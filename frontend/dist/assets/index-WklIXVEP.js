function sQ(e,r){for(var a=0;a<r.length;a++){const u=r[a];if(typeof u!="string"&&!Array.isArray(u)){for(const p in u)if(p!=="default"&&!(p in e)){const y=Object.getOwnPropertyDescriptor(u,p);y&&Object.defineProperty(e,p,y.get?y:{enumerable:!0,get:()=>u[p]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))u(p);new MutationObserver(p=>{for(const y of p)if(y.type==="childList")for(const x of y.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&u(x)}).observe(document,{childList:!0,subtree:!0});function a(p){const y={};return p.integrity&&(y.integrity=p.integrity),p.referrerPolicy&&(y.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?y.credentials="include":p.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function u(p){if(p.ep)return;p.ep=!0;const y=a(p);fetch(p.href,y)}})();var Db=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function aQ(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var r=e.default;if(typeof r=="function"){var a=function u(){var p=!1;try{p=this instanceof u}catch{}return p?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};a.prototype=r.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(u){var p=Object.getOwnPropertyDescriptor(e,u);Object.defineProperty(a,u,p.get?p:{enumerable:!0,get:function(){return e[u]}})}),a}var ZT={exports:{}},Yv={},XT={exports:{}},Hi={};var Vk;function lQ(){if(Vk)return Hi;Vk=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),x=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),R=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),F=Symbol.iterator;function V(tt){return tt===null||typeof tt!="object"?null:(tt=F&&tt[F]||tt["@@iterator"],typeof tt=="function"?tt:null)}var G={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H=Object.assign,Z={};function J(tt,ct,_t){this.props=tt,this.context=ct,this.refs=Z,this.updater=_t||G}J.prototype.isReactComponent={},J.prototype.setState=function(tt,ct){if(typeof tt!="object"&&typeof tt!="function"&&tt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,tt,ct,"setState")},J.prototype.forceUpdate=function(tt){this.updater.enqueueForceUpdate(this,tt,"forceUpdate")};function se(){}se.prototype=J.prototype;function pe(tt,ct,_t){this.props=tt,this.context=ct,this.refs=Z,this.updater=_t||G}var ve=pe.prototype=new se;ve.constructor=pe,H(ve,J.prototype),ve.isPureReactComponent=!0;var Ne=Array.isArray,_e=Object.prototype.hasOwnProperty,Re={current:null},ke={key:!0,ref:!0,__self:!0,__source:!0};function ze(tt,ct,_t){var Vt,bt={},ar=null,hr=null;if(ct!=null)for(Vt in ct.ref!==void 0&&(hr=ct.ref),ct.key!==void 0&&(ar=""+ct.key),ct)_e.call(ct,Vt)&&!ke.hasOwnProperty(Vt)&&(bt[Vt]=ct[Vt]);var xr=arguments.length-2;if(xr===1)bt.children=_t;else if(1<xr){for(var sr=Array(xr),Br=0;Br<xr;Br++)sr[Br]=arguments[Br+2];bt.children=sr}if(tt&&tt.defaultProps)for(Vt in xr=tt.defaultProps,xr)bt[Vt]===void 0&&(bt[Vt]=xr[Vt]);return{$$typeof:e,type:tt,key:ar,ref:hr,props:bt,_owner:Re.current}}function et(tt,ct){return{$$typeof:e,type:tt.type,key:ct,ref:tt.ref,props:tt.props,_owner:tt._owner}}function ht(tt){return typeof tt=="object"&&tt!==null&&tt.$$typeof===e}function Xt(tt){var ct={"=":"=0",":":"=2"};return"$"+tt.replace(/[=:]/g,function(_t){return ct[_t]})}var Ir=/\/+/g;function nr(tt,ct){return typeof tt=="object"&&tt!==null&&tt.key!=null?Xt(""+tt.key):ct.toString(36)}function Fr(tt,ct,_t,Vt,bt){var ar=typeof tt;(ar==="undefined"||ar==="boolean")&&(tt=null);var hr=!1;if(tt===null)hr=!0;else switch(ar){case"string":case"number":hr=!0;break;case"object":switch(tt.$$typeof){case e:case r:hr=!0}}if(hr)return hr=tt,bt=bt(hr),tt=Vt===""?"."+nr(hr,0):Vt,Ne(bt)?(_t="",tt!=null&&(_t=tt.replace(Ir,"$&/")+"/"),Fr(bt,ct,_t,"",function(Br){return Br})):bt!=null&&(ht(bt)&&(bt=et(bt,_t+(!bt.key||hr&&hr.key===bt.key?"":(""+bt.key).replace(Ir,"$&/")+"/")+tt)),ct.push(bt)),1;if(hr=0,Vt=Vt===""?".":Vt+":",Ne(tt))for(var xr=0;xr<tt.length;xr++){ar=tt[xr];var sr=Vt+nr(ar,xr);hr+=Fr(ar,ct,_t,sr,bt)}else if(sr=V(tt),typeof sr=="function")for(tt=sr.call(tt),xr=0;!(ar=tt.next()).done;)ar=ar.value,sr=Vt+nr(ar,xr++),hr+=Fr(ar,ct,_t,sr,bt);else if(ar==="object")throw ct=String(tt),Error("Objects are not valid as a React child (found: "+(ct==="[object Object]"?"object with keys {"+Object.keys(tt).join(", ")+"}":ct)+"). If you meant to render a collection of children, use an array instead.");return hr}function Or(tt,ct,_t){if(tt==null)return tt;var Vt=[],bt=0;return Fr(tt,Vt,"","",function(ar){return ct.call(_t,ar,bt++)}),Vt}function or(tt){if(tt._status===-1){var ct=tt._result;ct=ct(),ct.then(function(_t){(tt._status===0||tt._status===-1)&&(tt._status=1,tt._result=_t)},function(_t){(tt._status===0||tt._status===-1)&&(tt._status=2,tt._result=_t)}),tt._status===-1&&(tt._status=0,tt._result=ct)}if(tt._status===1)return tt._result.default;throw tt._result}var lt={current:null},Et={transition:null},qt={ReactCurrentDispatcher:lt,ReactCurrentBatchConfig:Et,ReactCurrentOwner:Re};function Gt(){throw Error("act(...) is not supported in production builds of React.")}return Hi.Children={map:Or,forEach:function(tt,ct,_t){Or(tt,function(){ct.apply(this,arguments)},_t)},count:function(tt){var ct=0;return Or(tt,function(){ct++}),ct},toArray:function(tt){return Or(tt,function(ct){return ct})||[]},only:function(tt){if(!ht(tt))throw Error("React.Children.only expected to receive a single React element child.");return tt}},Hi.Component=J,Hi.Fragment=a,Hi.Profiler=p,Hi.PureComponent=pe,Hi.StrictMode=u,Hi.Suspense=C,Hi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qt,Hi.act=Gt,Hi.cloneElement=function(tt,ct,_t){if(tt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+tt+".");var Vt=H({},tt.props),bt=tt.key,ar=tt.ref,hr=tt._owner;if(ct!=null){if(ct.ref!==void 0&&(ar=ct.ref,hr=Re.current),ct.key!==void 0&&(bt=""+ct.key),tt.type&&tt.type.defaultProps)var xr=tt.type.defaultProps;for(sr in ct)_e.call(ct,sr)&&!ke.hasOwnProperty(sr)&&(Vt[sr]=ct[sr]===void 0&&xr!==void 0?xr[sr]:ct[sr])}var sr=arguments.length-2;if(sr===1)Vt.children=_t;else if(1<sr){xr=Array(sr);for(var Br=0;Br<sr;Br++)xr[Br]=arguments[Br+2];Vt.children=xr}return{$$typeof:e,type:tt.type,key:bt,ref:ar,props:Vt,_owner:hr}},Hi.createContext=function(tt){return tt={$$typeof:x,_currentValue:tt,_currentValue2:tt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},tt.Provider={$$typeof:y,_context:tt},tt.Consumer=tt},Hi.createElement=ze,Hi.createFactory=function(tt){var ct=ze.bind(null,tt);return ct.type=tt,ct},Hi.createRef=function(){return{current:null}},Hi.forwardRef=function(tt){return{$$typeof:i,render:tt}},Hi.isValidElement=ht,Hi.lazy=function(tt){return{$$typeof:z,_payload:{_status:-1,_result:tt},_init:or}},Hi.memo=function(tt,ct){return{$$typeof:R,type:tt,compare:ct===void 0?null:ct}},Hi.startTransition=function(tt){var ct=Et.transition;Et.transition={};try{tt()}finally{Et.transition=ct}},Hi.unstable_act=Gt,Hi.useCallback=function(tt,ct){return lt.current.useCallback(tt,ct)},Hi.useContext=function(tt){return lt.current.useContext(tt)},Hi.useDebugValue=function(){},Hi.useDeferredValue=function(tt){return lt.current.useDeferredValue(tt)},Hi.useEffect=function(tt,ct){return lt.current.useEffect(tt,ct)},Hi.useId=function(){return lt.current.useId()},Hi.useImperativeHandle=function(tt,ct,_t){return lt.current.useImperativeHandle(tt,ct,_t)},Hi.useInsertionEffect=function(tt,ct){return lt.current.useInsertionEffect(tt,ct)},Hi.useLayoutEffect=function(tt,ct){return lt.current.useLayoutEffect(tt,ct)},Hi.useMemo=function(tt,ct){return lt.current.useMemo(tt,ct)},Hi.useReducer=function(tt,ct,_t){return lt.current.useReducer(tt,ct,_t)},Hi.useRef=function(tt){return lt.current.useRef(tt)},Hi.useState=function(tt){return lt.current.useState(tt)},Hi.useSyncExternalStore=function(tt,ct,_t){return lt.current.useSyncExternalStore(tt,ct,_t)},Hi.useTransition=function(){return lt.current.useTransition()},Hi.version="18.3.1",Hi}var Uk;function Ld(){return Uk||(Uk=1,XT.exports=lQ()),XT.exports}var $k;function cQ(){if($k)return Yv;$k=1;var e=Ld(),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,p=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y={key:!0,ref:!0,__self:!0,__source:!0};function x(i,C,R){var z,F={},V=null,G=null;R!==void 0&&(V=""+R),C.key!==void 0&&(V=""+C.key),C.ref!==void 0&&(G=C.ref);for(z in C)u.call(C,z)&&!y.hasOwnProperty(z)&&(F[z]=C[z]);if(i&&i.defaultProps)for(z in C=i.defaultProps,C)F[z]===void 0&&(F[z]=C[z]);return{$$typeof:r,type:i,key:V,ref:G,props:F,_owner:p.current}}return Yv.Fragment=a,Yv.jsx=x,Yv.jsxs=x,Yv}var Wk;function lW(){return Wk||(Wk=1,ZT.exports=cQ()),ZT.exports}var X=lW(),ge=Ld();const Js=hx(ge),sA=sQ({__proto__:null,default:Js},[ge]);var Rb={},KT={exports:{}},xu={},QT={exports:{}},JT={};var qk;function uQ(){return qk||(qk=1,(function(e){function r(Et,qt){var Gt=Et.length;Et.push(qt);e:for(;0<Gt;){var tt=Gt-1>>>1,ct=Et[tt];if(0<p(ct,qt))Et[tt]=qt,Et[Gt]=ct,Gt=tt;else break e}}function a(Et){return Et.length===0?null:Et[0]}function u(Et){if(Et.length===0)return null;var qt=Et[0],Gt=Et.pop();if(Gt!==qt){Et[0]=Gt;e:for(var tt=0,ct=Et.length,_t=ct>>>1;tt<_t;){var Vt=2*(tt+1)-1,bt=Et[Vt],ar=Vt+1,hr=Et[ar];if(0>p(bt,Gt))ar<ct&&0>p(hr,bt)?(Et[tt]=hr,Et[ar]=Gt,tt=ar):(Et[tt]=bt,Et[Vt]=Gt,tt=Vt);else if(ar<ct&&0>p(hr,Gt))Et[tt]=hr,Et[ar]=Gt,tt=ar;else break e}}return qt}function p(Et,qt){var Gt=Et.sortIndex-qt.sortIndex;return Gt!==0?Gt:Et.id-qt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;e.unstable_now=function(){return y.now()}}else{var x=Date,i=x.now();e.unstable_now=function(){return x.now()-i}}var C=[],R=[],z=1,F=null,V=3,G=!1,H=!1,Z=!1,J=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,pe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ve(Et){for(var qt=a(R);qt!==null;){if(qt.callback===null)u(R);else if(qt.startTime<=Et)u(R),qt.sortIndex=qt.expirationTime,r(C,qt);else break;qt=a(R)}}function Ne(Et){if(Z=!1,ve(Et),!H)if(a(C)!==null)H=!0,or(_e);else{var qt=a(R);qt!==null&&lt(Ne,qt.startTime-Et)}}function _e(Et,qt){H=!1,Z&&(Z=!1,se(ze),ze=-1),G=!0;var Gt=V;try{for(ve(qt),F=a(C);F!==null&&(!(F.expirationTime>qt)||Et&&!Xt());){var tt=F.callback;if(typeof tt=="function"){F.callback=null,V=F.priorityLevel;var ct=tt(F.expirationTime<=qt);qt=e.unstable_now(),typeof ct=="function"?F.callback=ct:F===a(C)&&u(C),ve(qt)}else u(C);F=a(C)}if(F!==null)var _t=!0;else{var Vt=a(R);Vt!==null&&lt(Ne,Vt.startTime-qt),_t=!1}return _t}finally{F=null,V=Gt,G=!1}}var Re=!1,ke=null,ze=-1,et=5,ht=-1;function Xt(){return!(e.unstable_now()-ht<et)}function Ir(){if(ke!==null){var Et=e.unstable_now();ht=Et;var qt=!0;try{qt=ke(!0,Et)}finally{qt?nr():(Re=!1,ke=null)}}else Re=!1}var nr;if(typeof pe=="function")nr=function(){pe(Ir)};else if(typeof MessageChannel<"u"){var Fr=new MessageChannel,Or=Fr.port2;Fr.port1.onmessage=Ir,nr=function(){Or.postMessage(null)}}else nr=function(){J(Ir,0)};function or(Et){ke=Et,Re||(Re=!0,nr())}function lt(Et,qt){ze=J(function(){Et(e.unstable_now())},qt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Et){Et.callback=null},e.unstable_continueExecution=function(){H||G||(H=!0,or(_e))},e.unstable_forceFrameRate=function(Et){0>Et||125<Et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):et=0<Et?Math.floor(1e3/Et):5},e.unstable_getCurrentPriorityLevel=function(){return V},e.unstable_getFirstCallbackNode=function(){return a(C)},e.unstable_next=function(Et){switch(V){case 1:case 2:case 3:var qt=3;break;default:qt=V}var Gt=V;V=qt;try{return Et()}finally{V=Gt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Et,qt){switch(Et){case 1:case 2:case 3:case 4:case 5:break;default:Et=3}var Gt=V;V=Et;try{return qt()}finally{V=Gt}},e.unstable_scheduleCallback=function(Et,qt,Gt){var tt=e.unstable_now();switch(typeof Gt=="object"&&Gt!==null?(Gt=Gt.delay,Gt=typeof Gt=="number"&&0<Gt?tt+Gt:tt):Gt=tt,Et){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=Gt+ct,Et={id:z++,callback:qt,priorityLevel:Et,startTime:Gt,expirationTime:ct,sortIndex:-1},Gt>tt?(Et.sortIndex=Gt,r(R,Et),a(C)===null&&Et===a(R)&&(Z?(se(ze),ze=-1):Z=!0,lt(Ne,Gt-tt))):(Et.sortIndex=ct,r(C,Et),H||G||(H=!0,or(_e))),Et},e.unstable_shouldYield=Xt,e.unstable_wrapCallback=function(Et){var qt=V;return function(){var Gt=V;V=qt;try{return Et.apply(this,arguments)}finally{V=Gt}}}})(JT)),JT}var Gk;function dQ(){return Gk||(Gk=1,QT.exports=uQ()),QT.exports}var Hk;function hQ(){if(Hk)return xu;Hk=1;var e=Ld(),r=dQ();function a(_){for(var S="https://reactjs.org/docs/error-decoder.html?invariant="+_,A=1;A<arguments.length;A++)S+="&args[]="+encodeURIComponent(arguments[A]);return"Minified React error #"+_+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,p={};function y(_,S){x(_,S),x(_+"Capture",S)}function x(_,S){for(p[_]=S,_=0;_<S.length;_++)u.add(S[_])}var i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),C=Object.prototype.hasOwnProperty,R=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,z={},F={};function V(_){return C.call(F,_)?!0:C.call(z,_)?!1:R.test(_)?F[_]=!0:(z[_]=!0,!1)}function G(_,S,A,N){if(A!==null&&A.type===0)return!1;switch(typeof S){case"function":case"symbol":return!0;case"boolean":return N?!1:A!==null?!A.acceptsBooleans:(_=_.toLowerCase().slice(0,5),_!=="data-"&&_!=="aria-");default:return!1}}function H(_,S,A,N){if(S===null||typeof S>"u"||G(_,S,A,N))return!0;if(N)return!1;if(A!==null)switch(A.type){case 3:return!S;case 4:return S===!1;case 5:return isNaN(S);case 6:return isNaN(S)||1>S}return!1}function Z(_,S,A,N,K,oe,Ee){this.acceptsBooleans=S===2||S===3||S===4,this.attributeName=N,this.attributeNamespace=K,this.mustUseProperty=A,this.propertyName=_,this.type=S,this.sanitizeURL=oe,this.removeEmptyString=Ee}var J={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_){J[_]=new Z(_,0,!1,_,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_){var S=_[0];J[S]=new Z(S,1,!1,_[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(_){J[_]=new Z(_,2,!1,_.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_){J[_]=new Z(_,2,!1,_,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_){J[_]=new Z(_,3,!1,_.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(_){J[_]=new Z(_,3,!0,_,null,!1,!1)}),["capture","download"].forEach(function(_){J[_]=new Z(_,4,!1,_,null,!1,!1)}),["cols","rows","size","span"].forEach(function(_){J[_]=new Z(_,6,!1,_,null,!1,!1)}),["rowSpan","start"].forEach(function(_){J[_]=new Z(_,5,!1,_.toLowerCase(),null,!1,!1)});var se=/[\-:]([a-z])/g;function pe(_){return _[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_){var S=_.replace(se,pe);J[S]=new Z(S,1,!1,_,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_){var S=_.replace(se,pe);J[S]=new Z(S,1,!1,_,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(_){var S=_.replace(se,pe);J[S]=new Z(S,1,!1,_,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(_){J[_]=new Z(_,1,!1,_.toLowerCase(),null,!1,!1)}),J.xlinkHref=new Z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(_){J[_]=new Z(_,1,!1,_.toLowerCase(),null,!0,!0)});function ve(_,S,A,N){var K=J.hasOwnProperty(S)?J[S]:null;(K!==null?K.type!==0:N||!(2<S.length)||S[0]!=="o"&&S[0]!=="O"||S[1]!=="n"&&S[1]!=="N")&&(H(S,A,K,N)&&(A=null),N||K===null?V(S)&&(A===null?_.removeAttribute(S):_.setAttribute(S,""+A)):K.mustUseProperty?_[K.propertyName]=A===null?K.type===3?!1:"":A:(S=K.attributeName,N=K.attributeNamespace,A===null?_.removeAttribute(S):(K=K.type,A=K===3||K===4&&A===!0?"":""+A,N?_.setAttributeNS(N,S,A):_.setAttribute(S,A))))}var Ne=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_e=Symbol.for("react.element"),Re=Symbol.for("react.portal"),ke=Symbol.for("react.fragment"),ze=Symbol.for("react.strict_mode"),et=Symbol.for("react.profiler"),ht=Symbol.for("react.provider"),Xt=Symbol.for("react.context"),Ir=Symbol.for("react.forward_ref"),nr=Symbol.for("react.suspense"),Fr=Symbol.for("react.suspense_list"),Or=Symbol.for("react.memo"),or=Symbol.for("react.lazy"),lt=Symbol.for("react.offscreen"),Et=Symbol.iterator;function qt(_){return _===null||typeof _!="object"?null:(_=Et&&_[Et]||_["@@iterator"],typeof _=="function"?_:null)}var Gt=Object.assign,tt;function ct(_){if(tt===void 0)try{throw Error()}catch(A){var S=A.stack.trim().match(/\n( *(at )?)/);tt=S&&S[1]||""}return`
`+tt+_}var _t=!1;function Vt(_,S){if(!_||_t)return"";_t=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(S)if(S=function(){throw Error()},Object.defineProperty(S.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(S,[])}catch(Yt){var N=Yt}Reflect.construct(_,[],S)}else{try{S.call()}catch(Yt){N=Yt}_.call(S.prototype)}else{try{throw Error()}catch(Yt){N=Yt}_()}}catch(Yt){if(Yt&&N&&typeof Yt.stack=="string"){for(var K=Yt.stack.split(`
`),oe=N.stack.split(`
`),Ee=K.length-1,Ke=oe.length-1;1<=Ee&&0<=Ke&&K[Ee]!==oe[Ke];)Ke--;for(;1<=Ee&&0<=Ke;Ee--,Ke--)if(K[Ee]!==oe[Ke]){if(Ee!==1||Ke!==1)do if(Ee--,Ke--,0>Ke||K[Ee]!==oe[Ke]){var ut=`
`+K[Ee].replace(" at new "," at ");return _.displayName&&ut.includes("<anonymous>")&&(ut=ut.replace("<anonymous>",_.displayName)),ut}while(1<=Ee&&0<=Ke);break}}}finally{_t=!1,Error.prepareStackTrace=A}return(_=_?_.displayName||_.name:"")?ct(_):""}function bt(_){switch(_.tag){case 5:return ct(_.type);case 16:return ct("Lazy");case 13:return ct("Suspense");case 19:return ct("SuspenseList");case 0:case 2:case 15:return _=Vt(_.type,!1),_;case 11:return _=Vt(_.type.render,!1),_;case 1:return _=Vt(_.type,!0),_;default:return""}}function ar(_){if(_==null)return null;if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _;switch(_){case ke:return"Fragment";case Re:return"Portal";case et:return"Profiler";case ze:return"StrictMode";case nr:return"Suspense";case Fr:return"SuspenseList"}if(typeof _=="object")switch(_.$$typeof){case Xt:return(_.displayName||"Context")+".Consumer";case ht:return(_._context.displayName||"Context")+".Provider";case Ir:var S=_.render;return _=_.displayName,_||(_=S.displayName||S.name||"",_=_!==""?"ForwardRef("+_+")":"ForwardRef"),_;case Or:return S=_.displayName||null,S!==null?S:ar(_.type)||"Memo";case or:S=_._payload,_=_._init;try{return ar(_(S))}catch{}}return null}function hr(_){var S=_.type;switch(_.tag){case 24:return"Cache";case 9:return(S.displayName||"Context")+".Consumer";case 10:return(S._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _=S.render,_=_.displayName||_.name||"",S.displayName||(_!==""?"ForwardRef("+_+")":"ForwardRef");case 7:return"Fragment";case 5:return S;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ar(S);case 8:return S===ze?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof S=="function")return S.displayName||S.name||null;if(typeof S=="string")return S}return null}function xr(_){switch(typeof _){case"boolean":case"number":case"string":case"undefined":return _;case"object":return _;default:return""}}function sr(_){var S=_.type;return(_=_.nodeName)&&_.toLowerCase()==="input"&&(S==="checkbox"||S==="radio")}function Br(_){var S=sr(_)?"checked":"value",A=Object.getOwnPropertyDescriptor(_.constructor.prototype,S),N=""+_[S];if(!_.hasOwnProperty(S)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var K=A.get,oe=A.set;return Object.defineProperty(_,S,{configurable:!0,get:function(){return K.call(this)},set:function(Ee){N=""+Ee,oe.call(this,Ee)}}),Object.defineProperty(_,S,{enumerable:A.enumerable}),{getValue:function(){return N},setValue:function(Ee){N=""+Ee},stopTracking:function(){_._valueTracker=null,delete _[S]}}}}function hn(_){_._valueTracker||(_._valueTracker=Br(_))}function Vn(_){if(!_)return!1;var S=_._valueTracker;if(!S)return!0;var A=S.getValue(),N="";return _&&(N=sr(_)?_.checked?"true":"false":_.value),_=N,_!==A?(S.setValue(_),!0):!1}function Yr(_){if(_=_||(typeof document<"u"?document:void 0),typeof _>"u")return null;try{return _.activeElement||_.body}catch{return _.body}}function Un(_,S){var A=S.checked;return Gt({},S,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:A??_._wrapperState.initialChecked})}function Si(_,S){var A=S.defaultValue==null?"":S.defaultValue,N=S.checked!=null?S.checked:S.defaultChecked;A=xr(S.value!=null?S.value:A),_._wrapperState={initialChecked:N,initialValue:A,controlled:S.type==="checkbox"||S.type==="radio"?S.checked!=null:S.value!=null}}function di(_,S){S=S.checked,S!=null&&ve(_,"checked",S,!1)}function Ii(_,S){di(_,S);var A=xr(S.value),N=S.type;if(A!=null)N==="number"?(A===0&&_.value===""||_.value!=A)&&(_.value=""+A):_.value!==""+A&&(_.value=""+A);else if(N==="submit"||N==="reset"){_.removeAttribute("value");return}S.hasOwnProperty("value")?Go(_,S.type,A):S.hasOwnProperty("defaultValue")&&Go(_,S.type,xr(S.defaultValue)),S.checked==null&&S.defaultChecked!=null&&(_.defaultChecked=!!S.defaultChecked)}function Xn(_,S,A){if(S.hasOwnProperty("value")||S.hasOwnProperty("defaultValue")){var N=S.type;if(!(N!=="submit"&&N!=="reset"||S.value!==void 0&&S.value!==null))return;S=""+_._wrapperState.initialValue,A||S===_.value||(_.value=S),_.defaultValue=S}A=_.name,A!==""&&(_.name=""),_.defaultChecked=!!_._wrapperState.initialChecked,A!==""&&(_.name=A)}function Go(_,S,A){(S!=="number"||Yr(_.ownerDocument)!==_)&&(A==null?_.defaultValue=""+_._wrapperState.initialValue:_.defaultValue!==""+A&&(_.defaultValue=""+A))}var Lo=Array.isArray;function co(_,S,A,N){if(_=_.options,S){S={};for(var K=0;K<A.length;K++)S["$"+A[K]]=!0;for(A=0;A<_.length;A++)K=S.hasOwnProperty("$"+_[A].value),_[A].selected!==K&&(_[A].selected=K),K&&N&&(_[A].defaultSelected=!0)}else{for(A=""+xr(A),S=null,K=0;K<_.length;K++){if(_[K].value===A){_[K].selected=!0,N&&(_[K].defaultSelected=!0);return}S!==null||_[K].disabled||(S=_[K])}S!==null&&(S.selected=!0)}}function Ko(_,S){if(S.dangerouslySetInnerHTML!=null)throw Error(a(91));return Gt({},S,{value:void 0,defaultValue:void 0,children:""+_._wrapperState.initialValue})}function ds(_,S){var A=S.value;if(A==null){if(A=S.children,S=S.defaultValue,A!=null){if(S!=null)throw Error(a(92));if(Lo(A)){if(1<A.length)throw Error(a(93));A=A[0]}S=A}S==null&&(S=""),A=S}_._wrapperState={initialValue:xr(A)}}function Bo(_,S){var A=xr(S.value),N=xr(S.defaultValue);A!=null&&(A=""+A,A!==_.value&&(_.value=A),S.defaultValue==null&&_.defaultValue!==A&&(_.defaultValue=A)),N!=null&&(_.defaultValue=""+N)}function ra(_){var S=_.textContent;S===_._wrapperState.initialValue&&S!==""&&S!==null&&(_.value=S)}function va(_){switch(_){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xa(_,S){return _==null||_==="http://www.w3.org/1999/xhtml"?va(S):_==="http://www.w3.org/2000/svg"&&S==="foreignObject"?"http://www.w3.org/1999/xhtml":_}var Bs,Qo=(function(_){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(S,A,N,K){MSApp.execUnsafeLocalFunction(function(){return _(S,A,N,K)})}:_})(function(_,S){if(_.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in _)_.innerHTML=S;else{for(Bs=Bs||document.createElement("div"),Bs.innerHTML="<svg>"+S.valueOf().toString()+"</svg>",S=Bs.firstChild;_.firstChild;)_.removeChild(_.firstChild);for(;S.firstChild;)_.appendChild(S.firstChild)}});function na(_,S){if(S){var A=_.firstChild;if(A&&A===_.lastChild&&A.nodeType===3){A.nodeValue=S;return}}_.textContent=S}var hs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cl=["Webkit","ms","Moz","O"];Object.keys(hs).forEach(function(_){Cl.forEach(function(S){S=S+_.charAt(0).toUpperCase()+_.substring(1),hs[S]=hs[_]})});function Al(_,S,A){return S==null||typeof S=="boolean"||S===""?"":A||typeof S!="number"||S===0||hs.hasOwnProperty(_)&&hs[_]?(""+S).trim():S+"px"}function io(_,S){_=_.style;for(var A in S)if(S.hasOwnProperty(A)){var N=A.indexOf("--")===0,K=Al(A,S[A],N);A==="float"&&(A="cssFloat"),N?_.setProperty(A,K):_[A]=K}}var js=Gt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ba(_,S){if(S){if(js[_]&&(S.children!=null||S.dangerouslySetInnerHTML!=null))throw Error(a(137,_));if(S.dangerouslySetInnerHTML!=null){if(S.children!=null)throw Error(a(60));if(typeof S.dangerouslySetInnerHTML!="object"||!("__html"in S.dangerouslySetInnerHTML))throw Error(a(61))}if(S.style!=null&&typeof S.style!="object")throw Error(a(62))}}function wa(_,S){if(_.indexOf("-")===-1)return typeof S.is=="string";switch(_){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ps=null;function Is(_){return _=_.target||_.srcElement||window,_.correspondingUseElement&&(_=_.correspondingUseElement),_.nodeType===3?_.parentNode:_}var _i=null,Zi=null,ia=null;function fs(_){if(_=Uh(_)){if(typeof _i!="function")throw Error(a(280));var S=_.stateNode;S&&(S=Hd(S),_i(_.stateNode,_.type,S))}}function Ms(_){Zi?ia?ia.push(_):ia=[_]:Zi=_}function Dc(){if(Zi){var _=Zi,S=ia;if(ia=Zi=null,fs(_),S)for(_=0;_<S.length;_++)fs(S[_])}}function rc(_,S){return _(S)}function ru(){}var ll=!1;function St(_,S,A){if(ll)return _(S,A);ll=!0;try{return rc(_,S,A)}finally{ll=!1,(Zi!==null||ia!==null)&&(ru(),Dc())}}function Ns(_,S){var A=_.stateNode;if(A===null)return null;var N=Hd(A);if(N===null)return null;A=N[S];e:switch(S){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(N=!N.disabled)||(_=_.type,N=!(_==="button"||_==="input"||_==="select"||_==="textarea")),_=!N;break e;default:_=!1}if(_)return null;if(A&&typeof A!="function")throw Error(a(231,S,typeof A));return A}var Dl=!1;if(i)try{var Ka={};Object.defineProperty(Ka,"passive",{get:function(){Dl=!0}}),window.addEventListener("test",Ka,Ka),window.removeEventListener("test",Ka,Ka)}catch{Dl=!1}function vn(_,S,A,N,K,oe,Ee,Ke,ut){var Yt=Array.prototype.slice.call(arguments,3);try{S.apply(A,Yt)}catch(Er){this.onError(Er)}}var So=!1,Sa=null,cl=!1,qe=null,ie={onError:function(_){So=!0,Sa=_}};function le(_,S,A,N,K,oe,Ee,Ke,ut){So=!1,Sa=null,vn.apply(ie,arguments)}function we(_,S,A,N,K,oe,Ee,Ke,ut){if(le.apply(this,arguments),So){if(So){var Yt=Sa;So=!1,Sa=null}else throw Error(a(198));cl||(cl=!0,qe=Yt)}}function Oe(_){var S=_,A=_;if(_.alternate)for(;S.return;)S=S.return;else{_=S;do S=_,(S.flags&4098)!==0&&(A=S.return),_=S.return;while(_)}return S.tag===3?A:null}function Le(_){if(_.tag===13){var S=_.memoizedState;if(S===null&&(_=_.alternate,_!==null&&(S=_.memoizedState)),S!==null)return S.dehydrated}return null}function Ue(_){if(Oe(_)!==_)throw Error(a(188))}function nt(_){var S=_.alternate;if(!S){if(S=Oe(_),S===null)throw Error(a(188));return S!==_?null:_}for(var A=_,N=S;;){var K=A.return;if(K===null)break;var oe=K.alternate;if(oe===null){if(N=K.return,N!==null){A=N;continue}break}if(K.child===oe.child){for(oe=K.child;oe;){if(oe===A)return Ue(K),_;if(oe===N)return Ue(K),S;oe=oe.sibling}throw Error(a(188))}if(A.return!==N.return)A=K,N=oe;else{for(var Ee=!1,Ke=K.child;Ke;){if(Ke===A){Ee=!0,A=K,N=oe;break}if(Ke===N){Ee=!0,N=K,A=oe;break}Ke=Ke.sibling}if(!Ee){for(Ke=oe.child;Ke;){if(Ke===A){Ee=!0,A=oe,N=K;break}if(Ke===N){Ee=!0,N=oe,A=K;break}Ke=Ke.sibling}if(!Ee)throw Error(a(189))}}if(A.alternate!==N)throw Error(a(190))}if(A.tag!==3)throw Error(a(188));return A.stateNode.current===A?_:S}function We(_){return _=nt(_),_!==null?Je(_):null}function Je(_){if(_.tag===5||_.tag===6)return _;for(_=_.child;_!==null;){var S=Je(_);if(S!==null)return S;_=_.sibling}return null}var Ot=r.unstable_scheduleCallback,Pt=r.unstable_cancelCallback,gr=r.unstable_shouldYield,jr=r.unstable_requestPaint,yr=r.unstable_now,Cr=r.unstable_getCurrentPriorityLevel,Zr=r.unstable_ImmediatePriority,on=r.unstable_UserBlockingPriority,Cn=r.unstable_NormalPriority,Mi=r.unstable_LowPriority,Qi=r.unstable_IdlePriority,Ti=null,si=null;function Ln(_){if(si&&typeof si.onCommitFiberRoot=="function")try{si.onCommitFiberRoot(Ti,_,void 0,(_.current.flags&128)===128)}catch{}}var rn=Math.clz32?Math.clz32:$n,fi=Math.log,Ei=Math.LN2;function $n(_){return _>>>=0,_===0?32:31-(fi(_)/Ei|0)|0}var ii=64,Ji=4194304;function To(_){switch(_&-_){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _}}function ps(_,S){var A=_.pendingLanes;if(A===0)return 0;var N=0,K=_.suspendedLanes,oe=_.pingedLanes,Ee=A&268435455;if(Ee!==0){var Ke=Ee&~K;Ke!==0?N=To(Ke):(oe&=Ee,oe!==0&&(N=To(oe)))}else Ee=A&~K,Ee!==0?N=To(Ee):oe!==0&&(N=To(oe));if(N===0)return 0;if(S!==0&&S!==N&&(S&K)===0&&(K=N&-N,oe=S&-S,K>=oe||K===16&&(oe&4194240)!==0))return S;if((N&4)!==0&&(N|=A&16),S=_.entangledLanes,S!==0)for(_=_.entanglements,S&=N;0<S;)A=31-rn(S),K=1<<A,N|=_[A],S&=~K;return N}function Oa(_,S){switch(_){case 1:case 2:case 4:return S+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return S+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uo(_,S){for(var A=_.suspendedLanes,N=_.pingedLanes,K=_.expirationTimes,oe=_.pendingLanes;0<oe;){var Ee=31-rn(oe),Ke=1<<Ee,ut=K[Ee];ut===-1?((Ke&A)===0||(Ke&N)!==0)&&(K[Ee]=Oa(Ke,S)):ut<=S&&(_.expiredLanes|=Ke),oe&=~Ke}}function Cs(_){return _=_.pendingLanes&-1073741825,_!==0?_:_&1073741824?1073741824:0}function Jo(){var _=ii;return ii<<=1,(ii&4194240)===0&&(ii=64),_}function As(_){for(var S=[],A=0;31>A;A++)S.push(_);return S}function Ho(_,S,A){_.pendingLanes|=S,S!==536870912&&(_.suspendedLanes=0,_.pingedLanes=0),_=_.eventTimes,S=31-rn(S),_[S]=A}function Ds(_,S){var A=_.pendingLanes&~S;_.pendingLanes=S,_.suspendedLanes=0,_.pingedLanes=0,_.expiredLanes&=S,_.mutableReadLanes&=S,_.entangledLanes&=S,S=_.entanglements;var N=_.eventTimes;for(_=_.expirationTimes;0<A;){var K=31-rn(A),oe=1<<K;S[K]=0,N[K]=-1,_[K]=-1,A&=~oe}}function nc(_,S){var A=_.entangledLanes|=S;for(_=_.entanglements;A;){var N=31-rn(A),K=1<<N;K&S|_[N]&S&&(_[N]|=S),A&=~K}}var yi=0;function ic(_){return _&=-_,1<_?4<_?(_&268435455)!==0?16:536870912:4:1}var oc,es,Rs,ts,Os,Ta=!1,Vs=[],Us=null,$s=null,jo=null,oa=new Map,ul=new Map,Ea=[],Ws="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function La(_,S){switch(_){case"focusin":case"focusout":Us=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":jo=null;break;case"pointerover":case"pointerout":oa.delete(S.pointerId);break;case"gotpointercapture":case"lostpointercapture":ul.delete(S.pointerId)}}function ms(_,S,A,N,K,oe){return _===null||_.nativeEvent!==oe?(_={blockedOn:S,domEventName:A,eventSystemFlags:N,nativeEvent:oe,targetContainers:[K]},S!==null&&(S=Uh(S),S!==null&&es(S)),_):(_.eventSystemFlags|=N,S=_.targetContainers,K!==null&&S.indexOf(K)===-1&&S.push(K),_)}function Rl(_,S,A,N,K){switch(S){case"focusin":return Us=ms(Us,_,S,A,N,K),!0;case"dragenter":return $s=ms($s,_,S,A,N,K),!0;case"mouseover":return jo=ms(jo,_,S,A,N,K),!0;case"pointerover":var oe=K.pointerId;return oa.set(oe,ms(oa.get(oe)||null,_,S,A,N,K)),!0;case"gotpointercapture":return oe=K.pointerId,ul.set(oe,ms(ul.get(oe)||null,_,S,A,N,K)),!0}return!1}function Rc(_){var S=fd(_.target);if(S!==null){var A=Oe(S);if(A!==null){if(S=A.tag,S===13){if(S=Le(A),S!==null){_.blockedOn=S,Os(_.priority,function(){Rs(A)});return}}else if(S===3&&A.stateNode.current.memoizedState.isDehydrated){_.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}_.blockedOn=null}function dl(_){if(_.blockedOn!==null)return!1;for(var S=_.targetContainers;0<S.length;){var A=Ri(_.domEventName,_.eventSystemFlags,S[0],_.nativeEvent);if(A===null){A=_.nativeEvent;var N=new A.constructor(A.type,A);Ps=N,A.target.dispatchEvent(N),Ps=null}else return S=Uh(A),S!==null&&es(S),_.blockedOn=A,!1;S.shift()}return!0}function hl(_,S,A){dl(_)&&A.delete(S)}function bn(){Ta=!1,Us!==null&&dl(Us)&&(Us=null),$s!==null&&dl($s)&&($s=null),jo!==null&&dl(jo)&&(jo=null),oa.forEach(hl),ul.forEach(hl)}function Ol(_,S){_.blockedOn===S&&(_.blockedOn=null,Ta||(Ta=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,bn)))}function za(_){function S(K){return Ol(K,_)}if(0<Vs.length){Ol(Vs[0],_);for(var A=1;A<Vs.length;A++){var N=Vs[A];N.blockedOn===_&&(N.blockedOn=null)}}for(Us!==null&&Ol(Us,_),$s!==null&&Ol($s,_),jo!==null&&Ol(jo,_),oa.forEach(S),ul.forEach(S),A=0;A<Ea.length;A++)N=Ea[A],N.blockedOn===_&&(N.blockedOn=null);for(;0<Ea.length&&(A=Ea[0],A.blockedOn===null);)Rc(A),A.blockedOn===null&&Ea.shift()}var Fa=Ne.ReactCurrentBatchConfig,Ge=!0;function yt(_,S,A,N){var K=yi,oe=Fa.transition;Fa.transition=null;try{yi=1,Xr(_,S,A,N)}finally{yi=K,Fa.transition=oe}}function Ht(_,S,A,N){var K=yi,oe=Fa.transition;Fa.transition=null;try{yi=4,Xr(_,S,A,N)}finally{yi=K,Fa.transition=oe}}function Xr(_,S,A,N){if(Ge){var K=Ri(_,S,A,N);if(K===null)qp(_,S,N,jn,A),La(_,N);else if(Rl(K,_,S,A,N))N.stopPropagation();else if(La(_,N),S&4&&-1<Ws.indexOf(_)){for(;K!==null;){var oe=Uh(K);if(oe!==null&&oc(oe),oe=Ri(_,S,A,N),oe===null&&qp(_,S,N,jn,A),oe===K)break;K=oe}K!==null&&N.stopPropagation()}else qp(_,S,N,null,A)}}var jn=null;function Ri(_,S,A,N){if(jn=null,_=Is(N),_=fd(_),_!==null)if(S=Oe(_),S===null)_=null;else if(A=S.tag,A===13){if(_=Le(S),_!==null)return _;_=null}else if(A===3){if(S.stateNode.current.memoizedState.isDehydrated)return S.tag===3?S.stateNode.containerInfo:null;_=null}else S!==_&&(_=null);return jn=_,null}function Ui(_){switch(_){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cr()){case Zr:return 1;case on:return 4;case Cn:case Mi:return 16;case Qi:return 536870912;default:return 16}default:return 16}}var ai=null,Oi=null,eo=null;function Yo(){if(eo)return eo;var _,S=Oi,A=S.length,N,K="value"in ai?ai.value:ai.textContent,oe=K.length;for(_=0;_<A&&S[_]===K[_];_++);var Ee=A-_;for(N=1;N<=Ee&&S[A-N]===K[oe-N];N++);return eo=K.slice(_,1<N?1-N:void 0)}function qs(_){var S=_.keyCode;return"charCode"in _?(_=_.charCode,_===0&&S===13&&(_=13)):_=S,_===10&&(_=13),32<=_||_===13?_:0}function ka(){return!0}function sa(){return!1}function pi(_){function S(A,N,K,oe,Ee){this._reactName=A,this._targetInst=K,this.type=N,this.nativeEvent=oe,this.target=Ee,this.currentTarget=null;for(var Ke in _)_.hasOwnProperty(Ke)&&(A=_[Ke],this[Ke]=A?A(oe):oe[Ke]);return this.isDefaultPrevented=(oe.defaultPrevented!=null?oe.defaultPrevented:oe.returnValue===!1)?ka:sa,this.isPropagationStopped=sa,this}return Gt(S.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=ka)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=ka)},persist:function(){},isPersistent:ka}),S}var sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(_){return _.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Iu=pi(sc),Oc=Gt({},sc,{view:0,detail:0}),zn=pi(Oc),Mu,rd,nu,Lr=Gt({},Oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ho,button:0,buttons:0,relatedTarget:function(_){return _.relatedTarget===void 0?_.fromElement===_.srcElement?_.toElement:_.fromElement:_.relatedTarget},movementX:function(_){return"movementX"in _?_.movementX:(_!==nu&&(nu&&_.type==="mousemove"?(Mu=_.screenX-nu.screenX,rd=_.screenY-nu.screenY):rd=Mu=0,nu=_),Mu)},movementY:function(_){return"movementY"in _?_.movementY:rd}}),iu=pi(Lr),Ll=Gt({},Lr,{dataTransfer:0}),Ba=pi(Ll),ja=Gt({},Oc,{relatedTarget:0}),ac=pi(ja),br=Gt({},sc,{animationName:0,elapsedTime:0,pseudoElement:0}),wn=pi(br),Dn=Gt({},sc,{clipboardData:function(_){return"clipboardData"in _?_.clipboardData:window.clipboardData}}),aa=pi(Dn),ou=Gt({},sc,{data:0}),Fn=pi(ou),Cu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Au={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zo(_){var S=this.nativeEvent;return S.getModifierState?S.getModifierState(_):(_=Au[_])?!!S[_]:!1}function ho(){return Zo}var Bf=Gt({},Oc,{key:function(_){if(_.key){var S=Cu[_.key]||_.key;if(S!=="Unidentified")return S}return _.type==="keypress"?(_=qs(_),_===13?"Enter":String.fromCharCode(_)):_.type==="keydown"||_.type==="keyup"?Lc[_.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ho,charCode:function(_){return _.type==="keypress"?qs(_):0},keyCode:function(_){return _.type==="keydown"||_.type==="keyup"?_.keyCode:0},which:function(_){return _.type==="keypress"?qs(_):_.type==="keydown"||_.type==="keyup"?_.keyCode:0}}),Du=pi(Bf),zd=Gt({},Lr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),su=pi(zd),nd=Gt({},Oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ho}),Fd=pi(nd),Ru=Gt({},sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),No=pi(Ru),zl=Gt({},Lr,{deltaX:function(_){return"deltaX"in _?_.deltaX:"wheelDeltaX"in _?-_.wheelDeltaX:0},deltaY:function(_){return"deltaY"in _?_.deltaY:"wheelDeltaY"in _?-_.wheelDeltaY:"wheelDelta"in _?-_.wheelDelta:0},deltaZ:0,deltaMode:0}),Gs=pi(zl),id=[9,13,27,32],lc=i&&"CompositionEvent"in window,fo=null;i&&"documentMode"in document&&(fo=document.documentMode);var fl=i&&"TextEvent"in window&&!fo,pl=i&&(!lc||fo&&8<fo&&11>=fo),Xi=" ",en=!1;function pr(_,S){switch(_){case"keyup":return id.indexOf(S.keyCode)!==-1;case"keydown":return S.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cc(_){return _=_.detail,typeof _=="object"&&"data"in _?_.data:null}var Nr=!1;function au(_,S){switch(_){case"compositionend":return cc(S);case"keypress":return S.which!==32?null:(en=!0,Xi);case"textInput":return _=S.data,_===Xi&&en?null:_;default:return null}}function od(_,S){if(Nr)return _==="compositionend"||!lc&&pr(_,S)?(_=Yo(),eo=Oi=ai=null,Nr=!1,_):null;switch(_){case"paste":return null;case"keypress":if(!(S.ctrlKey||S.altKey||S.metaKey)||S.ctrlKey&&S.altKey){if(S.char&&1<S.char.length)return S.char;if(S.which)return String.fromCharCode(S.which)}return null;case"compositionend":return pl&&S.locale!=="ko"?null:S.data;default:return null}}var Vr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lu(_){var S=_&&_.nodeName&&_.nodeName.toLowerCase();return S==="input"?!!Vr[_.type]:S==="textarea"}function Ou(_,S,A,N){Ms(N),S=Gp(S,"onChange"),0<S.length&&(A=new Iu("onChange","change",null,A,N),_.push({event:A,listeners:S}))}var cu=null,la=null;function sd(_){Vd(_,0)}function Eo(_){var S=kc(_);if(Vn(S))return _}function gs(_,S){if(_==="change")return S}var uc=!1;if(i){var dc;if(i){var Qa="oninput"in document;if(!Qa){var Vo=document.createElement("div");Vo.setAttribute("oninput","return;"),Qa=typeof Vo.oninput=="function"}dc=Qa}else dc=!1;uc=dc&&(!document.documentMode||9<document.documentMode)}function Rh(){cu&&(cu.detachEvent("onpropertychange",Oh),la=cu=null)}function Oh(_){if(_.propertyName==="value"&&Eo(la)){var S=[];Ou(S,la,_,Is(_)),St(sd,S)}}function Lu(_,S,A){_==="focusin"?(Rh(),cu=S,la=A,cu.attachEvent("onpropertychange",Oh)):_==="focusout"&&Rh()}function hc(_){if(_==="selectionchange"||_==="keyup"||_==="keydown")return Eo(la)}function Lh(_,S){if(_==="click")return Eo(S)}function Na(_,S){if(_==="input"||_==="change")return Eo(S)}function zh(_,S){return _===S&&(_!==0||1/_===1/S)||_!==_&&S!==S}var ca=typeof Object.is=="function"?Object.is:zh;function Fl(_,S){if(ca(_,S))return!0;if(typeof _!="object"||_===null||typeof S!="object"||S===null)return!1;var A=Object.keys(_),N=Object.keys(S);if(A.length!==N.length)return!1;for(N=0;N<A.length;N++){var K=A[N];if(!C.call(S,K)||!ca(_[K],S[K]))return!1}return!0}function kl(_){for(;_&&_.firstChild;)_=_.firstChild;return _}function Fh(_,S){var A=kl(_);_=0;for(var N;A;){if(A.nodeType===3){if(N=_+A.textContent.length,_<=S&&N>=S)return{node:A,offset:S-_};_=N}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=kl(A)}}function kd(_,S){return _&&S?_===S?!0:_&&_.nodeType===3?!1:S&&S.nodeType===3?kd(_,S.parentNode):"contains"in _?_.contains(S):_.compareDocumentPosition?!!(_.compareDocumentPosition(S)&16):!1:!1}function kh(){for(var _=window,S=Yr();S instanceof _.HTMLIFrameElement;){try{var A=typeof S.contentWindow.location.href=="string"}catch{A=!1}if(A)_=S.contentWindow;else break;S=Yr(_.document)}return S}function ml(_){var S=_&&_.nodeName&&_.nodeName.toLowerCase();return S&&(S==="input"&&(_.type==="text"||_.type==="search"||_.type==="tel"||_.type==="url"||_.type==="password")||S==="textarea"||_.contentEditable==="true")}function T(_){var S=kh(),A=_.focusedElem,N=_.selectionRange;if(S!==A&&A&&A.ownerDocument&&kd(A.ownerDocument.documentElement,A)){if(N!==null&&ml(A)){if(S=N.start,_=N.end,_===void 0&&(_=S),"selectionStart"in A)A.selectionStart=S,A.selectionEnd=Math.min(_,A.value.length);else if(_=(S=A.ownerDocument||document)&&S.defaultView||window,_.getSelection){_=_.getSelection();var K=A.textContent.length,oe=Math.min(N.start,K);N=N.end===void 0?oe:Math.min(N.end,K),!_.extend&&oe>N&&(K=N,N=oe,oe=K),K=Fh(A,oe);var Ee=Fh(A,N);K&&Ee&&(_.rangeCount!==1||_.anchorNode!==K.node||_.anchorOffset!==K.offset||_.focusNode!==Ee.node||_.focusOffset!==Ee.offset)&&(S=S.createRange(),S.setStart(K.node,K.offset),_.removeAllRanges(),oe>N?(_.addRange(S),_.extend(Ee.node,Ee.offset)):(S.setEnd(Ee.node,Ee.offset),_.addRange(S)))}}for(S=[],_=A;_=_.parentNode;)_.nodeType===1&&S.push({element:_,left:_.scrollLeft,top:_.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<S.length;A++)_=S[A],_.element.scrollLeft=_.left,_.element.scrollTop=_.top}}var tg=i&&"documentMode"in document&&11>=document.documentMode,zu=null,jf=null,Bd=null,gl=!1;function ad(_,S,A){var N=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;gl||zu==null||zu!==Yr(N)||(N=zu,"selectionStart"in N&&ml(N)?N={start:N.selectionStart,end:N.selectionEnd}:(N=(N.ownerDocument&&N.ownerDocument.defaultView||window).getSelection(),N={anchorNode:N.anchorNode,anchorOffset:N.anchorOffset,focusNode:N.focusNode,focusOffset:N.focusOffset}),Bd&&Fl(Bd,N)||(Bd=N,N=Gp(jf,"onSelect"),0<N.length&&(S=new Iu("onSelect","select",null,S,A),_.push({event:S,listeners:N}),S.target=zu)))}function ld(_,S){var A={};return A[_.toLowerCase()]=S.toLowerCase(),A["Webkit"+_]="webkit"+S,A["Moz"+_]="moz"+S,A}var cd={animationend:ld("Animation","AnimationEnd"),animationiteration:ld("Animation","AnimationIteration"),animationstart:ld("Animation","AnimationStart"),transitionend:ld("Transition","TransitionEnd")},Nf={},jd={};i&&(jd=document.createElement("div").style,"AnimationEvent"in window||(delete cd.animationend.animation,delete cd.animationiteration.animation,delete cd.animationstart.animation),"TransitionEvent"in window||delete cd.transitionend.transition);function Fu(_){if(Nf[_])return Nf[_];if(!cd[_])return _;var S=cd[_],A;for(A in S)if(S.hasOwnProperty(A)&&A in jd)return Nf[_]=S[A];return _}var $p=Fu("animationend"),Vf=Fu("animationiteration"),_l=Fu("animationstart"),Uf=Fu("transitionend"),Ut=new Map,Wp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bl(_,S){Ut.set(_,S),y(S,[_])}for(var ud=0;ud<Wp.length;ud++){var Nd=Wp[ud],$f=Nd.toLowerCase(),uu=Nd[0].toUpperCase()+Nd.slice(1);Bl($f,"on"+uu)}Bl($p,"onAnimationEnd"),Bl(Vf,"onAnimationIteration"),Bl(_l,"onAnimationStart"),Bl("dblclick","onDoubleClick"),Bl("focusin","onFocus"),Bl("focusout","onBlur"),Bl(Uf,"onTransitionEnd"),x("onMouseEnter",["mouseout","mouseover"]),x("onMouseLeave",["mouseout","mouseover"]),x("onPointerEnter",["pointerout","pointerover"]),x("onPointerLeave",["pointerout","pointerover"]),y("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),y("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),y("onBeforeInput",["compositionend","keypress","textInput","paste"]),y("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),y("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fc=new Set("cancel close invalid load scroll toggle".split(" ").concat(dd));function xn(_,S,A){var N=_.type||"unknown-event";_.currentTarget=A,we(N,S,void 0,_),_.currentTarget=null}function Vd(_,S){S=(S&4)!==0;for(var A=0;A<_.length;A++){var N=_[A],K=N.event;N=N.listeners;e:{var oe=void 0;if(S)for(var Ee=N.length-1;0<=Ee;Ee--){var Ke=N[Ee],ut=Ke.instance,Yt=Ke.currentTarget;if(Ke=Ke.listener,ut!==oe&&K.isPropagationStopped())break e;xn(K,Ke,Yt),oe=ut}else for(Ee=0;Ee<N.length;Ee++){if(Ke=N[Ee],ut=Ke.instance,Yt=Ke.currentTarget,Ke=Ke.listener,ut!==oe&&K.isPropagationStopped())break e;xn(K,Ke,Yt),oe=ut}}}if(cl)throw _=qe,cl=!1,qe=null,_}function Uo(_,S){var A=S[Vh];A===void 0&&(A=S[Vh]=new Set);var N=_+"__bubble";A.has(N)||($i(S,_,2,!1),A.add(N))}function rg(_,S,A){var N=0;S&&(N|=4),$i(A,_,N,S)}var Ud="_reactListening"+Math.random().toString(36).slice(2);function Wf(_){if(!_[Ud]){_[Ud]=!0,u.forEach(function(A){A!=="selectionchange"&&(fc.has(A)||rg(A,!1,_),rg(A,!0,_))});var S=_.nodeType===9?_:_.ownerDocument;S===null||S[Ud]||(S[Ud]=!0,rg("selectionchange",!1,S))}}function $i(_,S,A,N){switch(Ui(S)){case 1:var K=yt;break;case 4:K=Ht;break;default:K=Xr}A=K.bind(null,S,A,_),K=void 0,!Dl||S!=="touchstart"&&S!=="touchmove"&&S!=="wheel"||(K=!0),N?K!==void 0?_.addEventListener(S,A,{capture:!0,passive:K}):_.addEventListener(S,A,!0):K!==void 0?_.addEventListener(S,A,{passive:K}):_.addEventListener(S,A,!1)}function qp(_,S,A,N,K){var oe=N;if((S&1)===0&&(S&2)===0&&N!==null)e:for(;;){if(N===null)return;var Ee=N.tag;if(Ee===3||Ee===4){var Ke=N.stateNode.containerInfo;if(Ke===K||Ke.nodeType===8&&Ke.parentNode===K)break;if(Ee===4)for(Ee=N.return;Ee!==null;){var ut=Ee.tag;if((ut===3||ut===4)&&(ut=Ee.stateNode.containerInfo,ut===K||ut.nodeType===8&&ut.parentNode===K))return;Ee=Ee.return}for(;Ke!==null;){if(Ee=fd(Ke),Ee===null)return;if(ut=Ee.tag,ut===5||ut===6){N=oe=Ee;continue e}Ke=Ke.parentNode}}N=N.return}St(function(){var Yt=oe,Er=Is(A),Ar=[];e:{var Pr=Ut.get(_);if(Pr!==void 0){var un=Iu,fn=_;switch(_){case"keypress":if(qs(A)===0)break e;case"keydown":case"keyup":un=Du;break;case"focusin":fn="focus",un=ac;break;case"focusout":fn="blur",un=ac;break;case"beforeblur":case"afterblur":un=ac;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":un=iu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":un=Ba;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":un=Fd;break;case $p:case Vf:case _l:un=wn;break;case Uf:un=No;break;case"scroll":un=zn;break;case"wheel":un=Gs;break;case"copy":case"cut":case"paste":un=aa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":un=su}var an=(S&4)!==0,Io=!an&&_==="scroll",Lt=an?Pr!==null?Pr+"Capture":null:Pr;an=[];for(var vt=Yt,Bt;vt!==null;){Bt=vt;var kr=Bt.stateNode;if(Bt.tag===5&&kr!==null&&(Bt=kr,Lt!==null&&(kr=Ns(vt,Lt),kr!=null&&an.push($d(vt,kr,Bt)))),Io)break;vt=vt.return}0<an.length&&(Pr=new un(Pr,fn,null,A,Er),Ar.push({event:Pr,listeners:an}))}}if((S&7)===0){e:{if(Pr=_==="mouseover"||_==="pointerover",un=_==="mouseout"||_==="pointerout",Pr&&A!==Ps&&(fn=A.relatedTarget||A.fromElement)&&(fd(fn)||fn[Fc]))break e;if((un||Pr)&&(Pr=Er.window===Er?Er:(Pr=Er.ownerDocument)?Pr.defaultView||Pr.parentWindow:window,un?(fn=A.relatedTarget||A.toElement,un=Yt,fn=fn?fd(fn):null,fn!==null&&(Io=Oe(fn),fn!==Io||fn.tag!==5&&fn.tag!==6)&&(fn=null)):(un=null,fn=Yt),un!==fn)){if(an=iu,kr="onMouseLeave",Lt="onMouseEnter",vt="mouse",(_==="pointerout"||_==="pointerover")&&(an=su,kr="onPointerLeave",Lt="onPointerEnter",vt="pointer"),Io=un==null?Pr:kc(un),Bt=fn==null?Pr:kc(fn),Pr=new an(kr,vt+"leave",un,A,Er),Pr.target=Io,Pr.relatedTarget=Bt,kr=null,fd(Er)===Yt&&(an=new an(Lt,vt+"enter",fn,A,Er),an.target=Bt,an.relatedTarget=Io,kr=an),Io=kr,un&&fn)t:{for(an=un,Lt=fn,vt=0,Bt=an;Bt;Bt=Bh(Bt))vt++;for(Bt=0,kr=Lt;kr;kr=Bh(kr))Bt++;for(;0<vt-Bt;)an=Bh(an),vt--;for(;0<Bt-vt;)Lt=Bh(Lt),Bt--;for(;vt--;){if(an===Lt||Lt!==null&&an===Lt.alternate)break t;an=Bh(an),Lt=Bh(Lt)}an=null}else an=null;un!==null&&w_(Ar,Pr,un,an,!1),fn!==null&&Io!==null&&w_(Ar,Io,fn,an,!0)}}e:{if(Pr=Yt?kc(Yt):window,un=Pr.nodeName&&Pr.nodeName.toLowerCase(),un==="select"||un==="input"&&Pr.type==="file")var mn=gs;else if(lu(Pr))if(uc)mn=Na;else{mn=hc;var In=Lu}else(un=Pr.nodeName)&&un.toLowerCase()==="input"&&(Pr.type==="checkbox"||Pr.type==="radio")&&(mn=Lh);if(mn&&(mn=mn(_,Yt))){Ou(Ar,mn,A,Er);break e}In&&In(_,Pr,Yt),_==="focusout"&&(In=Pr._wrapperState)&&In.controlled&&Pr.type==="number"&&Go(Pr,"number",Pr.value)}switch(In=Yt?kc(Yt):window,_){case"focusin":(lu(In)||In.contentEditable==="true")&&(zu=In,jf=Yt,Bd=null);break;case"focusout":Bd=jf=zu=null;break;case"mousedown":gl=!0;break;case"contextmenu":case"mouseup":case"dragend":gl=!1,ad(Ar,A,Er);break;case"selectionchange":if(tg)break;case"keydown":case"keyup":ad(Ar,A,Er)}var Rn;if(lc)e:{switch(_){case"compositionstart":var Gn="onCompositionStart";break e;case"compositionend":Gn="onCompositionEnd";break e;case"compositionupdate":Gn="onCompositionUpdate";break e}Gn=void 0}else Nr?pr(_,A)&&(Gn="onCompositionEnd"):_==="keydown"&&A.keyCode===229&&(Gn="onCompositionStart");Gn&&(pl&&A.locale!=="ko"&&(Nr||Gn!=="onCompositionStart"?Gn==="onCompositionEnd"&&Nr&&(Rn=Yo()):(ai=Er,Oi="value"in ai?ai.value:ai.textContent,Nr=!0)),In=Gp(Yt,Gn),0<In.length&&(Gn=new Fn(Gn,_,null,A,Er),Ar.push({event:Gn,listeners:In}),Rn?Gn.data=Rn:(Rn=cc(A),Rn!==null&&(Gn.data=Rn)))),(Rn=fl?au(_,A):od(_,A))&&(Yt=Gp(Yt,"onBeforeInput"),0<Yt.length&&(Er=new Fn("onBeforeInput","beforeinput",null,A,Er),Ar.push({event:Er,listeners:Yt}),Er.data=Rn))}Vd(Ar,S)})}function $d(_,S,A){return{instance:_,listener:S,currentTarget:A}}function Gp(_,S){for(var A=S+"Capture",N=[];_!==null;){var K=_,oe=K.stateNode;K.tag===5&&oe!==null&&(K=oe,oe=Ns(_,A),oe!=null&&N.unshift($d(_,oe,K)),oe=Ns(_,S),oe!=null&&N.push($d(_,oe,K))),_=_.return}return N}function Bh(_){if(_===null)return null;do _=_.return;while(_&&_.tag!==5);return _||null}function w_(_,S,A,N,K){for(var oe=S._reactName,Ee=[];A!==null&&A!==N;){var Ke=A,ut=Ke.alternate,Yt=Ke.stateNode;if(ut!==null&&ut===N)break;Ke.tag===5&&Yt!==null&&(Ke=Yt,K?(ut=Ns(A,oe),ut!=null&&Ee.unshift($d(A,ut,Ke))):K||(ut=Ns(A,oe),ut!=null&&Ee.push($d(A,ut,Ke)))),A=A.return}Ee.length!==0&&_.push({event:S,listeners:Ee})}var ov=/\r\n?/g,S_=/\u0000|\uFFFD/g;function T_(_){return(typeof _=="string"?_:""+_).replace(ov,`
`).replace(S_,"")}function Wd(_,S,A){if(S=T_(S),T_(_)!==S&&A)throw Error(a(425))}function Hp(){}var Yp=null,qf=null;function jh(_,S){return _==="textarea"||_==="noscript"||typeof S.children=="string"||typeof S.children=="number"||typeof S.dangerouslySetInnerHTML=="object"&&S.dangerouslySetInnerHTML!==null&&S.dangerouslySetInnerHTML.__html!=null}var Gf=typeof setTimeout=="function"?setTimeout:void 0,qd=typeof clearTimeout=="function"?clearTimeout:void 0,Gd=typeof Promise=="function"?Promise:void 0,Hf=typeof queueMicrotask=="function"?queueMicrotask:typeof Gd<"u"?function(_){return Gd.resolve(null).then(_).catch(Nh)}:Gf;function Nh(_){setTimeout(function(){throw _})}function Zp(_,S){var A=S,N=0;do{var K=A.nextSibling;if(_.removeChild(A),K&&K.nodeType===8)if(A=K.data,A==="/$"){if(N===0){_.removeChild(K),za(S);return}N--}else A!=="$"&&A!=="$?"&&A!=="$!"||N++;A=K}while(A);za(S)}function du(_){for(;_!=null;_=_.nextSibling){var S=_.nodeType;if(S===1||S===3)break;if(S===8){if(S=_.data,S==="$"||S==="$!"||S==="$?")break;if(S==="/$")return null}}return _}function ng(_){_=_.previousSibling;for(var S=0;_;){if(_.nodeType===8){var A=_.data;if(A==="$"||A==="$!"||A==="$?"){if(S===0)return _;S--}else A==="/$"&&S++}_=_.previousSibling}return null}var zc=Math.random().toString(36).slice(2),jl="__reactFiber$"+zc,hd="__reactProps$"+zc,Fc="__reactContainer$"+zc,Vh="__reactEvents$"+zc,Yf="__reactListeners$"+zc,E_="__reactHandles$"+zc;function fd(_){var S=_[jl];if(S)return S;for(var A=_.parentNode;A;){if(S=A[Fc]||A[jl]){if(A=S.alternate,S.child!==null||A!==null&&A.child!==null)for(_=ng(_);_!==null;){if(A=_[jl])return A;_=ng(_)}return S}_=A,A=_.parentNode}return null}function Uh(_){return _=_[jl]||_[Fc],!_||_.tag!==5&&_.tag!==6&&_.tag!==13&&_.tag!==3?null:_}function kc(_){if(_.tag===5||_.tag===6)return _.stateNode;throw Error(a(33))}function Hd(_){return _[hd]||null}var ig=[],Yd=-1;function pd(_){return{current:_}}function Po(_){0>Yd||(_.current=ig[Yd],ig[Yd]=null,Yd--)}function vo(_,S){Yd++,ig[Yd]=_.current,_.current=S}var Bc={},Hs=pd(Bc),Ls=pd(!1),ku=Bc;function Zd(_,S){var A=_.type.contextTypes;if(!A)return Bc;var N=_.stateNode;if(N&&N.__reactInternalMemoizedUnmaskedChildContext===S)return N.__reactInternalMemoizedMaskedChildContext;var K={},oe;for(oe in A)K[oe]=S[oe];return N&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=S,_.__reactInternalMemoizedMaskedChildContext=K),K}function ua(_){return _=_.childContextTypes,_!=null}function hu(){Po(Ls),Po(Hs)}function Zf(_,S,A){if(Hs.current!==Bc)throw Error(a(168));vo(Hs,S),vo(Ls,A)}function yl(_,S,A){var N=_.stateNode;if(S=S.childContextTypes,typeof N.getChildContext!="function")return A;N=N.getChildContext();for(var K in N)if(!(K in S))throw Error(a(108,hr(_)||"Unknown",K));return Gt({},A,N)}function $h(_){return _=(_=_.stateNode)&&_.__reactInternalMemoizedMergedChildContext||Bc,ku=Hs.current,vo(Hs,_),vo(Ls,Ls.current),!0}function Wh(_,S,A){var N=_.stateNode;if(!N)throw Error(a(169));A?(_=yl(_,S,ku),N.__reactInternalMemoizedMergedChildContext=_,Po(Ls),Po(Hs),vo(Hs,_)):Po(Ls),vo(Ls,A)}var Nl=null,qh=!1,Xf=!1;function Xp(_){Nl===null?Nl=[_]:Nl.push(_)}function Kf(_){qh=!0,Xp(_)}function jc(){if(!Xf&&Nl!==null){Xf=!0;var _=0,S=yi;try{var A=Nl;for(yi=1;_<A.length;_++){var N=A[_];do N=N(!0);while(N!==null)}Nl=null,qh=!1}catch(K){throw Nl!==null&&(Nl=Nl.slice(_+1)),Ot(Zr,jc),K}finally{yi=S,Xf=!1}}return null}var Nc=[],Bu=0,Xd=null,Qf=0,Vl=[],Pa=0,md=null,fu=1,ju="";function Kd(_,S){Nc[Bu++]=Qf,Nc[Bu++]=Xd,Xd=_,Qf=S}function P_(_,S,A){Vl[Pa++]=fu,Vl[Pa++]=ju,Vl[Pa++]=md,md=_;var N=fu;_=ju;var K=32-rn(N)-1;N&=~(1<<K),A+=1;var oe=32-rn(S)+K;if(30<oe){var Ee=K-K%5;oe=(N&(1<<Ee)-1).toString(32),N>>=Ee,K-=Ee,fu=1<<32-rn(S)+K|A<<K|N,ju=oe+_}else fu=1<<oe|A<<K|N,ju=_}function Gh(_){_.return!==null&&(Kd(_,1),P_(_,1,0))}function Jf(_){for(;_===Xd;)Xd=Nc[--Bu],Nc[Bu]=null,Qf=Nc[--Bu],Nc[Bu]=null;for(;_===md;)md=Vl[--Pa],Vl[Pa]=null,ju=Vl[--Pa],Vl[Pa]=null,fu=Vl[--Pa],Vl[Pa]=null}var Ja=null,vl=null,go=!1,Ul=null;function og(_,S){var A=yn(5,null,null,0);A.elementType="DELETED",A.stateNode=S,A.return=_,S=_.deletions,S===null?(_.deletions=[A],_.flags|=16):S.push(A)}function sg(_,S){switch(_.tag){case 5:var A=_.type;return S=S.nodeType!==1||A.toLowerCase()!==S.nodeName.toLowerCase()?null:S,S!==null?(_.stateNode=S,Ja=_,vl=du(S.firstChild),!0):!1;case 6:return S=_.pendingProps===""||S.nodeType!==3?null:S,S!==null?(_.stateNode=S,Ja=_,vl=null,!0):!1;case 13:return S=S.nodeType!==8?null:S,S!==null?(A=md!==null?{id:fu,overflow:ju}:null,_.memoizedState={dehydrated:S,treeContext:A,retryLane:1073741824},A=yn(18,null,null,0),A.stateNode=S,A.return=_,_.child=A,Ja=_,vl=null,!0):!1;default:return!1}}function Hh(_){return(_.mode&1)!==0&&(_.flags&128)===0}function Vc(_){if(go){var S=vl;if(S){var A=S;if(!sg(_,S)){if(Hh(_))throw Error(a(418));S=du(A.nextSibling);var N=Ja;S&&sg(_,S)?og(N,A):(_.flags=_.flags&-4097|2,go=!1,Ja=_)}}else{if(Hh(_))throw Error(a(418));_.flags=_.flags&-4097|2,go=!1,Ja=_}}}function Yh(_){for(_=_.return;_!==null&&_.tag!==5&&_.tag!==3&&_.tag!==13;)_=_.return;Ja=_}function Qd(_){if(_!==Ja)return!1;if(!go)return Yh(_),go=!0,!1;var S;if((S=_.tag!==3)&&!(S=_.tag!==5)&&(S=_.type,S=S!=="head"&&S!=="body"&&!jh(_.type,_.memoizedProps)),S&&(S=vl)){if(Hh(_))throw gd(),Error(a(418));for(;S;)og(_,S),S=du(S.nextSibling)}if(Yh(_),_.tag===13){if(_=_.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(a(317));e:{for(_=_.nextSibling,S=0;_;){if(_.nodeType===8){var A=_.data;if(A==="/$"){if(S===0){vl=du(_.nextSibling);break e}S--}else A!=="$"&&A!=="$!"&&A!=="$?"||S++}_=_.nextSibling}vl=null}}else vl=Ja?du(_.stateNode.nextSibling):null;return!0}function gd(){for(var _=vl;_;)_=du(_.nextSibling)}function $l(){vl=Ja=null,go=!1}function ep(_){Ul===null?Ul=[_]:Ul.push(_)}var Kp=Ne.ReactCurrentBatchConfig;function Jd(_,S,A){if(_=A.ref,_!==null&&typeof _!="function"&&typeof _!="object"){if(A._owner){if(A=A._owner,A){if(A.tag!==1)throw Error(a(309));var N=A.stateNode}if(!N)throw Error(a(147,_));var K=N,oe=""+_;return S!==null&&S.ref!==null&&typeof S.ref=="function"&&S.ref._stringRef===oe?S.ref:(S=function(Ee){var Ke=K.refs;Ee===null?delete Ke[oe]:Ke[oe]=Ee},S._stringRef=oe,S)}if(typeof _!="string")throw Error(a(284));if(!A._owner)throw Error(a(290,_))}return _}function Zh(_,S){throw _=Object.prototype.toString.call(S),Error(a(31,_==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":_))}function tp(_){var S=_._init;return S(_._payload)}function rp(_){function S(Lt,vt){if(_){var Bt=Lt.deletions;Bt===null?(Lt.deletions=[vt],Lt.flags|=16):Bt.push(vt)}}function A(Lt,vt){if(!_)return null;for(;vt!==null;)S(Lt,vt),vt=vt.sibling;return null}function N(Lt,vt){for(Lt=new Map;vt!==null;)vt.key!==null?Lt.set(vt.key,vt):Lt.set(vt.index,vt),vt=vt.sibling;return Lt}function K(Lt,vt){return Lt=Jr(Lt,vt),Lt.index=0,Lt.sibling=null,Lt}function oe(Lt,vt,Bt){return Lt.index=Bt,_?(Bt=Lt.alternate,Bt!==null?(Bt=Bt.index,Bt<vt?(Lt.flags|=2,vt):Bt):(Lt.flags|=2,vt)):(Lt.flags|=1048576,vt)}function Ee(Lt){return _&&Lt.alternate===null&&(Lt.flags|=2),Lt}function Ke(Lt,vt,Bt,kr){return vt===null||vt.tag!==6?(vt=En(Bt,Lt.mode,kr),vt.return=Lt,vt):(vt=K(vt,Bt),vt.return=Lt,vt)}function ut(Lt,vt,Bt,kr){var mn=Bt.type;return mn===ke?Er(Lt,vt,Bt.props.children,kr,Bt.key):vt!==null&&(vt.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===or&&tp(mn)===vt.type)?(kr=K(vt,Bt.props),kr.ref=Jd(Lt,vt,Bt),kr.return=Lt,kr):(kr=xi(Bt.type,Bt.key,Bt.props,null,Lt.mode,kr),kr.ref=Jd(Lt,vt,Bt),kr.return=Lt,kr)}function Yt(Lt,vt,Bt,kr){return vt===null||vt.tag!==4||vt.stateNode.containerInfo!==Bt.containerInfo||vt.stateNode.implementation!==Bt.implementation?(vt=zi(Bt,Lt.mode,kr),vt.return=Lt,vt):(vt=K(vt,Bt.children||[]),vt.return=Lt,vt)}function Er(Lt,vt,Bt,kr,mn){return vt===null||vt.tag!==7?(vt=Pn(Bt,Lt.mode,kr,mn),vt.return=Lt,vt):(vt=K(vt,Bt),vt.return=Lt,vt)}function Ar(Lt,vt,Bt){if(typeof vt=="string"&&vt!==""||typeof vt=="number")return vt=En(""+vt,Lt.mode,Bt),vt.return=Lt,vt;if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case _e:return Bt=xi(vt.type,vt.key,vt.props,null,Lt.mode,Bt),Bt.ref=Jd(Lt,null,vt),Bt.return=Lt,Bt;case Re:return vt=zi(vt,Lt.mode,Bt),vt.return=Lt,vt;case or:var kr=vt._init;return Ar(Lt,kr(vt._payload),Bt)}if(Lo(vt)||qt(vt))return vt=Pn(vt,Lt.mode,Bt,null),vt.return=Lt,vt;Zh(Lt,vt)}return null}function Pr(Lt,vt,Bt,kr){var mn=vt!==null?vt.key:null;if(typeof Bt=="string"&&Bt!==""||typeof Bt=="number")return mn!==null?null:Ke(Lt,vt,""+Bt,kr);if(typeof Bt=="object"&&Bt!==null){switch(Bt.$$typeof){case _e:return Bt.key===mn?ut(Lt,vt,Bt,kr):null;case Re:return Bt.key===mn?Yt(Lt,vt,Bt,kr):null;case or:return mn=Bt._init,Pr(Lt,vt,mn(Bt._payload),kr)}if(Lo(Bt)||qt(Bt))return mn!==null?null:Er(Lt,vt,Bt,kr,null);Zh(Lt,Bt)}return null}function un(Lt,vt,Bt,kr,mn){if(typeof kr=="string"&&kr!==""||typeof kr=="number")return Lt=Lt.get(Bt)||null,Ke(vt,Lt,""+kr,mn);if(typeof kr=="object"&&kr!==null){switch(kr.$$typeof){case _e:return Lt=Lt.get(kr.key===null?Bt:kr.key)||null,ut(vt,Lt,kr,mn);case Re:return Lt=Lt.get(kr.key===null?Bt:kr.key)||null,Yt(vt,Lt,kr,mn);case or:var In=kr._init;return un(Lt,vt,Bt,In(kr._payload),mn)}if(Lo(kr)||qt(kr))return Lt=Lt.get(Bt)||null,Er(vt,Lt,kr,mn,null);Zh(vt,kr)}return null}function fn(Lt,vt,Bt,kr){for(var mn=null,In=null,Rn=vt,Gn=vt=0,fa=null;Rn!==null&&Gn<Bt.length;Gn++){Rn.index>Gn?(fa=Rn,Rn=null):fa=Rn.sibling;var ro=Pr(Lt,Rn,Bt[Gn],kr);if(ro===null){Rn===null&&(Rn=fa);break}_&&Rn&&ro.alternate===null&&S(Lt,Rn),vt=oe(ro,vt,Gn),In===null?mn=ro:In.sibling=ro,In=ro,Rn=fa}if(Gn===Bt.length)return A(Lt,Rn),go&&Kd(Lt,Gn),mn;if(Rn===null){for(;Gn<Bt.length;Gn++)Rn=Ar(Lt,Bt[Gn],kr),Rn!==null&&(vt=oe(Rn,vt,Gn),In===null?mn=Rn:In.sibling=Rn,In=Rn);return go&&Kd(Lt,Gn),mn}for(Rn=N(Lt,Rn);Gn<Bt.length;Gn++)fa=un(Rn,Lt,Gn,Bt[Gn],kr),fa!==null&&(_&&fa.alternate!==null&&Rn.delete(fa.key===null?Gn:fa.key),vt=oe(fa,vt,Gn),In===null?mn=fa:In.sibling=fa,In=fa);return _&&Rn.forEach(function(ph){return S(Lt,ph)}),go&&Kd(Lt,Gn),mn}function an(Lt,vt,Bt,kr){var mn=qt(Bt);if(typeof mn!="function")throw Error(a(150));if(Bt=mn.call(Bt),Bt==null)throw Error(a(151));for(var In=mn=null,Rn=vt,Gn=vt=0,fa=null,ro=Bt.next();Rn!==null&&!ro.done;Gn++,ro=Bt.next()){Rn.index>Gn?(fa=Rn,Rn=null):fa=Rn.sibling;var ph=Pr(Lt,Rn,ro.value,kr);if(ph===null){Rn===null&&(Rn=fa);break}_&&Rn&&ph.alternate===null&&S(Lt,Rn),vt=oe(ph,vt,Gn),In===null?mn=ph:In.sibling=ph,In=ph,Rn=fa}if(ro.done)return A(Lt,Rn),go&&Kd(Lt,Gn),mn;if(Rn===null){for(;!ro.done;Gn++,ro=Bt.next())ro=Ar(Lt,ro.value,kr),ro!==null&&(vt=oe(ro,vt,Gn),In===null?mn=ro:In.sibling=ro,In=ro);return go&&Kd(Lt,Gn),mn}for(Rn=N(Lt,Rn);!ro.done;Gn++,ro=Bt.next())ro=un(Rn,Lt,Gn,ro.value,kr),ro!==null&&(_&&ro.alternate!==null&&Rn.delete(ro.key===null?Gn:ro.key),vt=oe(ro,vt,Gn),In===null?mn=ro:In.sibling=ro,In=ro);return _&&Rn.forEach(function(jx){return S(Lt,jx)}),go&&Kd(Lt,Gn),mn}function Io(Lt,vt,Bt,kr){if(typeof Bt=="object"&&Bt!==null&&Bt.type===ke&&Bt.key===null&&(Bt=Bt.props.children),typeof Bt=="object"&&Bt!==null){switch(Bt.$$typeof){case _e:e:{for(var mn=Bt.key,In=vt;In!==null;){if(In.key===mn){if(mn=Bt.type,mn===ke){if(In.tag===7){A(Lt,In.sibling),vt=K(In,Bt.props.children),vt.return=Lt,Lt=vt;break e}}else if(In.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===or&&tp(mn)===In.type){A(Lt,In.sibling),vt=K(In,Bt.props),vt.ref=Jd(Lt,In,Bt),vt.return=Lt,Lt=vt;break e}A(Lt,In);break}else S(Lt,In);In=In.sibling}Bt.type===ke?(vt=Pn(Bt.props.children,Lt.mode,kr,Bt.key),vt.return=Lt,Lt=vt):(kr=xi(Bt.type,Bt.key,Bt.props,null,Lt.mode,kr),kr.ref=Jd(Lt,vt,Bt),kr.return=Lt,Lt=kr)}return Ee(Lt);case Re:e:{for(In=Bt.key;vt!==null;){if(vt.key===In)if(vt.tag===4&&vt.stateNode.containerInfo===Bt.containerInfo&&vt.stateNode.implementation===Bt.implementation){A(Lt,vt.sibling),vt=K(vt,Bt.children||[]),vt.return=Lt,Lt=vt;break e}else{A(Lt,vt);break}else S(Lt,vt);vt=vt.sibling}vt=zi(Bt,Lt.mode,kr),vt.return=Lt,Lt=vt}return Ee(Lt);case or:return In=Bt._init,Io(Lt,vt,In(Bt._payload),kr)}if(Lo(Bt))return fn(Lt,vt,Bt,kr);if(qt(Bt))return an(Lt,vt,Bt,kr);Zh(Lt,Bt)}return typeof Bt=="string"&&Bt!==""||typeof Bt=="number"?(Bt=""+Bt,vt!==null&&vt.tag===6?(A(Lt,vt.sibling),vt=K(vt,Bt),vt.return=Lt,Lt=vt):(A(Lt,vt),vt=En(Bt,Lt.mode,kr),vt.return=Lt,Lt=vt),Ee(Lt)):A(Lt,vt)}return Io}var _d=rp(!0),np=rp(!1),Nu=pd(null),Qp=null,Wl=null,Jp=null;function ag(){Jp=Wl=Qp=null}function Xh(_){var S=Nu.current;Po(Nu),_._currentValue=S}function Kh(_,S,A){for(;_!==null;){var N=_.alternate;if((_.childLanes&S)!==S?(_.childLanes|=S,N!==null&&(N.childLanes|=S)):N!==null&&(N.childLanes&S)!==S&&(N.childLanes|=S),_===A)break;_=_.return}}function el(_,S){Qp=_,Jp=Wl=null,_=_.dependencies,_!==null&&_.firstContext!==null&&((_.lanes&S)!==0&&(Zs=!0),_.firstContext=null)}function Va(_){var S=_._currentValue;if(Jp!==_)if(_={context:_,memoizedValue:S,next:null},Wl===null){if(Qp===null)throw Error(a(308));Wl=_,Qp.dependencies={lanes:0,firstContext:_}}else Wl=Wl.next=_;return S}var xl=null;function ip(_){xl===null?xl=[_]:xl.push(_)}function op(_,S,A,N){var K=S.interleaved;return K===null?(A.next=A,ip(S)):(A.next=K.next,K.next=A),S.interleaved=A,pc(_,N)}function pc(_,S){_.lanes|=S;var A=_.alternate;for(A!==null&&(A.lanes|=S),A=_,_=_.return;_!==null;)_.childLanes|=S,A=_.alternate,A!==null&&(A.childLanes|=S),A=_,_=_.return;return A.tag===3?A.stateNode:null}var mc=!1;function Qh(_){_.updateQueue={baseState:_.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lg(_,S){_=_.updateQueue,S.updateQueue===_&&(S.updateQueue={baseState:_.baseState,firstBaseUpdate:_.firstBaseUpdate,lastBaseUpdate:_.lastBaseUpdate,shared:_.shared,effects:_.effects})}function tl(_,S){return{eventTime:_,lane:S,tag:0,payload:null,callback:null,next:null}}function ql(_,S,A){var N=_.updateQueue;if(N===null)return null;if(N=N.shared,(Ki&2)!==0){var K=N.pending;return K===null?S.next=S:(S.next=K.next,K.next=S),N.pending=S,pc(_,A)}return K=N.interleaved,K===null?(S.next=S,ip(N)):(S.next=K.next,K.next=S),N.interleaved=S,pc(_,A)}function cr(_,S,A){if(S=S.updateQueue,S!==null&&(S=S.shared,(A&4194240)!==0)){var N=S.lanes;N&=_.pendingLanes,A|=N,S.lanes=A,nc(_,A)}}function em(_,S){var A=_.updateQueue,N=_.alternate;if(N!==null&&(N=N.updateQueue,A===N)){var K=null,oe=null;if(A=A.firstBaseUpdate,A!==null){do{var Ee={eventTime:A.eventTime,lane:A.lane,tag:A.tag,payload:A.payload,callback:A.callback,next:null};oe===null?K=oe=Ee:oe=oe.next=Ee,A=A.next}while(A!==null);oe===null?K=oe=S:oe=oe.next=S}else K=oe=S;A={baseState:N.baseState,firstBaseUpdate:K,lastBaseUpdate:oe,shared:N.shared,effects:N.effects},_.updateQueue=A;return}_=A.lastBaseUpdate,_===null?A.firstBaseUpdate=S:_.next=S,A.lastBaseUpdate=S}function gc(_,S,A,N){var K=_.updateQueue;mc=!1;var oe=K.firstBaseUpdate,Ee=K.lastBaseUpdate,Ke=K.shared.pending;if(Ke!==null){K.shared.pending=null;var ut=Ke,Yt=ut.next;ut.next=null,Ee===null?oe=Yt:Ee.next=Yt,Ee=ut;var Er=_.alternate;Er!==null&&(Er=Er.updateQueue,Ke=Er.lastBaseUpdate,Ke!==Ee&&(Ke===null?Er.firstBaseUpdate=Yt:Ke.next=Yt,Er.lastBaseUpdate=ut))}if(oe!==null){var Ar=K.baseState;Ee=0,Er=Yt=ut=null,Ke=oe;do{var Pr=Ke.lane,un=Ke.eventTime;if((N&Pr)===Pr){Er!==null&&(Er=Er.next={eventTime:un,lane:0,tag:Ke.tag,payload:Ke.payload,callback:Ke.callback,next:null});e:{var fn=_,an=Ke;switch(Pr=S,un=A,an.tag){case 1:if(fn=an.payload,typeof fn=="function"){Ar=fn.call(un,Ar,Pr);break e}Ar=fn;break e;case 3:fn.flags=fn.flags&-65537|128;case 0:if(fn=an.payload,Pr=typeof fn=="function"?fn.call(un,Ar,Pr):fn,Pr==null)break e;Ar=Gt({},Ar,Pr);break e;case 2:mc=!0}}Ke.callback!==null&&Ke.lane!==0&&(_.flags|=64,Pr=K.effects,Pr===null?K.effects=[Ke]:Pr.push(Ke))}else un={eventTime:un,lane:Pr,tag:Ke.tag,payload:Ke.payload,callback:Ke.callback,next:null},Er===null?(Yt=Er=un,ut=Ar):Er=Er.next=un,Ee|=Pr;if(Ke=Ke.next,Ke===null){if(Ke=K.shared.pending,Ke===null)break;Pr=Ke,Ke=Pr.next,Pr.next=null,K.lastBaseUpdate=Pr,K.shared.pending=null}}while(!0);if(Er===null&&(ut=Ar),K.baseState=ut,K.firstBaseUpdate=Yt,K.lastBaseUpdate=Er,S=K.shared.interleaved,S!==null){K=S;do Ee|=K.lane,K=K.next;while(K!==S)}else oe===null&&(K.shared.lanes=0);v|=Ee,_.lanes=Ee,_.memoizedState=Ar}}function Vu(_,S,A){if(_=S.effects,S.effects=null,_!==null)for(S=0;S<_.length;S++){var N=_[S],K=N.callback;if(K!==null){if(N.callback=null,N=A,typeof K!="function")throw Error(a(191,K));K.call(N)}}}var _c={},Mr=pd(_c),eh=pd(_c),Jh=pd(_c);function pu(_){if(_===_c)throw Error(a(174));return _}function ef(_,S){switch(vo(Jh,S),vo(eh,_),vo(Mr,_c),_=S.nodeType,_){case 9:case 11:S=(S=S.documentElement)?S.namespaceURI:xa(null,"");break;default:_=_===8?S.parentNode:S,S=_.namespaceURI||null,_=_.tagName,S=xa(S,_)}Po(Mr),vo(Mr,S)}function yd(){Po(Mr),Po(eh),Po(Jh)}function tm(_){pu(Jh.current);var S=pu(Mr.current),A=xa(S,_.type);S!==A&&(vo(eh,_),vo(Mr,A))}function rm(_){eh.current===_&&(Po(Mr),Po(eh))}var rs=pd(0);function nm(_){for(var S=_;S!==null;){if(S.tag===13){var A=S.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||A.data==="$!"))return S}else if(S.tag===19&&S.memoizedProps.revealOrder!==void 0){if((S.flags&128)!==0)return S}else if(S.child!==null){S.child.return=S,S=S.child;continue}if(S===_)break;for(;S.sibling===null;){if(S.return===null||S.return===_)return null;S=S.return}S.sibling.return=S.return,S=S.sibling}return null}var Ua=[];function sp(){for(var _=0;_<Ua.length;_++)Ua[_]._workInProgressVersionPrimary=null;Ua.length=0}var Ys=Ne.ReactCurrentDispatcher,mu=Ne.ReactCurrentBatchConfig,vd=0,$o=null,_s=null,zs=null,tf=!1,da=!1,mi=0,ap=0;function ys(){throw Error(a(321))}function im(_,S){if(S===null)return!1;for(var A=0;A<S.length&&A<_.length;A++)if(!ca(_[A],S[A]))return!1;return!0}function om(_,S,A,N,K,oe){if(vd=oe,$o=S,S.memoizedState=null,S.updateQueue=null,S.lanes=0,Ys.current=_===null||_.memoizedState===null?pg:nl,_=A(N,K),da){oe=0;do{if(da=!1,mi=0,25<=oe)throw Error(a(301));oe+=1,zs=_s=null,S.updateQueue=null,Ys.current=sh,_=A(N,K)}while(da)}if(Ys.current=pn,S=_s!==null&&_s.next!==null,vd=0,zs=_s=$o=null,tf=!1,S)throw Error(a(300));return _}function Uc(){var _=mi!==0;return mi=0,_}function yc(){var _={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zs===null?$o.memoizedState=zs=_:zs=zs.next=_,zs}function ns(){if(_s===null){var _=$o.alternate;_=_!==null?_.memoizedState:null}else _=_s.next;var S=zs===null?$o.memoizedState:zs.next;if(S!==null)zs=S,_s=_;else{if(_===null)throw Error(a(310));_s=_,_={memoizedState:_s.memoizedState,baseState:_s.baseState,baseQueue:_s.baseQueue,queue:_s.queue,next:null},zs===null?$o.memoizedState=zs=_:zs=zs.next=_}return zs}function $c(_,S){return typeof S=="function"?S(_):S}function zt(_){var S=ns(),A=S.queue;if(A===null)throw Error(a(311));A.lastRenderedReducer=_;var N=_s,K=N.baseQueue,oe=A.pending;if(oe!==null){if(K!==null){var Ee=K.next;K.next=oe.next,oe.next=Ee}N.baseQueue=K=oe,A.pending=null}if(K!==null){oe=K.next,N=N.baseState;var Ke=Ee=null,ut=null,Yt=oe;do{var Er=Yt.lane;if((vd&Er)===Er)ut!==null&&(ut=ut.next={lane:0,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null}),N=Yt.hasEagerState?Yt.eagerState:_(N,Yt.action);else{var Ar={lane:Er,action:Yt.action,hasEagerState:Yt.hasEagerState,eagerState:Yt.eagerState,next:null};ut===null?(Ke=ut=Ar,Ee=N):ut=ut.next=Ar,$o.lanes|=Er,v|=Er}Yt=Yt.next}while(Yt!==null&&Yt!==oe);ut===null?Ee=N:ut.next=Ke,ca(N,S.memoizedState)||(Zs=!0),S.memoizedState=N,S.baseState=Ee,S.baseQueue=ut,A.lastRenderedState=N}if(_=A.interleaved,_!==null){K=_;do oe=K.lane,$o.lanes|=oe,v|=oe,K=K.next;while(K!==_)}else K===null&&(A.lanes=0);return[S.memoizedState,A.dispatch]}function tr(_){var S=ns(),A=S.queue;if(A===null)throw Error(a(311));A.lastRenderedReducer=_;var N=A.dispatch,K=A.pending,oe=S.memoizedState;if(K!==null){A.pending=null;var Ee=K=K.next;do oe=_(oe,Ee.action),Ee=Ee.next;while(Ee!==K);ca(oe,S.memoizedState)||(Zs=!0),S.memoizedState=oe,S.baseQueue===null&&(S.baseState=oe),A.lastRenderedState=oe}return[oe,N]}function th(){}function to(_,S){var A=$o,N=ns(),K=S(),oe=!ca(N.memoizedState,K);if(oe&&(N.memoizedState=K,Zs=!0),N=N.queue,rl(rh.bind(null,A,N,_),[_]),N.getSnapshot!==S||oe||zs!==null&&zs.memoizedState.tag&1){if(A.flags|=2048,gu(9,sm.bind(null,A,N,K,S),void 0,null),ha===null)throw Error(a(349));(vd&30)!==0||Ye(A,S,K)}return K}function Ye(_,S,A){_.flags|=16384,_={getSnapshot:S,value:A},S=$o.updateQueue,S===null?(S={lastEffect:null,stores:null},$o.updateQueue=S,S.stores=[_]):(A=S.stores,A===null?S.stores=[_]:A.push(_))}function sm(_,S,A,N){S.value=A,S.getSnapshot=N,nh(S)&&lp(_)}function rh(_,S,A){return A(function(){nh(S)&&lp(_)})}function nh(_){var S=_.getSnapshot;_=_.value;try{var A=S();return!ca(_,A)}catch{return!0}}function lp(_){var S=pc(_,1);S!==null&&Te(S,_,1,-1)}function cp(_){var S=yc();return typeof _=="function"&&(_=_()),S.memoizedState=S.baseState=_,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$c,lastRenderedState:_},S.queue=_,_=_.dispatch=Ia.bind(null,$o,_),[S.memoizedState,_]}function gu(_,S,A,N){return _={tag:_,create:S,destroy:A,deps:N,next:null},S=$o.updateQueue,S===null?(S={lastEffect:null,stores:null},$o.updateQueue=S,S.lastEffect=_.next=_):(A=S.lastEffect,A===null?S.lastEffect=_.next=_:(N=A.next,A.next=_,_.next=N,S.lastEffect=_)),_}function ih(){return ns().memoizedState}function am(_,S,A,N){var K=yc();$o.flags|=_,K.memoizedState=gu(1|S,A,void 0,N===void 0?null:N)}function up(_,S,A,N){var K=ns();N=N===void 0?null:N;var oe=void 0;if(_s!==null){var Ee=_s.memoizedState;if(oe=Ee.destroy,N!==null&&im(N,Ee.deps)){K.memoizedState=gu(S,A,oe,N);return}}$o.flags|=_,K.memoizedState=gu(1|S,A,oe,N)}function cg(_,S){return am(8390656,8,_,S)}function rl(_,S){return up(2048,8,_,S)}function lm(_,S){return up(4,2,_,S)}function cm(_,S){return up(4,4,_,S)}function ug(_,S){if(typeof S=="function")return _=_(),S(_),function(){S(null)};if(S!=null)return _=_(),S.current=_,function(){S.current=null}}function dp(_,S,A){return A=A!=null?A.concat([_]):null,up(4,4,ug.bind(null,S,_),A)}function oh(){}function xd(_,S){var A=ns();S=S===void 0?null:S;var N=A.memoizedState;return N!==null&&S!==null&&im(S,N[1])?N[0]:(A.memoizedState=[_,S],_)}function dg(_,S){var A=ns();S=S===void 0?null:S;var N=A.memoizedState;return N!==null&&S!==null&&im(S,N[1])?N[0]:(_=_(),A.memoizedState=[_,S],_)}function hg(_,S,A){return(vd&21)===0?(_.baseState&&(_.baseState=!1,Zs=!0),_.memoizedState=A):(ca(A,S)||(A=Jo(),$o.lanes|=A,v|=A,_.baseState=!0),S)}function sv(_,S){var A=yi;yi=A!==0&&4>A?A:4,_(!0);var N=mu.transition;mu.transition={};try{_(!1),S()}finally{yi=A,mu.transition=N}}function fg(){return ns().memoizedState}function av(_,S,A){var N=Ce(_);if(A={lane:N,action:A,hasEagerState:!1,eagerState:null,next:null},I_(_))rf(S,A);else if(A=op(_,S,A,N),A!==null){var K=xe();Te(A,_,N,K),Ci(A,S,N)}}function Ia(_,S,A){var N=Ce(_),K={lane:N,action:A,hasEagerState:!1,eagerState:null,next:null};if(I_(_))rf(S,K);else{var oe=_.alternate;if(_.lanes===0&&(oe===null||oe.lanes===0)&&(oe=S.lastRenderedReducer,oe!==null))try{var Ee=S.lastRenderedState,Ke=oe(Ee,A);if(K.hasEagerState=!0,K.eagerState=Ke,ca(Ke,Ee)){var ut=S.interleaved;ut===null?(K.next=K,ip(S)):(K.next=ut.next,ut.next=K),S.interleaved=K;return}}catch{}finally{}A=op(_,S,K,N),A!==null&&(K=xe(),Te(A,_,N,K),Ci(A,S,N))}}function I_(_){var S=_.alternate;return _===$o||S!==null&&S===$o}function rf(_,S){da=tf=!0;var A=_.pending;A===null?S.next=S:(S.next=A.next,A.next=S),_.pending=S}function Ci(_,S,A){if((A&4194240)!==0){var N=S.lanes;N&=_.pendingLanes,A|=N,S.lanes=A,nc(_,A)}}var pn={readContext:Va,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useInsertionEffect:ys,useLayoutEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useMutableSource:ys,useSyncExternalStore:ys,useId:ys,unstable_isNewReconciler:!1},pg={readContext:Va,useCallback:function(_,S){return yc().memoizedState=[_,S===void 0?null:S],_},useContext:Va,useEffect:cg,useImperativeHandle:function(_,S,A){return A=A!=null?A.concat([_]):null,am(4194308,4,ug.bind(null,S,_),A)},useLayoutEffect:function(_,S){return am(4194308,4,_,S)},useInsertionEffect:function(_,S){return am(4,2,_,S)},useMemo:function(_,S){var A=yc();return S=S===void 0?null:S,_=_(),A.memoizedState=[_,S],_},useReducer:function(_,S,A){var N=yc();return S=A!==void 0?A(S):S,N.memoizedState=N.baseState=S,_={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_,lastRenderedState:S},N.queue=_,_=_.dispatch=av.bind(null,$o,_),[N.memoizedState,_]},useRef:function(_){var S=yc();return _={current:_},S.memoizedState=_},useState:cp,useDebugValue:oh,useDeferredValue:function(_){return yc().memoizedState=_},useTransition:function(){var _=cp(!1),S=_[0];return _=sv.bind(null,_[1]),yc().memoizedState=_,[S,_]},useMutableSource:function(){},useSyncExternalStore:function(_,S,A){var N=$o,K=yc();if(go){if(A===void 0)throw Error(a(407));A=A()}else{if(A=S(),ha===null)throw Error(a(349));(vd&30)!==0||Ye(N,S,A)}K.memoizedState=A;var oe={value:A,getSnapshot:S};return K.queue=oe,cg(rh.bind(null,N,oe,_),[_]),N.flags|=2048,gu(9,sm.bind(null,N,oe,A,S),void 0,null),A},useId:function(){var _=yc(),S=ha.identifierPrefix;if(go){var A=ju,N=fu;A=(N&~(1<<32-rn(N)-1)).toString(32)+A,S=":"+S+"R"+A,A=mi++,0<A&&(S+="H"+A.toString(32)),S+=":"}else A=ap++,S=":"+S+"r"+A.toString(32)+":";return _.memoizedState=S},unstable_isNewReconciler:!1},nl={readContext:Va,useCallback:xd,useContext:Va,useEffect:rl,useImperativeHandle:dp,useInsertionEffect:lm,useLayoutEffect:cm,useMemo:dg,useReducer:zt,useRef:ih,useState:function(){return zt($c)},useDebugValue:oh,useDeferredValue:function(_){var S=ns();return hg(S,_s.memoizedState,_)},useTransition:function(){var _=zt($c)[0],S=ns().memoizedState;return[_,S]},useMutableSource:th,useSyncExternalStore:to,useId:fg,unstable_isNewReconciler:!1},sh={readContext:Va,useCallback:xd,useContext:Va,useEffect:rl,useImperativeHandle:dp,useInsertionEffect:lm,useLayoutEffect:cm,useMemo:dg,useReducer:tr,useRef:ih,useState:function(){return tr($c)},useDebugValue:oh,useDeferredValue:function(_){var S=ns();return _s===null?S.memoizedState=_:hg(S,_s.memoizedState,_)},useTransition:function(){var _=tr($c)[0],S=ns().memoizedState;return[_,S]},useMutableSource:th,useSyncExternalStore:to,useId:fg,unstable_isNewReconciler:!1};function $a(_,S){if(_&&_.defaultProps){S=Gt({},S),_=_.defaultProps;for(var A in _)S[A]===void 0&&(S[A]=_[A]);return S}return S}function Wc(_,S,A,N){S=_.memoizedState,A=A(N,S),A=A==null?S:Gt({},S,A),_.memoizedState=A,_.lanes===0&&(_.updateQueue.baseState=A)}var nf={isMounted:function(_){return(_=_._reactInternals)?Oe(_)===_:!1},enqueueSetState:function(_,S,A){_=_._reactInternals;var N=xe(),K=Ce(_),oe=tl(N,K);oe.payload=S,A!=null&&(oe.callback=A),S=ql(_,oe,K),S!==null&&(Te(S,_,K,N),cr(S,_,K))},enqueueReplaceState:function(_,S,A){_=_._reactInternals;var N=xe(),K=Ce(_),oe=tl(N,K);oe.tag=1,oe.payload=S,A!=null&&(oe.callback=A),S=ql(_,oe,K),S!==null&&(Te(S,_,K,N),cr(S,_,K))},enqueueForceUpdate:function(_,S){_=_._reactInternals;var A=xe(),N=Ce(_),K=tl(A,N);K.tag=2,S!=null&&(K.callback=S),S=ql(_,K,N),S!==null&&(Te(S,_,N,A),cr(S,_,N))}};function um(_,S,A,N,K,oe,Ee){return _=_.stateNode,typeof _.shouldComponentUpdate=="function"?_.shouldComponentUpdate(N,oe,Ee):S.prototype&&S.prototype.isPureReactComponent?!Fl(A,N)||!Fl(K,oe):!0}function hp(_,S,A){var N=!1,K=Bc,oe=S.contextType;return typeof oe=="object"&&oe!==null?oe=Va(oe):(K=ua(S)?ku:Hs.current,N=S.contextTypes,oe=(N=N!=null)?Zd(_,K):Bc),S=new S(A,oe),_.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=nf,_.stateNode=S,S._reactInternals=_,N&&(_=_.stateNode,_.__reactInternalMemoizedUnmaskedChildContext=K,_.__reactInternalMemoizedMaskedChildContext=oe),S}function fp(_,S,A,N){_=S.state,typeof S.componentWillReceiveProps=="function"&&S.componentWillReceiveProps(A,N),typeof S.UNSAFE_componentWillReceiveProps=="function"&&S.UNSAFE_componentWillReceiveProps(A,N),S.state!==_&&nf.enqueueReplaceState(S,S.state,null)}function il(_,S,A,N){var K=_.stateNode;K.props=A,K.state=_.memoizedState,K.refs={},Qh(_);var oe=S.contextType;typeof oe=="object"&&oe!==null?K.context=Va(oe):(oe=ua(S)?ku:Hs.current,K.context=Zd(_,oe)),K.state=_.memoizedState,oe=S.getDerivedStateFromProps,typeof oe=="function"&&(Wc(_,S,oe,A),K.state=_.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof K.getSnapshotBeforeUpdate=="function"||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(S=K.state,typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount(),S!==K.state&&nf.enqueueReplaceState(K,K.state,null),gc(_,A,K,N),K.state=_.memoizedState),typeof K.componentDidMount=="function"&&(_.flags|=4194308)}function Gl(_,S){try{var A="",N=S;do A+=bt(N),N=N.return;while(N);var K=A}catch(oe){K=`
Error generating stack: `+oe.message+`
`+oe.stack}return{value:_,source:S,stack:K,digest:null}}function Uu(_,S,A){return{value:_,source:null,stack:A??null,digest:S??null}}function of(_,S){try{console.error(S.value)}catch(A){setTimeout(function(){throw A})}}var dm=typeof WeakMap=="function"?WeakMap:Map;function ah(_,S,A){A=tl(-1,A),A.tag=3,A.payload={element:null};var N=S.value;return A.callback=function(){U||(U=!0,Y=N),of(_,S)},A}function $u(_,S,A){A=tl(-1,A),A.tag=3;var N=_.type.getDerivedStateFromError;if(typeof N=="function"){var K=S.value;A.payload=function(){return N(K)},A.callback=function(){of(_,S)}}var oe=_.stateNode;return oe!==null&&typeof oe.componentDidCatch=="function"&&(A.callback=function(){of(_,S),typeof N!="function"&&(ee===null?ee=new Set([this]):ee.add(this));var Ee=S.stack;this.componentDidCatch(S.value,{componentStack:Ee!==null?Ee:""})}),A}function hm(_,S,A){var N=_.pingCache;if(N===null){N=_.pingCache=new dm;var K=new Set;N.set(S,K)}else K=N.get(S),K===void 0&&(K=new Set,N.set(S,K));K.has(A)||(K.add(A),_=hi.bind(null,_,S,A),S.then(_,_))}function Hl(_){do{var S;if((S=_.tag===13)&&(S=_.memoizedState,S=S!==null?S.dehydrated!==null:!0),S)return _;_=_.return}while(_!==null);return null}function fm(_,S,A,N,K){return(_.mode&1)===0?(_===S?_.flags|=65536:(_.flags|=128,A.flags|=131072,A.flags&=-52805,A.tag===1&&(A.alternate===null?A.tag=17:(S=tl(-1,1),S.tag=2,ql(A,S,1))),A.lanes|=1),_):(_.flags|=65536,_.lanes=K,_)}var pm=Ne.ReactCurrentOwner,Zs=!1;function Fs(_,S,A,N){S.child=_===null?np(S,null,A,N):_d(S,_.child,A,N)}function Li(_,S,A,N,K){A=A.render;var oe=S.ref;return el(S,K),N=om(_,S,A,N,oe,K),A=Uc(),_!==null&&!Zs?(S.updateQueue=_.updateQueue,S.flags&=-2053,_.lanes&=~K,_u(_,S,K)):(go&&A&&Gh(S),S.flags|=1,Fs(_,S,N,K),S.child)}function lh(_,S,A,N,K){if(_===null){var oe=A.type;return typeof oe=="function"&&!nn(oe)&&oe.defaultProps===void 0&&A.compare===null&&A.defaultProps===void 0?(S.tag=15,S.type=oe,mm(_,S,oe,N,K)):(_=xi(A.type,null,N,S,S.mode,K),_.ref=S.ref,_.return=S,S.child=_)}if(oe=_.child,(_.lanes&K)===0){var Ee=oe.memoizedProps;if(A=A.compare,A=A!==null?A:Fl,A(Ee,N)&&_.ref===S.ref)return _u(_,S,K)}return S.flags|=1,_=Jr(oe,N),_.ref=S.ref,_.return=S,S.child=_}function mm(_,S,A,N,K){if(_!==null){var oe=_.memoizedProps;if(Fl(oe,N)&&_.ref===S.ref)if(Zs=!1,S.pendingProps=N=oe,(_.lanes&K)!==0)(_.flags&131072)!==0&&(Zs=!0);else return S.lanes=_.lanes,_u(_,S,K)}return pp(_,S,A,N,K)}function gm(_,S,A){var N=S.pendingProps,K=N.children,oe=_!==null?_.memoizedState:null;if(N.mode==="hidden")if((S.mode&1)===0)S.memoizedState={baseLanes:0,cachePool:null,transitions:null},vo(n,h),h|=A;else{if((A&1073741824)===0)return _=oe!==null?oe.baseLanes|A:A,S.lanes=S.childLanes=1073741824,S.memoizedState={baseLanes:_,cachePool:null,transitions:null},S.updateQueue=null,vo(n,h),h|=_,null;S.memoizedState={baseLanes:0,cachePool:null,transitions:null},N=oe!==null?oe.baseLanes:A,vo(n,h),h|=N}else oe!==null?(N=oe.baseLanes|A,S.memoizedState=null):N=A,vo(n,h),h|=N;return Fs(_,S,K,A),S.child}function bd(_,S){var A=S.ref;(_===null&&A!==null||_!==null&&_.ref!==A)&&(S.flags|=512,S.flags|=2097152)}function pp(_,S,A,N,K){var oe=ua(A)?ku:Hs.current;return oe=Zd(S,oe),el(S,K),A=om(_,S,A,N,oe,K),N=Uc(),_!==null&&!Zs?(S.updateQueue=_.updateQueue,S.flags&=-2053,_.lanes&=~K,_u(_,S,K)):(go&&N&&Gh(S),S.flags|=1,Fs(_,S,A,K),S.child)}function sf(_,S,A,N,K){if(ua(A)){var oe=!0;$h(S)}else oe=!1;if(el(S,K),S.stateNode===null)df(_,S),hp(S,A,N),il(S,A,N,K),N=!0;else if(_===null){var Ee=S.stateNode,Ke=S.memoizedProps;Ee.props=Ke;var ut=Ee.context,Yt=A.contextType;typeof Yt=="object"&&Yt!==null?Yt=Va(Yt):(Yt=ua(A)?ku:Hs.current,Yt=Zd(S,Yt));var Er=A.getDerivedStateFromProps,Ar=typeof Er=="function"||typeof Ee.getSnapshotBeforeUpdate=="function";Ar||typeof Ee.UNSAFE_componentWillReceiveProps!="function"&&typeof Ee.componentWillReceiveProps!="function"||(Ke!==N||ut!==Yt)&&fp(S,Ee,N,Yt),mc=!1;var Pr=S.memoizedState;Ee.state=Pr,gc(S,N,Ee,K),ut=S.memoizedState,Ke!==N||Pr!==ut||Ls.current||mc?(typeof Er=="function"&&(Wc(S,A,Er,N),ut=S.memoizedState),(Ke=mc||um(S,A,Ke,N,Pr,ut,Yt))?(Ar||typeof Ee.UNSAFE_componentWillMount!="function"&&typeof Ee.componentWillMount!="function"||(typeof Ee.componentWillMount=="function"&&Ee.componentWillMount(),typeof Ee.UNSAFE_componentWillMount=="function"&&Ee.UNSAFE_componentWillMount()),typeof Ee.componentDidMount=="function"&&(S.flags|=4194308)):(typeof Ee.componentDidMount=="function"&&(S.flags|=4194308),S.memoizedProps=N,S.memoizedState=ut),Ee.props=N,Ee.state=ut,Ee.context=Yt,N=Ke):(typeof Ee.componentDidMount=="function"&&(S.flags|=4194308),N=!1)}else{Ee=S.stateNode,lg(_,S),Ke=S.memoizedProps,Yt=S.type===S.elementType?Ke:$a(S.type,Ke),Ee.props=Yt,Ar=S.pendingProps,Pr=Ee.context,ut=A.contextType,typeof ut=="object"&&ut!==null?ut=Va(ut):(ut=ua(A)?ku:Hs.current,ut=Zd(S,ut));var un=A.getDerivedStateFromProps;(Er=typeof un=="function"||typeof Ee.getSnapshotBeforeUpdate=="function")||typeof Ee.UNSAFE_componentWillReceiveProps!="function"&&typeof Ee.componentWillReceiveProps!="function"||(Ke!==Ar||Pr!==ut)&&fp(S,Ee,N,ut),mc=!1,Pr=S.memoizedState,Ee.state=Pr,gc(S,N,Ee,K);var fn=S.memoizedState;Ke!==Ar||Pr!==fn||Ls.current||mc?(typeof un=="function"&&(Wc(S,A,un,N),fn=S.memoizedState),(Yt=mc||um(S,A,Yt,N,Pr,fn,ut)||!1)?(Er||typeof Ee.UNSAFE_componentWillUpdate!="function"&&typeof Ee.componentWillUpdate!="function"||(typeof Ee.componentWillUpdate=="function"&&Ee.componentWillUpdate(N,fn,ut),typeof Ee.UNSAFE_componentWillUpdate=="function"&&Ee.UNSAFE_componentWillUpdate(N,fn,ut)),typeof Ee.componentDidUpdate=="function"&&(S.flags|=4),typeof Ee.getSnapshotBeforeUpdate=="function"&&(S.flags|=1024)):(typeof Ee.componentDidUpdate!="function"||Ke===_.memoizedProps&&Pr===_.memoizedState||(S.flags|=4),typeof Ee.getSnapshotBeforeUpdate!="function"||Ke===_.memoizedProps&&Pr===_.memoizedState||(S.flags|=1024),S.memoizedProps=N,S.memoizedState=fn),Ee.props=N,Ee.state=fn,Ee.context=ut,N=Yt):(typeof Ee.componentDidUpdate!="function"||Ke===_.memoizedProps&&Pr===_.memoizedState||(S.flags|=4),typeof Ee.getSnapshotBeforeUpdate!="function"||Ke===_.memoizedProps&&Pr===_.memoizedState||(S.flags|=1024),N=!1)}return mp(_,S,A,N,oe,K)}function mp(_,S,A,N,K,oe){bd(_,S);var Ee=(S.flags&128)!==0;if(!N&&!Ee)return K&&Wh(S,A,!1),_u(_,S,oe);N=S.stateNode,pm.current=S;var Ke=Ee&&typeof A.getDerivedStateFromError!="function"?null:N.render();return S.flags|=1,_!==null&&Ee?(S.child=_d(S,_.child,null,oe),S.child=_d(S,null,Ke,oe)):Fs(_,S,Ke,oe),S.memoizedState=N.state,K&&Wh(S,A,!0),S.child}function Wu(_){var S=_.stateNode;S.pendingContext?Zf(_,S.pendingContext,S.pendingContext!==S.context):S.context&&Zf(_,S.context,!1),ef(_,S.containerInfo)}function _m(_,S,A,N,K){return $l(),ep(K),S.flags|=256,Fs(_,S,A,N),S.child}var af={dehydrated:null,treeContext:null,retryLane:0};function lf(_){return{baseLanes:_,cachePool:null,transitions:null}}function ch(_,S,A){var N=S.pendingProps,K=rs.current,oe=!1,Ee=(S.flags&128)!==0,Ke;if((Ke=Ee)||(Ke=_!==null&&_.memoizedState===null?!1:(K&2)!==0),Ke?(oe=!0,S.flags&=-129):(_===null||_.memoizedState!==null)&&(K|=1),vo(rs,K&1),_===null)return Vc(S),_=S.memoizedState,_!==null&&(_=_.dehydrated,_!==null)?((S.mode&1)===0?S.lanes=1:_.data==="$!"?S.lanes=8:S.lanes=1073741824,null):(Ee=N.children,_=N.fallback,oe?(N=S.mode,oe=S.child,Ee={mode:"hidden",children:Ee},(N&1)===0&&oe!==null?(oe.childLanes=0,oe.pendingProps=Ee):oe=qr(Ee,N,0,null),_=Pn(_,N,A,null),oe.return=S,_.return=S,oe.sibling=_,S.child=oe,S.child.memoizedState=lf(A),S.memoizedState=af,_):gp(S,Ee));if(K=_.memoizedState,K!==null&&(Ke=K.dehydrated,Ke!==null))return mg(_,S,Ee,N,Ke,K,A);if(oe){oe=N.fallback,Ee=S.mode,K=_.child,Ke=K.sibling;var ut={mode:"hidden",children:N.children};return(Ee&1)===0&&S.child!==K?(N=S.child,N.childLanes=0,N.pendingProps=ut,S.deletions=null):(N=Jr(K,ut),N.subtreeFlags=K.subtreeFlags&14680064),Ke!==null?oe=Jr(Ke,oe):(oe=Pn(oe,Ee,A,null),oe.flags|=2),oe.return=S,N.return=S,N.sibling=oe,S.child=N,N=oe,oe=S.child,Ee=_.child.memoizedState,Ee=Ee===null?lf(A):{baseLanes:Ee.baseLanes|A,cachePool:null,transitions:Ee.transitions},oe.memoizedState=Ee,oe.childLanes=_.childLanes&~A,S.memoizedState=af,N}return oe=_.child,_=oe.sibling,N=Jr(oe,{mode:"visible",children:N.children}),(S.mode&1)===0&&(N.lanes=A),N.return=S,N.sibling=null,_!==null&&(A=S.deletions,A===null?(S.deletions=[_],S.flags|=16):A.push(_)),S.child=N,S.memoizedState=null,N}function gp(_,S){return S=qr({mode:"visible",children:S},_.mode,0,null),S.return=_,_.child=S}function uh(_,S,A,N){return N!==null&&ep(N),_d(S,_.child,null,A),_=gp(S,S.pendingProps.children),_.flags|=2,S.memoizedState=null,_}function mg(_,S,A,N,K,oe,Ee){if(A)return S.flags&256?(S.flags&=-257,N=Uu(Error(a(422))),uh(_,S,Ee,N)):S.memoizedState!==null?(S.child=_.child,S.flags|=128,null):(oe=N.fallback,K=S.mode,N=qr({mode:"visible",children:N.children},K,0,null),oe=Pn(oe,K,Ee,null),oe.flags|=2,N.return=S,oe.return=S,N.sibling=oe,S.child=N,(S.mode&1)!==0&&_d(S,_.child,null,Ee),S.child.memoizedState=lf(Ee),S.memoizedState=af,oe);if((S.mode&1)===0)return uh(_,S,Ee,null);if(K.data==="$!"){if(N=K.nextSibling&&K.nextSibling.dataset,N)var Ke=N.dgst;return N=Ke,oe=Error(a(419)),N=Uu(oe,N,void 0),uh(_,S,Ee,N)}if(Ke=(Ee&_.childLanes)!==0,Zs||Ke){if(N=ha,N!==null){switch(Ee&-Ee){case 4:K=2;break;case 16:K=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:K=32;break;case 536870912:K=268435456;break;default:K=0}K=(K&(N.suspendedLanes|Ee))!==0?0:K,K!==0&&K!==oe.retryLane&&(oe.retryLane=K,pc(_,K),Te(N,_,K,-1))}return $t(),N=Uu(Error(a(421))),uh(_,S,Ee,N)}return K.data==="$?"?(S.flags|=128,S.child=_.child,S=Sn.bind(null,_),K._reactRetry=S,null):(_=oe.treeContext,vl=du(K.nextSibling),Ja=S,go=!0,Ul=null,_!==null&&(Vl[Pa++]=fu,Vl[Pa++]=ju,Vl[Pa++]=md,fu=_.id,ju=_.overflow,md=S),S=gp(S,N.children),S.flags|=4096,S)}function gg(_,S,A){_.lanes|=S;var N=_.alternate;N!==null&&(N.lanes|=S),Kh(_.return,S,A)}function cf(_,S,A,N,K){var oe=_.memoizedState;oe===null?_.memoizedState={isBackwards:S,rendering:null,renderingStartTime:0,last:N,tail:A,tailMode:K}:(oe.isBackwards=S,oe.rendering=null,oe.renderingStartTime=0,oe.last=N,oe.tail=A,oe.tailMode=K)}function uf(_,S,A){var N=S.pendingProps,K=N.revealOrder,oe=N.tail;if(Fs(_,S,N.children,A),N=rs.current,(N&2)!==0)N=N&1|2,S.flags|=128;else{if(_!==null&&(_.flags&128)!==0)e:for(_=S.child;_!==null;){if(_.tag===13)_.memoizedState!==null&&gg(_,A,S);else if(_.tag===19)gg(_,A,S);else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===S)break e;for(;_.sibling===null;){if(_.return===null||_.return===S)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}N&=1}if(vo(rs,N),(S.mode&1)===0)S.memoizedState=null;else switch(K){case"forwards":for(A=S.child,K=null;A!==null;)_=A.alternate,_!==null&&nm(_)===null&&(K=A),A=A.sibling;A=K,A===null?(K=S.child,S.child=null):(K=A.sibling,A.sibling=null),cf(S,!1,K,A,oe);break;case"backwards":for(A=null,K=S.child,S.child=null;K!==null;){if(_=K.alternate,_!==null&&nm(_)===null){S.child=K;break}_=K.sibling,K.sibling=A,A=K,K=_}cf(S,!0,A,null,oe);break;case"together":cf(S,!1,null,null,void 0);break;default:S.memoizedState=null}return S.child}function df(_,S){(S.mode&1)===0&&_!==null&&(_.alternate=null,S.alternate=null,S.flags|=2)}function _u(_,S,A){if(_!==null&&(S.dependencies=_.dependencies),v|=S.lanes,(A&S.childLanes)===0)return null;if(_!==null&&S.child!==_.child)throw Error(a(153));if(S.child!==null){for(_=S.child,A=Jr(_,_.pendingProps),S.child=A,A.return=S;_.sibling!==null;)_=_.sibling,A=A.sibling=Jr(_,_.pendingProps),A.return=S;A.sibling=null}return S.child}function _g(_,S,A){switch(S.tag){case 3:Wu(S),$l();break;case 5:tm(S);break;case 1:ua(S.type)&&$h(S);break;case 4:ef(S,S.stateNode.containerInfo);break;case 10:var N=S.type._context,K=S.memoizedProps.value;vo(Nu,N._currentValue),N._currentValue=K;break;case 13:if(N=S.memoizedState,N!==null)return N.dehydrated!==null?(vo(rs,rs.current&1),S.flags|=128,null):(A&S.child.childLanes)!==0?ch(_,S,A):(vo(rs,rs.current&1),_=_u(_,S,A),_!==null?_.sibling:null);vo(rs,rs.current&1);break;case 19:if(N=(A&S.childLanes)!==0,(_.flags&128)!==0){if(N)return uf(_,S,A);S.flags|=128}if(K=S.memoizedState,K!==null&&(K.rendering=null,K.tail=null,K.lastEffect=null),vo(rs,rs.current),N)break;return null;case 22:case 23:return S.lanes=0,gm(_,S,A)}return _u(_,S,A)}var yg,hf,vg,xg;yg=function(_,S){for(var A=S.child;A!==null;){if(A.tag===5||A.tag===6)_.appendChild(A.stateNode);else if(A.tag!==4&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===S)break;for(;A.sibling===null;){if(A.return===null||A.return===S)return;A=A.return}A.sibling.return=A.return,A=A.sibling}},hf=function(){},vg=function(_,S,A,N){var K=_.memoizedProps;if(K!==N){_=S.stateNode,pu(Mr.current);var oe=null;switch(A){case"input":K=Un(_,K),N=Un(_,N),oe=[];break;case"select":K=Gt({},K,{value:void 0}),N=Gt({},N,{value:void 0}),oe=[];break;case"textarea":K=Ko(_,K),N=Ko(_,N),oe=[];break;default:typeof K.onClick!="function"&&typeof N.onClick=="function"&&(_.onclick=Hp)}ba(A,N);var Ee;A=null;for(Yt in K)if(!N.hasOwnProperty(Yt)&&K.hasOwnProperty(Yt)&&K[Yt]!=null)if(Yt==="style"){var Ke=K[Yt];for(Ee in Ke)Ke.hasOwnProperty(Ee)&&(A||(A={}),A[Ee]="")}else Yt!=="dangerouslySetInnerHTML"&&Yt!=="children"&&Yt!=="suppressContentEditableWarning"&&Yt!=="suppressHydrationWarning"&&Yt!=="autoFocus"&&(p.hasOwnProperty(Yt)?oe||(oe=[]):(oe=oe||[]).push(Yt,null));for(Yt in N){var ut=N[Yt];if(Ke=K?.[Yt],N.hasOwnProperty(Yt)&&ut!==Ke&&(ut!=null||Ke!=null))if(Yt==="style")if(Ke){for(Ee in Ke)!Ke.hasOwnProperty(Ee)||ut&&ut.hasOwnProperty(Ee)||(A||(A={}),A[Ee]="");for(Ee in ut)ut.hasOwnProperty(Ee)&&Ke[Ee]!==ut[Ee]&&(A||(A={}),A[Ee]=ut[Ee])}else A||(oe||(oe=[]),oe.push(Yt,A)),A=ut;else Yt==="dangerouslySetInnerHTML"?(ut=ut?ut.__html:void 0,Ke=Ke?Ke.__html:void 0,ut!=null&&Ke!==ut&&(oe=oe||[]).push(Yt,ut)):Yt==="children"?typeof ut!="string"&&typeof ut!="number"||(oe=oe||[]).push(Yt,""+ut):Yt!=="suppressContentEditableWarning"&&Yt!=="suppressHydrationWarning"&&(p.hasOwnProperty(Yt)?(ut!=null&&Yt==="onScroll"&&Uo("scroll",_),oe||Ke===ut||(oe=[])):(oe=oe||[]).push(Yt,ut))}A&&(oe=oe||[]).push("style",A);var Yt=oe;(S.updateQueue=Yt)&&(S.flags|=4)}},xg=function(_,S,A,N){A!==N&&(S.flags|=4)};function ff(_,S){if(!go)switch(_.tailMode){case"hidden":S=_.tail;for(var A=null;S!==null;)S.alternate!==null&&(A=S),S=S.sibling;A===null?_.tail=null:A.sibling=null;break;case"collapsed":A=_.tail;for(var N=null;A!==null;)A.alternate!==null&&(N=A),A=A.sibling;N===null?S||_.tail===null?_.tail=null:_.tail.sibling=null:N.sibling=null}}function Ma(_){var S=_.alternate!==null&&_.alternate.child===_.child,A=0,N=0;if(S)for(var K=_.child;K!==null;)A|=K.lanes|K.childLanes,N|=K.subtreeFlags&14680064,N|=K.flags&14680064,K.return=_,K=K.sibling;else for(K=_.child;K!==null;)A|=K.lanes|K.childLanes,N|=K.subtreeFlags,N|=K.flags,K.return=_,K=K.sibling;return _.subtreeFlags|=N,_.childLanes=A,S}function M_(_,S,A){var N=S.pendingProps;switch(Jf(S),S.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ma(S),null;case 1:return ua(S.type)&&hu(),Ma(S),null;case 3:return N=S.stateNode,yd(),Po(Ls),Po(Hs),sp(),N.pendingContext&&(N.context=N.pendingContext,N.pendingContext=null),(_===null||_.child===null)&&(Qd(S)?S.flags|=4:_===null||_.memoizedState.isDehydrated&&(S.flags&256)===0||(S.flags|=1024,Ul!==null&&($e(Ul),Ul=null))),hf(_,S),Ma(S),null;case 5:rm(S);var K=pu(Jh.current);if(A=S.type,_!==null&&S.stateNode!=null)vg(_,S,A,N,K),_.ref!==S.ref&&(S.flags|=512,S.flags|=2097152);else{if(!N){if(S.stateNode===null)throw Error(a(166));return Ma(S),null}if(_=pu(Mr.current),Qd(S)){N=S.stateNode,A=S.type;var oe=S.memoizedProps;switch(N[jl]=S,N[hd]=oe,_=(S.mode&1)!==0,A){case"dialog":Uo("cancel",N),Uo("close",N);break;case"iframe":case"object":case"embed":Uo("load",N);break;case"video":case"audio":for(K=0;K<dd.length;K++)Uo(dd[K],N);break;case"source":Uo("error",N);break;case"img":case"image":case"link":Uo("error",N),Uo("load",N);break;case"details":Uo("toggle",N);break;case"input":Si(N,oe),Uo("invalid",N);break;case"select":N._wrapperState={wasMultiple:!!oe.multiple},Uo("invalid",N);break;case"textarea":ds(N,oe),Uo("invalid",N)}ba(A,oe),K=null;for(var Ee in oe)if(oe.hasOwnProperty(Ee)){var Ke=oe[Ee];Ee==="children"?typeof Ke=="string"?N.textContent!==Ke&&(oe.suppressHydrationWarning!==!0&&Wd(N.textContent,Ke,_),K=["children",Ke]):typeof Ke=="number"&&N.textContent!==""+Ke&&(oe.suppressHydrationWarning!==!0&&Wd(N.textContent,Ke,_),K=["children",""+Ke]):p.hasOwnProperty(Ee)&&Ke!=null&&Ee==="onScroll"&&Uo("scroll",N)}switch(A){case"input":hn(N),Xn(N,oe,!0);break;case"textarea":hn(N),ra(N);break;case"select":case"option":break;default:typeof oe.onClick=="function"&&(N.onclick=Hp)}N=K,S.updateQueue=N,N!==null&&(S.flags|=4)}else{Ee=K.nodeType===9?K:K.ownerDocument,_==="http://www.w3.org/1999/xhtml"&&(_=va(A)),_==="http://www.w3.org/1999/xhtml"?A==="script"?(_=Ee.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild)):typeof N.is=="string"?_=Ee.createElement(A,{is:N.is}):(_=Ee.createElement(A),A==="select"&&(Ee=_,N.multiple?Ee.multiple=!0:N.size&&(Ee.size=N.size))):_=Ee.createElementNS(_,A),_[jl]=S,_[hd]=N,yg(_,S,!1,!1),S.stateNode=_;e:{switch(Ee=wa(A,N),A){case"dialog":Uo("cancel",_),Uo("close",_),K=N;break;case"iframe":case"object":case"embed":Uo("load",_),K=N;break;case"video":case"audio":for(K=0;K<dd.length;K++)Uo(dd[K],_);K=N;break;case"source":Uo("error",_),K=N;break;case"img":case"image":case"link":Uo("error",_),Uo("load",_),K=N;break;case"details":Uo("toggle",_),K=N;break;case"input":Si(_,N),K=Un(_,N),Uo("invalid",_);break;case"option":K=N;break;case"select":_._wrapperState={wasMultiple:!!N.multiple},K=Gt({},N,{value:void 0}),Uo("invalid",_);break;case"textarea":ds(_,N),K=Ko(_,N),Uo("invalid",_);break;default:K=N}ba(A,K),Ke=K;for(oe in Ke)if(Ke.hasOwnProperty(oe)){var ut=Ke[oe];oe==="style"?io(_,ut):oe==="dangerouslySetInnerHTML"?(ut=ut?ut.__html:void 0,ut!=null&&Qo(_,ut)):oe==="children"?typeof ut=="string"?(A!=="textarea"||ut!=="")&&na(_,ut):typeof ut=="number"&&na(_,""+ut):oe!=="suppressContentEditableWarning"&&oe!=="suppressHydrationWarning"&&oe!=="autoFocus"&&(p.hasOwnProperty(oe)?ut!=null&&oe==="onScroll"&&Uo("scroll",_):ut!=null&&ve(_,oe,ut,Ee))}switch(A){case"input":hn(_),Xn(_,N,!1);break;case"textarea":hn(_),ra(_);break;case"option":N.value!=null&&_.setAttribute("value",""+xr(N.value));break;case"select":_.multiple=!!N.multiple,oe=N.value,oe!=null?co(_,!!N.multiple,oe,!1):N.defaultValue!=null&&co(_,!!N.multiple,N.defaultValue,!0);break;default:typeof K.onClick=="function"&&(_.onclick=Hp)}switch(A){case"button":case"input":case"select":case"textarea":N=!!N.autoFocus;break e;case"img":N=!0;break e;default:N=!1}}N&&(S.flags|=4)}S.ref!==null&&(S.flags|=512,S.flags|=2097152)}return Ma(S),null;case 6:if(_&&S.stateNode!=null)xg(_,S,_.memoizedProps,N);else{if(typeof N!="string"&&S.stateNode===null)throw Error(a(166));if(A=pu(Jh.current),pu(Mr.current),Qd(S)){if(N=S.stateNode,A=S.memoizedProps,N[jl]=S,(oe=N.nodeValue!==A)&&(_=Ja,_!==null))switch(_.tag){case 3:Wd(N.nodeValue,A,(_.mode&1)!==0);break;case 5:_.memoizedProps.suppressHydrationWarning!==!0&&Wd(N.nodeValue,A,(_.mode&1)!==0)}oe&&(S.flags|=4)}else N=(A.nodeType===9?A:A.ownerDocument).createTextNode(N),N[jl]=S,S.stateNode=N}return Ma(S),null;case 13:if(Po(rs),N=S.memoizedState,_===null||_.memoizedState!==null&&_.memoizedState.dehydrated!==null){if(go&&vl!==null&&(S.mode&1)!==0&&(S.flags&128)===0)gd(),$l(),S.flags|=98560,oe=!1;else if(oe=Qd(S),N!==null&&N.dehydrated!==null){if(_===null){if(!oe)throw Error(a(318));if(oe=S.memoizedState,oe=oe!==null?oe.dehydrated:null,!oe)throw Error(a(317));oe[jl]=S}else $l(),(S.flags&128)===0&&(S.memoizedState=null),S.flags|=4;Ma(S),oe=!1}else Ul!==null&&($e(Ul),Ul=null),oe=!0;if(!oe)return S.flags&65536?S:null}return(S.flags&128)!==0?(S.lanes=A,S):(N=N!==null,N!==(_!==null&&_.memoizedState!==null)&&N&&(S.child.flags|=8192,(S.mode&1)!==0&&(_===null||(rs.current&1)!==0?l===0&&(l=3):$t())),S.updateQueue!==null&&(S.flags|=4),Ma(S),null);case 4:return yd(),hf(_,S),_===null&&Wf(S.stateNode.containerInfo),Ma(S),null;case 10:return Xh(S.type._context),Ma(S),null;case 17:return ua(S.type)&&hu(),Ma(S),null;case 19:if(Po(rs),oe=S.memoizedState,oe===null)return Ma(S),null;if(N=(S.flags&128)!==0,Ee=oe.rendering,Ee===null)if(N)ff(oe,!1);else{if(l!==0||_!==null&&(_.flags&128)!==0)for(_=S.child;_!==null;){if(Ee=nm(_),Ee!==null){for(S.flags|=128,ff(oe,!1),N=Ee.updateQueue,N!==null&&(S.updateQueue=N,S.flags|=4),S.subtreeFlags=0,N=A,A=S.child;A!==null;)oe=A,_=N,oe.flags&=14680066,Ee=oe.alternate,Ee===null?(oe.childLanes=0,oe.lanes=_,oe.child=null,oe.subtreeFlags=0,oe.memoizedProps=null,oe.memoizedState=null,oe.updateQueue=null,oe.dependencies=null,oe.stateNode=null):(oe.childLanes=Ee.childLanes,oe.lanes=Ee.lanes,oe.child=Ee.child,oe.subtreeFlags=0,oe.deletions=null,oe.memoizedProps=Ee.memoizedProps,oe.memoizedState=Ee.memoizedState,oe.updateQueue=Ee.updateQueue,oe.type=Ee.type,_=Ee.dependencies,oe.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),A=A.sibling;return vo(rs,rs.current&1|2),S.child}_=_.sibling}oe.tail!==null&&yr()>j&&(S.flags|=128,N=!0,ff(oe,!1),S.lanes=4194304)}else{if(!N)if(_=nm(Ee),_!==null){if(S.flags|=128,N=!0,A=_.updateQueue,A!==null&&(S.updateQueue=A,S.flags|=4),ff(oe,!0),oe.tail===null&&oe.tailMode==="hidden"&&!Ee.alternate&&!go)return Ma(S),null}else 2*yr()-oe.renderingStartTime>j&&A!==1073741824&&(S.flags|=128,N=!0,ff(oe,!1),S.lanes=4194304);oe.isBackwards?(Ee.sibling=S.child,S.child=Ee):(A=oe.last,A!==null?A.sibling=Ee:S.child=Ee,oe.last=Ee)}return oe.tail!==null?(S=oe.tail,oe.rendering=S,oe.tail=S.sibling,oe.renderingStartTime=yr(),S.sibling=null,A=rs.current,vo(rs,N?A&1|2:A&1),S):(Ma(S),null);case 22:case 23:return je(),N=S.memoizedState!==null,_!==null&&_.memoizedState!==null!==N&&(S.flags|=8192),N&&(S.mode&1)!==0?(h&1073741824)!==0&&(Ma(S),S.subtreeFlags&6&&(S.flags|=8192)):Ma(S),null;case 24:return null;case 25:return null}throw Error(a(156,S.tag))}function lv(_,S){switch(Jf(S),S.tag){case 1:return ua(S.type)&&hu(),_=S.flags,_&65536?(S.flags=_&-65537|128,S):null;case 3:return yd(),Po(Ls),Po(Hs),sp(),_=S.flags,(_&65536)!==0&&(_&128)===0?(S.flags=_&-65537|128,S):null;case 5:return rm(S),null;case 13:if(Po(rs),_=S.memoizedState,_!==null&&_.dehydrated!==null){if(S.alternate===null)throw Error(a(340));$l()}return _=S.flags,_&65536?(S.flags=_&-65537|128,S):null;case 19:return Po(rs),null;case 4:return yd(),null;case 10:return Xh(S.type._context),null;case 22:case 23:return je(),null;case 24:return null;default:return null}}var ym=!1,Wn=!1,C_=typeof WeakSet=="function"?WeakSet:Set,dn=null;function pf(_,S){var A=_.ref;if(A!==null)if(typeof A=="function")try{A(null)}catch(N){Kr(_,S,N)}else A.current=null}function bg(_,S,A){try{A()}catch(N){Kr(_,S,N)}}var mf=!1;function _p(_,S){if(Yp=Ge,_=kh(),ml(_)){if("selectionStart"in _)var A={start:_.selectionStart,end:_.selectionEnd};else e:{A=(A=_.ownerDocument)&&A.defaultView||window;var N=A.getSelection&&A.getSelection();if(N&&N.rangeCount!==0){A=N.anchorNode;var K=N.anchorOffset,oe=N.focusNode;N=N.focusOffset;try{A.nodeType,oe.nodeType}catch{A=null;break e}var Ee=0,Ke=-1,ut=-1,Yt=0,Er=0,Ar=_,Pr=null;t:for(;;){for(var un;Ar!==A||K!==0&&Ar.nodeType!==3||(Ke=Ee+K),Ar!==oe||N!==0&&Ar.nodeType!==3||(ut=Ee+N),Ar.nodeType===3&&(Ee+=Ar.nodeValue.length),(un=Ar.firstChild)!==null;)Pr=Ar,Ar=un;for(;;){if(Ar===_)break t;if(Pr===A&&++Yt===K&&(Ke=Ee),Pr===oe&&++Er===N&&(ut=Ee),(un=Ar.nextSibling)!==null)break;Ar=Pr,Pr=Ar.parentNode}Ar=un}A=Ke===-1||ut===-1?null:{start:Ke,end:ut}}else A=null}A=A||{start:0,end:0}}else A=null;for(qf={focusedElem:_,selectionRange:A},Ge=!1,dn=S;dn!==null;)if(S=dn,_=S.child,(S.subtreeFlags&1028)!==0&&_!==null)_.return=S,dn=_;else for(;dn!==null;){S=dn;try{var fn=S.alternate;if((S.flags&1024)!==0)switch(S.tag){case 0:case 11:case 15:break;case 1:if(fn!==null){var an=fn.memoizedProps,Io=fn.memoizedState,Lt=S.stateNode,vt=Lt.getSnapshotBeforeUpdate(S.elementType===S.type?an:$a(S.type,an),Io);Lt.__reactInternalSnapshotBeforeUpdate=vt}break;case 3:var Bt=S.stateNode.containerInfo;Bt.nodeType===1?Bt.textContent="":Bt.nodeType===9&&Bt.documentElement&&Bt.removeChild(Bt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(kr){Kr(S,S.return,kr)}if(_=S.sibling,_!==null){_.return=S.return,dn=_;break}dn=S.return}return fn=mf,mf=!1,fn}function dh(_,S,A){var N=S.updateQueue;if(N=N!==null?N.lastEffect:null,N!==null){var K=N=N.next;do{if((K.tag&_)===_){var oe=K.destroy;K.destroy=void 0,oe!==void 0&&bg(S,A,oe)}K=K.next}while(K!==N)}}function hh(_,S){if(S=S.updateQueue,S=S!==null?S.lastEffect:null,S!==null){var A=S=S.next;do{if((A.tag&_)===_){var N=A.create;A.destroy=N()}A=A.next}while(A!==S)}}function bl(_){var S=_.ref;if(S!==null){var A=_.stateNode;switch(_.tag){case 5:_=A;break;default:_=A}typeof S=="function"?S(_):S.current=_}}function yp(_){var S=_.alternate;S!==null&&(_.alternate=null,yp(S)),_.child=null,_.deletions=null,_.sibling=null,_.tag===5&&(S=_.stateNode,S!==null&&(delete S[jl],delete S[hd],delete S[Vh],delete S[Yf],delete S[E_])),_.stateNode=null,_.return=null,_.dependencies=null,_.memoizedProps=null,_.memoizedState=null,_.pendingProps=null,_.stateNode=null,_.updateQueue=null}function xo(_){return _.tag===5||_.tag===3||_.tag===4}function qc(_){e:for(;;){for(;_.sibling===null;){if(_.return===null||xo(_.return))return null;_=_.return}for(_.sibling.return=_.return,_=_.sibling;_.tag!==5&&_.tag!==6&&_.tag!==18;){if(_.flags&2||_.child===null||_.tag===4)continue e;_.child.return=_,_=_.child}if(!(_.flags&2))return _.stateNode}}function wd(_,S,A){var N=_.tag;if(N===5||N===6)_=_.stateNode,S?A.nodeType===8?A.parentNode.insertBefore(_,S):A.insertBefore(_,S):(A.nodeType===8?(S=A.parentNode,S.insertBefore(_,A)):(S=A,S.appendChild(_)),A=A._reactRootContainer,A!=null||S.onclick!==null||(S.onclick=Hp));else if(N!==4&&(_=_.child,_!==null))for(wd(_,S,A),_=_.sibling;_!==null;)wd(_,S,A),_=_.sibling}function fh(_,S,A){var N=_.tag;if(N===5||N===6)_=_.stateNode,S?A.insertBefore(_,S):A.appendChild(_);else if(N!==4&&(_=_.child,_!==null))for(fh(_,S,A),_=_.sibling;_!==null;)fh(_,S,A),_=_.sibling}var Xs=null,vc=!1;function xc(_,S,A){for(A=A.child;A!==null;)A_(_,S,A),A=A.sibling}function A_(_,S,A){if(si&&typeof si.onCommitFiberUnmount=="function")try{si.onCommitFiberUnmount(Ti,A)}catch{}switch(A.tag){case 5:Wn||pf(A,S);case 6:var N=Xs,K=vc;Xs=null,xc(_,S,A),Xs=N,vc=K,Xs!==null&&(vc?(_=Xs,A=A.stateNode,_.nodeType===8?_.parentNode.removeChild(A):_.removeChild(A)):Xs.removeChild(A.stateNode));break;case 18:Xs!==null&&(vc?(_=Xs,A=A.stateNode,_.nodeType===8?Zp(_.parentNode,A):_.nodeType===1&&Zp(_,A),za(_)):Zp(Xs,A.stateNode));break;case 4:N=Xs,K=vc,Xs=A.stateNode.containerInfo,vc=!0,xc(_,S,A),Xs=N,vc=K;break;case 0:case 11:case 14:case 15:if(!Wn&&(N=A.updateQueue,N!==null&&(N=N.lastEffect,N!==null))){K=N=N.next;do{var oe=K,Ee=oe.destroy;oe=oe.tag,Ee!==void 0&&((oe&2)!==0||(oe&4)!==0)&&bg(A,S,Ee),K=K.next}while(K!==N)}xc(_,S,A);break;case 1:if(!Wn&&(pf(A,S),N=A.stateNode,typeof N.componentWillUnmount=="function"))try{N.props=A.memoizedProps,N.state=A.memoizedState,N.componentWillUnmount()}catch(Ke){Kr(A,S,Ke)}xc(_,S,A);break;case 21:xc(_,S,A);break;case 22:A.mode&1?(Wn=(N=Wn)||A.memoizedState!==null,xc(_,S,A),Wn=N):xc(_,S,A);break;default:xc(_,S,A)}}function wg(_){var S=_.updateQueue;if(S!==null){_.updateQueue=null;var A=_.stateNode;A===null&&(A=_.stateNode=new C_),S.forEach(function(N){var K=sn.bind(null,_,N);A.has(N)||(A.add(N),N.then(K,K))})}}function Yl(_,S){var A=S.deletions;if(A!==null)for(var N=0;N<A.length;N++){var K=A[N];try{var oe=_,Ee=S,Ke=Ee;e:for(;Ke!==null;){switch(Ke.tag){case 5:Xs=Ke.stateNode,vc=!1;break e;case 3:Xs=Ke.stateNode.containerInfo,vc=!0;break e;case 4:Xs=Ke.stateNode.containerInfo,vc=!0;break e}Ke=Ke.return}if(Xs===null)throw Error(a(160));A_(oe,Ee,K),Xs=null,vc=!1;var ut=K.alternate;ut!==null&&(ut.return=null),K.return=null}catch(Yt){Kr(K,S,Yt)}}if(S.subtreeFlags&12854)for(S=S.child;S!==null;)vm(S,_),S=S.sibling}function vm(_,S){var A=_.alternate,N=_.flags;switch(_.tag){case 0:case 11:case 14:case 15:if(Yl(S,_),Zl(_),N&4){try{dh(3,_,_.return),hh(3,_)}catch(an){Kr(_,_.return,an)}try{dh(5,_,_.return)}catch(an){Kr(_,_.return,an)}}break;case 1:Yl(S,_),Zl(_),N&512&&A!==null&&pf(A,A.return);break;case 5:if(Yl(S,_),Zl(_),N&512&&A!==null&&pf(A,A.return),_.flags&32){var K=_.stateNode;try{na(K,"")}catch(an){Kr(_,_.return,an)}}if(N&4&&(K=_.stateNode,K!=null)){var oe=_.memoizedProps,Ee=A!==null?A.memoizedProps:oe,Ke=_.type,ut=_.updateQueue;if(_.updateQueue=null,ut!==null)try{Ke==="input"&&oe.type==="radio"&&oe.name!=null&&di(K,oe),wa(Ke,Ee);var Yt=wa(Ke,oe);for(Ee=0;Ee<ut.length;Ee+=2){var Er=ut[Ee],Ar=ut[Ee+1];Er==="style"?io(K,Ar):Er==="dangerouslySetInnerHTML"?Qo(K,Ar):Er==="children"?na(K,Ar):ve(K,Er,Ar,Yt)}switch(Ke){case"input":Ii(K,oe);break;case"textarea":Bo(K,oe);break;case"select":var Pr=K._wrapperState.wasMultiple;K._wrapperState.wasMultiple=!!oe.multiple;var un=oe.value;un!=null?co(K,!!oe.multiple,un,!1):Pr!==!!oe.multiple&&(oe.defaultValue!=null?co(K,!!oe.multiple,oe.defaultValue,!0):co(K,!!oe.multiple,oe.multiple?[]:"",!1))}K[hd]=oe}catch(an){Kr(_,_.return,an)}}break;case 6:if(Yl(S,_),Zl(_),N&4){if(_.stateNode===null)throw Error(a(162));K=_.stateNode,oe=_.memoizedProps;try{K.nodeValue=oe}catch(an){Kr(_,_.return,an)}}break;case 3:if(Yl(S,_),Zl(_),N&4&&A!==null&&A.memoizedState.isDehydrated)try{za(S.containerInfo)}catch(an){Kr(_,_.return,an)}break;case 4:Yl(S,_),Zl(_);break;case 13:Yl(S,_),Zl(_),K=_.child,K.flags&8192&&(oe=K.memoizedState!==null,K.stateNode.isHidden=oe,!oe||K.alternate!==null&&K.alternate.memoizedState!==null||(B=yr())),N&4&&wg(_);break;case 22:if(Er=A!==null&&A.memoizedState!==null,_.mode&1?(Wn=(Yt=Wn)||Er,Yl(S,_),Wn=Yt):Yl(S,_),Zl(_),N&8192){if(Yt=_.memoizedState!==null,(_.stateNode.isHidden=Yt)&&!Er&&(_.mode&1)!==0)for(dn=_,Er=_.child;Er!==null;){for(Ar=dn=Er;dn!==null;){switch(Pr=dn,un=Pr.child,Pr.tag){case 0:case 11:case 14:case 15:dh(4,Pr,Pr.return);break;case 1:pf(Pr,Pr.return);var fn=Pr.stateNode;if(typeof fn.componentWillUnmount=="function"){N=Pr,A=Pr.return;try{S=N,fn.props=S.memoizedProps,fn.state=S.memoizedState,fn.componentWillUnmount()}catch(an){Kr(N,A,an)}}break;case 5:pf(Pr,Pr.return);break;case 22:if(Pr.memoizedState!==null){bc(Ar);continue}}un!==null?(un.return=Pr,dn=un):bc(Ar)}Er=Er.sibling}e:for(Er=null,Ar=_;;){if(Ar.tag===5){if(Er===null){Er=Ar;try{K=Ar.stateNode,Yt?(oe=K.style,typeof oe.setProperty=="function"?oe.setProperty("display","none","important"):oe.display="none"):(Ke=Ar.stateNode,ut=Ar.memoizedProps.style,Ee=ut!=null&&ut.hasOwnProperty("display")?ut.display:null,Ke.style.display=Al("display",Ee))}catch(an){Kr(_,_.return,an)}}}else if(Ar.tag===6){if(Er===null)try{Ar.stateNode.nodeValue=Yt?"":Ar.memoizedProps}catch(an){Kr(_,_.return,an)}}else if((Ar.tag!==22&&Ar.tag!==23||Ar.memoizedState===null||Ar===_)&&Ar.child!==null){Ar.child.return=Ar,Ar=Ar.child;continue}if(Ar===_)break e;for(;Ar.sibling===null;){if(Ar.return===null||Ar.return===_)break e;Er===Ar&&(Er=null),Ar=Ar.return}Er===Ar&&(Er=null),Ar.sibling.return=Ar.return,Ar=Ar.sibling}}break;case 19:Yl(S,_),Zl(_),N&4&&wg(_);break;case 21:break;default:Yl(S,_),Zl(_)}}function Zl(_){var S=_.flags;if(S&2){try{e:{for(var A=_.return;A!==null;){if(xo(A)){var N=A;break e}A=A.return}throw Error(a(160))}switch(N.tag){case 5:var K=N.stateNode;N.flags&32&&(na(K,""),N.flags&=-33);var oe=qc(_);fh(_,oe,K);break;case 3:case 4:var Ee=N.stateNode.containerInfo,Ke=qc(_);wd(_,Ke,Ee);break;default:throw Error(a(161))}}catch(ut){Kr(_,_.return,ut)}_.flags&=-3}S&4096&&(_.flags&=-4097)}function xm(_,S,A){dn=_,gf(_)}function gf(_,S,A){for(var N=(_.mode&1)!==0;dn!==null;){var K=dn,oe=K.child;if(K.tag===22&&N){var Ee=K.memoizedState!==null||ym;if(!Ee){var Ke=K.alternate,ut=Ke!==null&&Ke.memoizedState!==null||Wn;Ke=ym;var Yt=Wn;if(ym=Ee,(Wn=ut)&&!Yt)for(dn=K;dn!==null;)Ee=dn,ut=Ee.child,Ee.tag===22&&Ee.memoizedState!==null?Ks(K):ut!==null?(ut.return=Ee,dn=ut):Ks(K);for(;oe!==null;)dn=oe,gf(oe),oe=oe.sibling;dn=K,ym=Ke,Wn=Yt}yu(_)}else(K.subtreeFlags&8772)!==0&&oe!==null?(oe.return=K,dn=oe):yu(_)}}function yu(_){for(;dn!==null;){var S=dn;if((S.flags&8772)!==0){var A=S.alternate;try{if((S.flags&8772)!==0)switch(S.tag){case 0:case 11:case 15:Wn||hh(5,S);break;case 1:var N=S.stateNode;if(S.flags&4&&!Wn)if(A===null)N.componentDidMount();else{var K=S.elementType===S.type?A.memoizedProps:$a(S.type,A.memoizedProps);N.componentDidUpdate(K,A.memoizedState,N.__reactInternalSnapshotBeforeUpdate)}var oe=S.updateQueue;oe!==null&&Vu(S,oe,N);break;case 3:var Ee=S.updateQueue;if(Ee!==null){if(A=null,S.child!==null)switch(S.child.tag){case 5:A=S.child.stateNode;break;case 1:A=S.child.stateNode}Vu(S,Ee,A)}break;case 5:var Ke=S.stateNode;if(A===null&&S.flags&4){A=Ke;var ut=S.memoizedProps;switch(S.type){case"button":case"input":case"select":case"textarea":ut.autoFocus&&A.focus();break;case"img":ut.src&&(A.src=ut.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(S.memoizedState===null){var Yt=S.alternate;if(Yt!==null){var Er=Yt.memoizedState;if(Er!==null){var Ar=Er.dehydrated;Ar!==null&&za(Ar)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(a(163))}Wn||S.flags&512&&bl(S)}catch(Pr){Kr(S,S.return,Pr)}}if(S===_){dn=null;break}if(A=S.sibling,A!==null){A.return=S.return,dn=A;break}dn=S.return}}function bc(_){for(;dn!==null;){var S=dn;if(S===_){dn=null;break}var A=S.sibling;if(A!==null){A.return=S.return,dn=A;break}dn=S.return}}function Ks(_){for(;dn!==null;){var S=dn;try{switch(S.tag){case 0:case 11:case 15:var A=S.return;try{hh(4,S)}catch(ut){Kr(S,A,ut)}break;case 1:var N=S.stateNode;if(typeof N.componentDidMount=="function"){var K=S.return;try{N.componentDidMount()}catch(ut){Kr(S,K,ut)}}var oe=S.return;try{bl(S)}catch(ut){Kr(S,oe,ut)}break;case 5:var Ee=S.return;try{bl(S)}catch(ut){Kr(S,Ee,ut)}}}catch(ut){Kr(S,S.return,ut)}if(S===_){dn=null;break}var Ke=S.sibling;if(Ke!==null){Ke.return=S.return,dn=Ke;break}dn=S.return}}var qu=Math.ceil,wl=Ne.ReactCurrentDispatcher,Sg=Ne.ReactCurrentOwner,wc=Ne.ReactCurrentBatchConfig,Ki=0,ha=null,as=null,oo=0,h=0,n=pd(0),l=0,f=null,v=0,w=0,E=0,M=null,D=null,B=0,j=1/0,q=null,U=!1,Y=null,ee=null,re=!1,ce=null,ae=0,de=0,ye=null,fe=-1,Me=0;function xe(){return(Ki&6)!==0?yr():fe!==-1?fe:fe=yr()}function Ce(_){return(_.mode&1)===0?1:(Ki&2)!==0&&oo!==0?oo&-oo:Kp.transition!==null?(Me===0&&(Me=Jo()),Me):(_=yi,_!==0||(_=window.event,_=_===void 0?16:Ui(_.type)),_)}function Te(_,S,A,N){if(50<de)throw de=0,ye=null,Error(a(185));Ho(_,A,N),((Ki&2)===0||_!==ha)&&(_===ha&&((Ki&2)===0&&(w|=A),l===4&&Qe(_,oo)),be(_,N),A===1&&Ki===0&&(S.mode&1)===0&&(j=yr()+500,qh&&jc()))}function be(_,S){var A=_.callbackNode;uo(_,S);var N=ps(_,_===ha?oo:0);if(N===0)A!==null&&Pt(A),_.callbackNode=null,_.callbackPriority=0;else if(S=N&-N,_.callbackPriority!==S){if(A!=null&&Pt(A),S===1)_.tag===0?Kf(pt.bind(null,_)):Xp(pt.bind(null,_)),Hf(function(){(Ki&6)===0&&jc()}),A=null;else{switch(ic(N)){case 1:A=Zr;break;case 4:A=on;break;case 16:A=Cn;break;case 536870912:A=Qi;break;default:A=Cn}A=Tn(A,De.bind(null,_))}_.callbackPriority=S,_.callbackNode=A}}function De(_,S){if(fe=-1,Me=0,(Ki&6)!==0)throw Error(a(327));var A=_.callbackNode;if(Dr()&&_.callbackNode!==A)return null;var N=ps(_,_===ha?oo:0);if(N===0)return null;if((N&30)!==0||(N&_.expiredLanes)!==0||S)S=fr(_,N);else{S=N;var K=Ki;Ki|=2;var oe=Mt();(ha!==_||oo!==S)&&(q=null,j=yr()+500,dt(_,S));do try{Nt();break}catch(Ke){rt(_,Ke)}while(!0);ag(),wl.current=oe,Ki=K,as!==null?S=0:(ha=null,oo=0,S=l)}if(S!==0){if(S===2&&(K=Cs(_),K!==0&&(N=K,S=He(_,K))),S===1)throw A=f,dt(_,0),Qe(_,N),be(_,yr()),A;if(S===6)Qe(_,N);else{if(K=_.current.alternate,(N&30)===0&&!st(K)&&(S=fr(_,N),S===2&&(oe=Cs(_),oe!==0&&(N=oe,S=He(_,oe))),S===1))throw A=f,dt(_,0),Qe(_,N),be(_,yr()),A;switch(_.finishedWork=K,_.finishedLanes=N,S){case 0:case 1:throw Error(a(345));case 2:Qt(_,D,q);break;case 3:if(Qe(_,N),(N&130023424)===N&&(S=B+500-yr(),10<S)){if(ps(_,0)!==0)break;if(K=_.suspendedLanes,(K&N)!==N){xe(),_.pingedLanes|=_.suspendedLanes&K;break}_.timeoutHandle=Gf(Qt.bind(null,_,D,q),S);break}Qt(_,D,q);break;case 4:if(Qe(_,N),(N&4194240)===N)break;for(S=_.eventTimes,K=-1;0<N;){var Ee=31-rn(N);oe=1<<Ee,Ee=S[Ee],Ee>K&&(K=Ee),N&=~oe}if(N=K,N=yr()-N,N=(120>N?120:480>N?480:1080>N?1080:1920>N?1920:3e3>N?3e3:4320>N?4320:1960*qu(N/1960))-N,10<N){_.timeoutHandle=Gf(Qt.bind(null,_,D,q),N);break}Qt(_,D,q);break;case 5:Qt(_,D,q);break;default:throw Error(a(329))}}}return be(_,yr()),_.callbackNode===A?De.bind(null,_):null}function He(_,S){var A=M;return _.current.memoizedState.isDehydrated&&(dt(_,S).flags|=256),_=fr(_,S),_!==2&&(S=D,D=A,S!==null&&$e(S)),_}function $e(_){D===null?D=_:D.push.apply(D,_)}function st(_){for(var S=_;;){if(S.flags&16384){var A=S.updateQueue;if(A!==null&&(A=A.stores,A!==null))for(var N=0;N<A.length;N++){var K=A[N],oe=K.getSnapshot;K=K.value;try{if(!ca(oe(),K))return!1}catch{return!1}}}if(A=S.child,S.subtreeFlags&16384&&A!==null)A.return=S,S=A;else{if(S===_)break;for(;S.sibling===null;){if(S.return===null||S.return===_)return!0;S=S.return}S.sibling.return=S.return,S=S.sibling}}return!0}function Qe(_,S){for(S&=~E,S&=~w,_.suspendedLanes|=S,_.pingedLanes&=~S,_=_.expirationTimes;0<S;){var A=31-rn(S),N=1<<A;_[A]=-1,S&=~N}}function pt(_){if((Ki&6)!==0)throw Error(a(327));Dr();var S=ps(_,0);if((S&1)===0)return be(_,yr()),null;var A=fr(_,S);if(_.tag!==0&&A===2){var N=Cs(_);N!==0&&(S=N,A=He(_,N))}if(A===1)throw A=f,dt(_,0),Qe(_,S),be(_,yr()),A;if(A===6)throw Error(a(345));return _.finishedWork=_.current.alternate,_.finishedLanes=S,Qt(_,D,q),be(_,yr()),null}function Ft(_,S){var A=Ki;Ki|=1;try{return _(S)}finally{Ki=A,Ki===0&&(j=yr()+500,qh&&jc())}}function Xe(_){ce!==null&&ce.tag===0&&(Ki&6)===0&&Dr();var S=Ki;Ki|=1;var A=wc.transition,N=yi;try{if(wc.transition=null,yi=1,_)return _()}finally{yi=N,wc.transition=A,Ki=S,(Ki&6)===0&&jc()}}function je(){h=n.current,Po(n)}function dt(_,S){_.finishedWork=null,_.finishedLanes=0;var A=_.timeoutHandle;if(A!==-1&&(_.timeoutHandle=-1,qd(A)),as!==null)for(A=as.return;A!==null;){var N=A;switch(Jf(N),N.tag){case 1:N=N.type.childContextTypes,N!=null&&hu();break;case 3:yd(),Po(Ls),Po(Hs),sp();break;case 5:rm(N);break;case 4:yd();break;case 13:Po(rs);break;case 19:Po(rs);break;case 10:Xh(N.type._context);break;case 22:case 23:je()}A=A.return}if(ha=_,as=_=Jr(_.current,null),oo=h=S,l=0,f=null,E=w=v=0,D=M=null,xl!==null){for(S=0;S<xl.length;S++)if(A=xl[S],N=A.interleaved,N!==null){A.interleaved=null;var K=N.next,oe=A.pending;if(oe!==null){var Ee=oe.next;oe.next=K,N.next=Ee}A.pending=N}xl=null}return _}function rt(_,S){do{var A=as;try{if(ag(),Ys.current=pn,tf){for(var N=$o.memoizedState;N!==null;){var K=N.queue;K!==null&&(K.pending=null),N=N.next}tf=!1}if(vd=0,zs=_s=$o=null,da=!1,mi=0,Sg.current=null,A===null||A.return===null){l=1,f=S,as=null;break}e:{var oe=_,Ee=A.return,Ke=A,ut=S;if(S=oo,Ke.flags|=32768,ut!==null&&typeof ut=="object"&&typeof ut.then=="function"){var Yt=ut,Er=Ke,Ar=Er.tag;if((Er.mode&1)===0&&(Ar===0||Ar===11||Ar===15)){var Pr=Er.alternate;Pr?(Er.updateQueue=Pr.updateQueue,Er.memoizedState=Pr.memoizedState,Er.lanes=Pr.lanes):(Er.updateQueue=null,Er.memoizedState=null)}var un=Hl(Ee);if(un!==null){un.flags&=-257,fm(un,Ee,Ke,oe,S),un.mode&1&&hm(oe,Yt,S),S=un,ut=Yt;var fn=S.updateQueue;if(fn===null){var an=new Set;an.add(ut),S.updateQueue=an}else fn.add(ut);break e}else{if((S&1)===0){hm(oe,Yt,S),$t();break e}ut=Error(a(426))}}else if(go&&Ke.mode&1){var Io=Hl(Ee);if(Io!==null){(Io.flags&65536)===0&&(Io.flags|=256),fm(Io,Ee,Ke,oe,S),ep(Gl(ut,Ke));break e}}oe=ut=Gl(ut,Ke),l!==4&&(l=2),M===null?M=[oe]:M.push(oe),oe=Ee;do{switch(oe.tag){case 3:oe.flags|=65536,S&=-S,oe.lanes|=S;var Lt=ah(oe,ut,S);em(oe,Lt);break e;case 1:Ke=ut;var vt=oe.type,Bt=oe.stateNode;if((oe.flags&128)===0&&(typeof vt.getDerivedStateFromError=="function"||Bt!==null&&typeof Bt.componentDidCatch=="function"&&(ee===null||!ee.has(Bt)))){oe.flags|=65536,S&=-S,oe.lanes|=S;var kr=$u(oe,Ke,S);em(oe,kr);break e}}oe=oe.return}while(oe!==null)}lr(A)}catch(mn){S=mn,as===A&&A!==null&&(as=A=A.return);continue}break}while(!0)}function Mt(){var _=wl.current;return wl.current=pn,_===null?pn:_}function $t(){(l===0||l===3||l===2)&&(l=4),ha===null||(v&268435455)===0&&(w&268435455)===0||Qe(ha,oo)}function fr(_,S){var A=Ki;Ki|=2;var N=Mt();(ha!==_||oo!==S)&&(q=null,dt(_,S));do try{kt();break}catch(K){rt(_,K)}while(!0);if(ag(),Ki=A,wl.current=N,as!==null)throw Error(a(261));return ha=null,oo=0,l}function kt(){for(;as!==null;)mr(as)}function Nt(){for(;as!==null&&!gr();)mr(as)}function mr(_){var S=ti(_.alternate,_,h);_.memoizedProps=_.pendingProps,S===null?lr(_):as=S,Sg.current=null}function lr(_){var S=_;do{var A=S.alternate;if(_=S.return,(S.flags&32768)===0){if(A=M_(A,S,h),A!==null){as=A;return}}else{if(A=lv(A,S),A!==null){A.flags&=32767,as=A;return}if(_!==null)_.flags|=32768,_.subtreeFlags=0,_.deletions=null;else{l=6,as=null;return}}if(S=S.sibling,S!==null){as=S;return}as=S=_}while(S!==null);l===0&&(l=5)}function Qt(_,S,A){var N=yi,K=wc.transition;try{wc.transition=null,yi=1,ur(_,S,A,N)}finally{wc.transition=K,yi=N}return null}function ur(_,S,A,N){do Dr();while(ce!==null);if((Ki&6)!==0)throw Error(a(327));A=_.finishedWork;var K=_.finishedLanes;if(A===null)return null;if(_.finishedWork=null,_.finishedLanes=0,A===_.current)throw Error(a(177));_.callbackNode=null,_.callbackPriority=0;var oe=A.lanes|A.childLanes;if(Ds(_,oe),_===ha&&(as=ha=null,oo=0),(A.subtreeFlags&2064)===0&&(A.flags&2064)===0||re||(re=!0,Tn(Cn,function(){return Dr(),null})),oe=(A.flags&15990)!==0,(A.subtreeFlags&15990)!==0||oe){oe=wc.transition,wc.transition=null;var Ee=yi;yi=1;var Ke=Ki;Ki|=4,Sg.current=null,_p(_,A),vm(A,_),T(qf),Ge=!!Yp,qf=Yp=null,_.current=A,xm(A),jr(),Ki=Ke,yi=Ee,wc.transition=oe}else _.current=A;if(re&&(re=!1,ce=_,ae=K),oe=_.pendingLanes,oe===0&&(ee=null),Ln(A.stateNode),be(_,yr()),S!==null)for(N=_.onRecoverableError,A=0;A<S.length;A++)K=S[A],N(K.value,{componentStack:K.stack,digest:K.digest});if(U)throw U=!1,_=Y,Y=null,_;return(ae&1)!==0&&_.tag!==0&&Dr(),oe=_.pendingLanes,(oe&1)!==0?_===ye?de++:(de=0,ye=_):de=0,jc(),null}function Dr(){if(ce!==null){var _=ic(ae),S=wc.transition,A=yi;try{if(wc.transition=null,yi=16>_?16:_,ce===null)var N=!1;else{if(_=ce,ce=null,ae=0,(Ki&6)!==0)throw Error(a(331));var K=Ki;for(Ki|=4,dn=_.current;dn!==null;){var oe=dn,Ee=oe.child;if((dn.flags&16)!==0){var Ke=oe.deletions;if(Ke!==null){for(var ut=0;ut<Ke.length;ut++){var Yt=Ke[ut];for(dn=Yt;dn!==null;){var Er=dn;switch(Er.tag){case 0:case 11:case 15:dh(8,Er,oe)}var Ar=Er.child;if(Ar!==null)Ar.return=Er,dn=Ar;else for(;dn!==null;){Er=dn;var Pr=Er.sibling,un=Er.return;if(yp(Er),Er===Yt){dn=null;break}if(Pr!==null){Pr.return=un,dn=Pr;break}dn=un}}}var fn=oe.alternate;if(fn!==null){var an=fn.child;if(an!==null){fn.child=null;do{var Io=an.sibling;an.sibling=null,an=Io}while(an!==null)}}dn=oe}}if((oe.subtreeFlags&2064)!==0&&Ee!==null)Ee.return=oe,dn=Ee;else e:for(;dn!==null;){if(oe=dn,(oe.flags&2048)!==0)switch(oe.tag){case 0:case 11:case 15:dh(9,oe,oe.return)}var Lt=oe.sibling;if(Lt!==null){Lt.return=oe.return,dn=Lt;break e}dn=oe.return}}var vt=_.current;for(dn=vt;dn!==null;){Ee=dn;var Bt=Ee.child;if((Ee.subtreeFlags&2064)!==0&&Bt!==null)Bt.return=Ee,dn=Bt;else e:for(Ee=vt;dn!==null;){if(Ke=dn,(Ke.flags&2048)!==0)try{switch(Ke.tag){case 0:case 11:case 15:hh(9,Ke)}}catch(mn){Kr(Ke,Ke.return,mn)}if(Ke===Ee){dn=null;break e}var kr=Ke.sibling;if(kr!==null){kr.return=Ke.return,dn=kr;break e}dn=Ke.return}}if(Ki=K,jc(),si&&typeof si.onPostCommitFiberRoot=="function")try{si.onPostCommitFiberRoot(Ti,_)}catch{}N=!0}return N}finally{yi=A,wc.transition=S}}return!1}function _n(_,S,A){S=Gl(A,S),S=ah(_,S,1),_=ql(_,S,1),S=xe(),_!==null&&(Ho(_,1,S),be(_,S))}function Kr(_,S,A){if(_.tag===3)_n(_,_,A);else for(;S!==null;){if(S.tag===3){_n(S,_,A);break}else if(S.tag===1){var N=S.stateNode;if(typeof S.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&(ee===null||!ee.has(N))){_=Gl(A,_),_=$u(S,_,1),S=ql(S,_,1),_=xe(),S!==null&&(Ho(S,1,_),be(S,_));break}}S=S.return}}function hi(_,S,A){var N=_.pingCache;N!==null&&N.delete(S),S=xe(),_.pingedLanes|=_.suspendedLanes&A,ha===_&&(oo&A)===A&&(l===4||l===3&&(oo&130023424)===oo&&500>yr()-B?dt(_,0):E|=A),be(_,S)}function Wr(_,S){S===0&&((_.mode&1)===0?S=1:(S=Ji,Ji<<=1,(Ji&130023424)===0&&(Ji=4194304)));var A=xe();_=pc(_,S),_!==null&&(Ho(_,S,A),be(_,A))}function Sn(_){var S=_.memoizedState,A=0;S!==null&&(A=S.retryLane),Wr(_,A)}function sn(_,S){var A=0;switch(_.tag){case 13:var N=_.stateNode,K=_.memoizedState;K!==null&&(A=K.retryLane);break;case 19:N=_.stateNode;break;default:throw Error(a(314))}N!==null&&N.delete(S),Wr(_,A)}var ti;ti=function(_,S,A){if(_!==null)if(_.memoizedProps!==S.pendingProps||Ls.current)Zs=!0;else{if((_.lanes&A)===0&&(S.flags&128)===0)return Zs=!1,_g(_,S,A);Zs=(_.flags&131072)!==0}else Zs=!1,go&&(S.flags&1048576)!==0&&P_(S,Qf,S.index);switch(S.lanes=0,S.tag){case 2:var N=S.type;df(_,S),_=S.pendingProps;var K=Zd(S,Hs.current);el(S,A),K=om(null,S,N,_,K,A);var oe=Uc();return S.flags|=1,typeof K=="object"&&K!==null&&typeof K.render=="function"&&K.$$typeof===void 0?(S.tag=1,S.memoizedState=null,S.updateQueue=null,ua(N)?(oe=!0,$h(S)):oe=!1,S.memoizedState=K.state!==null&&K.state!==void 0?K.state:null,Qh(S),K.updater=nf,S.stateNode=K,K._reactInternals=S,il(S,N,_,A),S=mp(null,S,N,!0,oe,A)):(S.tag=0,go&&oe&&Gh(S),Fs(null,S,K,A),S=S.child),S;case 16:N=S.elementType;e:{switch(df(_,S),_=S.pendingProps,K=N._init,N=K(N._payload),S.type=N,K=S.tag=qn(N),_=$a(N,_),K){case 0:S=pp(null,S,N,_,A);break e;case 1:S=sf(null,S,N,_,A);break e;case 11:S=Li(null,S,N,_,A);break e;case 14:S=lh(null,S,N,$a(N.type,_),A);break e}throw Error(a(306,N,""))}return S;case 0:return N=S.type,K=S.pendingProps,K=S.elementType===N?K:$a(N,K),pp(_,S,N,K,A);case 1:return N=S.type,K=S.pendingProps,K=S.elementType===N?K:$a(N,K),sf(_,S,N,K,A);case 3:e:{if(Wu(S),_===null)throw Error(a(387));N=S.pendingProps,oe=S.memoizedState,K=oe.element,lg(_,S),gc(S,N,null,A);var Ee=S.memoizedState;if(N=Ee.element,oe.isDehydrated)if(oe={element:N,isDehydrated:!1,cache:Ee.cache,pendingSuspenseBoundaries:Ee.pendingSuspenseBoundaries,transitions:Ee.transitions},S.updateQueue.baseState=oe,S.memoizedState=oe,S.flags&256){K=Gl(Error(a(423)),S),S=_m(_,S,N,A,K);break e}else if(N!==K){K=Gl(Error(a(424)),S),S=_m(_,S,N,A,K);break e}else for(vl=du(S.stateNode.containerInfo.firstChild),Ja=S,go=!0,Ul=null,A=np(S,null,N,A),S.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling;else{if($l(),N===K){S=_u(_,S,A);break e}Fs(_,S,N,A)}S=S.child}return S;case 5:return tm(S),_===null&&Vc(S),N=S.type,K=S.pendingProps,oe=_!==null?_.memoizedProps:null,Ee=K.children,jh(N,K)?Ee=null:oe!==null&&jh(N,oe)&&(S.flags|=32),bd(_,S),Fs(_,S,Ee,A),S.child;case 6:return _===null&&Vc(S),null;case 13:return ch(_,S,A);case 4:return ef(S,S.stateNode.containerInfo),N=S.pendingProps,_===null?S.child=_d(S,null,N,A):Fs(_,S,N,A),S.child;case 11:return N=S.type,K=S.pendingProps,K=S.elementType===N?K:$a(N,K),Li(_,S,N,K,A);case 7:return Fs(_,S,S.pendingProps,A),S.child;case 8:return Fs(_,S,S.pendingProps.children,A),S.child;case 12:return Fs(_,S,S.pendingProps.children,A),S.child;case 10:e:{if(N=S.type._context,K=S.pendingProps,oe=S.memoizedProps,Ee=K.value,vo(Nu,N._currentValue),N._currentValue=Ee,oe!==null)if(ca(oe.value,Ee)){if(oe.children===K.children&&!Ls.current){S=_u(_,S,A);break e}}else for(oe=S.child,oe!==null&&(oe.return=S);oe!==null;){var Ke=oe.dependencies;if(Ke!==null){Ee=oe.child;for(var ut=Ke.firstContext;ut!==null;){if(ut.context===N){if(oe.tag===1){ut=tl(-1,A&-A),ut.tag=2;var Yt=oe.updateQueue;if(Yt!==null){Yt=Yt.shared;var Er=Yt.pending;Er===null?ut.next=ut:(ut.next=Er.next,Er.next=ut),Yt.pending=ut}}oe.lanes|=A,ut=oe.alternate,ut!==null&&(ut.lanes|=A),Kh(oe.return,A,S),Ke.lanes|=A;break}ut=ut.next}}else if(oe.tag===10)Ee=oe.type===S.type?null:oe.child;else if(oe.tag===18){if(Ee=oe.return,Ee===null)throw Error(a(341));Ee.lanes|=A,Ke=Ee.alternate,Ke!==null&&(Ke.lanes|=A),Kh(Ee,A,S),Ee=oe.sibling}else Ee=oe.child;if(Ee!==null)Ee.return=oe;else for(Ee=oe;Ee!==null;){if(Ee===S){Ee=null;break}if(oe=Ee.sibling,oe!==null){oe.return=Ee.return,Ee=oe;break}Ee=Ee.return}oe=Ee}Fs(_,S,K.children,A),S=S.child}return S;case 9:return K=S.type,N=S.pendingProps.children,el(S,A),K=Va(K),N=N(K),S.flags|=1,Fs(_,S,N,A),S.child;case 14:return N=S.type,K=$a(N,S.pendingProps),K=$a(N.type,K),lh(_,S,N,K,A);case 15:return mm(_,S,S.type,S.pendingProps,A);case 17:return N=S.type,K=S.pendingProps,K=S.elementType===N?K:$a(N,K),df(_,S),S.tag=1,ua(N)?(_=!0,$h(S)):_=!1,el(S,A),hp(S,N,K),il(S,N,K,A),mp(null,S,N,!0,_,A);case 19:return uf(_,S,A);case 22:return gm(_,S,A)}throw Error(a(156,S.tag))};function Tn(_,S){return Ot(_,S)}function vi(_,S,A,N){this.tag=_,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=S,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yn(_,S,A,N){return new vi(_,S,A,N)}function nn(_){return _=_.prototype,!(!_||!_.isReactComponent)}function qn(_){if(typeof _=="function")return nn(_)?1:0;if(_!=null){if(_=_.$$typeof,_===Ir)return 11;if(_===Or)return 14}return 2}function Jr(_,S){var A=_.alternate;return A===null?(A=yn(_.tag,S,_.key,_.mode),A.elementType=_.elementType,A.type=_.type,A.stateNode=_.stateNode,A.alternate=_,_.alternate=A):(A.pendingProps=S,A.type=_.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=_.flags&14680064,A.childLanes=_.childLanes,A.lanes=_.lanes,A.child=_.child,A.memoizedProps=_.memoizedProps,A.memoizedState=_.memoizedState,A.updateQueue=_.updateQueue,S=_.dependencies,A.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext},A.sibling=_.sibling,A.index=_.index,A.ref=_.ref,A}function xi(_,S,A,N,K,oe){var Ee=2;if(N=_,typeof _=="function")nn(_)&&(Ee=1);else if(typeof _=="string")Ee=5;else e:switch(_){case ke:return Pn(A.children,K,oe,S);case ze:Ee=8,K|=8;break;case et:return _=yn(12,A,S,K|2),_.elementType=et,_.lanes=oe,_;case nr:return _=yn(13,A,S,K),_.elementType=nr,_.lanes=oe,_;case Fr:return _=yn(19,A,S,K),_.elementType=Fr,_.lanes=oe,_;case lt:return qr(A,K,oe,S);default:if(typeof _=="object"&&_!==null)switch(_.$$typeof){case ht:Ee=10;break e;case Xt:Ee=9;break e;case Ir:Ee=11;break e;case Or:Ee=14;break e;case or:Ee=16,N=null;break e}throw Error(a(130,_==null?_:typeof _,""))}return S=yn(Ee,A,S,K),S.elementType=_,S.type=N,S.lanes=oe,S}function Pn(_,S,A,N){return _=yn(7,_,N,S),_.lanes=A,_}function qr(_,S,A,N){return _=yn(22,_,N,S),_.elementType=lt,_.lanes=A,_.stateNode={isHidden:!1},_}function En(_,S,A){return _=yn(6,_,null,S),_.lanes=A,_}function zi(_,S,A){return S=yn(4,_.children!==null?_.children:[],_.key,S),S.lanes=A,S.stateNode={containerInfo:_.containerInfo,pendingChildren:null,implementation:_.implementation},S}function _o(_,S,A,N,K){this.tag=S,this.containerInfo=_,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=As(0),this.expirationTimes=As(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=As(0),this.identifierPrefix=N,this.onRecoverableError=K,this.mutableSourceEagerHydrationData=null}function ki(_,S,A,N,K,oe,Ee,Ke,ut){return _=new _o(_,S,A,Ke,ut),S===1?(S=1,oe===!0&&(S|=8)):S=0,oe=yn(3,null,null,S),_.current=oe,oe.stateNode=_,oe.memoizedState={element:N,isDehydrated:A,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qh(oe),_}function so(_,S,A){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Re,key:N==null?null:""+N,children:_,containerInfo:S,implementation:A}}function Wa(_){if(!_)return Bc;_=_._reactInternals;e:{if(Oe(_)!==_||_.tag!==1)throw Error(a(170));var S=_;do{switch(S.tag){case 3:S=S.stateNode.context;break e;case 1:if(ua(S.type)){S=S.stateNode.__reactInternalMemoizedMergedChildContext;break e}}S=S.return}while(S!==null);throw Error(a(171))}if(_.tag===1){var A=_.type;if(ua(A))return yl(_,A,S)}return S}function Ca(_,S,A,N,K,oe,Ee,Ke,ut){return _=ki(A,N,!0,_,K,oe,Ee,Ke,ut),_.context=Wa(null),A=_.current,N=xe(),K=Ce(A),oe=tl(N,K),oe.callback=S??null,ql(A,oe,K),_.current.lanes=K,Ho(_,K,N),be(_,N),_}function ls(_,S,A,N){var K=S.current,oe=xe(),Ee=Ce(K);return A=Wa(A),S.context===null?S.context=A:S.pendingContext=A,S=tl(oe,Ee),S.payload={element:_},N=N===void 0?null:N,N!==null&&(S.callback=N),_=ql(K,S,Ee),_!==null&&(Te(_,K,Ee,oe),cr(_,K,Ee)),Ee}function vs(_){if(_=_.current,!_.child)return null;switch(_.child.tag){case 5:return _.child.stateNode;default:return _.child.stateNode}}function Sl(_,S){if(_=_.memoizedState,_!==null&&_.dehydrated!==null){var A=_.retryLane;_.retryLane=A!==0&&A<S?A:S}}function xs(_,S){Sl(_,S),(_=_.alternate)&&Sl(_,S)}function Xl(){return null}var Kl=typeof reportError=="function"?reportError:function(_){console.error(_)};function is(_){this._internalRoot=_}Bi.prototype.render=is.prototype.render=function(_){var S=this._internalRoot;if(S===null)throw Error(a(409));ls(_,S,null,null)},Bi.prototype.unmount=is.prototype.unmount=function(){var _=this._internalRoot;if(_!==null){this._internalRoot=null;var S=_.containerInfo;Xe(function(){ls(null,_,null,null)}),S[Fc]=null}};function Bi(_){this._internalRoot=_}Bi.prototype.unstable_scheduleHydration=function(_){if(_){var S=ts();_={blockedOn:null,target:_,priority:S};for(var A=0;A<Ea.length&&S!==0&&S<Ea[A].priority;A++);Ea.splice(A,0,_),A===0&&Rc(_)}};function ao(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11)}function li(_){return!(!_||_.nodeType!==1&&_.nodeType!==9&&_.nodeType!==11&&(_.nodeType!==8||_.nodeValue!==" react-mount-point-unstable "))}function yo(){}function bs(_,S,A,N,K){if(K){if(typeof N=="function"){var oe=N;N=function(){var Yt=vs(Ee);oe.call(Yt)}}var Ee=Ca(S,N,_,0,null,!1,!1,"",yo);return _._reactRootContainer=Ee,_[Fc]=Ee.current,Wf(_.nodeType===8?_.parentNode:_),Xe(),Ee}for(;K=_.lastChild;)_.removeChild(K);if(typeof N=="function"){var Ke=N;N=function(){var Yt=vs(ut);Ke.call(Yt)}}var ut=ki(_,0,!1,null,null,!1,!1,"",yo);return _._reactRootContainer=ut,_[Fc]=ut.current,Wf(_.nodeType===8?_.parentNode:_),Xe(function(){ls(S,ut,A,N)}),ut}function ji(_,S,A,N,K){var oe=A._reactRootContainer;if(oe){var Ee=oe;if(typeof K=="function"){var Ke=K;K=function(){var ut=vs(Ee);Ke.call(ut)}}ls(S,Ee,_,K)}else Ee=bs(A,S,_,K,N);return vs(Ee)}oc=function(_){switch(_.tag){case 3:var S=_.stateNode;if(S.current.memoizedState.isDehydrated){var A=To(S.pendingLanes);A!==0&&(nc(S,A|1),be(S,yr()),(Ki&6)===0&&(j=yr()+500,jc()))}break;case 13:Xe(function(){var N=pc(_,1);if(N!==null){var K=xe();Te(N,_,1,K)}}),xs(_,1)}},es=function(_){if(_.tag===13){var S=pc(_,134217728);if(S!==null){var A=xe();Te(S,_,134217728,A)}xs(_,134217728)}},Rs=function(_){if(_.tag===13){var S=Ce(_),A=pc(_,S);if(A!==null){var N=xe();Te(A,_,S,N)}xs(_,S)}},ts=function(){return yi},Os=function(_,S){var A=yi;try{return yi=_,S()}finally{yi=A}},_i=function(_,S,A){switch(S){case"input":if(Ii(_,A),S=A.name,A.type==="radio"&&S!=null){for(A=_;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll("input[name="+JSON.stringify(""+S)+'][type="radio"]'),S=0;S<A.length;S++){var N=A[S];if(N!==_&&N.form===_.form){var K=Hd(N);if(!K)throw Error(a(90));Vn(N),Ii(N,K)}}}break;case"textarea":Bo(_,A);break;case"select":S=A.value,S!=null&&co(_,!!A.multiple,S,!1)}},rc=Ft,ru=Xe;var Ql={usingClientEntryPoint:!1,Events:[Uh,kc,Hd,Ms,Dc,Ft]},vu={findFiberByHostInstance:fd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Gu={bundleType:vu.bundleType,version:vu.version,rendererPackageName:vu.rendererPackageName,rendererConfig:vu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ne.ReactCurrentDispatcher,findHostInstanceByFiber:function(_){return _=We(_),_===null?null:_.stateNode},findFiberByHostInstance:vu.findFiberByHostInstance||Xl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hu.isDisabled&&Hu.supportsFiber)try{Ti=Hu.inject(Gu),si=Hu}catch{}}return xu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ql,xu.createPortal=function(_,S){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ao(S))throw Error(a(200));return so(_,S,null,A)},xu.createRoot=function(_,S){if(!ao(_))throw Error(a(299));var A=!1,N="",K=Kl;return S!=null&&(S.unstable_strictMode===!0&&(A=!0),S.identifierPrefix!==void 0&&(N=S.identifierPrefix),S.onRecoverableError!==void 0&&(K=S.onRecoverableError)),S=ki(_,1,!1,null,null,A,!1,N,K),_[Fc]=S.current,Wf(_.nodeType===8?_.parentNode:_),new is(S)},xu.findDOMNode=function(_){if(_==null)return null;if(_.nodeType===1)return _;var S=_._reactInternals;if(S===void 0)throw typeof _.render=="function"?Error(a(188)):(_=Object.keys(_).join(","),Error(a(268,_)));return _=We(S),_=_===null?null:_.stateNode,_},xu.flushSync=function(_){return Xe(_)},xu.hydrate=function(_,S,A){if(!li(S))throw Error(a(200));return ji(null,_,S,!0,A)},xu.hydrateRoot=function(_,S,A){if(!ao(_))throw Error(a(405));var N=A!=null&&A.hydratedSources||null,K=!1,oe="",Ee=Kl;if(A!=null&&(A.unstable_strictMode===!0&&(K=!0),A.identifierPrefix!==void 0&&(oe=A.identifierPrefix),A.onRecoverableError!==void 0&&(Ee=A.onRecoverableError)),S=Ca(S,null,_,1,A??null,K,!1,oe,Ee),_[Fc]=S.current,Wf(_),N)for(_=0;_<N.length;_++)A=N[_],K=A._getVersion,K=K(A._source),S.mutableSourceEagerHydrationData==null?S.mutableSourceEagerHydrationData=[A,K]:S.mutableSourceEagerHydrationData.push(A,K);return new Bi(S)},xu.render=function(_,S,A){if(!li(S))throw Error(a(200));return ji(null,_,S,!1,A)},xu.unmountComponentAtNode=function(_){if(!li(_))throw Error(a(40));return _._reactRootContainer?(Xe(function(){ji(null,null,_,!1,function(){_._reactRootContainer=null,_[Fc]=null})}),!0):!1},xu.unstable_batchedUpdates=Ft,xu.unstable_renderSubtreeIntoContainer=function(_,S,A,N){if(!li(A))throw Error(a(200));if(_==null||_._reactInternals===void 0)throw Error(a(38));return ji(_,S,A,!1,N)},xu.version="18.3.1-next-f1338f8080-20240426",xu}var Yk;function cW(){if(Yk)return KT.exports;Yk=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),KT.exports=hQ(),KT.exports}var Zk;function fQ(){if(Zk)return Rb;Zk=1;var e=cW();return Rb.createRoot=e.createRoot,Rb.hydrateRoot=e.hydrateRoot,Rb}var pQ=fQ();const mQ=hx(pQ);var uW=cW();function $0(){return $0=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},$0.apply(this,arguments)}var Bm;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Bm||(Bm={}));const Xk="popstate";function gQ(e){e===void 0&&(e={});function r(u,p){let{pathname:y,search:x,hash:i}=u.location;return aA("",{pathname:y,search:x,hash:i},p.state&&p.state.usr||null,p.state&&p.state.key||"default")}function a(u,p){return typeof p=="string"?p:yw(p)}return yQ(r,a,null,e)}function Xa(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function dW(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function _Q(){return Math.random().toString(36).substr(2,8)}function Kk(e,r){return{usr:e.state,key:e.key,idx:r}}function aA(e,r,a,u){return a===void 0&&(a=null),$0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?Wy(r):r,{state:a,key:r&&r.key||u||_Q()})}function yw(e){let{pathname:r="/",search:a="",hash:u=""}=e;return a&&a!=="?"&&(r+=a.charAt(0)==="?"?a:"?"+a),u&&u!=="#"&&(r+=u.charAt(0)==="#"?u:"#"+u),r}function Wy(e){let r={};if(e){let a=e.indexOf("#");a>=0&&(r.hash=e.substr(a),e=e.substr(0,a));let u=e.indexOf("?");u>=0&&(r.search=e.substr(u),e=e.substr(0,u)),e&&(r.pathname=e)}return r}function yQ(e,r,a,u){u===void 0&&(u={});let{window:p=document.defaultView,v5Compat:y=!1}=u,x=p.history,i=Bm.Pop,C=null,R=z();R==null&&(R=0,x.replaceState($0({},x.state,{idx:R}),""));function z(){return(x.state||{idx:null}).idx}function F(){i=Bm.Pop;let J=z(),se=J==null?null:J-R;R=J,C&&C({action:i,location:Z.location,delta:se})}function V(J,se){i=Bm.Push;let pe=aA(Z.location,J,se);R=z()+1;let ve=Kk(pe,R),Ne=Z.createHref(pe);try{x.pushState(ve,"",Ne)}catch(_e){if(_e instanceof DOMException&&_e.name==="DataCloneError")throw _e;p.location.assign(Ne)}y&&C&&C({action:i,location:Z.location,delta:1})}function G(J,se){i=Bm.Replace;let pe=aA(Z.location,J,se);R=z();let ve=Kk(pe,R),Ne=Z.createHref(pe);x.replaceState(ve,"",Ne),y&&C&&C({action:i,location:Z.location,delta:0})}function H(J){let se=p.location.origin!=="null"?p.location.origin:p.location.href,pe=typeof J=="string"?J:yw(J);return pe=pe.replace(/ $/,"%20"),Xa(se,"No window.location.(origin|href) available to create URL for href: "+pe),new URL(pe,se)}let Z={get action(){return i},get location(){return e(p,x)},listen(J){if(C)throw new Error("A history only accepts one active listener");return p.addEventListener(Xk,F),C=J,()=>{p.removeEventListener(Xk,F),C=null}},createHref(J){return r(p,J)},createURL:H,encodeLocation(J){let se=H(J);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:V,replace:G,go(J){return x.go(J)}};return Z}var Qk;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Qk||(Qk={}));function vQ(e,r,a){return a===void 0&&(a="/"),xQ(e,r,a)}function xQ(e,r,a,u){let p=typeof r=="string"?Wy(r):r,y=AD(p.pathname||"/",a);if(y==null)return null;let x=hW(e);bQ(x);let i=null;for(let C=0;i==null&&C<x.length;++C){let R=OQ(y);i=AQ(x[C],R)}return i}function hW(e,r,a,u){r===void 0&&(r=[]),a===void 0&&(a=[]),u===void 0&&(u="");let p=(y,x,i)=>{let C={relativePath:i===void 0?y.path||"":i,caseSensitive:y.caseSensitive===!0,childrenIndex:x,route:y};C.relativePath.startsWith("/")&&(Xa(C.relativePath.startsWith(u),'Absolute route path "'+C.relativePath+'" nested under path '+('"'+u+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),C.relativePath=C.relativePath.slice(u.length));let R=jm([u,C.relativePath]),z=a.concat(C);y.children&&y.children.length>0&&(Xa(y.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+R+'".')),hW(y.children,r,z,R)),!(y.path==null&&!y.index)&&r.push({path:R,score:MQ(R,y.index),routesMeta:z})};return e.forEach((y,x)=>{var i;if(y.path===""||!((i=y.path)!=null&&i.includes("?")))p(y,x);else for(let C of fW(y.path))p(y,x,C)}),r}function fW(e){let r=e.split("/");if(r.length===0)return[];let[a,...u]=r,p=a.endsWith("?"),y=a.replace(/\?$/,"");if(u.length===0)return p?[y,""]:[y];let x=fW(u.join("/")),i=[];return i.push(...x.map(C=>C===""?y:[y,C].join("/"))),p&&i.push(...x),i.map(C=>e.startsWith("/")&&C===""?"/":C)}function bQ(e){e.sort((r,a)=>r.score!==a.score?a.score-r.score:CQ(r.routesMeta.map(u=>u.childrenIndex),a.routesMeta.map(u=>u.childrenIndex)))}const wQ=/^:[\w-]+$/,SQ=3,TQ=2,EQ=1,PQ=10,IQ=-2,Jk=e=>e==="*";function MQ(e,r){let a=e.split("/"),u=a.length;return a.some(Jk)&&(u+=IQ),r&&(u+=TQ),a.filter(p=>!Jk(p)).reduce((p,y)=>p+(wQ.test(y)?SQ:y===""?EQ:PQ),u)}function CQ(e,r){return e.length===r.length&&e.slice(0,-1).every((u,p)=>u===r[p])?e[e.length-1]-r[r.length-1]:0}function AQ(e,r,a){let{routesMeta:u}=e,p={},y="/",x=[];for(let i=0;i<u.length;++i){let C=u[i],R=i===u.length-1,z=y==="/"?r:r.slice(y.length)||"/",F=DQ({path:C.relativePath,caseSensitive:C.caseSensitive,end:R},z),V=C.route;if(!F)return null;Object.assign(p,F.params),x.push({params:p,pathname:jm([y,F.pathname]),pathnameBase:kQ(jm([y,F.pathnameBase])),route:V}),F.pathnameBase!=="/"&&(y=jm([y,F.pathnameBase]))}return x}function DQ(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,u]=RQ(e.path,e.caseSensitive,e.end),p=r.match(a);if(!p)return null;let y=p[0],x=y.replace(/(.)\/+$/,"$1"),i=p.slice(1);return{params:u.reduce((R,z,F)=>{let{paramName:V,isOptional:G}=z;if(V==="*"){let Z=i[F]||"";x=y.slice(0,y.length-Z.length).replace(/(.)\/+$/,"$1")}const H=i[F];return G&&!H?R[V]=void 0:R[V]=(H||"").replace(/%2F/g,"/"),R},{}),pathname:y,pathnameBase:x,pattern:e}}function RQ(e,r,a){r===void 0&&(r=!1),a===void 0&&(a=!0),dW(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let u=[],p="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(x,i,C)=>(u.push({paramName:i,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(u.push({paramName:"*"}),p+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?p+="\\/*$":e!==""&&e!=="/"&&(p+="(?:(?=\\/|$))"),[new RegExp(p,r?void 0:"i"),u]}function OQ(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return dW(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function AD(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let a=r.endsWith("/")?r.length-1:r.length,u=e.charAt(a);return u&&u!=="/"?null:e.slice(a)||"/"}function LQ(e,r){r===void 0&&(r="/");let{pathname:a,search:u="",hash:p=""}=typeof e=="string"?Wy(e):e;return{pathname:a?a.startsWith("/")?a:zQ(a,r):r,search:BQ(u),hash:jQ(p)}}function zQ(e,r){let a=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(p=>{p===".."?a.length>1&&a.pop():p!=="."&&a.push(p)}),a.length>1?a.join("/"):"/"}function e2(e,r,a,u){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(u)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function FQ(e){return e.filter((r,a)=>a===0||r.route.path&&r.route.path.length>0)}function pW(e,r){let a=FQ(e);return r?a.map((u,p)=>p===a.length-1?u.pathname:u.pathnameBase):a.map(u=>u.pathnameBase)}function mW(e,r,a,u){u===void 0&&(u=!1);let p;typeof e=="string"?p=Wy(e):(p=$0({},e),Xa(!p.pathname||!p.pathname.includes("?"),e2("?","pathname","search",p)),Xa(!p.pathname||!p.pathname.includes("#"),e2("#","pathname","hash",p)),Xa(!p.search||!p.search.includes("#"),e2("#","search","hash",p)));let y=e===""||p.pathname==="",x=y?"/":p.pathname,i;if(x==null)i=a;else{let F=r.length-1;if(!u&&x.startsWith("..")){let V=x.split("/");for(;V[0]==="..";)V.shift(),F-=1;p.pathname=V.join("/")}i=F>=0?r[F]:"/"}let C=LQ(p,i),R=x&&x!=="/"&&x.endsWith("/"),z=(y||x===".")&&a.endsWith("/");return!C.pathname.endsWith("/")&&(R||z)&&(C.pathname+="/"),C}const jm=e=>e.join("/").replace(/\/\/+/g,"/"),kQ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),BQ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,jQ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function NQ(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const gW=["post","put","patch","delete"];new Set(gW);const VQ=["get",...gW];new Set(VQ);function W0(){return W0=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},W0.apply(this,arguments)}const DD=ge.createContext(null),UQ=ge.createContext(null),u_=ge.createContext(null),$w=ge.createContext(null),Fp=ge.createContext({outlet:null,matches:[],isDataRoute:!1}),_W=ge.createContext(null);function $Q(e,r){let{relative:a}=r===void 0?{}:r;fx()||Xa(!1);let{basename:u,navigator:p}=ge.useContext(u_),{hash:y,pathname:x,search:i}=vW(e,{relative:a}),C=x;return u!=="/"&&(C=x==="/"?u:jm([u,x])),p.createHref({pathname:C,search:i,hash:y})}function fx(){return ge.useContext($w)!=null}function px(){return fx()||Xa(!1),ge.useContext($w).location}function yW(e){ge.useContext(u_).static||ge.useLayoutEffect(e)}function kp(){let{isDataRoute:e}=ge.useContext(Fp);return e?oJ():WQ()}function WQ(){fx()||Xa(!1);let e=ge.useContext(DD),{basename:r,future:a,navigator:u}=ge.useContext(u_),{matches:p}=ge.useContext(Fp),{pathname:y}=px(),x=JSON.stringify(pW(p,a.v7_relativeSplatPath)),i=ge.useRef(!1);return yW(()=>{i.current=!0}),ge.useCallback(function(R,z){if(z===void 0&&(z={}),!i.current)return;if(typeof R=="number"){u.go(R);return}let F=mW(R,JSON.parse(x),y,z.relative==="path");e==null&&r!=="/"&&(F.pathname=F.pathname==="/"?r:jm([r,F.pathname])),(z.replace?u.replace:u.push)(F,z.state,z)},[r,u,x,y,e])}const qQ=ge.createContext(null);function GQ(e){let r=ge.useContext(Fp).outlet;return r&&ge.createElement(qQ.Provider,{value:e},r)}function HQ(){let{matches:e}=ge.useContext(Fp),r=e[e.length-1];return r?r.params:{}}function vW(e,r){let{relative:a}=r===void 0?{}:r,{future:u}=ge.useContext(u_),{matches:p}=ge.useContext(Fp),{pathname:y}=px(),x=JSON.stringify(pW(p,u.v7_relativeSplatPath));return ge.useMemo(()=>mW(e,JSON.parse(x),y,a==="path"),[e,x,y,a])}function YQ(e,r){return ZQ(e,r)}function ZQ(e,r,a,u){fx()||Xa(!1);let{navigator:p}=ge.useContext(u_),{matches:y}=ge.useContext(Fp),x=y[y.length-1],i=x?x.params:{};x&&x.pathname;let C=x?x.pathnameBase:"/";x&&x.route;let R=px(),z;if(r){var F;let J=typeof r=="string"?Wy(r):r;C==="/"||(F=J.pathname)!=null&&F.startsWith(C)||Xa(!1),z=J}else z=R;let V=z.pathname||"/",G=V;if(C!=="/"){let J=C.replace(/^\//,"").split("/");G="/"+V.replace(/^\//,"").split("/").slice(J.length).join("/")}let H=vQ(e,{pathname:G}),Z=eJ(H&&H.map(J=>Object.assign({},J,{params:Object.assign({},i,J.params),pathname:jm([C,p.encodeLocation?p.encodeLocation(J.pathname).pathname:J.pathname]),pathnameBase:J.pathnameBase==="/"?C:jm([C,p.encodeLocation?p.encodeLocation(J.pathnameBase).pathname:J.pathnameBase])})),y,a,u);return r&&Z?ge.createElement($w.Provider,{value:{location:W0({pathname:"/",search:"",hash:"",state:null,key:"default"},z),navigationType:Bm.Pop}},Z):Z}function XQ(){let e=iJ(),r=NQ(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,p={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ge.createElement(ge.Fragment,null,ge.createElement("h2",null,"Unexpected Application Error!"),ge.createElement("h3",{style:{fontStyle:"italic"}},r),a?ge.createElement("pre",{style:p},a):null,null)}const KQ=ge.createElement(XQ,null);class QQ extends ge.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,a){return a.location!==r.location||a.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:a.error,location:a.location,revalidation:r.revalidation||a.revalidation}}componentDidCatch(r,a){console.error("React Router caught the following error during render",r,a)}render(){return this.state.error!==void 0?ge.createElement(Fp.Provider,{value:this.props.routeContext},ge.createElement(_W.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function JQ(e){let{routeContext:r,match:a,children:u}=e,p=ge.useContext(DD);return p&&p.static&&p.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(p.staticContext._deepestRenderedBoundaryId=a.route.id),ge.createElement(Fp.Provider,{value:r},u)}function eJ(e,r,a,u){var p;if(r===void 0&&(r=[]),a===void 0&&(a=null),u===void 0&&(u=null),e==null){var y;if(!a)return null;if(a.errors)e=a.matches;else if((y=u)!=null&&y.v7_partialHydration&&r.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let x=e,i=(p=a)==null?void 0:p.errors;if(i!=null){let z=x.findIndex(F=>F.route.id&&i?.[F.route.id]!==void 0);z>=0||Xa(!1),x=x.slice(0,Math.min(x.length,z+1))}let C=!1,R=-1;if(a&&u&&u.v7_partialHydration)for(let z=0;z<x.length;z++){let F=x[z];if((F.route.HydrateFallback||F.route.hydrateFallbackElement)&&(R=z),F.route.id){let{loaderData:V,errors:G}=a,H=F.route.loader&&V[F.route.id]===void 0&&(!G||G[F.route.id]===void 0);if(F.route.lazy||H){C=!0,R>=0?x=x.slice(0,R+1):x=[x[0]];break}}}return x.reduceRight((z,F,V)=>{let G,H=!1,Z=null,J=null;a&&(G=i&&F.route.id?i[F.route.id]:void 0,Z=F.route.errorElement||KQ,C&&(R<0&&V===0?(sJ("route-fallback"),H=!0,J=null):R===V&&(H=!0,J=F.route.hydrateFallbackElement||null)));let se=r.concat(x.slice(0,V+1)),pe=()=>{let ve;return G?ve=Z:H?ve=J:F.route.Component?ve=ge.createElement(F.route.Component,null):F.route.element?ve=F.route.element:ve=z,ge.createElement(JQ,{match:F,routeContext:{outlet:z,matches:se,isDataRoute:a!=null},children:ve})};return a&&(F.route.ErrorBoundary||F.route.errorElement||V===0)?ge.createElement(QQ,{location:a.location,revalidation:a.revalidation,component:Z,error:G,children:pe(),routeContext:{outlet:null,matches:se,isDataRoute:!0}}):pe()},null)}var xW=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(xW||{}),bW=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(bW||{});function tJ(e){let r=ge.useContext(DD);return r||Xa(!1),r}function rJ(e){let r=ge.useContext(UQ);return r||Xa(!1),r}function nJ(e){let r=ge.useContext(Fp);return r||Xa(!1),r}function wW(e){let r=nJ(),a=r.matches[r.matches.length-1];return a.route.id||Xa(!1),a.route.id}function iJ(){var e;let r=ge.useContext(_W),a=rJ(),u=wW();return r!==void 0?r:(e=a.errors)==null?void 0:e[u]}function oJ(){let{router:e}=tJ(xW.UseNavigateStable),r=wW(bW.UseNavigateStable),a=ge.useRef(!1);return yW(()=>{a.current=!0}),ge.useCallback(function(p,y){y===void 0&&(y={}),a.current&&(typeof p=="number"?e.navigate(p):e.navigate(p,W0({fromRouteId:r},y)))},[e,r])}const e3={};function sJ(e,r,a){e3[e]||(e3[e]=!0)}function aJ(e,r){e?.v7_startTransition,e?.v7_relativeSplatPath}function lJ(e){return GQ(e.context)}function Sp(e){Xa(!1)}function cJ(e){let{basename:r="/",children:a=null,location:u,navigationType:p=Bm.Pop,navigator:y,static:x=!1,future:i}=e;fx()&&Xa(!1);let C=r.replace(/^\/*/,"/"),R=ge.useMemo(()=>({basename:C,navigator:y,static:x,future:W0({v7_relativeSplatPath:!1},i)}),[C,i,y,x]);typeof u=="string"&&(u=Wy(u));let{pathname:z="/",search:F="",hash:V="",state:G=null,key:H="default"}=u,Z=ge.useMemo(()=>{let J=AD(z,C);return J==null?null:{location:{pathname:J,search:F,hash:V,state:G,key:H},navigationType:p}},[C,z,F,V,G,H,p]);return Z==null?null:ge.createElement(u_.Provider,{value:R},ge.createElement($w.Provider,{children:a,value:Z}))}function uJ(e){let{children:r,location:a}=e;return YQ(lA(r),a)}new Promise(()=>{});function lA(e,r){r===void 0&&(r=[]);let a=[];return ge.Children.forEach(e,(u,p)=>{if(!ge.isValidElement(u))return;let y=[...r,p];if(u.type===ge.Fragment){a.push.apply(a,lA(u.props.children,y));return}u.type!==Sp&&Xa(!1),!u.props.index||!u.props.children||Xa(!1);let x={id:u.props.id||y.join("-"),caseSensitive:u.props.caseSensitive,element:u.props.element,Component:u.props.Component,index:u.props.index,path:u.props.path,loader:u.props.loader,action:u.props.action,errorElement:u.props.errorElement,ErrorBoundary:u.props.ErrorBoundary,hasErrorBoundary:u.props.ErrorBoundary!=null||u.props.errorElement!=null,shouldRevalidate:u.props.shouldRevalidate,handle:u.props.handle,lazy:u.props.lazy};u.props.children&&(x.children=lA(u.props.children,y)),a.push(x)}),a}function cA(){return cA=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},cA.apply(this,arguments)}function dJ(e,r){if(e==null)return{};var a={},u=Object.keys(e),p,y;for(y=0;y<u.length;y++)p=u[y],!(r.indexOf(p)>=0)&&(a[p]=e[p]);return a}function hJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function fJ(e,r){return e.button===0&&(!r||r==="_self")&&!hJ(e)}function uA(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((r,a)=>{let u=e[a];return r.concat(Array.isArray(u)?u.map(p=>[a,p]):[[a,u]])},[]))}function pJ(e,r){let a=uA(e);return r&&r.forEach((u,p)=>{a.has(p)||r.getAll(p).forEach(y=>{a.append(p,y)})}),a}const mJ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],gJ="6";try{window.__reactRouterVersion=gJ}catch{}const _J="startTransition",t3=sA[_J];function yJ(e){let{basename:r,children:a,future:u,window:p}=e,y=ge.useRef();y.current==null&&(y.current=gQ({window:p,v5Compat:!0}));let x=y.current,[i,C]=ge.useState({action:x.action,location:x.location}),{v7_startTransition:R}=u||{},z=ge.useCallback(F=>{R&&t3?t3(()=>C(F)):C(F)},[C,R]);return ge.useLayoutEffect(()=>x.listen(z),[x,z]),ge.useEffect(()=>aJ(u),[u]),ge.createElement(cJ,{basename:r,children:a,location:i.location,navigationType:i.action,navigator:x,future:u})}const vJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",xJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zv=ge.forwardRef(function(r,a){let{onClick:u,relative:p,reloadDocument:y,replace:x,state:i,target:C,to:R,preventScrollReset:z,viewTransition:F}=r,V=dJ(r,mJ),{basename:G}=ge.useContext(u_),H,Z=!1;if(typeof R=="string"&&xJ.test(R)&&(H=R,vJ))try{let ve=new URL(window.location.href),Ne=R.startsWith("//")?new URL(ve.protocol+R):new URL(R),_e=AD(Ne.pathname,G);Ne.origin===ve.origin&&_e!=null?R=_e+Ne.search+Ne.hash:Z=!0}catch{}let J=$Q(R,{relative:p}),se=bJ(R,{replace:x,state:i,target:C,preventScrollReset:z,relative:p,viewTransition:F});function pe(ve){u&&u(ve),ve.defaultPrevented||se(ve)}return ge.createElement("a",cA({},V,{href:H||J,onClick:Z||y?u:pe,ref:a,target:C}))});var r3;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(r3||(r3={}));var n3;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(n3||(n3={}));function bJ(e,r){let{target:a,replace:u,state:p,preventScrollReset:y,relative:x,viewTransition:i}=r===void 0?{}:r,C=kp(),R=px(),z=vW(e,{relative:x});return ge.useCallback(F=>{if(fJ(F,a)){F.preventDefault();let V=u!==void 0?u:yw(R)===yw(z);C(e,{replace:V,state:p,preventScrollReset:y,relative:x,viewTransition:i})}},[R,C,z,u,p,a,e,y,x,i])}function wJ(e){let r=ge.useRef(uA(e)),a=ge.useRef(!1),u=px(),p=ge.useMemo(()=>pJ(u.search,a.current?null:r.current),[u.search]),y=kp(),x=ge.useCallback((i,C)=>{const R=uA(typeof i=="function"?i(p):i);a.current=!0,y("?"+R,C)},[y,p]);return[p,x]}const i3=e=>{let r;const a=new Set,u=(R,z)=>{const F=typeof R=="function"?R(r):R;if(!Object.is(F,r)){const V=r;r=z??(typeof F!="object"||F===null)?F:Object.assign({},r,F),a.forEach(G=>G(r,V))}},p=()=>r,i={setState:u,getState:p,getInitialState:()=>C,subscribe:R=>(a.add(R),()=>a.delete(R))},C=r=e(u,p,i);return i},SJ=(e=>e?i3(e):i3),TJ=e=>e;function EJ(e,r=TJ){const a=Js.useSyncExternalStore(e.subscribe,Js.useCallback(()=>r(e.getState()),[e,r]),Js.useCallback(()=>r(e.getInitialState()),[e,r]));return Js.useDebugValue(a),a}const o3=e=>{const r=SJ(e),a=u=>EJ(r,u);return Object.assign(a,r),a},qy=(e=>e?o3(e):o3),s3={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_URL:"http://127.0.0.1:8000/api/v1",VITE_MAPBOX_TOKEN:"pk.eyJ1IjoiamVubmVmZXI4ODgiLCJhIjoiY21oYWp6aDI0MXU4ZTJrb2VnMHkyaDNmbiJ9.pbbLJheEB2crbr8nG45hfw",VITE_STRIPE_PUBLIC_KEY:"pk_test_51SPjEsB01R3IB0FYYV85ezUQGbD0LDpYpU6li1R3DLb13X2bnSid9n4geSU5VgabajoKR8KlQWnLmWXl45lRTzAP008IIpjLqw"},q0=new Map,Ob=e=>{const r=q0.get(e);return r?Object.fromEntries(Object.entries(r.stores).map(([a,u])=>[a,u.getState()])):{}},PJ=(e,r,a)=>{if(e===void 0)return{type:"untracked",connection:r.connect(a)};const u=q0.get(a.name);if(u)return{type:"tracked",store:e,...u};const p={connection:r.connect(a),stores:{}};return q0.set(a.name,p),{type:"tracked",store:e,...p}},IJ=(e,r)=>{if(r===void 0)return;const a=q0.get(e);a&&(delete a.stores[r],Object.keys(a.stores).length===0&&q0.delete(e))},MJ=e=>{var r,a;if(!e)return;const u=e.split(`
`),p=u.findIndex(x=>x.includes("api.setState"));if(p<0)return;const y=((r=u[p+1])==null?void 0:r.trim())||"";return(a=/.+ (.+) .+/.exec(y))==null?void 0:a[1]},CJ=(e,r={})=>(a,u,p)=>{const{enabled:y,anonymousActionType:x,store:i,...C}=r;let R;try{R=(y??(s3?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!R)return e(a,u,p);const{connection:z,...F}=PJ(i,R,C);let V=!0;p.setState=((Z,J,se)=>{const pe=a(Z,J);if(!V)return pe;const ve=se===void 0?{type:x||MJ(new Error().stack)||"anonymous"}:typeof se=="string"?{type:se}:se;return i===void 0?(z?.send(ve,u()),pe):(z?.send({...ve,type:`${i}/${ve.type}`},{...Ob(C.name),[i]:p.getState()}),pe)}),p.devtools={cleanup:()=>{z&&typeof z.unsubscribe=="function"&&z.unsubscribe(),IJ(C.name,i)}};const G=(...Z)=>{const J=V;V=!1,a(...Z),V=J},H=e(p.setState,u,p);if(F.type==="untracked"?z?.init(H):(F.stores[F.store]=p,z?.init(Object.fromEntries(Object.entries(F.stores).map(([Z,J])=>[Z,Z===F.store?H:J.getState()])))),p.dispatchFromDevtools&&typeof p.dispatch=="function"){let Z=!1;const J=p.dispatch;p.dispatch=(...se)=>{(s3?"production":void 0)!=="production"&&se[0].type==="__setState"&&!Z&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),Z=!0),J(...se)}}return z.subscribe(Z=>{var J;switch(Z.type){case"ACTION":if(typeof Z.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return t2(Z.payload,se=>{if(se.type==="__setState"){if(i===void 0){G(se.state);return}Object.keys(se.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const pe=se.state[i];if(pe==null)return;JSON.stringify(p.getState())!==JSON.stringify(pe)&&G(pe);return}p.dispatchFromDevtools&&typeof p.dispatch=="function"&&p.dispatch(se)});case"DISPATCH":switch(Z.payload.type){case"RESET":return G(H),i===void 0?z?.init(p.getState()):z?.init(Ob(C.name));case"COMMIT":if(i===void 0){z?.init(p.getState());return}return z?.init(Ob(C.name));case"ROLLBACK":return t2(Z.state,se=>{if(i===void 0){G(se),z?.init(p.getState());return}G(se[i]),z?.init(Ob(C.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return t2(Z.state,se=>{if(i===void 0){G(se);return}JSON.stringify(p.getState())!==JSON.stringify(se[i])&&G(se[i])});case"IMPORT_STATE":{const{nextLiftedState:se}=Z.payload,pe=(J=se.computedStates.slice(-1)[0])==null?void 0:J.state;if(!pe)return;G(i===void 0?pe:pe[i]),z?.send(null,se);return}case"PAUSE_RECORDING":return V=!V}return}}),H},mx=CJ,t2=(e,r)=>{let a;try{a=JSON.parse(e)}catch(u){console.error("[zustand devtools middleware] Could not parse the received json",u)}a!==void 0&&r(a)};function AJ(e,r){let a;try{a=e()}catch{return}return{getItem:p=>{var y;const x=C=>C===null?null:JSON.parse(C,void 0),i=(y=a.getItem(p))!=null?y:null;return i instanceof Promise?i.then(x):x(i)},setItem:(p,y)=>a.setItem(p,JSON.stringify(y,void 0)),removeItem:p=>a.removeItem(p)}}const dA=e=>r=>{try{const a=e(r);return a instanceof Promise?a:{then(u){return dA(u)(a)},catch(u){return this}}}catch(a){return{then(u){return this},catch(u){return dA(u)(a)}}}},DJ=(e,r)=>(a,u,p)=>{let y={storage:AJ(()=>localStorage),partialize:Z=>Z,version:0,merge:(Z,J)=>({...J,...Z}),...r},x=!1;const i=new Set,C=new Set;let R=y.storage;if(!R)return e((...Z)=>{console.warn(`[zustand persist middleware] Unable to update item '${y.name}', the given storage is currently unavailable.`),a(...Z)},u,p);const z=()=>{const Z=y.partialize({...u()});return R.setItem(y.name,{state:Z,version:y.version})},F=p.setState;p.setState=(Z,J)=>(F(Z,J),z());const V=e((...Z)=>(a(...Z),z()),u,p);p.getInitialState=()=>V;let G;const H=()=>{var Z,J;if(!R)return;x=!1,i.forEach(pe=>{var ve;return pe((ve=u())!=null?ve:V)});const se=((J=y.onRehydrateStorage)==null?void 0:J.call(y,(Z=u())!=null?Z:V))||void 0;return dA(R.getItem.bind(R))(y.name).then(pe=>{if(pe)if(typeof pe.version=="number"&&pe.version!==y.version){if(y.migrate){const ve=y.migrate(pe.state,pe.version);return ve instanceof Promise?ve.then(Ne=>[!0,Ne]):[!0,ve]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,pe.state];return[!1,void 0]}).then(pe=>{var ve;const[Ne,_e]=pe;if(G=y.merge(_e,(ve=u())!=null?ve:V),a(G,!0),Ne)return z()}).then(()=>{se?.(G,void 0),G=u(),x=!0,C.forEach(pe=>pe(G))}).catch(pe=>{se?.(void 0,pe)})};return p.persist={setOptions:Z=>{y={...y,...Z},Z.storage&&(R=Z.storage)},clearStorage:()=>{R?.removeItem(y.name)},getOptions:()=>y,rehydrate:()=>H(),hasHydrated:()=>x,onHydrate:Z=>(i.add(Z),()=>{i.delete(Z)}),onFinishHydration:Z=>(C.add(Z),()=>{C.delete(Z)})},y.skipHydration||H(),G||V},RD=DJ;function SW(e,r){return function(){return e.apply(r,arguments)}}const{toString:RJ}=Object.prototype,{getPrototypeOf:OD}=Object,{iterator:Ww,toStringTag:TW}=Symbol,qw=(e=>r=>{const a=RJ.call(r);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Ah=e=>(e=e.toLowerCase(),r=>qw(r)===e),Gw=e=>r=>typeof r===e,{isArray:Gy}=Array,Ry=Gw("undefined");function gx(e){return e!==null&&!Ry(e)&&e.constructor!==null&&!Ry(e.constructor)&&Tu(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const EW=Ah("ArrayBuffer");function OJ(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&EW(e.buffer),r}const LJ=Gw("string"),Tu=Gw("function"),PW=Gw("number"),_x=e=>e!==null&&typeof e=="object",zJ=e=>e===!0||e===!1,G1=e=>{if(qw(e)!=="object")return!1;const r=OD(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(TW in e)&&!(Ww in e)},FJ=e=>{if(!_x(e)||gx(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},kJ=Ah("Date"),BJ=Ah("File"),jJ=Ah("Blob"),NJ=Ah("FileList"),VJ=e=>_x(e)&&Tu(e.pipe),UJ=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||Tu(e.append)&&((r=qw(e))==="formdata"||r==="object"&&Tu(e.toString)&&e.toString()==="[object FormData]"))},$J=Ah("URLSearchParams"),[WJ,qJ,GJ,HJ]=["ReadableStream","Request","Response","Headers"].map(Ah),YJ=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function yx(e,r,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let u,p;if(typeof e!="object"&&(e=[e]),Gy(e))for(u=0,p=e.length;u<p;u++)r.call(null,e[u],u,e);else{if(gx(e))return;const y=a?Object.getOwnPropertyNames(e):Object.keys(e),x=y.length;let i;for(u=0;u<x;u++)i=y[u],r.call(null,e[i],i,e)}}function IW(e,r){if(gx(e))return null;r=r.toLowerCase();const a=Object.keys(e);let u=a.length,p;for(;u-- >0;)if(p=a[u],r===p.toLowerCase())return p;return null}const Ug=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,MW=e=>!Ry(e)&&e!==Ug;function hA(){const{caseless:e,skipUndefined:r}=MW(this)&&this||{},a={},u=(p,y)=>{const x=e&&IW(a,y)||y;G1(a[x])&&G1(p)?a[x]=hA(a[x],p):G1(p)?a[x]=hA({},p):Gy(p)?a[x]=p.slice():(!r||!Ry(p))&&(a[x]=p)};for(let p=0,y=arguments.length;p<y;p++)arguments[p]&&yx(arguments[p],u);return a}const ZJ=(e,r,a,{allOwnKeys:u}={})=>(yx(r,(p,y)=>{a&&Tu(p)?e[y]=SW(p,a):e[y]=p},{allOwnKeys:u}),e),XJ=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),KJ=(e,r,a,u)=>{e.prototype=Object.create(r.prototype,u),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),a&&Object.assign(e.prototype,a)},QJ=(e,r,a,u)=>{let p,y,x;const i={};if(r=r||{},e==null)return r;do{for(p=Object.getOwnPropertyNames(e),y=p.length;y-- >0;)x=p[y],(!u||u(x,e,r))&&!i[x]&&(r[x]=e[x],i[x]=!0);e=a!==!1&&OD(e)}while(e&&(!a||a(e,r))&&e!==Object.prototype);return r},JJ=(e,r,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=r.length;const u=e.indexOf(r,a);return u!==-1&&u===a},eee=e=>{if(!e)return null;if(Gy(e))return e;let r=e.length;if(!PW(r))return null;const a=new Array(r);for(;r-- >0;)a[r]=e[r];return a},tee=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&OD(Uint8Array)),ree=(e,r)=>{const u=(e&&e[Ww]).call(e);let p;for(;(p=u.next())&&!p.done;){const y=p.value;r.call(e,y[0],y[1])}},nee=(e,r)=>{let a;const u=[];for(;(a=e.exec(r))!==null;)u.push(a);return u},iee=Ah("HTMLFormElement"),oee=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,u,p){return u.toUpperCase()+p}),a3=(({hasOwnProperty:e})=>(r,a)=>e.call(r,a))(Object.prototype),see=Ah("RegExp"),CW=(e,r)=>{const a=Object.getOwnPropertyDescriptors(e),u={};yx(a,(p,y)=>{let x;(x=r(p,y,e))!==!1&&(u[y]=x||p)}),Object.defineProperties(e,u)},aee=e=>{CW(e,(r,a)=>{if(Tu(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const u=e[a];if(Tu(u)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},lee=(e,r)=>{const a={},u=p=>{p.forEach(y=>{a[y]=!0})};return Gy(e)?u(e):u(String(e).split(r)),a},cee=()=>{},uee=(e,r)=>e!=null&&Number.isFinite(e=+e)?e:r;function dee(e){return!!(e&&Tu(e.append)&&e[TW]==="FormData"&&e[Ww])}const hee=e=>{const r=new Array(10),a=(u,p)=>{if(_x(u)){if(r.indexOf(u)>=0)return;if(gx(u))return u;if(!("toJSON"in u)){r[p]=u;const y=Gy(u)?[]:{};return yx(u,(x,i)=>{const C=a(x,p+1);!Ry(C)&&(y[i]=C)}),r[p]=void 0,y}}return u};return a(e,0)},fee=Ah("AsyncFunction"),pee=e=>e&&(_x(e)||Tu(e))&&Tu(e.then)&&Tu(e.catch),AW=((e,r)=>e?setImmediate:r?((a,u)=>(Ug.addEventListener("message",({source:p,data:y})=>{p===Ug&&y===a&&u.length&&u.shift()()},!1),p=>{u.push(p),Ug.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",Tu(Ug.postMessage)),mee=typeof queueMicrotask<"u"?queueMicrotask.bind(Ug):typeof process<"u"&&process.nextTick||AW,gee=e=>e!=null&&Tu(e[Ww]),Kt={isArray:Gy,isArrayBuffer:EW,isBuffer:gx,isFormData:UJ,isArrayBufferView:OJ,isString:LJ,isNumber:PW,isBoolean:zJ,isObject:_x,isPlainObject:G1,isEmptyObject:FJ,isReadableStream:WJ,isRequest:qJ,isResponse:GJ,isHeaders:HJ,isUndefined:Ry,isDate:kJ,isFile:BJ,isBlob:jJ,isRegExp:see,isFunction:Tu,isStream:VJ,isURLSearchParams:$J,isTypedArray:tee,isFileList:NJ,forEach:yx,merge:hA,extend:ZJ,trim:YJ,stripBOM:XJ,inherits:KJ,toFlatObject:QJ,kindOf:qw,kindOfTest:Ah,endsWith:JJ,toArray:eee,forEachEntry:ree,matchAll:nee,isHTMLForm:iee,hasOwnProperty:a3,hasOwnProp:a3,reduceDescriptors:CW,freezeMethods:aee,toObjectSet:lee,toCamelCase:oee,noop:cee,toFiniteNumber:uee,findKey:IW,global:Ug,isContextDefined:MW,isSpecCompliantForm:dee,toJSONObject:hee,isAsyncFn:fee,isThenable:pee,setImmediate:AW,asap:mee,isIterable:gee};function Pi(e,r,a,u,p){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),a&&(this.config=a),u&&(this.request=u),p&&(this.response=p,this.status=p.status?p.status:null)}Kt.inherits(Pi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Kt.toJSONObject(this.config),code:this.code,status:this.status}}});const DW=Pi.prototype,RW={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{RW[e]={value:e}});Object.defineProperties(Pi,RW);Object.defineProperty(DW,"isAxiosError",{value:!0});Pi.from=(e,r,a,u,p,y)=>{const x=Object.create(DW);Kt.toFlatObject(e,x,function(z){return z!==Error.prototype},R=>R!=="isAxiosError");const i=e&&e.message?e.message:"Error",C=r==null&&e?e.code:r;return Pi.call(x,i,C,a,u,p),e&&x.cause==null&&Object.defineProperty(x,"cause",{value:e,configurable:!0}),x.name=e&&e.name||"Error",y&&Object.assign(x,y),x};const _ee=null;function fA(e){return Kt.isPlainObject(e)||Kt.isArray(e)}function OW(e){return Kt.endsWith(e,"[]")?e.slice(0,-2):e}function l3(e,r,a){return e?e.concat(r).map(function(p,y){return p=OW(p),!a&&y?"["+p+"]":p}).join(a?".":""):r}function yee(e){return Kt.isArray(e)&&!e.some(fA)}const vee=Kt.toFlatObject(Kt,{},null,function(r){return/^is[A-Z]/.test(r)});function Hw(e,r,a){if(!Kt.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,a=Kt.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Z,J){return!Kt.isUndefined(J[Z])});const u=a.metaTokens,p=a.visitor||z,y=a.dots,x=a.indexes,C=(a.Blob||typeof Blob<"u"&&Blob)&&Kt.isSpecCompliantForm(r);if(!Kt.isFunction(p))throw new TypeError("visitor must be a function");function R(H){if(H===null)return"";if(Kt.isDate(H))return H.toISOString();if(Kt.isBoolean(H))return H.toString();if(!C&&Kt.isBlob(H))throw new Pi("Blob is not supported. Use a Buffer instead.");return Kt.isArrayBuffer(H)||Kt.isTypedArray(H)?C&&typeof Blob=="function"?new Blob([H]):Buffer.from(H):H}function z(H,Z,J){let se=H;if(H&&!J&&typeof H=="object"){if(Kt.endsWith(Z,"{}"))Z=u?Z:Z.slice(0,-2),H=JSON.stringify(H);else if(Kt.isArray(H)&&yee(H)||(Kt.isFileList(H)||Kt.endsWith(Z,"[]"))&&(se=Kt.toArray(H)))return Z=OW(Z),se.forEach(function(ve,Ne){!(Kt.isUndefined(ve)||ve===null)&&r.append(x===!0?l3([Z],Ne,y):x===null?Z:Z+"[]",R(ve))}),!1}return fA(H)?!0:(r.append(l3(J,Z,y),R(H)),!1)}const F=[],V=Object.assign(vee,{defaultVisitor:z,convertValue:R,isVisitable:fA});function G(H,Z){if(!Kt.isUndefined(H)){if(F.indexOf(H)!==-1)throw Error("Circular reference detected in "+Z.join("."));F.push(H),Kt.forEach(H,function(se,pe){(!(Kt.isUndefined(se)||se===null)&&p.call(r,se,Kt.isString(pe)?pe.trim():pe,Z,V))===!0&&G(se,Z?Z.concat(pe):[pe])}),F.pop()}}if(!Kt.isObject(e))throw new TypeError("data must be an object");return G(e),r}function c3(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(u){return r[u]})}function LD(e,r){this._pairs=[],e&&Hw(e,this,r)}const LW=LD.prototype;LW.append=function(r,a){this._pairs.push([r,a])};LW.toString=function(r){const a=r?function(u){return r.call(this,u,c3)}:c3;return this._pairs.map(function(p){return a(p[0])+"="+a(p[1])},"").join("&")};function xee(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function zW(e,r,a){if(!r)return e;const u=a&&a.encode||xee;Kt.isFunction(a)&&(a={serialize:a});const p=a&&a.serialize;let y;if(p?y=p(r,a):y=Kt.isURLSearchParams(r)?r.toString():new LD(r,a).toString(u),y){const x=e.indexOf("#");x!==-1&&(e=e.slice(0,x)),e+=(e.indexOf("?")===-1?"?":"&")+y}return e}class u3{constructor(){this.handlers=[]}use(r,a,u){return this.handlers.push({fulfilled:r,rejected:a,synchronous:u?u.synchronous:!1,runWhen:u?u.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){Kt.forEach(this.handlers,function(u){u!==null&&r(u)})}}const FW={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bee=typeof URLSearchParams<"u"?URLSearchParams:LD,wee=typeof FormData<"u"?FormData:null,See=typeof Blob<"u"?Blob:null,Tee={isBrowser:!0,classes:{URLSearchParams:bee,FormData:wee,Blob:See},protocols:["http","https","file","blob","url","data"]},zD=typeof window<"u"&&typeof document<"u",pA=typeof navigator=="object"&&navigator||void 0,Eee=zD&&(!pA||["ReactNative","NativeScript","NS"].indexOf(pA.product)<0),Pee=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Iee=zD&&window.location.href||"http://localhost",Mee=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:zD,hasStandardBrowserEnv:Eee,hasStandardBrowserWebWorkerEnv:Pee,navigator:pA,origin:Iee},Symbol.toStringTag,{value:"Module"})),Mc={...Mee,...Tee};function Cee(e,r){return Hw(e,new Mc.classes.URLSearchParams,{visitor:function(a,u,p,y){return Mc.isNode&&Kt.isBuffer(a)?(this.append(u,a.toString("base64")),!1):y.defaultVisitor.apply(this,arguments)},...r})}function Aee(e){return Kt.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function Dee(e){const r={},a=Object.keys(e);let u;const p=a.length;let y;for(u=0;u<p;u++)y=a[u],r[y]=e[y];return r}function kW(e){function r(a,u,p,y){let x=a[y++];if(x==="__proto__")return!0;const i=Number.isFinite(+x),C=y>=a.length;return x=!x&&Kt.isArray(p)?p.length:x,C?(Kt.hasOwnProp(p,x)?p[x]=[p[x],u]:p[x]=u,!i):((!p[x]||!Kt.isObject(p[x]))&&(p[x]=[]),r(a,u,p[x],y)&&Kt.isArray(p[x])&&(p[x]=Dee(p[x])),!i)}if(Kt.isFormData(e)&&Kt.isFunction(e.entries)){const a={};return Kt.forEachEntry(e,(u,p)=>{r(Aee(u),p,a,0)}),a}return null}function Ree(e,r,a){if(Kt.isString(e))try{return(r||JSON.parse)(e),Kt.trim(e)}catch(u){if(u.name!=="SyntaxError")throw u}return(a||JSON.stringify)(e)}const vx={transitional:FW,adapter:["xhr","http","fetch"],transformRequest:[function(r,a){const u=a.getContentType()||"",p=u.indexOf("application/json")>-1,y=Kt.isObject(r);if(y&&Kt.isHTMLForm(r)&&(r=new FormData(r)),Kt.isFormData(r))return p?JSON.stringify(kW(r)):r;if(Kt.isArrayBuffer(r)||Kt.isBuffer(r)||Kt.isStream(r)||Kt.isFile(r)||Kt.isBlob(r)||Kt.isReadableStream(r))return r;if(Kt.isArrayBufferView(r))return r.buffer;if(Kt.isURLSearchParams(r))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let i;if(y){if(u.indexOf("application/x-www-form-urlencoded")>-1)return Cee(r,this.formSerializer).toString();if((i=Kt.isFileList(r))||u.indexOf("multipart/form-data")>-1){const C=this.env&&this.env.FormData;return Hw(i?{"files[]":r}:r,C&&new C,this.formSerializer)}}return y||p?(a.setContentType("application/json",!1),Ree(r)):r}],transformResponse:[function(r){const a=this.transitional||vx.transitional,u=a&&a.forcedJSONParsing,p=this.responseType==="json";if(Kt.isResponse(r)||Kt.isReadableStream(r))return r;if(r&&Kt.isString(r)&&(u&&!this.responseType||p)){const x=!(a&&a.silentJSONParsing)&&p;try{return JSON.parse(r,this.parseReviver)}catch(i){if(x)throw i.name==="SyntaxError"?Pi.from(i,Pi.ERR_BAD_RESPONSE,this,null,this.response):i}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mc.classes.FormData,Blob:Mc.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Kt.forEach(["delete","get","head","post","put","patch"],e=>{vx.headers[e]={}});const Oee=Kt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Lee=e=>{const r={};let a,u,p;return e&&e.split(`
`).forEach(function(x){p=x.indexOf(":"),a=x.substring(0,p).trim().toLowerCase(),u=x.substring(p+1).trim(),!(!a||r[a]&&Oee[a])&&(a==="set-cookie"?r[a]?r[a].push(u):r[a]=[u]:r[a]=r[a]?r[a]+", "+u:u)}),r},d3=Symbol("internals");function Xv(e){return e&&String(e).trim().toLowerCase()}function H1(e){return e===!1||e==null?e:Kt.isArray(e)?e.map(H1):String(e)}function zee(e){const r=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let u;for(;u=a.exec(e);)r[u[1]]=u[2];return r}const Fee=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function r2(e,r,a,u,p){if(Kt.isFunction(u))return u.call(this,r,a);if(p&&(r=a),!!Kt.isString(r)){if(Kt.isString(u))return r.indexOf(u)!==-1;if(Kt.isRegExp(u))return u.test(r)}}function kee(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,a,u)=>a.toUpperCase()+u)}function Bee(e,r){const a=Kt.toCamelCase(" "+r);["get","set","has"].forEach(u=>{Object.defineProperty(e,u+a,{value:function(p,y,x){return this[u].call(this,r,p,y,x)},configurable:!0})})}let Eu=class{constructor(r){r&&this.set(r)}set(r,a,u){const p=this;function y(i,C,R){const z=Xv(C);if(!z)throw new Error("header name must be a non-empty string");const F=Kt.findKey(p,z);(!F||p[F]===void 0||R===!0||R===void 0&&p[F]!==!1)&&(p[F||C]=H1(i))}const x=(i,C)=>Kt.forEach(i,(R,z)=>y(R,z,C));if(Kt.isPlainObject(r)||r instanceof this.constructor)x(r,a);else if(Kt.isString(r)&&(r=r.trim())&&!Fee(r))x(Lee(r),a);else if(Kt.isObject(r)&&Kt.isIterable(r)){let i={},C,R;for(const z of r){if(!Kt.isArray(z))throw TypeError("Object iterator must return a key-value pair");i[R=z[0]]=(C=i[R])?Kt.isArray(C)?[...C,z[1]]:[C,z[1]]:z[1]}x(i,a)}else r!=null&&y(a,r,u);return this}get(r,a){if(r=Xv(r),r){const u=Kt.findKey(this,r);if(u){const p=this[u];if(!a)return p;if(a===!0)return zee(p);if(Kt.isFunction(a))return a.call(this,p,u);if(Kt.isRegExp(a))return a.exec(p);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,a){if(r=Xv(r),r){const u=Kt.findKey(this,r);return!!(u&&this[u]!==void 0&&(!a||r2(this,this[u],u,a)))}return!1}delete(r,a){const u=this;let p=!1;function y(x){if(x=Xv(x),x){const i=Kt.findKey(u,x);i&&(!a||r2(u,u[i],i,a))&&(delete u[i],p=!0)}}return Kt.isArray(r)?r.forEach(y):y(r),p}clear(r){const a=Object.keys(this);let u=a.length,p=!1;for(;u--;){const y=a[u];(!r||r2(this,this[y],y,r,!0))&&(delete this[y],p=!0)}return p}normalize(r){const a=this,u={};return Kt.forEach(this,(p,y)=>{const x=Kt.findKey(u,y);if(x){a[x]=H1(p),delete a[y];return}const i=r?kee(y):String(y).trim();i!==y&&delete a[y],a[i]=H1(p),u[i]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const a=Object.create(null);return Kt.forEach(this,(u,p)=>{u!=null&&u!==!1&&(a[p]=r&&Kt.isArray(u)?u.join(", "):u)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,a])=>r+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...a){const u=new this(r);return a.forEach(p=>u.set(p)),u}static accessor(r){const u=(this[d3]=this[d3]={accessors:{}}).accessors,p=this.prototype;function y(x){const i=Xv(x);u[i]||(Bee(p,x),u[i]=!0)}return Kt.isArray(r)?r.forEach(y):y(r),this}};Eu.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Kt.reduceDescriptors(Eu.prototype,({value:e},r)=>{let a=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(u){this[a]=u}}});Kt.freezeMethods(Eu);function n2(e,r){const a=this||vx,u=r||a,p=Eu.from(u.headers);let y=u.data;return Kt.forEach(e,function(i){y=i.call(a,y,p.normalize(),r?r.status:void 0)}),p.normalize(),y}function BW(e){return!!(e&&e.__CANCEL__)}function Hy(e,r,a){Pi.call(this,e??"canceled",Pi.ERR_CANCELED,r,a),this.name="CanceledError"}Kt.inherits(Hy,Pi,{__CANCEL__:!0});function jW(e,r,a){const u=a.config.validateStatus;!a.status||!u||u(a.status)?e(a):r(new Pi("Request failed with status code "+a.status,[Pi.ERR_BAD_REQUEST,Pi.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function jee(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function Nee(e,r){e=e||10;const a=new Array(e),u=new Array(e);let p=0,y=0,x;return r=r!==void 0?r:1e3,function(C){const R=Date.now(),z=u[y];x||(x=R),a[p]=C,u[p]=R;let F=y,V=0;for(;F!==p;)V+=a[F++],F=F%e;if(p=(p+1)%e,p===y&&(y=(y+1)%e),R-x<r)return;const G=z&&R-z;return G?Math.round(V*1e3/G):void 0}}function Vee(e,r){let a=0,u=1e3/r,p,y;const x=(R,z=Date.now())=>{a=z,p=null,y&&(clearTimeout(y),y=null),e(...R)};return[(...R)=>{const z=Date.now(),F=z-a;F>=u?x(R,z):(p=R,y||(y=setTimeout(()=>{y=null,x(p)},u-F)))},()=>p&&x(p)]}const vw=(e,r,a=3)=>{let u=0;const p=Nee(50,250);return Vee(y=>{const x=y.loaded,i=y.lengthComputable?y.total:void 0,C=x-u,R=p(C),z=x<=i;u=x;const F={loaded:x,total:i,progress:i?x/i:void 0,bytes:C,rate:R||void 0,estimated:R&&i&&z?(i-x)/R:void 0,event:y,lengthComputable:i!=null,[r?"download":"upload"]:!0};e(F)},a)},h3=(e,r)=>{const a=e!=null;return[u=>r[0]({lengthComputable:a,total:e,loaded:u}),r[1]]},f3=e=>(...r)=>Kt.asap(()=>e(...r)),Uee=Mc.hasStandardBrowserEnv?((e,r)=>a=>(a=new URL(a,Mc.origin),e.protocol===a.protocol&&e.host===a.host&&(r||e.port===a.port)))(new URL(Mc.origin),Mc.navigator&&/(msie|trident)/i.test(Mc.navigator.userAgent)):()=>!0,$ee=Mc.hasStandardBrowserEnv?{write(e,r,a,u,p,y,x){if(typeof document>"u")return;const i=[`${e}=${encodeURIComponent(r)}`];Kt.isNumber(a)&&i.push(`expires=${new Date(a).toUTCString()}`),Kt.isString(u)&&i.push(`path=${u}`),Kt.isString(p)&&i.push(`domain=${p}`),y===!0&&i.push("secure"),Kt.isString(x)&&i.push(`SameSite=${x}`),document.cookie=i.join("; ")},read(e){if(typeof document>"u")return null;const r=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return r?decodeURIComponent(r[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Wee(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function qee(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function NW(e,r,a){let u=!Wee(r);return e&&(u||a==!1)?qee(e,r):r}const p3=e=>e instanceof Eu?{...e}:e;function n_(e,r){r=r||{};const a={};function u(R,z,F,V){return Kt.isPlainObject(R)&&Kt.isPlainObject(z)?Kt.merge.call({caseless:V},R,z):Kt.isPlainObject(z)?Kt.merge({},z):Kt.isArray(z)?z.slice():z}function p(R,z,F,V){if(Kt.isUndefined(z)){if(!Kt.isUndefined(R))return u(void 0,R,F,V)}else return u(R,z,F,V)}function y(R,z){if(!Kt.isUndefined(z))return u(void 0,z)}function x(R,z){if(Kt.isUndefined(z)){if(!Kt.isUndefined(R))return u(void 0,R)}else return u(void 0,z)}function i(R,z,F){if(F in r)return u(R,z);if(F in e)return u(void 0,R)}const C={url:y,method:y,data:y,baseURL:x,transformRequest:x,transformResponse:x,paramsSerializer:x,timeout:x,timeoutMessage:x,withCredentials:x,withXSRFToken:x,adapter:x,responseType:x,xsrfCookieName:x,xsrfHeaderName:x,onUploadProgress:x,onDownloadProgress:x,decompress:x,maxContentLength:x,maxBodyLength:x,beforeRedirect:x,transport:x,httpAgent:x,httpsAgent:x,cancelToken:x,socketPath:x,responseEncoding:x,validateStatus:i,headers:(R,z,F)=>p(p3(R),p3(z),F,!0)};return Kt.forEach(Object.keys({...e,...r}),function(z){const F=C[z]||p,V=F(e[z],r[z],z);Kt.isUndefined(V)&&F!==i||(a[z]=V)}),a}const VW=e=>{const r=n_({},e);let{data:a,withXSRFToken:u,xsrfHeaderName:p,xsrfCookieName:y,headers:x,auth:i}=r;if(r.headers=x=Eu.from(x),r.url=zW(NW(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),i&&x.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):""))),Kt.isFormData(a)){if(Mc.hasStandardBrowserEnv||Mc.hasStandardBrowserWebWorkerEnv)x.setContentType(void 0);else if(Kt.isFunction(a.getHeaders)){const C=a.getHeaders(),R=["content-type","content-length"];Object.entries(C).forEach(([z,F])=>{R.includes(z.toLowerCase())&&x.set(z,F)})}}if(Mc.hasStandardBrowserEnv&&(u&&Kt.isFunction(u)&&(u=u(r)),u||u!==!1&&Uee(r.url))){const C=p&&y&&$ee.read(y);C&&x.set(p,C)}return r},Gee=typeof XMLHttpRequest<"u",Hee=Gee&&function(e){return new Promise(function(a,u){const p=VW(e);let y=p.data;const x=Eu.from(p.headers).normalize();let{responseType:i,onUploadProgress:C,onDownloadProgress:R}=p,z,F,V,G,H;function Z(){G&&G(),H&&H(),p.cancelToken&&p.cancelToken.unsubscribe(z),p.signal&&p.signal.removeEventListener("abort",z)}let J=new XMLHttpRequest;J.open(p.method.toUpperCase(),p.url,!0),J.timeout=p.timeout;function se(){if(!J)return;const ve=Eu.from("getAllResponseHeaders"in J&&J.getAllResponseHeaders()),_e={data:!i||i==="text"||i==="json"?J.responseText:J.response,status:J.status,statusText:J.statusText,headers:ve,config:e,request:J};jW(function(ke){a(ke),Z()},function(ke){u(ke),Z()},_e),J=null}"onloadend"in J?J.onloadend=se:J.onreadystatechange=function(){!J||J.readyState!==4||J.status===0&&!(J.responseURL&&J.responseURL.indexOf("file:")===0)||setTimeout(se)},J.onabort=function(){J&&(u(new Pi("Request aborted",Pi.ECONNABORTED,e,J)),J=null)},J.onerror=function(Ne){const _e=Ne&&Ne.message?Ne.message:"Network Error",Re=new Pi(_e,Pi.ERR_NETWORK,e,J);Re.event=Ne||null,u(Re),J=null},J.ontimeout=function(){let Ne=p.timeout?"timeout of "+p.timeout+"ms exceeded":"timeout exceeded";const _e=p.transitional||FW;p.timeoutErrorMessage&&(Ne=p.timeoutErrorMessage),u(new Pi(Ne,_e.clarifyTimeoutError?Pi.ETIMEDOUT:Pi.ECONNABORTED,e,J)),J=null},y===void 0&&x.setContentType(null),"setRequestHeader"in J&&Kt.forEach(x.toJSON(),function(Ne,_e){J.setRequestHeader(_e,Ne)}),Kt.isUndefined(p.withCredentials)||(J.withCredentials=!!p.withCredentials),i&&i!=="json"&&(J.responseType=p.responseType),R&&([V,H]=vw(R,!0),J.addEventListener("progress",V)),C&&J.upload&&([F,G]=vw(C),J.upload.addEventListener("progress",F),J.upload.addEventListener("loadend",G)),(p.cancelToken||p.signal)&&(z=ve=>{J&&(u(!ve||ve.type?new Hy(null,e,J):ve),J.abort(),J=null)},p.cancelToken&&p.cancelToken.subscribe(z),p.signal&&(p.signal.aborted?z():p.signal.addEventListener("abort",z)));const pe=jee(p.url);if(pe&&Mc.protocols.indexOf(pe)===-1){u(new Pi("Unsupported protocol "+pe+":",Pi.ERR_BAD_REQUEST,e));return}J.send(y||null)})},Yee=(e,r)=>{const{length:a}=e=e?e.filter(Boolean):[];if(r||a){let u=new AbortController,p;const y=function(R){if(!p){p=!0,i();const z=R instanceof Error?R:this.reason;u.abort(z instanceof Pi?z:new Hy(z instanceof Error?z.message:z))}};let x=r&&setTimeout(()=>{x=null,y(new Pi(`timeout ${r} of ms exceeded`,Pi.ETIMEDOUT))},r);const i=()=>{e&&(x&&clearTimeout(x),x=null,e.forEach(R=>{R.unsubscribe?R.unsubscribe(y):R.removeEventListener("abort",y)}),e=null)};e.forEach(R=>R.addEventListener("abort",y));const{signal:C}=u;return C.unsubscribe=()=>Kt.asap(i),C}},Zee=function*(e,r){let a=e.byteLength;if(a<r){yield e;return}let u=0,p;for(;u<a;)p=u+r,yield e.slice(u,p),u=p},Xee=async function*(e,r){for await(const a of Kee(e))yield*Zee(a,r)},Kee=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const r=e.getReader();try{for(;;){const{done:a,value:u}=await r.read();if(a)break;yield u}}finally{await r.cancel()}},m3=(e,r,a,u)=>{const p=Xee(e,r);let y=0,x,i=C=>{x||(x=!0,u&&u(C))};return new ReadableStream({async pull(C){try{const{done:R,value:z}=await p.next();if(R){i(),C.close();return}let F=z.byteLength;if(a){let V=y+=F;a(V)}C.enqueue(new Uint8Array(z))}catch(R){throw i(R),R}},cancel(C){return i(C),p.return()}},{highWaterMark:2})},g3=64*1024,{isFunction:Lb}=Kt,Qee=(({Request:e,Response:r})=>({Request:e,Response:r}))(Kt.global),{ReadableStream:_3,TextEncoder:y3}=Kt.global,v3=(e,...r)=>{try{return!!e(...r)}catch{return!1}},Jee=e=>{e=Kt.merge.call({skipUndefined:!0},Qee,e);const{fetch:r,Request:a,Response:u}=e,p=r?Lb(r):typeof fetch=="function",y=Lb(a),x=Lb(u);if(!p)return!1;const i=p&&Lb(_3),C=p&&(typeof y3=="function"?(H=>Z=>H.encode(Z))(new y3):async H=>new Uint8Array(await new a(H).arrayBuffer())),R=y&&i&&v3(()=>{let H=!1;const Z=new a(Mc.origin,{body:new _3,method:"POST",get duplex(){return H=!0,"half"}}).headers.has("Content-Type");return H&&!Z}),z=x&&i&&v3(()=>Kt.isReadableStream(new u("").body)),F={stream:z&&(H=>H.body)};p&&["text","arrayBuffer","blob","formData","stream"].forEach(H=>{!F[H]&&(F[H]=(Z,J)=>{let se=Z&&Z[H];if(se)return se.call(Z);throw new Pi(`Response type '${H}' is not supported`,Pi.ERR_NOT_SUPPORT,J)})});const V=async H=>{if(H==null)return 0;if(Kt.isBlob(H))return H.size;if(Kt.isSpecCompliantForm(H))return(await new a(Mc.origin,{method:"POST",body:H}).arrayBuffer()).byteLength;if(Kt.isArrayBufferView(H)||Kt.isArrayBuffer(H))return H.byteLength;if(Kt.isURLSearchParams(H)&&(H=H+""),Kt.isString(H))return(await C(H)).byteLength},G=async(H,Z)=>{const J=Kt.toFiniteNumber(H.getContentLength());return J??V(Z)};return async H=>{let{url:Z,method:J,data:se,signal:pe,cancelToken:ve,timeout:Ne,onDownloadProgress:_e,onUploadProgress:Re,responseType:ke,headers:ze,withCredentials:et="same-origin",fetchOptions:ht}=VW(H),Xt=r||fetch;ke=ke?(ke+"").toLowerCase():"text";let Ir=Yee([pe,ve&&ve.toAbortSignal()],Ne),nr=null;const Fr=Ir&&Ir.unsubscribe&&(()=>{Ir.unsubscribe()});let Or;try{if(Re&&R&&J!=="get"&&J!=="head"&&(Or=await G(ze,se))!==0){let tt=new a(Z,{method:"POST",body:se,duplex:"half"}),ct;if(Kt.isFormData(se)&&(ct=tt.headers.get("content-type"))&&ze.setContentType(ct),tt.body){const[_t,Vt]=h3(Or,vw(f3(Re)));se=m3(tt.body,g3,_t,Vt)}}Kt.isString(et)||(et=et?"include":"omit");const or=y&&"credentials"in a.prototype,lt={...ht,signal:Ir,method:J.toUpperCase(),headers:ze.normalize().toJSON(),body:se,duplex:"half",credentials:or?et:void 0};nr=y&&new a(Z,lt);let Et=await(y?Xt(nr,ht):Xt(Z,lt));const qt=z&&(ke==="stream"||ke==="response");if(z&&(_e||qt&&Fr)){const tt={};["status","statusText","headers"].forEach(bt=>{tt[bt]=Et[bt]});const ct=Kt.toFiniteNumber(Et.headers.get("content-length")),[_t,Vt]=_e&&h3(ct,vw(f3(_e),!0))||[];Et=new u(m3(Et.body,g3,_t,()=>{Vt&&Vt(),Fr&&Fr()}),tt)}ke=ke||"text";let Gt=await F[Kt.findKey(F,ke)||"text"](Et,H);return!qt&&Fr&&Fr(),await new Promise((tt,ct)=>{jW(tt,ct,{data:Gt,headers:Eu.from(Et.headers),status:Et.status,statusText:Et.statusText,config:H,request:nr})})}catch(or){throw Fr&&Fr(),or&&or.name==="TypeError"&&/Load failed|fetch/i.test(or.message)?Object.assign(new Pi("Network Error",Pi.ERR_NETWORK,H,nr),{cause:or.cause||or}):Pi.from(or,or&&or.code,H,nr)}}},ete=new Map,UW=e=>{let r=e&&e.env||{};const{fetch:a,Request:u,Response:p}=r,y=[u,p,a];let x=y.length,i=x,C,R,z=ete;for(;i--;)C=y[i],R=z.get(C),R===void 0&&z.set(C,R=i?new Map:Jee(r)),z=R;return R};UW();const FD={http:_ee,xhr:Hee,fetch:{get:UW}};Kt.forEach(FD,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const x3=e=>`- ${e}`,tte=e=>Kt.isFunction(e)||e===null||e===!1;function rte(e,r){e=Kt.isArray(e)?e:[e];const{length:a}=e;let u,p;const y={};for(let x=0;x<a;x++){u=e[x];let i;if(p=u,!tte(u)&&(p=FD[(i=String(u)).toLowerCase()],p===void 0))throw new Pi(`Unknown adapter '${i}'`);if(p&&(Kt.isFunction(p)||(p=p.get(r))))break;y[i||"#"+x]=p}if(!p){const x=Object.entries(y).map(([C,R])=>`adapter ${C} `+(R===!1?"is not supported by the environment":"is not available in the build"));let i=a?x.length>1?`since :
`+x.map(x3).join(`
`):" "+x3(x[0]):"as no adapter specified";throw new Pi("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return p}const $W={getAdapter:rte,adapters:FD};function i2(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Hy(null,e)}function b3(e){return i2(e),e.headers=Eu.from(e.headers),e.data=n2.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),$W.getAdapter(e.adapter||vx.adapter,e)(e).then(function(u){return i2(e),u.data=n2.call(e,e.transformResponse,u),u.headers=Eu.from(u.headers),u},function(u){return BW(u)||(i2(e),u&&u.response&&(u.response.data=n2.call(e,e.transformResponse,u.response),u.response.headers=Eu.from(u.response.headers))),Promise.reject(u)})}const WW="1.13.2",Yw={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{Yw[e]=function(u){return typeof u===e||"a"+(r<1?"n ":" ")+e}});const w3={};Yw.transitional=function(r,a,u){function p(y,x){return"[Axios v"+WW+"] Transitional option '"+y+"'"+x+(u?". "+u:"")}return(y,x,i)=>{if(r===!1)throw new Pi(p(x," has been removed"+(a?" in "+a:"")),Pi.ERR_DEPRECATED);return a&&!w3[x]&&(w3[x]=!0,console.warn(p(x," has been deprecated since v"+a+" and will be removed in the near future"))),r?r(y,x,i):!0}};Yw.spelling=function(r){return(a,u)=>(console.warn(`${u} is likely a misspelling of ${r}`),!0)};function nte(e,r,a){if(typeof e!="object")throw new Pi("options must be an object",Pi.ERR_BAD_OPTION_VALUE);const u=Object.keys(e);let p=u.length;for(;p-- >0;){const y=u[p],x=r[y];if(x){const i=e[y],C=i===void 0||x(i,y,e);if(C!==!0)throw new Pi("option "+y+" must be "+C,Pi.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new Pi("Unknown option "+y,Pi.ERR_BAD_OPTION)}}const Y1={assertOptions:nte,validators:Yw},bf=Y1.validators;let Hg=class{constructor(r){this.defaults=r||{},this.interceptors={request:new u3,response:new u3}}async request(r,a){try{return await this._request(r,a)}catch(u){if(u instanceof Error){let p={};Error.captureStackTrace?Error.captureStackTrace(p):p=new Error;const y=p.stack?p.stack.replace(/^.+\n/,""):"";try{u.stack?y&&!String(u.stack).endsWith(y.replace(/^.+\n.+\n/,""))&&(u.stack+=`
`+y):u.stack=y}catch{}}throw u}}_request(r,a){typeof r=="string"?(a=a||{},a.url=r):a=r||{},a=n_(this.defaults,a);const{transitional:u,paramsSerializer:p,headers:y}=a;u!==void 0&&Y1.assertOptions(u,{silentJSONParsing:bf.transitional(bf.boolean),forcedJSONParsing:bf.transitional(bf.boolean),clarifyTimeoutError:bf.transitional(bf.boolean)},!1),p!=null&&(Kt.isFunction(p)?a.paramsSerializer={serialize:p}:Y1.assertOptions(p,{encode:bf.function,serialize:bf.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),Y1.assertOptions(a,{baseUrl:bf.spelling("baseURL"),withXsrfToken:bf.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let x=y&&Kt.merge(y.common,y[a.method]);y&&Kt.forEach(["delete","get","head","post","put","patch","common"],H=>{delete y[H]}),a.headers=Eu.concat(x,y);const i=[];let C=!0;this.interceptors.request.forEach(function(Z){typeof Z.runWhen=="function"&&Z.runWhen(a)===!1||(C=C&&Z.synchronous,i.unshift(Z.fulfilled,Z.rejected))});const R=[];this.interceptors.response.forEach(function(Z){R.push(Z.fulfilled,Z.rejected)});let z,F=0,V;if(!C){const H=[b3.bind(this),void 0];for(H.unshift(...i),H.push(...R),V=H.length,z=Promise.resolve(a);F<V;)z=z.then(H[F++],H[F++]);return z}V=i.length;let G=a;for(;F<V;){const H=i[F++],Z=i[F++];try{G=H(G)}catch(J){Z.call(this,J);break}}try{z=b3.call(this,G)}catch(H){return Promise.reject(H)}for(F=0,V=R.length;F<V;)z=z.then(R[F++],R[F++]);return z}getUri(r){r=n_(this.defaults,r);const a=NW(r.baseURL,r.url,r.allowAbsoluteUrls);return zW(a,r.params,r.paramsSerializer)}};Kt.forEach(["delete","get","head","options"],function(r){Hg.prototype[r]=function(a,u){return this.request(n_(u||{},{method:r,url:a,data:(u||{}).data}))}});Kt.forEach(["post","put","patch"],function(r){function a(u){return function(y,x,i){return this.request(n_(i||{},{method:r,headers:u?{"Content-Type":"multipart/form-data"}:{},url:y,data:x}))}}Hg.prototype[r]=a(),Hg.prototype[r+"Form"]=a(!0)});let ite=class qW{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(y){a=y});const u=this;this.promise.then(p=>{if(!u._listeners)return;let y=u._listeners.length;for(;y-- >0;)u._listeners[y](p);u._listeners=null}),this.promise.then=p=>{let y;const x=new Promise(i=>{u.subscribe(i),y=i}).then(p);return x.cancel=function(){u.unsubscribe(y)},x},r(function(y,x,i){u.reason||(u.reason=new Hy(y,x,i),a(u.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const a=this._listeners.indexOf(r);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const r=new AbortController,a=u=>{r.abort(u)};return this.subscribe(a),r.signal.unsubscribe=()=>this.unsubscribe(a),r.signal}static source(){let r;return{token:new qW(function(p){r=p}),cancel:r}}};function ote(e){return function(a){return e.apply(null,a)}}function ste(e){return Kt.isObject(e)&&e.isAxiosError===!0}const mA={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(mA).forEach(([e,r])=>{mA[r]=e});function GW(e){const r=new Hg(e),a=SW(Hg.prototype.request,r);return Kt.extend(a,Hg.prototype,r,{allOwnKeys:!0}),Kt.extend(a,r,null,{allOwnKeys:!0}),a.create=function(p){return GW(n_(e,p))},a}const Ra=GW(vx);Ra.Axios=Hg;Ra.CanceledError=Hy;Ra.CancelToken=ite;Ra.isCancel=BW;Ra.VERSION=WW;Ra.toFormData=Hw;Ra.AxiosError=Pi;Ra.Cancel=Ra.CanceledError;Ra.all=function(r){return Promise.all(r)};Ra.spread=ote;Ra.isAxiosError=ste;Ra.mergeConfig=n_;Ra.AxiosHeaders=Eu;Ra.formToJSON=e=>kW(Kt.isHTMLForm(e)?new FormData(e):e);Ra.getAdapter=$W.getAdapter;Ra.HttpStatusCode=mA;Ra.default=Ra;const{Axios:BEe,AxiosError:jEe,CanceledError:NEe,isCancel:VEe,CancelToken:UEe,VERSION:$Ee,all:WEe,Cancel:qEe,isAxiosError:GEe,spread:HEe,toFormData:YEe,AxiosHeaders:ZEe,HttpStatusCode:XEe,formToJSON:KEe,getAdapter:QEe,mergeConfig:JEe}=Ra,Ni=Ra.create({baseURL:"http://127.0.0.1:8000/api/v1",withCredentials:!0});Ni.interceptors.request.use(e=>{const r=JSON.parse(localStorage.getItem("user-storage"))?.state?.token;return r&&(e.headers.Authorization=`Bearer ${r}`),e});const ate=async e=>(await Ni.post("/users/signup",e)).data,lte=async(e,r)=>(await Ni.post("/users/login",{email:e,password:r})).data,cte=async()=>Ni.get("/users/logout"),ute=async e=>(await Ni.post("/users/forgotPassword",{email:e})).data,dte=async(e,r)=>(await Ni.patch(`/users/resetPassword/${e}`,r)).data,hte=async e=>(await Ni.patch("/users/updateMyPassword",e)).data,fte=async e=>(await Ni.patch("/users/updateMe",e)).data,pte=async()=>Ni.delete("/users/deleteMe"),Og=async()=>(await Ni.get("/users/me")).data.data.doc,mte=async e=>(await Ni.get(`/users?role=${e}`)).data.data.users,gte=async e=>(await Ni.post("/users/google-login",{credential:e},{withCredentials:!0})).data,_te=async e=>(await Ni.post("/users/send-email-code",{email:e})).data,yte=async(e,r)=>(await Ni.post("/users/verify-email-code",{email:e,code:r})).data,vte=e=>Ni.post("/users/send-otp",{phone:e}),xte=(e,r)=>Ni.post("/users/verify-otp",{phone:e,code:r}),bte=e=>Ni.post("/users/send-phone-verification-otp",{phoneNumber:e}),wte=e=>Ni.post("/users/verify-phone-otp",{code:e}),Ste=e=>Ni.post("/users/check-phone",{phone:e}),HW=qy(mx(RD((e,r)=>({user:null,token:null,users:[],isLoggedIn:!1,loading:!1,error:null,ready:!1,init:async()=>{const{ready:a}=r();if(a)return;if(!r().token){e({ready:!0,isLoggedIn:!1});return}try{const p=await Og();e({user:p,isLoggedIn:!0})}catch{e({user:null,token:null,isLoggedIn:!1})}finally{e({ready:!0})}},signup:async a=>{e({loading:!0,error:null});try{const u=await ate(a);return e({user:u.user,token:u.token,isLoggedIn:!0,loading:!1}),u}catch(u){throw e({loading:!1,error:u.response?.data?.message||"Signup failed"}),u}},isLoggedInUser:()=>{const u=!!r().token;return e({isLoggedIn:u}),u},login:async(a,u)=>{e({loading:!0,error:null});try{const p=await lte(a,u);e({token:p.token});const y=await Og();return e({user:y,loading:!1,isLoggedIn:!0}),{user:y,token:p.token}}catch(p){throw e({loading:!1,error:p.response?.data?.message||"Incorrect email or password"}),p}},googleLogin:async a=>{e({loading:!0,error:null});try{const u=await gte(a);e({token:u.token,isLoggedIn:!0});const p=await Og();return e({user:p,loading:!1}),u}catch(u){throw e({loading:!1,error:u.response?.data?.message||"Google login failed"}),u}},sendEmailCode:async a=>await _te(a),verifyEmailCode:async(a,u)=>{e({loading:!0,error:null});try{const p=await yte(a,u);e({token:p.token,isLoggedIn:!0});const y=await Og();return e({user:y,loading:!1,ready:!0}),y}catch(p){throw e({loading:!1,error:p.response?.data?.message||"Email verification failed"}),p}},sendSmsOtp:async a=>await vte(a),verifySmsOtp:async(a,u)=>{const p=await xte(a,u);e({token:p.token,isLoggedIn:!0});const y=await Og();return e({user:y,loading:!1,ready:!0}),y},sendPhoneVerificationOtp:bte,verifyPhoneVerificationOtp:wte,checkPhoneUnique:Ste,logout:async()=>{try{await cte()}finally{e({user:null,token:null,isLoggedIn:!1})}},forgotPassword:async a=>{try{return await ute(a)}catch(u){throw u.response?.data?.message||"Error sending reset email"}},resetPassword:async(a,u)=>{try{const p=await dte(a,u);return e({user:p.user,token:p.token}),p}catch(p){throw p.response?.data?.message||"Reset password failed"}},updateProfile:async a=>{try{await fte(a);const u=await Og();return e({user:u}),u}catch(u){throw u.response?.data?.message||"Failed updating profile"}},updateMyPassword:async a=>{try{const u=await hte(a);e({token:u.token});const p=await Og();return e({user:p}),u}catch(u){throw u.response?.data?.message||"Password update failed"}},deleteAccount:async()=>{try{await pte(),e({user:null,token:null})}catch(a){throw a.response?.data?.message||"Delete account failed"}},fetchUsers:async(a="user")=>{try{const u=await mte(a);e({users:u})}catch(u){throw u.response?.data?.message||"Failed to load users"}}}),{name:"user-storage",getStorage:()=>localStorage}),{name:"UserStore"}));function Tte(e){return e!=null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function Ete(){return!!globalThis?.document}function YW(e){return e.parentElement&&YW(e.parentElement)?!0:e.hidden}function Pte(e){const r=e.getAttribute("contenteditable");return r!=="false"&&r!=null}function Ite(e){return!!e.getAttribute("disabled")||!!e.getAttribute("aria-disabled")}function Mte(e,...r){if(e==null)throw new TypeError("Cannot convert undefined or null to object");const a={...e};for(const u of r)if(u!=null)for(const p in u)Object.prototype.hasOwnProperty.call(u,p)&&(p in a&&delete a[p],a[p]=u[p]);return a}const Ku=e=>e?"":void 0,o2=e=>e?!0:void 0;function Cte(e){return Array.isArray(e)}function Rd(e){const r=typeof e;return e!=null&&(r==="object"||r==="function")&&!Cte(e)}function Ate(e){const r=e==null?0:e.length;return r?e[r-1]:void 0}function Dte(e){const r=parseFloat(e.toString()),a=e.toString().replace(String(r),"");return{unitless:!a,value:r,unit:a}}function gA(e){if(e==null)return e;const{unitless:r}=Dte(e);return r||typeof e=="number"?`${e}px`:e}const ZW=(e,r)=>parseInt(e[1],10)>parseInt(r[1],10)?1:-1,kD=e=>Object.fromEntries(Object.entries(e).sort(ZW));function S3(e){const r=kD(e);return Object.assign(Object.values(r),r)}function Rte(e){const r=Object.keys(kD(e));return new Set(r)}function T3(e){if(!e)return e;e=gA(e)??e;const r=-.02;return typeof e=="number"?`${e+r}`:e.replace(/(\d+\.?\d*)/u,a=>`${parseFloat(a)+r}`)}function p0(e,r){const a=["@media screen"];return e&&a.push("and",`(min-width: ${gA(e)})`),r&&a.push("and",`(max-width: ${gA(r)})`),a.join(" ")}function Ote(e){if(!e)return null;e.base=e.base??"0px";const r=S3(e),a=Object.entries(e).sort(ZW).map(([y,x],i,C)=>{let[,R]=C[i+1]??[];return R=parseFloat(R)>0?T3(R):void 0,{_minW:T3(x),breakpoint:y,minW:x,maxW:R,maxWQuery:p0(null,R),minWQuery:p0(x),minMaxQuery:p0(x,R)}}),u=Rte(e),p=Array.from(u.values());return{keys:u,normalized:r,isResponsive(y){const x=Object.keys(y);return x.length>0&&x.every(i=>u.has(i))},asObject:kD(e),asArray:S3(e),details:a,get(y){return a.find(x=>x.breakpoint===y)},media:[null,...r.map(y=>p0(y)).slice(1)],toArrayValue(y){if(!Rd(y))throw new Error("toArrayValue: value must be an object");const x=p.map(i=>y[i]??null);for(;Ate(x)===null;)x.pop();return x},toObjectValue(y){if(!Array.isArray(y))throw new Error("toObjectValue: value must be an array");return y.reduce((x,i,C)=>{const R=p[C];return R!=null&&i!=null&&(x[R]=i),x},{})}}}function Ph(...e){return function(a){e.some(u=>(u?.(a),a?.defaultPrevented))}}function XW(e){return ge.Children.toArray(e).filter(r=>ge.isValidElement(r))}function Zw(e){const r=Object.assign({},e);for(let a in r)r[a]===void 0&&delete r[a];return r}function Lte(e,r){return`${e} returned \`undefined\`. Seems you forgot to wrap component within ${r}`}function Pl(e={}){const{name:r,strict:a=!0,hookName:u="useContext",providerName:p="Provider",errorMessage:y,defaultValue:x}=e,i=ge.createContext(x);i.displayName=r;function C(){const R=ge.useContext(i);if(!R&&a){const z=new Error(y??Lte(u,p));throw z.name="ContextError",Error.captureStackTrace?.(z,C),z}return R}return[i.Provider,C,i]}const Yi=(...e)=>e.filter(Boolean).join(" "),zte=e=>e.hasAttribute("tabindex");function Fte(e){if(!Tte(e)||YW(e)||Ite(e))return!1;const{localName:r}=e;if(["input","select","textarea","button"].indexOf(r)>=0)return!0;const u={a:()=>e.hasAttribute("href"),audio:()=>e.hasAttribute("controls"),video:()=>e.hasAttribute("controls")};return r in u?u[r]():Pte(e)?!0:zte(e)}const kte=["input:not(:disabled):not([disabled])","select:not(:disabled):not([disabled])","textarea:not(:disabled):not([disabled])","embed","iframe","object","a[href]","area[href]","button:not(:disabled):not([disabled])","[tabindex]","audio[controls]","video[controls]","*[tabindex]:not([aria-disabled])","*[contenteditable]"],Bte=kte.join(),jte=e=>e.offsetWidth>0&&e.offsetHeight>0;function Nte(e){const r=Array.from(e.querySelectorAll(Bte));return r.unshift(e),r.filter(a=>Fte(a)&&jte(a))}function Vte(e,r,a,u){const p=typeof r=="string"?r.split("."):[r];for(u=0;u<p.length&&e;u+=1)e=e[p[u]];return e===void 0?a:e}const Ute=e=>{const r=new WeakMap;return(u,p,y,x)=>{if(typeof u>"u")return e(u,p,y);r.has(u)||r.set(u,new Map);const i=r.get(u);if(i.has(p))return i.get(p);const C=e(u,p,y,x);return i.set(p,C),C}},KW=Ute(Vte),$te=e=>e.default||e;function QW(e,r=[]){const a=Object.assign({},e);for(const u of r)u in a&&delete a[u];return a}function Wte(e,r){const a={};for(const u of r)u in e&&(a[u]=e[u]);return a}function Xw(e,r){return Array.isArray(e)?e.map(a=>a===null?null:r(a)):Rd(e)?Object.keys(e).reduce((a,u)=>(a[u]=r(e[u]),a),{}):e!=null?r(e):null}const qte=e=>typeof e=="function";function Cd(e,...r){return qte(e)?e(...r):e}function Gte(e,r){const a={},u={};for(const[p,y]of Object.entries(e))r.includes(p)?a[p]=y:u[p]=y;return[a,u]}function Hte(e,...r){const a=Object.getOwnPropertyDescriptors(e),u=Object.keys(a),p=x=>{const i={};for(let C=0;C<x.length;C++){const R=x[C];a[R]&&(Object.defineProperty(i,R,a[R]),delete a[R])}return i},y=x=>p(Array.isArray(x)?x:u.filter(x));return r.map(y).concat(p(u))}function E3(e,r,a={}){const{stop:u,getKey:p}=a;function y(x,i=[]){if(Rd(x)||Array.isArray(x)){const C={};for(const[R,z]of Object.entries(x)){const F=p?.(R)??R,V=[...i,F];if(u?.(x,V))return r(x,i);C[F]=y(z,V)}return C}return r(x,i)}return y(e)}var m0={exports:{}};m0.exports;var P3;function Yte(){return P3||(P3=1,(function(e,r){var a=200,u="__lodash_hash_undefined__",p=800,y=16,x=9007199254740991,i="[object Arguments]",C="[object Array]",R="[object AsyncFunction]",z="[object Boolean]",F="[object Date]",V="[object Error]",G="[object Function]",H="[object GeneratorFunction]",Z="[object Map]",J="[object Number]",se="[object Null]",pe="[object Object]",ve="[object Proxy]",Ne="[object RegExp]",_e="[object Set]",Re="[object String]",ke="[object Undefined]",ze="[object WeakMap]",et="[object ArrayBuffer]",ht="[object DataView]",Xt="[object Float32Array]",Ir="[object Float64Array]",nr="[object Int8Array]",Fr="[object Int16Array]",Or="[object Int32Array]",or="[object Uint8Array]",lt="[object Uint8ClampedArray]",Et="[object Uint16Array]",qt="[object Uint32Array]",Gt=/[\\^$.*+?()[\]{}|]/g,tt=/^\[object .+?Constructor\]$/,ct=/^(?:0|[1-9]\d*)$/,_t={};_t[Xt]=_t[Ir]=_t[nr]=_t[Fr]=_t[Or]=_t[or]=_t[lt]=_t[Et]=_t[qt]=!0,_t[i]=_t[C]=_t[et]=_t[z]=_t[ht]=_t[F]=_t[V]=_t[G]=_t[Z]=_t[J]=_t[pe]=_t[Ne]=_t[_e]=_t[Re]=_t[ze]=!1;var Vt=typeof Db=="object"&&Db&&Db.Object===Object&&Db,bt=typeof self=="object"&&self&&self.Object===Object&&self,ar=Vt||bt||Function("return this")(),hr=r&&!r.nodeType&&r,xr=hr&&!0&&e&&!e.nodeType&&e,sr=xr&&xr.exports===hr,Br=sr&&Vt.process,hn=(function(){try{var Ge=xr&&xr.require&&xr.require("util").types;return Ge||Br&&Br.binding&&Br.binding("util")}catch{}})(),Vn=hn&&hn.isTypedArray;function Yr(Ge,yt,Ht){switch(Ht.length){case 0:return Ge.call(yt);case 1:return Ge.call(yt,Ht[0]);case 2:return Ge.call(yt,Ht[0],Ht[1]);case 3:return Ge.call(yt,Ht[0],Ht[1],Ht[2])}return Ge.apply(yt,Ht)}function Un(Ge,yt){for(var Ht=-1,Xr=Array(Ge);++Ht<Ge;)Xr[Ht]=yt(Ht);return Xr}function Si(Ge){return function(yt){return Ge(yt)}}function di(Ge,yt){return Ge?.[yt]}function Ii(Ge,yt){return function(Ht){return Ge(yt(Ht))}}var Xn=Array.prototype,Go=Function.prototype,Lo=Object.prototype,co=ar["__core-js_shared__"],Ko=Go.toString,ds=Lo.hasOwnProperty,Bo=(function(){var Ge=/[^.]+$/.exec(co&&co.keys&&co.keys.IE_PROTO||"");return Ge?"Symbol(src)_1."+Ge:""})(),ra=Lo.toString,va=Ko.call(Object),xa=RegExp("^"+Ko.call(ds).replace(Gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bs=sr?ar.Buffer:void 0,Qo=ar.Symbol,na=ar.Uint8Array;Bs&&Bs.allocUnsafe;var hs=Ii(Object.getPrototypeOf,Object),Cl=Object.create,Al=Lo.propertyIsEnumerable,io=Xn.splice,js=Qo?Qo.toStringTag:void 0,ba=(function(){try{var Ge=uo(Object,"defineProperty");return Ge({},"",{}),Ge}catch{}})(),wa=Bs?Bs.isBuffer:void 0,Ps=Math.max,Is=Date.now,_i=uo(ar,"Map"),Zi=uo(Object,"create"),ia=(function(){function Ge(){}return function(yt){if(!La(yt))return{};if(Cl)return Cl(yt);Ge.prototype=yt;var Ht=new Ge;return Ge.prototype=void 0,Ht}})();function fs(Ge){var yt=-1,Ht=Ge==null?0:Ge.length;for(this.clear();++yt<Ht;){var Xr=Ge[yt];this.set(Xr[0],Xr[1])}}function Ms(){this.__data__=Zi?Zi(null):{},this.size=0}function Dc(Ge){var yt=this.has(Ge)&&delete this.__data__[Ge];return this.size-=yt?1:0,yt}function rc(Ge){var yt=this.__data__;if(Zi){var Ht=yt[Ge];return Ht===u?void 0:Ht}return ds.call(yt,Ge)?yt[Ge]:void 0}function ru(Ge){var yt=this.__data__;return Zi?yt[Ge]!==void 0:ds.call(yt,Ge)}function ll(Ge,yt){var Ht=this.__data__;return this.size+=this.has(Ge)?0:1,Ht[Ge]=Zi&&yt===void 0?u:yt,this}fs.prototype.clear=Ms,fs.prototype.delete=Dc,fs.prototype.get=rc,fs.prototype.has=ru,fs.prototype.set=ll;function St(Ge){var yt=-1,Ht=Ge==null?0:Ge.length;for(this.clear();++yt<Ht;){var Xr=Ge[yt];this.set(Xr[0],Xr[1])}}function Ns(){this.__data__=[],this.size=0}function Dl(Ge){var yt=this.__data__,Ht=jr(yt,Ge);if(Ht<0)return!1;var Xr=yt.length-1;return Ht==Xr?yt.pop():io.call(yt,Ht,1),--this.size,!0}function Ka(Ge){var yt=this.__data__,Ht=jr(yt,Ge);return Ht<0?void 0:yt[Ht][1]}function vn(Ge){return jr(this.__data__,Ge)>-1}function So(Ge,yt){var Ht=this.__data__,Xr=jr(Ht,Ge);return Xr<0?(++this.size,Ht.push([Ge,yt])):Ht[Xr][1]=yt,this}St.prototype.clear=Ns,St.prototype.delete=Dl,St.prototype.get=Ka,St.prototype.has=vn,St.prototype.set=So;function Sa(Ge){var yt=-1,Ht=Ge==null?0:Ge.length;for(this.clear();++yt<Ht;){var Xr=Ge[yt];this.set(Xr[0],Xr[1])}}function cl(){this.size=0,this.__data__={hash:new fs,map:new(_i||St),string:new fs}}function qe(Ge){var yt=Oa(this,Ge).delete(Ge);return this.size-=yt?1:0,yt}function ie(Ge){return Oa(this,Ge).get(Ge)}function le(Ge){return Oa(this,Ge).has(Ge)}function we(Ge,yt){var Ht=Oa(this,Ge),Xr=Ht.size;return Ht.set(Ge,yt),this.size+=Ht.size==Xr?0:1,this}Sa.prototype.clear=cl,Sa.prototype.delete=qe,Sa.prototype.get=ie,Sa.prototype.has=le,Sa.prototype.set=we;function Oe(Ge){var yt=this.__data__=new St(Ge);this.size=yt.size}function Le(){this.__data__=new St,this.size=0}function Ue(Ge){var yt=this.__data__,Ht=yt.delete(Ge);return this.size=yt.size,Ht}function nt(Ge){return this.__data__.get(Ge)}function We(Ge){return this.__data__.has(Ge)}function Je(Ge,yt){var Ht=this.__data__;if(Ht instanceof St){var Xr=Ht.__data__;if(!_i||Xr.length<a-1)return Xr.push([Ge,yt]),this.size=++Ht.size,this;Ht=this.__data__=new Sa(Xr)}return Ht.set(Ge,yt),this.size=Ht.size,this}Oe.prototype.clear=Le,Oe.prototype.delete=Ue,Oe.prototype.get=nt,Oe.prototype.has=We,Oe.prototype.set=Je;function Ot(Ge,yt){var Ht=$s(Ge),Xr=!Ht&&Us(Ge),jn=!Ht&&!Xr&&ul(Ge),Ri=!Ht&&!Xr&&!jn&&Rc(Ge),Ui=Ht||Xr||jn||Ri,ai=Ui?Un(Ge.length,String):[],Oi=ai.length;for(var eo in Ge)Ui&&(eo=="length"||jn&&(eo=="offset"||eo=="parent")||Ri&&(eo=="buffer"||eo=="byteLength"||eo=="byteOffset")||As(eo,Oi))||ai.push(eo);return ai}function Pt(Ge,yt,Ht){(Ht!==void 0&&!Vs(Ge[yt],Ht)||Ht===void 0&&!(yt in Ge))&&yr(Ge,yt,Ht)}function gr(Ge,yt,Ht){var Xr=Ge[yt];(!(ds.call(Ge,yt)&&Vs(Xr,Ht))||Ht===void 0&&!(yt in Ge))&&yr(Ge,yt,Ht)}function jr(Ge,yt){for(var Ht=Ge.length;Ht--;)if(Vs(Ge[Ht][0],yt))return Ht;return-1}function yr(Ge,yt,Ht){yt=="__proto__"&&ba?ba(Ge,yt,{configurable:!0,enumerable:!0,value:Ht,writable:!0}):Ge[yt]=Ht}var Cr=ps();function Zr(Ge){return Ge==null?Ge===void 0?ke:se:js&&js in Object(Ge)?Cs(Ge):oc(Ge)}function on(Ge){return ms(Ge)&&Zr(Ge)==i}function Cn(Ge){if(!La(Ge)||nc(Ge))return!1;var yt=Ea(Ge)?xa:tt;return yt.test(Ta(Ge))}function Mi(Ge){return ms(Ge)&&Ws(Ge.length)&&!!_t[Zr(Ge)]}function Qi(Ge){if(!La(Ge))return ic(Ge);var yt=yi(Ge),Ht=[];for(var Xr in Ge)Xr=="constructor"&&(yt||!ds.call(Ge,Xr))||Ht.push(Xr);return Ht}function Ti(Ge,yt,Ht,Xr,jn){Ge!==yt&&Cr(yt,function(Ri,Ui){if(jn||(jn=new Oe),La(Ri))si(Ge,yt,Ui,Ht,Ti,Xr,jn);else{var ai=Xr?Xr(Rs(Ge,Ui),Ri,Ui+"",Ge,yt,jn):void 0;ai===void 0&&(ai=Ri),Pt(Ge,Ui,ai)}},hl)}function si(Ge,yt,Ht,Xr,jn,Ri,Ui){var ai=Rs(Ge,Ht),Oi=Rs(yt,Ht),eo=Ui.get(Oi);if(eo){Pt(Ge,Ht,eo);return}var Yo=Ri?Ri(ai,Oi,Ht+"",Ge,yt,Ui):void 0,qs=Yo===void 0;if(qs){var ka=$s(Oi),sa=!ka&&ul(Oi),pi=!ka&&!sa&&Rc(Oi);Yo=Oi,ka||sa||pi?$s(ai)?Yo=ai:oa(ai)?Yo=ii(ai):sa?(qs=!1,Yo=fi(Oi)):pi?(qs=!1,Yo=$n(Oi)):Yo=[]:Rl(Oi)||Us(Oi)?(Yo=ai,Us(ai)?Yo=dl(ai):(!La(ai)||Ea(ai))&&(Yo=Jo(Oi))):qs=!1}qs&&(Ui.set(Oi,Yo),jn(Yo,Oi,Xr,Ri,Ui),Ui.delete(Oi)),Pt(Ge,Ht,Yo)}function Ln(Ge,yt){return ts(es(Ge,yt,za),Ge+"")}var rn=ba?function(Ge,yt){return ba(Ge,"toString",{configurable:!0,enumerable:!1,value:Ol(yt),writable:!0})}:za;function fi(Ge,yt){return Ge.slice()}function Ei(Ge){var yt=new Ge.constructor(Ge.byteLength);return new na(yt).set(new na(Ge)),yt}function $n(Ge,yt){var Ht=Ei(Ge.buffer);return new Ge.constructor(Ht,Ge.byteOffset,Ge.length)}function ii(Ge,yt){var Ht=-1,Xr=Ge.length;for(yt||(yt=Array(Xr));++Ht<Xr;)yt[Ht]=Ge[Ht];return yt}function Ji(Ge,yt,Ht,Xr){var jn=!Ht;Ht||(Ht={});for(var Ri=-1,Ui=yt.length;++Ri<Ui;){var ai=yt[Ri],Oi=void 0;Oi===void 0&&(Oi=Ge[ai]),jn?yr(Ht,ai,Oi):gr(Ht,ai,Oi)}return Ht}function To(Ge){return Ln(function(yt,Ht){var Xr=-1,jn=Ht.length,Ri=jn>1?Ht[jn-1]:void 0,Ui=jn>2?Ht[2]:void 0;for(Ri=Ge.length>3&&typeof Ri=="function"?(jn--,Ri):void 0,Ui&&Ho(Ht[0],Ht[1],Ui)&&(Ri=jn<3?void 0:Ri,jn=1),yt=Object(yt);++Xr<jn;){var ai=Ht[Xr];ai&&Ge(yt,ai,Xr,Ri)}return yt})}function ps(Ge){return function(yt,Ht,Xr){for(var jn=-1,Ri=Object(yt),Ui=Xr(yt),ai=Ui.length;ai--;){var Oi=Ui[++jn];if(Ht(Ri[Oi],Oi,Ri)===!1)break}return yt}}function Oa(Ge,yt){var Ht=Ge.__data__;return Ds(yt)?Ht[typeof yt=="string"?"string":"hash"]:Ht.map}function uo(Ge,yt){var Ht=di(Ge,yt);return Cn(Ht)?Ht:void 0}function Cs(Ge){var yt=ds.call(Ge,js),Ht=Ge[js];try{Ge[js]=void 0;var Xr=!0}catch{}var jn=ra.call(Ge);return Xr&&(yt?Ge[js]=Ht:delete Ge[js]),jn}function Jo(Ge){return typeof Ge.constructor=="function"&&!yi(Ge)?ia(hs(Ge)):{}}function As(Ge,yt){var Ht=typeof Ge;return yt=yt??x,!!yt&&(Ht=="number"||Ht!="symbol"&&ct.test(Ge))&&Ge>-1&&Ge%1==0&&Ge<yt}function Ho(Ge,yt,Ht){if(!La(Ht))return!1;var Xr=typeof yt;return(Xr=="number"?jo(Ht)&&As(yt,Ht.length):Xr=="string"&&yt in Ht)?Vs(Ht[yt],Ge):!1}function Ds(Ge){var yt=typeof Ge;return yt=="string"||yt=="number"||yt=="symbol"||yt=="boolean"?Ge!=="__proto__":Ge===null}function nc(Ge){return!!Bo&&Bo in Ge}function yi(Ge){var yt=Ge&&Ge.constructor,Ht=typeof yt=="function"&&yt.prototype||Lo;return Ge===Ht}function ic(Ge){var yt=[];if(Ge!=null)for(var Ht in Object(Ge))yt.push(Ht);return yt}function oc(Ge){return ra.call(Ge)}function es(Ge,yt,Ht){return yt=Ps(yt===void 0?Ge.length-1:yt,0),function(){for(var Xr=arguments,jn=-1,Ri=Ps(Xr.length-yt,0),Ui=Array(Ri);++jn<Ri;)Ui[jn]=Xr[yt+jn];jn=-1;for(var ai=Array(yt+1);++jn<yt;)ai[jn]=Xr[jn];return ai[yt]=Ht(Ui),Yr(Ge,this,ai)}}function Rs(Ge,yt){if(!(yt==="constructor"&&typeof Ge[yt]=="function")&&yt!="__proto__")return Ge[yt]}var ts=Os(rn);function Os(Ge){var yt=0,Ht=0;return function(){var Xr=Is(),jn=y-(Xr-Ht);if(Ht=Xr,jn>0){if(++yt>=p)return arguments[0]}else yt=0;return Ge.apply(void 0,arguments)}}function Ta(Ge){if(Ge!=null){try{return Ko.call(Ge)}catch{}try{return Ge+""}catch{}}return""}function Vs(Ge,yt){return Ge===yt||Ge!==Ge&&yt!==yt}var Us=on((function(){return arguments})())?on:function(Ge){return ms(Ge)&&ds.call(Ge,"callee")&&!Al.call(Ge,"callee")},$s=Array.isArray;function jo(Ge){return Ge!=null&&Ws(Ge.length)&&!Ea(Ge)}function oa(Ge){return ms(Ge)&&jo(Ge)}var ul=wa||Fa;function Ea(Ge){if(!La(Ge))return!1;var yt=Zr(Ge);return yt==G||yt==H||yt==R||yt==ve}function Ws(Ge){return typeof Ge=="number"&&Ge>-1&&Ge%1==0&&Ge<=x}function La(Ge){var yt=typeof Ge;return Ge!=null&&(yt=="object"||yt=="function")}function ms(Ge){return Ge!=null&&typeof Ge=="object"}function Rl(Ge){if(!ms(Ge)||Zr(Ge)!=pe)return!1;var yt=hs(Ge);if(yt===null)return!0;var Ht=ds.call(yt,"constructor")&&yt.constructor;return typeof Ht=="function"&&Ht instanceof Ht&&Ko.call(Ht)==va}var Rc=Vn?Si(Vn):Mi;function dl(Ge){return Ji(Ge,hl(Ge))}function hl(Ge){return jo(Ge)?Ot(Ge):Qi(Ge)}var bn=To(function(Ge,yt,Ht,Xr){Ti(Ge,yt,Ht,Xr)});function Ol(Ge){return function(){return Ge}}function za(Ge){return Ge}function Fa(){return!1}e.exports=bn})(m0,m0.exports)),m0.exports}var Zte=Yte();const Cf=hx(Zte);function wy(e,r=[]){const a=ge.useRef(e);return ge.useEffect(()=>{a.current=e}),ge.useCallback((...u)=>a.current?.(...u),r)}function Xte(e){const{value:r,defaultValue:a,onChange:u,shouldUpdate:p=(V,G)=>V!==G}=e,y=wy(u),x=wy(p),[i,C]=ge.useState(a),R=r!==void 0,z=R?r:i,F=wy(V=>{const H=typeof V=="function"?V(z):V;x(z,H)&&(R||C(H),y(H))},[R,y,z,x]);return[z,F]}function JW(e={}){const{onClose:r,onOpen:a,isOpen:u,id:p}=e,y=wy(a),x=wy(r),[i,C]=ge.useState(e.defaultIsOpen||!1),R=u!==void 0?u:i,z=u!==void 0,F=ge.useId(),V=p??`disclosure-${F}`,G=ge.useCallback(()=>{z||C(!1),x?.()},[z,x]),H=ge.useCallback(()=>{z||C(!0),y?.()},[z,y]),Z=ge.useCallback(()=>{R?G():H()},[R,H,G]);function J(pe={}){return{...pe,"aria-expanded":R,"aria-controls":V,onClick(ve){pe.onClick?.(ve),Z()}}}function se(pe={}){return{...pe,hidden:!R,id:V}}return{isOpen:R,onOpen:H,onClose:G,onToggle:Z,isControlled:z,getButtonProps:J,getDisclosureProps:se}}const xw=globalThis?.document?ge.useLayoutEffect:ge.useEffect,I3=(e,r)=>{const a=ge.useRef(!1),u=ge.useRef(!1);ge.useEffect(()=>{if(a.current&&u.current)return e();u.current=!0},r),ge.useEffect(()=>(a.current=!0,()=>{a.current=!1}),[])};function Kte(e,r){if(e!=null){if(typeof e=="function"){e(r);return}try{e.current=r}catch{throw new Error(`Cannot assign value '${r}' to ref '${e}'`)}}}function Nm(...e){return r=>{e.forEach(a=>{Kte(a,r)})}}function Qte(...e){return ge.useMemo(()=>Nm(...e),e)}function Jte(e,r){const a=wy(e);ge.useEffect(()=>{if(r==null)return;let u=null;return u=window.setTimeout(()=>{a()},r),()=>{u&&window.clearTimeout(u)}},[r,a])}const ol={open:(e,r)=>`${e}[data-open], ${e}[open], ${e}[data-state=open] ${r}`,closed:(e,r)=>`${e}[data-closed], ${e}[data-state=closed] ${r}`,hover:(e,r)=>`${e}:hover ${r}, ${e}[data-hover] ${r}`,focus:(e,r)=>`${e}:focus ${r}, ${e}[data-focus] ${r}`,focusVisible:(e,r)=>`${e}:focus-visible ${r}`,focusWithin:(e,r)=>`${e}:focus-within ${r}`,active:(e,r)=>`${e}:active ${r}, ${e}[data-active] ${r}`,disabled:(e,r)=>`${e}:disabled ${r}, ${e}[data-disabled] ${r}`,invalid:(e,r)=>`${e}:invalid ${r}, ${e}[data-invalid] ${r}`,checked:(e,r)=>`${e}:checked ${r}, ${e}[data-checked] ${r}`,placeholderShown:(e,r)=>`${e}:placeholder-shown ${r}`},wf=e=>e8(r=>e(r,"&"),"[role=group]","[data-group]",".group"),wp=e=>e8(r=>e(r,"~ &"),"[data-peer]",".peer"),e8=(e,...r)=>r.map(e).join(", "),Kw={_hover:"&:hover, &[data-hover]",_active:"&:active, &[data-active]",_focus:"&:focus, &[data-focus]",_highlighted:"&[data-highlighted]",_focusWithin:"&:focus-within, &[data-focus-within]",_focusVisible:"&:focus-visible, &[data-focus-visible]",_disabled:"&:disabled, &[disabled], &[aria-disabled=true], &[data-disabled]",_readOnly:"&[aria-readonly=true], &[readonly], &[data-readonly]",_before:"&::before",_after:"&::after",_empty:"&:empty, &[data-empty]",_expanded:"&[aria-expanded=true], &[data-expanded], &[data-state=expanded]",_checked:"&[aria-checked=true], &[data-checked], &[data-state=checked]",_grabbed:"&[aria-grabbed=true], &[data-grabbed]",_pressed:"&[aria-pressed=true], &[data-pressed]",_invalid:"&[aria-invalid=true], &[data-invalid]",_valid:"&[data-valid], &[data-state=valid]",_loading:"&[data-loading], &[aria-busy=true]",_selected:"&[aria-selected=true], &[data-selected]",_hidden:"&[hidden], &[data-hidden]",_autofill:"&:-webkit-autofill",_even:"&:nth-of-type(even)",_odd:"&:nth-of-type(odd)",_first:"&:first-of-type",_firstLetter:"&::first-letter",_last:"&:last-of-type",_notFirst:"&:not(:first-of-type)",_notLast:"&:not(:last-of-type)",_visited:"&:visited",_activeLink:"&[aria-current=page]",_activeStep:"&[aria-current=step]",_indeterminate:"&:indeterminate, &[aria-checked=mixed], &[data-indeterminate], &[data-state=indeterminate]",_groupOpen:wf(ol.open),_groupClosed:wf(ol.closed),_groupHover:wf(ol.hover),_peerHover:wp(ol.hover),_groupFocus:wf(ol.focus),_peerFocus:wp(ol.focus),_groupFocusVisible:wf(ol.focusVisible),_peerFocusVisible:wp(ol.focusVisible),_groupActive:wf(ol.active),_peerActive:wp(ol.active),_groupDisabled:wf(ol.disabled),_peerDisabled:wp(ol.disabled),_groupInvalid:wf(ol.invalid),_peerInvalid:wp(ol.invalid),_groupChecked:wf(ol.checked),_peerChecked:wp(ol.checked),_groupFocusWithin:wf(ol.focusWithin),_peerFocusWithin:wp(ol.focusWithin),_peerPlaceholderShown:wp(ol.placeholderShown),_placeholder:"&::placeholder, &[data-placeholder]",_placeholderShown:"&:placeholder-shown, &[data-placeholder-shown]",_fullScreen:"&:fullscreen, &[data-fullscreen]",_selection:"&::selection",_rtl:"[dir=rtl] &, &[dir=rtl]",_ltr:"[dir=ltr] &, &[dir=ltr]",_mediaDark:"@media (prefers-color-scheme: dark)",_mediaReduceMotion:"@media (prefers-reduced-motion: reduce)",_dark:".chakra-ui-dark &:not([data-theme]),[data-theme=dark] &:not([data-theme]),&[data-theme=dark]",_light:".chakra-ui-light &:not([data-theme]),[data-theme=light] &:not([data-theme]),&[data-theme=light]",_horizontal:"&[data-orientation=horizontal]",_vertical:"&[data-orientation=vertical]",_open:"&[data-open], &[open], &[data-state=open]",_closed:"&[data-closed], &[data-state=closed]",_complete:"&[data-complete]",_incomplete:"&[data-incomplete]",_current:"&[data-current]"},t8=Object.keys(Kw),ere=e=>/!(important)?$/.test(e),M3=e=>typeof e=="string"?e.replace(/!(important)?$/,"").trim():e,tre=(e,r)=>a=>{const u=String(r),p=ere(u),y=M3(u),x=e?`${e}.${y}`:y;let i=Rd(a.__cssMap)&&x in a.__cssMap?a.__cssMap[x].varRef:r;return i=M3(i),p?`${i} !important`:i};function BD(e){const{scale:r,transform:a,compose:u}=e;return(y,x)=>{const i=tre(r,y)(x);let C=a?.(i,x)??i;return u&&(C=u(C,x)),C}}const zb=(...e)=>r=>e.reduce((a,u)=>u(a),r);function Td(e,r){return a=>{const u={property:a,scale:e};return u.transform=BD({scale:e,transform:r}),u}}const rre=({rtl:e,ltr:r})=>a=>a.direction==="rtl"?e:r;function nre(e){const{property:r,scale:a,transform:u}=e;return{scale:a,property:rre(r),transform:a?BD({scale:a,compose:u}):u}}const r8=["rotate(var(--chakra-rotate, 0))","scaleX(var(--chakra-scale-x, 1))","scaleY(var(--chakra-scale-y, 1))","skewX(var(--chakra-skew-x, 0))","skewY(var(--chakra-skew-y, 0))"];function ire(){return["translateX(var(--chakra-translate-x, 0))","translateY(var(--chakra-translate-y, 0))",...r8].join(" ")}function ore(){return["translate3d(var(--chakra-translate-x, 0), var(--chakra-translate-y, 0), 0)",...r8].join(" ")}const sre={"--chakra-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-sepia":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-drop-shadow":"var(--chakra-empty,/*!*/ /*!*/)",filter:["var(--chakra-blur)","var(--chakra-brightness)","var(--chakra-contrast)","var(--chakra-grayscale)","var(--chakra-hue-rotate)","var(--chakra-invert)","var(--chakra-saturate)","var(--chakra-sepia)","var(--chakra-drop-shadow)"].join(" ")},are={backdropFilter:["var(--chakra-backdrop-blur)","var(--chakra-backdrop-brightness)","var(--chakra-backdrop-contrast)","var(--chakra-backdrop-grayscale)","var(--chakra-backdrop-hue-rotate)","var(--chakra-backdrop-invert)","var(--chakra-backdrop-opacity)","var(--chakra-backdrop-saturate)","var(--chakra-backdrop-sepia)"].join(" "),"--chakra-backdrop-blur":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-brightness":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-contrast":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-grayscale":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-hue-rotate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-invert":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-opacity":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-saturate":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-backdrop-sepia":"var(--chakra-empty,/*!*/ /*!*/)"};function lre(e){return{"--chakra-ring-offset-shadow":"var(--chakra-ring-inset) 0 0 0 var(--chakra-ring-offset-width) var(--chakra-ring-offset-color)","--chakra-ring-shadow":"var(--chakra-ring-inset) 0 0 0 calc(var(--chakra-ring-width) + var(--chakra-ring-offset-width)) var(--chakra-ring-color)","--chakra-ring-width":e,boxShadow:["var(--chakra-ring-offset-shadow)","var(--chakra-ring-shadow)","var(--chakra-shadow, 0 0 #0000)"].join(", ")}}const cre={"row-reverse":{space:"--chakra-space-x-reverse",divide:"--chakra-divide-x-reverse"},"column-reverse":{space:"--chakra-space-y-reverse",divide:"--chakra-divide-y-reverse"}},_A={"to-t":"to top","to-tr":"to top right","to-r":"to right","to-br":"to bottom right","to-b":"to bottom","to-bl":"to bottom left","to-l":"to left","to-tl":"to top left"},ure=new Set(Object.values(_A)),yA=new Set(["none","-moz-initial","inherit","initial","revert","unset"]),dre=e=>e.trim();function hre(e,r){if(e==null||yA.has(e))return e;if(!(vA(e)||yA.has(e)))return`url('${e}')`;const p=/(^[a-z-A-Z]+)\((.*)\)/g.exec(e),y=p?.[1],x=p?.[2];if(!y||!x)return e;const i=y.includes("-gradient")?y:`${y}-gradient`,[C,...R]=x.split(",").map(dre).filter(Boolean);if(R?.length===0)return e;const z=C in _A?_A[C]:C;R.unshift(z);const F=R.map(V=>{if(ure.has(V))return V;const G=V.indexOf(" "),[H,Z]=G!==-1?[V.substr(0,G),V.substr(G+1)]:[V],J=vA(Z)?Z:Z&&Z.split(" "),se=`colors.${H}`,pe=se in r.__cssMap?r.__cssMap[se].varRef:H;return J?[pe,...Array.isArray(J)?J:[J]].join(" "):pe});return`${i}(${F.join(", ")})`}const vA=e=>typeof e=="string"&&e.includes("(")&&e.includes(")"),fre=(e,r)=>hre(e,r??{});function pre(e){return/^var\(--.+\)$/.test(e)}const mre=e=>{const r=parseFloat(e.toString()),a=e.toString().replace(String(r),"");return{unitless:!a,value:r,unit:a}},Sf=e=>r=>`${e}(${r})`,lo={filter(e){return e!=="auto"?e:sre},backdropFilter(e){return e!=="auto"?e:are},ring(e){return lre(lo.px(e))},bgClip(e){return e==="text"?{color:"transparent",backgroundClip:"text"}:{backgroundClip:e}},transform(e){return e==="auto"?ire():e==="auto-gpu"?ore():e},vh(e){return e==="$100vh"?"var(--chakra-vh)":e},px(e){if(e==null)return e;const{unitless:r}=mre(e);return r||typeof e=="number"?`${e}px`:e},fraction(e){return typeof e!="number"||e>1?e:`${e*100}%`},float(e,r){const a={left:"right",right:"left"};return r.direction==="rtl"?a[e]:e},degree(e){if(pre(e)||e==null)return e;const r=typeof e=="string"&&!e.endsWith("deg");return typeof e=="number"||r?`${e}deg`:e},gradient:fre,blur:Sf("blur"),opacity:Sf("opacity"),brightness:Sf("brightness"),contrast:Sf("contrast"),dropShadow:Sf("drop-shadow"),grayscale:Sf("grayscale"),hueRotate:e=>Sf("hue-rotate")(lo.degree(e)),invert:Sf("invert"),saturate:Sf("saturate"),sepia:Sf("sepia"),bgImage(e){return e==null||vA(e)||yA.has(e)?e:`url(${e})`},outline(e){const r=String(e)==="0"||String(e)==="none";return e!==null&&r?{outline:"2px solid transparent",outlineOffset:"2px"}:{outline:e}},flexDirection(e){const{space:r,divide:a}=cre[e]??{},u={flexDirection:e};return r&&(u[r]=1),a&&(u[a]=1),u}},Tt={borderWidths:Td("borderWidths"),borderStyles:Td("borderStyles"),colors:Td("colors"),borders:Td("borders"),gradients:Td("gradients",lo.gradient),radii:Td("radii",lo.px),space:Td("space",zb(lo.vh,lo.px)),spaceT:Td("space",zb(lo.vh,lo.px)),degreeT(e){return{property:e,transform:lo.degree}},prop(e,r,a){return{property:e,scale:r,...r&&{transform:BD({scale:r,transform:a})}}},propT(e,r){return{property:e,transform:r}},sizes:Td("sizes",zb(lo.vh,lo.px)),sizesT:Td("sizes",zb(lo.vh,lo.fraction)),shadows:Td("shadows"),logical:nre,blur:Td("blur",lo.blur)},Z1={background:Tt.colors("background"),backgroundColor:Tt.colors("backgroundColor"),backgroundImage:Tt.gradients("backgroundImage"),backgroundSize:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundAttachment:!0,backgroundClip:{transform:lo.bgClip},bgSize:Tt.prop("backgroundSize"),bgPosition:Tt.prop("backgroundPosition"),bg:Tt.colors("background"),bgColor:Tt.colors("backgroundColor"),bgPos:Tt.prop("backgroundPosition"),bgRepeat:Tt.prop("backgroundRepeat"),bgAttachment:Tt.prop("backgroundAttachment"),bgGradient:Tt.gradients("backgroundImage"),bgClip:{transform:lo.bgClip}};Object.assign(Z1,{bgImage:Z1.backgroundImage,bgImg:Z1.backgroundImage});const Mo={border:Tt.borders("border"),borderWidth:Tt.borderWidths("borderWidth"),borderStyle:Tt.borderStyles("borderStyle"),borderColor:Tt.colors("borderColor"),borderRadius:Tt.radii("borderRadius"),borderTop:Tt.borders("borderTop"),borderBlockStart:Tt.borders("borderBlockStart"),borderTopLeftRadius:Tt.radii("borderTopLeftRadius"),borderStartStartRadius:Tt.logical({scale:"radii",property:{ltr:"borderTopLeftRadius",rtl:"borderTopRightRadius"}}),borderEndStartRadius:Tt.logical({scale:"radii",property:{ltr:"borderBottomLeftRadius",rtl:"borderBottomRightRadius"}}),borderTopRightRadius:Tt.radii("borderTopRightRadius"),borderStartEndRadius:Tt.logical({scale:"radii",property:{ltr:"borderTopRightRadius",rtl:"borderTopLeftRadius"}}),borderEndEndRadius:Tt.logical({scale:"radii",property:{ltr:"borderBottomRightRadius",rtl:"borderBottomLeftRadius"}}),borderRight:Tt.borders("borderRight"),borderInlineEnd:Tt.borders("borderInlineEnd"),borderBottom:Tt.borders("borderBottom"),borderBlockEnd:Tt.borders("borderBlockEnd"),borderBottomLeftRadius:Tt.radii("borderBottomLeftRadius"),borderBottomRightRadius:Tt.radii("borderBottomRightRadius"),borderLeft:Tt.borders("borderLeft"),borderInlineStart:{property:"borderInlineStart",scale:"borders"},borderInlineStartRadius:Tt.logical({scale:"radii",property:{ltr:["borderTopLeftRadius","borderBottomLeftRadius"],rtl:["borderTopRightRadius","borderBottomRightRadius"]}}),borderInlineEndRadius:Tt.logical({scale:"radii",property:{ltr:["borderTopRightRadius","borderBottomRightRadius"],rtl:["borderTopLeftRadius","borderBottomLeftRadius"]}}),borderX:Tt.borders(["borderLeft","borderRight"]),borderInline:Tt.borders("borderInline"),borderY:Tt.borders(["borderTop","borderBottom"]),borderBlock:Tt.borders("borderBlock"),borderTopWidth:Tt.borderWidths("borderTopWidth"),borderBlockStartWidth:Tt.borderWidths("borderBlockStartWidth"),borderTopColor:Tt.colors("borderTopColor"),borderBlockStartColor:Tt.colors("borderBlockStartColor"),borderTopStyle:Tt.borderStyles("borderTopStyle"),borderBlockStartStyle:Tt.borderStyles("borderBlockStartStyle"),borderBottomWidth:Tt.borderWidths("borderBottomWidth"),borderBlockEndWidth:Tt.borderWidths("borderBlockEndWidth"),borderBottomColor:Tt.colors("borderBottomColor"),borderBlockEndColor:Tt.colors("borderBlockEndColor"),borderBottomStyle:Tt.borderStyles("borderBottomStyle"),borderBlockEndStyle:Tt.borderStyles("borderBlockEndStyle"),borderLeftWidth:Tt.borderWidths("borderLeftWidth"),borderInlineStartWidth:Tt.borderWidths("borderInlineStartWidth"),borderLeftColor:Tt.colors("borderLeftColor"),borderInlineStartColor:Tt.colors("borderInlineStartColor"),borderLeftStyle:Tt.borderStyles("borderLeftStyle"),borderInlineStartStyle:Tt.borderStyles("borderInlineStartStyle"),borderRightWidth:Tt.borderWidths("borderRightWidth"),borderInlineEndWidth:Tt.borderWidths("borderInlineEndWidth"),borderRightColor:Tt.colors("borderRightColor"),borderInlineEndColor:Tt.colors("borderInlineEndColor"),borderRightStyle:Tt.borderStyles("borderRightStyle"),borderInlineEndStyle:Tt.borderStyles("borderInlineEndStyle"),borderTopRadius:Tt.radii(["borderTopLeftRadius","borderTopRightRadius"]),borderBottomRadius:Tt.radii(["borderBottomLeftRadius","borderBottomRightRadius"]),borderLeftRadius:Tt.radii(["borderTopLeftRadius","borderBottomLeftRadius"]),borderRightRadius:Tt.radii(["borderTopRightRadius","borderBottomRightRadius"])};Object.assign(Mo,{rounded:Mo.borderRadius,roundedTop:Mo.borderTopRadius,roundedTopLeft:Mo.borderTopLeftRadius,roundedTopRight:Mo.borderTopRightRadius,roundedTopStart:Mo.borderStartStartRadius,roundedTopEnd:Mo.borderStartEndRadius,roundedBottom:Mo.borderBottomRadius,roundedBottomLeft:Mo.borderBottomLeftRadius,roundedBottomRight:Mo.borderBottomRightRadius,roundedBottomStart:Mo.borderEndStartRadius,roundedBottomEnd:Mo.borderEndEndRadius,roundedLeft:Mo.borderLeftRadius,roundedRight:Mo.borderRightRadius,roundedStart:Mo.borderInlineStartRadius,roundedEnd:Mo.borderInlineEndRadius,borderStart:Mo.borderInlineStart,borderEnd:Mo.borderInlineEnd,borderTopStartRadius:Mo.borderStartStartRadius,borderTopEndRadius:Mo.borderStartEndRadius,borderBottomStartRadius:Mo.borderEndStartRadius,borderBottomEndRadius:Mo.borderEndEndRadius,borderStartRadius:Mo.borderInlineStartRadius,borderEndRadius:Mo.borderInlineEndRadius,borderStartWidth:Mo.borderInlineStartWidth,borderEndWidth:Mo.borderInlineEndWidth,borderStartColor:Mo.borderInlineStartColor,borderEndColor:Mo.borderInlineEndColor,borderStartStyle:Mo.borderInlineStartStyle,borderEndStyle:Mo.borderInlineEndStyle});const gre={color:Tt.colors("color"),textColor:Tt.colors("color"),fill:Tt.colors("fill"),stroke:Tt.colors("stroke"),accentColor:Tt.colors("accentColor"),textFillColor:Tt.colors("textFillColor")},bw={alignItems:!0,alignContent:!0,justifyItems:!0,justifyContent:!0,flexWrap:!0,flexDirection:{transform:lo.flexDirection},flex:!0,flexFlow:!0,flexGrow:!0,flexShrink:!0,flexBasis:Tt.sizes("flexBasis"),justifySelf:!0,alignSelf:!0,order:!0,placeItems:!0,placeContent:!0,placeSelf:!0,gap:Tt.space("gap"),rowGap:Tt.space("rowGap"),columnGap:Tt.space("columnGap")};Object.assign(bw,{flexDir:bw.flexDirection});const Pd={width:Tt.sizesT("width"),inlineSize:Tt.sizesT("inlineSize"),height:Tt.sizes("height"),blockSize:Tt.sizes("blockSize"),boxSize:Tt.sizes(["width","height"]),minWidth:Tt.sizes("minWidth"),minInlineSize:Tt.sizes("minInlineSize"),minHeight:Tt.sizes("minHeight"),minBlockSize:Tt.sizes("minBlockSize"),maxWidth:Tt.sizes("maxWidth"),maxInlineSize:Tt.sizes("maxInlineSize"),maxHeight:Tt.sizes("maxHeight"),maxBlockSize:Tt.sizes("maxBlockSize"),overflow:!0,overflowX:!0,overflowY:!0,overscrollBehavior:!0,overscrollBehaviorX:!0,overscrollBehaviorY:!0,display:!0,aspectRatio:!0,hideFrom:{scale:"breakpoints",transform:(e,r)=>({[`@media screen and (min-width: ${r.__breakpoints?.get(e)?.minW??e})`]:{display:"none"}})},hideBelow:{scale:"breakpoints",transform:(e,r)=>({[`@media screen and (max-width: ${r.__breakpoints?.get(e)?._minW??e})`]:{display:"none"}})},verticalAlign:!0,boxSizing:!0,boxDecorationBreak:!0,float:Tt.propT("float",lo.float),objectFit:!0,objectPosition:!0,visibility:!0,isolation:!0};Object.assign(Pd,{w:Pd.width,h:Pd.height,minW:Pd.minWidth,maxW:Pd.maxWidth,minH:Pd.minHeight,maxH:Pd.maxHeight,overscroll:Pd.overscrollBehavior,overscrollX:Pd.overscrollBehaviorX,overscrollY:Pd.overscrollBehaviorY});const _re={filter:{transform:lo.filter},blur:Tt.blur("--chakra-blur"),brightness:Tt.propT("--chakra-brightness",lo.brightness),contrast:Tt.propT("--chakra-contrast",lo.contrast),hueRotate:Tt.propT("--chakra-hue-rotate",lo.hueRotate),invert:Tt.propT("--chakra-invert",lo.invert),saturate:Tt.propT("--chakra-saturate",lo.saturate),dropShadow:Tt.propT("--chakra-drop-shadow",lo.dropShadow),backdropFilter:{transform:lo.backdropFilter},backdropBlur:Tt.blur("--chakra-backdrop-blur"),backdropBrightness:Tt.propT("--chakra-backdrop-brightness",lo.brightness),backdropContrast:Tt.propT("--chakra-backdrop-contrast",lo.contrast),backdropHueRotate:Tt.propT("--chakra-backdrop-hue-rotate",lo.hueRotate),backdropInvert:Tt.propT("--chakra-backdrop-invert",lo.invert),backdropSaturate:Tt.propT("--chakra-backdrop-saturate",lo.saturate)},yre={ring:{transform:lo.ring},ringColor:Tt.colors("--chakra-ring-color"),ringOffset:Tt.prop("--chakra-ring-offset-width"),ringOffsetColor:Tt.colors("--chakra-ring-offset-color"),ringInset:Tt.prop("--chakra-ring-inset")},vre={appearance:!0,cursor:!0,resize:!0,userSelect:!0,pointerEvents:!0,outline:{transform:lo.outline},outlineOffset:!0,outlineColor:Tt.colors("outlineColor")},n8={gridGap:Tt.space("gridGap"),gridColumnGap:Tt.space("gridColumnGap"),gridRowGap:Tt.space("gridRowGap"),gridColumn:!0,gridRow:!0,gridAutoFlow:!0,gridAutoColumns:!0,gridColumnStart:!0,gridColumnEnd:!0,gridRowStart:!0,gridRowEnd:!0,gridAutoRows:!0,gridTemplate:!0,gridTemplateColumns:!0,gridTemplateRows:!0,gridTemplateAreas:!0,gridArea:!0};function xre(e,r,a,u){const p=typeof r=="string"?r.split("."):[r];for(u=0;u<p.length&&e;u+=1)e=e[p[u]];return e===void 0?a:e}const bre=e=>{const r=new WeakMap;return(u,p,y,x)=>{if(typeof u>"u")return e(u,p,y);r.has(u)||r.set(u,new Map);const i=r.get(u);if(i.has(p))return i.get(p);const C=e(u,p,y,x);return i.set(p,C),C}},wre=bre(xre),Sre={border:"0px",clip:"rect(0, 0, 0, 0)",width:"1px",height:"1px",margin:"-1px",padding:"0px",overflow:"hidden",whiteSpace:"nowrap",position:"absolute"},Tre={position:"static",width:"auto",height:"auto",clip:"auto",padding:"0",margin:"0",overflow:"visible",whiteSpace:"normal"},s2=(e,r,a)=>{const u={},p=wre(e,r,{});for(const y in p)y in a&&a[y]!=null||(u[y]=p[y]);return u},Ere={srOnly:{transform(e){return e===!0?Sre:e==="focusable"?Tre:{}}},layerStyle:{processResult:!0,transform:(e,r,a)=>s2(r,`layerStyles.${e}`,a)},textStyle:{processResult:!0,transform:(e,r,a)=>s2(r,`textStyles.${e}`,a)},apply:{processResult:!0,transform:(e,r,a)=>s2(r,e,a)}},M0={position:!0,pos:Tt.prop("position"),zIndex:Tt.prop("zIndex","zIndices"),inset:Tt.spaceT("inset"),insetX:Tt.spaceT(["left","right"]),insetInline:Tt.spaceT("insetInline"),insetY:Tt.spaceT(["top","bottom"]),insetBlock:Tt.spaceT("insetBlock"),top:Tt.spaceT("top"),insetBlockStart:Tt.spaceT("insetBlockStart"),bottom:Tt.spaceT("bottom"),insetBlockEnd:Tt.spaceT("insetBlockEnd"),left:Tt.spaceT("left"),insetInlineStart:Tt.logical({scale:"space",property:{ltr:"left",rtl:"right"}}),right:Tt.spaceT("right"),insetInlineEnd:Tt.logical({scale:"space",property:{ltr:"right",rtl:"left"}})};Object.assign(M0,{insetStart:M0.insetInlineStart,insetEnd:M0.insetInlineEnd});const xA={boxShadow:Tt.shadows("boxShadow"),mixBlendMode:!0,blendMode:Tt.prop("mixBlendMode"),backgroundBlendMode:!0,bgBlendMode:Tt.prop("backgroundBlendMode"),opacity:!0};Object.assign(xA,{shadow:xA.boxShadow});const Ss={margin:Tt.spaceT("margin"),marginTop:Tt.spaceT("marginTop"),marginBlockStart:Tt.spaceT("marginBlockStart"),marginRight:Tt.spaceT("marginRight"),marginInlineEnd:Tt.spaceT("marginInlineEnd"),marginBottom:Tt.spaceT("marginBottom"),marginBlockEnd:Tt.spaceT("marginBlockEnd"),marginLeft:Tt.spaceT("marginLeft"),marginInlineStart:Tt.spaceT("marginInlineStart"),marginX:Tt.spaceT(["marginInlineStart","marginInlineEnd"]),marginInline:Tt.spaceT("marginInline"),marginY:Tt.spaceT(["marginTop","marginBottom"]),marginBlock:Tt.spaceT("marginBlock"),padding:Tt.space("padding"),paddingTop:Tt.space("paddingTop"),paddingBlockStart:Tt.space("paddingBlockStart"),paddingRight:Tt.space("paddingRight"),paddingBottom:Tt.space("paddingBottom"),paddingBlockEnd:Tt.space("paddingBlockEnd"),paddingLeft:Tt.space("paddingLeft"),paddingInlineStart:Tt.space("paddingInlineStart"),paddingInlineEnd:Tt.space("paddingInlineEnd"),paddingX:Tt.space(["paddingInlineStart","paddingInlineEnd"]),paddingInline:Tt.space("paddingInline"),paddingY:Tt.space(["paddingTop","paddingBottom"]),paddingBlock:Tt.space("paddingBlock")};Object.assign(Ss,{m:Ss.margin,mt:Ss.marginTop,mr:Ss.marginRight,me:Ss.marginInlineEnd,marginEnd:Ss.marginInlineEnd,mb:Ss.marginBottom,ml:Ss.marginLeft,ms:Ss.marginInlineStart,marginStart:Ss.marginInlineStart,mx:Ss.marginX,my:Ss.marginY,p:Ss.padding,pt:Ss.paddingTop,py:Ss.paddingY,px:Ss.paddingX,pb:Ss.paddingBottom,pl:Ss.paddingLeft,ps:Ss.paddingInlineStart,paddingStart:Ss.paddingInlineStart,pr:Ss.paddingRight,pe:Ss.paddingInlineEnd,paddingEnd:Ss.paddingInlineEnd});const Pre={scrollBehavior:!0,scrollSnapAlign:!0,scrollSnapStop:!0,scrollSnapType:!0,scrollMargin:Tt.spaceT("scrollMargin"),scrollMarginTop:Tt.spaceT("scrollMarginTop"),scrollMarginBottom:Tt.spaceT("scrollMarginBottom"),scrollMarginLeft:Tt.spaceT("scrollMarginLeft"),scrollMarginRight:Tt.spaceT("scrollMarginRight"),scrollMarginX:Tt.spaceT(["scrollMarginLeft","scrollMarginRight"]),scrollMarginY:Tt.spaceT(["scrollMarginTop","scrollMarginBottom"]),scrollPadding:Tt.spaceT("scrollPadding"),scrollPaddingTop:Tt.spaceT("scrollPaddingTop"),scrollPaddingBottom:Tt.spaceT("scrollPaddingBottom"),scrollPaddingLeft:Tt.spaceT("scrollPaddingLeft"),scrollPaddingRight:Tt.spaceT("scrollPaddingRight"),scrollPaddingX:Tt.spaceT(["scrollPaddingLeft","scrollPaddingRight"]),scrollPaddingY:Tt.spaceT(["scrollPaddingTop","scrollPaddingBottom"])},Ire={fontFamily:Tt.prop("fontFamily","fonts"),fontSize:Tt.prop("fontSize","fontSizes",lo.px),fontWeight:Tt.prop("fontWeight","fontWeights"),lineHeight:Tt.prop("lineHeight","lineHeights"),letterSpacing:Tt.prop("letterSpacing","letterSpacings"),textAlign:!0,fontStyle:!0,textIndent:!0,wordBreak:!0,overflowWrap:!0,textOverflow:!0,textTransform:!0,whiteSpace:!0,isTruncated:{transform(e){if(e===!0)return{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}},noOfLines:{static:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:"var(--chakra-line-clamp)"},property:"--chakra-line-clamp"}},Mre={textDecorationColor:Tt.colors("textDecorationColor"),textDecoration:!0,textDecor:{property:"textDecoration"},textDecorationLine:!0,textDecorationStyle:!0,textDecorationThickness:!0,textUnderlineOffset:!0,textShadow:Tt.shadows("textShadow")},Cre={clipPath:!0,transform:Tt.propT("transform",lo.transform),transformOrigin:!0,translateX:Tt.spaceT("--chakra-translate-x"),translateY:Tt.spaceT("--chakra-translate-y"),skewX:Tt.degreeT("--chakra-skew-x"),skewY:Tt.degreeT("--chakra-skew-y"),scaleX:Tt.prop("--chakra-scale-x"),scaleY:Tt.prop("--chakra-scale-y"),scale:Tt.prop(["--chakra-scale-x","--chakra-scale-y"]),rotate:Tt.degreeT("--chakra-rotate")},Are={listStyleType:!0,listStylePosition:!0,listStylePos:Tt.prop("listStylePosition"),listStyleImage:!0,listStyleImg:Tt.prop("listStyleImage")},Dre={transition:!0,transitionDelay:!0,animation:!0,willChange:!0,transitionDuration:Tt.prop("transitionDuration","transition.duration"),transitionProperty:Tt.prop("transitionProperty","transition.property"),transitionTimingFunction:Tt.prop("transitionTimingFunction","transition.easing")},jD=Cf({},Z1,Mo,gre,bw,Pd,_re,yre,vre,n8,Ere,M0,xA,Ss,Pre,Ire,Mre,Cre,Are,Dre),Rre=Object.assign({},Ss,Pd,bw,n8,M0),Ore=Object.keys(Rre),Lre=[...Object.keys(jD),...t8],zre={...jD,...Kw},Fre=e=>e in zre,kre=e=>r=>{if(!r.__breakpoints)return e;const{isResponsive:a,toArrayValue:u,media:p}=r.__breakpoints,y={};for(const x in e){let i=Cd(e[x],r);if(i==null)continue;if(i=Rd(i)&&a(i)?u(i):i,!Array.isArray(i)){y[x]=i;continue}const C=i.slice(0,p.length).length;for(let R=0;R<C;R+=1){const z=p?.[R];if(!z){y[x]=i[R];continue}y[z]=y[z]||{},i[R]!=null&&(y[z][x]=i[R])}}return y};function Bre(e){const r=[];let a="",u=!1;for(let p=0;p<e.length;p++){const y=e[p];y==="("?(u=!0,a+=y):y===")"?(u=!1,a+=y):y===","&&!u?(r.push(a),a=""):a+=y}return a=a.trim(),a&&r.push(a),r}function jre(e){return/^var\(--.+\)$/.test(e)}const Nre=(e,r)=>e.startsWith("--")&&typeof r=="string"&&!jre(r),Vre=(e,r)=>{if(r==null)return r;const a=x=>e.__cssMap?.[x]?.varRef,u=x=>a(x)??x,[p,y]=Bre(r);return r=a(p)??u(y)??u(r),r};function Ure(e){const{configs:r={},pseudos:a={},theme:u}=e,p=(y,x=!1)=>{const i=Cd(y,u),C=kre(i)(u);let R={};for(let z in C){const F=C[z];let V=Cd(F,u);z in a&&(z=a[z]),Nre(z,V)&&(V=Vre(u,V));let G=r[z];if(G===!0&&(G={property:z}),Rd(V)){R[z]=R[z]??{},R[z]=Cf({},R[z],p(V,!0));continue}let H=G?.transform?.(V,u,i)??V;H=G?.processResult?p(H,!0):H;const Z=Cd(G?.property,u);if(!x&&G?.static){const J=Cd(G.static,u);R=Cf({},R,J)}if(Z&&Array.isArray(Z)){for(const J of Z)R[J]=H;continue}if(Z){Z==="&"&&Rd(H)?R=Cf({},R,H):R[Z]=H;continue}if(Rd(H)){R=Cf({},R,H);continue}R[z]=H}return R};return p}const i8=e=>r=>Ure({theme:r,pseudos:Kw,configs:jD})(e);function us(e){return{definePartsStyle(r){return r},defineMultiStyleConfig(r){return{parts:e,...r}}}}function $re(e,r){if(Array.isArray(e))return e;if(Rd(e))return r(e);if(e!=null)return[e]}function Wre(e,r){for(let a=r+1;a<e.length;a++)if(e[a]!=null)return a;return-1}function qre(e){const r=e.__breakpoints;return function(u,p,y,x){if(!r)return;const i={},C=$re(y,r.toArrayValue);if(!C)return i;const R=C.length,z=R===1,F=!!u.parts;for(let V=0;V<R;V++){const G=r.details[V],H=r.details[Wre(C,V)],Z=p0(G.minW,H?._minW),J=Cd(u[p]?.[C[V]],x);if(J){if(F){u.parts?.forEach(se=>{Cf(i,{[se]:z?J[se]:{[Z]:J[se]}})});continue}if(!F){z?Cf(i,J):i[Z]=J;continue}i[Z]=J}}return i}}function Gre(e){return r=>{const{variant:a,size:u,theme:p}=r,y=qre(p);return Cf({},Cd(e.baseStyle??{},r),y(e,"sizes",u,r),y(e,"variants",a,r))}}function Il(e){return QW(e,["styleConfig","size","variant","colorScheme"])}function o8(e){return Rd(e)&&e.reference?e.reference:String(e)}const Qw=(e,...r)=>r.map(o8).join(` ${e} `).replace(/calc/g,""),C3=(...e)=>`calc(${Qw("+",...e)})`,A3=(...e)=>`calc(${Qw("-",...e)})`,bA=(...e)=>`calc(${Qw("*",...e)})`,D3=(...e)=>`calc(${Qw("/",...e)})`,R3=e=>{const r=o8(e);return r!=null&&!Number.isNaN(parseFloat(r))?String(r).startsWith("-")?String(r).slice(1):`-${r}`:bA(r,-1)},Tp=Object.assign(e=>({add:(...r)=>Tp(C3(e,...r)),subtract:(...r)=>Tp(A3(e,...r)),multiply:(...r)=>Tp(bA(e,...r)),divide:(...r)=>Tp(D3(e,...r)),negate:()=>Tp(R3(e)),toString:()=>e.toString()}),{add:C3,subtract:A3,multiply:bA,divide:D3,negate:R3});function Hre(e,r="-"){return e.replace(/\s+/g,r)}function Yre(e){const r=Hre(e.toString());return Xre(Zre(r))}function Zre(e){return e.includes("\\.")?e:!Number.isInteger(parseFloat(e.toString()))?e.replace(".","\\."):e}function Xre(e){return e.replace(/[!-,/:-@[-^`{-~]/g,"\\$&")}function Kre(e,r=""){return[r,e].filter(Boolean).join("-")}function Qre(e,r){return`var(${e}${r?`, ${r}`:""})`}function Jre(e,r=""){return Yre(`--${Kre(e,r)}`)}function Zn(e,r,a){const u=Jre(e,a);return{variable:u,reference:Qre(u,r)}}function ene(e,r){const a={};for(const u of r){if(Array.isArray(u)){const[p,y]=u;a[p]=Zn(`${e}-${p}`,y);continue}a[u]=Zn(`${e}-${u}`)}return a}const tne=["colors","borders","borderWidths","borderStyles","fonts","fontSizes","fontWeights","gradients","letterSpacings","lineHeights","radii","space","shadows","sizes","zIndices","transition","blur","breakpoints"];function rne(e){return Wte(e,tne)}function nne(e){return e.semanticTokens}function ine(e){const{__cssMap:r,__cssVars:a,__breakpoints:u,...p}=e;return p}function one(e){const r=rne(e),a=nne(e),u=y=>t8.includes(y)||y==="default",p={};return E3(r,(y,x)=>{y!=null&&(p[x.join(".")]={isSemantic:!1,value:y})}),E3(a,(y,x)=>{y!=null&&(p[x.join(".")]={isSemantic:!0,value:y})},{stop:y=>Object.keys(y).every(u)}),p}function O3(e,r){return Zn(String(e).replace(/\./g,"-"),void 0,r)}function sne(e){const r=one(e),a=e.config?.cssVarPrefix;let u={};const p={};function y(x,i){const R=[String(x).split(".")[0],i].join(".");if(!r[R])return i;const{reference:F}=O3(R,a);return F}for(const[x,i]of Object.entries(r)){const{isSemantic:C,value:R}=i,{variable:z,reference:F}=O3(x,a);if(!C){if(x.startsWith("space")){const G=x.split("."),[H,...Z]=G,J=`${H}.-${Z.join(".")}`,se=Tp.negate(R),pe=Tp.negate(F);p[J]={value:se,var:z,varRef:pe}}u[z]=R,p[x]={value:R,var:z,varRef:F};continue}const V=Rd(R)?R:{default:R};u=Cf(u,Object.entries(V).reduce((G,[H,Z])=>{if(!Z)return G;const J=y(x,`${Z}`);if(H==="default")return G[z]=J,G;const se=Kw?.[H]??H;return G[se]={[z]:J},G},{})),p[x]={value:F,var:z,varRef:F}}return{cssVars:u,cssMap:p}}function ane(e){const r=ine(e),{cssMap:a,cssVars:u}=sne(r);return Object.assign(r,{__cssVars:{...{"--chakra-ring-inset":"var(--chakra-empty,/*!*/ /*!*/)","--chakra-ring-offset-width":"0px","--chakra-ring-offset-color":"#fff","--chakra-ring-color":"rgba(66, 153, 225, 0.6)","--chakra-ring-offset-shadow":"0 0 #0000","--chakra-ring-shadow":"0 0 #0000","--chakra-space-x-reverse":"0","--chakra-space-y-reverse":"0"},...u},__cssMap:a,__breakpoints:Ote(r.breakpoints)}),r}function Ro(e,r={}){let a=!1;function u(){if(!a){a=!0;return}throw new Error("[anatomy] .part(...) should only be called once. Did you mean to use .extend(...) ?")}function p(...z){u();for(const F of z)r[F]=C(F);return Ro(e,r)}function y(...z){for(const F of z)F in r||(r[F]=C(F));return Ro(e,r)}function x(){return Object.fromEntries(Object.entries(r).map(([F,V])=>[F,V.selector]))}function i(){return Object.fromEntries(Object.entries(r).map(([F,V])=>[F,V.className]))}function C(z){const G=`chakra-${(["container","root"].includes(z??"")?[e]:[e,z]).filter(Boolean).join("__")}`;return{className:G,selector:`.${G}`,toString:()=>z}}return{parts:p,toPart:C,extend:y,selectors:x,classnames:i,get keys(){return Object.keys(r)},__type:{}}}const lne=Ro("accordion").parts("root","container","button","panel","icon"),cne=Ro("alert").parts("title","description","container","icon","spinner"),une=Ro("avatar").parts("label","badge","container","excessLabel","group"),dne=Ro("breadcrumb").parts("link","item","container","separator");Ro("button").parts();const hne=Ro("checkbox").parts("control","icon","container","label");Ro("progress").parts("track","filledTrack","label");const fne=Ro("drawer").parts("overlay","dialogContainer","dialog","header","closeButton","body","footer"),pne=Ro("editable").parts("preview","input","textarea"),mne=Ro("form").parts("container","requiredIndicator","helperText"),gne=Ro("formError").parts("text","icon"),_ne=Ro("input").parts("addon","field","element","group"),yne=Ro("list").parts("container","item","icon"),vne=Ro("menu").parts("button","list","item","groupTitle","icon","command","divider"),xne=Ro("modal").parts("overlay","dialogContainer","dialog","header","closeButton","body","footer"),bne=Ro("numberinput").parts("root","field","stepperGroup","stepper");Ro("pininput").parts("field");const wne=Ro("popover").parts("content","header","body","footer","popper","arrow","closeButton"),Sne=Ro("progress").parts("label","filledTrack","track"),Tne=Ro("radio").parts("container","control","label"),Ene=Ro("select").parts("field","icon"),Pne=Ro("slider").parts("container","track","thumb","filledTrack","mark"),Ine=Ro("stat").parts("container","label","helpText","number","icon"),Mne=Ro("switch").parts("container","track","thumb","label"),Cne=Ro("table").parts("table","thead","tbody","tr","th","td","tfoot","caption"),Ane=Ro("tabs").parts("root","tab","tablist","tabpanel","tabpanels","indicator"),Dne=Ro("tag").parts("container","label","closeButton"),Rne=Ro("card").parts("container","header","body","footer");Ro("stepper").parts("stepper","step","title","description","indicator","separator","icon","number");const{definePartsStyle:One,defineMultiStyleConfig:Lne}=us(lne.keys),zne={borderTopWidth:"1px",borderColor:"inherit",_last:{borderBottomWidth:"1px"}},Fne={transitionProperty:"common",transitionDuration:"normal",fontSize:"md",_focusVisible:{boxShadow:"outline"},_hover:{bg:"blackAlpha.50"},_disabled:{opacity:.4,cursor:"not-allowed"},px:"4",py:"2"},kne={pt:"2",px:"4",pb:"5"},Bne={fontSize:"1.25em"},jne=One({container:zne,button:Fne,panel:kne,icon:Bne}),Nne=Lne({baseStyle:jne});function $g(e,r,a){return Math.min(Math.max(e,a),r)}class Vne extends Error{constructor(r){super(`Failed to parse color: "${r}"`)}}var g0=Vne;function ND(e){if(typeof e!="string")throw new g0(e);if(e.trim().toLowerCase()==="transparent")return[0,0,0,0];let r=e.trim();r=Zne.test(e)?Wne(e):e;const a=qne.exec(r);if(a){const x=Array.from(a).slice(1);return[...x.slice(0,3).map(i=>parseInt(G0(i,2),16)),parseInt(G0(x[3]||"f",2),16)/255]}const u=Gne.exec(r);if(u){const x=Array.from(u).slice(1);return[...x.slice(0,3).map(i=>parseInt(i,16)),parseInt(x[3]||"ff",16)/255]}const p=Hne.exec(r);if(p){const x=Array.from(p).slice(1);return[...x.slice(0,3).map(i=>parseInt(i,10)),parseFloat(x[3]||"1")]}const y=Yne.exec(r);if(y){const[x,i,C,R]=Array.from(y).slice(1).map(parseFloat);if($g(0,100,i)!==i)throw new g0(e);if($g(0,100,C)!==C)throw new g0(e);return[...Xne(x,i,C),Number.isNaN(R)?1:R]}throw new g0(e)}function Une(e){let r=5381,a=e.length;for(;a;)r=r*33^e.charCodeAt(--a);return(r>>>0)%2341}const L3=e=>parseInt(e.replace(/_/g,""),36),$ne="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((e,r)=>{const a=L3(r.substring(0,3)),u=L3(r.substring(3)).toString(16);let p="";for(let y=0;y<6-u.length;y++)p+="0";return e[a]=`${p}${u}`,e},{});function Wne(e){const r=e.toLowerCase().trim(),a=$ne[Une(r)];if(!a)throw new g0(e);return`#${a}`}const G0=(e,r)=>Array.from(Array(r)).map(()=>e).join(""),qne=new RegExp(`^#${G0("([a-f0-9])",3)}([a-f0-9])?$`,"i"),Gne=new RegExp(`^#${G0("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),Hne=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${G0(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),Yne=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,Zne=/^[a-z]+$/i,z3=e=>Math.round(e*255),Xne=(e,r,a)=>{let u=a/100;if(r===0)return[u,u,u].map(z3);const p=(e%360+360)%360/60,y=(1-Math.abs(2*u-1))*(r/100),x=y*(1-Math.abs(p%2-1));let i=0,C=0,R=0;p>=0&&p<1?(i=y,C=x):p>=1&&p<2?(i=x,C=y):p>=2&&p<3?(C=y,R=x):p>=3&&p<4?(C=x,R=y):p>=4&&p<5?(i=x,R=y):p>=5&&p<6&&(i=y,R=x);const z=u-y/2,F=i+z,V=C+z,G=R+z;return[F,V,G].map(z3)};function Kne(e,r,a,u){return`rgba(${$g(0,255,e).toFixed()}, ${$g(0,255,r).toFixed()}, ${$g(0,255,a).toFixed()}, ${parseFloat($g(0,1,u).toFixed(3))})`}function Qne(e,r){const[a,u,p,y]=ND(e);return Kne(a,u,p,y-r)}function Jne(e){const[r,a,u,p]=ND(e);let y=x=>{const i=$g(0,255,x).toString(16);return i.length===1?`0${i}`:i};return`#${y(r)}${y(a)}${y(u)}${p<1?y(Math.round(p*255)):""}`}const eie=e=>Object.keys(e).length===0;function tie(e,r,a,u,p){for(r=r.split?r.split("."):r,u=0;u<r.length;u++)e=e?e[r[u]]:p;return e===p?a:e}const Kc=(e,r,a)=>{const u=tie(e,`colors.${r}`,r);try{return Jne(u),u}catch{return a??"#000000"}},rie=e=>{const[r,a,u]=ND(e);return(r*299+a*587+u*114)/1e3},nie=e=>r=>{const a=Kc(r,e);return rie(a)<128?"dark":"light"},iie=e=>r=>nie(e)(r)==="dark",Oy=(e,r)=>a=>{const u=Kc(a,e);return Qne(u,1-r)};function F3(e="1rem",r="rgba(255, 255, 255, 0.15)"){return{backgroundImage:`linear-gradient(
    45deg,
    ${r} 25%,
    transparent 25%,
    transparent 50%,
    ${r} 50%,
    ${r} 75%,
    transparent 75%,
    transparent
  )`,backgroundSize:`${e} ${e}`}}const oie=()=>`#${Math.floor(Math.random()*16777215).toString(16).padEnd(6,"0")}`;function sie(e){const r=oie();return!e||eie(e)?r:e.string&&e.colors?lie(e.string,e.colors):e.string&&!e.colors?aie(e.string):e.colors&&!e.string?cie(e.colors):r}function aie(e){let r=0;if(e.length===0)return r.toString();for(let u=0;u<e.length;u+=1)r=e.charCodeAt(u)+((r<<5)-r),r=r&r;let a="#";for(let u=0;u<3;u+=1){const p=r>>u*8&255;a+=`00${p.toString(16)}`.substr(-2)}return a}function lie(e,r){let a=0;if(e.length===0)return r[0];for(let u=0;u<e.length;u+=1)a=e.charCodeAt(u)+((a<<5)-a),a=a&a;return a=(a%r.length+r.length)%r.length,r[a]}function cie(e){return e[Math.floor(Math.random()*e.length)]}function Yn(e,r){return a=>a.colorMode==="dark"?r:e}function VD(e){const{orientation:r,vertical:a,horizontal:u}=e;return r?r==="vertical"?a:u:{}}function s8(e){return Rd(e)&&e.reference?e.reference:String(e)}const Jw=(e,...r)=>r.map(s8).join(` ${e} `).replace(/calc/g,""),k3=(...e)=>`calc(${Jw("+",...e)})`,B3=(...e)=>`calc(${Jw("-",...e)})`,wA=(...e)=>`calc(${Jw("*",...e)})`,j3=(...e)=>`calc(${Jw("/",...e)})`,N3=e=>{const r=s8(e);return r!=null&&!Number.isNaN(parseFloat(r))?String(r).startsWith("-")?String(r).slice(1):`-${r}`:wA(r,-1)},Ep=Object.assign(e=>({add:(...r)=>Ep(k3(e,...r)),subtract:(...r)=>Ep(B3(e,...r)),multiply:(...r)=>Ep(wA(e,...r)),divide:(...r)=>Ep(j3(e,...r)),negate:()=>Ep(N3(e)),toString:()=>e.toString()}),{add:k3,subtract:B3,multiply:wA,divide:j3,negate:N3});function uie(e){return!Number.isInteger(parseFloat(e.toString()))}function die(e,r="-"){return e.replace(/\s+/g,r)}function a8(e){const r=die(e.toString());return r.includes("\\.")?e:uie(e)?r.replace(".","\\."):e}function hie(e,r=""){return[r,a8(e)].filter(Boolean).join("-")}function fie(e,r){return`var(${a8(e)}${r?`, ${r}`:""})`}function pie(e,r=""){return`--${hie(e,r)}`}function al(e,r){const a=pie(e,r?.prefix);return{variable:a,reference:fie(a,mie(r?.fallback))}}function mie(e){return e?.reference}const{definePartsStyle:xx,defineMultiStyleConfig:gie}=us(cne.keys),Qu=Zn("alert-fg"),Dp=Zn("alert-bg"),_ie=xx({container:{bg:Dp.reference,px:"4",py:"3"},title:{fontWeight:"bold",lineHeight:"6",marginEnd:"2"},description:{lineHeight:"6"},icon:{color:Qu.reference,flexShrink:0,marginEnd:"3",w:"5",h:"6"},spinner:{color:Qu.reference,flexShrink:0,marginEnd:"3",w:"5",h:"5"}});function UD(e){const{theme:r,colorScheme:a}=e,u=Oy(`${a}.200`,.16)(r);return{light:`colors.${a}.100`,dark:u}}const yie=xx(e=>{const{colorScheme:r}=e,a=UD(e);return{container:{[Qu.variable]:`colors.${r}.600`,[Dp.variable]:a.light,_dark:{[Qu.variable]:`colors.${r}.200`,[Dp.variable]:a.dark}}}}),vie=xx(e=>{const{colorScheme:r}=e,a=UD(e);return{container:{[Qu.variable]:`colors.${r}.600`,[Dp.variable]:a.light,_dark:{[Qu.variable]:`colors.${r}.200`,[Dp.variable]:a.dark},paddingStart:"3",borderStartWidth:"4px",borderStartColor:Qu.reference}}}),xie=xx(e=>{const{colorScheme:r}=e,a=UD(e);return{container:{[Qu.variable]:`colors.${r}.600`,[Dp.variable]:a.light,_dark:{[Qu.variable]:`colors.${r}.200`,[Dp.variable]:a.dark},pt:"2",borderTopWidth:"4px",borderTopColor:Qu.reference}}}),bie=xx(e=>{const{colorScheme:r}=e;return{container:{[Qu.variable]:"colors.white",[Dp.variable]:`colors.${r}.600`,_dark:{[Qu.variable]:"colors.gray.900",[Dp.variable]:`colors.${r}.200`},color:Qu.reference}}}),wie={subtle:yie,"left-accent":vie,"top-accent":xie,solid:bie},Sie=gie({baseStyle:_ie,variants:wie,defaultProps:{variant:"subtle",colorScheme:"blue"}}),l8={px:"1px",.5:"0.125rem",1:"0.25rem",1.5:"0.375rem",2:"0.5rem",2.5:"0.625rem",3:"0.75rem",3.5:"0.875rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem",12:"3rem",14:"3.5rem",16:"4rem",20:"5rem",24:"6rem",28:"7rem",32:"8rem",36:"9rem",40:"10rem",44:"11rem",48:"12rem",52:"13rem",56:"14rem",60:"15rem",64:"16rem",72:"18rem",80:"20rem",96:"24rem"},Tie={max:"max-content",min:"min-content",full:"100%","3xs":"14rem","2xs":"16rem",xs:"20rem",sm:"24rem",md:"28rem",lg:"32rem",xl:"36rem","2xl":"42rem","3xl":"48rem","4xl":"56rem","5xl":"64rem","6xl":"72rem","7xl":"80rem","8xl":"90rem",prose:"60ch"},Eie={sm:"640px",md:"768px",lg:"1024px",xl:"1280px"},c8={...l8,...Tie,container:Eie},Pie=e=>typeof e=="function";function Jc(e,...r){return Pie(e)?e(...r):e}const{definePartsStyle:u8,defineMultiStyleConfig:Iie}=us(une.keys),Sy=Zn("avatar-border-color"),C0=Zn("avatar-bg"),H0=Zn("avatar-font-size"),Ly=Zn("avatar-size"),Mie={borderRadius:"full",border:"0.2em solid",borderColor:Sy.reference,[Sy.variable]:"white",_dark:{[Sy.variable]:"colors.gray.800"}},Cie={bg:C0.reference,fontSize:H0.reference,width:Ly.reference,height:Ly.reference,lineHeight:"1",[C0.variable]:"colors.gray.200",_dark:{[C0.variable]:"colors.whiteAlpha.400"}},Aie=e=>{const{name:r,theme:a}=e,u=r?sie({string:r}):"colors.gray.400",p=iie(u)(a);let y="white";return p||(y="gray.800"),{bg:C0.reference,fontSize:H0.reference,color:y,borderColor:Sy.reference,verticalAlign:"top",width:Ly.reference,height:Ly.reference,"&:not([data-loaded])":{[C0.variable]:u},[Sy.variable]:"colors.white",_dark:{[Sy.variable]:"colors.gray.800"}}},Die={fontSize:H0.reference,lineHeight:"1"},Rie=u8(e=>({badge:Jc(Mie,e),excessLabel:Jc(Cie,e),container:Jc(Aie,e),label:Die}));function Cm(e){const r=e!=="100%"?c8[e]:void 0;return u8({container:{[Ly.variable]:r??e,[H0.variable]:`calc(${r??e} / 2.5)`},excessLabel:{[Ly.variable]:r??e,[H0.variable]:`calc(${r??e} / 2.5)`}})}const Oie={"2xs":Cm(4),xs:Cm(6),sm:Cm(8),md:Cm(12),lg:Cm(16),xl:Cm(24),"2xl":Cm(32),full:Cm("100%")},Lie=Iie({baseStyle:Rie,sizes:Oie,defaultProps:{size:"md"}}),Da=ene("badge",["bg","color","shadow"]),zie={px:1,textTransform:"uppercase",fontSize:"xs",borderRadius:"sm",fontWeight:"bold",bg:Da.bg.reference,color:Da.color.reference,boxShadow:Da.shadow.reference},Fie=e=>{const{colorScheme:r,theme:a}=e,u=Oy(`${r}.500`,.6)(a);return{[Da.bg.variable]:`colors.${r}.500`,[Da.color.variable]:"colors.white",_dark:{[Da.bg.variable]:u,[Da.color.variable]:"colors.whiteAlpha.800"}}},kie=e=>{const{colorScheme:r,theme:a}=e,u=Oy(`${r}.200`,.16)(a);return{[Da.bg.variable]:`colors.${r}.100`,[Da.color.variable]:`colors.${r}.800`,_dark:{[Da.bg.variable]:u,[Da.color.variable]:`colors.${r}.200`}}},Bie=e=>{const{colorScheme:r,theme:a}=e,u=Oy(`${r}.200`,.8)(a);return{[Da.color.variable]:`colors.${r}.500`,_dark:{[Da.color.variable]:u},[Da.shadow.variable]:`inset 0 0 0px 1px ${Da.color.reference}`}},jie={solid:Fie,subtle:kie,outline:Bie},A0={baseStyle:zie,variants:jie,defaultProps:{variant:"subtle",colorScheme:"gray"}},{defineMultiStyleConfig:Nie,definePartsStyle:Vie}=us(dne.keys),a2=Zn("breadcrumb-link-decor"),Uie={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",outline:"none",color:"inherit",textDecoration:a2.reference,[a2.variable]:"none","&:not([aria-current=page])":{cursor:"pointer",_hover:{[a2.variable]:"underline"},_focusVisible:{boxShadow:"outline"}}},$ie=Vie({link:Uie}),Wie=Nie({baseStyle:$ie}),qie={lineHeight:"1.2",borderRadius:"md",fontWeight:"semibold",transitionProperty:"common",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{_disabled:{bg:"initial"}}},d8=e=>{const{colorScheme:r,theme:a}=e;if(r==="gray")return{color:Yn("gray.800","whiteAlpha.900")(e),_hover:{bg:Yn("gray.100","whiteAlpha.200")(e)},_active:{bg:Yn("gray.200","whiteAlpha.300")(e)}};const u=Oy(`${r}.200`,.12)(a),p=Oy(`${r}.200`,.24)(a);return{color:Yn(`${r}.600`,`${r}.200`)(e),bg:"transparent",_hover:{bg:Yn(`${r}.50`,u)(e)},_active:{bg:Yn(`${r}.100`,p)(e)}}},Gie=e=>{const{colorScheme:r}=e,a=Yn("gray.200","whiteAlpha.300")(e);return{border:"1px solid",borderColor:r==="gray"?a:"currentColor",".chakra-button__group[data-attached][data-orientation=horizontal] > &:not(:last-of-type)":{marginEnd:"-1px"},".chakra-button__group[data-attached][data-orientation=vertical] > &:not(:last-of-type)":{marginBottom:"-1px"},...Jc(d8,e)}},Hie={yellow:{bg:"yellow.400",color:"black",hoverBg:"yellow.500",activeBg:"yellow.600"},cyan:{bg:"cyan.400",color:"black",hoverBg:"cyan.500",activeBg:"cyan.600"}},Yie=e=>{const{colorScheme:r}=e;if(r==="gray"){const i=Yn("gray.100","whiteAlpha.200")(e);return{bg:i,color:Yn("gray.800","whiteAlpha.900")(e),_hover:{bg:Yn("gray.200","whiteAlpha.300")(e),_disabled:{bg:i}},_active:{bg:Yn("gray.300","whiteAlpha.400")(e)}}}const{bg:a=`${r}.500`,color:u="white",hoverBg:p=`${r}.600`,activeBg:y=`${r}.700`}=Hie[r]??{},x=Yn(a,`${r}.200`)(e);return{bg:x,color:Yn(u,"gray.800")(e),_hover:{bg:Yn(p,`${r}.300`)(e),_disabled:{bg:x}},_active:{bg:Yn(y,`${r}.400`)(e)}}},Zie=e=>{const{colorScheme:r}=e;return{padding:0,height:"auto",lineHeight:"normal",verticalAlign:"baseline",color:Yn(`${r}.500`,`${r}.200`)(e),_hover:{textDecoration:"underline",_disabled:{textDecoration:"none"}},_active:{color:Yn(`${r}.700`,`${r}.500`)(e)}}},Xie={bg:"none",color:"inherit",display:"inline",lineHeight:"inherit",m:"0",p:"0"},Kie={ghost:d8,outline:Gie,solid:Yie,link:Zie,unstyled:Xie},Qie={lg:{h:"12",minW:"12",fontSize:"lg",px:"6"},md:{h:"10",minW:"10",fontSize:"md",px:"4"},sm:{h:"8",minW:"8",fontSize:"sm",px:"3"},xs:{h:"6",minW:"6",fontSize:"xs",px:"2"}},Jie={baseStyle:qie,variants:Kie,sizes:Qie,defaultProps:{variant:"solid",size:"md",colorScheme:"gray"}},{definePartsStyle:Yg,defineMultiStyleConfig:eoe}=us(Rne.keys),ww=Zn("card-bg"),Mp=Zn("card-padding"),h8=Zn("card-shadow"),X1=Zn("card-radius"),f8=Zn("card-border-width","0"),p8=Zn("card-border-color"),toe=Yg({container:{[ww.variable]:"colors.chakra-body-bg",backgroundColor:ww.reference,boxShadow:h8.reference,borderRadius:X1.reference,color:"chakra-body-text",borderWidth:f8.reference,borderColor:p8.reference},body:{padding:Mp.reference,flex:"1 1 0%"},header:{padding:Mp.reference},footer:{padding:Mp.reference}}),roe={sm:Yg({container:{[X1.variable]:"radii.base",[Mp.variable]:"space.3"}}),md:Yg({container:{[X1.variable]:"radii.md",[Mp.variable]:"space.5"}}),lg:Yg({container:{[X1.variable]:"radii.xl",[Mp.variable]:"space.7"}})},noe={elevated:Yg({container:{[h8.variable]:"shadows.base",_dark:{[ww.variable]:"colors.gray.700"}}}),outline:Yg({container:{[f8.variable]:"1px",[p8.variable]:"colors.chakra-border-color"}}),filled:Yg({container:{[ww.variable]:"colors.chakra-subtle-bg"}}),unstyled:{body:{[Mp.variable]:0},header:{[Mp.variable]:0},footer:{[Mp.variable]:0}}},ioe=eoe({baseStyle:toe,variants:noe,sizes:roe,defaultProps:{variant:"elevated",size:"md"}}),{definePartsStyle:K1,defineMultiStyleConfig:ooe}=us(hne.keys),D0=Zn("checkbox-size"),soe=e=>{const{colorScheme:r}=e;return{w:D0.reference,h:D0.reference,transitionProperty:"box-shadow",transitionDuration:"normal",border:"2px solid",borderRadius:"sm",borderColor:"inherit",color:"white",_checked:{bg:Yn(`${r}.500`,`${r}.200`)(e),borderColor:Yn(`${r}.500`,`${r}.200`)(e),color:Yn("white","gray.900")(e),_hover:{bg:Yn(`${r}.600`,`${r}.300`)(e),borderColor:Yn(`${r}.600`,`${r}.300`)(e)},_disabled:{borderColor:Yn("gray.200","transparent")(e),bg:Yn("gray.200","whiteAlpha.300")(e),color:Yn("gray.500","whiteAlpha.500")(e)}},_indeterminate:{bg:Yn(`${r}.500`,`${r}.200`)(e),borderColor:Yn(`${r}.500`,`${r}.200`)(e),color:Yn("white","gray.900")(e)},_disabled:{bg:Yn("gray.100","whiteAlpha.100")(e),borderColor:Yn("gray.100","transparent")(e)},_focusVisible:{boxShadow:"outline"},_invalid:{borderColor:Yn("red.500","red.300")(e)}}},aoe={_disabled:{cursor:"not-allowed"}},loe={userSelect:"none",_disabled:{opacity:.4}},coe={transitionProperty:"transform",transitionDuration:"normal"},uoe=K1(e=>({icon:coe,container:aoe,control:Jc(soe,e),label:loe})),doe={sm:K1({control:{[D0.variable]:"sizes.3"},label:{fontSize:"sm"},icon:{fontSize:"3xs"}}),md:K1({control:{[D0.variable]:"sizes.4"},label:{fontSize:"md"},icon:{fontSize:"2xs"}}),lg:K1({control:{[D0.variable]:"sizes.5"},label:{fontSize:"lg"},icon:{fontSize:"2xs"}})},Sw=ooe({baseStyle:uoe,sizes:doe,defaultProps:{size:"md",colorScheme:"blue"}}),R0=al("close-button-size"),Kv=al("close-button-bg"),hoe={w:[R0.reference],h:[R0.reference],borderRadius:"md",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed",boxShadow:"none"},_hover:{[Kv.variable]:"colors.blackAlpha.100",_dark:{[Kv.variable]:"colors.whiteAlpha.100"}},_active:{[Kv.variable]:"colors.blackAlpha.200",_dark:{[Kv.variable]:"colors.whiteAlpha.200"}},_focusVisible:{boxShadow:"outline"},bg:Kv.reference},foe={lg:{[R0.variable]:"sizes.10",fontSize:"md"},md:{[R0.variable]:"sizes.8",fontSize:"xs"},sm:{[R0.variable]:"sizes.6",fontSize:"2xs"}},poe={baseStyle:hoe,sizes:foe,defaultProps:{size:"md"}},{variants:moe,defaultProps:goe}=A0,_oe={fontFamily:"mono",fontSize:"sm",px:"0.2em",borderRadius:"sm",bg:Da.bg.reference,color:Da.color.reference,boxShadow:Da.shadow.reference},yoe={baseStyle:_oe,variants:moe,defaultProps:goe},voe={w:"100%",mx:"auto",maxW:"prose",px:"4"},xoe={baseStyle:voe},boe={opacity:.6,borderColor:"inherit"},woe={borderStyle:"solid"},Soe={borderStyle:"dashed"},Toe={solid:woe,dashed:Soe},Eoe={baseStyle:boe,variants:Toe,defaultProps:{variant:"solid"}},{definePartsStyle:SA,defineMultiStyleConfig:Poe}=us(fne.keys),l2=Zn("drawer-bg"),c2=Zn("drawer-box-shadow");function J_(e){return SA(e==="full"?{dialog:{maxW:"100vw",h:"100vh"}}:{dialog:{maxW:e}})}const Ioe={bg:"blackAlpha.600",zIndex:"modal"},Moe={display:"flex",zIndex:"modal",justifyContent:"center"},Coe=e=>{const{isFullHeight:r}=e;return{...r&&{height:"100vh"},zIndex:"modal",maxH:"100vh",color:"inherit",[l2.variable]:"colors.white",[c2.variable]:"shadows.lg",_dark:{[l2.variable]:"colors.gray.700",[c2.variable]:"shadows.dark-lg"},bg:l2.reference,boxShadow:c2.reference}},Aoe={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},Doe={position:"absolute",top:"2",insetEnd:"3"},Roe={px:"6",py:"2",flex:"1",overflow:"auto"},Ooe={px:"6",py:"4"},Loe=SA(e=>({overlay:Ioe,dialogContainer:Moe,dialog:Jc(Coe,e),header:Aoe,closeButton:Doe,body:Roe,footer:Ooe})),zoe={xs:J_("xs"),sm:J_("md"),md:J_("lg"),lg:J_("2xl"),xl:J_("4xl"),full:J_("full")},Foe=Poe({baseStyle:Loe,sizes:zoe,defaultProps:{size:"xs"}}),{definePartsStyle:koe,defineMultiStyleConfig:Boe}=us(pne.keys),joe={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal"},Noe={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},Voe={borderRadius:"md",py:"1",transitionProperty:"common",transitionDuration:"normal",width:"full",_focusVisible:{boxShadow:"outline"},_placeholder:{opacity:.6}},Uoe=koe({preview:joe,input:Noe,textarea:Voe}),$oe=Boe({baseStyle:Uoe}),{definePartsStyle:Woe,defineMultiStyleConfig:qoe}=us(mne.keys),Ty=Zn("form-control-color"),Goe={marginStart:"1",[Ty.variable]:"colors.red.500",_dark:{[Ty.variable]:"colors.red.300"},color:Ty.reference},Hoe={mt:"2",[Ty.variable]:"colors.gray.600",_dark:{[Ty.variable]:"colors.whiteAlpha.600"},color:Ty.reference,lineHeight:"normal",fontSize:"sm"},Yoe=Woe({container:{width:"100%",position:"relative"},requiredIndicator:Goe,helperText:Hoe}),Zoe=qoe({baseStyle:Yoe}),{definePartsStyle:Xoe,defineMultiStyleConfig:Koe}=us(gne.keys),Ey=Zn("form-error-color"),Qoe={[Ey.variable]:"colors.red.500",_dark:{[Ey.variable]:"colors.red.300"},color:Ey.reference,mt:"2",fontSize:"sm",lineHeight:"normal"},Joe={marginEnd:"0.5em",[Ey.variable]:"colors.red.500",_dark:{[Ey.variable]:"colors.red.300"},color:Ey.reference},ese=Xoe({text:Qoe,icon:Joe}),tse=Koe({baseStyle:ese}),rse={fontSize:"md",marginEnd:"3",mb:"2",fontWeight:"medium",transitionProperty:"common",transitionDuration:"normal",opacity:1,_disabled:{opacity:.4}},nse={baseStyle:rse},ise={fontFamily:"heading",fontWeight:"bold"},ose={"4xl":{fontSize:["6xl",null,"7xl"],lineHeight:1},"3xl":{fontSize:["5xl",null,"6xl"],lineHeight:1},"2xl":{fontSize:["4xl",null,"5xl"],lineHeight:[1.2,null,1]},xl:{fontSize:["3xl",null,"4xl"],lineHeight:[1.33,null,1.2]},lg:{fontSize:["2xl",null,"3xl"],lineHeight:[1.33,null,1.2]},md:{fontSize:"xl",lineHeight:1.2},sm:{fontSize:"md",lineHeight:1.2},xs:{fontSize:"sm",lineHeight:1.2}},sse={baseStyle:ise,sizes:ose,defaultProps:{size:"xl"}},{definePartsStyle:Ip,defineMultiStyleConfig:ase}=us(_ne.keys),sy=Zn("input-height"),ay=Zn("input-font-size"),ly=Zn("input-padding"),cy=Zn("input-border-radius"),lse=Ip({addon:{height:sy.reference,fontSize:ay.reference,px:ly.reference,borderRadius:cy.reference},field:{width:"100%",height:sy.reference,fontSize:ay.reference,px:ly.reference,borderRadius:cy.reference,minWidth:0,outline:0,position:"relative",appearance:"none",transitionProperty:"common",transitionDuration:"normal",_disabled:{opacity:.4,cursor:"not-allowed"}}}),Am={lg:{[ay.variable]:"fontSizes.lg",[ly.variable]:"space.4",[cy.variable]:"radii.md",[sy.variable]:"sizes.12"},md:{[ay.variable]:"fontSizes.md",[ly.variable]:"space.4",[cy.variable]:"radii.md",[sy.variable]:"sizes.10"},sm:{[ay.variable]:"fontSizes.sm",[ly.variable]:"space.3",[cy.variable]:"radii.sm",[sy.variable]:"sizes.8"},xs:{[ay.variable]:"fontSizes.xs",[ly.variable]:"space.2",[cy.variable]:"radii.sm",[sy.variable]:"sizes.6"}},cse={lg:Ip({field:Am.lg,group:Am.lg}),md:Ip({field:Am.md,group:Am.md}),sm:Ip({field:Am.sm,group:Am.sm}),xs:Ip({field:Am.xs,group:Am.xs})};function $D(e){const{focusBorderColor:r,errorBorderColor:a}=e;return{focusBorderColor:r||Yn("blue.500","blue.300")(e),errorBorderColor:a||Yn("red.500","red.300")(e)}}const use=Ip(e=>{const{theme:r}=e,{focusBorderColor:a,errorBorderColor:u}=$D(e);return{field:{border:"1px solid",borderColor:"inherit",bg:"inherit",_hover:{borderColor:Yn("gray.300","whiteAlpha.400")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:Kc(r,u),boxShadow:`0 0 0 1px ${Kc(r,u)}`},_focusVisible:{zIndex:1,borderColor:Kc(r,a),boxShadow:`0 0 0 1px ${Kc(r,a)}`}},addon:{border:"1px solid",borderColor:Yn("inherit","whiteAlpha.50")(e),bg:Yn("gray.100","whiteAlpha.300")(e)}}}),dse=Ip(e=>{const{theme:r}=e,{focusBorderColor:a,errorBorderColor:u}=$D(e);return{field:{border:"2px solid",borderColor:"transparent",bg:Yn("gray.100","whiteAlpha.50")(e),_hover:{bg:Yn("gray.200","whiteAlpha.100")(e)},_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:Kc(r,u)},_focusVisible:{bg:"transparent",borderColor:Kc(r,a)}},addon:{border:"2px solid",borderColor:"transparent",bg:Yn("gray.100","whiteAlpha.50")(e)}}}),hse=Ip(e=>{const{theme:r}=e,{focusBorderColor:a,errorBorderColor:u}=$D(e);return{field:{borderBottom:"1px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent",_readOnly:{boxShadow:"none !important",userSelect:"all"},_invalid:{borderColor:Kc(r,u),boxShadow:`0px 1px 0px 0px ${Kc(r,u)}`},_focusVisible:{borderColor:Kc(r,a),boxShadow:`0px 1px 0px 0px ${Kc(r,a)}`}},addon:{borderBottom:"2px solid",borderColor:"inherit",borderRadius:"0",px:"0",bg:"transparent"}}}),fse=Ip({field:{bg:"transparent",px:"0",height:"auto"},addon:{bg:"transparent",px:"0",height:"auto"}}),pse={outline:use,filled:dse,flushed:hse,unstyled:fse},Do=ase({baseStyle:lse,sizes:cse,variants:pse,defaultProps:{size:"md",variant:"outline"}}),u2=Zn("kbd-bg"),mse={[u2.variable]:"colors.gray.100",_dark:{[u2.variable]:"colors.whiteAlpha.100"},bg:u2.reference,borderRadius:"md",borderWidth:"1px",borderBottomWidth:"3px",fontSize:"0.8em",fontWeight:"bold",lineHeight:"normal",px:"0.4em",whiteSpace:"nowrap"},gse={baseStyle:mse},_se={transitionProperty:"common",transitionDuration:"fast",transitionTimingFunction:"ease-out",cursor:"pointer",textDecoration:"none",outline:"none",color:"inherit",_hover:{textDecoration:"underline"},_focusVisible:{boxShadow:"outline"}},yse={baseStyle:_se},{defineMultiStyleConfig:vse,definePartsStyle:xse}=us(yne.keys),bse={marginEnd:"2",display:"inline",verticalAlign:"text-bottom"},wse=xse({icon:bse}),Sse=vse({baseStyle:wse}),{defineMultiStyleConfig:Tse,definePartsStyle:Ese}=us(vne.keys),Tf=Zn("menu-bg"),d2=Zn("menu-shadow"),Pse={[Tf.variable]:"#fff",[d2.variable]:"shadows.sm",_dark:{[Tf.variable]:"colors.gray.700",[d2.variable]:"shadows.dark-lg"},color:"inherit",minW:"3xs",py:"2",zIndex:"dropdown",borderRadius:"md",borderWidth:"1px",bg:Tf.reference,boxShadow:d2.reference},Ise={py:"1.5",px:"3",transitionProperty:"background",transitionDuration:"ultra-fast",transitionTimingFunction:"ease-in",_focus:{[Tf.variable]:"colors.gray.100",_dark:{[Tf.variable]:"colors.whiteAlpha.100"}},_active:{[Tf.variable]:"colors.gray.200",_dark:{[Tf.variable]:"colors.whiteAlpha.200"}},_expanded:{[Tf.variable]:"colors.gray.100",_dark:{[Tf.variable]:"colors.whiteAlpha.100"}},_disabled:{opacity:.4,cursor:"not-allowed"},bg:Tf.reference},Mse={mx:4,my:2,fontWeight:"semibold",fontSize:"sm"},Cse={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0},Ase={opacity:.6},Dse={border:0,borderBottom:"1px solid",borderColor:"inherit",my:"2",opacity:.6},Rse={transitionProperty:"common",transitionDuration:"normal"},Ose=Ese({button:Rse,list:Pse,item:Ise,groupTitle:Mse,icon:Cse,command:Ase,divider:Dse}),Lse=Tse({baseStyle:Ose}),{defineMultiStyleConfig:zse,definePartsStyle:TA}=us(xne.keys),h2=Zn("modal-bg"),f2=Zn("modal-shadow"),Fse={bg:"blackAlpha.600",zIndex:"modal"},kse=e=>{const{isCentered:r,scrollBehavior:a}=e;return{display:"flex",zIndex:"modal",justifyContent:"center",alignItems:r?"center":"flex-start",overflow:a==="inside"?"hidden":"auto",overscrollBehaviorY:"none"}},Bse=e=>{const{isCentered:r,scrollBehavior:a}=e;return{borderRadius:"md",color:"inherit",my:r?"auto":"16",mx:r?"auto":void 0,zIndex:"modal",maxH:a==="inside"?"calc(100% - 7.5rem)":void 0,[h2.variable]:"colors.white",[f2.variable]:"shadows.lg",_dark:{[h2.variable]:"colors.gray.700",[f2.variable]:"shadows.dark-lg"},bg:h2.reference,boxShadow:f2.reference}},jse={px:"6",py:"4",fontSize:"xl",fontWeight:"semibold"},Nse={position:"absolute",top:"2",insetEnd:"3"},Vse=e=>{const{scrollBehavior:r}=e;return{px:"6",py:"2",flex:"1",overflow:r==="inside"?"auto":void 0}},Use={px:"6",py:"4"},$se=TA(e=>({overlay:Fse,dialogContainer:Jc(kse,e),dialog:Jc(Bse,e),header:jse,closeButton:Nse,body:Jc(Vse,e),footer:Use}));function xh(e){return TA(e==="full"?{dialog:{maxW:"100vw",minH:"$100vh",my:"0",borderRadius:"0"}}:{dialog:{maxW:e}})}const Wse={xs:xh("xs"),sm:xh("sm"),md:xh("md"),lg:xh("lg"),xl:xh("xl"),"2xl":xh("2xl"),"3xl":xh("3xl"),"4xl":xh("4xl"),"5xl":xh("5xl"),"6xl":xh("6xl"),full:xh("full")},qse=zse({baseStyle:$se,sizes:Wse,defaultProps:{size:"md"}}),m8={letterSpacings:{tighter:"-0.05em",tight:"-0.025em",normal:"0",wide:"0.025em",wider:"0.05em",widest:"0.1em"},lineHeights:{normal:"normal",none:1,shorter:1.25,short:1.375,base:1.5,tall:1.625,taller:"2",3:".75rem",4:"1rem",5:"1.25rem",6:"1.5rem",7:"1.75rem",8:"2rem",9:"2.25rem",10:"2.5rem"},fontWeights:{hairline:100,thin:200,light:300,normal:400,medium:500,semibold:600,bold:700,extrabold:800,black:900},fonts:{heading:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'-apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'},fontSizes:{"3xs":"0.45rem","2xs":"0.625rem",xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem","2xl":"1.5rem","3xl":"1.875rem","4xl":"2.25rem","5xl":"3rem","6xl":"3.75rem","7xl":"4.5rem","8xl":"6rem","9xl":"8rem"}},{defineMultiStyleConfig:Gse,definePartsStyle:g8}=us(bne.keys),WD=al("number-input-stepper-width"),_8=al("number-input-input-padding"),Hse=Ep(WD).add("0.5rem").toString(),p2=al("number-input-bg"),m2=al("number-input-color"),g2=al("number-input-border-color"),Yse={[WD.variable]:"sizes.6",[_8.variable]:Hse},Zse=e=>Jc(Do.baseStyle,e)?.field??{},Xse={width:WD.reference},Kse={borderStart:"1px solid",borderStartColor:g2.reference,color:m2.reference,bg:p2.reference,[m2.variable]:"colors.chakra-body-text",[g2.variable]:"colors.chakra-border-color",_dark:{[m2.variable]:"colors.whiteAlpha.800",[g2.variable]:"colors.whiteAlpha.300"},_active:{[p2.variable]:"colors.gray.200",_dark:{[p2.variable]:"colors.whiteAlpha.300"}},_disabled:{opacity:.4,cursor:"not-allowed"}},Qse=g8(e=>({root:Yse,field:Jc(Zse,e)??{},stepperGroup:Xse,stepper:Kse}));function Fb(e){const r=Do.sizes?.[e],a={lg:"md",md:"md",sm:"sm",xs:"sm"},u=r.field?.fontSize??"md",p=m8.fontSizes[u];return g8({field:{...r.field,paddingInlineEnd:_8.reference,verticalAlign:"top"},stepper:{fontSize:Ep(p).multiply(.75).toString(),_first:{borderTopEndRadius:a[e]},_last:{borderBottomEndRadius:a[e],mt:"-1px",borderTopWidth:1}}})}const Jse={xs:Fb("xs"),sm:Fb("sm"),md:Fb("md"),lg:Fb("lg")},eae=Gse({baseStyle:Qse,sizes:Jse,variants:Do.variants,defaultProps:Do.defaultProps}),tae={...Do.baseStyle?.field,textAlign:"center"},rae={lg:{fontSize:"lg",w:12,h:12,borderRadius:"md"},md:{fontSize:"md",w:10,h:10,borderRadius:"md"},sm:{fontSize:"sm",w:8,h:8,borderRadius:"sm"},xs:{fontSize:"xs",w:6,h:6,borderRadius:"sm"}},nae={outline:e=>Jc(Do.variants?.outline,e)?.field??{},flushed:e=>Jc(Do.variants?.flushed,e)?.field??{},filled:e=>Jc(Do.variants?.filled,e)?.field??{},unstyled:Do.variants?.unstyled.field??{}},iae={baseStyle:tae,sizes:rae,variants:nae,defaultProps:Do.defaultProps},{defineMultiStyleConfig:oae,definePartsStyle:sae}=us(wne.keys),kb=al("popper-bg"),aae=al("popper-arrow-bg"),V3=al("popper-arrow-shadow-color"),lae={zIndex:"popover"},cae={[kb.variable]:"colors.white",bg:kb.reference,[aae.variable]:kb.reference,[V3.variable]:"colors.gray.200",_dark:{[kb.variable]:"colors.gray.700",[V3.variable]:"colors.whiteAlpha.300"},width:"xs",border:"1px solid",borderColor:"inherit",borderRadius:"md",boxShadow:"sm",zIndex:"inherit",_focusVisible:{outline:0,boxShadow:"outline"}},uae={px:3,py:2,borderBottomWidth:"1px"},dae={px:3,py:2},hae={px:3,py:2,borderTopWidth:"1px"},fae={position:"absolute",borderRadius:"md",top:1,insetEnd:2,padding:2},pae=sae({popper:lae,content:cae,header:uae,body:dae,footer:hae,closeButton:fae}),mae=oae({baseStyle:pae}),{defineMultiStyleConfig:gae,definePartsStyle:_0}=us(Sne.keys),_ae=e=>{const{colorScheme:r,theme:a,isIndeterminate:u,hasStripe:p}=e,y=Yn(F3(),F3("1rem","rgba(0,0,0,0.1)"))(e),x=Yn(`${r}.500`,`${r}.200`)(e),i=`linear-gradient(
    to right,
    transparent 0%,
    ${Kc(a,x)} 50%,
    transparent 100%
  )`;return{...!u&&p&&y,...u?{bgImage:i}:{bgColor:x}}},yae={lineHeight:"1",fontSize:"0.25em",fontWeight:"bold",color:"white"},vae=e=>({bg:Yn("gray.100","whiteAlpha.300")(e)}),xae=e=>({transitionProperty:"common",transitionDuration:"slow",..._ae(e)}),bae=_0(e=>({label:yae,filledTrack:xae(e),track:vae(e)})),wae={xs:_0({track:{h:"1"}}),sm:_0({track:{h:"2"}}),md:_0({track:{h:"3"}}),lg:_0({track:{h:"4"}})},Sae=gae({sizes:wae,baseStyle:bae,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:Tae,definePartsStyle:Q1}=us(Tne.keys),Eae=e=>{const r=Jc(Sw.baseStyle,e)?.control;return{...r,borderRadius:"full",_checked:{...r?._checked,_before:{content:'""',display:"inline-block",pos:"relative",w:"50%",h:"50%",borderRadius:"50%",bg:"currentColor"}}}},Pae=Q1(e=>({label:Sw.baseStyle?.(e).label,container:Sw.baseStyle?.(e).container,control:Eae(e)})),Iae={md:Q1({control:{w:"4",h:"4"},label:{fontSize:"md"}}),lg:Q1({control:{w:"5",h:"5"},label:{fontSize:"lg"}}),sm:Q1({control:{width:"3",height:"3"},label:{fontSize:"sm"}})},Mae=Tae({baseStyle:Pae,sizes:Iae,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:Cae,definePartsStyle:Aae}=us(Ene.keys),Bb=Zn("select-bg"),Dae={...Do.baseStyle?.field,appearance:"none",paddingBottom:"1px",lineHeight:"normal",bg:Bb.reference,[Bb.variable]:"colors.white",_dark:{[Bb.variable]:"colors.gray.700"},"> option, > optgroup":{bg:Bb.reference}},Rae={width:"6",height:"100%",insetEnd:"2",position:"relative",color:"currentColor",fontSize:"xl",_disabled:{opacity:.5}},Oae=Aae({field:Dae,icon:Rae}),jb={paddingInlineEnd:"8"},Lae={lg:{...Do.sizes?.lg,field:{...Do.sizes?.lg.field,...jb}},md:{...Do.sizes?.md,field:{...Do.sizes?.md.field,...jb}},sm:{...Do.sizes?.sm,field:{...Do.sizes?.sm.field,...jb}},xs:{...Do.sizes?.xs,field:{...Do.sizes?.xs.field,...jb},icon:{insetEnd:"1"}}},zae=Cae({baseStyle:Oae,sizes:Lae,variants:Do.variants,defaultProps:Do.defaultProps}),_2=Zn("skeleton-start-color"),y2=Zn("skeleton-end-color"),Fae={[_2.variable]:"colors.gray.100",[y2.variable]:"colors.gray.400",_dark:{[_2.variable]:"colors.gray.800",[y2.variable]:"colors.gray.600"},background:_2.reference,borderColor:y2.reference,opacity:.7,borderRadius:"sm"},kae={baseStyle:Fae},v2=Zn("skip-link-bg"),Bae={borderRadius:"md",fontWeight:"semibold",_focusVisible:{boxShadow:"outline",padding:"4",position:"fixed",top:"6",insetStart:"6",[v2.variable]:"colors.white",_dark:{[v2.variable]:"colors.gray.700"},bg:v2.reference}},jae={baseStyle:Bae},{defineMultiStyleConfig:Nae,definePartsStyle:eS}=us(Pne.keys),i_=Zn("slider-thumb-size"),Y0=Zn("slider-track-size"),km=Zn("slider-bg"),Vae=e=>{const{orientation:r}=e;return{display:"inline-block",position:"relative",cursor:"pointer",_disabled:{opacity:.6,cursor:"default",pointerEvents:"none"},...VD({orientation:r,vertical:{h:"100%",px:Tp(i_.reference).divide(2).toString()},horizontal:{w:"100%",py:Tp(i_.reference).divide(2).toString()}})}},Uae=e=>({...VD({orientation:e.orientation,horizontal:{h:Y0.reference},vertical:{w:Y0.reference}}),overflow:"hidden",borderRadius:"sm",[km.variable]:"colors.gray.200",_dark:{[km.variable]:"colors.whiteAlpha.200"},_disabled:{[km.variable]:"colors.gray.300",_dark:{[km.variable]:"colors.whiteAlpha.300"}},bg:km.reference}),$ae=e=>{const{orientation:r}=e;return{...VD({orientation:r,vertical:{left:"50%"},horizontal:{top:"50%"}}),w:i_.reference,h:i_.reference,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",outline:0,zIndex:1,borderRadius:"full",bg:"white",boxShadow:"base",border:"1px solid",borderColor:"transparent",transitionProperty:"transform",transitionDuration:"normal",_focusVisible:{boxShadow:"outline"},_active:{"--slider-thumb-scale":"1.15"},_disabled:{bg:"gray.300"}}},Wae=e=>{const{colorScheme:r}=e;return{width:"inherit",height:"inherit",[km.variable]:`colors.${r}.500`,_dark:{[km.variable]:`colors.${r}.200`},bg:km.reference}},qae=eS(e=>({container:Vae(e),track:Uae(e),thumb:$ae(e),filledTrack:Wae(e)})),Gae=eS({container:{[i_.variable]:"sizes.4",[Y0.variable]:"sizes.1"}}),Hae=eS({container:{[i_.variable]:"sizes.3.5",[Y0.variable]:"sizes.1"}}),Yae=eS({container:{[i_.variable]:"sizes.2.5",[Y0.variable]:"sizes.0.5"}}),Zae={lg:Gae,md:Hae,sm:Yae},Xae=Nae({baseStyle:qae,sizes:Zae,defaultProps:{size:"md",colorScheme:"blue"}}),Vg=al("spinner-size"),Kae={width:[Vg.reference],height:[Vg.reference]},Qae={xs:{[Vg.variable]:"sizes.3"},sm:{[Vg.variable]:"sizes.4"},md:{[Vg.variable]:"sizes.6"},lg:{[Vg.variable]:"sizes.8"},xl:{[Vg.variable]:"sizes.12"}},Jae={baseStyle:Kae,sizes:Qae,defaultProps:{size:"md"}},{defineMultiStyleConfig:ele,definePartsStyle:y8}=us(Ine.keys),tle={fontWeight:"medium"},rle={opacity:.8,marginBottom:"2"},nle={verticalAlign:"baseline",fontWeight:"semibold"},ile={marginEnd:1,w:"3.5",h:"3.5",verticalAlign:"middle"},ole=y8({container:{},label:tle,helpText:rle,number:nle,icon:ile}),sle={md:y8({label:{fontSize:"sm"},helpText:{fontSize:"sm"},number:{fontSize:"2xl"}})},ale=ele({baseStyle:ole,sizes:sle,defaultProps:{size:"md"}}),{defineMultiStyleConfig:lle,definePartsStyle:y0}=us(["stepper","step","title","description","indicator","separator","icon","number"]),Pp=Zn("stepper-indicator-size"),uy=Zn("stepper-icon-size"),dy=Zn("stepper-title-font-size"),v0=Zn("stepper-description-font-size"),Qv=Zn("stepper-accent-color"),cle=y0(({colorScheme:e})=>({stepper:{display:"flex",justifyContent:"space-between",gap:"4","&[data-orientation=vertical]":{flexDirection:"column",alignItems:"flex-start"},"&[data-orientation=horizontal]":{flexDirection:"row",alignItems:"center"},[Qv.variable]:`colors.${e}.500`,_dark:{[Qv.variable]:`colors.${e}.200`}},title:{fontSize:dy.reference,fontWeight:"medium"},description:{fontSize:v0.reference,color:"chakra-subtle-text"},number:{fontSize:dy.reference},step:{flexShrink:0,position:"relative",display:"flex",gap:"2","&[data-orientation=horizontal]":{alignItems:"center"},flex:"1","&:last-of-type:not([data-stretch])":{flex:"initial"}},icon:{flexShrink:0,width:uy.reference,height:uy.reference},indicator:{flexShrink:0,borderRadius:"full",width:Pp.reference,height:Pp.reference,display:"flex",justifyContent:"center",alignItems:"center","&[data-status=active]":{borderWidth:"2px",borderColor:Qv.reference},"&[data-status=complete]":{bg:Qv.reference,color:"chakra-inverse-text"},"&[data-status=incomplete]":{borderWidth:"2px"}},separator:{bg:"chakra-border-color",flex:"1","&[data-status=complete]":{bg:Qv.reference},"&[data-orientation=horizontal]":{width:"100%",height:"2px",marginStart:"2"},"&[data-orientation=vertical]":{width:"2px",position:"absolute",height:"100%",maxHeight:`calc(100% - ${Pp.reference} - 8px)`,top:`calc(${Pp.reference} + 4px)`,insetStart:`calc(${Pp.reference} / 2 - 1px)`}}})),ule=lle({baseStyle:cle,sizes:{xs:y0({stepper:{[Pp.variable]:"sizes.4",[uy.variable]:"sizes.3",[dy.variable]:"fontSizes.xs",[v0.variable]:"fontSizes.xs"}}),sm:y0({stepper:{[Pp.variable]:"sizes.6",[uy.variable]:"sizes.4",[dy.variable]:"fontSizes.sm",[v0.variable]:"fontSizes.xs"}}),md:y0({stepper:{[Pp.variable]:"sizes.8",[uy.variable]:"sizes.5",[dy.variable]:"fontSizes.md",[v0.variable]:"fontSizes.sm"}}),lg:y0({stepper:{[Pp.variable]:"sizes.10",[uy.variable]:"sizes.6",[dy.variable]:"fontSizes.lg",[v0.variable]:"fontSizes.md"}})},defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:dle,definePartsStyle:J1}=us(Mne.keys),O0=al("switch-track-width"),Zg=al("switch-track-height"),x2=al("switch-track-diff"),hle=Ep.subtract(O0,Zg),EA=al("switch-thumb-x"),Jv=al("switch-bg"),fle=e=>{const{colorScheme:r}=e;return{borderRadius:"full",p:"0.5",width:[O0.reference],height:[Zg.reference],transitionProperty:"common",transitionDuration:"fast",[Jv.variable]:"colors.gray.300",_dark:{[Jv.variable]:"colors.whiteAlpha.400"},_focusVisible:{boxShadow:"outline"},_disabled:{opacity:.4,cursor:"not-allowed"},_checked:{[Jv.variable]:`colors.${r}.500`,_dark:{[Jv.variable]:`colors.${r}.200`}},bg:Jv.reference}},ple={bg:"white",transitionProperty:"transform",transitionDuration:"normal",borderRadius:"inherit",width:[Zg.reference],height:[Zg.reference],_checked:{transform:`translateX(${EA.reference})`}},mle=J1(e=>({container:{[x2.variable]:hle,[EA.variable]:x2.reference,_rtl:{[EA.variable]:Ep(x2).negate().toString()}},track:fle(e),thumb:ple})),gle={sm:J1({container:{[O0.variable]:"1.375rem",[Zg.variable]:"sizes.3"}}),md:J1({container:{[O0.variable]:"1.875rem",[Zg.variable]:"sizes.4"}}),lg:J1({container:{[O0.variable]:"2.875rem",[Zg.variable]:"sizes.6"}})},_le=dle({baseStyle:mle,sizes:gle,defaultProps:{size:"md",colorScheme:"blue"}}),{defineMultiStyleConfig:yle,definePartsStyle:Py}=us(Cne.keys),vle=Py({table:{fontVariantNumeric:"lining-nums tabular-nums",borderCollapse:"collapse",width:"full"},th:{fontFamily:"heading",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"wider",textAlign:"start"},td:{textAlign:"start"},caption:{mt:4,fontFamily:"heading",textAlign:"center",fontWeight:"medium"}}),Tw={"&[data-is-numeric=true]":{textAlign:"end"}},xle=Py(e=>{const{colorScheme:r}=e;return{th:{color:Yn("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Yn(`${r}.100`,`${r}.700`)(e),...Tw},td:{borderBottom:"1px",borderColor:Yn(`${r}.100`,`${r}.700`)(e),...Tw},caption:{color:Yn("gray.600","gray.100")(e)},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),ble=Py(e=>{const{colorScheme:r}=e;return{th:{color:Yn("gray.600","gray.400")(e),borderBottom:"1px",borderColor:Yn(`${r}.100`,`${r}.700`)(e),...Tw},td:{borderBottom:"1px",borderColor:Yn(`${r}.100`,`${r}.700`)(e),...Tw},caption:{color:Yn("gray.600","gray.100")(e)},tbody:{tr:{"&:nth-of-type(odd)":{"th, td":{borderBottomWidth:"1px",borderColor:Yn(`${r}.100`,`${r}.700`)(e)},td:{background:Yn(`${r}.100`,`${r}.700`)(e)}}}},tfoot:{tr:{"&:last-of-type":{th:{borderBottomWidth:0}}}}}}),wle={simple:xle,striped:ble,unstyled:{}},Sle={sm:Py({th:{px:"4",py:"1",lineHeight:"4",fontSize:"xs"},td:{px:"4",py:"2",fontSize:"sm",lineHeight:"4"},caption:{px:"4",py:"2",fontSize:"xs"}}),md:Py({th:{px:"6",py:"3",lineHeight:"4",fontSize:"xs"},td:{px:"6",py:"4",lineHeight:"5"},caption:{px:"6",py:"2",fontSize:"sm"}}),lg:Py({th:{px:"8",py:"4",lineHeight:"5",fontSize:"sm"},td:{px:"8",py:"5",lineHeight:"6"},caption:{px:"6",py:"2",fontSize:"md"}})},Tle=yle({baseStyle:vle,variants:wle,sizes:Sle,defaultProps:{variant:"simple",size:"md",colorScheme:"gray"}}),wu=Zn("tabs-color"),Eh=Zn("tabs-bg"),Nb=Zn("tabs-border-color"),{defineMultiStyleConfig:Ele,definePartsStyle:Af}=us(Ane.keys),Ple=e=>{const{orientation:r}=e;return{display:r==="vertical"?"flex":"block"}},Ile=e=>{const{isFitted:r}=e;return{flex:r?1:void 0,transitionProperty:"common",transitionDuration:"normal",_focusVisible:{zIndex:1,boxShadow:"outline"},_disabled:{cursor:"not-allowed",opacity:.4}}},Mle=e=>{const{align:r="start",orientation:a}=e;return{justifyContent:{end:"flex-end",center:"center",start:"flex-start"}[r],flexDirection:a==="vertical"?"column":"row"}},Cle={p:4},Ale=Af(e=>({root:Ple(e),tab:Ile(e),tablist:Mle(e),tabpanel:Cle})),Dle={sm:Af({tab:{py:1,px:4,fontSize:"sm"}}),md:Af({tab:{fontSize:"md",py:2,px:4}}),lg:Af({tab:{fontSize:"lg",py:3,px:4}})},Rle=Af(e=>{const{colorScheme:r,orientation:a}=e,u=a==="vertical",p=u?"borderStart":"borderBottom",y=u?"marginStart":"marginBottom";return{tablist:{[p]:"2px solid",borderColor:"inherit"},tab:{[p]:"2px solid",borderColor:"transparent",[y]:"-2px",_selected:{[wu.variable]:`colors.${r}.600`,_dark:{[wu.variable]:`colors.${r}.300`},borderColor:"currentColor"},_active:{[Eh.variable]:"colors.gray.200",_dark:{[Eh.variable]:"colors.whiteAlpha.300"}},_disabled:{_active:{bg:"none"}},color:wu.reference,bg:Eh.reference}}}),Ole=Af(e=>{const{colorScheme:r}=e;return{tab:{borderTopRadius:"md",border:"1px solid",borderColor:"transparent",mb:"-1px",[Nb.variable]:"transparent",_selected:{[wu.variable]:`colors.${r}.600`,[Nb.variable]:"colors.white",_dark:{[wu.variable]:`colors.${r}.300`,[Nb.variable]:"colors.gray.800"},borderColor:"inherit",borderBottomColor:Nb.reference},color:wu.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),Lle=Af(e=>{const{colorScheme:r}=e;return{tab:{border:"1px solid",borderColor:"inherit",[Eh.variable]:"colors.gray.50",_dark:{[Eh.variable]:"colors.whiteAlpha.50"},mb:"-1px",_notLast:{marginEnd:"-1px"},_selected:{[Eh.variable]:"colors.white",[wu.variable]:`colors.${r}.600`,_dark:{[Eh.variable]:"colors.gray.800",[wu.variable]:`colors.${r}.300`},borderColor:"inherit",borderTopColor:"currentColor",borderBottomColor:"transparent"},color:wu.reference,bg:Eh.reference},tablist:{mb:"-1px",borderBottom:"1px solid",borderColor:"inherit"}}}),zle=Af(e=>{const{colorScheme:r,theme:a}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",color:"gray.600",_selected:{color:Kc(a,`${r}.700`),bg:Kc(a,`${r}.100`)}}}}),Fle=Af(e=>{const{colorScheme:r}=e;return{tab:{borderRadius:"full",fontWeight:"semibold",[wu.variable]:"colors.gray.600",_dark:{[wu.variable]:"inherit"},_selected:{[wu.variable]:"colors.white",[Eh.variable]:`colors.${r}.600`,_dark:{[wu.variable]:"colors.gray.800",[Eh.variable]:`colors.${r}.300`}},color:wu.reference,bg:Eh.reference}}}),kle=Af({}),Ble={line:Rle,enclosed:Ole,"enclosed-colored":Lle,"soft-rounded":zle,"solid-rounded":Fle,unstyled:kle},jle=Ele({baseStyle:Ale,sizes:Dle,variants:Ble,defaultProps:{size:"md",variant:"line",colorScheme:"blue"}}),{defineMultiStyleConfig:Nle,definePartsStyle:Xg}=us(Dne.keys),U3=Zn("tag-bg"),$3=Zn("tag-color"),b2=Zn("tag-shadow"),ew=Zn("tag-min-height"),tw=Zn("tag-min-width"),rw=Zn("tag-font-size"),nw=Zn("tag-padding-inline"),Vle={fontWeight:"medium",lineHeight:1.2,outline:0,[$3.variable]:Da.color.reference,[U3.variable]:Da.bg.reference,[b2.variable]:Da.shadow.reference,color:$3.reference,bg:U3.reference,boxShadow:b2.reference,borderRadius:"md",minH:ew.reference,minW:tw.reference,fontSize:rw.reference,px:nw.reference,_focusVisible:{[b2.variable]:"shadows.outline"}},Ule={lineHeight:1.2,overflow:"visible"},$le={fontSize:"lg",w:"5",h:"5",transitionProperty:"common",transitionDuration:"normal",borderRadius:"full",marginStart:"1.5",marginEnd:"-1",opacity:.5,_disabled:{opacity:.4},_focusVisible:{boxShadow:"outline",bg:"rgba(0, 0, 0, 0.14)"},_hover:{opacity:.8},_active:{opacity:1}},Wle=Xg({container:Vle,label:Ule,closeButton:$le}),qle={sm:Xg({container:{[ew.variable]:"sizes.5",[tw.variable]:"sizes.5",[rw.variable]:"fontSizes.xs",[nw.variable]:"space.2"},closeButton:{marginEnd:"-2px",marginStart:"0.35rem"}}),md:Xg({container:{[ew.variable]:"sizes.6",[tw.variable]:"sizes.6",[rw.variable]:"fontSizes.sm",[nw.variable]:"space.2"}}),lg:Xg({container:{[ew.variable]:"sizes.8",[tw.variable]:"sizes.8",[rw.variable]:"fontSizes.md",[nw.variable]:"space.3"}})},Gle={subtle:Xg(e=>({container:A0.variants?.subtle(e)})),solid:Xg(e=>({container:A0.variants?.solid(e)})),outline:Xg(e=>({container:A0.variants?.outline(e)}))},Hle=Nle({variants:Gle,baseStyle:Wle,sizes:qle,defaultProps:{size:"md",variant:"subtle",colorScheme:"gray"}}),Yle={...Do.baseStyle?.field,paddingY:"2",minHeight:"20",lineHeight:"short",verticalAlign:"top"},Zle={outline:e=>Do.variants?.outline(e).field??{},flushed:e=>Do.variants?.flushed(e).field??{},filled:e=>Do.variants?.filled(e).field??{},unstyled:Do.variants?.unstyled.field??{}},Xle={xs:Do.sizes?.xs.field??{},sm:Do.sizes?.sm.field??{},md:Do.sizes?.md.field??{},lg:Do.sizes?.lg.field??{}},Kle={baseStyle:Yle,sizes:Xle,variants:Zle,defaultProps:{size:"md",variant:"outline"}},Vb=al("tooltip-bg"),w2=al("tooltip-fg"),Qle=al("popper-arrow-bg"),Jle={bg:Vb.reference,color:w2.reference,[Vb.variable]:"colors.gray.700",[w2.variable]:"colors.whiteAlpha.900",_dark:{[Vb.variable]:"colors.gray.300",[w2.variable]:"colors.gray.900"},[Qle.variable]:Vb.reference,px:"2",py:"0.5",borderRadius:"sm",fontWeight:"medium",fontSize:"sm",boxShadow:"md",maxW:"xs",zIndex:"tooltip"},ece={baseStyle:Jle},tce={Accordion:Nne,Alert:Sie,Avatar:Lie,Badge:A0,Breadcrumb:Wie,Button:Jie,Checkbox:Sw,CloseButton:poe,Code:yoe,Container:xoe,Divider:Eoe,Drawer:Foe,Editable:$oe,Form:Zoe,FormError:tse,FormLabel:nse,Heading:sse,Input:Do,Kbd:gse,Link:yse,List:Sse,Menu:Lse,Modal:qse,NumberInput:eae,PinInput:iae,Popover:mae,Progress:Sae,Radio:Mae,Select:zae,Skeleton:kae,SkipLink:jae,Slider:Xae,Spinner:Jae,Stat:ale,Switch:_le,Table:Tle,Tabs:jle,Tag:Hle,Textarea:Kle,Tooltip:ece,Card:ioe,Stepper:ule},rce={none:0,"1px":"1px solid","2px":"2px solid","4px":"4px solid","8px":"8px solid"},nce={base:"0em",sm:"30em",md:"48em",lg:"62em",xl:"80em","2xl":"96em"},ice={transparent:"transparent",current:"currentColor",black:"#000000",white:"#FFFFFF",whiteAlpha:{50:"rgba(255, 255, 255, 0.04)",100:"rgba(255, 255, 255, 0.06)",200:"rgba(255, 255, 255, 0.08)",300:"rgba(255, 255, 255, 0.16)",400:"rgba(255, 255, 255, 0.24)",500:"rgba(255, 255, 255, 0.36)",600:"rgba(255, 255, 255, 0.48)",700:"rgba(255, 255, 255, 0.64)",800:"rgba(255, 255, 255, 0.80)",900:"rgba(255, 255, 255, 0.92)"},blackAlpha:{50:"rgba(0, 0, 0, 0.04)",100:"rgba(0, 0, 0, 0.06)",200:"rgba(0, 0, 0, 0.08)",300:"rgba(0, 0, 0, 0.16)",400:"rgba(0, 0, 0, 0.24)",500:"rgba(0, 0, 0, 0.36)",600:"rgba(0, 0, 0, 0.48)",700:"rgba(0, 0, 0, 0.64)",800:"rgba(0, 0, 0, 0.80)",900:"rgba(0, 0, 0, 0.92)"},gray:{50:"#F7FAFC",100:"#EDF2F7",200:"#E2E8F0",300:"#CBD5E0",400:"#A0AEC0",500:"#718096",600:"#4A5568",700:"#2D3748",800:"#1A202C",900:"#171923"},red:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"},orange:{50:"#FFFAF0",100:"#FEEBC8",200:"#FBD38D",300:"#F6AD55",400:"#ED8936",500:"#DD6B20",600:"#C05621",700:"#9C4221",800:"#7B341E",900:"#652B19"},yellow:{50:"#FFFFF0",100:"#FEFCBF",200:"#FAF089",300:"#F6E05E",400:"#ECC94B",500:"#D69E2E",600:"#B7791F",700:"#975A16",800:"#744210",900:"#5F370E"},green:{50:"#F0FFF4",100:"#C6F6D5",200:"#9AE6B4",300:"#68D391",400:"#48BB78",500:"#38A169",600:"#2F855A",700:"#276749",800:"#22543D",900:"#1C4532"},teal:{50:"#E6FFFA",100:"#B2F5EA",200:"#81E6D9",300:"#4FD1C5",400:"#38B2AC",500:"#319795",600:"#2C7A7B",700:"#285E61",800:"#234E52",900:"#1D4044"},blue:{50:"#ebf8ff",100:"#bee3f8",200:"#90cdf4",300:"#63b3ed",400:"#4299e1",500:"#3182ce",600:"#2b6cb0",700:"#2c5282",800:"#2a4365",900:"#1A365D"},cyan:{50:"#EDFDFD",100:"#C4F1F9",200:"#9DECF9",300:"#76E4F7",400:"#0BC5EA",500:"#00B5D8",600:"#00A3C4",700:"#0987A0",800:"#086F83",900:"#065666"},purple:{50:"#FAF5FF",100:"#E9D8FD",200:"#D6BCFA",300:"#B794F4",400:"#9F7AEA",500:"#805AD5",600:"#6B46C1",700:"#553C9A",800:"#44337A",900:"#322659"},pink:{50:"#FFF5F7",100:"#FED7E2",200:"#FBB6CE",300:"#F687B3",400:"#ED64A6",500:"#D53F8C",600:"#B83280",700:"#97266D",800:"#702459",900:"#521B41"}},oce={none:"0",sm:"0.125rem",base:"0.25rem",md:"0.375rem",lg:"0.5rem",xl:"0.75rem","2xl":"1rem","3xl":"1.5rem",full:"9999px"},sce={xs:"0 0 0 1px rgba(0, 0, 0, 0.05)",sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",base:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)",md:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",lg:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",xl:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","2xl":"0 25px 50px -12px rgba(0, 0, 0, 0.25)",outline:"0 0 0 3px rgba(66, 153, 225, 0.6)",inner:"inset 0 2px 4px 0 rgba(0,0,0,0.06)",none:"none","dark-lg":"rgba(0, 0, 0, 0.1) 0px 0px 0px 1px, rgba(0, 0, 0, 0.2) 0px 5px 10px, rgba(0, 0, 0, 0.4) 0px 15px 40px"},ace={common:"background-color, border-color, color, fill, stroke, opacity, box-shadow, transform",colors:"background-color, border-color, color, fill, stroke",dimensions:"width, height",position:"left, right, top, bottom",background:"background-color, background-image, background-position"},lce={"ease-in":"cubic-bezier(0.4, 0, 1, 1)","ease-out":"cubic-bezier(0, 0, 0.2, 1)","ease-in-out":"cubic-bezier(0.4, 0, 0.2, 1)"},cce={"ultra-fast":"50ms",faster:"100ms",fast:"150ms",normal:"200ms",slow:"300ms",slower:"400ms","ultra-slow":"500ms"},uce={property:ace,easing:lce,duration:cce},dce={hide:-1,auto:"auto",base:0,docked:10,dropdown:1e3,sticky:1100,banner:1200,overlay:1300,modal:1400,popover:1500,skipLink:1600,toast:1700,tooltip:1800},hce={none:0,sm:"4px",base:"8px",md:"12px",lg:"16px",xl:"24px","2xl":"40px","3xl":"64px"},fce={breakpoints:nce,zIndices:dce,radii:oce,blur:hce,colors:ice,...m8,sizes:c8,shadows:sce,space:l8,borders:rce,transition:uce},pce={colors:{"chakra-body-text":{_light:"gray.800",_dark:"whiteAlpha.900"},"chakra-body-bg":{_light:"white",_dark:"gray.800"},"chakra-border-color":{_light:"gray.200",_dark:"whiteAlpha.300"},"chakra-inverse-text":{_light:"white",_dark:"gray.800"},"chakra-subtle-bg":{_light:"gray.100",_dark:"gray.700"},"chakra-subtle-text":{_light:"gray.600",_dark:"gray.400"},"chakra-placeholder-color":{_light:"gray.500",_dark:"whiteAlpha.400"}}},mce={global:{body:{fontFamily:"body",color:"chakra-body-text",bg:"chakra-body-bg",transitionProperty:"background-color",transitionDuration:"normal",lineHeight:"base"},"*::placeholder":{color:"chakra-placeholder-color"},"*, *::before, &::after":{borderColor:"chakra-border-color"}}},gce="ltr",_ce={useSystemColorMode:!1,initialColorMode:"light",cssVarPrefix:"chakra"},v8={semanticTokens:pce,direction:gce,...fce,components:tce,styles:mce,config:_ce};function yce(e){if(e.sheet)return e.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===e)return document.styleSheets[r]}function vce(e){var r=document.createElement("style");return r.setAttribute("data-emotion",e.key),e.nonce!==void 0&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var xce=(function(){function e(a){var u=this;this._insertTag=function(p){var y;u.tags.length===0?u.insertionPoint?y=u.insertionPoint.nextSibling:u.prepend?y=u.container.firstChild:y=u.before:y=u.tags[u.tags.length-1].nextSibling,u.container.insertBefore(p,y),u.tags.push(p)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var r=e.prototype;return r.hydrate=function(u){u.forEach(this._insertTag)},r.insert=function(u){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(vce(this));var p=this.tags[this.tags.length-1];if(this.isSpeedy){var y=yce(p);try{y.insertRule(u,y.cssRules.length)}catch{}}else p.appendChild(document.createTextNode(u));this.ctr++},r.flush=function(){this.tags.forEach(function(u){var p;return(p=u.parentNode)==null?void 0:p.removeChild(u)}),this.tags=[],this.ctr=0},e})(),Ec="-ms-",Ew="-moz-",Co="-webkit-",x8="comm",qD="rule",GD="decl",bce="@import",b8="@keyframes",wce="@layer",Sce=Math.abs,tS=String.fromCharCode,Tce=Object.assign;function Ece(e,r){return tc(e,0)^45?(((r<<2^tc(e,0))<<2^tc(e,1))<<2^tc(e,2))<<2^tc(e,3):0}function w8(e){return e.trim()}function Pce(e,r){return(e=r.exec(e))?e[0]:e}function Ao(e,r,a){return e.replace(r,a)}function PA(e,r){return e.indexOf(r)}function tc(e,r){return e.charCodeAt(r)|0}function Z0(e,r,a){return e.slice(r,a)}function Ef(e){return e.length}function HD(e){return e.length}function Ub(e,r){return r.push(e),e}function Ice(e,r){return e.map(r).join("")}var rS=1,zy=1,S8=0,Pu=0,Za=0,Yy="";function nS(e,r,a,u,p,y,x){return{value:e,root:r,parent:a,type:u,props:p,children:y,line:rS,column:zy,length:x,return:""}}function e0(e,r){return Tce(nS("",null,null,"",null,null,0),e,{length:-e.length},r)}function Mce(){return Za}function Cce(){return Za=Pu>0?tc(Yy,--Pu):0,zy--,Za===10&&(zy=1,rS--),Za}function Ju(){return Za=Pu<S8?tc(Yy,Pu++):0,zy++,Za===10&&(zy=1,rS++),Za}function Df(){return tc(Yy,Pu)}function iw(){return Pu}function bx(e,r){return Z0(Yy,e,r)}function X0(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function T8(e){return rS=zy=1,S8=Ef(Yy=e),Pu=0,[]}function E8(e){return Yy="",e}function ow(e){return w8(bx(Pu-1,IA(e===91?e+2:e===40?e+1:e)))}function Ace(e){for(;(Za=Df())&&Za<33;)Ju();return X0(e)>2||X0(Za)>3?"":" "}function Dce(e,r){for(;--r&&Ju()&&!(Za<48||Za>102||Za>57&&Za<65||Za>70&&Za<97););return bx(e,iw()+(r<6&&Df()==32&&Ju()==32))}function IA(e){for(;Ju();)switch(Za){case e:return Pu;case 34:case 39:e!==34&&e!==39&&IA(Za);break;case 40:e===41&&IA(e);break;case 92:Ju();break}return Pu}function Rce(e,r){for(;Ju()&&e+Za!==57;)if(e+Za===84&&Df()===47)break;return"/*"+bx(r,Pu-1)+"*"+tS(e===47?e:Ju())}function Oce(e){for(;!X0(Df());)Ju();return bx(e,Pu)}function Lce(e){return E8(sw("",null,null,null,[""],e=T8(e),0,[0],e))}function sw(e,r,a,u,p,y,x,i,C){for(var R=0,z=0,F=x,V=0,G=0,H=0,Z=1,J=1,se=1,pe=0,ve="",Ne=p,_e=y,Re=u,ke=ve;J;)switch(H=pe,pe=Ju()){case 40:if(H!=108&&tc(ke,F-1)==58){PA(ke+=Ao(ow(pe),"&","&\f"),"&\f")!=-1&&(se=-1);break}case 34:case 39:case 91:ke+=ow(pe);break;case 9:case 10:case 13:case 32:ke+=Ace(H);break;case 92:ke+=Dce(iw()-1,7);continue;case 47:switch(Df()){case 42:case 47:Ub(zce(Rce(Ju(),iw()),r,a),C);break;default:ke+="/"}break;case 123*Z:i[R++]=Ef(ke)*se;case 125*Z:case 59:case 0:switch(pe){case 0:case 125:J=0;case 59+z:se==-1&&(ke=Ao(ke,/\f/g,"")),G>0&&Ef(ke)-F&&Ub(G>32?q3(ke+";",u,a,F-1):q3(Ao(ke," ","")+";",u,a,F-2),C);break;case 59:ke+=";";default:if(Ub(Re=W3(ke,r,a,R,z,p,i,ve,Ne=[],_e=[],F),y),pe===123)if(z===0)sw(ke,r,Re,Re,Ne,y,F,i,_e);else switch(V===99&&tc(ke,3)===110?100:V){case 100:case 108:case 109:case 115:sw(e,Re,Re,u&&Ub(W3(e,Re,Re,0,0,p,i,ve,p,Ne=[],F),_e),p,_e,F,i,u?Ne:_e);break;default:sw(ke,Re,Re,Re,[""],_e,0,i,_e)}}R=z=G=0,Z=se=1,ve=ke="",F=x;break;case 58:F=1+Ef(ke),G=H;default:if(Z<1){if(pe==123)--Z;else if(pe==125&&Z++==0&&Cce()==125)continue}switch(ke+=tS(pe),pe*Z){case 38:se=z>0?1:(ke+="\f",-1);break;case 44:i[R++]=(Ef(ke)-1)*se,se=1;break;case 64:Df()===45&&(ke+=ow(Ju())),V=Df(),z=F=Ef(ve=ke+=Oce(iw())),pe++;break;case 45:H===45&&Ef(ke)==2&&(Z=0)}}return y}function W3(e,r,a,u,p,y,x,i,C,R,z){for(var F=p-1,V=p===0?y:[""],G=HD(V),H=0,Z=0,J=0;H<u;++H)for(var se=0,pe=Z0(e,F+1,F=Sce(Z=x[H])),ve=e;se<G;++se)(ve=w8(Z>0?V[se]+" "+pe:Ao(pe,/&\f/g,V[se])))&&(C[J++]=ve);return nS(e,r,a,p===0?qD:i,C,R,z)}function zce(e,r,a){return nS(e,r,a,x8,tS(Mce()),Z0(e,2,-2),0)}function q3(e,r,a,u){return nS(e,r,a,GD,Z0(e,0,u),Z0(e,u+1,-1),u)}function Iy(e,r){for(var a="",u=HD(e),p=0;p<u;p++)a+=r(e[p],p,e,r)||"";return a}function Fce(e,r,a,u){switch(e.type){case wce:if(e.children.length)break;case bce:case GD:return e.return=e.return||e.value;case x8:return"";case b8:return e.return=e.value+"{"+Iy(e.children,u)+"}";case qD:e.value=e.props.join(",")}return Ef(a=Iy(e.children,u))?e.return=e.value+"{"+a+"}":""}function kce(e){var r=HD(e);return function(a,u,p,y){for(var x="",i=0;i<r;i++)x+=e[i](a,u,p,y)||"";return x}}function Bce(e){return function(r){r.root||(r=r.return)&&e(r)}}var G3=function(r){var a=new WeakMap;return function(u){if(a.has(u))return a.get(u);var p=r(u);return a.set(u,p),p}};function P8(e){var r=Object.create(null);return function(a){return r[a]===void 0&&(r[a]=e(a)),r[a]}}var jce=function(r,a,u){for(var p=0,y=0;p=y,y=Df(),p===38&&y===12&&(a[u]=1),!X0(y);)Ju();return bx(r,Pu)},Nce=function(r,a){var u=-1,p=44;do switch(X0(p)){case 0:p===38&&Df()===12&&(a[u]=1),r[u]+=jce(Pu-1,a,u);break;case 2:r[u]+=ow(p);break;case 4:if(p===44){r[++u]=Df()===58?"&\f":"",a[u]=r[u].length;break}default:r[u]+=tS(p)}while(p=Ju());return r},Vce=function(r,a){return E8(Nce(T8(r),a))},H3=new WeakMap,Uce=function(r){if(!(r.type!=="rule"||!r.parent||r.length<1)){for(var a=r.value,u=r.parent,p=r.column===u.column&&r.line===u.line;u.type!=="rule";)if(u=u.parent,!u)return;if(!(r.props.length===1&&a.charCodeAt(0)!==58&&!H3.get(u))&&!p){H3.set(r,!0);for(var y=[],x=Vce(a,y),i=u.props,C=0,R=0;C<x.length;C++)for(var z=0;z<i.length;z++,R++)r.props[R]=y[C]?x[C].replace(/&\f/g,i[z]):i[z]+" "+x[C]}}},$ce=function(r){if(r.type==="decl"){var a=r.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(r.return="",r.value="")}};function I8(e,r){switch(Ece(e,r)){case 5103:return Co+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Co+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Co+e+Ew+e+Ec+e+e;case 6828:case 4268:return Co+e+Ec+e+e;case 6165:return Co+e+Ec+"flex-"+e+e;case 5187:return Co+e+Ao(e,/(\w+).+(:[^]+)/,Co+"box-$1$2"+Ec+"flex-$1$2")+e;case 5443:return Co+e+Ec+"flex-item-"+Ao(e,/flex-|-self/,"")+e;case 4675:return Co+e+Ec+"flex-line-pack"+Ao(e,/align-content|flex-|-self/,"")+e;case 5548:return Co+e+Ec+Ao(e,"shrink","negative")+e;case 5292:return Co+e+Ec+Ao(e,"basis","preferred-size")+e;case 6060:return Co+"box-"+Ao(e,"-grow","")+Co+e+Ec+Ao(e,"grow","positive")+e;case 4554:return Co+Ao(e,/([^-])(transform)/g,"$1"+Co+"$2")+e;case 6187:return Ao(Ao(Ao(e,/(zoom-|grab)/,Co+"$1"),/(image-set)/,Co+"$1"),e,"")+e;case 5495:case 3959:return Ao(e,/(image-set\([^]*)/,Co+"$1$`$1");case 4968:return Ao(Ao(e,/(.+:)(flex-)?(.*)/,Co+"box-pack:$3"+Ec+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Co+e+e;case 4095:case 3583:case 4068:case 2532:return Ao(e,/(.+)-inline(.+)/,Co+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ef(e)-1-r>6)switch(tc(e,r+1)){case 109:if(tc(e,r+4)!==45)break;case 102:return Ao(e,/(.+:)(.+)-([^]+)/,"$1"+Co+"$2-$3$1"+Ew+(tc(e,r+3)==108?"$3":"$2-$3"))+e;case 115:return~PA(e,"stretch")?I8(Ao(e,"stretch","fill-available"),r)+e:e}break;case 4949:if(tc(e,r+1)!==115)break;case 6444:switch(tc(e,Ef(e)-3-(~PA(e,"!important")&&10))){case 107:return Ao(e,":",":"+Co)+e;case 101:return Ao(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Co+(tc(e,14)===45?"inline-":"")+"box$3$1"+Co+"$2$3$1"+Ec+"$2box$3")+e}break;case 5936:switch(tc(e,r+11)){case 114:return Co+e+Ec+Ao(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Co+e+Ec+Ao(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Co+e+Ec+Ao(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Co+e+Ec+e+e}return e}var Wce=function(r,a,u,p){if(r.length>-1&&!r.return)switch(r.type){case GD:r.return=I8(r.value,r.length);break;case b8:return Iy([e0(r,{value:Ao(r.value,"@","@"+Co)})],p);case qD:if(r.length)return Ice(r.props,function(y){switch(Pce(y,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Iy([e0(r,{props:[Ao(y,/:(read-\w+)/,":"+Ew+"$1")]})],p);case"::placeholder":return Iy([e0(r,{props:[Ao(y,/:(plac\w+)/,":"+Co+"input-$1")]}),e0(r,{props:[Ao(y,/:(plac\w+)/,":"+Ew+"$1")]}),e0(r,{props:[Ao(y,/:(plac\w+)/,Ec+"input-$1")]})],p)}return""})}},qce=[Wce],Gce=function(r){var a=r.key;if(a==="css"){var u=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(u,function(Z){var J=Z.getAttribute("data-emotion");J.indexOf(" ")!==-1&&(document.head.appendChild(Z),Z.setAttribute("data-s",""))})}var p=r.stylisPlugins||qce,y={},x,i=[];x=r.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(Z){for(var J=Z.getAttribute("data-emotion").split(" "),se=1;se<J.length;se++)y[J[se]]=!0;i.push(Z)});var C,R=[Uce,$ce];{var z,F=[Fce,Bce(function(Z){z.insert(Z)})],V=kce(R.concat(p,F)),G=function(J){return Iy(Lce(J),V)};C=function(J,se,pe,ve){z=pe,G(J?J+"{"+se.styles+"}":se.styles),ve&&(H.inserted[se.name]=!0)}}var H={key:a,sheet:new xce({key:a,container:x,nonce:r.nonce,speedy:r.speedy,prepend:r.prepend,insertionPoint:r.insertionPoint}),nonce:r.nonce,inserted:y,registered:{},insert:C};return H.sheet.hydrate(i),H};function o_(){return o_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var u in a)({}).hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},o_.apply(null,arguments)}var S2={exports:{}},Fo={};var Y3;function Hce(){if(Y3)return Fo;Y3=1;var e=typeof Symbol=="function"&&Symbol.for,r=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,u=e?Symbol.for("react.fragment"):60107,p=e?Symbol.for("react.strict_mode"):60108,y=e?Symbol.for("react.profiler"):60114,x=e?Symbol.for("react.provider"):60109,i=e?Symbol.for("react.context"):60110,C=e?Symbol.for("react.async_mode"):60111,R=e?Symbol.for("react.concurrent_mode"):60111,z=e?Symbol.for("react.forward_ref"):60112,F=e?Symbol.for("react.suspense"):60113,V=e?Symbol.for("react.suspense_list"):60120,G=e?Symbol.for("react.memo"):60115,H=e?Symbol.for("react.lazy"):60116,Z=e?Symbol.for("react.block"):60121,J=e?Symbol.for("react.fundamental"):60117,se=e?Symbol.for("react.responder"):60118,pe=e?Symbol.for("react.scope"):60119;function ve(_e){if(typeof _e=="object"&&_e!==null){var Re=_e.$$typeof;switch(Re){case r:switch(_e=_e.type,_e){case C:case R:case u:case y:case p:case F:return _e;default:switch(_e=_e&&_e.$$typeof,_e){case i:case z:case H:case G:case x:return _e;default:return Re}}case a:return Re}}}function Ne(_e){return ve(_e)===R}return Fo.AsyncMode=C,Fo.ConcurrentMode=R,Fo.ContextConsumer=i,Fo.ContextProvider=x,Fo.Element=r,Fo.ForwardRef=z,Fo.Fragment=u,Fo.Lazy=H,Fo.Memo=G,Fo.Portal=a,Fo.Profiler=y,Fo.StrictMode=p,Fo.Suspense=F,Fo.isAsyncMode=function(_e){return Ne(_e)||ve(_e)===C},Fo.isConcurrentMode=Ne,Fo.isContextConsumer=function(_e){return ve(_e)===i},Fo.isContextProvider=function(_e){return ve(_e)===x},Fo.isElement=function(_e){return typeof _e=="object"&&_e!==null&&_e.$$typeof===r},Fo.isForwardRef=function(_e){return ve(_e)===z},Fo.isFragment=function(_e){return ve(_e)===u},Fo.isLazy=function(_e){return ve(_e)===H},Fo.isMemo=function(_e){return ve(_e)===G},Fo.isPortal=function(_e){return ve(_e)===a},Fo.isProfiler=function(_e){return ve(_e)===y},Fo.isStrictMode=function(_e){return ve(_e)===p},Fo.isSuspense=function(_e){return ve(_e)===F},Fo.isValidElementType=function(_e){return typeof _e=="string"||typeof _e=="function"||_e===u||_e===R||_e===y||_e===p||_e===F||_e===V||typeof _e=="object"&&_e!==null&&(_e.$$typeof===H||_e.$$typeof===G||_e.$$typeof===x||_e.$$typeof===i||_e.$$typeof===z||_e.$$typeof===J||_e.$$typeof===se||_e.$$typeof===pe||_e.$$typeof===Z)},Fo.typeOf=ve,Fo}var Z3;function Yce(){return Z3||(Z3=1,S2.exports=Hce()),S2.exports}var T2,X3;function Zce(){if(X3)return T2;X3=1;var e=Yce(),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},u={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},p={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},y={};y[e.ForwardRef]=u,y[e.Memo]=p;function x(H){return e.isMemo(H)?p:y[H.$$typeof]||r}var i=Object.defineProperty,C=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,z=Object.getOwnPropertyDescriptor,F=Object.getPrototypeOf,V=Object.prototype;function G(H,Z,J){if(typeof Z!="string"){if(V){var se=F(Z);se&&se!==V&&G(H,se,J)}var pe=C(Z);R&&(pe=pe.concat(R(Z)));for(var ve=x(H),Ne=x(Z),_e=0;_e<pe.length;++_e){var Re=pe[_e];if(!a[Re]&&!(J&&J[Re])&&!(Ne&&Ne[Re])&&!(ve&&ve[Re])){var ke=z(Z,Re);try{i(H,Re,ke)}catch{}}}}return H}return T2=G,T2}Zce();var Xce=!0;function M8(e,r,a){var u="";return a.split(" ").forEach(function(p){e[p]!==void 0?r.push(e[p]+";"):p&&(u+=p+" ")}),u}var YD=function(r,a,u){var p=r.key+"-"+a.name;(u===!1||Xce===!1)&&r.registered[p]===void 0&&(r.registered[p]=a.styles)},ZD=function(r,a,u){YD(r,a,u);var p=r.key+"-"+a.name;if(r.inserted[a.name]===void 0){var y=a;do r.insert(a===y?"."+p:"",y,r.sheet,!0),y=y.next;while(y!==void 0)}};function Kce(e){for(var r=0,a,u=0,p=e.length;p>=4;++u,p-=4)a=e.charCodeAt(u)&255|(e.charCodeAt(++u)&255)<<8|(e.charCodeAt(++u)&255)<<16|(e.charCodeAt(++u)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,r=(a&65535)*1540483477+((a>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(p){case 3:r^=(e.charCodeAt(u+2)&255)<<16;case 2:r^=(e.charCodeAt(u+1)&255)<<8;case 1:r^=e.charCodeAt(u)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var Qce={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Jce=/[A-Z]|^ms/g,eue=/_EMO_([^_]+?)_([^]*?)_EMO_/g,C8=function(r){return r.charCodeAt(1)===45},K3=function(r){return r!=null&&typeof r!="boolean"},E2=P8(function(e){return C8(e)?e:e.replace(Jce,"-$&").toLowerCase()}),Q3=function(r,a){switch(r){case"animation":case"animationName":if(typeof a=="string")return a.replace(eue,function(u,p,y){return Pf={name:p,styles:y,next:Pf},p})}return Qce[r]!==1&&!C8(r)&&typeof a=="number"&&a!==0?a+"px":a};function K0(e,r,a){if(a==null)return"";var u=a;if(u.__emotion_styles!==void 0)return u;switch(typeof a){case"boolean":return"";case"object":{var p=a;if(p.anim===1)return Pf={name:p.name,styles:p.styles,next:Pf},p.name;var y=a;if(y.styles!==void 0){var x=y.next;if(x!==void 0)for(;x!==void 0;)Pf={name:x.name,styles:x.styles,next:Pf},x=x.next;var i=y.styles+";";return i}return tue(e,r,a)}case"function":{if(e!==void 0){var C=Pf,R=a(e);return Pf=C,K0(e,r,R)}break}}var z=a;if(r==null)return z;var F=r[z];return F!==void 0?F:z}function tue(e,r,a){var u="";if(Array.isArray(a))for(var p=0;p<a.length;p++)u+=K0(e,r,a[p])+";";else for(var y in a){var x=a[y];if(typeof x!="object"){var i=x;r!=null&&r[i]!==void 0?u+=y+"{"+r[i]+"}":K3(i)&&(u+=E2(y)+":"+Q3(y,i)+";")}else if(Array.isArray(x)&&typeof x[0]=="string"&&(r==null||r[x[0]]===void 0))for(var C=0;C<x.length;C++)K3(x[C])&&(u+=E2(y)+":"+Q3(y,x[C])+";");else{var R=K0(e,r,x);switch(y){case"animation":case"animationName":{u+=E2(y)+":"+R+";";break}default:u+=y+"{"+R+"}"}}}return u}var J3=/label:\s*([^\s;{]+)\s*(;|$)/g,Pf;function iS(e,r,a){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var u=!0,p="";Pf=void 0;var y=e[0];if(y==null||y.raw===void 0)u=!1,p+=K0(a,r,y);else{var x=y;p+=x[0]}for(var i=1;i<e.length;i++)if(p+=K0(a,r,e[i]),u){var C=y;p+=C[i]}J3.lastIndex=0;for(var R="",z;(z=J3.exec(p))!==null;)R+="-"+z[1];var F=Kce(p)+R;return{name:F,styles:p,next:Pf}}var rue=function(r){return r()},A8=sA.useInsertionEffect?sA.useInsertionEffect:!1,D8=A8||rue,eB=A8||ge.useLayoutEffect,XD=ge.createContext(typeof HTMLElement<"u"?Gce({key:"css"}):null);XD.Provider;var nue=function(){return ge.useContext(XD)},KD=function(r){return ge.forwardRef(function(a,u){var p=ge.useContext(XD);return r(a,p,u)})},Fy=ge.createContext({}),iue=function(r,a){if(typeof a=="function"){var u=a(r);return u}return o_({},r,a)},oue=G3(function(e){return G3(function(r){return iue(e,r)})}),sue=function(r){var a=ge.useContext(Fy);return r.theme!==a&&(a=oue(a)(r.theme)),ge.createElement(Fy.Provider,{value:a},r.children)},QD={}.hasOwnProperty,MA="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",aue=function(r,a){var u={};for(var p in a)QD.call(a,p)&&(u[p]=a[p]);return u[MA]=r,u},lue=function(r){var a=r.cache,u=r.serialized,p=r.isStringTag;return YD(a,u,p),D8(function(){return ZD(a,u,p)}),null},cue=KD(function(e,r,a){var u=e.css;typeof u=="string"&&r.registered[u]!==void 0&&(u=r.registered[u]);var p=e[MA],y=[u],x="";typeof e.className=="string"?x=M8(r.registered,y,e.className):e.className!=null&&(x=e.className+" ");var i=iS(y,void 0,ge.useContext(Fy));x+=r.key+"-"+i.name;var C={};for(var R in e)QD.call(e,R)&&R!=="css"&&R!==MA&&(C[R]=e[R]);return C.className=x,a&&(C.ref=a),ge.createElement(ge.Fragment,null,ge.createElement(lue,{cache:r,serialized:i,isStringTag:typeof p=="string"}),ge.createElement(p,C))}),uue=cue,tB=function(r,a){var u=arguments;if(a==null||!QD.call(a,"css"))return ge.createElement.apply(void 0,u);var p=u.length,y=new Array(p);y[0]=uue,y[1]=aue(r,a);for(var x=2;x<p;x++)y[x]=u[x];return ge.createElement.apply(null,y)};(function(e){var r;r||(r=e.JSX||(e.JSX={}))})(tB||(tB={}));var oS=KD(function(e,r){var a=e.styles,u=iS([a],void 0,ge.useContext(Fy)),p=ge.useRef();return eB(function(){var y=r.key+"-global",x=new r.sheet.constructor({key:y,nonce:r.sheet.nonce,container:r.sheet.container,speedy:r.sheet.isSpeedy}),i=!1,C=document.querySelector('style[data-emotion="'+y+" "+u.name+'"]');return r.sheet.tags.length&&(x.before=r.sheet.tags[0]),C!==null&&(i=!0,C.setAttribute("data-emotion",y),x.hydrate([C])),p.current=[x,i],function(){x.flush()}},[r]),eB(function(){var y=p.current,x=y[0],i=y[1];if(i){y[1]=!1;return}if(u.next!==void 0&&ZD(r,u.next,!0),x.tags.length){var C=x.tags[x.tags.length-1].nextElementSibling;x.before=C,x.flush()}r.insert("",u,x,!1)},[r,u.name]),null});function due(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return iS(r)}function hue(){var e=due.apply(void 0,arguments),r="animation-"+e.name;return{name:r,styles:"@keyframes "+r+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}const sS=ge.createContext({});sS.displayName="ColorModeContext";function aS(){const e=ge.useContext(sS);if(e===void 0)throw new Error("useColorMode must be used within a ColorModeProvider");return e}function Ih(e,r){const{colorMode:a}=aS();return a==="dark"?r:e}const $b={light:"chakra-ui-light",dark:"chakra-ui-dark"};function fue(e={}){const{preventTransition:r=!0,nonce:a}=e,u={setDataset:p=>{const y=r?u.preventTransition():void 0;document.documentElement.dataset.theme=p,document.documentElement.style.colorScheme=p,y?.()},setClassName(p){document.body.classList.add(p?$b.dark:$b.light),document.body.classList.remove(p?$b.light:$b.dark)},query(){return window.matchMedia("(prefers-color-scheme: dark)")},getSystemTheme(p){return u.query().matches??p==="dark"?"dark":"light"},addListener(p){const y=u.query(),x=i=>{p(i.matches?"dark":"light")};return typeof y.addListener=="function"?y.addListener(x):y.addEventListener("change",x),()=>{typeof y.removeListener=="function"?y.removeListener(x):y.removeEventListener("change",x)}},preventTransition(){const p=document.createElement("style");return p.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),a!==void 0&&(p.nonce=a),document.head.appendChild(p),()=>{window.getComputedStyle(document.body),requestAnimationFrame(()=>{requestAnimationFrame(()=>{document.head.removeChild(p)})})}}};return u}const pue="chakra-ui-color-mode";function mue(e){return{ssr:!1,type:"localStorage",get(r){if(!globalThis?.document)return r;let a;try{a=localStorage.getItem(e)||r}catch{}return a||r},set(r){try{localStorage.setItem(e,r)}catch{}}}}const gue=mue(pue),rB=()=>{},_ue=Ete()?ge.useLayoutEffect:ge.useEffect;function nB(e,r){return e.type==="cookie"&&e.ssr?e.get(r):r}const R8=function(r){const{value:a,children:u,options:{useSystemColorMode:p,initialColorMode:y,disableTransitionOnChange:x}={},colorModeManager:i=gue}=r,C=nue(),R=y==="dark"?"dark":"light",[z,F]=ge.useState(()=>nB(i,R)),[V,G]=ge.useState(()=>nB(i)),{getSystemTheme:H,setClassName:Z,setDataset:J,addListener:se}=ge.useMemo(()=>fue({preventTransition:x,nonce:C?.nonce}),[x,C?.nonce]),pe=y==="system"&&!z?V:z,ve=ge.useCallback(Re=>{const ke=Re==="system"?H():Re;F(ke),Z(ke==="dark"),J(ke),i.set(ke)},[i,H,Z,J]);_ue(()=>{y==="system"&&G(H())},[]),ge.useEffect(()=>{const Re=i.get();if(Re){ve(Re);return}if(y==="system"){ve("system");return}ve(R)},[i,R,y,ve]);const Ne=ge.useCallback(()=>{ve(pe==="dark"?"light":"dark")},[pe,ve]);ge.useEffect(()=>{if(p)return se(ve)},[p,se,ve]);const _e=ge.useMemo(()=>({colorMode:a??pe,toggleColorMode:a?rB:Ne,setColorMode:a?rB:ve,forced:a!==void 0}),[pe,Ne,ve,a]);return X.jsx(sS.Provider,{value:_e,children:u})};R8.displayName="ColorModeProvider";const O8=String.raw,L8=O8`
  :root,
  :host {
    --chakra-vh: 100vh;
  }

  @supports (height: -webkit-fill-available) {
    :root,
    :host {
      --chakra-vh: -webkit-fill-available;
    }
  }

  @supports (height: -moz-fill-available) {
    :root,
    :host {
      --chakra-vh: -moz-fill-available;
    }
  }

  @supports (height: 100dvh) {
    :root,
    :host {
      --chakra-vh: 100dvh;
    }
  }
`,yue=()=>X.jsx(oS,{styles:L8}),vue=({scope:e=""})=>X.jsx(oS,{styles:O8`
      html {
        line-height: 1.5;
        -webkit-text-size-adjust: 100%;
        font-family: system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
        -moz-osx-font-smoothing: grayscale;
        touch-action: manipulation;
      }

      body {
        position: relative;
        min-height: 100%;
        margin: 0;
        font-feature-settings: "kern";
      }

      ${e} :where(*, *::before, *::after) {
        border-width: 0;
        border-style: solid;
        box-sizing: border-box;
        word-wrap: break-word;
      }

      main {
        display: block;
      }

      ${e} hr {
        border-top-width: 1px;
        box-sizing: content-box;
        height: 0;
        overflow: visible;
      }

      ${e} :where(pre, code, kbd,samp) {
        font-family: SFMono-Regular, Menlo, Monaco, Consolas, monospace;
        font-size: 1em;
      }

      ${e} a {
        background-color: transparent;
        color: inherit;
        text-decoration: inherit;
      }

      ${e} abbr[title] {
        border-bottom: none;
        text-decoration: underline;
        -webkit-text-decoration: underline dotted;
        text-decoration: underline dotted;
      }

      ${e} :where(b, strong) {
        font-weight: bold;
      }

      ${e} small {
        font-size: 80%;
      }

      ${e} :where(sub,sup) {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
      }

      ${e} sub {
        bottom: -0.25em;
      }

      ${e} sup {
        top: -0.5em;
      }

      ${e} img {
        border-style: none;
      }

      ${e} :where(button, input, optgroup, select, textarea) {
        font-family: inherit;
        font-size: 100%;
        line-height: 1.15;
        margin: 0;
      }

      ${e} :where(button, input) {
        overflow: visible;
      }

      ${e} :where(button, select) {
        text-transform: none;
      }

      ${e} :where(
          button::-moz-focus-inner,
          [type="button"]::-moz-focus-inner,
          [type="reset"]::-moz-focus-inner,
          [type="submit"]::-moz-focus-inner
        ) {
        border-style: none;
        padding: 0;
      }

      ${e} fieldset {
        padding: 0.35em 0.75em 0.625em;
      }

      ${e} legend {
        box-sizing: border-box;
        color: inherit;
        display: table;
        max-width: 100%;
        padding: 0;
        white-space: normal;
      }

      ${e} progress {
        vertical-align: baseline;
      }

      ${e} textarea {
        overflow: auto;
      }

      ${e} :where([type="checkbox"], [type="radio"]) {
        box-sizing: border-box;
        padding: 0;
      }

      ${e} input[type="number"]::-webkit-inner-spin-button,
      ${e} input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none !important;
      }

      ${e} input[type="number"] {
        -moz-appearance: textfield;
      }

      ${e} input[type="search"] {
        -webkit-appearance: textfield;
        outline-offset: -2px;
      }

      ${e} input[type="search"]::-webkit-search-decoration {
        -webkit-appearance: none !important;
      }

      ${e} ::-webkit-file-upload-button {
        -webkit-appearance: button;
        font: inherit;
      }

      ${e} details {
        display: block;
      }

      ${e} summary {
        display: list-item;
      }

      template {
        display: none;
      }

      [hidden] {
        display: none !important;
      }

      ${e} :where(
          blockquote,
          dl,
          dd,
          h1,
          h2,
          h3,
          h4,
          h5,
          h6,
          hr,
          figure,
          p,
          pre
        ) {
        margin: 0;
      }

      ${e} button {
        background: transparent;
        padding: 0;
      }

      ${e} fieldset {
        margin: 0;
        padding: 0;
      }

      ${e} :where(ol, ul) {
        margin: 0;
        padding: 0;
      }

      ${e} textarea {
        resize: vertical;
      }

      ${e} :where(button, [role="button"]) {
        cursor: pointer;
      }

      ${e} button::-moz-focus-inner {
        border: 0 !important;
      }

      ${e} table {
        border-collapse: collapse;
      }

      ${e} :where(h1, h2, h3, h4, h5, h6) {
        font-size: inherit;
        font-weight: inherit;
      }

      ${e} :where(button, input, optgroup, select, textarea) {
        padding: 0;
        line-height: inherit;
        color: inherit;
      }

      ${e} :where(img, svg, video, canvas, audio, iframe, embed, object) {
        display: block;
      }

      ${e} :where(img, video) {
        max-width: 100%;
        height: auto;
      }

      [data-js-focus-visible]
        :focus:not([data-focus-visible-added]):not(
          [data-focus-visible-disabled]
        ) {
        outline: none;
        box-shadow: none;
      }

      ${e} select::-ms-expand {
        display: none;
      }

      ${L8}
    `});function z8(e){const{cssVarsRoot:r,theme:a,children:u}=e,p=ge.useMemo(()=>ane(a),[a]);return X.jsxs(sue,{theme:p,children:[X.jsx(xue,{root:r}),u]})}function xue({root:e=":host, :root"}){const r=[e,"[data-theme]"].join(",");return X.jsx(oS,{styles:a=>({[r]:a.__cssVars})})}Pl({name:"StylesContext",errorMessage:"useStyles: `styles` is undefined. Seems you forgot to wrap the components in `<StylesProvider />` "});function bue(){const{colorMode:e}=aS();return X.jsx(oS,{styles:r=>{const a=KW(r,"styles.global"),u=Cd(a,{theme:r,colorMode:e});return u?i8(u)(r):void 0}})}const[wue,Sue]=Pl({strict:!1,name:"PortalManagerContext"});function F8(e){const{children:r,zIndex:a}=e;return X.jsx(wue,{value:{zIndex:a},children:r})}F8.displayName="PortalManager";const k8=ge.createContext({getDocument(){return document},getWindow(){return window}});k8.displayName="EnvironmentContext";function B8(e){const{children:r,environment:a,disabled:u}=e,p=ge.useRef(null),y=ge.useMemo(()=>a||{getDocument:()=>p.current?.ownerDocument??document,getWindow:()=>p.current?.ownerDocument.defaultView??window},[a]),x=!u||!a;return X.jsxs(k8.Provider,{value:y,children:[r,x&&X.jsx("span",{id:"__chakra_env",hidden:!0,ref:p})]})}B8.displayName="EnvironmentProvider";const Tue=e=>{const{children:r,colorModeManager:a,portalZIndex:u,resetScope:p,resetCSS:y=!0,theme:x={},environment:i,cssVarsRoot:C,disableEnvironment:R,disableGlobalStyle:z}=e,F=X.jsx(B8,{environment:i,disabled:R,children:r});return X.jsx(z8,{theme:x,cssVarsRoot:C,children:X.jsxs(R8,{colorModeManager:a,options:x.config,children:[y?X.jsx(vue,{scope:p}):X.jsx(yue,{}),!z&&X.jsx(bue,{}),u?X.jsx(F8,{zIndex:u,children:F}):F]})})},JD=ge.createContext({});function eR(e){const r=ge.useRef(null);return r.current===null&&(r.current=e()),r.current}const wx=ge.createContext(null),tR=ge.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Eue extends ge.Component{getSnapshotBeforeUpdate(r){const a=this.props.childRef.current;if(a&&r.isPresent&&!this.props.isPresent){const u=this.props.sizeRef.current;u.height=a.offsetHeight||0,u.width=a.offsetWidth||0,u.top=a.offsetTop,u.left=a.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Pue({children:e,isPresent:r}){const a=ge.useId(),u=ge.useRef(null),p=ge.useRef({width:0,height:0,top:0,left:0}),{nonce:y}=ge.useContext(tR);return ge.useInsertionEffect(()=>{const{width:x,height:i,top:C,left:R}=p.current;if(r||!u.current||!x||!i)return;u.current.dataset.motionPopId=a;const z=document.createElement("style");return y&&(z.nonce=y),document.head.appendChild(z),z.sheet&&z.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${x}px !important;
            height: ${i}px !important;
            top: ${C}px !important;
            left: ${R}px !important;
          }
        `),()=>{document.head.removeChild(z)}},[r]),X.jsx(Eue,{isPresent:r,childRef:u,sizeRef:p,children:ge.cloneElement(e,{ref:u})})}const Iue=({children:e,initial:r,isPresent:a,onExitComplete:u,custom:p,presenceAffectsLayout:y,mode:x})=>{const i=eR(Mue),C=ge.useId(),R=ge.useCallback(F=>{i.set(F,!0);for(const V of i.values())if(!V)return;u&&u()},[i,u]),z=ge.useMemo(()=>({id:C,initial:r,isPresent:a,custom:p,onExitComplete:R,register:F=>(i.set(F,!1),()=>i.delete(F))}),y?[Math.random(),R]:[a,R]);return ge.useMemo(()=>{i.forEach((F,V)=>i.set(V,!1))},[a]),ge.useEffect(()=>{!a&&!i.size&&u&&u()},[a]),x==="popLayout"&&(e=X.jsx(Pue,{isPresent:a,children:e})),X.jsx(wx.Provider,{value:z,children:e})};function Mue(){return new Map}function rR(e=!0){const r=ge.useContext(wx);if(r===null)return[!0,null];const{isPresent:a,onExitComplete:u,register:p}=r,y=ge.useId();ge.useEffect(()=>{e&&p(y)},[e]);const x=ge.useCallback(()=>e&&u&&u(y),[y,u,e]);return!a&&u?[!1,x]:[!0]}function Cue(){return Aue(ge.useContext(wx))}function Aue(e){return e===null?!0:e.isPresent}const Wb=e=>e.key||"";function iB(e){const r=[];return ge.Children.forEach(e,a=>{ge.isValidElement(a)&&r.push(a)}),r}const nR=typeof window<"u",j8=nR?ge.useLayoutEffect:ge.useEffect,Sx=({children:e,custom:r,initial:a=!0,onExitComplete:u,presenceAffectsLayout:p=!0,mode:y="sync",propagate:x=!1})=>{const[i,C]=rR(x),R=ge.useMemo(()=>iB(e),[e]),z=x&&!i?[]:R.map(Wb),F=ge.useRef(!0),V=ge.useRef(R),G=eR(()=>new Map),[H,Z]=ge.useState(R),[J,se]=ge.useState(R);j8(()=>{F.current=!1,V.current=R;for(let Ne=0;Ne<J.length;Ne++){const _e=Wb(J[Ne]);z.includes(_e)?G.delete(_e):G.get(_e)!==!0&&G.set(_e,!1)}},[J,z.length,z.join("-")]);const pe=[];if(R!==H){let Ne=[...R];for(let _e=0;_e<J.length;_e++){const Re=J[_e],ke=Wb(Re);z.includes(ke)||(Ne.splice(_e,0,Re),pe.push(Re))}y==="wait"&&pe.length&&(Ne=pe),se(iB(Ne)),Z(R);return}const{forceRender:ve}=ge.useContext(JD);return X.jsx(X.Fragment,{children:J.map(Ne=>{const _e=Wb(Ne),Re=x&&!i?!1:R===J||z.includes(_e),ke=()=>{if(G.has(_e))G.set(_e,!0);else return;let ze=!0;G.forEach(et=>{et||(ze=!1)}),ze&&(ve?.(),se(V.current),x&&C?.(),u&&u())};return X.jsx(Iue,{isPresent:Re,initial:!F.current||a?void 0:!1,custom:Re?void 0:r,presenceAffectsLayout:p,mode:y,onExitComplete:Re?void 0:ke,children:Ne},_e)})})},ed=e=>e;let N8=ed;function iR(e){let r;return()=>(r===void 0&&(r=e()),r)}const ky=(e,r,a)=>{const u=r-e;return u===0?1:(a-e)/u},Cp=e=>e*1e3,Ap=e=>e/1e3,Due={useManualTiming:!1};function Rue(e){let r=new Set,a=new Set,u=!1,p=!1;const y=new WeakSet;let x={delta:0,timestamp:0,isProcessing:!1};function i(R){y.has(R)&&(C.schedule(R),e()),R(x)}const C={schedule:(R,z=!1,F=!1)=>{const G=F&&u?r:a;return z&&y.add(R),G.has(R)||G.add(R),R},cancel:R=>{a.delete(R),y.delete(R)},process:R=>{if(x=R,u){p=!0;return}u=!0,[r,a]=[a,r],r.forEach(i),r.clear(),u=!1,p&&(p=!1,C.process(R))}};return C}const qb=["read","resolveKeyframes","update","preRender","render","postRender"],Oue=40;function V8(e,r){let a=!1,u=!0;const p={delta:0,timestamp:0,isProcessing:!1},y=()=>a=!0,x=qb.reduce((se,pe)=>(se[pe]=Rue(y),se),{}),{read:i,resolveKeyframes:C,update:R,preRender:z,render:F,postRender:V}=x,G=()=>{const se=performance.now();a=!1,p.delta=u?1e3/60:Math.max(Math.min(se-p.timestamp,Oue),1),p.timestamp=se,p.isProcessing=!0,i.process(p),C.process(p),R.process(p),z.process(p),F.process(p),V.process(p),p.isProcessing=!1,a&&r&&(u=!1,e(G))},H=()=>{a=!0,u=!0,p.isProcessing||e(G)};return{schedule:qb.reduce((se,pe)=>{const ve=x[pe];return se[pe]=(Ne,_e=!1,Re=!1)=>(a||H(),ve.schedule(Ne,_e,Re)),se},{}),cancel:se=>{for(let pe=0;pe<qb.length;pe++)x[qb[pe]].cancel(se)},state:p,steps:x}}const{schedule:Ts,cancel:Vm,state:Jl,steps:P2}=V8(typeof requestAnimationFrame<"u"?requestAnimationFrame:ed,!0),U8=ge.createContext({strict:!1}),oB={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},By={};for(const e in oB)By[e]={isEnabled:r=>oB[e].some(a=>!!r[a])};function Lue(e){for(const r in e)By[r]={...By[r],...e[r]}}const zue=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Pw(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||zue.has(e)}let $8=e=>!Pw(e);function Fue(e){e&&($8=r=>r.startsWith("on")?!Pw(r):e(r))}try{Fue(require("@emotion/is-prop-valid").default)}catch{}function kue(e,r,a){const u={};for(const p in e)p==="values"&&typeof e.values=="object"||($8(p)||a===!0&&Pw(p)||!r&&!Pw(p)||e.draggable&&p.startsWith("onDrag"))&&(u[p]=e[p]);return u}function Bue(e){if(typeof Proxy>"u")return e;const r=new Map,a=(...u)=>e(...u);return new Proxy(a,{get:(u,p)=>p==="create"?e:(r.has(p)||r.set(p,e(p)),r.get(p))})}const lS=ge.createContext({});function Q0(e){return typeof e=="string"||Array.isArray(e)}function cS(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const oR=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],sR=["initial",...oR];function uS(e){return cS(e.animate)||sR.some(r=>Q0(e[r]))}function W8(e){return!!(uS(e)||e.variants)}function jue(e,r){if(uS(e)){const{initial:a,animate:u}=e;return{initial:a===!1||Q0(a)?a:void 0,animate:Q0(u)?u:void 0}}return e.inherit!==!1?r:{}}function Nue(e){const{initial:r,animate:a}=jue(e,ge.useContext(lS));return ge.useMemo(()=>({initial:r,animate:a}),[sB(r),sB(a)])}function sB(e){return Array.isArray(e)?e.join(" "):e}const Vue=Symbol.for("motionComponentSymbol");function hy(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Uue(e,r,a){return ge.useCallback(u=>{u&&e.onMount&&e.onMount(u),r&&(u?r.mount(u):r.unmount()),a&&(typeof a=="function"?a(u):hy(a)&&(a.current=u))},[r])}const aR=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),$ue="framerAppearId",q8="data-"+aR($ue),{schedule:lR}=V8(queueMicrotask,!1),G8=ge.createContext({});function Wue(e,r,a,u,p){var y,x;const{visualElement:i}=ge.useContext(lS),C=ge.useContext(U8),R=ge.useContext(wx),z=ge.useContext(tR).reducedMotion,F=ge.useRef(null);u=u||C.renderer,!F.current&&u&&(F.current=u(e,{visualState:r,parent:i,props:a,presenceContext:R,blockInitialAnimation:R?R.initial===!1:!1,reducedMotionConfig:z}));const V=F.current,G=ge.useContext(G8);V&&!V.projection&&p&&(V.type==="html"||V.type==="svg")&&que(F.current,a,p,G);const H=ge.useRef(!1);ge.useInsertionEffect(()=>{V&&H.current&&V.update(a,R)});const Z=a[q8],J=ge.useRef(!!Z&&!(!((y=window.MotionHandoffIsComplete)===null||y===void 0)&&y.call(window,Z))&&((x=window.MotionHasOptimisedAnimation)===null||x===void 0?void 0:x.call(window,Z)));return j8(()=>{V&&(H.current=!0,window.MotionIsMounted=!0,V.updateFeatures(),lR.render(V.render),J.current&&V.animationState&&V.animationState.animateChanges())}),ge.useEffect(()=>{V&&(!J.current&&V.animationState&&V.animationState.animateChanges(),J.current&&(queueMicrotask(()=>{var se;(se=window.MotionHandoffMarkAsComplete)===null||se===void 0||se.call(window,Z)}),J.current=!1))}),V}function que(e,r,a,u){const{layoutId:p,layout:y,drag:x,dragConstraints:i,layoutScroll:C,layoutRoot:R}=r;e.projection=new a(e.latestValues,r["data-framer-portal-id"]?void 0:H8(e.parent)),e.projection.setOptions({layoutId:p,layout:y,alwaysMeasureLayout:!!x||i&&hy(i),visualElement:e,animationType:typeof y=="string"?y:"both",initialPromotionConfig:u,layoutScroll:C,layoutRoot:R})}function H8(e){if(e)return e.options.allowProjection!==!1?e.projection:H8(e.parent)}function Gue({preloadedFeatures:e,createVisualElement:r,useRender:a,useVisualState:u,Component:p}){var y,x;e&&Lue(e);function i(R,z){let F;const V={...ge.useContext(tR),...R,layoutId:Hue(R)},{isStatic:G}=V,H=Nue(R),Z=u(R,G);if(!G&&nR){Yue();const J=Zue(V);F=J.MeasureLayout,H.visualElement=Wue(p,Z,V,r,J.ProjectionNode)}return X.jsxs(lS.Provider,{value:H,children:[F&&H.visualElement?X.jsx(F,{visualElement:H.visualElement,...V}):null,a(p,R,Uue(Z,H.visualElement,z),Z,G,H.visualElement)]})}i.displayName=`motion.${typeof p=="string"?p:`create(${(x=(y=p.displayName)!==null&&y!==void 0?y:p.name)!==null&&x!==void 0?x:""})`}`;const C=ge.forwardRef(i);return C[Vue]=p,C}function Hue({layoutId:e}){const r=ge.useContext(JD).id;return r&&e!==void 0?r+"-"+e:e}function Yue(e,r){ge.useContext(U8).strict}function Zue(e){const{drag:r,layout:a}=By;if(!r&&!a)return{};const u={...r,...a};return{MeasureLayout:r?.isEnabled(e)||a?.isEnabled(e)?u.MeasureLayout:void 0,ProjectionNode:u.ProjectionNode}}const Xue=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function cR(e){return typeof e!="string"||e.includes("-")?!1:!!(Xue.indexOf(e)>-1||/[A-Z]/u.test(e))}function aB(e){const r=[{},{}];return e?.values.forEach((a,u)=>{r[0][u]=a.get(),r[1][u]=a.getVelocity()}),r}function uR(e,r,a,u){if(typeof r=="function"){const[p,y]=aB(u);r=r(a!==void 0?a:e.custom,p,y)}if(typeof r=="string"&&(r=e.variants&&e.variants[r]),typeof r=="function"){const[p,y]=aB(u);r=r(a!==void 0?a:e.custom,p,y)}return r}const CA=e=>Array.isArray(e),Kue=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),Que=e=>CA(e)?e[e.length-1]||0:e,Cc=e=>!!(e&&e.getVelocity);function aw(e){const r=Cc(e)?e.get():e;return Kue(r)?r.toValue():r}function Jue({scrapeMotionValuesFromProps:e,createRenderState:r,onUpdate:a},u,p,y){const x={latestValues:ede(u,p,y,e),renderState:r()};return a&&(x.onMount=i=>a({props:u,current:i,...x}),x.onUpdate=i=>a(i)),x}const Y8=e=>(r,a)=>{const u=ge.useContext(lS),p=ge.useContext(wx),y=()=>Jue(e,r,u,p);return a?y():eR(y)};function ede(e,r,a,u){const p={},y=u(e,{});for(const V in y)p[V]=aw(y[V]);let{initial:x,animate:i}=e;const C=uS(e),R=W8(e);r&&R&&!C&&e.inherit!==!1&&(x===void 0&&(x=r.initial),i===void 0&&(i=r.animate));let z=a?a.initial===!1:!1;z=z||x===!1;const F=z?i:x;if(F&&typeof F!="boolean"&&!cS(F)){const V=Array.isArray(F)?F:[F];for(let G=0;G<V.length;G++){const H=uR(e,V[G]);if(H){const{transitionEnd:Z,transition:J,...se}=H;for(const pe in se){let ve=se[pe];if(Array.isArray(ve)){const Ne=z?ve.length-1:0;ve=ve[Ne]}ve!==null&&(p[pe]=ve)}for(const pe in Z)p[pe]=Z[pe]}}}return p}const Zy=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],d_=new Set(Zy),Z8=e=>r=>typeof r=="string"&&r.startsWith(e),X8=Z8("--"),tde=Z8("var(--"),dR=e=>tde(e)?rde.test(e.split("/*")[0].trim()):!1,rde=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,K8=(e,r)=>r&&typeof e=="number"?r.transform(e):e,Rp=(e,r,a)=>a>r?r:a<e?e:a,Xy={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},J0={...Xy,transform:e=>Rp(0,1,e)},Gb={...Xy,default:1},Tx=e=>({test:r=>typeof r=="string"&&r.endsWith(e)&&r.split(" ").length===1,parse:parseFloat,transform:r=>`${r}${e}`}),Om=Tx("deg"),Rf=Tx("%"),ni=Tx("px"),nde=Tx("vh"),ide=Tx("vw"),lB={...Rf,parse:e=>Rf.parse(e)/100,transform:e=>Rf.transform(e*100)},ode={borderWidth:ni,borderTopWidth:ni,borderRightWidth:ni,borderBottomWidth:ni,borderLeftWidth:ni,borderRadius:ni,radius:ni,borderTopLeftRadius:ni,borderTopRightRadius:ni,borderBottomRightRadius:ni,borderBottomLeftRadius:ni,width:ni,maxWidth:ni,height:ni,maxHeight:ni,top:ni,right:ni,bottom:ni,left:ni,padding:ni,paddingTop:ni,paddingRight:ni,paddingBottom:ni,paddingLeft:ni,margin:ni,marginTop:ni,marginRight:ni,marginBottom:ni,marginLeft:ni,backgroundPositionX:ni,backgroundPositionY:ni},sde={rotate:Om,rotateX:Om,rotateY:Om,rotateZ:Om,scale:Gb,scaleX:Gb,scaleY:Gb,scaleZ:Gb,skew:Om,skewX:Om,skewY:Om,distance:ni,translateX:ni,translateY:ni,translateZ:ni,x:ni,y:ni,z:ni,perspective:ni,transformPerspective:ni,opacity:J0,originX:lB,originY:lB,originZ:ni},cB={...Xy,transform:Math.round},hR={...ode,...sde,zIndex:cB,size:ni,fillOpacity:J0,strokeOpacity:J0,numOctaves:cB},ade={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lde=Zy.length;function cde(e,r,a){let u="",p=!0;for(let y=0;y<lde;y++){const x=Zy[y],i=e[x];if(i===void 0)continue;let C=!0;if(typeof i=="number"?C=i===(x.startsWith("scale")?1:0):C=parseFloat(i)===0,!C||a){const R=K8(i,hR[x]);if(!C){p=!1;const z=ade[x]||x;u+=`${z}(${R}) `}a&&(r[x]=R)}}return u=u.trim(),a?u=a(r,p?"":u):p&&(u="none"),u}function fR(e,r,a){const{style:u,vars:p,transformOrigin:y}=e;let x=!1,i=!1;for(const C in r){const R=r[C];if(d_.has(C)){x=!0;continue}else if(X8(C)){p[C]=R;continue}else{const z=K8(R,hR[C]);C.startsWith("origin")?(i=!0,y[C]=z):u[C]=z}}if(r.transform||(x||a?u.transform=cde(r,e.transform,a):u.transform&&(u.transform="none")),i){const{originX:C="50%",originY:R="50%",originZ:z=0}=y;u.transformOrigin=`${C} ${R} ${z}`}}const ude={offset:"stroke-dashoffset",array:"stroke-dasharray"},dde={offset:"strokeDashoffset",array:"strokeDasharray"};function hde(e,r,a=1,u=0,p=!0){e.pathLength=1;const y=p?ude:dde;e[y.offset]=ni.transform(-u);const x=ni.transform(r),i=ni.transform(a);e[y.array]=`${x} ${i}`}function uB(e,r,a){return typeof e=="string"?e:ni.transform(r+a*e)}function fde(e,r,a){const u=uB(r,e.x,e.width),p=uB(a,e.y,e.height);return`${u} ${p}`}function pR(e,{attrX:r,attrY:a,attrScale:u,originX:p,originY:y,pathLength:x,pathSpacing:i=1,pathOffset:C=0,...R},z,F){if(fR(e,R,F),z){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:V,style:G,dimensions:H}=e;V.transform&&(H&&(G.transform=V.transform),delete V.transform),H&&(p!==void 0||y!==void 0||G.transform)&&(G.transformOrigin=fde(H,p!==void 0?p:.5,y!==void 0?y:.5)),r!==void 0&&(V.x=r),a!==void 0&&(V.y=a),u!==void 0&&(V.scale=u),x!==void 0&&hde(V,x,i,C,!1)}const mR=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Q8=()=>({...mR(),attrs:{}}),gR=e=>typeof e=="string"&&e.toLowerCase()==="svg";function J8(e,{style:r,vars:a},u,p){Object.assign(e.style,r,p&&p.getProjectionStyles(u));for(const y in a)e.style.setProperty(y,a[y])}const eq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function tq(e,r,a,u){J8(e,r,void 0,u);for(const p in r.attrs)e.setAttribute(eq.has(p)?p:aR(p),r.attrs[p])}const Iw={};function pde(e){Object.assign(Iw,e)}function rq(e,{layout:r,layoutId:a}){return d_.has(e)||e.startsWith("origin")||(r||a!==void 0)&&(!!Iw[e]||e==="opacity")}function _R(e,r,a){var u;const{style:p}=e,y={};for(const x in p)(Cc(p[x])||r.style&&Cc(r.style[x])||rq(x,e)||((u=a?.getValue(x))===null||u===void 0?void 0:u.liveStyle)!==void 0)&&(y[x]=p[x]);return y}function nq(e,r,a){const u=_R(e,r,a);for(const p in e)if(Cc(e[p])||Cc(r[p])){const y=Zy.indexOf(p)!==-1?"attr"+p.charAt(0).toUpperCase()+p.substring(1):p;u[y]=e[p]}return u}function mde(e,r){try{r.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}const dB=["x","y","width","height","cx","cy","r"],gde={useVisualState:Y8({scrapeMotionValuesFromProps:nq,createRenderState:Q8,onUpdate:({props:e,prevProps:r,current:a,renderState:u,latestValues:p})=>{if(!a)return;let y=!!e.drag;if(!y){for(const i in p)if(d_.has(i)){y=!0;break}}if(!y)return;let x=!r;if(r)for(let i=0;i<dB.length;i++){const C=dB[i];e[C]!==r[C]&&(x=!0)}x&&Ts.read(()=>{mde(a,u),Ts.render(()=>{pR(u,p,gR(a.tagName),e.transformTemplate),tq(a,u)})})}})},_de={useVisualState:Y8({scrapeMotionValuesFromProps:_R,createRenderState:mR})};function iq(e,r,a){for(const u in r)!Cc(r[u])&&!rq(u,a)&&(e[u]=r[u])}function yde({transformTemplate:e},r){return ge.useMemo(()=>{const a=mR();return fR(a,r,e),Object.assign({},a.vars,a.style)},[r])}function vde(e,r){const a=e.style||{},u={};return iq(u,a,e),Object.assign(u,yde(e,r)),u}function xde(e,r){const a={},u=vde(e,r);return e.drag&&e.dragListener!==!1&&(a.draggable=!1,u.userSelect=u.WebkitUserSelect=u.WebkitTouchCallout="none",u.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=u,a}function bde(e,r,a,u){const p=ge.useMemo(()=>{const y=Q8();return pR(y,r,gR(u),e.transformTemplate),{...y.attrs,style:{...y.style}}},[r]);if(e.style){const y={};iq(y,e.style,e),p.style={...y,...p.style}}return p}function wde(e=!1){return(a,u,p,{latestValues:y},x)=>{const C=(cR(a)?bde:xde)(u,y,x,a),R=kue(u,typeof a=="string",e),z=a!==ge.Fragment?{...R,...C,ref:p}:{},{children:F}=u,V=ge.useMemo(()=>Cc(F)?F.get():F,[F]);return ge.createElement(a,{...z,children:V})}}function Sde(e,r){return function(u,{forwardMotionProps:p}={forwardMotionProps:!1}){const x={...cR(u)?gde:_de,preloadedFeatures:e,useRender:wde(p),createVisualElement:r,Component:u};return Gue(x)}}function oq(e,r){if(!Array.isArray(r))return!1;const a=r.length;if(a!==e.length)return!1;for(let u=0;u<a;u++)if(r[u]!==e[u])return!1;return!0}function dS(e,r,a){const u=e.getProps();return uR(u,r,a!==void 0?a:u.custom,e)}const Tde=iR(()=>window.ScrollTimeline!==void 0);class Ede{constructor(r){this.stop=()=>this.runAll("stop"),this.animations=r.filter(Boolean)}get finished(){return Promise.all(this.animations.map(r=>"finished"in r?r.finished:r))}getAll(r){return this.animations[0][r]}setAll(r,a){for(let u=0;u<this.animations.length;u++)this.animations[u][r]=a}attachTimeline(r,a){const u=this.animations.map(p=>{if(Tde()&&p.attachTimeline)return p.attachTimeline(r);if(typeof a=="function")return a(p)});return()=>{u.forEach((p,y)=>{p&&p(),this.animations[y].stop()})}}get time(){return this.getAll("time")}set time(r){this.setAll("time",r)}get speed(){return this.getAll("speed")}set speed(r){this.setAll("speed",r)}get startTime(){return this.getAll("startTime")}get duration(){let r=0;for(let a=0;a<this.animations.length;a++)r=Math.max(r,this.animations[a].duration);return r}runAll(r){this.animations.forEach(a=>a[r]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Pde extends Ede{then(r,a){return Promise.all(this.animations).then(r).catch(a)}}function yR(e,r){return e?e[r]||e.default||e:void 0}const AA=2e4;function sq(e){let r=0;const a=50;let u=e.next(r);for(;!u.done&&r<AA;)r+=a,u=e.next(r);return r>=AA?1/0:r}function vR(e){return typeof e=="function"}function hB(e,r){e.timeline=r,e.onfinish=null}const xR=e=>Array.isArray(e)&&typeof e[0]=="number",Ide={linearEasing:void 0};function Mde(e,r){const a=iR(e);return()=>{var u;return(u=Ide[r])!==null&&u!==void 0?u:a()}}const Mw=Mde(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),aq=(e,r,a=10)=>{let u="";const p=Math.max(Math.round(r/a),2);for(let y=0;y<p;y++)u+=e(ky(0,p-1,y))+", ";return`linear(${u.substring(0,u.length-2)})`};function lq(e){return!!(typeof e=="function"&&Mw()||!e||typeof e=="string"&&(e in DA||Mw())||xR(e)||Array.isArray(e)&&e.every(lq))}const x0=([e,r,a,u])=>`cubic-bezier(${e}, ${r}, ${a}, ${u})`,DA={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:x0([0,.65,.55,1]),circOut:x0([.55,0,1,.45]),backIn:x0([.31,.01,.66,-.59]),backOut:x0([.33,1.53,.69,.99])};function cq(e,r){if(e)return typeof e=="function"&&Mw()?aq(e,r):xR(e)?x0(e):Array.isArray(e)?e.map(a=>cq(a,r)||DA.easeOut):DA[e]}const Sh={x:!1,y:!1};function uq(){return Sh.x||Sh.y}function Cde(e,r,a){var u;if(e instanceof Element)return[e];if(typeof e=="string"){let p=document;const y=(u=void 0)!==null&&u!==void 0?u:p.querySelectorAll(e);return y?Array.from(y):[]}return Array.from(e)}function dq(e,r){const a=Cde(e),u=new AbortController,p={passive:!0,...r,signal:u.signal};return[a,p,()=>u.abort()]}function fB(e){return r=>{r.pointerType==="touch"||uq()||e(r)}}function Ade(e,r,a={}){const[u,p,y]=dq(e,a),x=fB(i=>{const{target:C}=i,R=r(i);if(typeof R!="function"||!C)return;const z=fB(F=>{R(F),C.removeEventListener("pointerleave",z)});C.addEventListener("pointerleave",z,p)});return u.forEach(i=>{i.addEventListener("pointerenter",x,p)}),y}const hq=(e,r)=>r?e===r?!0:hq(e,r.parentElement):!1,bR=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Dde=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Rde(e){return Dde.has(e.tagName)||e.tabIndex!==-1}const b0=new WeakSet;function pB(e){return r=>{r.key==="Enter"&&e(r)}}function I2(e,r){e.dispatchEvent(new PointerEvent("pointer"+r,{isPrimary:!0,bubbles:!0}))}const Ode=(e,r)=>{const a=e.currentTarget;if(!a)return;const u=pB(()=>{if(b0.has(a))return;I2(a,"down");const p=pB(()=>{I2(a,"up")}),y=()=>I2(a,"cancel");a.addEventListener("keyup",p,r),a.addEventListener("blur",y,r)});a.addEventListener("keydown",u,r),a.addEventListener("blur",()=>a.removeEventListener("keydown",u),r)};function mB(e){return bR(e)&&!uq()}function Lde(e,r,a={}){const[u,p,y]=dq(e,a),x=i=>{const C=i.currentTarget;if(!mB(i)||b0.has(C))return;b0.add(C);const R=r(i),z=(G,H)=>{window.removeEventListener("pointerup",F),window.removeEventListener("pointercancel",V),!(!mB(G)||!b0.has(C))&&(b0.delete(C),typeof R=="function"&&R(G,{success:H}))},F=G=>{z(G,a.useGlobalTarget||hq(C,G.target))},V=G=>{z(G,!1)};window.addEventListener("pointerup",F,p),window.addEventListener("pointercancel",V,p)};return u.forEach(i=>{!Rde(i)&&i.getAttribute("tabindex")===null&&(i.tabIndex=0),(a.useGlobalTarget?window:i).addEventListener("pointerdown",x,p),i.addEventListener("focus",R=>Ode(R,p),p)}),y}function zde(e){return e==="x"||e==="y"?Sh[e]?null:(Sh[e]=!0,()=>{Sh[e]=!1}):Sh.x||Sh.y?null:(Sh.x=Sh.y=!0,()=>{Sh.x=Sh.y=!1})}const fq=new Set(["width","height","top","left","right","bottom",...Zy]);let lw;function Fde(){lw=void 0}const Of={now:()=>(lw===void 0&&Of.set(Jl.isProcessing||Due.useManualTiming?Jl.timestamp:performance.now()),lw),set:e=>{lw=e,queueMicrotask(Fde)}};function wR(e,r){e.indexOf(r)===-1&&e.push(r)}function SR(e,r){const a=e.indexOf(r);a>-1&&e.splice(a,1)}let TR=class{constructor(){this.subscriptions=[]}add(r){return wR(this.subscriptions,r),()=>SR(this.subscriptions,r)}notify(r,a,u){const p=this.subscriptions.length;if(p)if(p===1)this.subscriptions[0](r,a,u);else for(let y=0;y<p;y++){const x=this.subscriptions[y];x&&x(r,a,u)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}};function pq(e,r){return r?e*(1e3/r):0}const gB=30,kde=e=>!isNaN(parseFloat(e));let Bde=class{constructor(r,a={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(u,p=!0)=>{const y=Of.now();this.updatedAt!==y&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(u),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),p&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(r),this.owner=a.owner}setCurrent(r){this.current=r,this.updatedAt=Of.now(),this.canTrackVelocity===null&&r!==void 0&&(this.canTrackVelocity=kde(this.current))}setPrevFrameValue(r=this.current){this.prevFrameValue=r,this.prevUpdatedAt=this.updatedAt}onChange(r){return this.on("change",r)}on(r,a){this.events[r]||(this.events[r]=new TR);const u=this.events[r].add(a);return r==="change"?()=>{u(),Ts.read(()=>{this.events.change.getSize()||this.stop()})}:u}clearListeners(){for(const r in this.events)this.events[r].clear()}attach(r,a){this.passiveEffect=r,this.stopPassiveEffect=a}set(r,a=!0){!a||!this.passiveEffect?this.updateAndNotify(r,a):this.passiveEffect(r,this.updateAndNotify)}setWithVelocity(r,a,u){this.set(a),this.prev=void 0,this.prevFrameValue=r,this.prevUpdatedAt=this.updatedAt-u}jump(r,a=!0){this.updateAndNotify(r),this.prev=r,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const r=Of.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||r-this.updatedAt>gB)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,gB);return pq(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(r){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=r(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}};function ex(e,r){return new Bde(e,r)}function jde(e,r,a){e.hasValue(r)?e.getValue(r).set(a):e.addValue(r,ex(a))}function Nde(e,r){const a=dS(e,r);let{transitionEnd:u={},transition:p={},...y}=a||{};y={...y,...u};for(const x in y){const i=Que(y[x]);jde(e,x,i)}}function Vde(e){return!!(Cc(e)&&e.add)}function RA(e,r){const a=e.getValue("willChange");if(Vde(a))return a.add(r)}function mq(e){return e.props[q8]}const gq=(e,r,a)=>(((1-3*a+3*r)*e+(3*a-6*r))*e+3*r)*e,Ude=1e-7,$de=12;function Wde(e,r,a,u,p){let y,x,i=0;do x=r+(a-r)/2,y=gq(x,u,p)-e,y>0?a=x:r=x;while(Math.abs(y)>Ude&&++i<$de);return x}function Ex(e,r,a,u){if(e===r&&a===u)return ed;const p=y=>Wde(y,0,1,e,a);return y=>y===0||y===1?y:gq(p(y),r,u)}const _q=e=>r=>r<=.5?e(2*r)/2:(2-e(2*(1-r)))/2,yq=e=>r=>1-e(1-r),vq=Ex(.33,1.53,.69,.99),ER=yq(vq),xq=_q(ER),bq=e=>(e*=2)<1?.5*ER(e):.5*(2-Math.pow(2,-10*(e-1))),PR=e=>1-Math.sin(Math.acos(e)),wq=yq(PR),Sq=_q(PR),Tq=e=>/^0[^.\s]+$/u.test(e);function qde(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Tq(e):!0}const L0=e=>Math.round(e*1e5)/1e5,IR=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Gde(e){return e==null}const Hde=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,MR=(e,r)=>a=>!!(typeof a=="string"&&Hde.test(a)&&a.startsWith(e)||r&&!Gde(a)&&Object.prototype.hasOwnProperty.call(a,r)),Eq=(e,r,a)=>u=>{if(typeof u!="string")return u;const[p,y,x,i]=u.match(IR);return{[e]:parseFloat(p),[r]:parseFloat(y),[a]:parseFloat(x),alpha:i!==void 0?parseFloat(i):1}},Yde=e=>Rp(0,255,e),M2={...Xy,transform:e=>Math.round(Yde(e))},Wg={test:MR("rgb","red"),parse:Eq("red","green","blue"),transform:({red:e,green:r,blue:a,alpha:u=1})=>"rgba("+M2.transform(e)+", "+M2.transform(r)+", "+M2.transform(a)+", "+L0(J0.transform(u))+")"};function Zde(e){let r="",a="",u="",p="";return e.length>5?(r=e.substring(1,3),a=e.substring(3,5),u=e.substring(5,7),p=e.substring(7,9)):(r=e.substring(1,2),a=e.substring(2,3),u=e.substring(3,4),p=e.substring(4,5),r+=r,a+=a,u+=u,p+=p),{red:parseInt(r,16),green:parseInt(a,16),blue:parseInt(u,16),alpha:p?parseInt(p,16)/255:1}}const OA={test:MR("#"),parse:Zde,transform:Wg.transform},fy={test:MR("hsl","hue"),parse:Eq("hue","saturation","lightness"),transform:({hue:e,saturation:r,lightness:a,alpha:u=1})=>"hsla("+Math.round(e)+", "+Rf.transform(L0(r))+", "+Rf.transform(L0(a))+", "+L0(J0.transform(u))+")"},Pc={test:e=>Wg.test(e)||OA.test(e)||fy.test(e),parse:e=>Wg.test(e)?Wg.parse(e):fy.test(e)?fy.parse(e):OA.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Wg.transform(e):fy.transform(e)},Xde=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Kde(e){var r,a;return isNaN(e)&&typeof e=="string"&&(((r=e.match(IR))===null||r===void 0?void 0:r.length)||0)+(((a=e.match(Xde))===null||a===void 0?void 0:a.length)||0)>0}const Pq="number",Iq="color",Qde="var",Jde="var(",_B="${}",ehe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function tx(e){const r=e.toString(),a=[],u={color:[],number:[],var:[]},p=[];let y=0;const i=r.replace(ehe,C=>(Pc.test(C)?(u.color.push(y),p.push(Iq),a.push(Pc.parse(C))):C.startsWith(Jde)?(u.var.push(y),p.push(Qde),a.push(C)):(u.number.push(y),p.push(Pq),a.push(parseFloat(C))),++y,_B)).split(_B);return{values:a,split:i,indexes:u,types:p}}function Mq(e){return tx(e).values}function Cq(e){const{split:r,types:a}=tx(e),u=r.length;return p=>{let y="";for(let x=0;x<u;x++)if(y+=r[x],p[x]!==void 0){const i=a[x];i===Pq?y+=L0(p[x]):i===Iq?y+=Pc.transform(p[x]):y+=p[x]}return y}}const the=e=>typeof e=="number"?0:e;function rhe(e){const r=Mq(e);return Cq(e)(r.map(the))}const Um={test:Kde,parse:Mq,createTransformer:Cq,getAnimatableNone:rhe},nhe=new Set(["brightness","contrast","saturate","opacity"]);function ihe(e){const[r,a]=e.slice(0,-1).split("(");if(r==="drop-shadow")return e;const[u]=a.match(IR)||[];if(!u)return e;const p=a.replace(u,"");let y=nhe.has(r)?1:0;return u!==a&&(y*=100),r+"("+y+p+")"}const ohe=/\b([a-z-]*)\(.*?\)/gu,LA={...Um,getAnimatableNone:e=>{const r=e.match(ohe);return r?r.map(ihe).join(" "):e}},she={...hR,color:Pc,backgroundColor:Pc,outlineColor:Pc,fill:Pc,stroke:Pc,borderColor:Pc,borderTopColor:Pc,borderRightColor:Pc,borderBottomColor:Pc,borderLeftColor:Pc,filter:LA,WebkitFilter:LA},CR=e=>she[e];function Aq(e,r){let a=CR(e);return a!==LA&&(a=Um),a.getAnimatableNone?a.getAnimatableNone(r):void 0}const ahe=new Set(["auto","none","0"]);function lhe(e,r,a){let u=0,p;for(;u<e.length&&!p;){const y=e[u];typeof y=="string"&&!ahe.has(y)&&tx(y).values.length&&(p=e[u]),u++}if(p&&a)for(const y of r)e[y]=Aq(a,p)}const yB=e=>e===Xy||e===ni,vB=(e,r)=>parseFloat(e.split(", ")[r]),xB=(e,r)=>(a,{transform:u})=>{if(u==="none"||!u)return 0;const p=u.match(/^matrix3d\((.+)\)$/u);if(p)return vB(p[1],r);{const y=u.match(/^matrix\((.+)\)$/u);return y?vB(y[1],e):0}},che=new Set(["x","y","z"]),uhe=Zy.filter(e=>!che.has(e));function dhe(e){const r=[];return uhe.forEach(a=>{const u=e.getValue(a);u!==void 0&&(r.push([a,u.get()]),u.set(a.startsWith("scale")?1:0))}),r}const jy={width:({x:e},{paddingLeft:r="0",paddingRight:a="0"})=>e.max-e.min-parseFloat(r)-parseFloat(a),height:({y:e},{paddingTop:r="0",paddingBottom:a="0"})=>e.max-e.min-parseFloat(r)-parseFloat(a),top:(e,{top:r})=>parseFloat(r),left:(e,{left:r})=>parseFloat(r),bottom:({y:e},{top:r})=>parseFloat(r)+(e.max-e.min),right:({x:e},{left:r})=>parseFloat(r)+(e.max-e.min),x:xB(4,13),y:xB(5,14)};jy.translateX=jy.x;jy.translateY=jy.y;const Kg=new Set;let zA=!1,FA=!1;function Dq(){if(FA){const e=Array.from(Kg).filter(u=>u.needsMeasurement),r=new Set(e.map(u=>u.element)),a=new Map;r.forEach(u=>{const p=dhe(u);p.length&&(a.set(u,p),u.render())}),e.forEach(u=>u.measureInitialState()),r.forEach(u=>{u.render();const p=a.get(u);p&&p.forEach(([y,x])=>{var i;(i=u.getValue(y))===null||i===void 0||i.set(x)})}),e.forEach(u=>u.measureEndState()),e.forEach(u=>{u.suspendedScrollY!==void 0&&window.scrollTo(0,u.suspendedScrollY)})}FA=!1,zA=!1,Kg.forEach(e=>e.complete()),Kg.clear()}function Rq(){Kg.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(FA=!0)})}function hhe(){Rq(),Dq()}let AR=class{constructor(r,a,u,p,y,x=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...r],this.onComplete=a,this.name=u,this.motionValue=p,this.element=y,this.isAsync=x}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Kg.add(this),zA||(zA=!0,Ts.read(Rq),Ts.resolveKeyframes(Dq))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:r,name:a,element:u,motionValue:p}=this;for(let y=0;y<r.length;y++)if(r[y]===null)if(y===0){const x=p?.get(),i=r[r.length-1];if(x!==void 0)r[0]=x;else if(u&&a){const C=u.readValue(a,i);C!=null&&(r[0]=C)}r[0]===void 0&&(r[0]=i),p&&x===void 0&&p.set(r[0])}else r[y]=r[y-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Kg.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Kg.delete(this))}resume(){this.isComplete||this.scheduleResolve()}};const Oq=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),fhe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function phe(e){const r=fhe.exec(e);if(!r)return[,];const[,a,u,p]=r;return[`--${a??u}`,p]}function Lq(e,r,a=1){const[u,p]=phe(e);if(!u)return;const y=window.getComputedStyle(r).getPropertyValue(u);if(y){const x=y.trim();return Oq(x)?parseFloat(x):x}return dR(p)?Lq(p,r,a+1):p}const zq=e=>r=>r.test(e),mhe={test:e=>e==="auto",parse:e=>e},Fq=[Xy,ni,Rf,Om,ide,nde,mhe],bB=e=>Fq.find(zq(e));let kq=class extends AR{constructor(r,a,u,p,y){super(r,a,u,p,y,!0)}readKeyframes(){const{unresolvedKeyframes:r,element:a,name:u}=this;if(!a||!a.current)return;super.readKeyframes();for(let C=0;C<r.length;C++){let R=r[C];if(typeof R=="string"&&(R=R.trim(),dR(R))){const z=Lq(R,a.current);z!==void 0&&(r[C]=z),C===r.length-1&&(this.finalKeyframe=R)}}if(this.resolveNoneKeyframes(),!fq.has(u)||r.length!==2)return;const[p,y]=r,x=bB(p),i=bB(y);if(x!==i)if(yB(x)&&yB(i))for(let C=0;C<r.length;C++){const R=r[C];typeof R=="string"&&(r[C]=parseFloat(R))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:r,name:a}=this,u=[];for(let p=0;p<r.length;p++)qde(r[p])&&u.push(p);u.length&&lhe(r,u,a)}measureInitialState(){const{element:r,unresolvedKeyframes:a,name:u}=this;if(!r||!r.current)return;u==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=jy[u](r.measureViewportBox(),window.getComputedStyle(r.current)),a[0]=this.measuredOrigin;const p=a[a.length-1];p!==void 0&&r.getValue(u,p).jump(p,!1)}measureEndState(){var r;const{element:a,name:u,unresolvedKeyframes:p}=this;if(!a||!a.current)return;const y=a.getValue(u);y&&y.jump(this.measuredOrigin,!1);const x=p.length-1,i=p[x];p[x]=jy[u](a.measureViewportBox(),window.getComputedStyle(a.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),!((r=this.removedTransforms)===null||r===void 0)&&r.length&&this.removedTransforms.forEach(([C,R])=>{a.getValue(C).set(R)}),this.resolveNoneKeyframes()}};const wB=(e,r)=>r==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Um.test(e)||e==="0")&&!e.startsWith("url("));function ghe(e){const r=e[0];if(e.length===1)return!0;for(let a=0;a<e.length;a++)if(e[a]!==r)return!0}function _he(e,r,a,u){const p=e[0];if(p===null)return!1;if(r==="display"||r==="visibility")return!0;const y=e[e.length-1],x=wB(p,r),i=wB(y,r);return!x||!i?!1:ghe(e)||(a==="spring"||vR(a))&&u}const yhe=e=>e!==null;function hS(e,{repeat:r,repeatType:a="loop"},u){const p=e.filter(yhe),y=r&&a!=="loop"&&r%2===1?0:p.length-1;return!y||u===void 0?p[y]:u}const vhe=40;class Bq{constructor({autoplay:r=!0,delay:a=0,type:u="keyframes",repeat:p=0,repeatDelay:y=0,repeatType:x="loop",...i}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Of.now(),this.options={autoplay:r,delay:a,type:u,repeat:p,repeatDelay:y,repeatType:x,...i},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>vhe?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&hhe(),this._resolved}onKeyframesResolved(r,a){this.resolvedAt=Of.now(),this.hasAttemptedResolve=!0;const{name:u,type:p,velocity:y,delay:x,onComplete:i,onUpdate:C,isGenerator:R}=this.options;if(!R&&!_he(r,u,p,y))if(x)this.options.duration=0;else{C&&C(hS(r,this.options,a)),i&&i(),this.resolveFinishedPromise();return}const z=this.initPlayback(r,a);z!==!1&&(this._resolved={keyframes:r,finalKeyframe:a,...z},this.onPostResolved())}onPostResolved(){}then(r,a){return this.currentFinishedPromise.then(r,a)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(r=>{this.resolveFinishedPromise=r})}}const ea=(e,r,a)=>e+(r-e)*a;function C2(e,r,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(r-e)*6*a:a<1/2?r:a<2/3?e+(r-e)*(2/3-a)*6:e}function xhe({hue:e,saturation:r,lightness:a,alpha:u}){e/=360,r/=100,a/=100;let p=0,y=0,x=0;if(!r)p=y=x=a;else{const i=a<.5?a*(1+r):a+r-a*r,C=2*a-i;p=C2(C,i,e+1/3),y=C2(C,i,e),x=C2(C,i,e-1/3)}return{red:Math.round(p*255),green:Math.round(y*255),blue:Math.round(x*255),alpha:u}}function Cw(e,r){return a=>a>0?r:e}const A2=(e,r,a)=>{const u=e*e,p=a*(r*r-u)+u;return p<0?0:Math.sqrt(p)},bhe=[OA,Wg,fy],whe=e=>bhe.find(r=>r.test(e));function SB(e){const r=whe(e);if(!r)return!1;let a=r.parse(e);return r===fy&&(a=xhe(a)),a}const TB=(e,r)=>{const a=SB(e),u=SB(r);if(!a||!u)return Cw(e,r);const p={...a};return y=>(p.red=A2(a.red,u.red,y),p.green=A2(a.green,u.green,y),p.blue=A2(a.blue,u.blue,y),p.alpha=ea(a.alpha,u.alpha,y),Wg.transform(p))},She=(e,r)=>a=>r(e(a)),Px=(...e)=>e.reduce(She),kA=new Set(["none","hidden"]);function The(e,r){return kA.has(e)?a=>a<=0?e:r:a=>a>=1?r:e}function Ehe(e,r){return a=>ea(e,r,a)}function DR(e){return typeof e=="number"?Ehe:typeof e=="string"?dR(e)?Cw:Pc.test(e)?TB:Mhe:Array.isArray(e)?jq:typeof e=="object"?Pc.test(e)?TB:Phe:Cw}function jq(e,r){const a=[...e],u=a.length,p=e.map((y,x)=>DR(y)(y,r[x]));return y=>{for(let x=0;x<u;x++)a[x]=p[x](y);return a}}function Phe(e,r){const a={...e,...r},u={};for(const p in a)e[p]!==void 0&&r[p]!==void 0&&(u[p]=DR(e[p])(e[p],r[p]));return p=>{for(const y in u)a[y]=u[y](p);return a}}function Ihe(e,r){var a;const u=[],p={color:0,var:0,number:0};for(let y=0;y<r.values.length;y++){const x=r.types[y],i=e.indexes[x][p[x]],C=(a=e.values[i])!==null&&a!==void 0?a:0;u[y]=C,p[x]++}return u}const Mhe=(e,r)=>{const a=Um.createTransformer(r),u=tx(e),p=tx(r);return u.indexes.var.length===p.indexes.var.length&&u.indexes.color.length===p.indexes.color.length&&u.indexes.number.length>=p.indexes.number.length?kA.has(e)&&!p.values.length||kA.has(r)&&!u.values.length?The(e,r):Px(jq(Ihe(u,p),p.values),a):Cw(e,r)};function Nq(e,r,a){return typeof e=="number"&&typeof r=="number"&&typeof a=="number"?ea(e,r,a):DR(e)(e,r)}const Che=5;function Vq(e,r,a){const u=Math.max(r-Che,0);return pq(a-e(u),r-u)}const _a={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},D2=.001;function Ahe({duration:e=_a.duration,bounce:r=_a.bounce,velocity:a=_a.velocity,mass:u=_a.mass}){let p,y,x=1-r;x=Rp(_a.minDamping,_a.maxDamping,x),e=Rp(_a.minDuration,_a.maxDuration,Ap(e)),x<1?(p=R=>{const z=R*x,F=z*e,V=z-a,G=BA(R,x),H=Math.exp(-F);return D2-V/G*H},y=R=>{const F=R*x*e,V=F*a+a,G=Math.pow(x,2)*Math.pow(R,2)*e,H=Math.exp(-F),Z=BA(Math.pow(R,2),x);return(-p(R)+D2>0?-1:1)*((V-G)*H)/Z}):(p=R=>{const z=Math.exp(-R*e),F=(R-a)*e+1;return-D2+z*F},y=R=>{const z=Math.exp(-R*e),F=(a-R)*(e*e);return z*F});const i=5/e,C=Rhe(p,y,i);if(e=Cp(e),isNaN(C))return{stiffness:_a.stiffness,damping:_a.damping,duration:e};{const R=Math.pow(C,2)*u;return{stiffness:R,damping:x*2*Math.sqrt(u*R),duration:e}}}const Dhe=12;function Rhe(e,r,a){let u=a;for(let p=1;p<Dhe;p++)u=u-e(u)/r(u);return u}function BA(e,r){return e*Math.sqrt(1-r*r)}const Ohe=["duration","bounce"],Lhe=["stiffness","damping","mass"];function EB(e,r){return r.some(a=>e[a]!==void 0)}function zhe(e){let r={velocity:_a.velocity,stiffness:_a.stiffness,damping:_a.damping,mass:_a.mass,isResolvedFromDuration:!1,...e};if(!EB(e,Lhe)&&EB(e,Ohe))if(e.visualDuration){const a=e.visualDuration,u=2*Math.PI/(a*1.2),p=u*u,y=2*Rp(.05,1,1-(e.bounce||0))*Math.sqrt(p);r={...r,mass:_a.mass,stiffness:p,damping:y}}else{const a=Ahe(e);r={...r,...a,mass:_a.mass},r.isResolvedFromDuration=!0}return r}function Uq(e=_a.visualDuration,r=_a.bounce){const a=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:r}:e;let{restSpeed:u,restDelta:p}=a;const y=a.keyframes[0],x=a.keyframes[a.keyframes.length-1],i={done:!1,value:y},{stiffness:C,damping:R,mass:z,duration:F,velocity:V,isResolvedFromDuration:G}=zhe({...a,velocity:-Ap(a.velocity||0)}),H=V||0,Z=R/(2*Math.sqrt(C*z)),J=x-y,se=Ap(Math.sqrt(C/z)),pe=Math.abs(J)<5;u||(u=pe?_a.restSpeed.granular:_a.restSpeed.default),p||(p=pe?_a.restDelta.granular:_a.restDelta.default);let ve;if(Z<1){const _e=BA(se,Z);ve=Re=>{const ke=Math.exp(-Z*se*Re);return x-ke*((H+Z*se*J)/_e*Math.sin(_e*Re)+J*Math.cos(_e*Re))}}else if(Z===1)ve=_e=>x-Math.exp(-se*_e)*(J+(H+se*J)*_e);else{const _e=se*Math.sqrt(Z*Z-1);ve=Re=>{const ke=Math.exp(-Z*se*Re),ze=Math.min(_e*Re,300);return x-ke*((H+Z*se*J)*Math.sinh(ze)+_e*J*Math.cosh(ze))/_e}}const Ne={calculatedDuration:G&&F||null,next:_e=>{const Re=ve(_e);if(G)i.done=_e>=F;else{let ke=0;Z<1&&(ke=_e===0?Cp(H):Vq(ve,_e,Re));const ze=Math.abs(ke)<=u,et=Math.abs(x-Re)<=p;i.done=ze&&et}return i.value=i.done?x:Re,i},toString:()=>{const _e=Math.min(sq(Ne),AA),Re=aq(ke=>Ne.next(_e*ke).value,_e,30);return _e+"ms "+Re}};return Ne}function PB({keyframes:e,velocity:r=0,power:a=.8,timeConstant:u=325,bounceDamping:p=10,bounceStiffness:y=500,modifyTarget:x,min:i,max:C,restDelta:R=.5,restSpeed:z}){const F=e[0],V={done:!1,value:F},G=ze=>i!==void 0&&ze<i||C!==void 0&&ze>C,H=ze=>i===void 0?C:C===void 0||Math.abs(i-ze)<Math.abs(C-ze)?i:C;let Z=a*r;const J=F+Z,se=x===void 0?J:x(J);se!==J&&(Z=se-F);const pe=ze=>-Z*Math.exp(-ze/u),ve=ze=>se+pe(ze),Ne=ze=>{const et=pe(ze),ht=ve(ze);V.done=Math.abs(et)<=R,V.value=V.done?se:ht};let _e,Re;const ke=ze=>{G(V.value)&&(_e=ze,Re=Uq({keyframes:[V.value,H(V.value)],velocity:Vq(ve,ze,V.value),damping:p,stiffness:y,restDelta:R,restSpeed:z}))};return ke(0),{calculatedDuration:null,next:ze=>{let et=!1;return!Re&&_e===void 0&&(et=!0,Ne(ze),ke(ze)),_e!==void 0&&ze>=_e?Re.next(ze-_e):(!et&&Ne(ze),V)}}}const Fhe=Ex(.42,0,1,1),khe=Ex(0,0,.58,1),$q=Ex(.42,0,.58,1),Bhe=e=>Array.isArray(e)&&typeof e[0]!="number",jhe={linear:ed,easeIn:Fhe,easeInOut:$q,easeOut:khe,circIn:PR,circInOut:Sq,circOut:wq,backIn:ER,backInOut:xq,backOut:vq,anticipate:bq},IB=e=>{if(xR(e)){N8(e.length===4);const[r,a,u,p]=e;return Ex(r,a,u,p)}else if(typeof e=="string")return jhe[e];return e};function Nhe(e,r,a){const u=[],p=a||Nq,y=e.length-1;for(let x=0;x<y;x++){let i=p(e[x],e[x+1]);if(r){const C=Array.isArray(r)?r[x]||ed:r;i=Px(C,i)}u.push(i)}return u}function Vhe(e,r,{clamp:a=!0,ease:u,mixer:p}={}){const y=e.length;if(N8(y===r.length),y===1)return()=>r[0];if(y===2&&r[0]===r[1])return()=>r[1];const x=e[0]===e[1];e[0]>e[y-1]&&(e=[...e].reverse(),r=[...r].reverse());const i=Nhe(r,u,p),C=i.length,R=z=>{if(x&&z<e[0])return r[0];let F=0;if(C>1)for(;F<e.length-2&&!(z<e[F+1]);F++);const V=ky(e[F],e[F+1],z);return i[F](V)};return a?z=>R(Rp(e[0],e[y-1],z)):R}function Uhe(e,r){const a=e[e.length-1];for(let u=1;u<=r;u++){const p=ky(0,r,u);e.push(ea(a,1,p))}}function $he(e){const r=[0];return Uhe(r,e.length-1),r}function Whe(e,r){return e.map(a=>a*r)}function qhe(e,r){return e.map(()=>r||$q).splice(0,e.length-1)}function Aw({duration:e=300,keyframes:r,times:a,ease:u="easeInOut"}){const p=Bhe(u)?u.map(IB):IB(u),y={done:!1,value:r[0]},x=Whe(a&&a.length===r.length?a:$he(r),e),i=Vhe(x,r,{ease:Array.isArray(p)?p:qhe(r,p)});return{calculatedDuration:e,next:C=>(y.value=i(C),y.done=C>=e,y)}}const Ghe=e=>{const r=({timestamp:a})=>e(a);return{start:()=>Ts.update(r,!0),stop:()=>Vm(r),now:()=>Jl.isProcessing?Jl.timestamp:Of.now()}},Hhe={decay:PB,inertia:PB,tween:Aw,keyframes:Aw,spring:Uq},Yhe=e=>e/100;class RR extends Bq{constructor(r){super(r),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:C}=this.options;C&&C()};const{name:a,motionValue:u,element:p,keyframes:y}=this.options,x=p?.KeyframeResolver||AR,i=(C,R)=>this.onKeyframesResolved(C,R);this.resolver=new x(y,i,a,u,p),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(r){const{type:a="keyframes",repeat:u=0,repeatDelay:p=0,repeatType:y,velocity:x=0}=this.options,i=vR(a)?a:Hhe[a]||Aw;let C,R;i!==Aw&&typeof r[0]!="number"&&(C=Px(Yhe,Nq(r[0],r[1])),r=[0,100]);const z=i({...this.options,keyframes:r});y==="mirror"&&(R=i({...this.options,keyframes:[...r].reverse(),velocity:-x})),z.calculatedDuration===null&&(z.calculatedDuration=sq(z));const{calculatedDuration:F}=z,V=F+p,G=V*(u+1)-p;return{generator:z,mirroredGenerator:R,mapPercentToKeyframes:C,calculatedDuration:F,resolvedDuration:V,totalDuration:G}}onPostResolved(){const{autoplay:r=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!r?this.pause():this.state=this.pendingPlayState}tick(r,a=!1){const{resolved:u}=this;if(!u){const{keyframes:ze}=this.options;return{done:!0,value:ze[ze.length-1]}}const{finalKeyframe:p,generator:y,mirroredGenerator:x,mapPercentToKeyframes:i,keyframes:C,calculatedDuration:R,totalDuration:z,resolvedDuration:F}=u;if(this.startTime===null)return y.next(0);const{delay:V,repeat:G,repeatType:H,repeatDelay:Z,onUpdate:J}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,r):this.speed<0&&(this.startTime=Math.min(r-z/this.speed,this.startTime)),a?this.currentTime=r:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(r-this.startTime)*this.speed;const se=this.currentTime-V*(this.speed>=0?1:-1),pe=this.speed>=0?se<0:se>z;this.currentTime=Math.max(se,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=z);let ve=this.currentTime,Ne=y;if(G){const ze=Math.min(this.currentTime,z)/F;let et=Math.floor(ze),ht=ze%1;!ht&&ze>=1&&(ht=1),ht===1&&et--,et=Math.min(et,G+1),!!(et%2)&&(H==="reverse"?(ht=1-ht,Z&&(ht-=Z/F)):H==="mirror"&&(Ne=x)),ve=Rp(0,1,ht)*F}const _e=pe?{done:!1,value:C[0]}:Ne.next(ve);i&&(_e.value=i(_e.value));let{done:Re}=_e;!pe&&R!==null&&(Re=this.speed>=0?this.currentTime>=z:this.currentTime<=0);const ke=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Re);return ke&&p!==void 0&&(_e.value=hS(C,this.options,p)),J&&J(_e.value),ke&&this.finish(),_e}get duration(){const{resolved:r}=this;return r?Ap(r.calculatedDuration):0}get time(){return Ap(this.currentTime)}set time(r){r=Cp(r),this.currentTime=r,this.holdTime!==null||this.speed===0?this.holdTime=r:this.driver&&(this.startTime=this.driver.now()-r/this.speed)}get speed(){return this.playbackSpeed}set speed(r){const a=this.playbackSpeed!==r;this.playbackSpeed=r,a&&(this.time=Ap(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:r=Ghe,onPlay:a,startTime:u}=this.options;this.driver||(this.driver=r(y=>this.tick(y))),a&&a();const p=this.driver.now();this.holdTime!==null?this.startTime=p-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=p):this.startTime=u??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var r;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(r=this.currentTime)!==null&&r!==void 0?r:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:r}=this.options;r&&r()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(r){return this.startTime=0,this.tick(r,!0)}}const Zhe=new Set(["opacity","clipPath","filter","transform"]);function Xhe(e,r,a,{delay:u=0,duration:p=300,repeat:y=0,repeatType:x="loop",ease:i="easeInOut",times:C}={}){const R={[r]:a};C&&(R.offset=C);const z=cq(i,p);return Array.isArray(z)&&(R.easing=z),e.animate(R,{delay:u,duration:p,easing:Array.isArray(z)?"linear":z,fill:"both",iterations:y+1,direction:x==="reverse"?"alternate":"normal"})}const Khe=iR(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Dw=10,Qhe=2e4;function Jhe(e){return vR(e.type)||e.type==="spring"||!lq(e.ease)}function efe(e,r){const a=new RR({...r,keyframes:e,repeat:0,delay:0,isGenerator:!0});let u={done:!1,value:e[0]};const p=[];let y=0;for(;!u.done&&y<Qhe;)u=a.sample(y),p.push(u.value),y+=Dw;return{times:void 0,keyframes:p,duration:y-Dw,ease:"linear"}}const Wq={anticipate:bq,backInOut:xq,circInOut:Sq};function tfe(e){return e in Wq}class MB extends Bq{constructor(r){super(r);const{name:a,motionValue:u,element:p,keyframes:y}=this.options;this.resolver=new kq(y,(x,i)=>this.onKeyframesResolved(x,i),a,u,p),this.resolver.scheduleResolve()}initPlayback(r,a){let{duration:u=300,times:p,ease:y,type:x,motionValue:i,name:C,startTime:R}=this.options;if(!i.owner||!i.owner.current)return!1;if(typeof y=="string"&&Mw()&&tfe(y)&&(y=Wq[y]),Jhe(this.options)){const{onComplete:F,onUpdate:V,motionValue:G,element:H,...Z}=this.options,J=efe(r,Z);r=J.keyframes,r.length===1&&(r[1]=r[0]),u=J.duration,p=J.times,y=J.ease,x="keyframes"}const z=Xhe(i.owner.current,C,r,{...this.options,duration:u,times:p,ease:y});return z.startTime=R??this.calcStartTime(),this.pendingTimeline?(hB(z,this.pendingTimeline),this.pendingTimeline=void 0):z.onfinish=()=>{const{onComplete:F}=this.options;i.set(hS(r,this.options,a)),F&&F(),this.cancel(),this.resolveFinishedPromise()},{animation:z,duration:u,times:p,type:x,ease:y,keyframes:r}}get duration(){const{resolved:r}=this;if(!r)return 0;const{duration:a}=r;return Ap(a)}get time(){const{resolved:r}=this;if(!r)return 0;const{animation:a}=r;return Ap(a.currentTime||0)}set time(r){const{resolved:a}=this;if(!a)return;const{animation:u}=a;u.currentTime=Cp(r)}get speed(){const{resolved:r}=this;if(!r)return 1;const{animation:a}=r;return a.playbackRate}set speed(r){const{resolved:a}=this;if(!a)return;const{animation:u}=a;u.playbackRate=r}get state(){const{resolved:r}=this;if(!r)return"idle";const{animation:a}=r;return a.playState}get startTime(){const{resolved:r}=this;if(!r)return null;const{animation:a}=r;return a.startTime}attachTimeline(r){if(!this._resolved)this.pendingTimeline=r;else{const{resolved:a}=this;if(!a)return ed;const{animation:u}=a;hB(u,r)}return ed}play(){if(this.isStopped)return;const{resolved:r}=this;if(!r)return;const{animation:a}=r;a.playState==="finished"&&this.updateFinishedPromise(),a.play()}pause(){const{resolved:r}=this;if(!r)return;const{animation:a}=r;a.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:r}=this;if(!r)return;const{animation:a,keyframes:u,duration:p,type:y,ease:x,times:i}=r;if(a.playState==="idle"||a.playState==="finished")return;if(this.time){const{motionValue:R,onUpdate:z,onComplete:F,element:V,...G}=this.options,H=new RR({...G,keyframes:u,duration:p,type:y,ease:x,times:i,isGenerator:!0}),Z=Cp(this.time);R.setWithVelocity(H.sample(Z-Dw).value,H.sample(Z).value,Dw)}const{onStop:C}=this.options;C&&C(),this.cancel()}complete(){const{resolved:r}=this;r&&r.animation.finish()}cancel(){const{resolved:r}=this;r&&r.animation.cancel()}static supports(r){const{motionValue:a,name:u,repeatDelay:p,repeatType:y,damping:x,type:i}=r;if(!a||!a.owner||!(a.owner.current instanceof HTMLElement))return!1;const{onUpdate:C,transformTemplate:R}=a.owner.getProps();return Khe()&&u&&Zhe.has(u)&&!C&&!R&&!p&&y!=="mirror"&&x!==0&&i!=="inertia"}}const rfe={type:"spring",stiffness:500,damping:25,restSpeed:10},nfe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),ife={type:"keyframes",duration:.8},ofe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},sfe=(e,{keyframes:r})=>r.length>2?ife:d_.has(e)?e.startsWith("scale")?nfe(r[1]):rfe:ofe;function afe({when:e,delay:r,delayChildren:a,staggerChildren:u,staggerDirection:p,repeat:y,repeatType:x,repeatDelay:i,from:C,elapsed:R,...z}){return!!Object.keys(z).length}const OR=(e,r,a,u={},p,y)=>x=>{const i=yR(u,e)||{},C=i.delay||u.delay||0;let{elapsed:R=0}=u;R=R-Cp(C);let z={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:r.getVelocity(),...i,delay:-R,onUpdate:V=>{r.set(V),i.onUpdate&&i.onUpdate(V)},onComplete:()=>{x(),i.onComplete&&i.onComplete()},name:e,motionValue:r,element:y?void 0:p};afe(i)||(z={...z,...sfe(e,z)}),z.duration&&(z.duration=Cp(z.duration)),z.repeatDelay&&(z.repeatDelay=Cp(z.repeatDelay)),z.from!==void 0&&(z.keyframes[0]=z.from);let F=!1;if((z.type===!1||z.duration===0&&!z.repeatDelay)&&(z.duration=0,z.delay===0&&(F=!0)),F&&!y&&r.get()!==void 0){const V=hS(z.keyframes,i);if(V!==void 0)return Ts.update(()=>{z.onUpdate(V),z.onComplete()}),new Pde([])}return!y&&MB.supports(z)?new MB(z):new RR(z)};function lfe({protectedKeys:e,needsAnimating:r},a){const u=e.hasOwnProperty(a)&&r[a]!==!0;return r[a]=!1,u}function qq(e,r,{delay:a=0,transitionOverride:u,type:p}={}){var y;let{transition:x=e.getDefaultTransition(),transitionEnd:i,...C}=r;u&&(x=u);const R=[],z=p&&e.animationState&&e.animationState.getState()[p];for(const F in C){const V=e.getValue(F,(y=e.latestValues[F])!==null&&y!==void 0?y:null),G=C[F];if(G===void 0||z&&lfe(z,F))continue;const H={delay:a,...yR(x||{},F)};let Z=!1;if(window.MotionHandoffAnimation){const se=mq(e);if(se){const pe=window.MotionHandoffAnimation(se,F,Ts);pe!==null&&(H.startTime=pe,Z=!0)}}RA(e,F),V.start(OR(F,V,G,e.shouldReduceMotion&&fq.has(F)?{type:!1}:H,e,Z));const J=V.animation;J&&R.push(J)}return i&&Promise.all(R).then(()=>{Ts.update(()=>{i&&Nde(e,i)})}),R}function jA(e,r,a={}){var u;const p=dS(e,r,a.type==="exit"?(u=e.presenceContext)===null||u===void 0?void 0:u.custom:void 0);let{transition:y=e.getDefaultTransition()||{}}=p||{};a.transitionOverride&&(y=a.transitionOverride);const x=p?()=>Promise.all(qq(e,p,a)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(R=0)=>{const{delayChildren:z=0,staggerChildren:F,staggerDirection:V}=y;return cfe(e,r,z+R,F,V,a)}:()=>Promise.resolve(),{when:C}=y;if(C){const[R,z]=C==="beforeChildren"?[x,i]:[i,x];return R().then(()=>z())}else return Promise.all([x(),i(a.delay)])}function cfe(e,r,a=0,u=0,p=1,y){const x=[],i=(e.variantChildren.size-1)*u,C=p===1?(R=0)=>R*u:(R=0)=>i-R*u;return Array.from(e.variantChildren).sort(ufe).forEach((R,z)=>{R.notify("AnimationStart",r),x.push(jA(R,r,{...y,delay:a+C(z)}).then(()=>R.notify("AnimationComplete",r)))}),Promise.all(x)}function ufe(e,r){return e.sortNodePosition(r)}function dfe(e,r,a={}){e.notify("AnimationStart",r);let u;if(Array.isArray(r)){const p=r.map(y=>jA(e,y,a));u=Promise.all(p)}else if(typeof r=="string")u=jA(e,r,a);else{const p=typeof r=="function"?dS(e,r,a.custom):r;u=Promise.all(qq(e,p,a))}return u.then(()=>{e.notify("AnimationComplete",r)})}const hfe=sR.length;function Gq(e){if(!e)return;if(!e.isControllingVariants){const a=e.parent?Gq(e.parent)||{}:{};return e.props.initial!==void 0&&(a.initial=e.props.initial),a}const r={};for(let a=0;a<hfe;a++){const u=sR[a],p=e.props[u];(Q0(p)||p===!1)&&(r[u]=p)}return r}const ffe=[...oR].reverse(),pfe=oR.length;function mfe(e){return r=>Promise.all(r.map(({animation:a,options:u})=>dfe(e,a,u)))}function gfe(e){let r=mfe(e),a=CB(),u=!0;const p=C=>(R,z)=>{var F;const V=dS(e,z,C==="exit"?(F=e.presenceContext)===null||F===void 0?void 0:F.custom:void 0);if(V){const{transition:G,transitionEnd:H,...Z}=V;R={...R,...Z,...H}}return R};function y(C){r=C(e)}function x(C){const{props:R}=e,z=Gq(e.parent)||{},F=[],V=new Set;let G={},H=1/0;for(let J=0;J<pfe;J++){const se=ffe[J],pe=a[se],ve=R[se]!==void 0?R[se]:z[se],Ne=Q0(ve),_e=se===C?pe.isActive:null;_e===!1&&(H=J);let Re=ve===z[se]&&ve!==R[se]&&Ne;if(Re&&u&&e.manuallyAnimateOnMount&&(Re=!1),pe.protectedKeys={...G},!pe.isActive&&_e===null||!ve&&!pe.prevProp||cS(ve)||typeof ve=="boolean")continue;const ke=_fe(pe.prevProp,ve);let ze=ke||se===C&&pe.isActive&&!Re&&Ne||J>H&&Ne,et=!1;const ht=Array.isArray(ve)?ve:[ve];let Xt=ht.reduce(p(se),{});_e===!1&&(Xt={});const{prevResolvedValues:Ir={}}=pe,nr={...Ir,...Xt},Fr=lt=>{ze=!0,V.has(lt)&&(et=!0,V.delete(lt)),pe.needsAnimating[lt]=!0;const Et=e.getValue(lt);Et&&(Et.liveStyle=!1)};for(const lt in nr){const Et=Xt[lt],qt=Ir[lt];if(G.hasOwnProperty(lt))continue;let Gt=!1;CA(Et)&&CA(qt)?Gt=!oq(Et,qt):Gt=Et!==qt,Gt?Et!=null?Fr(lt):V.add(lt):Et!==void 0&&V.has(lt)?Fr(lt):pe.protectedKeys[lt]=!0}pe.prevProp=ve,pe.prevResolvedValues=Xt,pe.isActive&&(G={...G,...Xt}),u&&e.blockInitialAnimation&&(ze=!1),ze&&(!(Re&&ke)||et)&&F.push(...ht.map(lt=>({animation:lt,options:{type:se}})))}if(V.size){const J={};V.forEach(se=>{const pe=e.getBaseTarget(se),ve=e.getValue(se);ve&&(ve.liveStyle=!0),J[se]=pe??null}),F.push({animation:J})}let Z=!!F.length;return u&&(R.initial===!1||R.initial===R.animate)&&!e.manuallyAnimateOnMount&&(Z=!1),u=!1,Z?r(F):Promise.resolve()}function i(C,R){var z;if(a[C].isActive===R)return Promise.resolve();(z=e.variantChildren)===null||z===void 0||z.forEach(V=>{var G;return(G=V.animationState)===null||G===void 0?void 0:G.setActive(C,R)}),a[C].isActive=R;const F=x(C);for(const V in a)a[V].protectedKeys={};return F}return{animateChanges:x,setActive:i,setAnimateFunction:y,getState:()=>a,reset:()=>{a=CB(),u=!0}}}function _fe(e,r){return typeof r=="string"?r!==e:Array.isArray(r)?!oq(r,e):!1}function Lg(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function CB(){return{animate:Lg(!0),whileInView:Lg(),whileHover:Lg(),whileTap:Lg(),whileDrag:Lg(),whileFocus:Lg(),exit:Lg()}}let Gm=class{constructor(r){this.isMounted=!1,this.node=r}update(){}},yfe=class extends Gm{constructor(r){super(r),r.animationState||(r.animationState=gfe(r))}updateAnimationControlsSubscription(){const{animate:r}=this.node.getProps();cS(r)&&(this.unmountControls=r.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:r}=this.node.getProps(),{animate:a}=this.node.prevProps||{};r!==a&&this.updateAnimationControlsSubscription()}unmount(){var r;this.node.animationState.reset(),(r=this.unmountControls)===null||r===void 0||r.call(this)}},vfe=0,xfe=class extends Gm{constructor(){super(...arguments),this.id=vfe++}update(){if(!this.node.presenceContext)return;const{isPresent:r,onExitComplete:a}=this.node.presenceContext,{isPresent:u}=this.node.prevPresenceContext||{};if(!this.node.animationState||r===u)return;const p=this.node.animationState.setActive("exit",!r);a&&!r&&p.then(()=>a(this.id))}mount(){const{register:r}=this.node.presenceContext||{};r&&(this.unmount=r(this.id))}unmount(){}};const bfe={animation:{Feature:yfe},exit:{Feature:xfe}};function rx(e,r,a,u={passive:!0}){return e.addEventListener(r,a,u),()=>e.removeEventListener(r,a)}function Ix(e){return{point:{x:e.pageX,y:e.pageY}}}const wfe=e=>r=>bR(r)&&e(r,Ix(r));function z0(e,r,a,u){return rx(e,r,wfe(a),u)}const AB=(e,r)=>Math.abs(e-r);function Sfe(e,r){const a=AB(e.x,r.x),u=AB(e.y,r.y);return Math.sqrt(a**2+u**2)}let Hq=class{constructor(r,a,{transformPagePoint:u,contextWindow:p,dragSnapToOrigin:y=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const F=O2(this.lastMoveEventInfo,this.history),V=this.startEvent!==null,G=Sfe(F.offset,{x:0,y:0})>=3;if(!V&&!G)return;const{point:H}=F,{timestamp:Z}=Jl;this.history.push({...H,timestamp:Z});const{onStart:J,onMove:se}=this.handlers;V||(J&&J(this.lastMoveEvent,F),this.startEvent=this.lastMoveEvent),se&&se(this.lastMoveEvent,F)},this.handlePointerMove=(F,V)=>{this.lastMoveEvent=F,this.lastMoveEventInfo=R2(V,this.transformPagePoint),Ts.update(this.updatePoint,!0)},this.handlePointerUp=(F,V)=>{this.end();const{onEnd:G,onSessionEnd:H,resumeAnimation:Z}=this.handlers;if(this.dragSnapToOrigin&&Z&&Z(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const J=O2(F.type==="pointercancel"?this.lastMoveEventInfo:R2(V,this.transformPagePoint),this.history);this.startEvent&&G&&G(F,J),H&&H(F,J)},!bR(r))return;this.dragSnapToOrigin=y,this.handlers=a,this.transformPagePoint=u,this.contextWindow=p||window;const x=Ix(r),i=R2(x,this.transformPagePoint),{point:C}=i,{timestamp:R}=Jl;this.history=[{...C,timestamp:R}];const{onSessionStart:z}=a;z&&z(r,O2(i,this.history)),this.removeListeners=Px(z0(this.contextWindow,"pointermove",this.handlePointerMove),z0(this.contextWindow,"pointerup",this.handlePointerUp),z0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(r){this.handlers=r}end(){this.removeListeners&&this.removeListeners(),Vm(this.updatePoint)}};function R2(e,r){return r?{point:r(e.point)}:e}function DB(e,r){return{x:e.x-r.x,y:e.y-r.y}}function O2({point:e},r){return{point:e,delta:DB(e,Yq(r)),offset:DB(e,Tfe(r)),velocity:Efe(r,.1)}}function Tfe(e){return e[0]}function Yq(e){return e[e.length-1]}function Efe(e,r){if(e.length<2)return{x:0,y:0};let a=e.length-1,u=null;const p=Yq(e);for(;a>=0&&(u=e[a],!(p.timestamp-u.timestamp>Cp(r)));)a--;if(!u)return{x:0,y:0};const y=Ap(p.timestamp-u.timestamp);if(y===0)return{x:0,y:0};const x={x:(p.x-u.x)/y,y:(p.y-u.y)/y};return x.x===1/0&&(x.x=0),x.y===1/0&&(x.y=0),x}const Zq=1e-4,Pfe=1-Zq,Ife=1+Zq,Xq=.01,Mfe=0-Xq,Cfe=0+Xq;function td(e){return e.max-e.min}function Afe(e,r,a){return Math.abs(e-r)<=a}function RB(e,r,a,u=.5){e.origin=u,e.originPoint=ea(r.min,r.max,e.origin),e.scale=td(a)/td(r),e.translate=ea(a.min,a.max,e.origin)-e.originPoint,(e.scale>=Pfe&&e.scale<=Ife||isNaN(e.scale))&&(e.scale=1),(e.translate>=Mfe&&e.translate<=Cfe||isNaN(e.translate))&&(e.translate=0)}function F0(e,r,a,u){RB(e.x,r.x,a.x,u?u.originX:void 0),RB(e.y,r.y,a.y,u?u.originY:void 0)}function OB(e,r,a){e.min=a.min+r.min,e.max=e.min+td(r)}function Dfe(e,r,a){OB(e.x,r.x,a.x),OB(e.y,r.y,a.y)}function LB(e,r,a){e.min=r.min-a.min,e.max=e.min+td(r)}function k0(e,r,a){LB(e.x,r.x,a.x),LB(e.y,r.y,a.y)}function Rfe(e,{min:r,max:a},u){return r!==void 0&&e<r?e=u?ea(r,e,u.min):Math.max(e,r):a!==void 0&&e>a&&(e=u?ea(a,e,u.max):Math.min(e,a)),e}function zB(e,r,a){return{min:r!==void 0?e.min+r:void 0,max:a!==void 0?e.max+a-(e.max-e.min):void 0}}function Ofe(e,{top:r,left:a,bottom:u,right:p}){return{x:zB(e.x,a,p),y:zB(e.y,r,u)}}function FB(e,r){let a=r.min-e.min,u=r.max-e.max;return r.max-r.min<e.max-e.min&&([a,u]=[u,a]),{min:a,max:u}}function Lfe(e,r){return{x:FB(e.x,r.x),y:FB(e.y,r.y)}}function zfe(e,r){let a=.5;const u=td(e),p=td(r);return p>u?a=ky(r.min,r.max-u,e.min):u>p&&(a=ky(e.min,e.max-p,r.min)),Rp(0,1,a)}function Ffe(e,r){const a={};return r.min!==void 0&&(a.min=r.min-e.min),r.max!==void 0&&(a.max=r.max-e.min),a}const NA=.35;function kfe(e=NA){return e===!1?e=0:e===!0&&(e=NA),{x:kB(e,"left","right"),y:kB(e,"top","bottom")}}function kB(e,r,a){return{min:BB(e,r),max:BB(e,a)}}function BB(e,r){return typeof e=="number"?e:e[r]||0}const jB=()=>({translate:0,scale:1,origin:0,originPoint:0}),py=()=>({x:jB(),y:jB()}),NB=()=>({min:0,max:0}),Aa=()=>({x:NB(),y:NB()});function Id(e){return[e("x"),e("y")]}function Kq({top:e,left:r,right:a,bottom:u}){return{x:{min:r,max:a},y:{min:e,max:u}}}function Bfe({x:e,y:r}){return{top:r.min,right:e.max,bottom:r.max,left:e.min}}function jfe(e,r){if(!r)return e;const a=r({x:e.left,y:e.top}),u=r({x:e.right,y:e.bottom});return{top:a.y,left:a.x,bottom:u.y,right:u.x}}function L2(e){return e===void 0||e===1}function VA({scale:e,scaleX:r,scaleY:a}){return!L2(e)||!L2(r)||!L2(a)}function Bg(e){return VA(e)||Qq(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Qq(e){return VB(e.x)||VB(e.y)}function VB(e){return e&&e!=="0%"}function Rw(e,r,a){const u=e-a,p=r*u;return a+p}function UB(e,r,a,u,p){return p!==void 0&&(e=Rw(e,p,u)),Rw(e,a,u)+r}function UA(e,r=0,a=1,u,p){e.min=UB(e.min,r,a,u,p),e.max=UB(e.max,r,a,u,p)}function Jq(e,{x:r,y:a}){UA(e.x,r.translate,r.scale,r.originPoint),UA(e.y,a.translate,a.scale,a.originPoint)}const $B=.999999999999,WB=1.0000000000001;function Nfe(e,r,a,u=!1){const p=a.length;if(!p)return;r.x=r.y=1;let y,x;for(let i=0;i<p;i++){y=a[i],x=y.projectionDelta;const{visualElement:C}=y.options;C&&C.props.style&&C.props.style.display==="contents"||(u&&y.options.layoutScroll&&y.scroll&&y!==y.root&&gy(e,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),x&&(r.x*=x.x.scale,r.y*=x.y.scale,Jq(e,x)),u&&Bg(y.latestValues)&&gy(e,y.latestValues))}r.x<WB&&r.x>$B&&(r.x=1),r.y<WB&&r.y>$B&&(r.y=1)}function my(e,r){e.min=e.min+r,e.max=e.max+r}function qB(e,r,a,u,p=.5){const y=ea(e.min,e.max,p);UA(e,r,a,y,u)}function gy(e,r){qB(e.x,r.x,r.scaleX,r.scale,r.originX),qB(e.y,r.y,r.scaleY,r.scale,r.originY)}function eG(e,r){return Kq(jfe(e.getBoundingClientRect(),r))}function Vfe(e,r,a){const u=eG(e,a),{scroll:p}=r;return p&&(my(u.x,p.offset.x),my(u.y,p.offset.y)),u}const tG=({current:e})=>e?e.ownerDocument.defaultView:null,Ufe=new WeakMap;let $fe=class{constructor(r){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Aa(),this.visualElement=r}start(r,{snapToCursor:a=!1}={}){const{presenceContext:u}=this.visualElement;if(u&&u.isPresent===!1)return;const p=z=>{const{dragSnapToOrigin:F}=this.getProps();F?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(Ix(z).point)},y=(z,F)=>{const{drag:V,dragPropagation:G,onDragStart:H}=this.getProps();if(V&&!G&&(this.openDragLock&&this.openDragLock(),this.openDragLock=zde(V),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Id(J=>{let se=this.getAxisMotionValue(J).get()||0;if(Rf.test(se)){const{projection:pe}=this.visualElement;if(pe&&pe.layout){const ve=pe.layout.layoutBox[J];ve&&(se=td(ve)*(parseFloat(se)/100))}}this.originPoint[J]=se}),H&&Ts.postRender(()=>H(z,F)),RA(this.visualElement,"transform");const{animationState:Z}=this.visualElement;Z&&Z.setActive("whileDrag",!0)},x=(z,F)=>{const{dragPropagation:V,dragDirectionLock:G,onDirectionLock:H,onDrag:Z}=this.getProps();if(!V&&!this.openDragLock)return;const{offset:J}=F;if(G&&this.currentDirection===null){this.currentDirection=Wfe(J),this.currentDirection!==null&&H&&H(this.currentDirection);return}this.updateAxis("x",F.point,J),this.updateAxis("y",F.point,J),this.visualElement.render(),Z&&Z(z,F)},i=(z,F)=>this.stop(z,F),C=()=>Id(z=>{var F;return this.getAnimationState(z)==="paused"&&((F=this.getAxisMotionValue(z).animation)===null||F===void 0?void 0:F.play())}),{dragSnapToOrigin:R}=this.getProps();this.panSession=new Hq(r,{onSessionStart:p,onStart:y,onMove:x,onSessionEnd:i,resumeAnimation:C},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:R,contextWindow:tG(this.visualElement)})}stop(r,a){const u=this.isDragging;if(this.cancel(),!u)return;const{velocity:p}=a;this.startAnimation(p);const{onDragEnd:y}=this.getProps();y&&Ts.postRender(()=>y(r,a))}cancel(){this.isDragging=!1;const{projection:r,animationState:a}=this.visualElement;r&&(r.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:u}=this.getProps();!u&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(r,a,u){const{drag:p}=this.getProps();if(!u||!Hb(r,p,this.currentDirection))return;const y=this.getAxisMotionValue(r);let x=this.originPoint[r]+u[r];this.constraints&&this.constraints[r]&&(x=Rfe(x,this.constraints[r],this.elastic[r])),y.set(x)}resolveConstraints(){var r;const{dragConstraints:a,dragElastic:u}=this.getProps(),p=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(r=this.visualElement.projection)===null||r===void 0?void 0:r.layout,y=this.constraints;a&&hy(a)?this.constraints||(this.constraints=this.resolveRefConstraints()):a&&p?this.constraints=Ofe(p.layoutBox,a):this.constraints=!1,this.elastic=kfe(u),y!==this.constraints&&p&&this.constraints&&!this.hasMutatedConstraints&&Id(x=>{this.constraints!==!1&&this.getAxisMotionValue(x)&&(this.constraints[x]=Ffe(p.layoutBox[x],this.constraints[x]))})}resolveRefConstraints(){const{dragConstraints:r,onMeasureDragConstraints:a}=this.getProps();if(!r||!hy(r))return!1;const u=r.current,{projection:p}=this.visualElement;if(!p||!p.layout)return!1;const y=Vfe(u,p.root,this.visualElement.getTransformPagePoint());let x=Lfe(p.layout.layoutBox,y);if(a){const i=a(Bfe(x));this.hasMutatedConstraints=!!i,i&&(x=Kq(i))}return x}startAnimation(r){const{drag:a,dragMomentum:u,dragElastic:p,dragTransition:y,dragSnapToOrigin:x,onDragTransitionEnd:i}=this.getProps(),C=this.constraints||{},R=Id(z=>{if(!Hb(z,a,this.currentDirection))return;let F=C&&C[z]||{};x&&(F={min:0,max:0});const V=p?200:1e6,G=p?40:1e7,H={type:"inertia",velocity:u?r[z]:0,bounceStiffness:V,bounceDamping:G,timeConstant:750,restDelta:1,restSpeed:10,...y,...F};return this.startAxisValueAnimation(z,H)});return Promise.all(R).then(i)}startAxisValueAnimation(r,a){const u=this.getAxisMotionValue(r);return RA(this.visualElement,r),u.start(OR(r,u,0,a,this.visualElement,!1))}stopAnimation(){Id(r=>this.getAxisMotionValue(r).stop())}pauseAnimation(){Id(r=>{var a;return(a=this.getAxisMotionValue(r).animation)===null||a===void 0?void 0:a.pause()})}getAnimationState(r){var a;return(a=this.getAxisMotionValue(r).animation)===null||a===void 0?void 0:a.state}getAxisMotionValue(r){const a=`_drag${r.toUpperCase()}`,u=this.visualElement.getProps(),p=u[a];return p||this.visualElement.getValue(r,(u.initial?u.initial[r]:void 0)||0)}snapToCursor(r){Id(a=>{const{drag:u}=this.getProps();if(!Hb(a,u,this.currentDirection))return;const{projection:p}=this.visualElement,y=this.getAxisMotionValue(a);if(p&&p.layout){const{min:x,max:i}=p.layout.layoutBox[a];y.set(r[a]-ea(x,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:r,dragConstraints:a}=this.getProps(),{projection:u}=this.visualElement;if(!hy(a)||!u||!this.constraints)return;this.stopAnimation();const p={x:0,y:0};Id(x=>{const i=this.getAxisMotionValue(x);if(i&&this.constraints!==!1){const C=i.get();p[x]=zfe({min:C,max:C},this.constraints[x])}});const{transformTemplate:y}=this.visualElement.getProps();this.visualElement.current.style.transform=y?y({},""):"none",u.root&&u.root.updateScroll(),u.updateLayout(),this.resolveConstraints(),Id(x=>{if(!Hb(x,r,null))return;const i=this.getAxisMotionValue(x),{min:C,max:R}=this.constraints[x];i.set(ea(C,R,p[x]))})}addListeners(){if(!this.visualElement.current)return;Ufe.set(this.visualElement,this);const r=this.visualElement.current,a=z0(r,"pointerdown",C=>{const{drag:R,dragListener:z=!0}=this.getProps();R&&z&&this.start(C)}),u=()=>{const{dragConstraints:C}=this.getProps();hy(C)&&C.current&&(this.constraints=this.resolveRefConstraints())},{projection:p}=this.visualElement,y=p.addEventListener("measure",u);p&&!p.layout&&(p.root&&p.root.updateScroll(),p.updateLayout()),Ts.read(u);const x=rx(window,"resize",()=>this.scalePositionWithinConstraints()),i=p.addEventListener("didUpdate",(({delta:C,hasLayoutChanged:R})=>{this.isDragging&&R&&(Id(z=>{const F=this.getAxisMotionValue(z);F&&(this.originPoint[z]+=C[z].translate,F.set(F.get()+C[z].translate))}),this.visualElement.render())}));return()=>{x(),a(),y(),i&&i()}}getProps(){const r=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:u=!1,dragPropagation:p=!1,dragConstraints:y=!1,dragElastic:x=NA,dragMomentum:i=!0}=r;return{...r,drag:a,dragDirectionLock:u,dragPropagation:p,dragConstraints:y,dragElastic:x,dragMomentum:i}}};function Hb(e,r,a){return(r===!0||r===e)&&(a===null||a===e)}function Wfe(e,r=10){let a=null;return Math.abs(e.y)>r?a="y":Math.abs(e.x)>r&&(a="x"),a}let qfe=class extends Gm{constructor(r){super(r),this.removeGroupControls=ed,this.removeListeners=ed,this.controls=new $fe(r)}mount(){const{dragControls:r}=this.node.getProps();r&&(this.removeGroupControls=r.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ed}unmount(){this.removeGroupControls(),this.removeListeners()}};const GB=e=>(r,a)=>{e&&Ts.postRender(()=>e(r,a))};let Gfe=class extends Gm{constructor(){super(...arguments),this.removePointerDownListener=ed}onPointerDown(r){this.session=new Hq(r,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:tG(this.node)})}createPanHandlers(){const{onPanSessionStart:r,onPanStart:a,onPan:u,onPanEnd:p}=this.node.getProps();return{onSessionStart:GB(r),onStart:GB(a),onMove:u,onEnd:(y,x)=>{delete this.session,p&&Ts.postRender(()=>p(y,x))}}}mount(){this.removePointerDownListener=z0(this.node.current,"pointerdown",r=>this.onPointerDown(r))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}};const cw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function HB(e,r){return r.max===r.min?0:e/(r.max-r.min)*100}const t0={correct:(e,r)=>{if(!r.target)return e;if(typeof e=="string")if(ni.test(e))e=parseFloat(e);else return e;const a=HB(e,r.target.x),u=HB(e,r.target.y);return`${a}% ${u}%`}},Hfe={correct:(e,{treeScale:r,projectionDelta:a})=>{const u=e,p=Um.parse(e);if(p.length>5)return u;const y=Um.createTransformer(e),x=typeof p[0]!="number"?1:0,i=a.x.scale*r.x,C=a.y.scale*r.y;p[0+x]/=i,p[1+x]/=C;const R=ea(i,C,.5);return typeof p[2+x]=="number"&&(p[2+x]/=R),typeof p[3+x]=="number"&&(p[3+x]/=R),y(p)}};let Yfe=class extends ge.Component{componentDidMount(){const{visualElement:r,layoutGroup:a,switchLayoutGroup:u,layoutId:p}=this.props,{projection:y}=r;pde(Zfe),y&&(a.group&&a.group.add(y),u&&u.register&&p&&u.register(y),y.root.didUpdate(),y.addEventListener("animationComplete",()=>{this.safeToRemove()}),y.setOptions({...y.options,onExitComplete:()=>this.safeToRemove()})),cw.hasEverUpdated=!0}getSnapshotBeforeUpdate(r){const{layoutDependency:a,visualElement:u,drag:p,isPresent:y}=this.props,x=u.projection;return x&&(x.isPresent=y,p||r.layoutDependency!==a||a===void 0?x.willUpdate():this.safeToRemove(),r.isPresent!==y&&(y?x.promote():x.relegate()||Ts.postRender(()=>{const i=x.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:r}=this.props.visualElement;r&&(r.root.didUpdate(),lR.postRender(()=>{!r.currentAnimation&&r.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:r,layoutGroup:a,switchLayoutGroup:u}=this.props,{projection:p}=r;p&&(p.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(p),u&&u.deregister&&u.deregister(p))}safeToRemove(){const{safeToRemove:r}=this.props;r&&r()}render(){return null}};function rG(e){const[r,a]=rR(),u=ge.useContext(JD);return X.jsx(Yfe,{...e,layoutGroup:u,switchLayoutGroup:ge.useContext(G8),isPresent:r,safeToRemove:a})}const Zfe={borderRadius:{...t0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:t0,borderTopRightRadius:t0,borderBottomLeftRadius:t0,borderBottomRightRadius:t0,boxShadow:Hfe};function Xfe(e,r,a){const u=Cc(e)?e:ex(e);return u.start(OR("",u,r,a)),u.animation}function Kfe(e){return e instanceof SVGElement&&e.tagName!=="svg"}const Qfe=(e,r)=>e.depth-r.depth;let Jfe=class{constructor(){this.children=[],this.isDirty=!1}add(r){wR(this.children,r),this.isDirty=!0}remove(r){SR(this.children,r),this.isDirty=!0}forEach(r){this.isDirty&&this.children.sort(Qfe),this.isDirty=!1,this.children.forEach(r)}};function epe(e,r){const a=Of.now(),u=({timestamp:p})=>{const y=p-a;y>=r&&(Vm(u),e(y-r))};return Ts.read(u,!0),()=>Vm(u)}const nG=["TopLeft","TopRight","BottomLeft","BottomRight"],tpe=nG.length,YB=e=>typeof e=="string"?parseFloat(e):e,ZB=e=>typeof e=="number"||ni.test(e);function rpe(e,r,a,u,p,y){p?(e.opacity=ea(0,a.opacity!==void 0?a.opacity:1,npe(u)),e.opacityExit=ea(r.opacity!==void 0?r.opacity:1,0,ipe(u))):y&&(e.opacity=ea(r.opacity!==void 0?r.opacity:1,a.opacity!==void 0?a.opacity:1,u));for(let x=0;x<tpe;x++){const i=`border${nG[x]}Radius`;let C=XB(r,i),R=XB(a,i);if(C===void 0&&R===void 0)continue;C||(C=0),R||(R=0),C===0||R===0||ZB(C)===ZB(R)?(e[i]=Math.max(ea(YB(C),YB(R),u),0),(Rf.test(R)||Rf.test(C))&&(e[i]+="%")):e[i]=R}(r.rotate||a.rotate)&&(e.rotate=ea(r.rotate||0,a.rotate||0,u))}function XB(e,r){return e[r]!==void 0?e[r]:e.borderRadius}const npe=iG(0,.5,wq),ipe=iG(.5,.95,ed);function iG(e,r,a){return u=>u<e?0:u>r?1:a(ky(e,r,u))}function KB(e,r){e.min=r.min,e.max=r.max}function Ed(e,r){KB(e.x,r.x),KB(e.y,r.y)}function QB(e,r){e.translate=r.translate,e.scale=r.scale,e.originPoint=r.originPoint,e.origin=r.origin}function JB(e,r,a,u,p){return e-=r,e=Rw(e,1/a,u),p!==void 0&&(e=Rw(e,1/p,u)),e}function ope(e,r=0,a=1,u=.5,p,y=e,x=e){if(Rf.test(r)&&(r=parseFloat(r),r=ea(x.min,x.max,r/100)-x.min),typeof r!="number")return;let i=ea(y.min,y.max,u);e===y&&(i-=r),e.min=JB(e.min,r,a,i,p),e.max=JB(e.max,r,a,i,p)}function ej(e,r,[a,u,p],y,x){ope(e,r[a],r[u],r[p],r.scale,y,x)}const spe=["x","scaleX","originX"],ape=["y","scaleY","originY"];function tj(e,r,a,u){ej(e.x,r,spe,a?a.x:void 0,u?u.x:void 0),ej(e.y,r,ape,a?a.y:void 0,u?u.y:void 0)}function rj(e){return e.translate===0&&e.scale===1}function oG(e){return rj(e.x)&&rj(e.y)}function nj(e,r){return e.min===r.min&&e.max===r.max}function lpe(e,r){return nj(e.x,r.x)&&nj(e.y,r.y)}function ij(e,r){return Math.round(e.min)===Math.round(r.min)&&Math.round(e.max)===Math.round(r.max)}function sG(e,r){return ij(e.x,r.x)&&ij(e.y,r.y)}function oj(e){return td(e.x)/td(e.y)}function sj(e,r){return e.translate===r.translate&&e.scale===r.scale&&e.originPoint===r.originPoint}let cpe=class{constructor(){this.members=[]}add(r){wR(this.members,r),r.scheduleRender()}remove(r){if(SR(this.members,r),r===this.prevLead&&(this.prevLead=void 0),r===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(r){const a=this.members.findIndex(p=>r===p);if(a===0)return!1;let u;for(let p=a;p>=0;p--){const y=this.members[p];if(y.isPresent!==!1){u=y;break}}return u?(this.promote(u),!0):!1}promote(r,a){const u=this.lead;if(r!==u&&(this.prevLead=u,this.lead=r,r.show(),u)){u.instance&&u.scheduleRender(),r.scheduleRender(),r.resumeFrom=u,a&&(r.resumeFrom.preserveOpacity=!0),u.snapshot&&(r.snapshot=u.snapshot,r.snapshot.latestValues=u.animationValues||u.latestValues),r.root&&r.root.isUpdating&&(r.isLayoutDirty=!0);const{crossfade:p}=r.options;p===!1&&u.hide()}}exitAnimationComplete(){this.members.forEach(r=>{const{options:a,resumingFrom:u}=r;a.onExitComplete&&a.onExitComplete(),u&&u.options.onExitComplete&&u.options.onExitComplete()})}scheduleRender(){this.members.forEach(r=>{r.instance&&r.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}};function upe(e,r,a){let u="";const p=e.x.translate/r.x,y=e.y.translate/r.y,x=a?.z||0;if((p||y||x)&&(u=`translate3d(${p}px, ${y}px, ${x}px) `),(r.x!==1||r.y!==1)&&(u+=`scale(${1/r.x}, ${1/r.y}) `),a){const{transformPerspective:R,rotate:z,rotateX:F,rotateY:V,skewX:G,skewY:H}=a;R&&(u=`perspective(${R}px) ${u}`),z&&(u+=`rotate(${z}deg) `),F&&(u+=`rotateX(${F}deg) `),V&&(u+=`rotateY(${V}deg) `),G&&(u+=`skewX(${G}deg) `),H&&(u+=`skewY(${H}deg) `)}const i=e.x.scale*r.x,C=e.y.scale*r.y;return(i!==1||C!==1)&&(u+=`scale(${i}, ${C})`),u||"none"}const jg={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},w0=typeof window<"u"&&window.MotionDebug!==void 0,z2=["","X","Y","Z"],dpe={visibility:"hidden"},aj=1e3;let hpe=0;function F2(e,r,a,u){const{latestValues:p}=r;p[e]&&(a[e]=p[e],r.setStaticValue(e,0),u&&(u[e]=0))}function aG(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:r}=e.options;if(!r)return;const a=mq(r);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:p,layoutId:y}=e.options;window.MotionCancelOptimisedAnimation(a,"transform",Ts,!(p||y))}const{parent:u}=e;u&&!u.hasCheckedOptimisedAppear&&aG(u)}function lG({attachResizeListener:e,defaultParent:r,measureScroll:a,checkIsScrollRoot:u,resetTransform:p}){return class{constructor(x={},i=r?.()){this.id=hpe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,w0&&(jg.totalNodes=jg.resolvedTargetDeltas=jg.recalculatedProjection=0),this.nodes.forEach(mpe),this.nodes.forEach(xpe),this.nodes.forEach(bpe),this.nodes.forEach(gpe),w0&&window.MotionDebug.record(jg)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=x,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let C=0;C<this.path.length;C++)this.path[C].shouldResetTransform=!0;this.root===this&&(this.nodes=new Jfe)}addEventListener(x,i){return this.eventHandlers.has(x)||this.eventHandlers.set(x,new TR),this.eventHandlers.get(x).add(i)}notifyListeners(x,...i){const C=this.eventHandlers.get(x);C&&C.notify(...i)}hasListeners(x){return this.eventHandlers.has(x)}mount(x,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Kfe(x),this.instance=x;const{layoutId:C,layout:R,visualElement:z}=this.options;if(z&&!z.current&&z.mount(x),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(R||C)&&(this.isLayoutDirty=!0),e){let F;const V=()=>this.root.updateBlockedByResize=!1;e(x,()=>{this.root.updateBlockedByResize=!0,F&&F(),F=epe(V,250),cw.hasAnimatedSinceResize&&(cw.hasAnimatedSinceResize=!1,this.nodes.forEach(cj))})}C&&this.root.registerSharedNode(C,this),this.options.animate!==!1&&z&&(C||R)&&this.addEventListener("didUpdate",({delta:F,hasLayoutChanged:V,hasRelativeTargetChanged:G,layout:H})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Z=this.options.transition||z.getDefaultTransition()||Ppe,{onLayoutAnimationStart:J,onLayoutAnimationComplete:se}=z.getProps(),pe=!this.targetLayout||!sG(this.targetLayout,H)||G,ve=!V&&G;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||ve||V&&(pe||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(F,ve);const Ne={...yR(Z,"layout"),onPlay:J,onComplete:se};(z.shouldReduceMotion||this.options.layoutRoot)&&(Ne.delay=0,Ne.type=!1),this.startAnimation(Ne)}else V||cj(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=H})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const x=this.getStack();x&&x.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Vm(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(wpe),this.animationId++)}getTransformTemplate(){const{visualElement:x}=this.options;return x&&x.getProps().transformTemplate}willUpdate(x=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&aG(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let z=0;z<this.path.length;z++){const F=this.path[z];F.shouldResetTransform=!0,F.updateScroll("snapshot"),F.options.layoutRoot&&F.willUpdate(!1)}const{layoutId:i,layout:C}=this.options;if(i===void 0&&!C)return;const R=this.getTransformTemplate();this.prevTransformTemplateValue=R?R(this.latestValues,""):void 0,this.updateSnapshot(),x&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(lj);return}this.isUpdating||this.nodes.forEach(ype),this.isUpdating=!1,this.nodes.forEach(vpe),this.nodes.forEach(fpe),this.nodes.forEach(ppe),this.clearAllSnapshots();const i=Of.now();Jl.delta=Rp(0,1e3/60,i-Jl.timestamp),Jl.timestamp=i,Jl.isProcessing=!0,P2.update.process(Jl),P2.preRender.process(Jl),P2.render.process(Jl),Jl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,lR.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(_pe),this.sharedNodes.forEach(Spe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ts.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ts.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let C=0;C<this.path.length;C++)this.path[C].updateScroll();const x=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Aa(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,x?x.layoutBox:void 0)}updateScroll(x="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===x&&(i=!1),i){const C=u(this.instance);this.scroll={animationId:this.root.animationId,phase:x,isRoot:C,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:C}}}resetTransform(){if(!p)return;const x=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!oG(this.projectionDelta),C=this.getTransformTemplate(),R=C?C(this.latestValues,""):void 0,z=R!==this.prevTransformTemplateValue;x&&(i||Bg(this.latestValues)||z)&&(p(this.instance,R),this.shouldResetTransform=!1,this.scheduleRender())}measure(x=!0){const i=this.measurePageBox();let C=this.removeElementScroll(i);return x&&(C=this.removeTransform(C)),Ipe(C),{animationId:this.root.animationId,measuredBox:i,layoutBox:C,latestValues:{},source:this.id}}measurePageBox(){var x;const{visualElement:i}=this.options;if(!i)return Aa();const C=i.measureViewportBox();if(!(((x=this.scroll)===null||x===void 0?void 0:x.wasRoot)||this.path.some(Mpe))){const{scroll:z}=this.root;z&&(my(C.x,z.offset.x),my(C.y,z.offset.y))}return C}removeElementScroll(x){var i;const C=Aa();if(Ed(C,x),!((i=this.scroll)===null||i===void 0)&&i.wasRoot)return C;for(let R=0;R<this.path.length;R++){const z=this.path[R],{scroll:F,options:V}=z;z!==this.root&&F&&V.layoutScroll&&(F.wasRoot&&Ed(C,x),my(C.x,F.offset.x),my(C.y,F.offset.y))}return C}applyTransform(x,i=!1){const C=Aa();Ed(C,x);for(let R=0;R<this.path.length;R++){const z=this.path[R];!i&&z.options.layoutScroll&&z.scroll&&z!==z.root&&gy(C,{x:-z.scroll.offset.x,y:-z.scroll.offset.y}),Bg(z.latestValues)&&gy(C,z.latestValues)}return Bg(this.latestValues)&&gy(C,this.latestValues),C}removeTransform(x){const i=Aa();Ed(i,x);for(let C=0;C<this.path.length;C++){const R=this.path[C];if(!R.instance||!Bg(R.latestValues))continue;VA(R.latestValues)&&R.updateSnapshot();const z=Aa(),F=R.measurePageBox();Ed(z,F),tj(i,R.latestValues,R.snapshot?R.snapshot.layoutBox:void 0,z)}return Bg(this.latestValues)&&tj(i,this.latestValues),i}setTargetDelta(x){this.targetDelta=x,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(x){this.options={...this.options,...x,crossfade:x.crossfade!==void 0?x.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Jl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(x=!1){var i;const C=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=C.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=C.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=C.isSharedProjectionDirty);const R=!!this.resumingFrom||this!==C;if(!(x||R&&this.isSharedProjectionDirty||this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:F,layoutId:V}=this.options;if(!(!this.layout||!(F||V))){if(this.resolvedRelativeTargetAt=Jl.timestamp,!this.targetDelta&&!this.relativeTarget){const G=this.getClosestProjectingParent();G&&G.layout&&this.animationProgress!==1?(this.relativeParent=G,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Aa(),this.relativeTargetOrigin=Aa(),k0(this.relativeTargetOrigin,this.layout.layoutBox,G.layout.layoutBox),Ed(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Aa(),this.targetWithTransforms=Aa()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Dfe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ed(this.target,this.layout.layoutBox),Jq(this.target,this.targetDelta)):Ed(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const G=this.getClosestProjectingParent();G&&!!G.resumingFrom==!!this.resumingFrom&&!G.options.layoutScroll&&G.target&&this.animationProgress!==1?(this.relativeParent=G,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Aa(),this.relativeTargetOrigin=Aa(),k0(this.relativeTargetOrigin,this.target,G.target),Ed(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}w0&&jg.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||VA(this.parent.latestValues)||Qq(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const i=this.getLead(),C=!!this.resumingFrom||this!==i;let R=!0;if((this.isProjectionDirty||!((x=this.parent)===null||x===void 0)&&x.isProjectionDirty)&&(R=!1),C&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(R=!1),this.resolvedRelativeTargetAt===Jl.timestamp&&(R=!1),R)return;const{layout:z,layoutId:F}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(z||F))return;Ed(this.layoutCorrected,this.layout.layoutBox);const V=this.treeScale.x,G=this.treeScale.y;Nfe(this.layoutCorrected,this.treeScale,this.path,C),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Aa());const{target:H}=i;if(!H){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(QB(this.prevProjectionDelta.x,this.projectionDelta.x),QB(this.prevProjectionDelta.y,this.projectionDelta.y)),F0(this.projectionDelta,this.layoutCorrected,H,this.latestValues),(this.treeScale.x!==V||this.treeScale.y!==G||!sj(this.projectionDelta.x,this.prevProjectionDelta.x)||!sj(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",H)),w0&&jg.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(x=!0){var i;if((i=this.options.visualElement)===null||i===void 0||i.scheduleRender(),x){const C=this.getStack();C&&C.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=py(),this.projectionDelta=py(),this.projectionDeltaWithTransform=py()}setAnimationOrigin(x,i=!1){const C=this.snapshot,R=C?C.latestValues:{},z={...this.latestValues},F=py();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const V=Aa(),G=C?C.source:void 0,H=this.layout?this.layout.source:void 0,Z=G!==H,J=this.getStack(),se=!J||J.members.length<=1,pe=!!(Z&&!se&&this.options.crossfade===!0&&!this.path.some(Epe));this.animationProgress=0;let ve;this.mixTargetDelta=Ne=>{const _e=Ne/1e3;uj(F.x,x.x,_e),uj(F.y,x.y,_e),this.setTargetDelta(F),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(k0(V,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Tpe(this.relativeTarget,this.relativeTargetOrigin,V,_e),ve&&lpe(this.relativeTarget,ve)&&(this.isProjectionDirty=!1),ve||(ve=Aa()),Ed(ve,this.relativeTarget)),Z&&(this.animationValues=z,rpe(z,R,this.latestValues,_e,pe,se)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_e},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(x){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Vm(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ts.update(()=>{cw.hasAnimatedSinceResize=!0,this.currentAnimation=Xfe(0,aj,{...x,onUpdate:i=>{this.mixTargetDelta(i),x.onUpdate&&x.onUpdate(i)},onComplete:()=>{x.onComplete&&x.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const x=this.getStack();x&&x.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aj),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const x=this.getLead();let{targetWithTransforms:i,target:C,layout:R,latestValues:z}=x;if(!(!i||!C||!R)){if(this!==x&&this.layout&&R&&cG(this.options.animationType,this.layout.layoutBox,R.layoutBox)){C=this.target||Aa();const F=td(this.layout.layoutBox.x);C.x.min=x.target.x.min,C.x.max=C.x.min+F;const V=td(this.layout.layoutBox.y);C.y.min=x.target.y.min,C.y.max=C.y.min+V}Ed(i,C),gy(i,z),F0(this.projectionDeltaWithTransform,this.layoutCorrected,i,z)}}registerSharedNode(x,i){this.sharedNodes.has(x)||this.sharedNodes.set(x,new cpe),this.sharedNodes.get(x).add(i);const R=i.options.initialPromotionConfig;i.promote({transition:R?R.transition:void 0,preserveFollowOpacity:R&&R.shouldPreserveFollowOpacity?R.shouldPreserveFollowOpacity(i):void 0})}isLead(){const x=this.getStack();return x?x.lead===this:!0}getLead(){var x;const{layoutId:i}=this.options;return i?((x=this.getStack())===null||x===void 0?void 0:x.lead)||this:this}getPrevLead(){var x;const{layoutId:i}=this.options;return i?(x=this.getStack())===null||x===void 0?void 0:x.prevLead:void 0}getStack(){const{layoutId:x}=this.options;if(x)return this.root.sharedNodes.get(x)}promote({needsReset:x,transition:i,preserveFollowOpacity:C}={}){const R=this.getStack();R&&R.promote(this,C),x&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const x=this.getStack();return x?x.relegate(this):!1}resetSkewAndRotation(){const{visualElement:x}=this.options;if(!x)return;let i=!1;const{latestValues:C}=x;if((C.z||C.rotate||C.rotateX||C.rotateY||C.rotateZ||C.skewX||C.skewY)&&(i=!0),!i)return;const R={};C.z&&F2("z",x,R,this.animationValues);for(let z=0;z<z2.length;z++)F2(`rotate${z2[z]}`,x,R,this.animationValues),F2(`skew${z2[z]}`,x,R,this.animationValues);x.render();for(const z in R)x.setStaticValue(z,R[z]),this.animationValues&&(this.animationValues[z]=R[z]);x.scheduleRender()}getProjectionStyles(x){var i,C;if(!this.instance||this.isSVG)return;if(!this.isVisible)return dpe;const R={visibility:""},z=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,R.opacity="",R.pointerEvents=aw(x?.pointerEvents)||"",R.transform=z?z(this.latestValues,""):"none",R;const F=this.getLead();if(!this.projectionDelta||!this.layout||!F.target){const Z={};return this.options.layoutId&&(Z.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,Z.pointerEvents=aw(x?.pointerEvents)||""),this.hasProjected&&!Bg(this.latestValues)&&(Z.transform=z?z({},""):"none",this.hasProjected=!1),Z}const V=F.animationValues||F.latestValues;this.applyTransformsToTarget(),R.transform=upe(this.projectionDeltaWithTransform,this.treeScale,V),z&&(R.transform=z(V,R.transform));const{x:G,y:H}=this.projectionDelta;R.transformOrigin=`${G.origin*100}% ${H.origin*100}% 0`,F.animationValues?R.opacity=F===this?(C=(i=V.opacity)!==null&&i!==void 0?i:this.latestValues.opacity)!==null&&C!==void 0?C:1:this.preserveOpacity?this.latestValues.opacity:V.opacityExit:R.opacity=F===this?V.opacity!==void 0?V.opacity:"":V.opacityExit!==void 0?V.opacityExit:0;for(const Z in Iw){if(V[Z]===void 0)continue;const{correct:J,applyTo:se}=Iw[Z],pe=R.transform==="none"?V[Z]:J(V[Z],F);if(se){const ve=se.length;for(let Ne=0;Ne<ve;Ne++)R[se[Ne]]=pe}else R[Z]=pe}return this.options.layoutId&&(R.pointerEvents=F===this?aw(x?.pointerEvents)||"":"none"),R}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(x=>{var i;return(i=x.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(lj),this.root.sharedNodes.clear()}}}function fpe(e){e.updateLayout()}function ppe(e){var r;const a=((r=e.resumeFrom)===null||r===void 0?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&a&&e.hasListeners("didUpdate")){const{layoutBox:u,measuredBox:p}=e.layout,{animationType:y}=e.options,x=a.source!==e.layout.source;y==="size"?Id(F=>{const V=x?a.measuredBox[F]:a.layoutBox[F],G=td(V);V.min=u[F].min,V.max=V.min+G}):cG(y,a.layoutBox,u)&&Id(F=>{const V=x?a.measuredBox[F]:a.layoutBox[F],G=td(u[F]);V.max=V.min+G,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[F].max=e.relativeTarget[F].min+G)});const i=py();F0(i,u,a.layoutBox);const C=py();x?F0(C,e.applyTransform(p,!0),a.measuredBox):F0(C,u,a.layoutBox);const R=!oG(i);let z=!1;if(!e.resumeFrom){const F=e.getClosestProjectingParent();if(F&&!F.resumeFrom){const{snapshot:V,layout:G}=F;if(V&&G){const H=Aa();k0(H,a.layoutBox,V.layoutBox);const Z=Aa();k0(Z,u,G.layoutBox),sG(H,Z)||(z=!0),F.options.layoutRoot&&(e.relativeTarget=Z,e.relativeTargetOrigin=H,e.relativeParent=F)}}}e.notifyListeners("didUpdate",{layout:u,snapshot:a,delta:C,layoutDelta:i,hasLayoutChanged:R,hasRelativeTargetChanged:z})}else if(e.isLead()){const{onExitComplete:u}=e.options;u&&u()}e.options.transition=void 0}function mpe(e){w0&&jg.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function gpe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function _pe(e){e.clearSnapshot()}function lj(e){e.clearMeasurements()}function ype(e){e.isLayoutDirty=!1}function vpe(e){const{visualElement:r}=e.options;r&&r.getProps().onBeforeLayoutMeasure&&r.notify("BeforeLayoutMeasure"),e.resetTransform()}function cj(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function xpe(e){e.resolveTargetDelta()}function bpe(e){e.calcProjection()}function wpe(e){e.resetSkewAndRotation()}function Spe(e){e.removeLeadSnapshot()}function uj(e,r,a){e.translate=ea(r.translate,0,a),e.scale=ea(r.scale,1,a),e.origin=r.origin,e.originPoint=r.originPoint}function dj(e,r,a,u){e.min=ea(r.min,a.min,u),e.max=ea(r.max,a.max,u)}function Tpe(e,r,a,u){dj(e.x,r.x,a.x,u),dj(e.y,r.y,a.y,u)}function Epe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Ppe={duration:.45,ease:[.4,0,.1,1]},hj=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),fj=hj("applewebkit/")&&!hj("chrome/")?Math.round:ed;function pj(e){e.min=fj(e.min),e.max=fj(e.max)}function Ipe(e){pj(e.x),pj(e.y)}function cG(e,r,a){return e==="position"||e==="preserve-aspect"&&!Afe(oj(r),oj(a),.2)}function Mpe(e){var r;return e!==e.root&&((r=e.scroll)===null||r===void 0?void 0:r.wasRoot)}const Cpe=lG({attachResizeListener:(e,r)=>rx(e,"resize",r),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),k2={current:void 0},uG=lG({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!k2.current){const e=new Cpe({});e.mount(window),e.setOptions({layoutScroll:!0}),k2.current=e}return k2.current},resetTransform:(e,r)=>{e.style.transform=r!==void 0?r:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Ape={pan:{Feature:Gfe},drag:{Feature:qfe,ProjectionNode:uG,MeasureLayout:rG}};function mj(e,r,a){const{props:u}=e;e.animationState&&u.whileHover&&e.animationState.setActive("whileHover",a==="Start");const p="onHover"+a,y=u[p];y&&Ts.postRender(()=>y(r,Ix(r)))}let Dpe=class extends Gm{mount(){const{current:r}=this.node;r&&(this.unmount=Ade(r,a=>(mj(this.node,a,"Start"),u=>mj(this.node,u,"End"))))}unmount(){}},Rpe=class extends Gm{constructor(){super(...arguments),this.isActive=!1}onFocus(){let r=!1;try{r=this.node.current.matches(":focus-visible")}catch{r=!0}!r||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Px(rx(this.node.current,"focus",()=>this.onFocus()),rx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}};function gj(e,r,a){const{props:u}=e;e.animationState&&u.whileTap&&e.animationState.setActive("whileTap",a==="Start");const p="onTap"+(a==="End"?"":a),y=u[p];y&&Ts.postRender(()=>y(r,Ix(r)))}let Ope=class extends Gm{mount(){const{current:r}=this.node;r&&(this.unmount=Lde(r,a=>(gj(this.node,a,"Start"),(u,{success:p})=>gj(this.node,u,p?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}};const $A=new WeakMap,B2=new WeakMap,Lpe=e=>{const r=$A.get(e.target);r&&r(e)},zpe=e=>{e.forEach(Lpe)};function Fpe({root:e,...r}){const a=e||document;B2.has(a)||B2.set(a,{});const u=B2.get(a),p=JSON.stringify(r);return u[p]||(u[p]=new IntersectionObserver(zpe,{root:e,...r})),u[p]}function kpe(e,r,a){const u=Fpe(r);return $A.set(e,a),u.observe(e),()=>{$A.delete(e),u.unobserve(e)}}const Bpe={some:0,all:1};let jpe=class extends Gm{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:r={}}=this.node.getProps(),{root:a,margin:u,amount:p="some",once:y}=r,x={root:a?a.current:void 0,rootMargin:u,threshold:typeof p=="number"?p:Bpe[p]},i=C=>{const{isIntersecting:R}=C;if(this.isInView===R||(this.isInView=R,y&&!R&&this.hasEnteredView))return;R&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",R);const{onViewportEnter:z,onViewportLeave:F}=this.node.getProps(),V=R?z:F;V&&V(C)};return kpe(this.node.current,x,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:r,prevProps:a}=this.node;["amount","margin","root"].some(Npe(r,a))&&this.startObserver()}unmount(){}};function Npe({viewport:e={}},{viewport:r={}}={}){return a=>e[a]!==r[a]}const Vpe={inView:{Feature:jpe},tap:{Feature:Ope},focus:{Feature:Rpe},hover:{Feature:Dpe}},Upe={layout:{ProjectionNode:uG,MeasureLayout:rG}},WA={current:null},dG={current:!1};function $pe(){if(dG.current=!0,!!nR)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),r=()=>WA.current=e.matches;e.addListener(r),r()}else WA.current=!1}const Wpe=[...Fq,Pc,Um],qpe=e=>Wpe.find(zq(e)),_j=new WeakMap;function Gpe(e,r,a){for(const u in r){const p=r[u],y=a[u];if(Cc(p))e.addValue(u,p);else if(Cc(y))e.addValue(u,ex(p,{owner:e}));else if(y!==p)if(e.hasValue(u)){const x=e.getValue(u);x.liveStyle===!0?x.jump(p):x.hasAnimated||x.set(p)}else{const x=e.getStaticValue(u);e.addValue(u,ex(x!==void 0?x:p,{owner:e}))}}for(const u in a)r[u]===void 0&&e.removeValue(u);return r}const yj=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Hpe=class{scrapeMotionValuesFromProps(r,a,u){return{}}constructor({parent:r,props:a,presenceContext:u,reducedMotionConfig:p,blockInitialAnimation:y,visualState:x},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=AR,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const G=Of.now();this.renderScheduledAt<G&&(this.renderScheduledAt=G,Ts.render(this.render,!1,!0))};const{latestValues:C,renderState:R,onUpdate:z}=x;this.onUpdate=z,this.latestValues=C,this.baseTarget={...C},this.initialValues=a.initial?{...C}:{},this.renderState=R,this.parent=r,this.props=a,this.presenceContext=u,this.depth=r?r.depth+1:0,this.reducedMotionConfig=p,this.options=i,this.blockInitialAnimation=!!y,this.isControllingVariants=uS(a),this.isVariantNode=W8(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(r&&r.current);const{willChange:F,...V}=this.scrapeMotionValuesFromProps(a,{},this);for(const G in V){const H=V[G];C[G]!==void 0&&Cc(H)&&H.set(C[G],!1)}}mount(r){this.current=r,_j.set(r,this),this.projection&&!this.projection.instance&&this.projection.mount(r),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,u)=>this.bindToMotionValue(u,a)),dG.current||$pe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:WA.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){_j.delete(this.current),this.projection&&this.projection.unmount(),Vm(this.notifyUpdate),Vm(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const a=this.features[r];a&&(a.unmount(),a.isMounted=!1)}this.current=null}bindToMotionValue(r,a){this.valueSubscriptions.has(r)&&this.valueSubscriptions.get(r)();const u=d_.has(r),p=a.on("change",i=>{this.latestValues[r]=i,this.props.onUpdate&&Ts.preRender(this.notifyUpdate),u&&this.projection&&(this.projection.isTransformDirty=!0)}),y=a.on("renderRequest",this.scheduleRender);let x;window.MotionCheckAppearSync&&(x=window.MotionCheckAppearSync(this,r,a)),this.valueSubscriptions.set(r,()=>{p(),y(),x&&x(),a.owner&&a.stop()})}sortNodePosition(r){return!this.current||!this.sortInstanceNodePosition||this.type!==r.type?0:this.sortInstanceNodePosition(this.current,r.current)}updateFeatures(){let r="animation";for(r in By){const a=By[r];if(!a)continue;const{isEnabled:u,Feature:p}=a;if(!this.features[r]&&p&&u(this.props)&&(this.features[r]=new p(this)),this.features[r]){const y=this.features[r];y.isMounted?y.update():(y.mount(),y.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Aa()}getStaticValue(r){return this.latestValues[r]}setStaticValue(r,a){this.latestValues[r]=a}update(r,a){(r.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=r,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let u=0;u<yj.length;u++){const p=yj[u];this.propEventSubscriptions[p]&&(this.propEventSubscriptions[p](),delete this.propEventSubscriptions[p]);const y="on"+p,x=r[y];x&&(this.propEventSubscriptions[p]=this.on(p,x))}this.prevMotionValues=Gpe(this,this.scrapeMotionValuesFromProps(r,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(r){return this.props.variants?this.props.variants[r]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(r){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(r),()=>a.variantChildren.delete(r)}addValue(r,a){const u=this.values.get(r);a!==u&&(u&&this.removeValue(r),this.bindToMotionValue(r,a),this.values.set(r,a),this.latestValues[r]=a.get())}removeValue(r){this.values.delete(r);const a=this.valueSubscriptions.get(r);a&&(a(),this.valueSubscriptions.delete(r)),delete this.latestValues[r],this.removeValueFromRenderState(r,this.renderState)}hasValue(r){return this.values.has(r)}getValue(r,a){if(this.props.values&&this.props.values[r])return this.props.values[r];let u=this.values.get(r);return u===void 0&&a!==void 0&&(u=ex(a===null?void 0:a,{owner:this}),this.addValue(r,u)),u}readValue(r,a){var u;let p=this.latestValues[r]!==void 0||!this.current?this.latestValues[r]:(u=this.getBaseTargetFromProps(this.props,r))!==null&&u!==void 0?u:this.readValueFromInstance(this.current,r,this.options);return p!=null&&(typeof p=="string"&&(Oq(p)||Tq(p))?p=parseFloat(p):!qpe(p)&&Um.test(a)&&(p=Aq(r,a)),this.setBaseTarget(r,Cc(p)?p.get():p)),Cc(p)?p.get():p}setBaseTarget(r,a){this.baseTarget[r]=a}getBaseTarget(r){var a;const{initial:u}=this.props;let p;if(typeof u=="string"||typeof u=="object"){const x=uR(this.props,u,(a=this.presenceContext)===null||a===void 0?void 0:a.custom);x&&(p=x[r])}if(u&&p!==void 0)return p;const y=this.getBaseTargetFromProps(this.props,r);return y!==void 0&&!Cc(y)?y:this.initialValues[r]!==void 0&&p===void 0?void 0:this.baseTarget[r]}on(r,a){return this.events[r]||(this.events[r]=new TR),this.events[r].add(a)}notify(r,...a){this.events[r]&&this.events[r].notify(...a)}},hG=class extends Hpe{constructor(){super(...arguments),this.KeyframeResolver=kq}sortInstanceNodePosition(r,a){return r.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(r,a){return r.style?r.style[a]:void 0}removeValueFromRenderState(r,{vars:a,style:u}){delete a[r],delete u[r]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:r}=this.props;Cc(r)&&(this.childSubscription=r.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}};function Ype(e){return window.getComputedStyle(e)}let Zpe=class extends hG{constructor(){super(...arguments),this.type="html",this.renderInstance=J8}readValueFromInstance(r,a){if(d_.has(a)){const u=CR(a);return u&&u.default||0}else{const u=Ype(r),p=(X8(a)?u.getPropertyValue(a):u[a])||0;return typeof p=="string"?p.trim():p}}measureInstanceViewportBox(r,{transformPagePoint:a}){return eG(r,a)}build(r,a,u){fR(r,a,u.transformTemplate)}scrapeMotionValuesFromProps(r,a,u){return _R(r,a,u)}},Xpe=class extends hG{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Aa}getBaseTargetFromProps(r,a){return r[a]}readValueFromInstance(r,a){if(d_.has(a)){const u=CR(a);return u&&u.default||0}return a=eq.has(a)?a:aR(a),r.getAttribute(a)}scrapeMotionValuesFromProps(r,a,u){return nq(r,a,u)}build(r,a,u){pR(r,a,this.isSVGTag,u.transformTemplate)}renderInstance(r,a,u,p){tq(r,a,u,p)}mount(r){this.isSVGTag=gR(r.tagName),super.mount(r)}};const Kpe=(e,r)=>cR(e)?new Xpe(r):new Zpe(r,{allowProjection:e!==ge.Fragment}),Qpe=Sde({...bfe,...Vpe,...Ape,...Upe},Kpe),Hm=Bue(Qpe),Jpe=(e,r)=>e.find(a=>a.id===r);function vj(e,r){const a=fG(e,r),u=a?e[a].findIndex(p=>p.id===r):-1;return{position:a,index:u}}function fG(e,r){for(const[a,u]of Object.entries(e))if(Jpe(u,r))return a}function eme(e){const r=e.includes("right"),a=e.includes("left");let u="center";return r&&(u="flex-end"),a&&(u="flex-start"),{display:"flex",flexDirection:"column",alignItems:u}}function tme(e){const a=e==="top"||e==="bottom"?"0 auto":void 0,u=e.includes("top")?"env(safe-area-inset-top, 0px)":void 0,p=e.includes("bottom")?"env(safe-area-inset-bottom, 0px)":void 0,y=e.includes("left")?void 0:"env(safe-area-inset-right, 0px)",x=e.includes("right")?void 0:"env(safe-area-inset-left, 0px)";return{position:"fixed",zIndex:"var(--toast-z-index, 5500)",pointerEvents:"none",display:"flex",flexDirection:"column",margin:a,top:u,bottom:p,right:y,left:x}}var rme=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,nme=P8(function(e){return rme.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),ime=nme,ome=function(r){return r!=="theme"},xj=function(r){return typeof r=="string"&&r.charCodeAt(0)>96?ime:ome},bj=function(r,a,u){var p;if(a){var y=a.shouldForwardProp;p=r.__emotion_forwardProp&&y?function(x){return r.__emotion_forwardProp(x)&&y(x)}:y}return typeof p!="function"&&u&&(p=r.__emotion_forwardProp),p},sme=function(r){var a=r.cache,u=r.serialized,p=r.isStringTag;return YD(a,u,p),D8(function(){return ZD(a,u,p)}),null},ame=function e(r,a){var u=r.__emotion_real===r,p=u&&r.__emotion_base||r,y,x;a!==void 0&&(y=a.label,x=a.target);var i=bj(r,a,u),C=i||xj(p),R=!C("as");return function(){var z=arguments,F=u&&r.__emotion_styles!==void 0?r.__emotion_styles.slice(0):[];if(y!==void 0&&F.push("label:"+y+";"),z[0]==null||z[0].raw===void 0)F.push.apply(F,z);else{var V=z[0];F.push(V[0]);for(var G=z.length,H=1;H<G;H++)F.push(z[H],V[H])}var Z=KD(function(J,se,pe){var ve=R&&J.as||p,Ne="",_e=[],Re=J;if(J.theme==null){Re={};for(var ke in J)Re[ke]=J[ke];Re.theme=ge.useContext(Fy)}typeof J.className=="string"?Ne=M8(se.registered,_e,J.className):J.className!=null&&(Ne=J.className+" ");var ze=iS(F.concat(_e),se.registered,Re);Ne+=se.key+"-"+ze.name,x!==void 0&&(Ne+=" "+x);var et=R&&i===void 0?xj(ve):C,ht={};for(var Xt in J)R&&Xt==="as"||et(Xt)&&(ht[Xt]=J[Xt]);return ht.className=Ne,pe&&(ht.ref=pe),ge.createElement(ge.Fragment,null,ge.createElement(sme,{cache:se,serialized:ze,isStringTag:typeof ve=="string"}),ge.createElement(ve,ht))});return Z.displayName=y!==void 0?y:"Styled("+(typeof p=="string"?p:p.displayName||p.name||"Component")+")",Z.defaultProps=r.defaultProps,Z.__emotion_real=Z,Z.__emotion_base=p,Z.__emotion_styles=F,Z.__emotion_forwardProp=i,Object.defineProperty(Z,"toString",{value:function(){return"."+x}}),Z.withComponent=function(J,se){var pe=e(J,o_({},a,se,{shouldForwardProp:bj(Z,se,!0)}));return pe.apply(void 0,F)},Z}},lme=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],qA=ame.bind(null);lme.forEach(function(e){qA[e]=qA(e)});const cme=new Set([...Lre,"textStyle","layerStyle","apply","noOfLines","focusBorderColor","errorBorderColor","as","__css","css","sx"]),ume=new Set(["htmlWidth","htmlHeight","htmlSize","htmlTranslate"]);function dme(e){return(ume.has(e)||!cme.has(e))&&e[0]!=="_"}const hme=$te(qA),fme=({baseStyle:e})=>r=>{const{theme:a,css:u,__css:p,sx:y,...x}=r,[i]=Hte(x,Fre),C=Cd(e,r),R=Mte({},p,C,Zw(i),y),z=i8(R)(r.theme);return u?[z,u]:z};function j2(e,r){const{baseStyle:a,...u}=r??{};u.shouldForwardProp||(u.shouldForwardProp=dme);const p=fme({baseStyle:a}),y=hme(e,u)(p);return ge.forwardRef(function(C,R){const{children:z,...F}=C,{colorMode:V,forced:G}=aS(),H=G?V:void 0;return ge.createElement(y,{ref:R,"data-theme":H,...F},z)})}function pme(){const e=new Map;return new Proxy(j2,{apply(r,a,u){return j2(...u)},get(r,a){return e.has(a)||e.set(a,j2(a)),e.get(a)}})}const An=pme(),mme={initial:e=>{const{position:r}=e,a=["top","bottom"].includes(r)?"y":"x";let u=["top-right","bottom-right"].includes(r)?1:-1;return r==="bottom"&&(u=1),{opacity:0,[a]:u*24}},animate:{opacity:1,y:0,x:0,scale:1,transition:{duration:.4,ease:[.4,0,.2,1]}},exit:{opacity:0,scale:.85,transition:{duration:.2,ease:[.4,0,1,1]}}},pG=ge.memo(e=>{const{id:r,message:a,onCloseComplete:u,onRequestRemove:p,requestClose:y=!1,position:x="bottom",duration:i=5e3,containerStyle:C,motionVariants:R=mme,toastSpacing:z="0.5rem"}=e,[F,V]=ge.useState(i),G=Cue();I3(()=>{G||u?.()},[G]),I3(()=>{V(i)},[i]);const H=()=>V(null),Z=()=>V(i),J=()=>{G&&p()};ge.useEffect(()=>{G&&y&&p()},[G,y,p]),Jte(J,F);const se=ge.useMemo(()=>({pointerEvents:"auto",maxWidth:560,minWidth:300,margin:z,...C}),[C,z]),pe=ge.useMemo(()=>eme(x),[x]);return X.jsx(Hm.div,{layout:!0,className:"chakra-toast",variants:R,initial:"initial",animate:"animate",exit:"exit",onHoverStart:H,onHoverEnd:Z,custom:{position:x},style:pe,children:X.jsx(An.div,{role:"status","aria-atomic":"true",className:"chakra-toast__inner",__css:se,children:Cd(a,{id:r,onClose:J})})})});pG.displayName="ToastComponent";function oi(e){return ge.forwardRef(e)}var N2,wj;function gme(){if(wj)return N2;wj=1;var e=typeof Element<"u",r=typeof Map=="function",a=typeof Set=="function",u=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function p(y,x){if(y===x)return!0;if(y&&x&&typeof y=="object"&&typeof x=="object"){if(y.constructor!==x.constructor)return!1;var i,C,R;if(Array.isArray(y)){if(i=y.length,i!=x.length)return!1;for(C=i;C--!==0;)if(!p(y[C],x[C]))return!1;return!0}var z;if(r&&y instanceof Map&&x instanceof Map){if(y.size!==x.size)return!1;for(z=y.entries();!(C=z.next()).done;)if(!x.has(C.value[0]))return!1;for(z=y.entries();!(C=z.next()).done;)if(!p(C.value[1],x.get(C.value[0])))return!1;return!0}if(a&&y instanceof Set&&x instanceof Set){if(y.size!==x.size)return!1;for(z=y.entries();!(C=z.next()).done;)if(!x.has(C.value[0]))return!1;return!0}if(u&&ArrayBuffer.isView(y)&&ArrayBuffer.isView(x)){if(i=y.length,i!=x.length)return!1;for(C=i;C--!==0;)if(y[C]!==x[C])return!1;return!0}if(y.constructor===RegExp)return y.source===x.source&&y.flags===x.flags;if(y.valueOf!==Object.prototype.valueOf&&typeof y.valueOf=="function"&&typeof x.valueOf=="function")return y.valueOf()===x.valueOf();if(y.toString!==Object.prototype.toString&&typeof y.toString=="function"&&typeof x.toString=="function")return y.toString()===x.toString();if(R=Object.keys(y),i=R.length,i!==Object.keys(x).length)return!1;for(C=i;C--!==0;)if(!Object.prototype.hasOwnProperty.call(x,R[C]))return!1;if(e&&y instanceof Element)return!1;for(C=i;C--!==0;)if(!((R[C]==="_owner"||R[C]==="__v"||R[C]==="__o")&&y.$$typeof)&&!p(y[R[C]],x[R[C]]))return!1;return!0}return y!==y&&x!==x}return N2=function(x,i){try{return p(x,i)}catch(C){if((C.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw C}},N2}var _me=gme();const yme=hx(_me);function mG(){const e=ge.useContext(Fy);if(!e)throw Error("useTheme: `theme` is undefined. Seems you forgot to wrap your app in `<ChakraProvider />` or `<ThemeProvider />`");return e}function vme(){const e=aS(),r=mG();return{...e,theme:r}}function xme(e,r,a){if(r==null)return r;const u=p=>e.__cssMap?.[p]?.value;return u(r)??u(a)??a}function bme(e,r,a){const u=Array.isArray(r)?r:[r],p=Array.isArray(a)?a:[a];return y=>{const x=p.filter(Boolean),i=u.map((C,R)=>{const z=`${e}.${C}`;return xme(y,z,x[R]??C)});return Array.isArray(r)?i:i[0]}}function wme(e){return Object.fromEntries(Object.entries(e).filter(([r,a])=>a!==void 0&&r!=="children"&&!ge.isValidElement(a)))}function gG(e,r={}){const{styleConfig:a,...u}=r,{theme:p,colorMode:y}=vme(),x=e?KW(p,`components.${e}`):void 0,i=a||x,C=Cf({theme:p,colorMode:y},i?.defaultProps??{},wme(u),(z,F)=>z?void 0:F),R=ge.useRef({});if(i){const F=Gre(i)(C);yme(R.current,F)||(R.current=F)}return R.current}function Dh(e,r={}){return gG(e,r)}function Bp(e,r={}){return gG(e,r)}const Sj={path:X.jsxs("g",{stroke:"currentColor",strokeWidth:"1.5",children:[X.jsx("path",{strokeLinecap:"round",fill:"none",d:"M9,9a3,3,0,1,1,4,2.829,1.5,1.5,0,0,0-1,1.415V14.25"}),X.jsx("path",{fill:"currentColor",strokeLinecap:"round",d:"M12,17.25a.375.375,0,1,0,.375.375A.375.375,0,0,0,12,17.25h0"}),X.jsx("circle",{fill:"none",strokeMiterlimit:"10",cx:"12",cy:"12",r:"11.25"})]}),viewBox:"0 0 24 24"},mo=oi((e,r)=>{const{as:a,viewBox:u,color:p="currentColor",focusable:y=!1,children:x,className:i,__css:C,...R}=e,z=Yi("chakra-icon",i),F=Dh("Icon",e),V={w:"1em",h:"1em",display:"inline-block",lineHeight:"1em",flexShrink:0,color:p,...C,...F},G={ref:r,focusable:y,className:z,__css:V},H=u??Sj.viewBox;if(a&&typeof a!="string")return X.jsx(An.svg,{as:a,...G,...R});const Z=x??Sj.path;return X.jsx(An.svg,{verticalAlign:"middle",viewBox:H,...G,...R,children:Z})});mo.displayName="Icon";function Sme(e){return X.jsx(mo,{viewBox:"0 0 24 24",...e,children:X.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.014,12.014,0,0,0,12,0Zm6.927,8.2-6.845,9.289a1.011,1.011,0,0,1-1.43.188L5.764,13.769a1,1,0,1,1,1.25-1.562l4.076,3.261,6.227-8.451A1,1,0,1,1,18.927,8.2Z"})})}function Tme(e){return X.jsx(mo,{viewBox:"0 0 24 24",...e,children:X.jsx("path",{fill:"currentColor",d:"M12,0A12,12,0,1,0,24,12,12.013,12.013,0,0,0,12,0Zm.25,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,12.25,5ZM14.5,18.5h-4a1,1,0,0,1,0-2h.75a.25.25,0,0,0,.25-.25v-4.5a.25.25,0,0,0-.25-.25H10.5a1,1,0,0,1,0-2h1a2,2,0,0,1,2,2v4.75a.25.25,0,0,0,.25.25h.75a1,1,0,1,1,0,2Z"})})}function Tj(e){return X.jsx(mo,{viewBox:"0 0 24 24",...e,children:X.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})}const Eme=hue({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),Ky=oi((e,r)=>{const a=Dh("Spinner",e),{label:u="Loading...",thickness:p="2px",speed:y="0.45s",emptyColor:x="transparent",className:i,...C}=Il(e),R=Yi("chakra-spinner",i),z={display:"inline-block",borderColor:"currentColor",borderStyle:"solid",borderRadius:"99999px",borderWidth:p,borderBottomColor:x,borderLeftColor:x,animation:`${Eme} ${y} linear infinite`,...a};return X.jsx(An.div,{ref:r,__css:z,className:R,...C,children:u&&X.jsx(An.span,{srOnly:!0,children:u})})});Ky.displayName="Spinner";const[Pme,LR]=Pl({name:"AlertContext",hookName:"useAlertContext",providerName:"<Alert />"}),[Ime,zR]=Pl({name:"AlertStylesContext",hookName:"useAlertStyles",providerName:"<Alert />"}),_G={info:{icon:Tme,colorScheme:"blue"},warning:{icon:Tj,colorScheme:"orange"},success:{icon:Sme,colorScheme:"green"},error:{icon:Tj,colorScheme:"red"},loading:{icon:Ky,colorScheme:"blue"}};function Mme(e){return _G[e].colorScheme}function Cme(e){return _G[e].icon}const yG=oi(function(r,a){const{status:u="info",addRole:p=!0,...y}=Il(r),x=r.colorScheme??Mme(u),i=Bp("Alert",{...r,colorScheme:x}),C={width:"100%",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",...i.container};return X.jsx(Pme,{value:{status:u},children:X.jsx(Ime,{value:i,children:X.jsx(An.div,{"data-status":u,role:p?"alert":void 0,ref:a,...y,className:Yi("chakra-alert",r.className),__css:C})})})});yG.displayName="Alert";function vG(e){const{status:r}=LR(),a=Cme(r),u=zR(),p=r==="loading"?u.spinner:u.icon;return X.jsx(An.span,{display:"inherit","data-status":r,...e,className:Yi("chakra-alert__icon",e.className),__css:p,children:e.children||X.jsx(a,{h:"100%",w:"100%"})})}vG.displayName="AlertIcon";const xG=oi(function(r,a){const u=zR(),{status:p}=LR();return X.jsx(An.div,{ref:a,"data-status":p,...r,className:Yi("chakra-alert__title",r.className),__css:u.title})});xG.displayName="AlertTitle";const bG=oi(function(r,a){const{status:u}=LR(),p=zR(),y={display:"inline",...p.description};return X.jsx(An.div,{ref:a,"data-status":u,...r,className:Yi("chakra-alert__desc",r.className),__css:y})});bG.displayName="AlertDescription";function Ame(e){return X.jsx(mo,{focusable:"false","aria-hidden":!0,...e,children:X.jsx("path",{fill:"currentColor",d:"M.439,21.44a1.5,1.5,0,0,0,2.122,2.121L11.823,14.3a.25.25,0,0,1,.354,0l9.262,9.263a1.5,1.5,0,1,0,2.122-2.121L14.3,12.177a.25.25,0,0,1,0-.354l9.263-9.262A1.5,1.5,0,0,0,21.439.44L12.177,9.7a.25.25,0,0,1-.354,0L2.561.44A1.5,1.5,0,0,0,.439,2.561L9.7,11.823a.25.25,0,0,1,0,.354Z"})})}const FR=oi(function(r,a){const u=Dh("CloseButton",r),{children:p,isDisabled:y,__css:x,...i}=Il(r),C={outline:0,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0};return X.jsx(An.button,{type:"button","aria-label":"Close",ref:a,disabled:y,__css:{...C,...u,...x},...i,children:p||X.jsx(Ame,{width:"1em",height:"1em"})})});FR.displayName="CloseButton";const Dme=e=>{const{status:r,variant:a="solid",id:u,title:p,isClosable:y,onClose:x,description:i,colorScheme:C,icon:R}=e,z=u?{root:`toast-${u}`,title:`toast-${u}-title`,description:`toast-${u}-description`}:void 0;return X.jsxs(yG,{addRole:!1,status:r,variant:a,id:z?.root,alignItems:"start",borderRadius:"md",boxShadow:"lg",paddingEnd:8,textAlign:"start",width:"auto",colorScheme:C,children:[X.jsx(vG,{children:R}),X.jsxs(An.div,{flex:"1",maxWidth:"100%",children:[p&&X.jsx(xG,{id:z?.title,children:p}),i&&X.jsx(bG,{id:z?.description,display:"block",children:i})]}),y&&X.jsx(FR,{size:"sm",onClick:x,position:"absolute",insetEnd:1,top:1})]})};function wG(e={}){const{render:r,toastComponent:a=Dme}=e;return p=>typeof r=="function"?r({...p,...e}):X.jsx(a,{...p,...e})}const Rme={top:[],"top-left":[],"top-right":[],"bottom-left":[],bottom:[],"bottom-right":[]},If=Ome(Rme);function Ome(e){let r=e;const a=new Set,u=p=>{r=p(r),a.forEach(y=>y())};return{getState:()=>r,subscribe:p=>(a.add(p),()=>{u(()=>e),a.delete(p)}),removeToast:(p,y)=>{u(x=>({...x,[y]:x[y].filter(i=>i.id!=p)}))},notify:(p,y)=>{const x=Lme(p,y),{position:i,id:C}=x;return u(R=>{const F=i.includes("top")?[x,...R[i]??[]]:[...R[i]??[],x];return{...R,[i]:F}}),C},update:(p,y)=>{p&&u(x=>{const i={...x},{position:C,index:R}=vj(i,p);return C&&R!==-1&&(i[C][R]={...i[C][R],...y,message:wG(y)}),i})},closeAll:({positions:p}={})=>{u(y=>(p??["bottom","bottom-right","bottom-left","top","top-left","top-right"]).reduce((C,R)=>(C[R]=y[R].map(z=>({...z,requestClose:!0})),C),{...y}))},close:p=>{u(y=>{const x=fG(y,p);return x?{...y,[x]:y[x].map(i=>i.id==p?{...i,requestClose:!0}:i)}:y})},isActive:p=>!!vj(If.getState(),p).position}}let Ej=0;function Lme(e,r={}){Ej+=1;const a=r.id??Ej,u=r.position??"bottom";return{id:a,message:e,position:u,duration:r.duration,onCloseComplete:r.onCloseComplete,onRequestRemove:()=>If.removeToast(String(a),u),status:r.status,requestClose:!1,containerStyle:r.containerStyle}}const[SG,zme]=Pl({strict:!1,name:"PortalContext"}),kR="chakra-portal",Fme=".chakra-portal",kme=e=>X.jsx("div",{className:"chakra-portal-zIndex",style:{position:"absolute",zIndex:e.zIndex,top:0,left:0,right:0},children:e.children}),Bme=e=>{const{appendToParentPortal:r,children:a}=e,[u,p]=ge.useState(null),y=ge.useRef(null),[,x]=ge.useState({});ge.useEffect(()=>x({}),[]);const i=zme(),C=Sue();xw(()=>{if(!u)return;const z=u.ownerDocument,F=r?i??z.body:z.body;if(!F)return;y.current=z.createElement("div"),y.current.className=kR,F.appendChild(y.current),x({});const V=y.current;return()=>{F.contains(V)&&F.removeChild(V)}},[u]);const R=C?.zIndex?X.jsx(kme,{zIndex:C?.zIndex,children:a}):a;return y.current?uW.createPortal(X.jsx(SG,{value:y.current,children:R}),y.current):X.jsx("span",{ref:z=>{z&&p(z)}})},jme=e=>{const{children:r,containerRef:a,appendToParentPortal:u}=e,p=a.current,y=p??(typeof window<"u"?document.body:void 0),x=ge.useMemo(()=>{const C=p?.ownerDocument.createElement("div");return C&&(C.className=kR),C},[p]),[,i]=ge.useState({});return xw(()=>i({}),[]),xw(()=>{if(!(!x||!y))return y.appendChild(x),()=>{y.removeChild(x)}},[x,y]),y&&x?uW.createPortal(X.jsx(SG,{value:u?x:null,children:r}),x):null};function Mx(e){const r={appendToParentPortal:!0,...e},{containerRef:a,...u}=r;return a?X.jsx(jme,{containerRef:a,...u}):X.jsx(Bme,{...u})}Mx.className=kR;Mx.selector=Fme;Mx.displayName="Portal";const[Nme]=Pl({name:"ToastOptionsContext",strict:!1}),TG=e=>{const r=ge.useSyncExternalStore(If.subscribe,If.getState,If.getState),{motionVariants:a,component:u=pG,portalProps:p,animatePresenceProps:y}=e,i=Object.keys(r).map(C=>{const R=r[C];return X.jsx("div",{role:"region","aria-live":"polite","aria-label":`Notifications-${C}`,id:`chakra-toast-manager-${C}`,style:tme(C),children:X.jsx(Sx,{...y,initial:!1,children:R.map(z=>X.jsx(u,{motionVariants:a,...z},z.id))})},C)});return X.jsx(Mx,{...p,children:i})},Vme=e=>function({children:a,theme:u=e,toastOptions:p,...y}){return X.jsxs(Tue,{theme:u,...y,children:[X.jsx(Nme,{value:p?.defaultOptions,children:a}),X.jsx(TG,{...p})]})},Ume=Vme(v8);function Pj(e){return e.sort((r,a)=>{const u=r.compareDocumentPosition(a);if(u&Node.DOCUMENT_POSITION_FOLLOWING||u&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(u&Node.DOCUMENT_POSITION_PRECEDING||u&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(u&Node.DOCUMENT_POSITION_DISCONNECTED||u&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}const $me=e=>typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE;function Ij(e,r,a){let u=e+1;return a&&u>=r&&(u=0),u}function Mj(e,r,a){let u=e-1;return a&&u<0&&(u=r),u}const V2=typeof window<"u"?ge.useLayoutEffect:ge.useEffect,Cj=e=>e;var Wme=Object.defineProperty,qme=(e,r,a)=>r in e?Wme(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,ga=(e,r,a)=>(qme(e,typeof r!="symbol"?r+"":r,a),a);class Gme{constructor(){ga(this,"descendants",new Map),ga(this,"register",r=>{if(r!=null)return $me(r)?this.registerNode(r):a=>{this.registerNode(a,r)}}),ga(this,"unregister",r=>{this.descendants.delete(r);const a=Pj(Array.from(this.descendants.keys()));this.assignIndex(a)}),ga(this,"destroy",()=>{this.descendants.clear()}),ga(this,"assignIndex",r=>{this.descendants.forEach(a=>{const u=r.indexOf(a.node);a.index=u,a.node.dataset.index=a.index.toString()})}),ga(this,"count",()=>this.descendants.size),ga(this,"enabledCount",()=>this.enabledValues().length),ga(this,"values",()=>Array.from(this.descendants.values()).sort((a,u)=>a.index-u.index)),ga(this,"enabledValues",()=>this.values().filter(r=>!r.disabled)),ga(this,"item",r=>{if(this.count()!==0)return this.values()[r]}),ga(this,"enabledItem",r=>{if(this.enabledCount()!==0)return this.enabledValues()[r]}),ga(this,"first",()=>this.item(0)),ga(this,"firstEnabled",()=>this.enabledItem(0)),ga(this,"last",()=>this.item(this.descendants.size-1)),ga(this,"lastEnabled",()=>{const r=this.enabledValues().length-1;return this.enabledItem(r)}),ga(this,"indexOf",r=>r?this.descendants.get(r)?.index??-1:-1),ga(this,"enabledIndexOf",r=>r==null?-1:this.enabledValues().findIndex(a=>a.node.isSameNode(r))),ga(this,"next",(r,a=!0)=>{const u=Ij(r,this.count(),a);return this.item(u)}),ga(this,"nextEnabled",(r,a=!0)=>{const u=this.item(r);if(!u)return;const p=this.enabledIndexOf(u.node),y=Ij(p,this.enabledCount(),a);return this.enabledItem(y)}),ga(this,"prev",(r,a=!0)=>{const u=Mj(r,this.count()-1,a);return this.item(u)}),ga(this,"prevEnabled",(r,a=!0)=>{const u=this.item(r);if(!u)return;const p=this.enabledIndexOf(u.node),y=Mj(p,this.enabledCount()-1,a);return this.enabledItem(y)}),ga(this,"registerNode",(r,a)=>{if(!r||this.descendants.has(r))return;const u=Array.from(this.descendants.keys()).concat(r),p=Pj(u);a?.disabled&&(a.disabled=!!a.disabled);const y={node:r,index:-1,...a};this.descendants.set(r,y),this.assignIndex(p)})}}function Hme(){const[e,r]=Pl({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});return[e,r,()=>{const p=ge.useRef(new Gme);return V2(()=>()=>p.current.destroy()),p.current},p=>{const y=r(),[x,i]=ge.useState(-1),C=ge.useRef(null);V2(()=>()=>{C.current&&y.unregister(C.current)},[]),V2(()=>{if(!C.current)return;const z=Number(C.current.dataset.index);x!=z&&!Number.isNaN(z)&&i(z)});const R=Cj(p?y.register(p):y.register);return{descendants:y,index:x,enabledIndex:y.enabledIndexOf(C.current),register:Nm(R,C)}}]}const Aj={easeIn:[.4,0,1,1],easeOut:[0,0,.2,1]},Qg={enter:{duration:.2,ease:Aj.easeOut},exit:{duration:.1,ease:Aj.easeIn}},Jg={enter:(e,r)=>({...e,delay:typeof r=="number"?r:r?.enter}),exit:(e,r)=>({...e,delay:typeof r=="number"?r:r?.exit})},[Yme,Zme]=Pl({name:"AvatarStylesContext",hookName:"useAvatarStyles",providerName:"<Avatar/>"});function Xme(e){const r=e.trim().split(" "),a=r[0]??"",u=r.length>1?r[r.length-1]:"";return a&&u?`${a.charAt(0)}${u.charAt(0)}`:a.charAt(0)}function EG(e){const{name:r,getInitials:a,...u}=e,p=Zme();return X.jsx(An.div,{role:"img","aria-label":r,...u,__css:p.label,children:r?a?.(r):null})}EG.displayName="AvatarName";const PG=e=>X.jsxs(An.svg,{viewBox:"0 0 128 128",color:"#fff",width:"100%",height:"100%",className:"chakra-avatar__svg",...e,children:[X.jsx("path",{fill:"currentColor",d:"M103,102.1388 C93.094,111.92 79.3504,118 64.1638,118 C48.8056,118 34.9294,111.768 25,101.7892 L25,95.2 C25,86.8096 31.981,80 40.6,80 L87.4,80 C96.019,80 103,86.8096 103,95.2 L103,102.1388 Z"}),X.jsx("path",{fill:"currentColor",d:"M63.9961647,24 C51.2938136,24 41,34.2938136 41,46.9961647 C41,59.7061864 51.2938136,70 63.9961647,70 C76.6985159,70 87,59.7061864 87,46.9961647 C87,34.2938136 76.6985159,24 63.9961647,24"})]});function IG(e){const{loading:r,src:a,srcSet:u,onLoad:p,onError:y,crossOrigin:x,sizes:i,ignoreFallback:C}=e,[R,z]=ge.useState("pending");ge.useEffect(()=>{z(a?"loading":"pending")},[a]);const F=ge.useRef(null),V=ge.useCallback(()=>{if(!a)return;G();const H=new Image;H.src=a,x&&(H.crossOrigin=x),u&&(H.srcset=u),i&&(H.sizes=i),r&&(H.loading=r),H.onload=Z=>{G(),z("loaded"),p?.(Z)},H.onerror=Z=>{G(),z("failed"),y?.(Z)},F.current=H},[a,x,u,i,p,y,r]),G=()=>{F.current&&(F.current.onload=null,F.current.onerror=null,F.current=null)};return xw(()=>{if(!C)return R==="loading"&&V(),()=>{G()}},[R,V,C]),C?"loaded":R}const Kme=(e,r)=>e!=="loaded"&&r==="beforeLoadOrError"||e==="failed"&&r==="onError";function MG(e){const{src:r,srcSet:a,onError:u,onLoad:p,getInitials:y,name:x,borderRadius:i,loading:C,iconLabel:R,icon:z=X.jsx(PG,{}),ignoreFallback:F,referrerPolicy:V,crossOrigin:G}=e,Z=IG({src:r,onError:u,crossOrigin:G,ignoreFallback:F})==="loaded";return!r||!Z?x?X.jsx(EG,{className:"chakra-avatar__initials",getInitials:y,name:x}):ge.cloneElement(z,{role:"img","aria-label":R}):X.jsx(An.img,{src:r,srcSet:a,alt:x??R,onLoad:p,referrerPolicy:V,crossOrigin:G??void 0,className:"chakra-avatar__img",loading:C,__css:{width:"100%",height:"100%",objectFit:"cover",borderRadius:i}})}MG.displayName="AvatarImage";const Qme={display:"inline-flex",alignItems:"center",justifyContent:"center",textAlign:"center",textTransform:"uppercase",fontWeight:"medium",position:"relative",flexShrink:0},Ny=oi((e,r)=>{const a=Bp("Avatar",e),[u,p]=ge.useState(!1),{src:y,srcSet:x,name:i,showBorder:C,borderRadius:R="full",onError:z,onLoad:F,getInitials:V=Xme,icon:G=X.jsx(PG,{}),iconLabel:H=" avatar",loading:Z,children:J,borderColor:se,ignoreFallback:pe,crossOrigin:ve,referrerPolicy:Ne,..._e}=Il(e),Re={borderRadius:R,borderWidth:C?"2px":void 0,...Qme,...a.container};return se&&(Re.borderColor=se),X.jsx(An.span,{ref:r,..._e,className:Yi("chakra-avatar",e.className),"data-loaded":Ku(u),__css:Re,children:X.jsxs(Yme,{value:a,children:[X.jsx(MG,{src:y,srcSet:x,loading:Z,onLoad:Ph(F,()=>{p(!0)}),onError:z,getInitials:V,name:i,borderRadius:R,icon:G,iconLabel:H,ignoreFallback:pe,crossOrigin:ve,referrerPolicy:Ne}),J]})})});Ny.displayName="Avatar";const fS=oi(function(r,a){const u=Dh("Badge",r),{className:p,...y}=Il(r);return X.jsx(An.span,{ref:a,className:Yi("chakra-badge",r.className),...y,__css:{display:"inline-block",whiteSpace:"nowrap",verticalAlign:"middle",...u}})});fS.displayName="Badge";const Mn=An("div");Mn.displayName="Box";const[SPe,Jme]=Pl({strict:!1,name:"ButtonGroupContext"});function S0(e){const{children:r,className:a,...u}=e,p=ge.isValidElement(r)?ge.cloneElement(r,{"aria-hidden":!0,focusable:!1}):r,y=Yi("chakra-button__icon",a);return X.jsx(An.span,{display:"inline-flex",alignSelf:"center",flexShrink:0,...u,className:y,children:p})}S0.displayName="ButtonIcon";function GA(e){const{label:r,placement:a,spacing:u="0.5rem",children:p=X.jsx(Ky,{color:"currentColor",width:"1em",height:"1em"}),className:y,__css:x,...i}=e,C=Yi("chakra-button__spinner",y),R=a==="start"?"marginEnd":"marginStart",z=ge.useMemo(()=>({display:"flex",alignItems:"center",position:r?"relative":"absolute",[R]:r?u:0,fontSize:"1em",lineHeight:"normal",...x}),[x,r,R,u]);return X.jsx(An.div,{className:C,...i,__css:z,children:p})}GA.displayName="ButtonSpinner";function ege(e){const[r,a]=ge.useState(!e);return{ref:ge.useCallback(y=>{y&&a(y.tagName==="BUTTON")},[]),type:r?"button":void 0}}const wo=oi((e,r)=>{const a=Jme(),u=Dh("Button",{...a,...e}),{isDisabled:p=a?.isDisabled,isLoading:y,isActive:x,children:i,leftIcon:C,rightIcon:R,loadingText:z,iconSpacing:F="0.5rem",type:V,spinner:G,spinnerPlacement:H="start",className:Z,as:J,shouldWrapChildren:se,...pe}=Il(e),ve=ge.useMemo(()=>{const ke={...u?._focus,zIndex:1};return{display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",...u,...!!a&&{_focus:ke}}},[u,a]),{ref:Ne,type:_e}=ege(J),Re={rightIcon:R,leftIcon:C,iconSpacing:F,children:i,shouldWrapChildren:se};return X.jsxs(An.button,{disabled:p||y,ref:Qte(r,Ne),as:J,type:V??_e,"data-active":Ku(x),"data-loading":Ku(y),__css:ve,className:Yi("chakra-button",Z),...pe,children:[y&&H==="start"&&X.jsx(GA,{className:"chakra-button__spinner--start",label:z,placement:"start",spacing:F,children:G}),y?z||X.jsx(An.span,{opacity:0,children:X.jsx(Dj,{...Re})}):X.jsx(Dj,{...Re}),y&&H==="end"&&X.jsx(GA,{className:"chakra-button__spinner--end",label:z,placement:"end",spacing:F,children:G})]})});wo.displayName="Button";function Dj(e){const{leftIcon:r,rightIcon:a,children:u,iconSpacing:p,shouldWrapChildren:y}=e;return y?X.jsxs("span",{style:{display:"contents"},children:[r&&X.jsx(S0,{marginEnd:p,children:r}),u,a&&X.jsx(S0,{marginStart:p,children:a})]}):X.jsxs(X.Fragment,{children:[r&&X.jsx(S0,{marginEnd:p,children:r}),u,a&&X.jsx(S0,{marginStart:p,children:a})]})}const T0=oi((e,r)=>{const{icon:a,children:u,isRound:p,"aria-label":y,...x}=e,i=a||u,C=ge.isValidElement(i)?ge.cloneElement(i,{"aria-hidden":!0,focusable:!1}):null;return X.jsx(wo,{px:"0",py:"0",borderRadius:p?"full":void 0,ref:r,"aria-label":y,...x,children:C})});T0.displayName="IconButton";const[tge,CG]=Pl({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[rge,pS]=Pl({strict:!1,name:"FormControlContext"});function nge(e){const{id:r,isRequired:a,isInvalid:u,isDisabled:p,isReadOnly:y,...x}=e,i=ge.useId(),C=r||`field-${i}`,R=`${C}-label`,z=`${C}-feedback`,F=`${C}-helptext`,[V,G]=ge.useState(!1),[H,Z]=ge.useState(!1),[J,se]=ge.useState(!1),pe=ge.useCallback((ke={},ze=null)=>({id:F,...ke,ref:Nm(ze,et=>{et&&Z(!0)})}),[F]),ve=ge.useCallback((ke={},ze=null)=>({...ke,ref:ze,"data-focus":Ku(J),"data-disabled":Ku(p),"data-invalid":Ku(u),"data-readonly":Ku(y),id:ke.id!==void 0?ke.id:R,htmlFor:ke.htmlFor!==void 0?ke.htmlFor:C}),[C,p,J,u,y,R]),Ne=ge.useCallback((ke={},ze=null)=>({id:z,...ke,ref:Nm(ze,et=>{et&&G(!0)}),"aria-live":"polite"}),[z]),_e=ge.useCallback((ke={},ze=null)=>({...ke,...x,ref:ze,role:"group","data-focus":Ku(J),"data-disabled":Ku(p),"data-invalid":Ku(u),"data-readonly":Ku(y)}),[x,p,J,u,y]),Re=ge.useCallback((ke={},ze=null)=>({...ke,ref:ze,role:"presentation","aria-hidden":!0,children:ke.children||"*"}),[]);return{isRequired:!!a,isInvalid:!!u,isReadOnly:!!y,isDisabled:!!p,isFocused:!!J,onFocus:()=>se(!0),onBlur:()=>se(!1),hasFeedbackText:V,setHasFeedbackText:G,hasHelpText:H,setHasHelpText:Z,id:C,labelId:R,feedbackId:z,helpTextId:F,htmlProps:x,getHelpTextProps:pe,getErrorMessageProps:Ne,getRootProps:_e,getLabelProps:ve,getRequiredIndicatorProps:Re}}const Lm=oi(function(r,a){const u=Bp("Form",r),p=Il(r),{getRootProps:y,htmlProps:x,...i}=nge(p),C=Yi("chakra-form-control",r.className);return X.jsx(rge,{value:i,children:X.jsx(tge,{value:u,children:X.jsx(An.div,{...y({},a),className:C,__css:u.container})})})});Lm.displayName="FormControl";const ige=oi(function(r,a){const u=pS(),p=CG(),y=Yi("chakra-form__helper-text",r.className);return X.jsx(An.div,{...u?.getHelpTextProps(r,a),__css:p.helperText,className:y})});ige.displayName="FormHelperText";function AG(e){const{isDisabled:r,isInvalid:a,isReadOnly:u,isRequired:p,...y}=oge(e);return{...y,disabled:r,readOnly:u,required:p,"aria-invalid":o2(a),"aria-required":o2(p),"aria-readonly":o2(u)}}function oge(e){const r=pS(),{id:a,disabled:u,readOnly:p,required:y,isRequired:x,isInvalid:i,isReadOnly:C,isDisabled:R,onFocus:z,onBlur:F,...V}=e,G=e["aria-describedby"]?[e["aria-describedby"]]:[];return r?.hasFeedbackText&&r?.isInvalid&&G.push(r.feedbackId),r?.hasHelpText&&G.push(r.helpTextId),{...V,"aria-describedby":G.join(" ")||void 0,id:a??r?.id,isDisabled:u??R??r?.isDisabled,isReadOnly:p??C??r?.isReadOnly,isRequired:y??x??r?.isRequired,isInvalid:i??r?.isInvalid,onFocus:Ph(r?.onFocus,z),onBlur:Ph(r?.onBlur,F)}}const Ad=oi(function(r,a){const{className:u,centerContent:p,...y}=Il(r),x=Dh("Container",r);return X.jsx(An.div,{ref:a,className:Yi("chakra-container",u),...y,__css:{...x,...p&&{display:"flex",flexDirection:"column",alignItems:"center"}}})});Ad.displayName="Container";const s_=oi(function(r,a){const{borderLeftWidth:u,borderBottomWidth:p,borderTopWidth:y,borderRightWidth:x,borderWidth:i,borderStyle:C,borderColor:R,...z}=Dh("Divider",r),{className:F,orientation:V="horizontal",__css:G,...H}=Il(r),Z={vertical:{borderLeftWidth:u||x||i||"1px",height:"100%"},horizontal:{borderBottomWidth:p||y||i||"1px",width:"100%"}};return X.jsx(An.hr,{ref:a,"aria-orientation":V,...H,__css:{...z,border:"0",borderColor:R,borderStyle:C,...Z[V],...G},className:Yi("chakra-divider",F)})});s_.displayName="Divider";const Ic=oi(function(r,a){const{direction:u,align:p,justify:y,wrap:x,basis:i,grow:C,shrink:R,...z}=r,F={display:"flex",flexDirection:u,alignItems:p,justifyContent:y,flexWrap:x,flexBasis:i,flexGrow:C,flexShrink:R};return X.jsx(An.div,{ref:a,__css:F,...z})});Ic.displayName="Flex";function sge(e,r){if(e==null)return{};var a={};for(var u in e)if({}.hasOwnProperty.call(e,u)){if(r.indexOf(u)!==-1)continue;a[u]=e[u]}return a}var U2={exports:{}},$2,Rj;function age(){if(Rj)return $2;Rj=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return $2=e,$2}var W2,Oj;function lge(){if(Oj)return W2;Oj=1;var e=age();function r(){}function a(){}return a.resetWarningCache=r,W2=function(){function u(x,i,C,R,z,F){if(F!==e){var V=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw V.name="Invariant Violation",V}}u.isRequired=u;function p(){return u}var y={array:u,bigint:u,bool:u,func:u,number:u,object:u,string:u,symbol:u,any:u,arrayOf:p,element:u,elementType:u,instanceOf:p,node:u,objectOf:p,oneOf:p,oneOfType:p,shape:p,exact:p,checkPropTypes:a,resetWarningCache:r};return y.PropTypes=y,y},W2}var Lj;function jp(){return Lj||(Lj=1,U2.exports=lge()()),U2.exports}var HA="data-focus-lock",DG="data-focus-lock-disabled",cge="data-no-focus-lock",uge="data-autofocus-inside",dge="data-no-autofocus";function q2(e,r){return typeof e=="function"?e(r):e&&(e.current=r),e}function hge(e,r){var a=ge.useState(function(){return{value:e,callback:r,facade:{get current(){return a.value},set current(u){var p=a.value;p!==u&&(a.value=u,a.callback(u,p))}}}})[0];return a.callback=r,a.facade}var fge=typeof window<"u"?ge.useLayoutEffect:ge.useEffect,zj=new WeakMap;function RG(e,r){var a=hge(null,function(u){return e.forEach(function(p){return q2(p,u)})});return fge(function(){var u=zj.get(a);if(u){var p=new Set(u),y=new Set(e),x=a.current;p.forEach(function(i){y.has(i)||q2(i,null)}),y.forEach(function(i){p.has(i)||q2(i,x)})}zj.set(a,e)},[e]),a}var G2={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"},Mf=function(){return Mf=Object.assign||function(r){for(var a,u=1,p=arguments.length;u<p;u++){a=arguments[u];for(var y in a)Object.prototype.hasOwnProperty.call(a,y)&&(r[y]=a[y])}return r},Mf.apply(this,arguments)};function OG(e,r){var a={};for(var u in e)Object.prototype.hasOwnProperty.call(e,u)&&r.indexOf(u)<0&&(a[u]=e[u]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var p=0,u=Object.getOwnPropertySymbols(e);p<u.length;p++)r.indexOf(u[p])<0&&Object.prototype.propertyIsEnumerable.call(e,u[p])&&(a[u[p]]=e[u[p]]);return a}function pge(e,r,a){if(a||arguments.length===2)for(var u=0,p=r.length,y;u<p;u++)(y||!(u in r))&&(y||(y=Array.prototype.slice.call(r,0,u)),y[u]=r[u]);return e.concat(y||Array.prototype.slice.call(r))}function LG(e){return e}function zG(e,r){r===void 0&&(r=LG);var a=[],u=!1,p={read:function(){if(u)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return a.length?a[a.length-1]:e},useMedium:function(y){var x=r(y,u);return a.push(x),function(){a=a.filter(function(i){return i!==x})}},assignSyncMedium:function(y){for(u=!0;a.length;){var x=a;a=[],x.forEach(y)}a={push:function(i){return y(i)},filter:function(){return a}}},assignMedium:function(y){u=!0;var x=[];if(a.length){var i=a;a=[],i.forEach(y),x=a}var C=function(){var z=x;x=[],z.forEach(y)},R=function(){return Promise.resolve().then(C)};R(),a={push:function(z){x.push(z),R()},filter:function(z){return x=x.filter(z),a}}}};return p}function BR(e,r){return r===void 0&&(r=LG),zG(e,r)}function FG(e){e===void 0&&(e={});var r=zG(null);return r.options=Mf({async:!0,ssr:!1},e),r}var kG=function(e){var r=e.sideCar,a=OG(e,["sideCar"]);if(!r)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var u=r.read();if(!u)throw new Error("Sidecar medium not found");return ge.createElement(u,Mf({},a))};kG.isSideCarExport=!0;function mge(e,r){return e.useMedium(r),kG}var BG=BR({},function(e){var r=e.target,a=e.currentTarget;return{target:r,currentTarget:a}}),jG=BR(),gge=BR(),_ge=FG({async:!0,ssr:typeof document<"u"}),yge=ge.createContext(void 0),vge=[],jR=ge.forwardRef(function(r,a){var u,p=ge.useState(),y=p[0],x=p[1],i=ge.useRef(),C=ge.useRef(!1),R=ge.useRef(null),z=ge.useState({}),F=z[1],V=r.children,G=r.disabled,H=G===void 0?!1:G,Z=r.noFocusGuards,J=Z===void 0?!1:Z,se=r.persistentFocus,pe=se===void 0?!1:se,ve=r.crossFrame,Ne=ve===void 0?!0:ve,_e=r.autoFocus,Re=_e===void 0?!0:_e;r.allowTextSelection;var ke=r.group,ze=r.className,et=r.whiteList,ht=r.hasPositiveIndices,Xt=r.shards,Ir=Xt===void 0?vge:Xt,nr=r.as,Fr=nr===void 0?"div":nr,Or=r.lockProps,or=Or===void 0?{}:Or,lt=r.sideCar,Et=r.returnFocus,qt=Et===void 0?!1:Et,Gt=r.focusOptions,tt=r.onActivation,ct=r.onDeactivation,_t=ge.useState({}),Vt=_t[0],bt=ge.useCallback(function(di){var Ii=di.captureFocusRestore;if(!R.current){var Xn,Go=(Xn=document)==null?void 0:Xn.activeElement;R.current=Go,Go!==document.body&&(R.current=Ii(Go))}i.current&&tt&&tt(i.current),C.current=!0,F()},[tt]),ar=ge.useCallback(function(){C.current=!1,ct&&ct(i.current),F()},[ct]),hr=ge.useCallback(function(di){var Ii=R.current;if(Ii){var Xn=(typeof Ii=="function"?Ii():Ii)||document.body,Go=typeof qt=="function"?qt(Xn):qt;if(Go){var Lo=typeof Go=="object"?Go:void 0;R.current=null,di?Promise.resolve().then(function(){return Xn.focus(Lo)}):Xn.focus(Lo)}}},[qt]),xr=ge.useCallback(function(di){C.current&&BG.useMedium(di)},[]),sr=jG.useMedium,Br=ge.useCallback(function(di){i.current!==di&&(i.current=di,x(di))},[]),hn=o_((u={},u[DG]=H&&"disabled",u[HA]=ke,u),or),Vn=J!==!0,Yr=Vn&&J!=="tail",Un=RG([a,Br]),Si=ge.useMemo(function(){return{observed:i,shards:Ir,enabled:!H,active:C.current}},[H,C.current,Ir,y]);return Js.createElement(ge.Fragment,null,Vn&&[Js.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:H?-1:0,style:G2}),ht?Js.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:H?-1:1,style:G2}):null],!H&&Js.createElement(lt,{id:Vt,sideCar:_ge,observed:y,disabled:H,persistentFocus:pe,crossFrame:Ne,autoFocus:Re,whiteList:et,shards:Ir,onActivation:bt,onDeactivation:ar,returnFocus:hr,focusOptions:Gt,noFocusGuards:J}),Js.createElement(Fr,o_({ref:Un},hn,{className:ze,onBlur:sr,onFocus:xr}),Js.createElement(yge.Provider,{value:Si},V)),Yr&&Js.createElement("div",{"data-focus-guard":!0,tabIndex:H?-1:0,style:G2}))});jR.propTypes={};function YA(e,r){return YA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,u){return a.__proto__=u,a},YA(e,r)}function xge(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,YA(e,r)}function nx(e){"@babel/helpers - typeof";return nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},nx(e)}function bge(e,r){if(nx(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var u=a.call(e,r);if(nx(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function wge(e){var r=bge(e,"string");return nx(r)=="symbol"?r:r+""}function Sge(e,r,a){return(r=wge(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Tge(e,r){function a(u){return u.displayName||u.name||"Component"}return function(p){var y=[],x;function i(){x=e(y.map(function(R){return R.props})),r(x)}var C=(function(R){xge(z,R);function z(){return R.apply(this,arguments)||this}z.peek=function(){return x};var F=z.prototype;return F.componentDidMount=function(){y.push(this),i()},F.componentDidUpdate=function(){i()},F.componentWillUnmount=function(){var G=y.indexOf(this);y.splice(G,1),i()},F.render=function(){return Js.createElement(p,this.props)},z})(ge.PureComponent);return Sge(C,"displayName","SideEffect("+a(p)+")"),C}}var Ff=function(e){for(var r=Array(e.length),a=0;a<e.length;++a)r[a]=e[a];return r},a_=function(e){return Array.isArray(e)?e:[e]},NG=function(e){return Array.isArray(e)?e[0]:e},Ege=function(e){if(e.nodeType!==Node.ELEMENT_NODE)return!1;var r=window.getComputedStyle(e,null);return!r||!r.getPropertyValue?!1:r.getPropertyValue("display")==="none"||r.getPropertyValue("visibility")==="hidden"},VG=function(e){return e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.host:e.parentNode},UG=function(e){return e===document||e&&e.nodeType===Node.DOCUMENT_NODE},Pge=function(e){return e.hasAttribute("inert")},Ige=function(e,r){return!e||UG(e)||!Ege(e)&&!Pge(e)&&r(VG(e))},$G=function(e,r){var a=e.get(r);if(a!==void 0)return a;var u=Ige(r,$G.bind(void 0,e));return e.set(r,u),u},Mge=function(e,r){return e&&!UG(e)?Dge(e)?r(VG(e)):!1:!0},WG=function(e,r){var a=e.get(r);if(a!==void 0)return a;var u=Mge(r,WG.bind(void 0,e));return e.set(r,u),u},qG=function(e){return e.dataset},Cge=function(e){return e.tagName==="BUTTON"},GG=function(e){return e.tagName==="INPUT"},HG=function(e){return GG(e)&&e.type==="radio"},Age=function(e){return!((GG(e)||Cge(e))&&(e.type==="hidden"||e.disabled))},Dge=function(e){var r=e.getAttribute(dge);return![!0,"true",""].includes(r)},NR=function(e){var r;return!!(e&&(!((r=qG(e))===null||r===void 0)&&r.focusGuard))},ZA=function(e){return!NR(e)},Rge=function(e){return!!e},Oge=function(e,r){var a=Math.max(0,e.tabIndex),u=Math.max(0,r.tabIndex),p=a-u,y=e.index-r.index;if(p){if(!a)return 1;if(!u)return-1}return p||y},Lge=function(e){return e.tabIndex<0&&!e.hasAttribute("tabindex")?0:e.tabIndex},VR=function(e,r,a){return Ff(e).map(function(u,p){var y=Lge(u);return{node:u,index:p,tabIndex:a&&y===-1?(u.dataset||{}).focusGuard?0:-1:y}}).filter(function(u){return!r||u.tabIndex>=0}).sort(Oge)},zge=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],UR=zge.join(","),Fge="".concat(UR,", [data-focus-guard]"),YG=function(e,r){return Ff((e.shadowRoot||e).children).reduce(function(a,u){return a.concat(u.matches(r?Fge:UR)?[u]:[],YG(u))},[])},kge=function(e,r){var a;return e instanceof HTMLIFrameElement&&(!((a=e.contentDocument)===null||a===void 0)&&a.body)?Vy([e.contentDocument.body],r):[e]},Vy=function(e,r){return e.reduce(function(a,u){var p,y=YG(u,r),x=(p=[]).concat.apply(p,y.map(function(i){return kge(i,r)}));return a.concat(x,u.parentNode?Ff(u.parentNode.querySelectorAll(UR)).filter(function(i){return i===u}):[])},[])},Bge=function(e){var r=e.querySelectorAll("[".concat(uge,"]"));return Ff(r).map(function(a){return Vy([a])}).reduce(function(a,u){return a.concat(u)},[])},$R=function(e,r){return Ff(e).filter(function(a){return $G(r,a)}).filter(function(a){return Age(a)})},Fj=function(e,r){return r===void 0&&(r=new Map),Ff(e).filter(function(a){return WG(r,a)})},WR=function(e,r,a){return VR($R(Vy(e,a),r),!0,a)},ix=function(e,r){return VR($R(Vy(e),r),!1)},jge=function(e,r){return $R(Bge(e),r)},e_=function(e,r){return e.shadowRoot?e_(e.shadowRoot,r):Object.getPrototypeOf(e).contains!==void 0&&Object.getPrototypeOf(e).contains.call(e,r)?!0:Ff(e.children).some(function(a){var u;if(a instanceof HTMLIFrameElement){var p=(u=a.contentDocument)===null||u===void 0?void 0:u.body;return p?e_(p,r):!1}return e_(a,r)})},Nge=function(e){for(var r=new Set,a=e.length,u=0;u<a;u+=1)for(var p=u+1;p<a;p+=1){var y=e[u].compareDocumentPosition(e[p]);(y&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&r.add(p),(y&Node.DOCUMENT_POSITION_CONTAINS)>0&&r.add(u)}return e.filter(function(x,i){return!r.has(i)})},ZG=function(e){return e.parentNode?ZG(e.parentNode):e},qR=function(e){var r=a_(e);return r.filter(Boolean).reduce(function(a,u){var p=u.getAttribute(HA);return a.push.apply(a,p?Nge(Ff(ZG(u).querySelectorAll("[".concat(HA,'="').concat(p,'"]:not([').concat(DG,'="disabled"])')))):[u]),a},[])},Vge=function(e){try{return e()}catch{return}},ox=function(e){if(e===void 0&&(e=document),!(!e||!e.activeElement)){var r=e.activeElement;return r.shadowRoot?ox(r.shadowRoot):r instanceof HTMLIFrameElement&&Vge(function(){return r.contentWindow.document})?ox(r.contentWindow.document):r}},Uge=function(e,r){return e===r},$ge=function(e,r){return!!Ff(e.querySelectorAll("iframe")).some(function(a){return Uge(a,r)})},XG=function(e,r){return r===void 0&&(r=ox(NG(e).ownerDocument)),!r||r.dataset&&r.dataset.focusGuard?!1:qR(e).some(function(a){return e_(a,r)||$ge(a,r)})},Wge=function(e){e===void 0&&(e=document);var r=ox(e);return r?Ff(e.querySelectorAll("[".concat(cge,"]"))).some(function(a){return e_(a,r)}):!1},qge=function(e,r){return r.filter(HG).filter(function(a){return a.name===e.name}).filter(function(a){return a.checked})[0]||e},GR=function(e,r){return HG(e)&&e.name?qge(e,r):e},Gge=function(e){var r=new Set;return e.forEach(function(a){return r.add(GR(a,e))}),e.filter(function(a){return r.has(a)})},kj=function(e){return e[0]&&e.length>1?GR(e[0],e):e[0]},Bj=function(e,r){return e.indexOf(GR(r,e))},XA="NEW_FOCUS",Hge=function(e,r,a,u,p){var y=e.length,x=e[0],i=e[y-1],C=NR(u);if(!(u&&e.indexOf(u)>=0)){var R=u!==void 0?a.indexOf(u):-1,z=p?a.indexOf(p):R,F=p?e.indexOf(p):-1;if(R===-1)return F!==-1?F:XA;if(F===-1)return XA;var V=R-z,G=a.indexOf(x),H=a.indexOf(i),Z=Gge(a),J=u!==void 0?Z.indexOf(u):-1,se=p?Z.indexOf(p):J,pe=Z.filter(function(ze){return ze.tabIndex>=0}),ve=u!==void 0?pe.indexOf(u):-1,Ne=p?pe.indexOf(p):ve,_e=ve>=0&&Ne>=0?Ne-ve:se-J;if(!V&&F>=0||r.length===0)return F;var Re=Bj(e,r[0]),ke=Bj(e,r[r.length-1]);if(R<=G&&C&&Math.abs(V)>1)return ke;if(R>=H&&C&&Math.abs(V)>1)return Re;if(V&&Math.abs(_e)>1)return F;if(R<=G)return ke;if(R>H)return Re;if(V)return Math.abs(V)>1?F:(y+F+V)%y}},Yge=function(e){return function(r){var a,u=(a=qG(r))===null||a===void 0?void 0:a.autofocus;return r.autofocus||u!==void 0&&u!=="false"||e.indexOf(r)>=0}},jj=function(e,r,a){var u=e.map(function(y){var x=y.node;return x}),p=Fj(u.filter(Yge(a)));return p&&p.length?kj(p):kj(Fj(r))},KA=function(e,r){return r===void 0&&(r=[]),r.push(e),e.parentNode&&KA(e.parentNode.host||e.parentNode,r),r},H2=function(e,r){for(var a=KA(e),u=KA(r),p=0;p<a.length;p+=1){var y=a[p];if(u.indexOf(y)>=0)return y}return!1},KG=function(e,r,a){var u=a_(e),p=a_(r),y=u[0],x=!1;return p.filter(Boolean).forEach(function(i){x=H2(x||i,i)||x,a.filter(Boolean).forEach(function(C){var R=H2(y,C);R&&(!x||e_(R,x)?x=R:x=H2(R,x))})}),x},Nj=function(e,r){return e.reduce(function(a,u){return a.concat(jge(u,r))},[])},Zge=function(e,r){var a=new Map;return r.forEach(function(u){return a.set(u.node,u)}),e.map(function(u){return a.get(u)}).filter(Rge)},Xge=function(e,r){var a=ox(a_(e).length>0?document:NG(e).ownerDocument),u=qR(e).filter(ZA),p=KG(a||e,e,u),y=new Map,x=ix(u,y),i=x.filter(function(H){var Z=H.node;return ZA(Z)});if(i[0]){var C=ix([p],y).map(function(H){var Z=H.node;return Z}),R=Zge(C,i),z=R.map(function(H){var Z=H.node;return Z}),F=R.filter(function(H){var Z=H.tabIndex;return Z>=0}).map(function(H){var Z=H.node;return Z}),V=Hge(z,F,C,a,r);if(V===XA){var G=jj(x,F,Nj(u,y))||jj(x,z,Nj(u,y));if(G)return{node:G};console.warn("focus-lock: cannot find any node to move focus into");return}return V===void 0?V:R[V]}},Kge=function(e){var r=qR(e).filter(ZA),a=KG(e,e,r),u=VR(Vy([a],!0),!0,!0),p=Vy(r,!1);return u.map(function(y){var x=y.node,i=y.index;return{node:x,index:i,lockItem:p.indexOf(x)>=0,guard:NR(x)}})},HR=function(e,r){e&&("focus"in e&&e.focus(r),"contentWindow"in e&&e.contentWindow&&e.contentWindow.focus())},Y2=0,Z2=!1,QG=function(e,r,a){a===void 0&&(a={});var u=Xge(e,r);if(!Z2&&u){if(Y2>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Z2=!0,setTimeout(function(){Z2=!1},1);return}Y2++,HR(u.node,a.focusOptions),Y2--}};function r0(e){if(!e)return null;if(typeof WeakRef>"u")return function(){return e||null};var r=e?new WeakRef(e):null;return function(){return r?.deref()||null}}var Qge=function(e){if(!e)return null;for(var r=[],a=e;a&&a!==document.body;)r.push({current:r0(a),parent:r0(a.parentElement),left:r0(a.previousElementSibling),right:r0(a.nextElementSibling)}),a=a.parentElement;return{element:r0(e),stack:r,ownerDocument:e.ownerDocument}},Jge=function(e){var r,a,u,p,y;if(e)for(var x=e.stack,i=e.ownerDocument,C=new Map,R=0,z=x;R<z.length;R++){var F=z[R],V=(r=F.parent)===null||r===void 0?void 0:r.call(F);if(V&&i.contains(V)){for(var G=(a=F.left)===null||a===void 0?void 0:a.call(F),H=F.current(),Z=V.contains(H)?H:void 0,J=(u=F.right)===null||u===void 0?void 0:u.call(F),se=WR([V],C),pe=(y=(p=Z??G?.nextElementSibling)!==null&&p!==void 0?p:J)!==null&&y!==void 0?y:G;pe;){for(var ve=0,Ne=se;ve<Ne.length;ve++){var _e=Ne[ve];if(pe?.contains(_e.node))return _e.node}pe=pe.nextElementSibling}if(se.length)return se[0].node}}},JG=function(e){var r=Qge(e);return function(){return Jge(r)}},e_e=function(e,r,a){if(!e||!r)return console.error("no element or scope given"),{};var u=a_(r);if(u.every(function(x){return!e_(x,e)}))return console.error("Active element is not contained in the scope"),{};var p=a?WR(u,new Map):ix(u,new Map),y=p.findIndex(function(x){var i=x.node;return i===e});if(y!==-1)return{prev:p[y-1],next:p[y+1],first:p[0],last:p[p.length-1]}},t_e=function(e,r){var a=r?WR(a_(e),new Map):ix(a_(e),new Map);return{first:a[0],last:a[a.length-1]}},r_e=function(e){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},e)},eH=function(e,r,a){r===void 0&&(r={});var u=r_e(r),p=e_e(e,u.scope,u.onlyTabbable);if(p){var y=a(p,u.cycle);y&&HR(y.node,u.focusOptions)}},n_e=function(e,r){r===void 0&&(r={}),eH(e,r,function(a,u){var p=a.next,y=a.first;return p||u&&y})},i_e=function(e,r){r===void 0&&(r={}),eH(e,r,function(a,u){var p=a.prev,y=a.last;return p||u&&y})},tH=function(e,r,a){var u,p=t_e(e,(u=r.onlyTabbable)!==null&&u!==void 0?u:!0),y=p[a];y&&HR(y.node,r.focusOptions)},o_e=function(e,r){r===void 0&&(r={}),tH(e,r,"first")},s_e=function(e,r){r===void 0&&(r={}),tH(e,r,"last")};function YR(e){setTimeout(e,1)}var a_e=function(r){return r&&"current"in r?r.current:r},rH=function(){return document&&document.activeElement===document.body},l_e=function(){return rH()||Wge()},My=null,bu=null,Vj=function(){return null},Cy=null,sx=!1,ZR=!1,c_e=function(){return!0},u_e=function(r){return(My.whiteList||c_e)(r)},d_e=function(r,a){Cy={observerNode:r,portaledElement:a}},h_e=function(r){return Cy&&Cy.portaledElement===r};function Uj(e,r,a,u){var p=null,y=e;do{var x=u[y];if(x.guard)x.node.dataset.focusAutoGuard&&(p=x);else if(x.lockItem){if(y!==e)return;p=null}else break}while((y+=a)!==r);p&&(p.node.tabIndex=0)}var f_e=function(r){return r?!!sx:sx==="meanwhile"},p_e=function e(r,a,u){return a&&(a.host===r&&(!a.activeElement||u.contains(a.activeElement))||a.parentNode&&e(r,a.parentNode,u))},m_e=function(r,a){return a.some(function(u){return p_e(r,u,u)})},nH=function(r){return ix(r,new Map)},g_e=function(r){return!nH([r.parentNode]).some(function(a){return a.node===r})},Ow=function(){var r=!1;if(My){var a=My,u=a.observed,p=a.persistentFocus,y=a.autoFocus,x=a.shards,i=a.crossFrame,C=a.focusOptions,R=a.noFocusGuards,z=u||Cy&&Cy.portaledElement;if(rH()&&bu&&bu!==document.body&&(!document.body.contains(bu)||g_e(bu))){var F=Vj();F&&F.focus()}var V=document&&document.activeElement;if(z){var G=[z].concat(x.map(a_e).filter(Boolean)),H=function(){if(!f_e(i)||!R||!bu||ZR)return!1;var ve=nH(G),Ne=ve.findIndex(function(_e){var Re=_e.node;return Re===bu});return Ne===0||Ne===ve.length-1};if((!V||u_e(V))&&(p||H()||!l_e()||!bu&&y)&&(z&&!(XG(G)||V&&m_e(V,G)||h_e(V))&&(document&&!bu&&V&&!y?(V.blur&&V.blur(),document.body.focus()):(r=QG(G,bu,{focusOptions:C}),Cy={})),bu=document&&document.activeElement,bu!==document.body&&(Vj=JG(bu)),sx=!1),document&&V!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var Z=document&&document.activeElement,J=Kge(G),se=J.map(function(pe){var ve=pe.node;return ve}).indexOf(Z);se>-1&&(J.filter(function(pe){var ve=pe.guard,Ne=pe.node;return ve&&Ne.dataset.focusAutoGuard}).forEach(function(pe){var ve=pe.node;return ve.removeAttribute("tabIndex")}),Uj(se,J.length,1,J),Uj(se,-1,-1,J))}}}return r},iH=function(r){Ow()&&r&&(r.stopPropagation(),r.preventDefault())},XR=function(){return YR(Ow)},__e=function(r){var a=r.target,u=r.currentTarget;u.contains(a)||d_e(u,a)},y_e=function(){return null},oH=function(){ZR=!0},sH=function(){ZR=!1,sx="just",YR(function(){sx="meanwhile"})},v_e=function(){document.addEventListener("focusin",iH),document.addEventListener("focusout",XR),window.addEventListener("focus",oH),window.addEventListener("blur",sH)},x_e=function(){document.removeEventListener("focusin",iH),document.removeEventListener("focusout",XR),window.removeEventListener("focus",oH),window.removeEventListener("blur",sH)};function b_e(e){return e.filter(function(r){var a=r.disabled;return!a})}var aH={moveFocusInside:QG,focusInside:XG,focusNextElement:n_e,focusPrevElement:i_e,focusFirstElement:o_e,focusLastElement:s_e,captureFocusRestore:JG};function w_e(e){var r=e.slice(-1)[0];r&&!My&&v_e();var a=My,u=a&&r&&r.id===a.id;My=r,a&&!u&&(a.onDeactivation(),e.filter(function(p){var y=p.id;return y===a.id}).length||a.returnFocus(!r)),r?(bu=null,(!u||a.observed!==r.observed)&&r.onActivation(aH),Ow(),YR(Ow)):(x_e(),bu=null)}BG.assignSyncMedium(__e);jG.assignMedium(XR);gge.assignMedium(function(e){return e(aH)});const S_e=Tge(b_e,w_e)(y_e);var QA=ge.forwardRef(function(r,a){return Js.createElement(jR,o_({sideCar:S_e,ref:a},r))}),lH=jR.propTypes||{};lH.sideCar;sge(lH,["sideCar"]);QA.propTypes={};const T_e=QA.default??QA,cH=e=>{const{initialFocusRef:r,finalFocusRef:a,contentRef:u,restoreFocus:p,children:y,isDisabled:x,autoFocus:i,persistentFocus:C,lockFocusAcrossFrames:R}=e,z=ge.useCallback(()=>{r?.current?r.current.focus():u?.current&&Nte(u.current).length===0&&requestAnimationFrame(()=>{u.current?.focus()})},[r,u]),F=ge.useCallback(()=>{a?.current?.focus()},[a]),V=p&&!a;return X.jsx(T_e,{crossFrame:R,persistentFocus:C,autoFocus:i,disabled:x,onActivation:z,onDeactivation:F,returnFocus:V,children:y})};cH.displayName="FocusLock";const zm=oi(function(r,a){const u=Dh("FormLabel",r),p=Il(r),{className:y,children:x,requiredIndicator:i=X.jsx(uH,{}),optionalIndicator:C=null,...R}=p,z=pS(),F=z?.getLabelProps(R,a)??{ref:a,...R};return X.jsxs(An.label,{...F,className:Yi("chakra-form__label",p.className),__css:{display:"block",textAlign:"start",...u},children:[x,z?.isRequired?i:C]})});zm.displayName="FormLabel";const uH=oi(function(r,a){const u=pS(),p=CG();if(!u?.isRequired)return null;const y=Yi("chakra-form__required-indicator",r.className);return X.jsx(An.span,{...u?.getRequiredIndicatorProps(r,a),__css:p.requiredIndicator,className:y})});uH.displayName="RequiredIndicator";const h_=oi(function(r,a){const{templateAreas:u,gap:p,rowGap:y,columnGap:x,column:i,row:C,autoFlow:R,autoRows:z,templateRows:F,autoColumns:V,templateColumns:G,...H}=r,Z={display:"grid",gridTemplateAreas:u,gridGap:p,gridRowGap:y,gridColumnGap:x,gridAutoColumns:V,gridColumn:i,gridRow:C,gridAutoFlow:R,gridAutoRows:z,gridTemplateRows:F,gridTemplateColumns:G};return X.jsx(An.div,{ref:a,__css:Z,...H})});h_.displayName="Grid";function $j(e){return Xw(e,r=>r==="auto"?"auto":`span ${r}/span ${r}`)}const Ch=oi(function(r,a){const{area:u,colSpan:p,colStart:y,colEnd:x,rowEnd:i,rowSpan:C,rowStart:R,...z}=r,F=Zw({gridArea:u,gridColumn:$j(p),gridRow:$j(C),gridColumnStart:y,gridColumnEnd:x,gridRowStart:R,gridRowEnd:i});return X.jsx(An.div,{ref:a,__css:F,...z})});Ch.displayName="GridItem";const Mh=oi(function(r,a){const{columns:u,spacingX:p,spacingY:y,spacing:x,minChildWidth:i,...C}=r,R=mG(),z=i?P_e(i,R):I_e(u);return X.jsx(h_,{ref:a,gap:x,columnGap:p,rowGap:y,templateColumns:z,...C})});Mh.displayName="SimpleGrid";function E_e(e){return typeof e=="number"?`${e}px`:e}function P_e(e,r){return Xw(e,a=>{const u=bme("sizes",a,E_e(a))(r);return a===null?null:`repeat(auto-fit, minmax(${u}, 1fr))`})}function I_e(e){return Xw(e,r=>r===null?null:`repeat(${r}, minmax(0, 1fr))`)}const JA=oi(function(r,a){const{htmlWidth:u,htmlHeight:p,alt:y,...x}=r;return X.jsx("img",{width:u,height:p,ref:a,alt:y,...x})});JA.displayName="NativeImage";const $m=oi(function(r,a){const{fallbackSrc:u,fallback:p,src:y,srcSet:x,align:i,fit:C,loading:R,ignoreFallback:z,crossOrigin:F,fallbackStrategy:V="beforeLoadOrError",referrerPolicy:G,...H}=r,Z=u!==void 0||p!==void 0,J=R!=null||z||!Z,se=IG({...r,crossOrigin:F,ignoreFallback:J}),pe=Kme(se,V),ve={ref:a,objectFit:C,objectPosition:i,...J?H:QW(H,["onError","onLoad"])};return pe?p||X.jsx(An.img,{as:JA,className:"chakra-image__placeholder",src:u,...ve}):X.jsx(An.img,{as:JA,src:y,srcSet:x,crossOrigin:F,loading:R,referrerPolicy:G,className:"chakra-image",...ve})});$m.displayName="Image";const El=oi(function(r,a){const{htmlSize:u,...p}=r,y=Bp("Input",p),x=Il(p),i=AG(x),C=Yi("chakra-input",r.className);return X.jsx(An.input,{size:u,...i,__css:y.field,ref:a,className:C})});El.displayName="Input";El.id="Input";const[M_e,C_e]=Pl({name:"InputGroupStylesContext",errorMessage:`useInputGroupStyles returned is 'undefined'. Seems you forgot to wrap the components in "<InputGroup />" `}),eD=oi(function(r,a){const u=Bp("Input",r),{children:p,className:y,...x}=Il(r),i=Yi("chakra-input__group",y),C={},R=XW(p),z=u.field;R.forEach(V=>{u&&(z&&V.type.id==="InputLeftElement"&&(C.paddingStart=z.height??z.h),z&&V.type.id==="InputRightElement"&&(C.paddingEnd=z.height??z.h),V.type.id==="InputRightAddon"&&(C.borderEndRadius=0),V.type.id==="InputLeftAddon"&&(C.borderStartRadius=0))});const F=R.map(V=>{const G=Zw({size:V.props?.size||r.size,variant:V.props?.variant||r.variant});return V.type.id!=="Input"?ge.cloneElement(V,G):ge.cloneElement(V,Object.assign(G,C,V.props))});return X.jsx(An.div,{className:i,ref:a,__css:{width:"100%",display:"flex",position:"relative",isolation:"isolate",...u.group},"data-group":!0,...x,children:X.jsx(M_e,{value:u,children:F})})});eD.displayName="InputGroup";const A_e=An("div",{baseStyle:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"0",zIndex:2}}),mS=oi(function(r,a){const{placement:u="left",...p}=r,y=C_e(),x=y.field,C={[u==="left"?"insetStart":"insetEnd"]:"0",width:x?.height??x?.h,height:x?.height??x?.h,fontSize:x?.fontSize,...y.element};return X.jsx(A_e,{ref:a,__css:C,...p})});mS.id="InputElement";mS.displayName="InputElement";const dH=oi(function(r,a){const{className:u,...p}=r,y=Yi("chakra-input__left-element",u);return X.jsx(mS,{ref:a,placement:"left",className:y,...p})});dH.id="InputLeftElement";dH.displayName="InputLeftElement";const Lw=oi(function(r,a){const{className:u,...p}=r,y=Yi("chakra-input__right-element",u);return X.jsx(mS,{ref:a,placement:"right",className:y,...p})});Lw.id="InputRightElement";Lw.displayName="InputRightElement";const B0=oi(function(r,a){const u=Dh("Link",r),{className:p,isExternal:y,...x}=Il(r);return X.jsx(An.a,{target:y?"_blank":void 0,rel:y?"noopener":void 0,ref:a,className:Yi("chakra-link",p),...x,__css:u})});B0.displayName="Link";function D_e(){const e=ge.useRef(new Map),r=e.current,a=ge.useCallback((p,y,x,i)=>{e.current.set(x,{type:y,el:p,options:i}),p.addEventListener(y,x,i)},[]),u=ge.useCallback((p,y,x,i)=>{p.removeEventListener(y,x,i),e.current.delete(x)},[]);return ge.useEffect(()=>()=>{r.forEach((p,y)=>{u(p.el,p.type,y,p.options)})},[u,r]),{add:a,remove:u}}function X2(e){const r=e.composedPath?.()?.[0]??e.target,{tagName:a,isContentEditable:u}=r;return a!=="INPUT"&&a!=="TEXTAREA"&&u!==!0}function R_e(e={}){const{ref:r,isDisabled:a,isFocusable:u,clickOnEnter:p=!0,clickOnSpace:y=!0,onMouseDown:x,onMouseUp:i,onClick:C,onKeyDown:R,onKeyUp:z,tabIndex:F,onMouseOver:V,onMouseLeave:G,...H}=e,[Z,J]=ge.useState(!0),[se,pe]=ge.useState(!1),ve=D_e(),Ne=lt=>{lt&&lt.tagName!=="BUTTON"&&J(!1)},_e=Z?F:F||0,Re=a&&!u,ke=ge.useCallback(lt=>{if(a){lt.stopPropagation(),lt.preventDefault();return}lt.currentTarget.focus(),C?.(lt)},[a,C]),ze=ge.useCallback(lt=>{se&&X2(lt)&&(lt.preventDefault(),lt.stopPropagation(),pe(!1),ve.remove(document,"keyup",ze,!1))},[se,ve]),et=ge.useCallback(lt=>{if(R?.(lt),a||lt.defaultPrevented||lt.metaKey||!X2(lt.nativeEvent)||Z)return;const Et=p&&lt.key==="Enter";y&&lt.key===" "&&(lt.preventDefault(),pe(!0)),Et&&(lt.preventDefault(),lt.currentTarget.click()),ve.add(document,"keyup",ze,!1)},[a,Z,R,p,y,ve,ze]),ht=ge.useCallback(lt=>{if(z?.(lt),a||lt.defaultPrevented||lt.metaKey||!X2(lt.nativeEvent)||Z)return;y&&lt.key===" "&&(lt.preventDefault(),pe(!1),lt.currentTarget.click())},[y,Z,a,z]),Xt=ge.useCallback(lt=>{lt.button===0&&(pe(!1),ve.remove(document,"mouseup",Xt,!1))},[ve]),Ir=ge.useCallback(lt=>{if(lt.button!==0)return;if(a){lt.stopPropagation(),lt.preventDefault();return}Z||pe(!0),lt.currentTarget.focus({preventScroll:!0}),ve.add(document,"mouseup",Xt,!1),x?.(lt)},[a,Z,x,ve,Xt]),nr=ge.useCallback(lt=>{lt.button===0&&(Z||pe(!1),i?.(lt))},[i,Z]),Fr=ge.useCallback(lt=>{if(a){lt.preventDefault();return}V?.(lt)},[a,V]),Or=ge.useCallback(lt=>{se&&(lt.preventDefault(),pe(!1)),G?.(lt)},[se,G]),or=Nm(r,Ne);return Z?{...H,ref:or,type:"button","aria-disabled":Re?void 0:a,disabled:Re,onClick:ke,onMouseDown:x,onMouseUp:i,onKeyUp:z,onKeyDown:R,onMouseOver:V,onMouseLeave:G}:{...H,ref:or,role:"button","data-active":Ku(se),"aria-disabled":a?"true":void 0,tabIndex:Re?void 0:_e,onClick:ke,onMouseDown:Ir,onMouseUp:nr,onKeyUp:ht,onKeyDown:et,onMouseOver:Fr,onMouseLeave:Or}}var O_e=function(e){if(typeof document>"u")return null;var r=Array.isArray(e)?e[0]:e;return r.ownerDocument.body},ey=new WeakMap,Yb=new WeakMap,Zb={},K2=0,hH=function(e){return e&&(e.host||hH(e.parentNode))},L_e=function(e,r){return r.map(function(a){if(e.contains(a))return a;var u=hH(a);return u&&e.contains(u)?u:(console.error("aria-hidden",a,"in not contained inside",e,". Doing nothing"),null)}).filter(function(a){return!!a})},z_e=function(e,r,a,u){var p=L_e(r,Array.isArray(e)?e:[e]);Zb[a]||(Zb[a]=new WeakMap);var y=Zb[a],x=[],i=new Set,C=new Set(p),R=function(F){!F||i.has(F)||(i.add(F),R(F.parentNode))};p.forEach(R);var z=function(F){!F||C.has(F)||Array.prototype.forEach.call(F.children,function(V){if(i.has(V))z(V);else try{var G=V.getAttribute(u),H=G!==null&&G!=="false",Z=(ey.get(V)||0)+1,J=(y.get(V)||0)+1;ey.set(V,Z),y.set(V,J),x.push(V),Z===1&&H&&Yb.set(V,!0),J===1&&V.setAttribute(a,"true"),H||V.setAttribute(u,"true")}catch(se){console.error("aria-hidden: cannot operate on ",V,se)}})};return z(r),i.clear(),K2++,function(){x.forEach(function(F){var V=ey.get(F)-1,G=y.get(F)-1;ey.set(F,V),y.set(F,G),V||(Yb.has(F)||F.removeAttribute(u),Yb.delete(F)),G||F.removeAttribute(a)}),K2--,K2||(ey=new WeakMap,ey=new WeakMap,Yb=new WeakMap,Zb={})}},F_e=function(e,r,a){a===void 0&&(a="data-aria-hidden");var u=Array.from(Array.isArray(e)?e:[e]),p=O_e(e);return p?(u.push.apply(u,Array.from(p.querySelectorAll("[aria-live], script"))),z_e(u,p,a,"aria-hidden")):function(){return null}},k_e=Object.defineProperty,B_e=(e,r,a)=>r in e?k_e(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,j_e=(e,r,a)=>(B_e(e,r+"",a),a);class N_e{constructor(){j_e(this,"modals"),this.modals=new Set}add(r){return this.modals.add(r),this.modals.size}remove(r){this.modals.delete(r)}isTopModal(r){if(!r)return!1;const a=Array.from(this.modals)[this.modals.size-1];return r===a}}const tD=new N_e;function fH(e,r){const[a,u]=ge.useState(0);return ge.useEffect(()=>{const p=e.current;if(p){if(r){const y=tD.add(p);u(y)}return()=>{tD.remove(p),u(0)}}},[r,e]),a}function V_e(e){const{isOpen:r,onClose:a,id:u,closeOnOverlayClick:p=!0,closeOnEsc:y=!0,useInert:x=!0,onOverlayClick:i,onEsc:C}=e,R=ge.useRef(null),z=ge.useRef(null),[F,V,G]=$_e(u,"chakra-modal","chakra-modal--header","chakra-modal--body");U_e(R,r&&x);const H=fH(R,r),Z=ge.useRef(null),J=ge.useCallback(et=>{Z.current=et.target},[]),se=ge.useCallback(et=>{et.key==="Escape"&&(et.stopPropagation(),y&&a?.(),C?.())},[y,a,C]),[pe,ve]=ge.useState(!1),[Ne,_e]=ge.useState(!1),Re=ge.useCallback((et={},ht=null)=>({role:"dialog",...et,ref:Nm(ht,R),id:F,tabIndex:-1,"aria-modal":!0,"aria-labelledby":pe?V:void 0,"aria-describedby":Ne?G:void 0,onClick:Ph(et.onClick,Xt=>Xt.stopPropagation())}),[G,Ne,F,V,pe]),ke=ge.useCallback(et=>{et.stopPropagation(),Z.current===et.target&&tD.isTopModal(R.current)&&(p&&a?.(),i?.())},[a,p,i]),ze=ge.useCallback((et={},ht=null)=>({...et,ref:Nm(ht,z),onClick:Ph(et.onClick,ke),onKeyDown:Ph(et.onKeyDown,se),onMouseDown:Ph(et.onMouseDown,J)}),[se,J,ke]);return{isOpen:r,onClose:a,headerId:V,bodyId:G,setBodyMounted:_e,setHeaderMounted:ve,dialogRef:R,overlayRef:z,getDialogProps:Re,getDialogContainerProps:ze,index:H}}function U_e(e,r){const a=e.current;ge.useEffect(()=>{if(!(!e.current||!r))return F_e(e.current)},[r,e,a])}function $_e(e,...r){const a=ge.useId(),u=e||a;return ge.useMemo(()=>r.map(p=>`${p}-${u}`),[u,r])}const[W_e,Qy]=Pl({name:"ModalStylesContext",errorMessage:`useModalStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Modal />" `}),[q_e,l_]=Pl({strict:!0,name:"ModalContext",errorMessage:"useModalContext: `context` is undefined. Seems you forgot to wrap modal components in `<Modal />`"}),f_=e=>{const r={scrollBehavior:"outside",autoFocus:!0,trapFocus:!0,returnFocusOnClose:!0,blockScrollOnMount:!0,allowPinchZoom:!1,preserveScrollBarGap:!0,motionPreset:"scale",...e,lockFocusAcrossFrames:e.lockFocusAcrossFrames??!0},{portalProps:a,children:u,autoFocus:p,trapFocus:y,initialFocusRef:x,finalFocusRef:i,returnFocusOnClose:C,blockScrollOnMount:R,allowPinchZoom:z,preserveScrollBarGap:F,motionPreset:V,lockFocusAcrossFrames:G,animatePresenceProps:H,onCloseComplete:Z}=r,J=Bp("Modal",r),pe={...V_e(r),autoFocus:p,trapFocus:y,initialFocusRef:x,finalFocusRef:i,returnFocusOnClose:C,blockScrollOnMount:R,allowPinchZoom:z,preserveScrollBarGap:F,motionPreset:V,lockFocusAcrossFrames:G};return X.jsx(q_e,{value:pe,children:X.jsx(W_e,{value:J,children:X.jsx(Sx,{...H,onExitComplete:Z,children:pe.isOpen&&X.jsx(Mx,{...a,children:u})})})})};f_.displayName="Modal";var uw="right-scroll-bar-position",dw="width-before-scroll-bar",G_e="with-scroll-bars-hidden",H_e="--removed-body-scroll-bar-size",pH=FG(),Q2=function(){},gS=ge.forwardRef(function(e,r){var a=ge.useRef(null),u=ge.useState({onScrollCapture:Q2,onWheelCapture:Q2,onTouchMoveCapture:Q2}),p=u[0],y=u[1],x=e.forwardProps,i=e.children,C=e.className,R=e.removeScrollBar,z=e.enabled,F=e.shards,V=e.sideCar,G=e.noRelative,H=e.noIsolation,Z=e.inert,J=e.allowPinchZoom,se=e.as,pe=se===void 0?"div":se,ve=e.gapMode,Ne=OG(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_e=V,Re=RG([a,r]),ke=Mf(Mf({},Ne),p);return ge.createElement(ge.Fragment,null,z&&ge.createElement(_e,{sideCar:pH,removeScrollBar:R,shards:F,noRelative:G,noIsolation:H,inert:Z,setCallbacks:y,allowPinchZoom:!!J,lockRef:a,gapMode:ve}),x?ge.cloneElement(ge.Children.only(i),Mf(Mf({},ke),{ref:Re})):ge.createElement(pe,Mf({},ke,{className:C,ref:Re}),i))});gS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};gS.classNames={fullWidth:dw,zeroRight:uw};var Y_e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Z_e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var r=Y_e();return r&&e.setAttribute("nonce",r),e}function X_e(e,r){e.styleSheet?e.styleSheet.cssText=r:e.appendChild(document.createTextNode(r))}function K_e(e){var r=document.head||document.getElementsByTagName("head")[0];r.appendChild(e)}var Q_e=function(){var e=0,r=null;return{add:function(a){e==0&&(r=Z_e())&&(X_e(r,a),K_e(r)),e++},remove:function(){e--,!e&&r&&(r.parentNode&&r.parentNode.removeChild(r),r=null)}}},J_e=function(){var e=Q_e();return function(r,a){ge.useEffect(function(){return e.add(r),function(){e.remove()}},[r&&a])}},mH=function(){var e=J_e(),r=function(a){var u=a.styles,p=a.dynamic;return e(u,p),null};return r},eye={left:0,top:0,right:0,gap:0},J2=function(e){return parseInt(e||"",10)||0},tye=function(e){var r=window.getComputedStyle(document.body),a=r[e==="padding"?"paddingLeft":"marginLeft"],u=r[e==="padding"?"paddingTop":"marginTop"],p=r[e==="padding"?"paddingRight":"marginRight"];return[J2(a),J2(u),J2(p)]},rye=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return eye;var r=tye(e),a=document.documentElement.clientWidth,u=window.innerWidth;return{left:r[0],top:r[1],right:r[2],gap:Math.max(0,u-a+r[2]-r[0])}},nye=mH(),Ay="data-scroll-locked",iye=function(e,r,a,u){var p=e.left,y=e.top,x=e.right,i=e.gap;return a===void 0&&(a="margin"),`
  .`.concat(G_e,` {
   overflow: hidden `).concat(u,`;
   padding-right: `).concat(i,"px ").concat(u,`;
  }
  body[`).concat(Ay,`] {
    overflow: hidden `).concat(u,`;
    overscroll-behavior: contain;
    `).concat([r&&"position: relative ".concat(u,";"),a==="margin"&&`
    padding-left: `.concat(p,`px;
    padding-top: `).concat(y,`px;
    padding-right: `).concat(x,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(u,`;
    `),a==="padding"&&"padding-right: ".concat(i,"px ").concat(u,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(uw,` {
    right: `).concat(i,"px ").concat(u,`;
  }
  
  .`).concat(dw,` {
    margin-right: `).concat(i,"px ").concat(u,`;
  }
  
  .`).concat(uw," .").concat(uw,` {
    right: 0 `).concat(u,`;
  }
  
  .`).concat(dw," .").concat(dw,` {
    margin-right: 0 `).concat(u,`;
  }
  
  body[`).concat(Ay,`] {
    `).concat(H_e,": ").concat(i,`px;
  }
`)},Wj=function(){var e=parseInt(document.body.getAttribute(Ay)||"0",10);return isFinite(e)?e:0},oye=function(){ge.useEffect(function(){return document.body.setAttribute(Ay,(Wj()+1).toString()),function(){var e=Wj()-1;e<=0?document.body.removeAttribute(Ay):document.body.setAttribute(Ay,e.toString())}},[])},sye=function(e){var r=e.noRelative,a=e.noImportant,u=e.gapMode,p=u===void 0?"margin":u;oye();var y=ge.useMemo(function(){return rye(p)},[p]);return ge.createElement(nye,{styles:iye(y,!r,p,a?"":"!important")})},rD=!1;if(typeof window<"u")try{var Xb=Object.defineProperty({},"passive",{get:function(){return rD=!0,!0}});window.addEventListener("test",Xb,Xb),window.removeEventListener("test",Xb,Xb)}catch{rD=!1}var ty=rD?{passive:!1}:!1,aye=function(e){return e.tagName==="TEXTAREA"},gH=function(e,r){if(!(e instanceof Element))return!1;var a=window.getComputedStyle(e);return a[r]!=="hidden"&&!(a.overflowY===a.overflowX&&!aye(e)&&a[r]==="visible")},lye=function(e){return gH(e,"overflowY")},cye=function(e){return gH(e,"overflowX")},qj=function(e,r){var a=r.ownerDocument,u=r;do{typeof ShadowRoot<"u"&&u instanceof ShadowRoot&&(u=u.host);var p=_H(e,u);if(p){var y=yH(e,u),x=y[1],i=y[2];if(x>i)return!0}u=u.parentNode}while(u&&u!==a.body);return!1},uye=function(e){var r=e.scrollTop,a=e.scrollHeight,u=e.clientHeight;return[r,a,u]},dye=function(e){var r=e.scrollLeft,a=e.scrollWidth,u=e.clientWidth;return[r,a,u]},_H=function(e,r){return e==="v"?lye(r):cye(r)},yH=function(e,r){return e==="v"?uye(r):dye(r)},hye=function(e,r){return e==="h"&&r==="rtl"?-1:1},fye=function(e,r,a,u,p){var y=hye(e,window.getComputedStyle(r).direction),x=y*u,i=a.target,C=r.contains(i),R=!1,z=x>0,F=0,V=0;do{if(!i)break;var G=yH(e,i),H=G[0],Z=G[1],J=G[2],se=Z-J-y*H;(H||se)&&_H(e,i)&&(F+=se,V+=H);var pe=i.parentNode;i=pe&&pe.nodeType===Node.DOCUMENT_FRAGMENT_NODE?pe.host:pe}while(!C&&i!==document.body||C&&(r.contains(i)||r===i));return(z&&Math.abs(F)<1||!z&&Math.abs(V)<1)&&(R=!0),R},Kb=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Gj=function(e){return[e.deltaX,e.deltaY]},Hj=function(e){return e&&"current"in e?e.current:e},pye=function(e,r){return e[0]===r[0]&&e[1]===r[1]},mye=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},gye=0,ry=[];function _ye(e){var r=ge.useRef([]),a=ge.useRef([0,0]),u=ge.useRef(),p=ge.useState(gye++)[0],y=ge.useState(mH)[0],x=ge.useRef(e);ge.useEffect(function(){x.current=e},[e]),ge.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(p));var Z=pge([e.lockRef.current],(e.shards||[]).map(Hj),!0).filter(Boolean);return Z.forEach(function(J){return J.classList.add("allow-interactivity-".concat(p))}),function(){document.body.classList.remove("block-interactivity-".concat(p)),Z.forEach(function(J){return J.classList.remove("allow-interactivity-".concat(p))})}}},[e.inert,e.lockRef.current,e.shards]);var i=ge.useCallback(function(Z,J){if("touches"in Z&&Z.touches.length===2||Z.type==="wheel"&&Z.ctrlKey)return!x.current.allowPinchZoom;var se=Kb(Z),pe=a.current,ve="deltaX"in Z?Z.deltaX:pe[0]-se[0],Ne="deltaY"in Z?Z.deltaY:pe[1]-se[1],_e,Re=Z.target,ke=Math.abs(ve)>Math.abs(Ne)?"h":"v";if("touches"in Z&&ke==="h"&&Re.type==="range")return!1;var ze=qj(ke,Re);if(!ze)return!0;if(ze?_e=ke:(_e=ke==="v"?"h":"v",ze=qj(ke,Re)),!ze)return!1;if(!u.current&&"changedTouches"in Z&&(ve||Ne)&&(u.current=_e),!_e)return!0;var et=u.current||_e;return fye(et,J,Z,et==="h"?ve:Ne)},[]),C=ge.useCallback(function(Z){var J=Z;if(!(!ry.length||ry[ry.length-1]!==y)){var se="deltaY"in J?Gj(J):Kb(J),pe=r.current.filter(function(_e){return _e.name===J.type&&(_e.target===J.target||J.target===_e.shadowParent)&&pye(_e.delta,se)})[0];if(pe&&pe.should){J.cancelable&&J.preventDefault();return}if(!pe){var ve=(x.current.shards||[]).map(Hj).filter(Boolean).filter(function(_e){return _e.contains(J.target)}),Ne=ve.length>0?i(J,ve[0]):!x.current.noIsolation;Ne&&J.cancelable&&J.preventDefault()}}},[]),R=ge.useCallback(function(Z,J,se,pe){var ve={name:Z,delta:J,target:se,should:pe,shadowParent:yye(se)};r.current.push(ve),setTimeout(function(){r.current=r.current.filter(function(Ne){return Ne!==ve})},1)},[]),z=ge.useCallback(function(Z){a.current=Kb(Z),u.current=void 0},[]),F=ge.useCallback(function(Z){R(Z.type,Gj(Z),Z.target,i(Z,e.lockRef.current))},[]),V=ge.useCallback(function(Z){R(Z.type,Kb(Z),Z.target,i(Z,e.lockRef.current))},[]);ge.useEffect(function(){return ry.push(y),e.setCallbacks({onScrollCapture:F,onWheelCapture:F,onTouchMoveCapture:V}),document.addEventListener("wheel",C,ty),document.addEventListener("touchmove",C,ty),document.addEventListener("touchstart",z,ty),function(){ry=ry.filter(function(Z){return Z!==y}),document.removeEventListener("wheel",C,ty),document.removeEventListener("touchmove",C,ty),document.removeEventListener("touchstart",z,ty)}},[]);var G=e.removeScrollBar,H=e.inert;return ge.createElement(ge.Fragment,null,H?ge.createElement(y,{styles:mye(p)}):null,G?ge.createElement(sye,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function yye(e){for(var r=null;e!==null;)e instanceof ShadowRoot&&(r=e.host,e=e.host),e=e.parentNode;return r}const vye=mge(pH,_ye);var vH=ge.forwardRef(function(e,r){return ge.createElement(gS,Mf({},e,{ref:r,sideCar:vye}))});vH.classNames=gS.classNames;function xye(e){const{autoFocus:r,trapFocus:a,dialogRef:u,initialFocusRef:p,blockScrollOnMount:y,allowPinchZoom:x,finalFocusRef:i,returnFocusOnClose:C,preserveScrollBarGap:R,lockFocusAcrossFrames:z,isOpen:F}=l_(),[V,G]=rR();ge.useEffect(()=>{!V&&G&&setTimeout(G)},[V,G]);const H=fH(u,F);return X.jsx(cH,{autoFocus:r,isDisabled:!a,initialFocusRef:p,finalFocusRef:i,restoreFocus:C,contentRef:u,lockFocusAcrossFrames:z,children:X.jsx(vH,{removeScrollBar:!R,allowPinchZoom:x,enabled:H===1&&y,forwardProps:!0,children:e.children})})}const bye={initial:({offsetX:e,offsetY:r,transition:a,transitionEnd:u,delay:p})=>({opacity:0,x:e,y:r,transition:a?.exit??Jg.exit(Qg.exit,p),transitionEnd:u?.exit}),enter:({transition:e,transitionEnd:r,delay:a})=>({opacity:1,x:0,y:0,transition:e?.enter??Jg.enter(Qg.enter,a),transitionEnd:r?.enter}),exit:({offsetY:e,offsetX:r,transition:a,transitionEnd:u,reverse:p,delay:y})=>{const x={x:r,y:e};return{opacity:0,transition:a?.exit??Jg.exit(Qg.exit,y),...p?{...x,transitionEnd:u?.exit}:{transitionEnd:{...x,...u?.exit}}}}},E0={initial:"initial",animate:"enter",exit:"exit",variants:bye},wye=ge.forwardRef(function(r,a){const{unmountOnExit:u,in:p,reverse:y=!0,className:x,offsetX:i=0,offsetY:C=8,transition:R,transitionEnd:z,delay:F,animatePresenceProps:V,...G}=r,H=u?p&&u:!0,Z=p||u?"enter":"exit",J={offsetX:i,offsetY:C,reverse:y,transition:R,transitionEnd:z,delay:F};return X.jsx(Sx,{...V,custom:J,children:H&&X.jsx(Hm.div,{ref:a,className:Yi("chakra-offset-slide",x),custom:J,...E0,animate:Z,...G})})});wye.displayName="SlideFade";const Sye={exit:({reverse:e,initialScale:r,transition:a,transitionEnd:u,delay:p})=>({opacity:0,...e?{scale:r,transitionEnd:u?.exit}:{transitionEnd:{scale:r,...u?.exit}},transition:a?.exit??Jg.exit(Qg.exit,p)}),enter:({transitionEnd:e,transition:r,delay:a})=>({opacity:1,scale:1,transition:r?.enter??Jg.enter(Qg.enter,a),transitionEnd:e?.enter})},xH={initial:"exit",animate:"enter",exit:"exit",variants:Sye},Tye=ge.forwardRef(function(r,a){const{unmountOnExit:u,in:p,reverse:y=!0,initialScale:x=.95,className:i,transition:C,transitionEnd:R,delay:z,animatePresenceProps:F,...V}=r,G=u?p&&u:!0,H=p||u?"enter":"exit",Z={initialScale:x,reverse:y,transition:C,transitionEnd:R,delay:z};return X.jsx(Sx,{...F,custom:Z,children:G&&X.jsx(Hm.div,{ref:a,className:Yi("chakra-offset-slide",i),...xH,animate:H,custom:Z,...V})})});Tye.displayName="ScaleFade";const Eye={slideInBottom:{...E0,custom:{offsetY:16,reverse:!0}},slideInRight:{...E0,custom:{offsetX:16,reverse:!0}},slideInTop:{...E0,custom:{offsetY:-16,reverse:!0}},slideInLeft:{...E0,custom:{offsetX:-16,reverse:!0}},scale:{...xH,custom:{initialScale:.95,reverse:!0}},none:{}},Pye=An(Hm.section),Iye=e=>Eye[e||"none"],bH=ge.forwardRef((e,r)=>{const{preset:a,motionProps:u=Iye(a),...p}=e;return X.jsx(Pye,{ref:r,...u,...p})});bH.displayName="ModalTransition";const p_=oi((e,r)=>{const{className:a,children:u,containerProps:p,motionProps:y,...x}=e,{getDialogProps:i,getDialogContainerProps:C}=l_(),R=i(x,r),z=C(p),F=Yi("chakra-modal__content",a),V=Qy(),G={display:"flex",flexDirection:"column",position:"relative",width:"100%",outline:0,...V.dialog},H={display:"flex",width:"100vw",height:"$100vh",position:"fixed",left:0,top:0,...V.dialogContainer},{motionPreset:Z}=l_();return X.jsx(xye,{children:X.jsx(An.div,{...z,className:"chakra-modal__content-container",tabIndex:-1,__css:H,children:X.jsx(bH,{preset:Z,motionProps:y,className:F,...R,__css:G,children:u})})})});p_.displayName="ModalContent";const m_=oi((e,r)=>{const{className:a,...u}=e,{bodyId:p,setBodyMounted:y}=l_();ge.useEffect(()=>(y(!0),()=>y(!1)),[y]);const x=Yi("chakra-modal__body",a),i=Qy();return X.jsx(An.div,{ref:r,className:x,id:p,...u,__css:i.body})});m_.displayName="ModalBody";const g_=oi((e,r)=>{const{onClick:a,className:u,...p}=e,{onClose:y}=l_(),x=Yi("chakra-modal__close-btn",u),i=Qy();return X.jsx(FR,{ref:r,__css:i.closeButton,className:x,onClick:Ph(a,C=>{C.stopPropagation(),y()}),...p})});g_.displayName="ModalCloseButton";const Cx=oi((e,r)=>{const{className:a,...u}=e,p=Yi("chakra-modal__footer",a),y=Qy(),x={display:"flex",alignItems:"center",justifyContent:"flex-end",...y.footer};return X.jsx(An.footer,{ref:r,...u,__css:x,className:p})});Cx.displayName="ModalFooter";const __=oi((e,r)=>{const{className:a,...u}=e,{headerId:p,setHeaderMounted:y}=l_();ge.useEffect(()=>(y(!0),()=>y(!1)),[y]);const x=Yi("chakra-modal__header",a),i=Qy(),C={flex:0,...i.header};return X.jsx(An.header,{ref:r,className:x,id:p,...u,__css:C})});__.displayName="ModalHeader";const Mye={enter:({transition:e,transitionEnd:r,delay:a}={})=>({opacity:1,transition:e?.enter??Jg.enter(Qg.enter,a),transitionEnd:r?.enter}),exit:({transition:e,transitionEnd:r,delay:a}={})=>({opacity:0,transition:e?.exit??Jg.exit(Qg.exit,a),transitionEnd:r?.exit})},wH={initial:"exit",animate:"enter",exit:"exit",variants:Mye},Cye=ge.forwardRef(function(r,a){const{unmountOnExit:u,in:p,className:y,transition:x,transitionEnd:i,delay:C,animatePresenceProps:R,...z}=r,F=p||u?"enter":"exit",V=u?p&&u:!0,G={transition:x,transitionEnd:i,delay:C};return X.jsx(Sx,{...R,custom:G,children:V&&X.jsx(Hm.div,{ref:a,className:Yi("chakra-fade",y),custom:G,...wH,animate:F,...z})})});Cye.displayName="Fade";const Aye=An(Hm.div),y_=oi((e,r)=>{const{className:a,transition:u,motionProps:p,...y}=e,x=Yi("chakra-modal__overlay",a),C={pos:"fixed",left:"0",top:"0",w:"100vw",h:"100vh",...Qy().overlay},{motionPreset:R}=l_(),F=p||(R==="none"?{}:wH);return X.jsx(Aye,{...F,__css:C,ref:r,className:x,...y})});y_.displayName="ModalOverlay";const SH=oi(function(r,a){const{children:u,placeholder:p,className:y,...x}=r;return X.jsxs(An.select,{...x,ref:a,className:Yi("chakra-select",y),children:[p&&X.jsx("option",{value:"",children:p}),u]})});SH.displayName="SelectField";const nD=oi((e,r)=>{const a=Bp("Select",e),{rootProps:u,placeholder:p,icon:y,color:x,height:i,h:C,minH:R,minHeight:z,iconColor:F,iconSize:V,...G}=Il(e),[H,Z]=Gte(G,Ore),J=AG(Z),se={width:"100%",height:"fit-content",position:"relative",color:x},pe={paddingEnd:"2rem",...a.field,_focus:{zIndex:"unset",...a.field?._focus}};return X.jsxs(An.div,{className:"chakra-select__wrapper",__css:se,...H,...u,children:[X.jsx(SH,{ref:r,height:C??i,minH:R??z,placeholder:p,...J,__css:pe,children:e.children}),X.jsx(TH,{"data-disabled":Ku(J.disabled),...(F||x)&&{color:F||x},__css:a.icon,...V&&{fontSize:V},children:y})]})});nD.displayName="Select";const Dye=e=>X.jsx("svg",{viewBox:"0 0 24 24",...e,children:X.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),Rye=An("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),TH=e=>{const{children:r=X.jsx(Dye,{}),...a}=e,u=ge.cloneElement(r,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return X.jsx(Rye,{...a,className:"chakra-select__icon-wrapper",children:ge.isValidElement(r)?u:null})};TH.displayName="SelectIcon";const iD=An("div",{baseStyle:{flex:1,justifySelf:"stretch",alignSelf:"stretch"}});iD.displayName="Spacer";const EH=e=>X.jsx(An.div,{className:"chakra-stack__item",...e,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...e.__css}});EH.displayName="StackItem";function Oye(e){const{spacing:r,direction:a}=e,u={column:{my:r,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:r,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:r,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:r,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":Xw(a,p=>u[p])}}const Ax=oi((e,r)=>{const{isInline:a,direction:u,align:p,justify:y,spacing:x="0.5rem",wrap:i,children:C,divider:R,className:z,shouldWrapChildren:F,...V}=e,G=a?"row":u??"column",H=ge.useMemo(()=>Oye({spacing:x,direction:G}),[x,G]),Z=!!R,J=!F&&!Z,se=ge.useMemo(()=>{const ve=XW(C);return J?ve:ve.map((Ne,_e)=>{const Re=typeof Ne.key<"u"?Ne.key:_e,ke=_e+1===ve.length,et=F?X.jsx(EH,{children:Ne},Re):Ne;if(!Z)return et;const ht=ge.cloneElement(R,{__css:H}),Xt=ke?null:ht;return X.jsxs(ge.Fragment,{children:[et,Xt]},Re)})},[R,H,Z,J,F,C]),pe=Yi("chakra-stack",z);return X.jsx(An.div,{ref:r,display:"flex",alignItems:p,justifyContent:y,flexDirection:G,flexWrap:i,gap:Z?void 0:x,className:pe,...V,children:se})});Ax.displayName="Stack";const Fi=oi((e,r)=>X.jsx(Ax,{align:"center",...e,direction:"row",ref:r}));Fi.displayName="HStack";const Wo=oi((e,r)=>X.jsx(Ax,{align:"center",...e,direction:"column",ref:r}));Wo.displayName="VStack";const[Lye,zye,Fye,kye]=Hme();function Bye(e){const{defaultIndex:r,onChange:a,index:u,isManual:p,isLazy:y,lazyBehavior:x="unmount",orientation:i="horizontal",direction:C="ltr",...R}=e,[z,F]=ge.useState(r??0),[V,G]=Xte({defaultValue:r??0,value:u,onChange:a});ge.useEffect(()=>{u!=null&&F(u)},[u]);const H=Fye(),Z=ge.useId();return{id:`tabs-${e.id??Z}`,selectedIndex:V,focusedIndex:z,setSelectedIndex:G,setFocusedIndex:F,isManual:p,isLazy:y,lazyBehavior:x,orientation:i,descendants:H,direction:C,htmlProps:R}}const[jye,PH]=Pl({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function Nye(e){const{focusedIndex:r,orientation:a,direction:u}=PH(),p=zye(),y=ge.useCallback(x=>{const i=()=>{const pe=p.nextEnabled(r);pe&&pe.node?.focus()},C=()=>{const pe=p.prevEnabled(r);pe&&pe.node?.focus()},R=()=>{const pe=p.firstEnabled();pe&&pe.node?.focus()},z=()=>{const pe=p.lastEnabled();pe&&pe.node?.focus()},F=a==="horizontal",V=a==="vertical",G=x.key,H=u==="ltr"?"ArrowLeft":"ArrowRight",Z=u==="ltr"?"ArrowRight":"ArrowLeft",se={[H]:()=>F&&C(),[Z]:()=>F&&i(),ArrowDown:()=>V&&i(),ArrowUp:()=>V&&C(),Home:R,End:z}[G];se&&(x.preventDefault(),se(x))},[p,r,a,u]);return{...e,role:"tablist","aria-orientation":a,onKeyDown:Ph(e.onKeyDown,y)}}function Vye(e){const{isDisabled:r=!1,isFocusable:a=!1,...u}=e,{setSelectedIndex:p,isManual:y,id:x,setFocusedIndex:i,selectedIndex:C}=PH(),{index:R,register:z}=kye({disabled:r&&!a}),F=R===C,V=()=>{p(R)},G=()=>{i(R),!y&&!(r&&a)&&p(R)};return{...R_e({...u,ref:Nm(z,e.ref),isDisabled:r,isFocusable:a,onClick:Ph(e.onClick,V)}),id:Uye(x,R),role:"tab",tabIndex:F?0:-1,type:"button","aria-selected":F,"aria-controls":$ye(x,R),onFocus:r?void 0:Ph(e.onFocus,G)}}Pl({});function Uye(e,r){return`${e}--tab-${r}`}function $ye(e,r){return`${e}--tabpanel-${r}`}const[Wye,IH]=Pl({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),MH=oi(function(r,a){const u=Bp("Tabs",r),{children:p,className:y,...x}=Il(r),{htmlProps:i,descendants:C,...R}=Bye(x),z=ge.useMemo(()=>R,[R]),{isFitted:F,...V}=i,G={position:"relative",...u.root};return X.jsx(Lye,{value:C,children:X.jsx(jye,{value:z,children:X.jsx(Wye,{value:u,children:X.jsx(An.div,{className:Yi("chakra-tabs",y),ref:a,...V,__css:G,children:p})})})})});MH.displayName="Tabs";const hw=oi(function(r,a){const u=IH(),p=Vye({...r,ref:a}),y={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...u.tab};return X.jsx(An.button,{...p,className:Yi("chakra-tabs__tab",r.className),__css:y})});hw.displayName="Tab";const CH=oi(function(r,a){const u=Nye({...r,ref:a}),p=IH(),y={display:"flex",...p.tablist};return X.jsx(An.div,{...u,className:Yi("chakra-tabs__tablist",r.className),__css:y})});CH.displayName="TabList";const[qye,AH]=Pl({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),oy=oi((e,r)=>{const a=Bp("Tag",e),u=Il(e),p={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...a.container};return X.jsx(qye,{value:a,children:X.jsx(An.span,{ref:r,...u,__css:p})})});oy.displayName="Tag";const Gye=oi((e,r)=>{const a=AH();return X.jsx(An.span,{ref:r,noOfLines:1,...e,__css:a.label})});Gye.displayName="TagLabel";const Hye=oi((e,r)=>X.jsx(mo,{ref:r,verticalAlign:"top",marginEnd:"0.5rem",...e}));Hye.displayName="TagLeftIcon";const Yye=oi((e,r)=>X.jsx(mo,{ref:r,verticalAlign:"top",marginStart:"0.5rem",...e}));Yye.displayName="TagRightIcon";const DH=e=>X.jsx(mo,{verticalAlign:"inherit",viewBox:"0 0 512 512",...e,children:X.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});DH.displayName="TagCloseIcon";const Zye=oi((e,r)=>{const{isDisabled:a,children:u,...p}=e,x={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",...AH().closeButton};return X.jsx(An.button,{ref:r,"aria-label":"close",...p,type:"button",disabled:a,__css:x,children:u||X.jsx(DH,{})})});Zye.displayName="TagCloseButton";function Xye(e,r){const a=e??"bottom";return{"top-start":{ltr:"top-left",rtl:"top-right"},"top-end":{ltr:"top-right",rtl:"top-left"},"bottom-start":{ltr:"bottom-left",rtl:"bottom-right"},"bottom-end":{ltr:"bottom-right",rtl:"bottom-left"}}[a]?.[r]??a}function Kye(e,r){const a=p=>({...r,...p,position:Xye(p?.position??r?.position,e)}),u=p=>{const y=a(p),x=wG(y);return If.notify(x,y)};return u.update=(p,y)=>{If.update(p,a(y))},u.promise=(p,y)=>{const x=u({...y.loading,status:"loading",duration:null});p.then(i=>u.update(x,{status:"success",duration:5e3,...Cd(y.success,i)})).catch(i=>u.update(x,{status:"error",duration:5e3,...Cd(y.error,i)}))},u.closeAll=If.closeAll,u.close=If.close,u.isActive=If.isActive,u}const Qye={duration:5e3,variant:"solid"},ny={theme:v8,colorMode:"light",toggleColorMode:()=>{},setColorMode:()=>{},defaultOptions:Qye,forced:!1};function Jye({theme:e=ny.theme,colorMode:r=ny.colorMode,toggleColorMode:a=ny.toggleColorMode,setColorMode:u=ny.setColorMode,defaultOptions:p=ny.defaultOptions,motionVariants:y,toastSpacing:x,component:i,forced:C}=ny){const R={colorMode:r,setColorMode:u,toggleColorMode:a,forced:C};return{ToastContainer:()=>X.jsx(z8,{theme:e,children:X.jsx(sS.Provider,{value:R,children:X.jsx(TG,{defaultOptions:p,motionVariants:y,toastSpacing:x,component:i})})}),toast:Kye(e.direction,p)}}const ko=oi(function(r,a){const u=Dh("Heading",r),{className:p,...y}=Il(r);return X.jsx(An.h2,{ref:a,className:Yi("chakra-heading",r.className),...y,__css:u})});ko.displayName="Heading";const zr=oi(function(r,a){const u=Dh("Text",r),{className:p,align:y,decoration:x,casing:i,...C}=Il(r),R=Zw({textAlign:r.align,textDecoration:r.decoration,textTransform:r.casing});return X.jsx(An.p,{ref:a,className:Yi("chakra-text",r.className),...R,...C,__css:u})});zr.displayName="Text";const _S=()=>{const{user:e,token:r,login:a,signup:u,logout:p,updateProfile:y,updateMyPassword:x,forgotPassword:i,resetPassword:C,deleteAccount:R,googleLogin:z,isLoggedIn:F,sendEmailCode:V,verifyEmailCode:G,sendSmsOtp:H,verifySmsOtp:Z,checkPhoneUnique:J,sendPhoneVerificationOtp:se,verifyPhoneVerificationOtp:pe}=HW();return{user:e,token:r,isLoggedIn:F,login:a,signup:u,logout:p,googleLogin:z,updateProfile:y,updateMyPassword:x,forgotPassword:i,resetPassword:C,deleteAccount:R,sendEmailCode:V,verifyEmailCode:G,sendSmsOtp:H,verifySmsOtp:Z,sendPhoneVerificationOtp:se,verifyPhoneVerificationOtp:pe,checkPhoneUnique:J,initGoogleLoginButton:Ne=>{if(!window.google?.accounts?.id)return;window.google.accounts.id.initialize({client_id:void 0,callback:Ne});const _e=document.getElementById("google-btn");_e&&(_e.innerHTML="",window.google.accounts.id.renderButton(_e,{type:"standard",theme:"outline",size:"large",width:Math.floor(_e.offsetWidth)}))}}};function eve(){const{user:e,isLoggedIn:r,logout:a}=_S(),[u,p]=ge.useState(!1),y=kp(),x=async()=>{await a(),y("/")};return ge.useEffect(()=>{const i=()=>{p(window.scrollY>50)};return window.addEventListener("scroll",i),()=>window.removeEventListener("scroll",i)},[]),X.jsx(Mn,{position:"fixed",px:8,py:1,top:"0",left:"0",w:"100%",zIndex:"1000",transition:"0.3s ease",bg:u?"rgba(254, 255, 254, 0.63)":"white",backdropFilter:u?"blur(10px)":"none",boxShadow:u?"md":"none",children:X.jsxs(Ic,{align:"center",children:[X.jsx(Fi,{spacing:2,children:X.jsx(B0,{as:Zv,to:"/",fontWeight:"medium",_hover:{textDecoration:"none",color:"blue.300"},children:"Travel"})}),X.jsx(iD,{}),X.jsx(Zv,{to:"/",children:X.jsx("img",{src:"/img/logo_h.png",alt:"Travel logo",style:{height:"60px",padding:"0"}})}),X.jsx(iD,{}),X.jsx(Fi,{spacing:4,children:r&&e?X.jsxs(X.Fragment,{children:[X.jsx(wo,{variant:"ghost",size:"sm",onClick:x,children:"Log out"}),X.jsx(Zv,{to:"/me?tab=profile",children:X.jsxs(Ic,{align:"center",gap:2,cursor:"pointer",children:[X.jsx(Ny,{size:"sm",name:e.name,src:e.photo?.startsWith("http")?e.photo:`undefined/img/users/${e.photo}`,border:"2px solid white"}),X.jsx(zr,{fontWeight:"medium",children:e.name?.split(" ")[0]})]})})]}):X.jsxs(X.Fragment,{children:[X.jsx(wo,{as:Zv,to:"/login",size:"sm",children:"Log in"}),X.jsx(wo,{as:Zv,to:"/signup",size:"sm",children:"Sign up"})]})})]})})}var RH={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Yj=Js.createContext&&Js.createContext(RH),tve=["attr","size","title"];function rve(e,r){if(e==null)return{};var a=nve(e,r),u,p;if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(p=0;p<y.length;p++)u=y[p],!(r.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(e,u)&&(a[u]=e[u])}return a}function nve(e,r){if(e==null)return{};var a={};for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){if(r.indexOf(u)>=0)continue;a[u]=e[u]}return a}function zw(){return zw=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},zw.apply(this,arguments)}function Zj(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);r&&(u=u.filter(function(p){return Object.getOwnPropertyDescriptor(e,p).enumerable})),a.push.apply(a,u)}return a}function Fw(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?Zj(Object(a),!0).forEach(function(u){ive(e,u,a[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zj(Object(a)).forEach(function(u){Object.defineProperty(e,u,Object.getOwnPropertyDescriptor(a,u))})}return e}function ive(e,r,a){return r=ove(r),r in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function ove(e){var r=sve(e,"string");return typeof r=="symbol"?r:r+""}function sve(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var u=a.call(e,r);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function OH(e){return e&&e.map((r,a)=>Js.createElement(r.tag,Fw({key:a},r.attr),OH(r.child)))}function Es(e){return r=>Js.createElement(ave,zw({attr:Fw({},e.attr)},r),OH(e.child))}function ave(e){var r=a=>{var{attr:u,size:p,title:y}=e,x=rve(e,tve),i=p||a.size||"1em",C;return a.className&&(C=a.className),e.className&&(C=(C?C+" ":"")+e.className),Js.createElement("svg",zw({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,u,x,{className:C,style:Fw(Fw({color:e.color||a.color},a.style),e.style),height:i,width:i,xmlns:"http://www.w3.org/2000/svg"}),y&&Js.createElement("title",null,y),e.children)};return Yj!==void 0?Js.createElement(Yj.Consumer,null,a=>r(a)):r(RH)}function lve(e){return Es({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(e)}function cve(e){return Es({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(e)}function uve(e){return Es({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"},child:[]}]})(e)}const dve={background:"rgba(255, 255, 255, 0.04)",borderRadius:"16px",boxShadow:"0 4px 30px rgba(210, 210, 210, 0.27)",backdropFilter:"blur(9.4px)",WebkitBackdropFilter:"blur(13.4px)",border:"1px solid rgba(255, 255, 255, 0.22)"};function LH({children:e,sx:r={},px:a,py:u,w:p,...y}){return X.jsx(Mn,{px:a??6,py:u??4,w:p??["90%","80%","60%"],sx:{...dve,...r},...y,children:e})}function hve(){return X.jsx(LH,{w:"100%",py:8,children:X.jsxs(Ic,{direction:["column","row"],justify:"space-between",align:"center",maxW:"6xl",mx:"auto",px:4,children:[X.jsxs(zr,{color:"gray.600",fontSize:"sm",children:[" ",new Date().getFullYear()," Travel. All rights reserved."]}),X.jsxs(Fi,{spacing:4,mt:[4,0],children:[X.jsx(B0,{href:"#",isExternal:!0,children:X.jsx(mo,{as:lve,w:5,h:5,color:"purple.500",_hover:{color:"purple.600"}})}),X.jsx(B0,{href:"#",isExternal:!0,children:X.jsx(mo,{as:cve,w:5,h:5,color:"purple.500",_hover:{color:"purple.600"}})}),X.jsx(B0,{href:"#",isExternal:!0,children:X.jsx(mo,{as:uve,w:5,h:5,color:"purple.500",_hover:{color:"purple.600"}})})]})]})})}function fve(){return X.jsxs(X.Fragment,{children:[X.jsx(eve,{}),X.jsx(lJ,{}),X.jsx(hve,{})]})}function pve(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(e)}function mve(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(e)}function oD(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(e)}function eE(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(e)}function tE(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"polyline",attr:{points:"12 6 12 12 16 14"},child:[]}]})(e)}function Xj(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(e)}function Kj(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(e)}function gve(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"},child:[]},{tag:"line",attr:{x1:"4",y1:"22",x2:"4",y2:"15"},child:[]}]})(e)}function _ve(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"},child:[]}]})(e)}function yve(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(e)}function vve(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(e)}function zH(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function xve(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"},child:[]}]})(e)}function sD(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)}function bve(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(e)}function Op(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"},child:[]}]})(e)}function Qj(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function FH(e){return Es({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function wve(e){return Es({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M7 15H5.5v-4.5H4V9h3v6zm6.5-1.5h-3v-1h2c.55 0 1-.45 1-1V10c0-.55-.45-1-1-1H9v1.5h3v1h-2c-.55 0-1 .45-1 1V15h4.5v-1.5zm6 .5v-4c0-.55-.45-1-1-1H15v1.5h3v1h-2v1h2v1h-3V15h3.5c.55 0 1-.45 1-1z"},child:[]}]})(e)}function Sve(e){return Es({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19.79 5.61A.998.998 0 0 0 19 4H6.83l7.97 7.97 4.99-6.36zM2.81 2.81 1.39 4.22 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-2.17l5.78 5.78 1.41-1.41L2.81 2.81z"},child:[]}]})(e)}function Tve(e){return Es({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"},child:[]}]})(e)}const kH=async(e="")=>{const r=e?`/tours?${e}`:"/tours";return(await Ni.get(r)).data.data.doc},Eve=async e=>(await Ni.get(`/tours/${e}`)).data.data.data,Pve=async(e,r)=>(await Ni.patch(`/tours/${e}`,r)).data.data.data,Ive=async e=>(await Ni.delete(`/tours/${e}`)).data,Mve=async e=>(await Ni.post("/tours",e)).data.data.data,Cve=async()=>(await Ni.get("/tours/top-5-cheap")).data.data.data,Ave=async e=>(await Ni.get(`/tours/monthly-plan?year=${e}`)).data.data.plan,Dve=async()=>(await Ni.get("/tours/tour-stats")).data.data.stats,Rve=async(e,r,a)=>(await Ni.get(`/tours/distance/${e},${r}/unit/${a}`)).data.data.data,Ove=async()=>(await Ni.get("/tours/countries")).data.data.countries,Lve=async()=>(await Ni.get("/tours/homepage-stats")).data.data,KR=qy(mx(RD((e,r)=>({tours:[],currentTour:null,stats:[],topTours:[],countries:[],monthlyPlan:[],distances:[],loading:!1,error:null,setCurrentTour:a=>e({currentTour:a}),fetchTours:async()=>{e({loading:!0});try{const a=await kH();e({tours:a})}catch(a){e({error:a.message})}finally{e({loading:!1})}},fetchTourById:async a=>{e({loading:!0});try{const u=await Eve(a);return e({currentTour:u}),u.data.doc}catch(u){e({error:u.message})}finally{e({loading:!1})}},fetchTopTours:async()=>{e({loading:!0});try{const a=await Cve();e({topTours:a})}catch(a){e({error:a.message})}finally{e({loading:!1})}},fetchStats:async()=>{try{const a=await Dve();e({stats:a})}catch(a){e({error:a.message})}},fetchMonthlyPlan:async a=>{try{const u=await Ave(a);e({monthlyPlan:u})}catch(u){e({error:u.message})}},fetchDistances:async(a,u,p)=>{try{const y=await Rve(a,u,p);e({distances:y})}catch(y){e({error:y.message})}},fetchCountries:async()=>{try{const a=await Ove();e({countries:Array.isArray(a)?a:[]})}catch{e({countries:[]})}},createTour:async a=>{const u=await Mve(a);e({tours:[...r().tours,u]})},updateTour:async(a,u)=>{const y=(await Pve(a,u)).data.doc;e({tours:r().tours.map(x=>x._id===a?y:x),currentTour:y})},deleteTour:async a=>{await Ive(a),e({tours:r().tours.filter(u=>u._id!==a)})}}),{name:"tour-storage",getStorage:()=>localStorage}),{name:"TourStore"})),Dx=()=>{const{tours:e,currentTour:r,countries:a,loading:u,error:p,fetchTours:y,fetchTour:x,fetchTourById:i,setCurrentTour:C,fetchCountries:R,fetchStats:z,fetchMonthlyPlan:F}=KR(),V=[{label:"Guided Tours Annually",value:"500+"},{label:"Satisfaction Rate",value:"90.5%"},{label:"Destinations",value:"150+"}],G=Array.isArray(e)?e:[],H=ge.useMemo(()=>[...G].sort(()=>.5-Math.random()),[G]),Z=H.slice(0,3),J=H.slice(3,7),se=G.length===0?"/img/default-hero.jpg":G[Math.floor(Math.random()*G.length)].imageCover;return{tours:G,featuredTours:Z,miniGridTours:J,heroImage:se,stats:V,countries:a,tour:r,setCurrentTour:C,fetchTours:y,fetchTourBySlug:x,fetchTourById:i,fetchCountries:R,fetchStats:z,fetchMonthlyPlan:F,loading:u,error:p}},zve=qy(mx((e,r)=>({filters:{search:"",country:"",priceMin:"",priceMax:"",dateFrom:"",dateTo:""},filteredTours:[],loading:!1,setFilter:(a,u)=>e({filters:{...r().filters,[a]:u}}),clearFilter:a=>e({filters:{...r().filters,[a]:""}}),clearAllFilters:()=>e({filters:{search:"",country:"",priceMin:"",priceMax:"",dateFrom:"",dateTo:""},filteredTours:[]}),buildQueryString:()=>{const a=new URLSearchParams,u=r().filters;return u.search&&a.append("search",u.search),u.country&&a.append("country",u.country),u.priceMin!==""&&a.append("price[gte]",u.priceMin),u.priceMax!==""&&a.append("price[lte]",u.priceMax),u.dateFrom&&a.append("startDateFrom",u.dateFrom),u.dateTo&&a.append("startDateTo",u.dateTo),a.toString()},applyFilters:async()=>{e({loading:!0});try{const a=r().buildQueryString(),u=await kH(a);return e({filteredTours:u}),u}finally{e({loading:!1})}},homepageStats:null,statsLoading:!1,statsError:null,fetchHomepageStats:async()=>{e({statsLoading:!0,statsError:null});try{const a=await Lve();return e({homepageStats:a,statsLoading:!1}),a}catch(a){e({statsLoading:!1,statsError:a?.response?.data?.message||a?.message||"Failed to load homepage stats"})}}}))),QR=()=>{const{filters:e,filteredTours:r,loading:a,setFilter:u,clearFilter:p,clearAllFilters:y,applyFilters:x,fetchHomepageStats:i,homepageStats:C}=zve(),R=F=>!F||isNaN(F)?"0":F>=1e3?(F/1e3).toFixed(1)+"k":F.toString(),z=C?{totalTours:`${C.totalTours||0}+`,totalReviews:R(C.totalReviews),totalBookings:R(C.totalBookings),topCountries:C.topCountries?.filter(F=>F.country)||[],topRatedTours:C.topRatedTours||[],guideCount:C.guideCount||0}:null;return{filters:e,filteredTours:r,loading:a,setFilter:u,clearFilter:p,clearAllFilters:y,applyFilters:x,fetchHomepageStats:i,homepageStats:C,formattedStats:z}},c_="/assets/default-BSCtZLS5.jpg";function Fve(e){return Es({attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#7CB342",d:"M24,4C13,4,4,13,4,24s9,20,20,20s20-9,20-20S35,4,24,4z"},child:[]},{tag:"path",attr:{fill:"#0277BD",d:"M45,24c0,11.7-9.5,21-21,21S3,35.7,3,24S12.3,3,24,3S45,12.3,45,24z M23.8,33.7c0-0.4-0.2-0.6-0.6-0.8 c-1.3-0.4-2.5-0.4-3.6-1.5c-0.2-0.4-0.2-0.8-0.4-1.3c-0.4-0.4-1.5-0.6-2.1-0.8c-0.8,0-1.7,0-2.7,0c-0.4,0-1.1,0-1.5,0 c-0.6-0.2-1.1-1.1-1.5-1.7c0-0.2,0-0.6-0.4-0.6c-0.4-0.2-0.8,0.2-1.3,0c-0.2-0.2-0.2-0.4-0.2-0.6c0-0.6,0.4-1.3,0.8-1.7 c0.6-0.4,1.3,0.2,1.9,0.2c0.2,0,0.2,0,0.4,0.2c0.6,0.2,0.8,1,0.8,1.7c0,0.2,0,0.4,0,0.4c0,0.2,0.2,0.2,0.4,0.2 c0.2-1.1,0.2-2.1,0.4-3.2c0-1.3,1.3-2.5,2.3-2.9c0.4-0.2,0.6,0.2,1.1,0c1.3-0.4,4.4-1.7,3.8-3.4c-0.4-1.5-1.7-2.9-3.4-2.7 c-0.4,0.2-0.6,0.4-1,0.6c-0.6,0.4-1.9,1.7-2.5,1.7c-1.1-0.2-1.1-1.7-0.8-2.3c0.2-0.8,2.1-3.6,3.4-3.1c0.2,0.2,0.6,0.6,0.8,0.8 c0.4,0.2,1.1,0.2,1.7,0.2c0.2,0,0.4,0,0.6-0.2c0.2-0.2,0.2-0.2,0.2-0.4c0-0.6-0.6-1.3-1-1.7c-0.4-0.4-1.1-0.8-1.7-1.1 c-2.1-0.6-5.5,0.2-7.1,1.7s-2.9,4-3.8,6.1c-0.4,1.3-0.8,2.9-1,4.4c-0.2,1-0.4,1.9,0.2,2.9c0.6,1.3,1.9,2.5,3.2,3.4 c0.8,0.6,2.5,0.6,3.4,1.7c0.6,0.8,0.4,1.9,0.4,2.9c0,1.3,0.8,2.3,1.3,3.4c0.2,0.6,0.4,1.5,0.6,2.1c0,0.2,0.2,1.5,0.2,1.7 c1.3,0.6,2.3,1.3,3.8,1.7c0.2,0,1-1.3,1-1.5c0.6-0.6,1.1-1.5,1.7-1.9c0.4-0.2,0.8-0.4,1.3-0.8c0.4-0.4,0.6-1.3,0.8-1.9 C23.8,35.1,24,34.3,23.8,33.7z M24.2,14.3c0.2,0,0.4-0.2,0.8-0.4c0.6-0.4,1.3-1.1,1.9-1.5c0.6-0.4,1.3-1.1,1.7-1.5 c0.6-0.4,1.1-1.3,1.3-1.9c0.2-0.4,0.8-1.3,0.6-1.9c-0.2-0.4-1.3-0.6-1.7-0.8c-1.7-0.4-3.1-0.6-4.8-0.6c-0.6,0-1.5,0.2-1.7,0.8 c-0.2,1.1,0.6,0.8,1.5,1.1c0,0,0.2,1.7,0.2,1.9c0.2,1-0.4,1.7-0.4,2.7c0,0.6,0,1.7,0.4,2.1L24.2,14.3z M41.8,29 c0.2-0.4,0.2-1.1,0.4-1.5c0.2-1,0.2-2.1,0.2-3.1c0-2.1-0.2-4.2-0.8-6.1c-0.4-0.6-0.6-1.3-0.8-1.9c-0.4-1.1-1-2.1-1.9-2.9 c-0.8-1.1-1.9-4-3.8-3.1c-0.6,0.2-1,1-1.5,1.5c-0.4,0.6-0.8,1.3-1.3,1.9c-0.2,0.2-0.4,0.6-0.2,0.8c0,0.2,0.2,0.2,0.4,0.2 c0.4,0.2,0.6,0.2,1,0.4c0.2,0,0.4,0.2,0.2,0.4c0,0,0,0.2-0.2,0.2c-1,1.1-2.1,1.9-3.1,2.9c-0.2,0.2-0.4,0.6-0.4,0.8 c0,0.2,0.2,0.2,0.2,0.4c0,0.2-0.2,0.2-0.4,0.4c-0.4,0.2-0.8,0.4-1.1,0.6c-0.2,0.4,0,1.1-0.2,1.5c-0.2,1.1-0.8,1.9-1.3,2.9 c-0.4,0.6-0.6,1.3-1,1.9c0,0.8-0.2,1.5,0.2,2.1c1,1.5,2.9,0.6,4.4,1.3c0.4,0.2,0.8,0.2,1.1,0.6c0.6,0.6,0.6,1.7,0.8,2.3 c0.2,0.8,0.4,1.7,0.8,2.5c0.2,1,0.6,2.1,0.8,2.9c1.9-1.5,3.6-3.1,4.8-5.2C40.6,32.4,41.2,30.7,41.8,29z"},child:[]}]})(e)}function BH({tour:e}){const r=kp(),a=KR(x=>x.setCurrentTour),u=e.imageCover?.startsWith("http")||e.cover?.startsWith("http")?e.imageCover||e.cover:e.imageCover?`/img/tours/${e.imageCover}`:e.cover?`/img/tours/${e.cover}`:c_,p=e.ratingsAverage??e.rating??4.5,y=()=>{a(e),r(`/tour/${e.slug}`)};return X.jsxs(Mn,{bg:"white",borderRadius:"2xl",overflow:"hidden",boxShadow:"lg",transition:"all 0.3s",_hover:{transform:"scale(1.02)",boxShadow:"xl"},children:[X.jsxs(Mn,{position:"relative",h:"240px",overflow:"hidden",onClick:y,cursor:"pointer",children:[X.jsx($m,{src:u,alt:e.name,w:"100%",fallbackSrc:c_,h:"100%",objectFit:"cover",transition:"0.4s",_hover:{transform:"scale(1.05)"}}),X.jsx(ko,{position:"absolute",bottom:"4",left:"4",color:"white",size:"md",zIndex:"2",textShadow:"0px 2px 4px rgba(0,0,0,0.6)",children:e.name}),e?.country&&X.jsxs(Mn,{position:"absolute",top:"10px",right:"10px",bg:"white",px:2.5,py:1,borderRadius:"full",display:"flex",alignItems:"center",gap:1,boxShadow:"sm",children:[X.jsx(mo,{as:Fve,boxSize:4}),X.jsx(zr,{fontWeight:"bold",fontSize:"sm",children:e.country})]})]}),X.jsxs(Mn,{p:5,children:[e?.difficulty&&X.jsxs(zr,{fontSize:"sm",color:"gray.500",mb:2,children:[e.difficulty,"  ",e.duration||"Multi"," days"]}),X.jsx(zr,{noOfLines:2,fontSize:"sm",color:"gray.700",mb:4,children:e.summary||"Amazing travel experience awaits!"}),X.jsxs(Ax,{spacing:2,fontSize:"sm",color:"gray.600",children:[e.startLocation?.description&&X.jsxs(Ic,{align:"center",gap:2,children:[X.jsx(mo,{as:zH,color:"purple.500"}),X.jsx(zr,{children:e.startLocation.description})]}),e.startDates?.length>0&&X.jsxs(Ic,{align:"center",gap:2,children:[X.jsx(mo,{as:oD,color:"purple.500"}),X.jsx(zr,{children:new Date(e.startDates[0]).toLocaleString("en-us",{month:"long",year:"numeric"})})]}),e.locations?.length>0&&X.jsxs(Ic,{align:"center",gap:2,children:[X.jsx(mo,{as:gve,color:"Purple.500"}),X.jsxs(zr,{children:[e.locations.length," stops"]})]}),e.maxGroupSize&&X.jsxs(Ic,{align:"center",gap:2,children:[X.jsx(mo,{as:FH,color:"purple.500"}),X.jsxs(zr,{children:[e.maxGroupSize," people"]})]})]})]}),X.jsxs(Ic,{justify:"space-between",align:"center",p:5,bg:"purple.50",children:[X.jsxs(Mn,{children:[e.price&&X.jsxs(zr,{fontWeight:"bold",fontSize:"lg",color:"purple.600",children:["$",e.price,X.jsxs(zr,{as:"span",color:"gray.500",fontSize:"sm",children:[" ","per person"]})]}),X.jsxs(Ic,{align:"center",mt:1,gap:1,color:"yellow.500",children:[X.jsx(mo,{as:Op}),X.jsx(zr,{fontWeight:"medium",color:"gray.700",children:p.toFixed(1)})]})]}),X.jsx(wo,{onClick:y,colorScheme:"purple",size:"sm",children:"Details"})]})]})}var rE={},n0={},i0={},zg={},nE={exports:{}};var Jj;function v_(){return Jj||(Jj=1,(function(e){(function(){var r={}.hasOwnProperty;function a(){for(var y="",x=0;x<arguments.length;x++){var i=arguments[x];i&&(y=p(y,u(i)))}return y}function u(y){if(typeof y=="string"||typeof y=="number")return y;if(typeof y!="object")return"";if(Array.isArray(y))return a.apply(null,y);if(y.toString!==Object.prototype.toString&&!y.toString.toString().includes("[native code]"))return y.toString();var x="";for(var i in y)r.call(y,i)&&y[i]&&(x=p(x,i));return x}function p(y,x){return x?y?y+" "+x:y+x:y}e.exports?(a.default=a,e.exports=a):window.classNames=a})()})(nE)),nE.exports}var iE={},oE={},sE={},aE={},ri={},e5;function Vi(){if(e5)return ri;e5=1,ri.secondsInYear=ri.secondsInWeek=ri.secondsInQuarter=ri.secondsInMonth=ri.secondsInMinute=ri.secondsInHour=ri.secondsInDay=ri.quartersInYear=ri.monthsInYear=ri.monthsInQuarter=ri.minutesInYear=ri.minutesInMonth=ri.minutesInHour=ri.minutesInDay=ri.minTime=ri.millisecondsInWeek=ri.millisecondsInSecond=ri.millisecondsInMinute=ri.millisecondsInHour=ri.millisecondsInDay=ri.maxTime=ri.daysInYear=ri.daysInWeek=ri.constructFromSymbol=void 0,ri.daysInWeek=7;const e=ri.daysInYear=365.2425,r=ri.maxTime=Math.pow(10,8)*24*60*60*1e3;ri.minTime=-r,ri.millisecondsInWeek=6048e5,ri.millisecondsInDay=864e5,ri.millisecondsInMinute=6e4,ri.millisecondsInHour=36e5,ri.millisecondsInSecond=1e3,ri.minutesInYear=525600,ri.minutesInMonth=43200,ri.minutesInDay=1440,ri.minutesInHour=60,ri.monthsInQuarter=3,ri.monthsInYear=12,ri.quartersInYear=4;const a=ri.secondsInHour=3600;ri.secondsInMinute=60;const u=ri.secondsInDay=a*24;ri.secondsInWeek=u*7;const p=ri.secondsInYear=u*e,y=ri.secondsInMonth=p/12;return ri.secondsInQuarter=y*3,ri.constructFromSymbol=Symbol.for("constructDateFrom"),ri}var t5;function Nn(){if(t5)return aE;t5=1,aE.constructFrom=r;var e=Vi();function r(a,u){return typeof a=="function"?a(u):a&&typeof a=="object"&&e.constructFromSymbol in a?a[e.constructFromSymbol](u):a instanceof Date?new a.constructor(u):new Date(u)}return aE}var lE={},r5;function Sr(){if(r5)return lE;r5=1,lE.toDate=r;var e=Nn();function r(a,u){return(0,e.constructFrom)(u||a,a)}return lE}var n5;function Np(){if(n5)return sE;n5=1,sE.addDays=a;var e=Nn(),r=Sr();function a(u,p,y){const x=(0,r.toDate)(u,y?.in);return isNaN(p)?(0,e.constructFrom)(y?.in||u,NaN):(p&&x.setDate(x.getDate()+p),x)}return sE}var cE={},i5;function Rx(){if(i5)return cE;i5=1,cE.addMonths=a;var e=Nn(),r=Sr();function a(u,p,y){const x=(0,r.toDate)(u,y?.in);if(isNaN(p))return(0,e.constructFrom)(y?.in||u,NaN);if(!p)return x;const i=x.getDate(),C=(0,e.constructFrom)(y?.in||u,x.getTime());C.setMonth(x.getMonth()+p+1,0);const R=C.getDate();return i>=R?C:(x.setFullYear(C.getFullYear(),C.getMonth(),i),x)}return cE}var o5;function jH(){if(o5)return oE;o5=1,oE.add=p;var e=Np(),r=Rx(),a=Nn(),u=Sr();function p(y,x,i){const{years:C=0,months:R=0,weeks:z=0,days:F=0,hours:V=0,minutes:G=0,seconds:H=0}=x,Z=(0,u.toDate)(y,i?.in),J=R||C?(0,r.addMonths)(Z,R+C*12):Z,se=F||z?(0,e.addDays)(J,F+z*7):J,pe=G+V*60,Ne=(H+pe*60)*1e3;return(0,a.constructFrom)(i?.in||y,+se+Ne)}return oE}var uE={},dE={},s5;function NH(){if(s5)return dE;s5=1,dE.isSaturday=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDay()===6}return dE}var hE={},a5;function VH(){if(a5)return hE;a5=1,hE.isSunday=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDay()===0}return hE}var fE={},l5;function yS(){if(l5)return fE;l5=1,fE.isWeekend=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in).getDay();return p===0||p===6}return fE}var c5;function UH(){if(c5)return uE;c5=1,uE.addBusinessDays=y;var e=Nn(),r=NH(),a=VH(),u=yS(),p=Sr();function y(x,i,C){const R=(0,p.toDate)(x,C?.in),z=(0,u.isWeekend)(R,C);if(isNaN(i))return(0,e.constructFrom)(C?.in,NaN);const F=R.getHours(),V=i<0?-1:1,G=Math.trunc(i/5);R.setDate(R.getDate()+G*7);let H=Math.abs(i%5);for(;H>0;)R.setDate(R.getDate()+V),(0,u.isWeekend)(R,C)||(H-=1);return z&&(0,u.isWeekend)(R,C)&&i!==0&&((0,r.isSaturday)(R,C)&&R.setDate(R.getDate()+(V<0?2:-1)),(0,a.isSunday)(R,C)&&R.setDate(R.getDate()+(V<0?1:-2))),R.setHours(F),R}return uE}var pE={},mE={},u5;function vS(){if(u5)return mE;u5=1,mE.addMilliseconds=a;var e=Nn(),r=Sr();function a(u,p,y){return(0,e.constructFrom)(y?.in||u,+(0,r.toDate)(u)+p)}return mE}var d5;function $H(){if(d5)return pE;d5=1,pE.addHours=a;var e=vS(),r=Vi();function a(u,p,y){return(0,e.addMilliseconds)(u,p*r.millisecondsInHour,y)}return pE}var gE={},_E={},yE={},vE={},Qb={},h5;function eu(){if(h5)return Qb;h5=1,Qb.getDefaultOptions=r,Qb.setDefaultOptions=a;let e={};function r(){return e}function a(u){e=u}return Qb}var f5;function kf(){if(f5)return vE;f5=1,vE.startOfWeek=a;var e=eu(),r=Sr();function a(u,p){const y=(0,e.getDefaultOptions)(),x=p?.weekStartsOn??p?.locale?.options?.weekStartsOn??y.weekStartsOn??y.locale?.options?.weekStartsOn??0,i=(0,r.toDate)(u,p?.in),C=i.getDay(),R=(C<x?7:0)+C-x;return i.setDate(i.getDate()-R),i.setHours(0,0,0,0),i}return vE}var p5;function Vp(){if(p5)return yE;p5=1,yE.startOfISOWeek=r;var e=kf();function r(a,u){return(0,e.startOfWeek)(a,{...u,weekStartsOn:1})}return yE}var m5;function x_(){if(m5)return _E;m5=1,_E.getISOWeekYear=u;var e=Nn(),r=Vp(),a=Sr();function u(p,y){const x=(0,a.toDate)(p,y?.in),i=x.getFullYear(),C=(0,e.constructFrom)(x,0);C.setFullYear(i+1,0,4),C.setHours(0,0,0,0);const R=(0,r.startOfISOWeek)(C),z=(0,e.constructFrom)(x,0);z.setFullYear(i,0,4),z.setHours(0,0,0,0);const F=(0,r.startOfISOWeek)(z);return x.getTime()>=R.getTime()?i+1:x.getTime()>=F.getTime()?i:i-1}return _E}var xE={},bE={},wE={},g5;function Ym(){if(g5)return wE;g5=1,wE.getTimezoneOffsetInMilliseconds=r;var e=Sr();function r(a){const u=(0,e.toDate)(a),p=new Date(Date.UTC(u.getFullYear(),u.getMonth(),u.getDate(),u.getHours(),u.getMinutes(),u.getSeconds(),u.getMilliseconds()));return p.setUTCFullYear(u.getFullYear()),+a-+p}return wE}var SE={},_5;function Xo(){if(_5)return SE;_5=1,SE.normalizeDates=r;var e=Nn();function r(a,...u){const p=e.constructFrom.bind(null,a||u.find(y=>typeof y=="object"));return u.map(p)}return SE}var TE={},y5;function xS(){if(y5)return TE;y5=1,TE.startOfDay=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setHours(0,0,0,0),p}return TE}var v5;function Zm(){if(v5)return bE;v5=1,bE.differenceInCalendarDays=p;var e=Ym(),r=Xo(),a=Vi(),u=xS();function p(y,x,i){const[C,R]=(0,r.normalizeDates)(i?.in,y,x),z=(0,u.startOfDay)(C),F=(0,u.startOfDay)(R),V=+z-(0,e.getTimezoneOffsetInMilliseconds)(z),G=+F-(0,e.getTimezoneOffsetInMilliseconds)(F);return Math.round((V-G)/a.millisecondsInDay)}return bE}var EE={},x5;function Ox(){if(x5)return EE;x5=1,EE.startOfISOWeekYear=u;var e=Nn(),r=x_(),a=Vp();function u(p,y){const x=(0,r.getISOWeekYear)(p,y),i=(0,e.constructFrom)(y?.in||p,0);return i.setFullYear(x,0,4),i.setHours(0,0,0,0),(0,a.startOfISOWeek)(i)}return EE}var b5;function WH(){if(b5)return xE;b5=1,xE.setISOWeekYear=p;var e=Nn(),r=Zm(),a=Ox(),u=Sr();function p(y,x,i){let C=(0,u.toDate)(y,i?.in);const R=(0,r.differenceInCalendarDays)(C,(0,a.startOfISOWeekYear)(C,i)),z=(0,e.constructFrom)(i?.in||y,0);return z.setFullYear(x,0,4),z.setHours(0,0,0,0),C=(0,a.startOfISOWeekYear)(z),C.setDate(C.getDate()+R),C}return xE}var w5;function qH(){if(w5)return gE;w5=1,gE.addISOWeekYears=a;var e=x_(),r=WH();function a(u,p,y){return(0,r.setISOWeekYear)(u,(0,e.getISOWeekYear)(u,y)+p,y)}return gE}var PE={},S5;function JR(){if(S5)return PE;S5=1,PE.addMinutes=a;var e=Vi(),r=Sr();function a(u,p,y){const x=(0,r.toDate)(u,y?.in);return x.setTime(x.getTime()+p*e.millisecondsInMinute),x}return PE}var IE={},T5;function eO(){if(T5)return IE;T5=1,IE.addQuarters=r;var e=Rx();function r(a,u,p){return(0,e.addMonths)(a,u*3,p)}return IE}var ME={},E5;function GH(){if(E5)return ME;E5=1,ME.addSeconds=r;var e=vS();function r(a,u,p){return(0,e.addMilliseconds)(a,u*1e3,p)}return ME}var CE={},P5;function bS(){if(P5)return CE;P5=1,CE.addWeeks=r;var e=Np();function r(a,u,p){return(0,e.addDays)(a,u*7,p)}return CE}var AE={},I5;function HH(){if(I5)return AE;I5=1,AE.addYears=r;var e=Rx();function r(a,u,p){return(0,e.addMonths)(a,u*12,p)}return AE}var DE={},M5;function kve(){if(M5)return DE;M5=1,DE.areIntervalsOverlapping=r;var e=Sr();function r(a,u,p){const[y,x]=[+(0,e.toDate)(a.start,p?.in),+(0,e.toDate)(a.end,p?.in)].sort((R,z)=>R-z),[i,C]=[+(0,e.toDate)(u.start,p?.in),+(0,e.toDate)(u.end,p?.in)].sort((R,z)=>R-z);return p?.inclusive?y<=C&&i<=x:y<C&&i<x}return DE}var RE={},OE={},C5;function YH(){if(C5)return OE;C5=1,OE.max=a;var e=Nn(),r=Sr();function a(u,p){let y,x=p?.in;return u.forEach(i=>{!x&&typeof i=="object"&&(x=e.constructFrom.bind(null,i));const C=(0,r.toDate)(i,x);(!y||y<C||isNaN(+C))&&(y=C)}),(0,e.constructFrom)(x,y||NaN)}return OE}var LE={},A5;function ZH(){if(A5)return LE;A5=1,LE.min=a;var e=Nn(),r=Sr();function a(u,p){let y,x=p?.in;return u.forEach(i=>{!x&&typeof i=="object"&&(x=e.constructFrom.bind(null,i));const C=(0,r.toDate)(i,x);(!y||y>C||isNaN(+C))&&(y=C)}),(0,e.constructFrom)(x,y||NaN)}return LE}var D5;function Bve(){if(D5)return RE;D5=1,RE.clamp=u;var e=Xo(),r=YH(),a=ZH();function u(p,y,x){const[i,C,R]=(0,e.normalizeDates)(x?.in,p,y.start,y.end);return(0,a.min)([(0,r.max)([i,C],x),R],x)}return RE}var zE={},R5;function XH(){if(R5)return zE;R5=1,zE.closestIndexTo=r;var e=Sr();function r(a,u){const p=+(0,e.toDate)(a);if(isNaN(p))return NaN;let y,x;return u.forEach((i,C)=>{const R=(0,e.toDate)(i);if(isNaN(+R)){y=NaN,x=NaN;return}const z=Math.abs(p-+R);(y==null||z<x)&&(y=C,x=z)}),y}return zE}var FE={},O5;function jve(){if(O5)return FE;O5=1,FE.closestTo=u;var e=Xo(),r=XH(),a=Nn();function u(p,y,x){const[i,...C]=(0,e.normalizeDates)(x?.in,p,...y),R=(0,r.closestIndexTo)(i,C);if(typeof R=="number"&&isNaN(R))return(0,a.constructFrom)(i,NaN);if(R!==void 0)return C[R]}return FE}var kE={},L5;function Jy(){if(L5)return kE;L5=1,kE.compareAsc=r;var e=Sr();function r(a,u){const p=+(0,e.toDate)(a)-+(0,e.toDate)(u);return p<0?-1:p>0?1:p}return kE}var BE={},z5;function Nve(){if(z5)return BE;z5=1,BE.compareDesc=r;var e=Sr();function r(a,u){const p=+(0,e.toDate)(a)-+(0,e.toDate)(u);return p>0?-1:p<0?1:p}return BE}var jE={},F5;function Ml(){if(F5)return jE;F5=1,jE.constructNow=r;var e=Nn();function r(a){return(0,e.constructFrom)(a,Date.now())}return jE}var NE={},k5;function Vve(){if(k5)return NE;k5=1,NE.daysToWeeks=r;var e=Vi();function r(a){const u=Math.trunc(a/e.daysInWeek);return u===0?0:u}return NE}var VE={},UE={},B5;function Lx(){if(B5)return UE;B5=1,UE.isSameDay=a;var e=Xo(),r=xS();function a(u,p,y){const[x,i]=(0,e.normalizeDates)(y?.in,u,p);return+(0,r.startOfDay)(x)==+(0,r.startOfDay)(i)}return UE}var $E={},WE={},j5;function KH(){if(j5)return WE;j5=1,WE.isDate=e;function e(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}return WE}var N5;function Xm(){if(N5)return $E;N5=1,$E.isValid=a;var e=KH(),r=Sr();function a(u){return!(!(0,e.isDate)(u)&&typeof u!="number"||isNaN(+(0,r.toDate)(u)))}return $E}var V5;function Uve(){if(V5)return VE;V5=1,VE.differenceInBusinessDays=x;var e=Xo(),r=Np(),a=Zm(),u=Lx(),p=Xm(),y=yS();function x(i,C,R){const[z,F]=(0,e.normalizeDates)(R?.in,i,C);if(!(0,p.isValid)(z)||!(0,p.isValid)(F))return NaN;const V=(0,a.differenceInCalendarDays)(z,F),G=V<0?-1:1,H=Math.trunc(V/7);let Z=H*5,J=(0,r.addDays)(F,H*7);for(;!(0,u.isSameDay)(z,J);)Z+=(0,y.isWeekend)(J,R)?0:G,J=(0,r.addDays)(J,G);return Z===0?0:Z}return VE}var qE={},U5;function QH(){if(U5)return qE;U5=1,qE.differenceInCalendarISOWeekYears=a;var e=Xo(),r=x_();function a(u,p,y){const[x,i]=(0,e.normalizeDates)(y?.in,u,p);return(0,r.getISOWeekYear)(x,y)-(0,r.getISOWeekYear)(i,y)}return qE}var GE={},$5;function $ve(){if($5)return GE;$5=1,GE.differenceInCalendarISOWeeks=p;var e=Ym(),r=Xo(),a=Vi(),u=Vp();function p(y,x,i){const[C,R]=(0,r.normalizeDates)(i?.in,y,x),z=(0,u.startOfISOWeek)(C),F=(0,u.startOfISOWeek)(R),V=+z-(0,e.getTimezoneOffsetInMilliseconds)(z),G=+F-(0,e.getTimezoneOffsetInMilliseconds)(F);return Math.round((V-G)/a.millisecondsInWeek)}return GE}var HE={},W5;function tO(){if(W5)return HE;W5=1,HE.differenceInCalendarMonths=r;var e=Xo();function r(a,u,p){const[y,x]=(0,e.normalizeDates)(p?.in,a,u),i=y.getFullYear()-x.getFullYear(),C=y.getMonth()-x.getMonth();return i*12+C}return HE}var YE={},ZE={},q5;function JH(){if(q5)return ZE;q5=1,ZE.getQuarter=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return Math.trunc(p.getMonth()/3)+1}return ZE}var G5;function e9(){if(G5)return YE;G5=1,YE.differenceInCalendarQuarters=a;var e=Xo(),r=JH();function a(u,p,y){const[x,i]=(0,e.normalizeDates)(y?.in,u,p),C=x.getFullYear()-i.getFullYear(),R=(0,r.getQuarter)(x)-(0,r.getQuarter)(i);return C*4+R}return YE}var XE={},H5;function rO(){if(H5)return XE;H5=1,XE.differenceInCalendarWeeks=p;var e=Ym(),r=Xo(),a=Vi(),u=kf();function p(y,x,i){const[C,R]=(0,r.normalizeDates)(i?.in,y,x),z=(0,u.startOfWeek)(C,i),F=(0,u.startOfWeek)(R,i),V=+z-(0,e.getTimezoneOffsetInMilliseconds)(z),G=+F-(0,e.getTimezoneOffsetInMilliseconds)(F);return Math.round((V-G)/a.millisecondsInWeek)}return XE}var KE={},Y5;function nO(){if(Y5)return KE;Y5=1,KE.differenceInCalendarYears=r;var e=Xo();function r(a,u,p){const[y,x]=(0,e.normalizeDates)(p?.in,a,u);return y.getFullYear()-x.getFullYear()}return KE}var QE={},Z5;function iO(){if(Z5)return QE;Z5=1,QE.differenceInDays=a;var e=Xo(),r=Zm();function a(p,y,x){const[i,C]=(0,e.normalizeDates)(x?.in,p,y),R=u(i,C),z=Math.abs((0,r.differenceInCalendarDays)(i,C));i.setDate(i.getDate()-R*z);const F=+(u(i,C)===-R),V=R*(z-F);return V===0?0:V}function u(p,y){const x=p.getFullYear()-y.getFullYear()||p.getMonth()-y.getMonth()||p.getDate()-y.getDate()||p.getHours()-y.getHours()||p.getMinutes()-y.getMinutes()||p.getSeconds()-y.getSeconds()||p.getMilliseconds()-y.getMilliseconds();return x<0?-1:x>0?1:x}return QE}var JE={},eP={},X5;function Km(){if(X5)return eP;X5=1,eP.getRoundingMethod=e;function e(r){return a=>{const p=(r?Math[r]:Math.trunc)(a);return p===0?0:p}}return eP}var K5;function oO(){if(K5)return JE;K5=1,JE.differenceInHours=u;var e=Km(),r=Xo(),a=Vi();function u(p,y,x){const[i,C]=(0,r.normalizeDates)(x?.in,p,y),R=(+i-+C)/a.millisecondsInHour;return(0,e.getRoundingMethod)(x?.roundingMethod)(R)}return JE}var tP={},rP={},Q5;function t9(){if(Q5)return rP;Q5=1,rP.subISOWeekYears=r;var e=qH();function r(a,u,p){return(0,e.addISOWeekYears)(a,-u,p)}return rP}var J5;function Wve(){if(J5)return tP;J5=1,tP.differenceInISOWeekYears=p;var e=Xo(),r=Jy(),a=QH(),u=t9();function p(y,x,i){const[C,R]=(0,e.normalizeDates)(i?.in,y,x),z=(0,r.compareAsc)(C,R),F=Math.abs((0,a.differenceInCalendarISOWeekYears)(C,R,i)),V=(0,u.subISOWeekYears)(C,z*F,i),G=+((0,r.compareAsc)(V,R)===-z),H=z*(F-G);return H===0?0:H}return tP}var nP={},e4;function sO(){if(e4)return nP;e4=1,nP.differenceInMilliseconds=r;var e=Sr();function r(a,u){return+(0,e.toDate)(a)-+(0,e.toDate)(u)}return nP}var iP={},t4;function aO(){if(t4)return iP;t4=1,iP.differenceInMinutes=u;var e=Km(),r=Vi(),a=sO();function u(p,y,x){const i=(0,a.differenceInMilliseconds)(p,y)/r.millisecondsInMinute;return(0,e.getRoundingMethod)(x?.roundingMethod)(i)}return iP}var oP={},sP={},aP={},r4;function lO(){if(r4)return aP;r4=1,aP.endOfDay=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setHours(23,59,59,999),p}return aP}var lP={},n4;function cO(){if(n4)return lP;n4=1,lP.endOfMonth=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getMonth();return p.setFullYear(p.getFullYear(),y+1,0),p.setHours(23,59,59,999),p}return lP}var i4;function r9(){if(i4)return sP;i4=1,sP.isLastDayOfMonth=u;var e=lO(),r=cO(),a=Sr();function u(p,y){const x=(0,a.toDate)(p,y?.in);return+(0,e.endOfDay)(x,y)==+(0,r.endOfMonth)(x,y)}return sP}var o4;function wS(){if(o4)return oP;o4=1,oP.differenceInMonths=p;var e=Xo(),r=Jy(),a=tO(),u=r9();function p(y,x,i){const[C,R,z]=(0,e.normalizeDates)(i?.in,y,y,x),F=(0,r.compareAsc)(R,z),V=Math.abs((0,a.differenceInCalendarMonths)(R,z));if(V<1)return 0;R.getMonth()===1&&R.getDate()>27&&R.setDate(30),R.setMonth(R.getMonth()-F*V);let G=(0,r.compareAsc)(R,z)===-F;(0,u.isLastDayOfMonth)(C)&&V===1&&(0,r.compareAsc)(C,z)===1&&(G=!1);const H=F*(V-+G);return H===0?0:H}return oP}var cP={},s4;function qve(){if(s4)return cP;s4=1,cP.differenceInQuarters=a;var e=Km(),r=wS();function a(u,p,y){const x=(0,r.differenceInMonths)(u,p,y)/3;return(0,e.getRoundingMethod)(y?.roundingMethod)(x)}return cP}var uP={},a4;function SS(){if(a4)return uP;a4=1,uP.differenceInSeconds=a;var e=Km(),r=sO();function a(u,p,y){const x=(0,r.differenceInMilliseconds)(u,p)/1e3;return(0,e.getRoundingMethod)(y?.roundingMethod)(x)}return uP}var dP={},l4;function Gve(){if(l4)return dP;l4=1,dP.differenceInWeeks=a;var e=Km(),r=iO();function a(u,p,y){const x=(0,r.differenceInDays)(u,p,y)/7;return(0,e.getRoundingMethod)(y?.roundingMethod)(x)}return dP}var hP={},c4;function n9(){if(c4)return hP;c4=1,hP.differenceInYears=u;var e=Xo(),r=Jy(),a=nO();function u(p,y,x){const[i,C]=(0,e.normalizeDates)(x?.in,p,y),R=(0,r.compareAsc)(i,C),z=Math.abs((0,a.differenceInCalendarYears)(i,C));i.setFullYear(1584),C.setFullYear(1584);const F=(0,r.compareAsc)(i,C)===-R,V=R*(z-+F);return V===0?0:V}return hP}var fP={},pP={},u4;function Up(){if(u4)return pP;u4=1,pP.normalizeInterval=r;var e=Xo();function r(a,u){const[p,y]=(0,e.normalizeDates)(a,u.start,u.end);return{start:p,end:y}}return pP}var d4;function i9(){if(d4)return fP;d4=1,fP.eachDayOfInterval=a;var e=Up(),r=Nn();function a(u,p){const{start:y,end:x}=(0,e.normalizeInterval)(p?.in,u);let i=+y>+x;const C=i?+y:+x,R=i?x:y;R.setHours(0,0,0,0);let z=p?.step??1;if(!z)return[];z<0&&(z=-z,i=!i);const F=[];for(;+R<=C;)F.push((0,r.constructFrom)(y,R)),R.setDate(R.getDate()+z),R.setHours(0,0,0,0);return i?F.reverse():F}return fP}var mP={},h4;function Hve(){if(h4)return mP;h4=1,mP.eachHourOfInterval=a;var e=Up(),r=Nn();function a(u,p){const{start:y,end:x}=(0,e.normalizeInterval)(p?.in,u);let i=+y>+x;const C=i?+y:+x,R=i?x:y;R.setMinutes(0,0,0);let z=p?.step??1;if(!z)return[];z<0&&(z=-z,i=!i);const F=[];for(;+R<=C;)F.push((0,r.constructFrom)(y,R)),R.setHours(R.getHours()+z);return i?F.reverse():F}return mP}var gP={},f4;function Yve(){if(f4)return gP;f4=1,gP.eachMinuteOfInterval=u;var e=Up(),r=JR(),a=Nn();function u(p,y){const{start:x,end:i}=(0,e.normalizeInterval)(y?.in,p);x.setSeconds(0,0);let C=+x>+i;const R=C?+x:+i;let z=C?i:x,F=y?.step??1;if(!F)return[];F<0&&(F=-F,C=!C);const V=[];for(;+z<=R;)V.push((0,a.constructFrom)(x,z)),z=(0,r.addMinutes)(z,F);return C?V.reverse():V}return gP}var _P={},p4;function Zve(){if(p4)return _P;p4=1,_P.eachMonthOfInterval=a;var e=Up(),r=Nn();function a(u,p){const{start:y,end:x}=(0,e.normalizeInterval)(p?.in,u);let i=+y>+x;const C=i?+y:+x,R=i?x:y;R.setHours(0,0,0,0),R.setDate(1);let z=p?.step??1;if(!z)return[];z<0&&(z=-z,i=!i);const F=[];for(;+R<=C;)F.push((0,r.constructFrom)(y,R)),R.setMonth(R.getMonth()+z);return i?F.reverse():F}return _P}var yP={},vP={},m4;function uO(){if(m4)return vP;m4=1,vP.startOfQuarter=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getMonth(),x=y-y%3;return p.setMonth(x,1),p.setHours(0,0,0,0),p}return vP}var g4;function Xve(){if(g4)return yP;g4=1,yP.eachQuarterOfInterval=p;var e=Up(),r=eO(),a=Nn(),u=uO();function p(y,x){const{start:i,end:C}=(0,e.normalizeInterval)(x?.in,y);let R=+i>+C;const z=R?+(0,u.startOfQuarter)(i):+(0,u.startOfQuarter)(C);let F=R?(0,u.startOfQuarter)(C):(0,u.startOfQuarter)(i),V=x?.step??1;if(!V)return[];V<0&&(V=-V,R=!R);const G=[];for(;+F<=z;)G.push((0,a.constructFrom)(i,F)),F=(0,r.addQuarters)(F,V);return R?G.reverse():G}return yP}var xP={},_4;function Kve(){if(_4)return xP;_4=1,xP.eachWeekOfInterval=p;var e=Up(),r=bS(),a=Nn(),u=kf();function p(y,x){const{start:i,end:C}=(0,e.normalizeInterval)(x?.in,y);let R=+i>+C;const z=R?(0,u.startOfWeek)(C,x):(0,u.startOfWeek)(i,x),F=R?(0,u.startOfWeek)(i,x):(0,u.startOfWeek)(C,x);z.setHours(15),F.setHours(15);const V=+F.getTime();let G=z,H=x?.step??1;if(!H)return[];H<0&&(H=-H,R=!R);const Z=[];for(;+G<=V;)G.setHours(0),Z.push((0,a.constructFrom)(i,G)),G=(0,r.addWeeks)(G,H),G.setHours(15);return R?Z.reverse():Z}return xP}var bP={},y4;function dO(){if(y4)return bP;y4=1,bP.eachWeekendOfInterval=p;var e=Up(),r=Nn(),a=i9(),u=yS();function p(y,x){const{start:i,end:C}=(0,e.normalizeInterval)(x?.in,y),R=(0,a.eachDayOfInterval)({start:i,end:C},x),z=[];let F=0;for(;F<R.length;){const V=R[F++];(0,u.isWeekend)(V)&&z.push((0,r.constructFrom)(i,V))}return z}return bP}var wP={},SP={},v4;function TS(){if(v4)return SP;v4=1,SP.startOfMonth=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setDate(1),p.setHours(0,0,0,0),p}return SP}var x4;function Qve(){if(x4)return wP;x4=1,wP.eachWeekendOfMonth=u;var e=dO(),r=cO(),a=TS();function u(p,y){const x=(0,a.startOfMonth)(p,y),i=(0,r.endOfMonth)(p,y);return(0,e.eachWeekendOfInterval)({start:x,end:i},y)}return wP}var TP={},EP={},b4;function o9(){if(b4)return EP;b4=1,EP.endOfYear=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getFullYear();return p.setFullYear(y+1,0,0),p.setHours(23,59,59,999),p}return EP}var PP={},w4;function hO(){if(w4)return PP;w4=1,PP.startOfYear=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setFullYear(p.getFullYear(),0,1),p.setHours(0,0,0,0),p}return PP}var S4;function Jve(){if(S4)return TP;S4=1,TP.eachWeekendOfYear=u;var e=dO(),r=o9(),a=hO();function u(p,y){const x=(0,a.startOfYear)(p,y),i=(0,r.endOfYear)(p,y);return(0,e.eachWeekendOfInterval)({start:x,end:i},y)}return TP}var IP={},T4;function e0e(){if(T4)return IP;T4=1,IP.eachYearOfInterval=a;var e=Up(),r=Nn();function a(u,p){const{start:y,end:x}=(0,e.normalizeInterval)(p?.in,u);let i=+y>+x;const C=i?+y:+x,R=i?x:y;R.setHours(0,0,0,0),R.setMonth(0,1);let z=p?.step??1;if(!z)return[];z<0&&(z=-z,i=!i);const F=[];for(;+R<=C;)F.push((0,r.constructFrom)(y,R)),R.setFullYear(R.getFullYear()+z);return i?F.reverse():F}return IP}var MP={},E4;function t0e(){if(E4)return MP;E4=1,MP.endOfDecade=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getFullYear(),x=9+Math.floor(y/10)*10;return p.setFullYear(x,11,31),p.setHours(23,59,59,999),p}return MP}var CP={},P4;function r0e(){if(P4)return CP;P4=1,CP.endOfHour=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setMinutes(59,59,999),p}return CP}var AP={},DP={},I4;function s9(){if(I4)return DP;I4=1,DP.endOfWeek=a;var e=eu(),r=Sr();function a(u,p){const y=(0,e.getDefaultOptions)(),x=p?.weekStartsOn??p?.locale?.options?.weekStartsOn??y.weekStartsOn??y.locale?.options?.weekStartsOn??0,i=(0,r.toDate)(u,p?.in),C=i.getDay(),R=(C<x?-7:0)+6-(C-x);return i.setDate(i.getDate()+R),i.setHours(23,59,59,999),i}return DP}var M4;function n0e(){if(M4)return AP;M4=1,AP.endOfISOWeek=r;var e=s9();function r(a,u){return(0,e.endOfWeek)(a,{...u,weekStartsOn:1})}return AP}var RP={},C4;function i0e(){if(C4)return RP;C4=1,RP.endOfISOWeekYear=u;var e=Nn(),r=x_(),a=Vp();function u(p,y){const x=(0,r.getISOWeekYear)(p,y),i=(0,e.constructFrom)(y?.in||p,0);i.setFullYear(x+1,0,4),i.setHours(0,0,0,0);const C=(0,a.startOfISOWeek)(i,y);return C.setMilliseconds(C.getMilliseconds()-1),C}return RP}var OP={},A4;function o0e(){if(A4)return OP;A4=1,OP.endOfMinute=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setSeconds(59,999),p}return OP}var LP={},D4;function s0e(){if(D4)return LP;D4=1,LP.endOfQuarter=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getMonth(),x=y-y%3+3;return p.setMonth(x,0),p.setHours(23,59,59,999),p}return LP}var zP={},R4;function a0e(){if(R4)return zP;R4=1,zP.endOfSecond=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setMilliseconds(999),p}return zP}var FP={},O4;function l0e(){if(O4)return FP;O4=1,FP.endOfToday=r;var e=lO();function r(a){return(0,e.endOfDay)(Date.now(),a)}return FP}var kP={},L4;function c0e(){if(L4)return kP;L4=1,kP.endOfTomorrow=r;var e=Ml();function r(a){const u=(0,e.constructNow)(a?.in),p=u.getFullYear(),y=u.getMonth(),x=u.getDate(),i=(0,e.constructNow)(a?.in);return i.setFullYear(p,y,x+1),i.setHours(23,59,59,999),a?.in?a.in(i):i}return kP}var BP={},z4;function u0e(){if(z4)return BP;z4=1,BP.endOfYesterday=a;var e=Nn(),r=Ml();function a(u){const p=(0,r.constructNow)(u?.in),y=(0,e.constructFrom)(u?.in,0);return y.setFullYear(p.getFullYear(),p.getMonth(),p.getDate()-1),y.setHours(23,59,59,999),y}return BP}var jP={},NP={},Jb={},e1={},F4;function d0e(){if(F4)return e1;F4=1,e1.formatDistance=void 0;const e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},r=(a,u,p)=>{let y;const x=e[a];return typeof x=="string"?y=x:u===1?y=x.one:y=x.other.replace("{{count}}",u.toString()),p?.addSuffix?p.comparison&&p.comparison>0?"in "+y:y+" ago":y};return e1.formatDistance=r,e1}var t1={},VP={},k4;function h0e(){if(k4)return VP;k4=1,VP.buildFormatLongFn=e;function e(r){return(a={})=>{const u=a.width?String(a.width):r.defaultWidth;return r.formats[u]||r.formats[r.defaultWidth]}}return VP}var B4;function f0e(){if(B4)return t1;B4=1,t1.formatLong=void 0;var e=h0e();const r={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},a={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},u={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"};return t1.formatLong={date:(0,e.buildFormatLongFn)({formats:r,defaultWidth:"full"}),time:(0,e.buildFormatLongFn)({formats:a,defaultWidth:"full"}),dateTime:(0,e.buildFormatLongFn)({formats:u,defaultWidth:"full"})},t1}var r1={},j4;function p0e(){if(j4)return r1;j4=1,r1.formatRelative=void 0;const e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},r=(a,u,p,y)=>e[a];return r1.formatRelative=r,r1}var n1={},UP={},N4;function m0e(){if(N4)return UP;N4=1,UP.buildLocalizeFn=e;function e(r){return(a,u)=>{const p=u?.context?String(u.context):"standalone";let y;if(p==="formatting"&&r.formattingValues){const i=r.defaultFormattingWidth||r.defaultWidth,C=u?.width?String(u.width):i;y=r.formattingValues[C]||r.formattingValues[i]}else{const i=r.defaultWidth,C=u?.width?String(u.width):r.defaultWidth;y=r.values[C]||r.values[i]}const x=r.argumentCallback?r.argumentCallback(a):a;return y[x]}}return UP}var V4;function g0e(){if(V4)return n1;V4=1,n1.localize=void 0;var e=m0e();const r={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},a={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},u={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},p={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},y={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},x={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},i=(C,R)=>{const z=Number(C),F=z%100;if(F>20||F<10)switch(F%10){case 1:return z+"st";case 2:return z+"nd";case 3:return z+"rd"}return z+"th"};return n1.localize={ordinalNumber:i,era:(0,e.buildLocalizeFn)({values:r,defaultWidth:"wide"}),quarter:(0,e.buildLocalizeFn)({values:a,defaultWidth:"wide",argumentCallback:C=>C-1}),month:(0,e.buildLocalizeFn)({values:u,defaultWidth:"wide"}),day:(0,e.buildLocalizeFn)({values:p,defaultWidth:"wide"}),dayPeriod:(0,e.buildLocalizeFn)({values:y,defaultWidth:"wide",formattingValues:x,defaultFormattingWidth:"wide"})},n1}var i1={},$P={},U4;function _0e(){if(U4)return $P;U4=1,$P.buildMatchFn=e;function e(u){return(p,y={})=>{const x=y.width,i=x&&u.matchPatterns[x]||u.matchPatterns[u.defaultMatchWidth],C=p.match(i);if(!C)return null;const R=C[0],z=x&&u.parsePatterns[x]||u.parsePatterns[u.defaultParseWidth],F=Array.isArray(z)?a(z,H=>H.test(R)):r(z,H=>H.test(R));let V;V=u.valueCallback?u.valueCallback(F):F,V=y.valueCallback?y.valueCallback(V):V;const G=p.slice(R.length);return{value:V,rest:G}}}function r(u,p){for(const y in u)if(Object.prototype.hasOwnProperty.call(u,y)&&p(u[y]))return y}function a(u,p){for(let y=0;y<u.length;y++)if(p(u[y]))return y}return $P}var WP={},$4;function y0e(){if($4)return WP;$4=1,WP.buildMatchPatternFn=e;function e(r){return(a,u={})=>{const p=a.match(r.matchPattern);if(!p)return null;const y=p[0],x=a.match(r.parsePattern);if(!x)return null;let i=r.valueCallback?r.valueCallback(x[0]):x[0];i=u.valueCallback?u.valueCallback(i):i;const C=a.slice(y.length);return{value:i,rest:C}}}return WP}var W4;function v0e(){if(W4)return i1;W4=1,i1.match=void 0;var e=_0e(),r=y0e();const a=/^(\d+)(th|st|nd|rd)?/i,u=/\d+/i,p={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},y={any:[/^b/i,/^(a|c)/i]},x={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},i={any:[/1/i,/2/i,/3/i,/4/i]},C={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},R={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},z={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},F={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},V={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},G={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}};return i1.match={ordinalNumber:(0,r.buildMatchPatternFn)({matchPattern:a,parsePattern:u,valueCallback:H=>parseInt(H,10)}),era:(0,e.buildMatchFn)({matchPatterns:p,defaultMatchWidth:"wide",parsePatterns:y,defaultParseWidth:"any"}),quarter:(0,e.buildMatchFn)({matchPatterns:x,defaultMatchWidth:"wide",parsePatterns:i,defaultParseWidth:"any",valueCallback:H=>H+1}),month:(0,e.buildMatchFn)({matchPatterns:C,defaultMatchWidth:"wide",parsePatterns:R,defaultParseWidth:"any"}),day:(0,e.buildMatchFn)({matchPatterns:z,defaultMatchWidth:"wide",parsePatterns:F,defaultParseWidth:"any"}),dayPeriod:(0,e.buildMatchFn)({matchPatterns:V,defaultMatchWidth:"any",parsePatterns:G,defaultParseWidth:"any"})},i1}var q4;function a9(){if(q4)return Jb;q4=1,Jb.enUS=void 0;var e=d0e(),r=f0e(),a=p0e(),u=g0e(),p=v0e();return Jb.enUS={code:"en-US",formatDistance:e.formatDistance,formatLong:r.formatLong,formatRelative:a.formatRelative,localize:u.localize,match:p.match,options:{weekStartsOn:0,firstWeekContainsDate:1}},Jb}var G4;function ev(){return G4||(G4=1,(function(e){Object.defineProperty(e,"defaultLocale",{enumerable:!0,get:function(){return r.enUS}});var r=a9()})(NP)),NP}var o1={},qP={},H4;function l9(){if(H4)return qP;H4=1,qP.getDayOfYear=u;var e=Zm(),r=hO(),a=Sr();function u(p,y){const x=(0,a.toDate)(p,y?.in);return(0,e.differenceInCalendarDays)(x,(0,r.startOfYear)(x))+1}return qP}var GP={},Y4;function fO(){if(Y4)return GP;Y4=1,GP.getISOWeek=p;var e=Vi(),r=Vp(),a=Ox(),u=Sr();function p(y,x){const i=(0,u.toDate)(y,x?.in),C=+(0,r.startOfISOWeek)(i)-+(0,a.startOfISOWeekYear)(i);return Math.round(C/e.millisecondsInWeek)+1}return GP}var HP={},YP={},ZP={},Z4;function ES(){if(Z4)return ZP;Z4=1,ZP.getWeekYear=p;var e=eu(),r=Nn(),a=kf(),u=Sr();function p(y,x){const i=(0,u.toDate)(y,x?.in),C=i.getFullYear(),R=(0,e.getDefaultOptions)(),z=x?.firstWeekContainsDate??x?.locale?.options?.firstWeekContainsDate??R.firstWeekContainsDate??R.locale?.options?.firstWeekContainsDate??1,F=(0,r.constructFrom)(x?.in||y,0);F.setFullYear(C+1,0,z),F.setHours(0,0,0,0);const V=(0,a.startOfWeek)(F,x),G=(0,r.constructFrom)(x?.in||y,0);G.setFullYear(C,0,z),G.setHours(0,0,0,0);const H=(0,a.startOfWeek)(G,x);return+i>=+V?C+1:+i>=+H?C:C-1}return ZP}var X4;function pO(){if(X4)return YP;X4=1,YP.startOfWeekYear=p;var e=eu(),r=Nn(),a=ES(),u=kf();function p(y,x){const i=(0,e.getDefaultOptions)(),C=x?.firstWeekContainsDate??x?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,R=(0,a.getWeekYear)(y,x),z=(0,r.constructFrom)(x?.in||y,0);return z.setFullYear(R,0,C),z.setHours(0,0,0,0),(0,u.startOfWeek)(z,x)}return YP}var K4;function mO(){if(K4)return HP;K4=1,HP.getWeek=p;var e=Vi(),r=kf(),a=pO(),u=Sr();function p(y,x){const i=(0,u.toDate)(y,x?.in),C=+(0,r.startOfWeek)(i,x)-+(0,a.startOfWeekYear)(i,x);return Math.round(C/e.millisecondsInWeek)+1}return HP}var XP={},Q4;function tv(){if(Q4)return XP;Q4=1,XP.addLeadingZeros=e;function e(r,a){const u=r<0?"-":"",p=Math.abs(r).toString().padStart(a,"0");return u+p}return XP}var s1={},J4;function c9(){if(J4)return s1;J4=1,s1.lightFormatters=void 0;var e=tv();return s1.lightFormatters={y(r,a){const u=r.getFullYear(),p=u>0?u:1-u;return(0,e.addLeadingZeros)(a==="yy"?p%100:p,a.length)},M(r,a){const u=r.getMonth();return a==="M"?String(u+1):(0,e.addLeadingZeros)(u+1,2)},d(r,a){return(0,e.addLeadingZeros)(r.getDate(),a.length)},a(r,a){const u=r.getHours()/12>=1?"pm":"am";switch(a){case"a":case"aa":return u.toUpperCase();case"aaa":return u;case"aaaaa":return u[0];case"aaaa":default:return u==="am"?"a.m.":"p.m."}},h(r,a){return(0,e.addLeadingZeros)(r.getHours()%12||12,a.length)},H(r,a){return(0,e.addLeadingZeros)(r.getHours(),a.length)},m(r,a){return(0,e.addLeadingZeros)(r.getMinutes(),a.length)},s(r,a){return(0,e.addLeadingZeros)(r.getSeconds(),a.length)},S(r,a){const u=a.length,p=r.getMilliseconds(),y=Math.trunc(p*Math.pow(10,u-3));return(0,e.addLeadingZeros)(y,a.length)}},s1}var eN;function x0e(){if(eN)return o1;eN=1,o1.formatters=void 0;var e=l9(),r=fO(),a=x_(),u=mO(),p=ES(),y=tv(),x=c9();const i={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};o1.formatters={G:function(F,V,G){const H=F.getFullYear()>0?1:0;switch(V){case"G":case"GG":case"GGG":return G.era(H,{width:"abbreviated"});case"GGGGG":return G.era(H,{width:"narrow"});case"GGGG":default:return G.era(H,{width:"wide"})}},y:function(F,V,G){if(V==="yo"){const H=F.getFullYear(),Z=H>0?H:1-H;return G.ordinalNumber(Z,{unit:"year"})}return x.lightFormatters.y(F,V)},Y:function(F,V,G,H){const Z=(0,p.getWeekYear)(F,H),J=Z>0?Z:1-Z;if(V==="YY"){const se=J%100;return(0,y.addLeadingZeros)(se,2)}return V==="Yo"?G.ordinalNumber(J,{unit:"year"}):(0,y.addLeadingZeros)(J,V.length)},R:function(F,V){const G=(0,a.getISOWeekYear)(F);return(0,y.addLeadingZeros)(G,V.length)},u:function(F,V){const G=F.getFullYear();return(0,y.addLeadingZeros)(G,V.length)},Q:function(F,V,G){const H=Math.ceil((F.getMonth()+1)/3);switch(V){case"Q":return String(H);case"QQ":return(0,y.addLeadingZeros)(H,2);case"Qo":return G.ordinalNumber(H,{unit:"quarter"});case"QQQ":return G.quarter(H,{width:"abbreviated",context:"formatting"});case"QQQQQ":return G.quarter(H,{width:"narrow",context:"formatting"});case"QQQQ":default:return G.quarter(H,{width:"wide",context:"formatting"})}},q:function(F,V,G){const H=Math.ceil((F.getMonth()+1)/3);switch(V){case"q":return String(H);case"qq":return(0,y.addLeadingZeros)(H,2);case"qo":return G.ordinalNumber(H,{unit:"quarter"});case"qqq":return G.quarter(H,{width:"abbreviated",context:"standalone"});case"qqqqq":return G.quarter(H,{width:"narrow",context:"standalone"});case"qqqq":default:return G.quarter(H,{width:"wide",context:"standalone"})}},M:function(F,V,G){const H=F.getMonth();switch(V){case"M":case"MM":return x.lightFormatters.M(F,V);case"Mo":return G.ordinalNumber(H+1,{unit:"month"});case"MMM":return G.month(H,{width:"abbreviated",context:"formatting"});case"MMMMM":return G.month(H,{width:"narrow",context:"formatting"});case"MMMM":default:return G.month(H,{width:"wide",context:"formatting"})}},L:function(F,V,G){const H=F.getMonth();switch(V){case"L":return String(H+1);case"LL":return(0,y.addLeadingZeros)(H+1,2);case"Lo":return G.ordinalNumber(H+1,{unit:"month"});case"LLL":return G.month(H,{width:"abbreviated",context:"standalone"});case"LLLLL":return G.month(H,{width:"narrow",context:"standalone"});case"LLLL":default:return G.month(H,{width:"wide",context:"standalone"})}},w:function(F,V,G,H){const Z=(0,u.getWeek)(F,H);return V==="wo"?G.ordinalNumber(Z,{unit:"week"}):(0,y.addLeadingZeros)(Z,V.length)},I:function(F,V,G){const H=(0,r.getISOWeek)(F);return V==="Io"?G.ordinalNumber(H,{unit:"week"}):(0,y.addLeadingZeros)(H,V.length)},d:function(F,V,G){return V==="do"?G.ordinalNumber(F.getDate(),{unit:"date"}):x.lightFormatters.d(F,V)},D:function(F,V,G){const H=(0,e.getDayOfYear)(F);return V==="Do"?G.ordinalNumber(H,{unit:"dayOfYear"}):(0,y.addLeadingZeros)(H,V.length)},E:function(F,V,G){const H=F.getDay();switch(V){case"E":case"EE":case"EEE":return G.day(H,{width:"abbreviated",context:"formatting"});case"EEEEE":return G.day(H,{width:"narrow",context:"formatting"});case"EEEEEE":return G.day(H,{width:"short",context:"formatting"});case"EEEE":default:return G.day(H,{width:"wide",context:"formatting"})}},e:function(F,V,G,H){const Z=F.getDay(),J=(Z-H.weekStartsOn+8)%7||7;switch(V){case"e":return String(J);case"ee":return(0,y.addLeadingZeros)(J,2);case"eo":return G.ordinalNumber(J,{unit:"day"});case"eee":return G.day(Z,{width:"abbreviated",context:"formatting"});case"eeeee":return G.day(Z,{width:"narrow",context:"formatting"});case"eeeeee":return G.day(Z,{width:"short",context:"formatting"});case"eeee":default:return G.day(Z,{width:"wide",context:"formatting"})}},c:function(F,V,G,H){const Z=F.getDay(),J=(Z-H.weekStartsOn+8)%7||7;switch(V){case"c":return String(J);case"cc":return(0,y.addLeadingZeros)(J,V.length);case"co":return G.ordinalNumber(J,{unit:"day"});case"ccc":return G.day(Z,{width:"abbreviated",context:"standalone"});case"ccccc":return G.day(Z,{width:"narrow",context:"standalone"});case"cccccc":return G.day(Z,{width:"short",context:"standalone"});case"cccc":default:return G.day(Z,{width:"wide",context:"standalone"})}},i:function(F,V,G){const H=F.getDay(),Z=H===0?7:H;switch(V){case"i":return String(Z);case"ii":return(0,y.addLeadingZeros)(Z,V.length);case"io":return G.ordinalNumber(Z,{unit:"day"});case"iii":return G.day(H,{width:"abbreviated",context:"formatting"});case"iiiii":return G.day(H,{width:"narrow",context:"formatting"});case"iiiiii":return G.day(H,{width:"short",context:"formatting"});case"iiii":default:return G.day(H,{width:"wide",context:"formatting"})}},a:function(F,V,G){const Z=F.getHours()/12>=1?"pm":"am";switch(V){case"a":case"aa":return G.dayPeriod(Z,{width:"abbreviated",context:"formatting"});case"aaa":return G.dayPeriod(Z,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return G.dayPeriod(Z,{width:"narrow",context:"formatting"});case"aaaa":default:return G.dayPeriod(Z,{width:"wide",context:"formatting"})}},b:function(F,V,G){const H=F.getHours();let Z;switch(H===12?Z=i.noon:H===0?Z=i.midnight:Z=H/12>=1?"pm":"am",V){case"b":case"bb":return G.dayPeriod(Z,{width:"abbreviated",context:"formatting"});case"bbb":return G.dayPeriod(Z,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return G.dayPeriod(Z,{width:"narrow",context:"formatting"});case"bbbb":default:return G.dayPeriod(Z,{width:"wide",context:"formatting"})}},B:function(F,V,G){const H=F.getHours();let Z;switch(H>=17?Z=i.evening:H>=12?Z=i.afternoon:H>=4?Z=i.morning:Z=i.night,V){case"B":case"BB":case"BBB":return G.dayPeriod(Z,{width:"abbreviated",context:"formatting"});case"BBBBB":return G.dayPeriod(Z,{width:"narrow",context:"formatting"});case"BBBB":default:return G.dayPeriod(Z,{width:"wide",context:"formatting"})}},h:function(F,V,G){if(V==="ho"){let H=F.getHours()%12;return H===0&&(H=12),G.ordinalNumber(H,{unit:"hour"})}return x.lightFormatters.h(F,V)},H:function(F,V,G){return V==="Ho"?G.ordinalNumber(F.getHours(),{unit:"hour"}):x.lightFormatters.H(F,V)},K:function(F,V,G){const H=F.getHours()%12;return V==="Ko"?G.ordinalNumber(H,{unit:"hour"}):(0,y.addLeadingZeros)(H,V.length)},k:function(F,V,G){let H=F.getHours();return H===0&&(H=24),V==="ko"?G.ordinalNumber(H,{unit:"hour"}):(0,y.addLeadingZeros)(H,V.length)},m:function(F,V,G){return V==="mo"?G.ordinalNumber(F.getMinutes(),{unit:"minute"}):x.lightFormatters.m(F,V)},s:function(F,V,G){return V==="so"?G.ordinalNumber(F.getSeconds(),{unit:"second"}):x.lightFormatters.s(F,V)},S:function(F,V){return x.lightFormatters.S(F,V)},X:function(F,V,G){const H=F.getTimezoneOffset();if(H===0)return"Z";switch(V){case"X":return R(H);case"XXXX":case"XX":return z(H);case"XXXXX":case"XXX":default:return z(H,":")}},x:function(F,V,G){const H=F.getTimezoneOffset();switch(V){case"x":return R(H);case"xxxx":case"xx":return z(H);case"xxxxx":case"xxx":default:return z(H,":")}},O:function(F,V,G){const H=F.getTimezoneOffset();switch(V){case"O":case"OO":case"OOO":return"GMT"+C(H,":");case"OOOO":default:return"GMT"+z(H,":")}},z:function(F,V,G){const H=F.getTimezoneOffset();switch(V){case"z":case"zz":case"zzz":return"GMT"+C(H,":");case"zzzz":default:return"GMT"+z(H,":")}},t:function(F,V,G){const H=Math.trunc(+F/1e3);return(0,y.addLeadingZeros)(H,V.length)},T:function(F,V,G){return(0,y.addLeadingZeros)(+F,V.length)}};function C(F,V=""){const G=F>0?"-":"+",H=Math.abs(F),Z=Math.trunc(H/60),J=H%60;return J===0?G+String(Z):G+String(Z)+V+(0,y.addLeadingZeros)(J,2)}function R(F,V){return F%60===0?(F>0?"-":"+")+(0,y.addLeadingZeros)(Math.abs(F)/60,2):z(F,V)}function z(F,V=""){const G=F>0?"-":"+",H=Math.abs(F),Z=(0,y.addLeadingZeros)(Math.trunc(H/60),2),J=(0,y.addLeadingZeros)(H%60,2);return G+Z+V+J}return o1}var a1={},tN;function u9(){if(tN)return a1;tN=1,a1.longFormatters=void 0;const e=(u,p)=>{switch(u){case"P":return p.date({width:"short"});case"PP":return p.date({width:"medium"});case"PPP":return p.date({width:"long"});case"PPPP":default:return p.date({width:"full"})}},r=(u,p)=>{switch(u){case"p":return p.time({width:"short"});case"pp":return p.time({width:"medium"});case"ppp":return p.time({width:"long"});case"pppp":default:return p.time({width:"full"})}},a=(u,p)=>{const y=u.match(/(P+)(p+)?/)||[],x=y[1],i=y[2];if(!i)return e(u,p);let C;switch(x){case"P":C=p.dateTime({width:"short"});break;case"PP":C=p.dateTime({width:"medium"});break;case"PPP":C=p.dateTime({width:"long"});break;case"PPPP":default:C=p.dateTime({width:"full"});break}return C.replace("{{date}}",e(x,p)).replace("{{time}}",r(i,p))};return a1.longFormatters={p:r,P:a},a1}var o0={},rN;function d9(){if(rN)return o0;rN=1,o0.isProtectedDayOfYearToken=u,o0.isProtectedWeekYearToken=p,o0.warnOrThrowProtectedError=y;const e=/^D+$/,r=/^Y+$/,a=["D","DD","YY","YYYY"];function u(i){return e.test(i)}function p(i){return r.test(i)}function y(i,C,R){const z=x(i,C,R);if(console.warn(z),a.includes(i))throw new RangeError(z)}function x(i,C,R){const z=i[0]==="Y"?"years":"days of the month";return`Use \`${i.toLowerCase()}\` instead of \`${i}\` (in \`${C}\`) for formatting ${z} to the input \`${R}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}return o0}var nN;function h9(){return nN||(nN=1,(function(e){e.format=e.formatDate=G,Object.defineProperty(e,"formatters",{enumerable:!0,get:function(){return u.formatters}}),Object.defineProperty(e,"longFormatters",{enumerable:!0,get:function(){return p.longFormatters}});var r=ev(),a=eu(),u=x0e(),p=u9(),y=d9(),x=Xm(),i=Sr();const C=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,R=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,z=/^'([^]*?)'?$/,F=/''/g,V=/[a-zA-Z]/;function G(Z,J,se){const pe=(0,a.getDefaultOptions)(),ve=se?.locale??pe.locale??r.defaultLocale,Ne=se?.firstWeekContainsDate??se?.locale?.options?.firstWeekContainsDate??pe.firstWeekContainsDate??pe.locale?.options?.firstWeekContainsDate??1,_e=se?.weekStartsOn??se?.locale?.options?.weekStartsOn??pe.weekStartsOn??pe.locale?.options?.weekStartsOn??0,Re=(0,i.toDate)(Z,se?.in);if(!(0,x.isValid)(Re))throw new RangeError("Invalid time value");let ke=J.match(R).map(et=>{const ht=et[0];if(ht==="p"||ht==="P"){const Xt=p.longFormatters[ht];return Xt(et,ve.formatLong)}return et}).join("").match(C).map(et=>{if(et==="''")return{isToken:!1,value:"'"};const ht=et[0];if(ht==="'")return{isToken:!1,value:H(et)};if(u.formatters[ht])return{isToken:!0,value:et};if(ht.match(V))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ht+"`");return{isToken:!1,value:et}});ve.localize.preprocessor&&(ke=ve.localize.preprocessor(Re,ke));const ze={firstWeekContainsDate:Ne,weekStartsOn:_e,locale:ve};return ke.map(et=>{if(!et.isToken)return et.value;const ht=et.value;(!se?.useAdditionalWeekYearTokens&&(0,y.isProtectedWeekYearToken)(ht)||!se?.useAdditionalDayOfYearTokens&&(0,y.isProtectedDayOfYearToken)(ht))&&(0,y.warnOrThrowProtectedError)(ht,J,String(Z));const Xt=u.formatters[ht[0]];return Xt(Re,ht,ve.localize,ze)}).join("")}function H(Z){const J=Z.match(z);return J?J[1].replace(F,"'"):Z}})(jP)),jP}var KP={},iN;function f9(){if(iN)return KP;iN=1,KP.formatDistance=C;var e=ev(),r=eu(),a=Ym(),u=Xo(),p=Jy(),y=Vi(),x=wS(),i=SS();function C(R,z,F){const V=(0,r.getDefaultOptions)(),G=F?.locale??V.locale??e.defaultLocale,H=2520,Z=(0,p.compareAsc)(R,z);if(isNaN(Z))throw new RangeError("Invalid time value");const J=Object.assign({},F,{addSuffix:F?.addSuffix,comparison:Z}),[se,pe]=(0,u.normalizeDates)(F?.in,...Z>0?[z,R]:[R,z]),ve=(0,i.differenceInSeconds)(pe,se),Ne=((0,a.getTimezoneOffsetInMilliseconds)(pe)-(0,a.getTimezoneOffsetInMilliseconds)(se))/1e3,_e=Math.round((ve-Ne)/60);let Re;if(_e<2)return F?.includeSeconds?ve<5?G.formatDistance("lessThanXSeconds",5,J):ve<10?G.formatDistance("lessThanXSeconds",10,J):ve<20?G.formatDistance("lessThanXSeconds",20,J):ve<40?G.formatDistance("halfAMinute",0,J):ve<60?G.formatDistance("lessThanXMinutes",1,J):G.formatDistance("xMinutes",1,J):_e===0?G.formatDistance("lessThanXMinutes",1,J):G.formatDistance("xMinutes",_e,J);if(_e<45)return G.formatDistance("xMinutes",_e,J);if(_e<90)return G.formatDistance("aboutXHours",1,J);if(_e<y.minutesInDay){const ke=Math.round(_e/60);return G.formatDistance("aboutXHours",ke,J)}else{if(_e<H)return G.formatDistance("xDays",1,J);if(_e<y.minutesInMonth){const ke=Math.round(_e/y.minutesInDay);return G.formatDistance("xDays",ke,J)}else if(_e<y.minutesInMonth*2)return Re=Math.round(_e/y.minutesInMonth),G.formatDistance("aboutXMonths",Re,J)}if(Re=(0,x.differenceInMonths)(pe,se),Re<12){const ke=Math.round(_e/y.minutesInMonth);return G.formatDistance("xMonths",ke,J)}else{const ke=Re%12,ze=Math.trunc(Re/12);return ke<3?G.formatDistance("aboutXYears",ze,J):ke<9?G.formatDistance("overXYears",ze,J):G.formatDistance("almostXYears",ze+1,J)}}return KP}var QP={},oN;function p9(){if(oN)return QP;oN=1,QP.formatDistanceStrict=i;var e=ev(),r=eu(),a=Km(),u=Ym(),p=Xo(),y=Jy(),x=Vi();function i(C,R,z){const F=(0,r.getDefaultOptions)(),V=z?.locale??F.locale??e.defaultLocale,G=(0,y.compareAsc)(C,R);if(isNaN(G))throw new RangeError("Invalid time value");const H=Object.assign({},z,{addSuffix:z?.addSuffix,comparison:G}),[Z,J]=(0,p.normalizeDates)(z?.in,...G>0?[R,C]:[C,R]),se=(0,a.getRoundingMethod)(z?.roundingMethod??"round"),pe=J.getTime()-Z.getTime(),ve=pe/x.millisecondsInMinute,Ne=(0,u.getTimezoneOffsetInMilliseconds)(J)-(0,u.getTimezoneOffsetInMilliseconds)(Z),_e=(pe-Ne)/x.millisecondsInMinute,Re=z?.unit;let ke;if(Re?ke=Re:ve<1?ke="second":ve<60?ke="minute":ve<x.minutesInDay?ke="hour":_e<x.minutesInMonth?ke="day":_e<x.minutesInYear?ke="month":ke="year",ke==="second"){const ze=se(pe/1e3);return V.formatDistance("xSeconds",ze,H)}else if(ke==="minute"){const ze=se(ve);return V.formatDistance("xMinutes",ze,H)}else if(ke==="hour"){const ze=se(ve/60);return V.formatDistance("xHours",ze,H)}else if(ke==="day"){const ze=se(_e/x.minutesInDay);return V.formatDistance("xDays",ze,H)}else if(ke==="month"){const ze=se(_e/x.minutesInMonth);return ze===12&&Re!=="month"?V.formatDistance("xYears",1,H):V.formatDistance("xMonths",ze,H)}else{const ze=se(_e/x.minutesInYear);return V.formatDistance("xYears",ze,H)}}return QP}var JP={},sN;function b0e(){if(sN)return JP;sN=1,JP.formatDistanceToNow=a;var e=Ml(),r=f9();function a(u,p){return(0,r.formatDistance)(u,(0,e.constructNow)(u),p)}return JP}var eI={},aN;function w0e(){if(aN)return eI;aN=1,eI.formatDistanceToNowStrict=a;var e=Ml(),r=p9();function a(u,p){return(0,r.formatDistanceStrict)(u,(0,e.constructNow)(u),p)}return eI}var tI={},lN;function S0e(){if(lN)return tI;lN=1,tI.formatDuration=u;var e=ev(),r=eu();const a=["years","months","weeks","days","hours","minutes","seconds"];function u(p,y){const x=(0,r.getDefaultOptions)(),i=y?.locale??x.locale??e.defaultLocale,C=y?.format??a,R=y?.zero??!1,z=y?.delimiter??" ";return i.formatDistance?C.reduce((V,G)=>{const H=`x${G.replace(/(^.)/,J=>J.toUpperCase())}`,Z=p[G];return Z!==void 0&&(R||p[G])?V.concat(i.formatDistance(H,Z)):V},[]).join(z):""}return tI}var rI={},cN;function T0e(){if(cN)return rI;cN=1,rI.formatISO=a;var e=tv(),r=Sr();function a(u,p){const y=(0,r.toDate)(u,p?.in);if(isNaN(+y))throw new RangeError("Invalid time value");const x=p?.format??"extended",i=p?.representation??"complete";let C="",R="";const z=x==="extended"?"-":"",F=x==="extended"?":":"";if(i!=="time"){const V=(0,e.addLeadingZeros)(y.getDate(),2),G=(0,e.addLeadingZeros)(y.getMonth()+1,2);C=`${(0,e.addLeadingZeros)(y.getFullYear(),4)}${z}${G}${z}${V}`}if(i!=="date"){const V=y.getTimezoneOffset();if(V!==0){const pe=Math.abs(V),ve=(0,e.addLeadingZeros)(Math.trunc(pe/60),2),Ne=(0,e.addLeadingZeros)(pe%60,2);R=`${V<0?"+":"-"}${ve}:${Ne}`}else R="Z";const G=(0,e.addLeadingZeros)(y.getHours(),2),H=(0,e.addLeadingZeros)(y.getMinutes(),2),Z=(0,e.addLeadingZeros)(y.getSeconds(),2),J=C===""?"":"T",se=[G,H,Z].join(F);C=`${C}${J}${se}${R}`}return C}return rI}var nI={},uN;function E0e(){if(uN)return nI;uN=1,nI.formatISO9075=u;var e=tv(),r=Xm(),a=Sr();function u(p,y){const x=(0,a.toDate)(p,y?.in);if(!(0,r.isValid)(x))throw new RangeError("Invalid time value");const i=y?.format??"extended",C=y?.representation??"complete";let R="";const z=i==="extended"?"-":"",F=i==="extended"?":":"";if(C!=="time"){const V=(0,e.addLeadingZeros)(x.getDate(),2),G=(0,e.addLeadingZeros)(x.getMonth()+1,2);R=`${(0,e.addLeadingZeros)(x.getFullYear(),4)}${z}${G}${z}${V}`}if(C!=="date"){const V=(0,e.addLeadingZeros)(x.getHours(),2),G=(0,e.addLeadingZeros)(x.getMinutes(),2),H=(0,e.addLeadingZeros)(x.getSeconds(),2);R=`${R}${R===""?"":" "}${V}${F}${G}${F}${H}`}return R}return nI}var iI={},dN;function P0e(){if(dN)return iI;dN=1,iI.formatISODuration=e;function e(r){const{years:a=0,months:u=0,days:p=0,hours:y=0,minutes:x=0,seconds:i=0}=r;return`P${a}Y${u}M${p}DT${y}H${x}M${i}S`}return iI}var oI={},hN;function I0e(){if(hN)return oI;hN=1,oI.formatRFC3339=u;var e=tv(),r=Xm(),a=Sr();function u(p,y){const x=(0,a.toDate)(p,y?.in);if(!(0,r.isValid)(x))throw new RangeError("Invalid time value");const i=y?.fractionDigits??0,C=(0,e.addLeadingZeros)(x.getDate(),2),R=(0,e.addLeadingZeros)(x.getMonth()+1,2),z=x.getFullYear(),F=(0,e.addLeadingZeros)(x.getHours(),2),V=(0,e.addLeadingZeros)(x.getMinutes(),2),G=(0,e.addLeadingZeros)(x.getSeconds(),2);let H="";if(i>0){const se=x.getMilliseconds(),pe=Math.trunc(se*Math.pow(10,i-3));H="."+(0,e.addLeadingZeros)(pe,i)}let Z="";const J=x.getTimezoneOffset();if(J!==0){const se=Math.abs(J),pe=(0,e.addLeadingZeros)(Math.trunc(se/60),2),ve=(0,e.addLeadingZeros)(se%60,2);Z=`${J<0?"+":"-"}${pe}:${ve}`}else Z="Z";return`${z}-${R}-${C}T${F}:${V}:${G}${H}${Z}`}return oI}var sI={},fN;function M0e(){if(fN)return sI;fN=1,sI.formatRFC7231=y;var e=tv(),r=Xm(),a=Sr();const u=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function y(x){const i=(0,a.toDate)(x);if(!(0,r.isValid)(i))throw new RangeError("Invalid time value");const C=u[i.getUTCDay()],R=(0,e.addLeadingZeros)(i.getUTCDate(),2),z=p[i.getUTCMonth()],F=i.getUTCFullYear(),V=(0,e.addLeadingZeros)(i.getUTCHours(),2),G=(0,e.addLeadingZeros)(i.getUTCMinutes(),2),H=(0,e.addLeadingZeros)(i.getUTCSeconds(),2);return`${C}, ${R} ${z} ${F} ${V}:${G}:${H} GMT`}return sI}var aI={},pN;function C0e(){if(pN)return aI;pN=1,aI.formatRelative=y;var e=ev(),r=eu(),a=Xo(),u=Zm(),p=h9();function y(x,i,C){const[R,z]=(0,a.normalizeDates)(C?.in,x,i),F=(0,r.getDefaultOptions)(),V=C?.locale??F.locale??e.defaultLocale,G=C?.weekStartsOn??C?.locale?.options?.weekStartsOn??F.weekStartsOn??F.locale?.options?.weekStartsOn??0,H=(0,u.differenceInCalendarDays)(R,z);if(isNaN(H))throw new RangeError("Invalid time value");let Z;H<-6?Z="other":H<-1?Z="lastWeek":H<0?Z="yesterday":H<1?Z="today":H<2?Z="tomorrow":H<7?Z="nextWeek":Z="other";const J=V.formatRelative(Z,R,z,{locale:V,weekStartsOn:G});return(0,p.format)(R,J,{locale:V,weekStartsOn:G})}return aI}var lI={},mN;function A0e(){if(mN)return lI;mN=1,lI.fromUnixTime=r;var e=Sr();function r(a,u){return(0,e.toDate)(a*1e3,u?.in)}return lI}var cI={},gN;function m9(){if(gN)return cI;gN=1,cI.getDate=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDate()}return cI}var uI={},_N;function PS(){if(_N)return uI;_N=1,uI.getDay=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDay()}return uI}var dI={},yN;function g9(){if(yN)return dI;yN=1,dI.getDaysInMonth=a;var e=Nn(),r=Sr();function a(u,p){const y=(0,r.toDate)(u,p?.in),x=y.getFullYear(),i=y.getMonth(),C=(0,e.constructFrom)(y,0);return C.setFullYear(x,i+1,0),C.setHours(0,0,0,0),C.getDate()}return dI}var hI={},fI={},vN;function _9(){if(vN)return fI;vN=1,fI.isLeapYear=r;var e=Sr();function r(a,u){const y=(0,e.toDate)(a,u?.in).getFullYear();return y%400===0||y%4===0&&y%100!==0}return fI}var xN;function D0e(){if(xN)return hI;xN=1,hI.getDaysInYear=a;var e=_9(),r=Sr();function a(u,p){const y=(0,r.toDate)(u,p?.in);return Number.isNaN(+y)?NaN:(0,e.isLeapYear)(y)?366:365}return hI}var pI={},bN;function R0e(){if(bN)return pI;bN=1,pI.getDecade=r;var e=Sr();function r(a,u){const y=(0,e.toDate)(a,u?.in).getFullYear();return Math.floor(y/10)*10}return pI}var mI={},wN;function y9(){if(wN)return mI;wN=1,mI.getDefaultOptions=r;var e=eu();function r(){return Object.assign({},(0,e.getDefaultOptions)())}return mI}var gI={},SN;function O0e(){if(SN)return gI;SN=1,gI.getHours=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getHours()}return gI}var _I={},TN;function v9(){if(TN)return _I;TN=1,_I.getISODay=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in).getDay();return p===0?7:p}return _I}var yI={},EN;function L0e(){if(EN)return yI;EN=1,yI.getISOWeeksInYear=u;var e=bS(),r=Vi(),a=Ox();function u(p,y){const x=(0,a.startOfISOWeekYear)(p,y),C=+(0,a.startOfISOWeekYear)((0,e.addWeeks)(x,60))-+x;return Math.round(C/r.millisecondsInWeek)}return yI}var vI={},PN;function z0e(){if(PN)return vI;PN=1,vI.getMilliseconds=r;var e=Sr();function r(a){return(0,e.toDate)(a).getMilliseconds()}return vI}var xI={},IN;function F0e(){if(IN)return xI;IN=1,xI.getMinutes=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getMinutes()}return xI}var bI={},MN;function k0e(){if(MN)return bI;MN=1,bI.getMonth=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getMonth()}return bI}var wI={},CN;function B0e(){if(CN)return wI;CN=1,wI.getOverlappingDaysInIntervals=u;var e=Ym(),r=Vi(),a=Sr();function u(p,y){const[x,i]=[+(0,a.toDate)(p.start),+(0,a.toDate)(p.end)].sort((Z,J)=>Z-J),[C,R]=[+(0,a.toDate)(y.start),+(0,a.toDate)(y.end)].sort((Z,J)=>Z-J);if(!(x<R&&C<i))return 0;const F=C<x?x:C,V=F-(0,e.getTimezoneOffsetInMilliseconds)(F),G=R>i?i:R,H=G-(0,e.getTimezoneOffsetInMilliseconds)(G);return Math.ceil((H-V)/r.millisecondsInDay)}return wI}var SI={},AN;function j0e(){if(AN)return SI;AN=1,SI.getSeconds=r;var e=Sr();function r(a){return(0,e.toDate)(a).getSeconds()}return SI}var TI={},DN;function N0e(){if(DN)return TI;DN=1,TI.getTime=r;var e=Sr();function r(a){return+(0,e.toDate)(a)}return TI}var EI={},RN;function V0e(){if(RN)return EI;RN=1,EI.getUnixTime=r;var e=Sr();function r(a){return Math.trunc(+(0,e.toDate)(a)/1e3)}return EI}var PI={},ON;function U0e(){if(ON)return PI;ON=1,PI.getWeekOfMonth=y;var e=eu(),r=m9(),a=PS(),u=TS(),p=Sr();function y(x,i){const C=(0,e.getDefaultOptions)(),R=i?.weekStartsOn??i?.locale?.options?.weekStartsOn??C.weekStartsOn??C.locale?.options?.weekStartsOn??0,z=(0,r.getDate)((0,p.toDate)(x,i?.in));if(isNaN(z))return NaN;const F=(0,a.getDay)((0,u.startOfMonth)(x,i));let V=R-F;V<=0&&(V+=7);const G=z-V;return Math.ceil(G/7)+1}return PI}var II={},MI={},LN;function x9(){if(LN)return MI;LN=1,MI.lastDayOfMonth=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getMonth();return p.setFullYear(p.getFullYear(),y+1,0),p.setHours(0,0,0,0),(0,e.toDate)(p,u?.in)}return MI}var zN;function $0e(){if(zN)return II;zN=1,II.getWeeksInMonth=p;var e=rO(),r=x9(),a=TS(),u=Sr();function p(y,x){const i=(0,u.toDate)(y,x?.in);return(0,e.differenceInCalendarWeeks)((0,r.lastDayOfMonth)(i,x),(0,a.startOfMonth)(i,x),x)+1}return II}var CI={},FN;function W0e(){if(FN)return CI;FN=1,CI.getYear=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getFullYear()}return CI}var AI={},kN;function q0e(){if(kN)return AI;kN=1,AI.hoursToMilliseconds=r;var e=Vi();function r(a){return Math.trunc(a*e.millisecondsInHour)}return AI}var DI={},BN;function G0e(){if(BN)return DI;BN=1,DI.hoursToMinutes=r;var e=Vi();function r(a){return Math.trunc(a*e.minutesInHour)}return DI}var RI={},jN;function H0e(){if(jN)return RI;jN=1,RI.hoursToSeconds=r;var e=Vi();function r(a){return Math.trunc(a*e.secondsInHour)}return RI}var OI={},NN;function Y0e(){if(NN)return OI;NN=1,OI.interval=r;var e=Xo();function r(a,u,p){const[y,x]=(0,e.normalizeDates)(p?.in,a,u);if(isNaN(+y))throw new TypeError("Start date is invalid");if(isNaN(+x))throw new TypeError("End date is invalid");if(p?.assertPositive&&+y>+x)throw new TypeError("End date must be after start date");return{start:y,end:x}}return OI}var LI={},VN;function Z0e(){if(VN)return LI;VN=1,LI.intervalToDuration=C;var e=Up(),r=jH(),a=iO(),u=oO(),p=aO(),y=wS(),x=SS(),i=n9();function C(R,z){const{start:F,end:V}=(0,e.normalizeInterval)(z?.in,R),G={},H=(0,i.differenceInYears)(V,F);H&&(G.years=H);const Z=(0,r.add)(F,{years:G.years}),J=(0,y.differenceInMonths)(V,Z);J&&(G.months=J);const se=(0,r.add)(Z,{months:G.months}),pe=(0,a.differenceInDays)(V,se);pe&&(G.days=pe);const ve=(0,r.add)(se,{days:G.days}),Ne=(0,u.differenceInHours)(V,ve);Ne&&(G.hours=Ne);const _e=(0,r.add)(ve,{hours:G.hours}),Re=(0,p.differenceInMinutes)(V,_e);Re&&(G.minutes=Re);const ke=(0,r.add)(_e,{minutes:G.minutes}),ze=(0,x.differenceInSeconds)(V,ke);return ze&&(G.seconds=ze),G}return LI}var zI={},UN;function X0e(){if(UN)return zI;UN=1,zI.intlFormat=r;var e=Sr();function r(u,p,y){let x;return a(p)?x=p:y=p,new Intl.DateTimeFormat(y?.locale,x).format((0,e.toDate)(u))}function a(u){return u!==void 0&&!("locale"in u)}return zI}var FI={},$N;function K0e(){if($N)return FI;$N=1,FI.intlFormatDistance=z;var e=Xo(),r=Vi(),a=Zm(),u=tO(),p=e9(),y=rO(),x=nO(),i=oO(),C=aO(),R=SS();function z(F,V,G){let H=0,Z;const[J,se]=(0,e.normalizeDates)(G?.in,F,V);if(G?.unit)Z=G?.unit,Z==="second"?H=(0,R.differenceInSeconds)(J,se):Z==="minute"?H=(0,C.differenceInMinutes)(J,se):Z==="hour"?H=(0,i.differenceInHours)(J,se):Z==="day"?H=(0,a.differenceInCalendarDays)(J,se):Z==="week"?H=(0,y.differenceInCalendarWeeks)(J,se):Z==="month"?H=(0,u.differenceInCalendarMonths)(J,se):Z==="quarter"?H=(0,p.differenceInCalendarQuarters)(J,se):Z==="year"&&(H=(0,x.differenceInCalendarYears)(J,se));else{const ve=(0,R.differenceInSeconds)(J,se);Math.abs(ve)<r.secondsInMinute?(H=(0,R.differenceInSeconds)(J,se),Z="second"):Math.abs(ve)<r.secondsInHour?(H=(0,C.differenceInMinutes)(J,se),Z="minute"):Math.abs(ve)<r.secondsInDay&&Math.abs((0,a.differenceInCalendarDays)(J,se))<1?(H=(0,i.differenceInHours)(J,se),Z="hour"):Math.abs(ve)<r.secondsInWeek&&(H=(0,a.differenceInCalendarDays)(J,se))&&Math.abs(H)<7?Z="day":Math.abs(ve)<r.secondsInMonth?(H=(0,y.differenceInCalendarWeeks)(J,se),Z="week"):Math.abs(ve)<r.secondsInQuarter?(H=(0,u.differenceInCalendarMonths)(J,se),Z="month"):Math.abs(ve)<r.secondsInYear&&(0,p.differenceInCalendarQuarters)(J,se)<4?(H=(0,p.differenceInCalendarQuarters)(J,se),Z="quarter"):(H=(0,x.differenceInCalendarYears)(J,se),Z="year")}return new Intl.RelativeTimeFormat(G?.locale,{numeric:"auto",...G}).format(H,Z)}return FI}var kI={},WN;function Q0e(){if(WN)return kI;WN=1,kI.isAfter=r;var e=Sr();function r(a,u){return+(0,e.toDate)(a)>+(0,e.toDate)(u)}return kI}var BI={},qN;function J0e(){if(qN)return BI;qN=1,BI.isBefore=r;var e=Sr();function r(a,u){return+(0,e.toDate)(a)<+(0,e.toDate)(u)}return BI}var jI={},GN;function exe(){if(GN)return jI;GN=1,jI.isEqual=r;var e=Sr();function r(a,u){return+(0,e.toDate)(a)==+(0,e.toDate)(u)}return jI}var NI={},HN;function txe(){if(HN)return NI;HN=1,NI.isExists=e;function e(r,a,u){const p=new Date(r,a,u);return p.getFullYear()===r&&p.getMonth()===a&&p.getDate()===u}return NI}var VI={},YN;function rxe(){if(YN)return VI;YN=1,VI.isFirstDayOfMonth=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDate()===1}return VI}var UI={},ZN;function nxe(){if(ZN)return UI;ZN=1,UI.isFriday=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDay()===5}return UI}var $I={},XN;function ixe(){if(XN)return $I;XN=1,$I.isFuture=r;var e=Sr();function r(a){return+(0,e.toDate)(a)>Date.now()}return $I}var WI={},qI={},Dm={},GI={},KN;function b9(){if(KN)return GI;KN=1,GI.transpose=r;var e=Nn();function r(u,p){const y=a(p)?new p(0):(0,e.constructFrom)(p,0);return y.setFullYear(u.getFullYear(),u.getMonth(),u.getDate()),y.setHours(u.getHours(),u.getMinutes(),u.getSeconds(),u.getMilliseconds()),y}function a(u){return typeof u=="function"&&u.prototype?.constructor===u}return GI}var QN;function w9(){if(QN)return Dm;QN=1,Dm.ValueSetter=Dm.Setter=Dm.DateTimezoneSetter=void 0;var e=Nn(),r=b9();const a=10;let u=class{subPriority=0;validate(i,C){return!0}};Dm.Setter=u;class p extends u{constructor(i,C,R,z,F){super(),this.value=i,this.validateValue=C,this.setValue=R,this.priority=z,F&&(this.subPriority=F)}validate(i,C){return this.validateValue(i,this.value,C)}set(i,C,R){return this.setValue(i,C,this.value,R)}}Dm.ValueSetter=p;class y extends u{priority=a;subPriority=-1;constructor(i,C){super(),this.context=i||(R=>(0,e.constructFrom)(C,R))}set(i,C){return C.timestampIsSet?i:(0,e.constructFrom)(i,(0,r.transpose)(i,this.context))}}return Dm.DateTimezoneSetter=y,Dm}var l1={},c1={},u1={},JN;function Oo(){if(JN)return u1;JN=1,u1.Parser=void 0;var e=w9();let r=class{run(u,p,y,x){const i=this.parse(u,p,y,x);return i?{setter:new e.ValueSetter(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(u,p,y){return!0}};return u1.Parser=r,u1}var eV;function oxe(){if(eV)return c1;eV=1,c1.EraParser=void 0;var e=Oo();let r=class extends e.Parser{priority=140;parse(u,p,y){switch(p){case"G":case"GG":case"GGG":return y.era(u,{width:"abbreviated"})||y.era(u,{width:"narrow"});case"GGGGG":return y.era(u,{width:"narrow"});case"GGGG":default:return y.era(u,{width:"wide"})||y.era(u,{width:"abbreviated"})||y.era(u,{width:"narrow"})}}set(u,p,y){return p.era=y,u.setFullYear(y,0,1),u.setHours(0,0,0,0),u}incompatibleTokens=["R","u","t","T"]};return c1.EraParser=r,c1}var d1={},bh={},iy={},tV;function tu(){return tV||(tV=1,iy.timezonePatterns=iy.numericPatterns=void 0,iy.numericPatterns={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},iy.timezonePatterns={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/}),iy}var rV;function qo(){if(rV)return bh;rV=1,bh.dayPeriodEnumToHours=C,bh.isLeapYearIndex=z,bh.mapValue=a,bh.normalizeTwoDigitYear=R,bh.parseAnyDigitsSigned=y,bh.parseNDigits=x,bh.parseNDigitsSigned=i,bh.parseNumericPattern=u,bh.parseTimezonePattern=p;var e=Vi(),r=tu();function a(F,V){return F&&{value:V(F.value),rest:F.rest}}function u(F,V){const G=V.match(F);return G?{value:parseInt(G[0],10),rest:V.slice(G[0].length)}:null}function p(F,V){const G=V.match(F);if(!G)return null;if(G[0]==="Z")return{value:0,rest:V.slice(1)};const H=G[1]==="+"?1:-1,Z=G[2]?parseInt(G[2],10):0,J=G[3]?parseInt(G[3],10):0,se=G[5]?parseInt(G[5],10):0;return{value:H*(Z*e.millisecondsInHour+J*e.millisecondsInMinute+se*e.millisecondsInSecond),rest:V.slice(G[0].length)}}function y(F){return u(r.numericPatterns.anyDigitsSigned,F)}function x(F,V){switch(F){case 1:return u(r.numericPatterns.singleDigit,V);case 2:return u(r.numericPatterns.twoDigits,V);case 3:return u(r.numericPatterns.threeDigits,V);case 4:return u(r.numericPatterns.fourDigits,V);default:return u(new RegExp("^\\d{1,"+F+"}"),V)}}function i(F,V){switch(F){case 1:return u(r.numericPatterns.singleDigitSigned,V);case 2:return u(r.numericPatterns.twoDigitsSigned,V);case 3:return u(r.numericPatterns.threeDigitsSigned,V);case 4:return u(r.numericPatterns.fourDigitsSigned,V);default:return u(new RegExp("^-?\\d{1,"+F+"}"),V)}}function C(F){switch(F){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function R(F,V){const G=V>0,H=G?V:1-V;let Z;if(H<=50)Z=F||100;else{const J=H+50,se=Math.trunc(J/100)*100,pe=F>=J%100;Z=F+se-(pe?100:0)}return G?Z:1-Z}function z(F){return F%400===0||F%4===0&&F%100!==0}return bh}var nV;function sxe(){if(nV)return d1;nV=1,d1.YearParser=void 0;var e=Oo(),r=qo();let a=class extends e.Parser{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(p,y,x){const i=C=>({year:C,isTwoDigitYear:y==="yy"});switch(y){case"y":return(0,r.mapValue)((0,r.parseNDigits)(4,p),i);case"yo":return(0,r.mapValue)(x.ordinalNumber(p,{unit:"year"}),i);default:return(0,r.mapValue)((0,r.parseNDigits)(y.length,p),i)}}validate(p,y){return y.isTwoDigitYear||y.year>0}set(p,y,x){const i=p.getFullYear();if(x.isTwoDigitYear){const R=(0,r.normalizeTwoDigitYear)(x.year,i);return p.setFullYear(R,0,1),p.setHours(0,0,0,0),p}const C=!("era"in y)||y.era===1?x.year:1-x.year;return p.setFullYear(C,0,1),p.setHours(0,0,0,0),p}};return d1.YearParser=a,d1}var h1={},iV;function axe(){if(iV)return h1;iV=1,h1.LocalWeekYearParser=void 0;var e=ES(),r=kf(),a=Oo(),u=qo();let p=class extends a.Parser{priority=130;parse(x,i,C){const R=z=>({year:z,isTwoDigitYear:i==="YY"});switch(i){case"Y":return(0,u.mapValue)((0,u.parseNDigits)(4,x),R);case"Yo":return(0,u.mapValue)(C.ordinalNumber(x,{unit:"year"}),R);default:return(0,u.mapValue)((0,u.parseNDigits)(i.length,x),R)}}validate(x,i){return i.isTwoDigitYear||i.year>0}set(x,i,C,R){const z=(0,e.getWeekYear)(x,R);if(C.isTwoDigitYear){const V=(0,u.normalizeTwoDigitYear)(C.year,z);return x.setFullYear(V,0,R.firstWeekContainsDate),x.setHours(0,0,0,0),(0,r.startOfWeek)(x,R)}const F=!("era"in i)||i.era===1?C.year:1-C.year;return x.setFullYear(F,0,R.firstWeekContainsDate),x.setHours(0,0,0,0),(0,r.startOfWeek)(x,R)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]};return h1.LocalWeekYearParser=p,h1}var f1={},oV;function lxe(){if(oV)return f1;oV=1,f1.ISOWeekYearParser=void 0;var e=Vp(),r=Nn(),a=Oo(),u=qo();let p=class extends a.Parser{priority=130;parse(x,i){return i==="R"?(0,u.parseNDigitsSigned)(4,x):(0,u.parseNDigitsSigned)(i.length,x)}set(x,i,C){const R=(0,r.constructFrom)(x,0);return R.setFullYear(C,0,4),R.setHours(0,0,0,0),(0,e.startOfISOWeek)(R)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]};return f1.ISOWeekYearParser=p,f1}var p1={},sV;function cxe(){if(sV)return p1;sV=1,p1.ExtendedYearParser=void 0;var e=Oo(),r=qo();let a=class extends e.Parser{priority=130;parse(p,y){return y==="u"?(0,r.parseNDigitsSigned)(4,p):(0,r.parseNDigitsSigned)(y.length,p)}set(p,y,x){return p.setFullYear(x,0,1),p.setHours(0,0,0,0),p}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]};return p1.ExtendedYearParser=a,p1}var m1={},aV;function uxe(){if(aV)return m1;aV=1,m1.QuarterParser=void 0;var e=Oo(),r=qo();let a=class extends e.Parser{priority=120;parse(p,y,x){switch(y){case"Q":case"QQ":return(0,r.parseNDigits)(y.length,p);case"Qo":return x.ordinalNumber(p,{unit:"quarter"});case"QQQ":return x.quarter(p,{width:"abbreviated",context:"formatting"})||x.quarter(p,{width:"narrow",context:"formatting"});case"QQQQQ":return x.quarter(p,{width:"narrow",context:"formatting"});case"QQQQ":default:return x.quarter(p,{width:"wide",context:"formatting"})||x.quarter(p,{width:"abbreviated",context:"formatting"})||x.quarter(p,{width:"narrow",context:"formatting"})}}validate(p,y){return y>=1&&y<=4}set(p,y,x){return p.setMonth((x-1)*3,1),p.setHours(0,0,0,0),p}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]};return m1.QuarterParser=a,m1}var g1={},lV;function dxe(){if(lV)return g1;lV=1,g1.StandAloneQuarterParser=void 0;var e=Oo(),r=qo();let a=class extends e.Parser{priority=120;parse(p,y,x){switch(y){case"q":case"qq":return(0,r.parseNDigits)(y.length,p);case"qo":return x.ordinalNumber(p,{unit:"quarter"});case"qqq":return x.quarter(p,{width:"abbreviated",context:"standalone"})||x.quarter(p,{width:"narrow",context:"standalone"});case"qqqqq":return x.quarter(p,{width:"narrow",context:"standalone"});case"qqqq":default:return x.quarter(p,{width:"wide",context:"standalone"})||x.quarter(p,{width:"abbreviated",context:"standalone"})||x.quarter(p,{width:"narrow",context:"standalone"})}}validate(p,y){return y>=1&&y<=4}set(p,y,x){return p.setMonth((x-1)*3,1),p.setHours(0,0,0,0),p}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]};return g1.StandAloneQuarterParser=a,g1}var _1={},cV;function hxe(){if(cV)return _1;cV=1,_1.MonthParser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(y,x,i){const C=R=>R-1;switch(x){case"M":return(0,a.mapValue)((0,a.parseNumericPattern)(e.numericPatterns.month,y),C);case"MM":return(0,a.mapValue)((0,a.parseNDigits)(2,y),C);case"Mo":return(0,a.mapValue)(i.ordinalNumber(y,{unit:"month"}),C);case"MMM":return i.month(y,{width:"abbreviated",context:"formatting"})||i.month(y,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(y,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(y,{width:"wide",context:"formatting"})||i.month(y,{width:"abbreviated",context:"formatting"})||i.month(y,{width:"narrow",context:"formatting"})}}validate(y,x){return x>=0&&x<=11}set(y,x,i){return y.setMonth(i,1),y.setHours(0,0,0,0),y}};return _1.MonthParser=u,_1}var y1={},uV;function fxe(){if(uV)return y1;uV=1,y1.StandAloneMonthParser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{priority=110;parse(y,x,i){const C=R=>R-1;switch(x){case"L":return(0,a.mapValue)((0,a.parseNumericPattern)(e.numericPatterns.month,y),C);case"LL":return(0,a.mapValue)((0,a.parseNDigits)(2,y),C);case"Lo":return(0,a.mapValue)(i.ordinalNumber(y,{unit:"month"}),C);case"LLL":return i.month(y,{width:"abbreviated",context:"standalone"})||i.month(y,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(y,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(y,{width:"wide",context:"standalone"})||i.month(y,{width:"abbreviated",context:"standalone"})||i.month(y,{width:"narrow",context:"standalone"})}}validate(y,x){return x>=0&&x<=11}set(y,x,i){return y.setMonth(i,1),y.setHours(0,0,0,0),y}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};return y1.StandAloneMonthParser=u,y1}var v1={},HI={},dV;function S9(){if(dV)return HI;dV=1,HI.setWeek=a;var e=mO(),r=Sr();function a(u,p,y){const x=(0,r.toDate)(u,y?.in),i=(0,e.getWeek)(x,y)-p;return x.setDate(x.getDate()-i*7),(0,r.toDate)(x,y?.in)}return HI}var hV;function pxe(){if(hV)return v1;hV=1,v1.LocalWeekParser=void 0;var e=S9(),r=kf(),a=tu(),u=Oo(),p=qo();let y=class extends u.Parser{priority=100;parse(i,C,R){switch(C){case"w":return(0,p.parseNumericPattern)(a.numericPatterns.week,i);case"wo":return R.ordinalNumber(i,{unit:"week"});default:return(0,p.parseNDigits)(C.length,i)}}validate(i,C){return C>=1&&C<=53}set(i,C,R,z){return(0,r.startOfWeek)((0,e.setWeek)(i,R,z),z)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};return v1.LocalWeekParser=y,v1}var x1={},YI={},fV;function T9(){if(fV)return YI;fV=1,YI.setISOWeek=a;var e=fO(),r=Sr();function a(u,p,y){const x=(0,r.toDate)(u,y?.in),i=(0,e.getISOWeek)(x,y)-p;return x.setDate(x.getDate()-i*7),x}return YI}var pV;function mxe(){if(pV)return x1;pV=1,x1.ISOWeekParser=void 0;var e=T9(),r=Vp(),a=tu(),u=Oo(),p=qo();let y=class extends u.Parser{priority=100;parse(i,C,R){switch(C){case"I":return(0,p.parseNumericPattern)(a.numericPatterns.week,i);case"Io":return R.ordinalNumber(i,{unit:"week"});default:return(0,p.parseNDigits)(C.length,i)}}validate(i,C){return C>=1&&C<=53}set(i,C,R){return(0,r.startOfISOWeek)((0,e.setISOWeek)(i,R))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};return x1.ISOWeekParser=y,x1}var b1={},mV;function gxe(){if(mV)return b1;mV=1,b1.DateParser=void 0;var e=tu(),r=Oo(),a=qo();const u=[31,28,31,30,31,30,31,31,30,31,30,31],p=[31,29,31,30,31,30,31,31,30,31,30,31];let y=class extends r.Parser{priority=90;subPriority=1;parse(i,C,R){switch(C){case"d":return(0,a.parseNumericPattern)(e.numericPatterns.date,i);case"do":return R.ordinalNumber(i,{unit:"date"});default:return(0,a.parseNDigits)(C.length,i)}}validate(i,C){const R=i.getFullYear(),z=(0,a.isLeapYearIndex)(R),F=i.getMonth();return z?C>=1&&C<=p[F]:C>=1&&C<=u[F]}set(i,C,R){return i.setDate(R),i.setHours(0,0,0,0),i}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]};return b1.DateParser=y,b1}var w1={},gV;function _xe(){if(gV)return w1;gV=1,w1.DayOfYearParser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{priority=90;subpriority=1;parse(y,x,i){switch(x){case"D":case"DD":return(0,a.parseNumericPattern)(e.numericPatterns.dayOfYear,y);case"Do":return i.ordinalNumber(y,{unit:"date"});default:return(0,a.parseNDigits)(x.length,y)}}validate(y,x){const i=y.getFullYear();return(0,a.isLeapYearIndex)(i)?x>=1&&x<=366:x>=1&&x<=365}set(y,x,i){return y.setMonth(0,i),y.setHours(0,0,0,0),y}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};return w1.DayOfYearParser=u,w1}var S1={},ZI={},_V;function IS(){if(_V)return ZI;_V=1,ZI.setDay=u;var e=eu(),r=Np(),a=Sr();function u(p,y,x){const i=(0,e.getDefaultOptions)(),C=x?.weekStartsOn??x?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,R=(0,a.toDate)(p,x?.in),z=R.getDay(),V=(y%7+7)%7,G=7-C,H=y<0||y>6?y-(z+G)%7:(V+G)%7-(z+G)%7;return(0,r.addDays)(R,H,x)}return ZI}var yV;function yxe(){if(yV)return S1;yV=1,S1.DayParser=void 0;var e=IS(),r=Oo();let a=class extends r.Parser{priority=90;parse(p,y,x){switch(y){case"E":case"EE":case"EEE":return x.day(p,{width:"abbreviated",context:"formatting"})||x.day(p,{width:"short",context:"formatting"})||x.day(p,{width:"narrow",context:"formatting"});case"EEEEE":return x.day(p,{width:"narrow",context:"formatting"});case"EEEEEE":return x.day(p,{width:"short",context:"formatting"})||x.day(p,{width:"narrow",context:"formatting"});case"EEEE":default:return x.day(p,{width:"wide",context:"formatting"})||x.day(p,{width:"abbreviated",context:"formatting"})||x.day(p,{width:"short",context:"formatting"})||x.day(p,{width:"narrow",context:"formatting"})}}validate(p,y){return y>=0&&y<=6}set(p,y,x,i){return p=(0,e.setDay)(p,x,i),p.setHours(0,0,0,0),p}incompatibleTokens=["D","i","e","c","t","T"]};return S1.DayParser=a,S1}var T1={},vV;function vxe(){if(vV)return T1;vV=1,T1.LocalDayParser=void 0;var e=IS(),r=Oo(),a=qo();let u=class extends r.Parser{priority=90;parse(y,x,i,C){const R=z=>{const F=Math.floor((z-1)/7)*7;return(z+C.weekStartsOn+6)%7+F};switch(x){case"e":case"ee":return(0,a.mapValue)((0,a.parseNDigits)(x.length,y),R);case"eo":return(0,a.mapValue)(i.ordinalNumber(y,{unit:"day"}),R);case"eee":return i.day(y,{width:"abbreviated",context:"formatting"})||i.day(y,{width:"short",context:"formatting"})||i.day(y,{width:"narrow",context:"formatting"});case"eeeee":return i.day(y,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(y,{width:"short",context:"formatting"})||i.day(y,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(y,{width:"wide",context:"formatting"})||i.day(y,{width:"abbreviated",context:"formatting"})||i.day(y,{width:"short",context:"formatting"})||i.day(y,{width:"narrow",context:"formatting"})}}validate(y,x){return x>=0&&x<=6}set(y,x,i,C){return y=(0,e.setDay)(y,i,C),y.setHours(0,0,0,0),y}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]};return T1.LocalDayParser=u,T1}var E1={},xV;function xxe(){if(xV)return E1;xV=1,E1.StandAloneLocalDayParser=void 0;var e=IS(),r=Oo(),a=qo();let u=class extends r.Parser{priority=90;parse(y,x,i,C){const R=z=>{const F=Math.floor((z-1)/7)*7;return(z+C.weekStartsOn+6)%7+F};switch(x){case"c":case"cc":return(0,a.mapValue)((0,a.parseNDigits)(x.length,y),R);case"co":return(0,a.mapValue)(i.ordinalNumber(y,{unit:"day"}),R);case"ccc":return i.day(y,{width:"abbreviated",context:"standalone"})||i.day(y,{width:"short",context:"standalone"})||i.day(y,{width:"narrow",context:"standalone"});case"ccccc":return i.day(y,{width:"narrow",context:"standalone"});case"cccccc":return i.day(y,{width:"short",context:"standalone"})||i.day(y,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(y,{width:"wide",context:"standalone"})||i.day(y,{width:"abbreviated",context:"standalone"})||i.day(y,{width:"short",context:"standalone"})||i.day(y,{width:"narrow",context:"standalone"})}}validate(y,x){return x>=0&&x<=6}set(y,x,i,C){return y=(0,e.setDay)(y,i,C),y.setHours(0,0,0,0),y}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};return E1.StandAloneLocalDayParser=u,E1}var P1={},XI={},bV;function E9(){if(bV)return XI;bV=1,XI.setISODay=u;var e=Np(),r=v9(),a=Sr();function u(p,y,x){const i=(0,a.toDate)(p,x?.in),C=(0,r.getISODay)(i,x),R=y-C;return(0,e.addDays)(i,R,x)}return XI}var wV;function bxe(){if(wV)return P1;wV=1,P1.ISODayParser=void 0;var e=E9(),r=Oo(),a=qo();let u=class extends r.Parser{priority=90;parse(y,x,i){const C=R=>R===0?7:R;switch(x){case"i":case"ii":return(0,a.parseNDigits)(x.length,y);case"io":return i.ordinalNumber(y,{unit:"day"});case"iii":return(0,a.mapValue)(i.day(y,{width:"abbreviated",context:"formatting"})||i.day(y,{width:"short",context:"formatting"})||i.day(y,{width:"narrow",context:"formatting"}),C);case"iiiii":return(0,a.mapValue)(i.day(y,{width:"narrow",context:"formatting"}),C);case"iiiiii":return(0,a.mapValue)(i.day(y,{width:"short",context:"formatting"})||i.day(y,{width:"narrow",context:"formatting"}),C);case"iiii":default:return(0,a.mapValue)(i.day(y,{width:"wide",context:"formatting"})||i.day(y,{width:"abbreviated",context:"formatting"})||i.day(y,{width:"short",context:"formatting"})||i.day(y,{width:"narrow",context:"formatting"}),C)}}validate(y,x){return x>=1&&x<=7}set(y,x,i){return y=(0,e.setISODay)(y,i),y.setHours(0,0,0,0),y}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]};return P1.ISODayParser=u,P1}var I1={},SV;function wxe(){if(SV)return I1;SV=1,I1.AMPMParser=void 0;var e=Oo(),r=qo();let a=class extends e.Parser{priority=80;parse(p,y,x){switch(y){case"a":case"aa":case"aaa":return x.dayPeriod(p,{width:"abbreviated",context:"formatting"})||x.dayPeriod(p,{width:"narrow",context:"formatting"});case"aaaaa":return x.dayPeriod(p,{width:"narrow",context:"formatting"});case"aaaa":default:return x.dayPeriod(p,{width:"wide",context:"formatting"})||x.dayPeriod(p,{width:"abbreviated",context:"formatting"})||x.dayPeriod(p,{width:"narrow",context:"formatting"})}}set(p,y,x){return p.setHours((0,r.dayPeriodEnumToHours)(x),0,0,0),p}incompatibleTokens=["b","B","H","k","t","T"]};return I1.AMPMParser=a,I1}var M1={},TV;function Sxe(){if(TV)return M1;TV=1,M1.AMPMMidnightParser=void 0;var e=Oo(),r=qo();let a=class extends e.Parser{priority=80;parse(p,y,x){switch(y){case"b":case"bb":case"bbb":return x.dayPeriod(p,{width:"abbreviated",context:"formatting"})||x.dayPeriod(p,{width:"narrow",context:"formatting"});case"bbbbb":return x.dayPeriod(p,{width:"narrow",context:"formatting"});case"bbbb":default:return x.dayPeriod(p,{width:"wide",context:"formatting"})||x.dayPeriod(p,{width:"abbreviated",context:"formatting"})||x.dayPeriod(p,{width:"narrow",context:"formatting"})}}set(p,y,x){return p.setHours((0,r.dayPeriodEnumToHours)(x),0,0,0),p}incompatibleTokens=["a","B","H","k","t","T"]};return M1.AMPMMidnightParser=a,M1}var C1={},EV;function Txe(){if(EV)return C1;EV=1,C1.DayPeriodParser=void 0;var e=Oo(),r=qo();let a=class extends e.Parser{priority=80;parse(p,y,x){switch(y){case"B":case"BB":case"BBB":return x.dayPeriod(p,{width:"abbreviated",context:"formatting"})||x.dayPeriod(p,{width:"narrow",context:"formatting"});case"BBBBB":return x.dayPeriod(p,{width:"narrow",context:"formatting"});case"BBBB":default:return x.dayPeriod(p,{width:"wide",context:"formatting"})||x.dayPeriod(p,{width:"abbreviated",context:"formatting"})||x.dayPeriod(p,{width:"narrow",context:"formatting"})}}set(p,y,x){return p.setHours((0,r.dayPeriodEnumToHours)(x),0,0,0),p}incompatibleTokens=["a","b","t","T"]};return C1.DayPeriodParser=a,C1}var A1={},PV;function Exe(){if(PV)return A1;PV=1,A1.Hour1to12Parser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{priority=70;parse(y,x,i){switch(x){case"h":return(0,a.parseNumericPattern)(e.numericPatterns.hour12h,y);case"ho":return i.ordinalNumber(y,{unit:"hour"});default:return(0,a.parseNDigits)(x.length,y)}}validate(y,x){return x>=1&&x<=12}set(y,x,i){const C=y.getHours()>=12;return C&&i<12?y.setHours(i+12,0,0,0):!C&&i===12?y.setHours(0,0,0,0):y.setHours(i,0,0,0),y}incompatibleTokens=["H","K","k","t","T"]};return A1.Hour1to12Parser=u,A1}var D1={},IV;function Pxe(){if(IV)return D1;IV=1,D1.Hour0to23Parser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{priority=70;parse(y,x,i){switch(x){case"H":return(0,a.parseNumericPattern)(e.numericPatterns.hour23h,y);case"Ho":return i.ordinalNumber(y,{unit:"hour"});default:return(0,a.parseNDigits)(x.length,y)}}validate(y,x){return x>=0&&x<=23}set(y,x,i){return y.setHours(i,0,0,0),y}incompatibleTokens=["a","b","h","K","k","t","T"]};return D1.Hour0to23Parser=u,D1}var R1={},MV;function Ixe(){if(MV)return R1;MV=1,R1.Hour0To11Parser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{priority=70;parse(y,x,i){switch(x){case"K":return(0,a.parseNumericPattern)(e.numericPatterns.hour11h,y);case"Ko":return i.ordinalNumber(y,{unit:"hour"});default:return(0,a.parseNDigits)(x.length,y)}}validate(y,x){return x>=0&&x<=11}set(y,x,i){return y.getHours()>=12&&i<12?y.setHours(i+12,0,0,0):y.setHours(i,0,0,0),y}incompatibleTokens=["h","H","k","t","T"]};return R1.Hour0To11Parser=u,R1}var O1={},CV;function Mxe(){if(CV)return O1;CV=1,O1.Hour1To24Parser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{priority=70;parse(y,x,i){switch(x){case"k":return(0,a.parseNumericPattern)(e.numericPatterns.hour24h,y);case"ko":return i.ordinalNumber(y,{unit:"hour"});default:return(0,a.parseNDigits)(x.length,y)}}validate(y,x){return x>=1&&x<=24}set(y,x,i){const C=i<=24?i%24:i;return y.setHours(C,0,0,0),y}incompatibleTokens=["a","b","h","H","K","t","T"]};return O1.Hour1To24Parser=u,O1}var L1={},AV;function Cxe(){if(AV)return L1;AV=1,L1.MinuteParser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{priority=60;parse(y,x,i){switch(x){case"m":return(0,a.parseNumericPattern)(e.numericPatterns.minute,y);case"mo":return i.ordinalNumber(y,{unit:"minute"});default:return(0,a.parseNDigits)(x.length,y)}}validate(y,x){return x>=0&&x<=59}set(y,x,i){return y.setMinutes(i,0,0),y}incompatibleTokens=["t","T"]};return L1.MinuteParser=u,L1}var z1={},DV;function Axe(){if(DV)return z1;DV=1,z1.SecondParser=void 0;var e=tu(),r=Oo(),a=qo();let u=class extends r.Parser{priority=50;parse(y,x,i){switch(x){case"s":return(0,a.parseNumericPattern)(e.numericPatterns.second,y);case"so":return i.ordinalNumber(y,{unit:"second"});default:return(0,a.parseNDigits)(x.length,y)}}validate(y,x){return x>=0&&x<=59}set(y,x,i){return y.setSeconds(i,0),y}incompatibleTokens=["t","T"]};return z1.SecondParser=u,z1}var F1={},RV;function Dxe(){if(RV)return F1;RV=1,F1.FractionOfSecondParser=void 0;var e=Oo(),r=qo();let a=class extends e.Parser{priority=30;parse(p,y){const x=i=>Math.trunc(i*Math.pow(10,-y.length+3));return(0,r.mapValue)((0,r.parseNDigits)(y.length,p),x)}set(p,y,x){return p.setMilliseconds(x),p}incompatibleTokens=["t","T"]};return F1.FractionOfSecondParser=a,F1}var k1={},OV;function Rxe(){if(OV)return k1;OV=1,k1.ISOTimezoneWithZParser=void 0;var e=Nn(),r=Ym(),a=tu(),u=Oo(),p=qo();let y=class extends u.Parser{priority=10;parse(i,C){switch(C){case"X":return(0,p.parseTimezonePattern)(a.timezonePatterns.basicOptionalMinutes,i);case"XX":return(0,p.parseTimezonePattern)(a.timezonePatterns.basic,i);case"XXXX":return(0,p.parseTimezonePattern)(a.timezonePatterns.basicOptionalSeconds,i);case"XXXXX":return(0,p.parseTimezonePattern)(a.timezonePatterns.extendedOptionalSeconds,i);case"XXX":default:return(0,p.parseTimezonePattern)(a.timezonePatterns.extended,i)}}set(i,C,R){return C.timestampIsSet?i:(0,e.constructFrom)(i,i.getTime()-(0,r.getTimezoneOffsetInMilliseconds)(i)-R)}incompatibleTokens=["t","T","x"]};return k1.ISOTimezoneWithZParser=y,k1}var B1={},LV;function Oxe(){if(LV)return B1;LV=1,B1.ISOTimezoneParser=void 0;var e=Nn(),r=Ym(),a=tu(),u=Oo(),p=qo();let y=class extends u.Parser{priority=10;parse(i,C){switch(C){case"x":return(0,p.parseTimezonePattern)(a.timezonePatterns.basicOptionalMinutes,i);case"xx":return(0,p.parseTimezonePattern)(a.timezonePatterns.basic,i);case"xxxx":return(0,p.parseTimezonePattern)(a.timezonePatterns.basicOptionalSeconds,i);case"xxxxx":return(0,p.parseTimezonePattern)(a.timezonePatterns.extendedOptionalSeconds,i);case"xxx":default:return(0,p.parseTimezonePattern)(a.timezonePatterns.extended,i)}}set(i,C,R){return C.timestampIsSet?i:(0,e.constructFrom)(i,i.getTime()-(0,r.getTimezoneOffsetInMilliseconds)(i)-R)}incompatibleTokens=["t","T","X"]};return B1.ISOTimezoneParser=y,B1}var j1={},zV;function Lxe(){if(zV)return j1;zV=1,j1.TimestampSecondsParser=void 0;var e=Nn(),r=Oo(),a=qo();let u=class extends r.Parser{priority=40;parse(y){return(0,a.parseAnyDigitsSigned)(y)}set(y,x,i){return[(0,e.constructFrom)(y,i*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"};return j1.TimestampSecondsParser=u,j1}var N1={},FV;function zxe(){if(FV)return N1;FV=1,N1.TimestampMillisecondsParser=void 0;var e=Nn(),r=Oo(),a=qo();let u=class extends r.Parser{priority=20;parse(y){return(0,a.parseAnyDigitsSigned)(y)}set(y,x,i){return[(0,e.constructFrom)(y,i),{timestampIsSet:!0}]}incompatibleTokens="*"};return N1.TimestampMillisecondsParser=u,N1}var kV;function Fxe(){if(kV)return l1;kV=1,l1.parsers=void 0;var e=oxe(),r=sxe(),a=axe(),u=lxe(),p=cxe(),y=uxe(),x=dxe(),i=hxe(),C=fxe(),R=pxe(),z=mxe(),F=gxe(),V=_xe(),G=yxe(),H=vxe(),Z=xxe(),J=bxe(),se=wxe(),pe=Sxe(),ve=Txe(),Ne=Exe(),_e=Pxe(),Re=Ixe(),ke=Mxe(),ze=Cxe(),et=Axe(),ht=Dxe(),Xt=Rxe(),Ir=Oxe(),nr=Lxe(),Fr=zxe();return l1.parsers={G:new e.EraParser,y:new r.YearParser,Y:new a.LocalWeekYearParser,R:new u.ISOWeekYearParser,u:new p.ExtendedYearParser,Q:new y.QuarterParser,q:new x.StandAloneQuarterParser,M:new i.MonthParser,L:new C.StandAloneMonthParser,w:new R.LocalWeekParser,I:new z.ISOWeekParser,d:new F.DateParser,D:new V.DayOfYearParser,E:new G.DayParser,e:new H.LocalDayParser,c:new Z.StandAloneLocalDayParser,i:new J.ISODayParser,a:new se.AMPMParser,b:new pe.AMPMMidnightParser,B:new ve.DayPeriodParser,h:new Ne.Hour1to12Parser,H:new _e.Hour0to23Parser,K:new Re.Hour0To11Parser,k:new ke.Hour1To24Parser,m:new ze.MinuteParser,s:new et.SecondParser,S:new ht.FractionOfSecondParser,X:new Xt.ISOTimezoneWithZParser,x:new Ir.ISOTimezoneParser,t:new nr.TimestampSecondsParser,T:new Fr.TimestampMillisecondsParser},l1}var BV;function P9(){return BV||(BV=1,(function(e){Object.defineProperty(e,"longFormatters",{enumerable:!0,get:function(){return a.longFormatters}}),e.parse=Z,Object.defineProperty(e,"parsers",{enumerable:!0,get:function(){return C.parsers}});var r=ev(),a=u9(),u=d9(),p=Nn(),y=y9(),x=Sr(),i=w9(),C=Fxe();const R=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,z=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,F=/^'([^]*?)'?$/,V=/''/g,G=/\S/,H=/[a-zA-Z]/;function Z(se,pe,ve,Ne){const _e=()=>(0,p.constructFrom)(Ne?.in||ve,NaN),Re=(0,y.getDefaultOptions)(),ke=Ne?.locale??Re.locale??r.defaultLocale,ze=Ne?.firstWeekContainsDate??Ne?.locale?.options?.firstWeekContainsDate??Re.firstWeekContainsDate??Re.locale?.options?.firstWeekContainsDate??1,et=Ne?.weekStartsOn??Ne?.locale?.options?.weekStartsOn??Re.weekStartsOn??Re.locale?.options?.weekStartsOn??0;if(!pe)return se?_e():(0,x.toDate)(ve,Ne?.in);const ht={firstWeekContainsDate:ze,weekStartsOn:et,locale:ke},Xt=[new i.DateTimezoneSetter(Ne?.in,ve)],Ir=pe.match(z).map(lt=>{const Et=lt[0];if(Et in a.longFormatters){const qt=a.longFormatters[Et];return qt(lt,ke.formatLong)}return lt}).join("").match(R),nr=[];for(let lt of Ir){!Ne?.useAdditionalWeekYearTokens&&(0,u.isProtectedWeekYearToken)(lt)&&(0,u.warnOrThrowProtectedError)(lt,pe,se),!Ne?.useAdditionalDayOfYearTokens&&(0,u.isProtectedDayOfYearToken)(lt)&&(0,u.warnOrThrowProtectedError)(lt,pe,se);const Et=lt[0],qt=C.parsers[Et];if(qt){const{incompatibleTokens:Gt}=qt;if(Array.isArray(Gt)){const ct=nr.find(_t=>Gt.includes(_t.token)||_t.token===Et);if(ct)throw new RangeError(`The format string mustn't contain \`${ct.fullToken}\` and \`${lt}\` at the same time`)}else if(qt.incompatibleTokens==="*"&&nr.length>0)throw new RangeError(`The format string mustn't contain \`${lt}\` and any other token at the same time`);nr.push({token:Et,fullToken:lt});const tt=qt.run(se,lt,ke.match,ht);if(!tt)return _e();Xt.push(tt.setter),se=tt.rest}else{if(Et.match(H))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Et+"`");if(lt==="''"?lt="'":Et==="'"&&(lt=J(lt)),se.indexOf(lt)===0)se=se.slice(lt.length);else return _e()}}if(se.length>0&&G.test(se))return _e();const Fr=Xt.map(lt=>lt.priority).sort((lt,Et)=>Et-lt).filter((lt,Et,qt)=>qt.indexOf(lt)===Et).map(lt=>Xt.filter(Et=>Et.priority===lt).sort((Et,qt)=>qt.subPriority-Et.subPriority)).map(lt=>lt[0]);let Or=(0,x.toDate)(ve,Ne?.in);if(isNaN(+Or))return _e();const or={};for(const lt of Fr){if(!lt.validate(Or,ht))return _e();const Et=lt.set(Or,or,ht);Array.isArray(Et)?(Or=Et[0],Object.assign(or,Et[1])):Or=Et}return Or}function J(se){return se.match(F)[1].replace(V,"'")}})(qI)),qI}var jV;function kxe(){if(jV)return WI;jV=1,WI.isMatch=a;var e=Xm(),r=P9();function a(u,p,y){return(0,e.isValid)((0,r.parse)(u,p,new Date,y))}return WI}var KI={},NV;function Bxe(){if(NV)return KI;NV=1,KI.isMonday=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDay()===1}return KI}var QI={},VV;function jxe(){if(VV)return QI;VV=1,QI.isPast=r;var e=Sr();function r(a){return+(0,e.toDate)(a)<Date.now()}return QI}var JI={},eM={},UV;function I9(){if(UV)return eM;UV=1,eM.startOfHour=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setMinutes(0,0,0),p}return eM}var $V;function M9(){if($V)return JI;$V=1,JI.isSameHour=a;var e=Xo(),r=I9();function a(u,p,y){const[x,i]=(0,e.normalizeDates)(y?.in,u,p);return+(0,r.startOfHour)(x)==+(0,r.startOfHour)(i)}return JI}var tM={},rM={},WV;function gO(){if(WV)return rM;WV=1,rM.isSameWeek=a;var e=Xo(),r=kf();function a(u,p,y){const[x,i]=(0,e.normalizeDates)(y?.in,u,p);return+(0,r.startOfWeek)(x,y)==+(0,r.startOfWeek)(i,y)}return rM}var qV;function C9(){if(qV)return tM;qV=1,tM.isSameISOWeek=r;var e=gO();function r(a,u,p){return(0,e.isSameWeek)(a,u,{...p,weekStartsOn:1})}return tM}var nM={},GV;function Nxe(){if(GV)return nM;GV=1,nM.isSameISOWeekYear=a;var e=Ox(),r=Xo();function a(u,p,y){const[x,i]=(0,r.normalizeDates)(y?.in,u,p);return+(0,e.startOfISOWeekYear)(x)==+(0,e.startOfISOWeekYear)(i)}return nM}var iM={},oM={},HV;function A9(){if(HV)return oM;HV=1,oM.startOfMinute=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setSeconds(0,0),p}return oM}var YV;function D9(){if(YV)return iM;YV=1,iM.isSameMinute=r;var e=A9();function r(a,u){return+(0,e.startOfMinute)(a)==+(0,e.startOfMinute)(u)}return iM}var sM={},ZV;function R9(){if(ZV)return sM;ZV=1,sM.isSameMonth=r;var e=Xo();function r(a,u,p){const[y,x]=(0,e.normalizeDates)(p?.in,a,u);return y.getFullYear()===x.getFullYear()&&y.getMonth()===x.getMonth()}return sM}var aM={},XV;function O9(){if(XV)return aM;XV=1,aM.isSameQuarter=a;var e=Xo(),r=uO();function a(u,p,y){const[x,i]=(0,e.normalizeDates)(y?.in,u,p);return+(0,r.startOfQuarter)(x)==+(0,r.startOfQuarter)(i)}return aM}var lM={},cM={},KV;function L9(){if(KV)return cM;KV=1,cM.startOfSecond=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in);return p.setMilliseconds(0),p}return cM}var QV;function z9(){if(QV)return lM;QV=1,lM.isSameSecond=r;var e=L9();function r(a,u){return+(0,e.startOfSecond)(a)==+(0,e.startOfSecond)(u)}return lM}var uM={},JV;function F9(){if(JV)return uM;JV=1,uM.isSameYear=r;var e=Xo();function r(a,u,p){const[y,x]=(0,e.normalizeDates)(p?.in,a,u);return y.getFullYear()===x.getFullYear()}return uM}var dM={},e6;function Vxe(){if(e6)return dM;e6=1,dM.isThisHour=u;var e=Ml(),r=M9(),a=Sr();function u(p,y){return(0,r.isSameHour)((0,a.toDate)(p,y?.in),(0,e.constructNow)(y?.in||p))}return dM}var hM={},t6;function Uxe(){if(t6)return hM;t6=1,hM.isThisISOWeek=u;var e=Nn(),r=Ml(),a=C9();function u(p,y){return(0,a.isSameISOWeek)((0,e.constructFrom)(y?.in||p,p),(0,r.constructNow)(y?.in||p))}return hM}var fM={},r6;function $xe(){if(r6)return fM;r6=1,fM.isThisMinute=a;var e=Ml(),r=D9();function a(u){return(0,r.isSameMinute)(u,(0,e.constructNow)(u))}return fM}var pM={},n6;function Wxe(){if(n6)return pM;n6=1,pM.isThisMonth=u;var e=Nn(),r=Ml(),a=R9();function u(p,y){return(0,a.isSameMonth)((0,e.constructFrom)(y?.in||p,p),(0,r.constructNow)(y?.in||p))}return pM}var mM={},i6;function qxe(){if(i6)return mM;i6=1,mM.isThisQuarter=u;var e=Nn(),r=Ml(),a=O9();function u(p,y){return(0,a.isSameQuarter)((0,e.constructFrom)(y?.in||p,p),(0,r.constructNow)(y?.in||p))}return mM}var gM={},o6;function Gxe(){if(o6)return gM;o6=1,gM.isThisSecond=a;var e=Ml(),r=z9();function a(u){return(0,r.isSameSecond)(u,(0,e.constructNow)(u))}return gM}var _M={},s6;function Hxe(){if(s6)return _M;s6=1,_M.isThisWeek=u;var e=Nn(),r=Ml(),a=gO();function u(p,y){return(0,a.isSameWeek)((0,e.constructFrom)(y?.in||p,p),(0,r.constructNow)(y?.in||p),y)}return _M}var yM={},a6;function Yxe(){if(a6)return yM;a6=1,yM.isThisYear=u;var e=Nn(),r=Ml(),a=F9();function u(p,y){return(0,a.isSameYear)((0,e.constructFrom)(y?.in||p,p),(0,r.constructNow)(y?.in||p))}return yM}var vM={},l6;function Zxe(){if(l6)return vM;l6=1,vM.isThursday=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDay()===4}return vM}var xM={},c6;function Xxe(){if(c6)return xM;c6=1,xM.isToday=u;var e=Nn(),r=Ml(),a=Lx();function u(p,y){return(0,a.isSameDay)((0,e.constructFrom)(y?.in||p,p),(0,r.constructNow)(y?.in||p))}return xM}var bM={},u6;function Kxe(){if(u6)return bM;u6=1,bM.isTomorrow=u;var e=Np(),r=Ml(),a=Lx();function u(p,y){return(0,a.isSameDay)(p,(0,e.addDays)((0,r.constructNow)(y?.in||p),1),y)}return bM}var wM={},d6;function Qxe(){if(d6)return wM;d6=1,wM.isTuesday=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDay()===2}return wM}var SM={},h6;function Jxe(){if(h6)return SM;h6=1,SM.isWednesday=r;var e=Sr();function r(a,u){return(0,e.toDate)(a,u?.in).getDay()===3}return SM}var TM={},f6;function ebe(){if(f6)return TM;f6=1,TM.isWithinInterval=r;var e=Sr();function r(a,u,p){const y=+(0,e.toDate)(a,p?.in),[x,i]=[+(0,e.toDate)(u.start,p?.in),+(0,e.toDate)(u.end,p?.in)].sort((C,R)=>C-R);return y>=x&&y<=i}return TM}var EM={},PM={},p6;function MS(){if(p6)return PM;p6=1,PM.subDays=r;var e=Np();function r(a,u,p){return(0,e.addDays)(a,-u,p)}return PM}var m6;function tbe(){if(m6)return EM;m6=1,EM.isYesterday=p;var e=Nn(),r=Ml(),a=Lx(),u=MS();function p(y,x){return(0,a.isSameDay)((0,e.constructFrom)(x?.in||y,y),(0,u.subDays)((0,r.constructNow)(x?.in||y),1))}return EM}var IM={},g6;function rbe(){if(g6)return IM;g6=1,IM.lastDayOfDecade=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getFullYear(),x=9+Math.floor(y/10)*10;return p.setFullYear(x+1,0,0),p.setHours(0,0,0,0),(0,e.toDate)(p,u?.in)}return IM}var MM={},CM={},_6;function k9(){if(_6)return CM;_6=1,CM.lastDayOfWeek=a;var e=eu(),r=Sr();function a(u,p){const y=(0,e.getDefaultOptions)(),x=p?.weekStartsOn??p?.locale?.options?.weekStartsOn??y.weekStartsOn??y.locale?.options?.weekStartsOn??0,i=(0,r.toDate)(u,p?.in),C=i.getDay(),R=(C<x?-7:0)+6-(C-x);return i.setHours(0,0,0,0),i.setDate(i.getDate()+R),i}return CM}var y6;function nbe(){if(y6)return MM;y6=1,MM.lastDayOfISOWeek=r;var e=k9();function r(a,u){return(0,e.lastDayOfWeek)(a,{...u,weekStartsOn:1})}return MM}var AM={},v6;function ibe(){if(v6)return AM;v6=1,AM.lastDayOfISOWeekYear=u;var e=Nn(),r=x_(),a=Vp();function u(p,y){const x=(0,r.getISOWeekYear)(p,y),i=(0,e.constructFrom)(y?.in||p,0);i.setFullYear(x+1,0,4),i.setHours(0,0,0,0);const C=(0,a.startOfISOWeek)(i,y);return C.setDate(C.getDate()-1),C}return AM}var DM={},x6;function obe(){if(x6)return DM;x6=1,DM.lastDayOfQuarter=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getMonth(),x=y-y%3+3;return p.setMonth(x,0),p.setHours(0,0,0,0),p}return DM}var RM={},b6;function sbe(){if(b6)return RM;b6=1,RM.lastDayOfYear=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getFullYear();return p.setFullYear(y+1,0,0),p.setHours(0,0,0,0),p}return RM}var OM={},w6;function abe(){return w6||(w6=1,(function(e){e.lightFormat=C,Object.defineProperty(e,"lightFormatters",{enumerable:!0,get:function(){return r.lightFormatters}});var r=c9(),a=Xm(),u=Sr();const p=/(\w)\1*|''|'(''|[^'])+('|$)|./g,y=/^'([^]*?)'?$/,x=/''/g,i=/[a-zA-Z]/;function C(z,F){const V=(0,u.toDate)(z);if(!(0,a.isValid)(V))throw new RangeError("Invalid time value");const G=F.match(p);return G?G.map(Z=>{if(Z==="''")return"'";const J=Z[0];if(J==="'")return R(Z);const se=r.lightFormatters[J];if(se)return se(V,Z);if(J.match(i))throw new RangeError("Format string contains an unescaped latin alphabet character `"+J+"`");return Z}).join(""):""}function R(z){const F=z.match(y);return F?F[1].replace(x,"'"):z}})(OM)),OM}var LM={},S6;function lbe(){if(S6)return LM;S6=1,LM.milliseconds=r;var e=Vi();function r({years:a,months:u,weeks:p,days:y,hours:x,minutes:i,seconds:C}){let R=0;a&&(R+=a*e.daysInYear),u&&(R+=u*(e.daysInYear/12)),p&&(R+=p*7),y&&(R+=y);let z=R*24*60*60;return x&&(z+=x*60*60),i&&(z+=i*60),C&&(z+=C),Math.trunc(z*1e3)}return LM}var zM={},T6;function cbe(){if(T6)return zM;T6=1,zM.millisecondsToHours=r;var e=Vi();function r(a){const u=a/e.millisecondsInHour;return Math.trunc(u)}return zM}var FM={},E6;function ube(){if(E6)return FM;E6=1,FM.millisecondsToMinutes=r;var e=Vi();function r(a){const u=a/e.millisecondsInMinute;return Math.trunc(u)}return FM}var kM={},P6;function dbe(){if(P6)return kM;P6=1,kM.millisecondsToSeconds=r;var e=Vi();function r(a){const u=a/e.millisecondsInSecond;return Math.trunc(u)}return kM}var BM={},I6;function hbe(){if(I6)return BM;I6=1,BM.minutesToHours=r;var e=Vi();function r(a){const u=a/e.minutesInHour;return Math.trunc(u)}return BM}var jM={},M6;function fbe(){if(M6)return jM;M6=1,jM.minutesToMilliseconds=r;var e=Vi();function r(a){return Math.trunc(a*e.millisecondsInMinute)}return jM}var NM={},C6;function pbe(){if(C6)return NM;C6=1,NM.minutesToSeconds=r;var e=Vi();function r(a){return Math.trunc(a*e.secondsInMinute)}return NM}var VM={},A6;function mbe(){if(A6)return VM;A6=1,VM.monthsToQuarters=r;var e=Vi();function r(a){const u=a/e.monthsInQuarter;return Math.trunc(u)}return VM}var UM={},D6;function gbe(){if(D6)return UM;D6=1,UM.monthsToYears=r;var e=Vi();function r(a){const u=a/e.monthsInYear;return Math.trunc(u)}return UM}var $M={},R6;function Qm(){if(R6)return $M;R6=1,$M.nextDay=a;var e=Np(),r=PS();function a(u,p,y){let x=p-(0,r.getDay)(u,y);return x<=0&&(x+=7),(0,e.addDays)(u,x,y)}return $M}var WM={},O6;function _be(){if(O6)return WM;O6=1,WM.nextFriday=r;var e=Qm();function r(a,u){return(0,e.nextDay)(a,5,u)}return WM}var qM={},L6;function ybe(){if(L6)return qM;L6=1,qM.nextMonday=r;var e=Qm();function r(a,u){return(0,e.nextDay)(a,1,u)}return qM}var GM={},z6;function vbe(){if(z6)return GM;z6=1,GM.nextSaturday=r;var e=Qm();function r(a,u){return(0,e.nextDay)(a,6,u)}return GM}var HM={},F6;function xbe(){if(F6)return HM;F6=1,HM.nextSunday=r;var e=Qm();function r(a,u){return(0,e.nextDay)(a,0,u)}return HM}var YM={},k6;function bbe(){if(k6)return YM;k6=1,YM.nextThursday=r;var e=Qm();function r(a,u){return(0,e.nextDay)(a,4,u)}return YM}var ZM={},B6;function wbe(){if(B6)return ZM;B6=1,ZM.nextTuesday=r;var e=Qm();function r(a,u){return(0,e.nextDay)(a,2,u)}return ZM}var XM={},j6;function Sbe(){if(j6)return XM;j6=1,XM.nextWednesday=r;var e=Qm();function r(a,u){return(0,e.nextDay)(a,3,u)}return XM}var KM={},N6;function Tbe(){if(N6)return KM;N6=1,KM.parseISO=u;var e=Vi(),r=Nn(),a=Sr();function u(ke,ze){const et=()=>(0,r.constructFrom)(ze?.in,NaN),ht=ze?.additionalDigits??2,Xt=C(ke);let Ir;if(Xt.date){const or=R(Xt.date,ht);Ir=z(or.restDateString,or.year)}if(!Ir||isNaN(+Ir))return et();const nr=+Ir;let Fr=0,Or;if(Xt.time&&(Fr=V(Xt.time),isNaN(Fr)))return et();if(Xt.timezone){if(Or=H(Xt.timezone),isNaN(Or))return et()}else{const or=new Date(nr+Fr),lt=(0,a.toDate)(0,ze?.in);return lt.setFullYear(or.getUTCFullYear(),or.getUTCMonth(),or.getUTCDate()),lt.setHours(or.getUTCHours(),or.getUTCMinutes(),or.getUTCSeconds(),or.getUTCMilliseconds()),lt}return(0,a.toDate)(nr+Fr+Or,ze?.in)}const p={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},y=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,x=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,i=/^([+-])(\d{2})(?::?(\d{2}))?$/;function C(ke){const ze={},et=ke.split(p.dateTimeDelimiter);let ht;if(et.length>2)return ze;if(/:/.test(et[0])?ht=et[0]:(ze.date=et[0],ht=et[1],p.timeZoneDelimiter.test(ze.date)&&(ze.date=ke.split(p.timeZoneDelimiter)[0],ht=ke.substr(ze.date.length,ke.length))),ht){const Xt=p.timezone.exec(ht);Xt?(ze.time=ht.replace(Xt[1],""),ze.timezone=Xt[1]):ze.time=ht}return ze}function R(ke,ze){const et=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+ze)+"})|(\\d{2}|[+-]\\d{"+(2+ze)+"})$)"),ht=ke.match(et);if(!ht)return{year:NaN,restDateString:""};const Xt=ht[1]?parseInt(ht[1]):null,Ir=ht[2]?parseInt(ht[2]):null;return{year:Ir===null?Xt:Ir*100,restDateString:ke.slice((ht[1]||ht[2]).length)}}function z(ke,ze){if(ze===null)return new Date(NaN);const et=ke.match(y);if(!et)return new Date(NaN);const ht=!!et[4],Xt=F(et[1]),Ir=F(et[2])-1,nr=F(et[3]),Fr=F(et[4]),Or=F(et[5])-1;if(ht)return Ne(ze,Fr,Or)?Z(ze,Fr,Or):new Date(NaN);{const or=new Date(0);return!pe(ze,Ir,nr)||!ve(ze,Xt)?new Date(NaN):(or.setUTCFullYear(ze,Ir,Math.max(Xt,nr)),or)}}function F(ke){return ke?parseInt(ke):1}function V(ke){const ze=ke.match(x);if(!ze)return NaN;const et=G(ze[1]),ht=G(ze[2]),Xt=G(ze[3]);return _e(et,ht,Xt)?et*e.millisecondsInHour+ht*e.millisecondsInMinute+Xt*1e3:NaN}function G(ke){return ke&&parseFloat(ke.replace(",","."))||0}function H(ke){if(ke==="Z")return 0;const ze=ke.match(i);if(!ze)return 0;const et=ze[1]==="+"?-1:1,ht=parseInt(ze[2]),Xt=ze[3]&&parseInt(ze[3])||0;return Re(ht,Xt)?et*(ht*e.millisecondsInHour+Xt*e.millisecondsInMinute):NaN}function Z(ke,ze,et){const ht=new Date(0);ht.setUTCFullYear(ke,0,4);const Xt=ht.getUTCDay()||7,Ir=(ze-1)*7+et+1-Xt;return ht.setUTCDate(ht.getUTCDate()+Ir),ht}const J=[31,null,31,30,31,30,31,31,30,31,30,31];function se(ke){return ke%400===0||ke%4===0&&ke%100!==0}function pe(ke,ze,et){return ze>=0&&ze<=11&&et>=1&&et<=(J[ze]||(se(ke)?29:28))}function ve(ke,ze){return ze>=1&&ze<=(se(ke)?366:365)}function Ne(ke,ze,et){return ze>=1&&ze<=53&&et>=0&&et<=6}function _e(ke,ze,et){return ke===24?ze===0&&et===0:et>=0&&et<60&&ze>=0&&ze<60&&ke>=0&&ke<25}function Re(ke,ze){return ze>=0&&ze<=59}return KM}var QM={},V6;function Ebe(){if(V6)return QM;V6=1,QM.parseJSON=r;var e=Sr();function r(a,u){const p=a.match(/(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(?:\.(\d{0,7}))?(?:Z|(.)(\d{2}):?(\d{2})?)?/);return p?(0,e.toDate)(Date.UTC(+p[1],+p[2]-1,+p[3],+p[4]-(+p[9]||0)*(p[8]=="-"?-1:1),+p[5]-(+p[10]||0)*(p[8]=="-"?-1:1),+p[6],+((p[7]||"0")+"00").substring(0,3)),u?.in):(0,e.toDate)(NaN,u?.in)}return QM}var JM={},U6;function Jm(){if(U6)return JM;U6=1,JM.previousDay=a;var e=PS(),r=MS();function a(u,p,y){let x=(0,e.getDay)(u,y)-p;return x<=0&&(x+=7),(0,r.subDays)(u,x,y)}return JM}var eC={},$6;function Pbe(){if($6)return eC;$6=1,eC.previousFriday=r;var e=Jm();function r(a,u){return(0,e.previousDay)(a,5,u)}return eC}var tC={},W6;function Ibe(){if(W6)return tC;W6=1,tC.previousMonday=r;var e=Jm();function r(a,u){return(0,e.previousDay)(a,1,u)}return tC}var rC={},q6;function Mbe(){if(q6)return rC;q6=1,rC.previousSaturday=r;var e=Jm();function r(a,u){return(0,e.previousDay)(a,6,u)}return rC}var nC={},G6;function Cbe(){if(G6)return nC;G6=1,nC.previousSunday=r;var e=Jm();function r(a,u){return(0,e.previousDay)(a,0,u)}return nC}var iC={},H6;function Abe(){if(H6)return iC;H6=1,iC.previousThursday=r;var e=Jm();function r(a,u){return(0,e.previousDay)(a,4,u)}return iC}var oC={},Y6;function Dbe(){if(Y6)return oC;Y6=1,oC.previousTuesday=r;var e=Jm();function r(a,u){return(0,e.previousDay)(a,2,u)}return oC}var sC={},Z6;function Rbe(){if(Z6)return sC;Z6=1,sC.previousWednesday=r;var e=Jm();function r(a,u){return(0,e.previousDay)(a,3,u)}return sC}var aC={},X6;function Obe(){if(X6)return aC;X6=1,aC.quartersToMonths=r;var e=Vi();function r(a){return Math.trunc(a*e.monthsInQuarter)}return aC}var lC={},K6;function Lbe(){if(K6)return lC;K6=1,lC.quartersToYears=r;var e=Vi();function r(a){const u=a/e.quartersInYear;return Math.trunc(u)}return lC}var cC={},Q6;function zbe(){if(Q6)return cC;Q6=1,cC.roundToNearestHours=u;var e=Km(),r=Nn(),a=Sr();function u(p,y){const x=y?.nearestTo??1;if(x<1||x>12)return(0,r.constructFrom)(y?.in||p,NaN);const i=(0,a.toDate)(p,y?.in),C=i.getMinutes()/60,R=i.getSeconds()/60/60,z=i.getMilliseconds()/1e3/60/60,F=i.getHours()+C+R+z,V=y?.roundingMethod??"round",H=(0,e.getRoundingMethod)(V)(F/x)*x;return i.setHours(H,0,0,0),i}return cC}var uC={},J6;function Fbe(){if(J6)return uC;J6=1,uC.roundToNearestMinutes=u;var e=Km(),r=Nn(),a=Sr();function u(p,y){const x=y?.nearestTo??1;if(x<1||x>30)return(0,r.constructFrom)(p,NaN);const i=(0,a.toDate)(p,y?.in),C=i.getSeconds()/60,R=i.getMilliseconds()/1e3/60,z=i.getMinutes()+C+R,F=y?.roundingMethod??"round",G=(0,e.getRoundingMethod)(F)(z/x)*x;return i.setMinutes(G,0,0),i}return uC}var dC={},eU;function kbe(){if(eU)return dC;eU=1,dC.secondsToHours=r;var e=Vi();function r(a){const u=a/e.secondsInHour;return Math.trunc(u)}return dC}var hC={},tU;function Bbe(){if(tU)return hC;tU=1,hC.secondsToMilliseconds=r;var e=Vi();function r(a){return a*e.millisecondsInSecond}return hC}var fC={},rU;function jbe(){if(rU)return fC;rU=1,fC.secondsToMinutes=r;var e=Vi();function r(a){const u=a/e.secondsInMinute;return Math.trunc(u)}return fC}var pC={},mC={},nU;function _O(){if(nU)return mC;nU=1,mC.setMonth=u;var e=Nn(),r=g9(),a=Sr();function u(p,y,x){const i=(0,a.toDate)(p,x?.in),C=i.getFullYear(),R=i.getDate(),z=(0,e.constructFrom)(x?.in||p,0);z.setFullYear(C,y,15),z.setHours(0,0,0,0);const F=(0,r.getDaysInMonth)(z);return i.setMonth(y,Math.min(R,F)),i}return mC}var iU;function Nbe(){if(iU)return pC;iU=1,pC.set=u;var e=Nn(),r=_O(),a=Sr();function u(p,y,x){let i=(0,a.toDate)(p,x?.in);return isNaN(+i)?(0,e.constructFrom)(x?.in||p,NaN):(y.year!=null&&i.setFullYear(y.year),y.month!=null&&(i=(0,r.setMonth)(i,y.month)),y.date!=null&&i.setDate(y.date),y.hours!=null&&i.setHours(y.hours),y.minutes!=null&&i.setMinutes(y.minutes),y.seconds!=null&&i.setSeconds(y.seconds),y.milliseconds!=null&&i.setMilliseconds(y.milliseconds),i)}return pC}var gC={},oU;function Vbe(){if(oU)return gC;oU=1,gC.setDate=r;var e=Sr();function r(a,u,p){const y=(0,e.toDate)(a,p?.in);return y.setDate(u),y}return gC}var _C={},sU;function Ube(){if(sU)return _C;sU=1,_C.setDayOfYear=r;var e=Sr();function r(a,u,p){const y=(0,e.toDate)(a,p?.in);return y.setMonth(0),y.setDate(u),y}return _C}var yC={},aU;function $be(){if(aU)return yC;aU=1,yC.setDefaultOptions=r;var e=eu();function r(a){const u={},p=(0,e.getDefaultOptions)();for(const y in p)Object.prototype.hasOwnProperty.call(p,y)&&(u[y]=p[y]);for(const y in a)Object.prototype.hasOwnProperty.call(a,y)&&(a[y]===void 0?delete u[y]:u[y]=a[y]);(0,e.setDefaultOptions)(u)}return yC}var vC={},lU;function Wbe(){if(lU)return vC;lU=1,vC.setHours=r;var e=Sr();function r(a,u,p){const y=(0,e.toDate)(a,p?.in);return y.setHours(u),y}return vC}var xC={},cU;function qbe(){if(cU)return xC;cU=1,xC.setMilliseconds=r;var e=Sr();function r(a,u,p){const y=(0,e.toDate)(a,p?.in);return y.setMilliseconds(u),y}return xC}var bC={},uU;function Gbe(){if(uU)return bC;uU=1,bC.setMinutes=r;var e=Sr();function r(a,u,p){const y=(0,e.toDate)(a,p?.in);return y.setMinutes(u),y}return bC}var wC={},dU;function Hbe(){if(dU)return wC;dU=1,wC.setQuarter=a;var e=_O(),r=Sr();function a(u,p,y){const x=(0,r.toDate)(u,y?.in),i=Math.trunc(x.getMonth()/3)+1,C=p-i;return(0,e.setMonth)(x,x.getMonth()+C*3)}return wC}var SC={},hU;function Ybe(){if(hU)return SC;hU=1,SC.setSeconds=r;var e=Sr();function r(a,u,p){const y=(0,e.toDate)(a,p?.in);return y.setSeconds(u),y}return SC}var TC={},fU;function Zbe(){if(fU)return TC;fU=1,TC.setWeekYear=y;var e=eu(),r=Nn(),a=Zm(),u=pO(),p=Sr();function y(x,i,C){const R=(0,e.getDefaultOptions)(),z=C?.firstWeekContainsDate??C?.locale?.options?.firstWeekContainsDate??R.firstWeekContainsDate??R.locale?.options?.firstWeekContainsDate??1,F=(0,a.differenceInCalendarDays)((0,p.toDate)(x,C?.in),(0,u.startOfWeekYear)(x,C),C),V=(0,r.constructFrom)(C?.in||x,0);V.setFullYear(i,0,z),V.setHours(0,0,0,0);const G=(0,u.startOfWeekYear)(V,C);return G.setDate(G.getDate()+F),G}return TC}var EC={},pU;function Xbe(){if(pU)return EC;pU=1,EC.setYear=a;var e=Nn(),r=Sr();function a(u,p,y){const x=(0,r.toDate)(u,y?.in);return isNaN(+x)?(0,e.constructFrom)(y?.in||u,NaN):(x.setFullYear(p),x)}return EC}var PC={},mU;function Kbe(){if(mU)return PC;mU=1,PC.startOfDecade=r;var e=Sr();function r(a,u){const p=(0,e.toDate)(a,u?.in),y=p.getFullYear(),x=Math.floor(y/10)*10;return p.setFullYear(x,0,1),p.setHours(0,0,0,0),p}return PC}var IC={},gU;function Qbe(){if(gU)return IC;gU=1,IC.startOfToday=r;var e=xS();function r(a){return(0,e.startOfDay)(Date.now(),a)}return IC}var MC={},_U;function Jbe(){if(_U)return MC;_U=1,MC.startOfTomorrow=a;var e=Nn(),r=Ml();function a(u){const p=(0,r.constructNow)(u?.in),y=p.getFullYear(),x=p.getMonth(),i=p.getDate(),C=(0,e.constructFrom)(u?.in,0);return C.setFullYear(y,x,i+1),C.setHours(0,0,0,0),C}return MC}var CC={},yU;function e1e(){if(yU)return CC;yU=1,CC.startOfYesterday=r;var e=Ml();function r(a){const u=(0,e.constructNow)(a?.in),p=u.getFullYear(),y=u.getMonth(),x=u.getDate(),i=(0,e.constructNow)(a?.in);return i.setFullYear(p,y,x-1),i.setHours(0,0,0,0),i}return CC}var AC={},DC={},vU;function B9(){if(vU)return DC;vU=1,DC.subMonths=r;var e=Rx();function r(a,u,p){return(0,e.addMonths)(a,-u,p)}return DC}var xU;function t1e(){if(xU)return AC;xU=1,AC.sub=u;var e=Nn(),r=MS(),a=B9();function u(p,y,x){const{years:i=0,months:C=0,weeks:R=0,days:z=0,hours:F=0,minutes:V=0,seconds:G=0}=y,H=(0,a.subMonths)(p,C+i*12,x),Z=(0,r.subDays)(H,z+R*7,x),J=V+F*60,pe=(G+J*60)*1e3;return(0,e.constructFrom)(x?.in||p,+Z-pe)}return AC}var RC={},bU;function r1e(){if(bU)return RC;bU=1,RC.subBusinessDays=r;var e=UH();function r(a,u,p){return(0,e.addBusinessDays)(a,-u,p)}return RC}var OC={},wU;function n1e(){if(wU)return OC;wU=1,OC.subHours=r;var e=$H();function r(a,u,p){return(0,e.addHours)(a,-u,p)}return OC}var LC={},SU;function i1e(){if(SU)return LC;SU=1,LC.subMilliseconds=r;var e=vS();function r(a,u,p){return(0,e.addMilliseconds)(a,-u,p)}return LC}var zC={},TU;function o1e(){if(TU)return zC;TU=1,zC.subMinutes=r;var e=JR();function r(a,u,p){return(0,e.addMinutes)(a,-u,p)}return zC}var FC={},EU;function s1e(){if(EU)return FC;EU=1,FC.subQuarters=r;var e=eO();function r(a,u,p){return(0,e.addQuarters)(a,-u,p)}return FC}var kC={},PU;function a1e(){if(PU)return kC;PU=1,kC.subSeconds=r;var e=GH();function r(a,u,p){return(0,e.addSeconds)(a,-u,p)}return kC}var BC={},IU;function l1e(){if(IU)return BC;IU=1,BC.subWeeks=r;var e=bS();function r(a,u,p){return(0,e.addWeeks)(a,-u,p)}return BC}var jC={},MU;function c1e(){if(MU)return jC;MU=1,jC.subYears=r;var e=HH();function r(a,u,p){return(0,e.addYears)(a,-u,p)}return jC}var NC={},CU;function u1e(){if(CU)return NC;CU=1,NC.weeksToDays=r;var e=Vi();function r(a){return Math.trunc(a*e.daysInWeek)}return NC}var VC={},AU;function d1e(){if(AU)return VC;AU=1,VC.yearsToDays=r;var e=Vi();function r(a){return Math.trunc(a*e.daysInYear)}return VC}var UC={},DU;function h1e(){if(DU)return UC;DU=1,UC.yearsToMonths=r;var e=Vi();function r(a){return Math.trunc(a*e.monthsInYear)}return UC}var $C={},RU;function f1e(){if(RU)return $C;RU=1,$C.yearsToQuarters=r;var e=Vi();function r(a){return Math.trunc(a*e.quartersInYear)}return $C}var OU;function b_(){return OU||(OU=1,(function(e){var r=jH();Object.keys(r).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===r[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return r[T]}})});var a=UH();Object.keys(a).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===a[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return a[T]}})});var u=Np();Object.keys(u).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===u[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return u[T]}})});var p=$H();Object.keys(p).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===p[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return p[T]}})});var y=qH();Object.keys(y).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===y[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return y[T]}})});var x=vS();Object.keys(x).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===x[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return x[T]}})});var i=JR();Object.keys(i).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===i[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return i[T]}})});var C=Rx();Object.keys(C).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===C[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return C[T]}})});var R=eO();Object.keys(R).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===R[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return R[T]}})});var z=GH();Object.keys(z).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===z[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return z[T]}})});var F=bS();Object.keys(F).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===F[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return F[T]}})});var V=HH();Object.keys(V).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===V[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return V[T]}})});var G=kve();Object.keys(G).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===G[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return G[T]}})});var H=Bve();Object.keys(H).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===H[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return H[T]}})});var Z=XH();Object.keys(Z).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Z[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Z[T]}})});var J=jve();Object.keys(J).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===J[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return J[T]}})});var se=Jy();Object.keys(se).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===se[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return se[T]}})});var pe=Nve();Object.keys(pe).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===pe[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return pe[T]}})});var ve=Nn();Object.keys(ve).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ve[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ve[T]}})});var Ne=Ml();Object.keys(Ne).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ne[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ne[T]}})});var _e=Vve();Object.keys(_e).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===_e[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return _e[T]}})});var Re=Uve();Object.keys(Re).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Re[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Re[T]}})});var ke=Zm();Object.keys(ke).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ke[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ke[T]}})});var ze=QH();Object.keys(ze).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ze[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ze[T]}})});var et=$ve();Object.keys(et).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===et[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return et[T]}})});var ht=tO();Object.keys(ht).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ht[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ht[T]}})});var Xt=e9();Object.keys(Xt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Xt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Xt[T]}})});var Ir=rO();Object.keys(Ir).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ir[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ir[T]}})});var nr=nO();Object.keys(nr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===nr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return nr[T]}})});var Fr=iO();Object.keys(Fr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Fr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Fr[T]}})});var Or=oO();Object.keys(Or).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Or[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Or[T]}})});var or=Wve();Object.keys(or).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===or[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return or[T]}})});var lt=sO();Object.keys(lt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===lt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return lt[T]}})});var Et=aO();Object.keys(Et).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Et[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Et[T]}})});var qt=wS();Object.keys(qt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===qt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return qt[T]}})});var Gt=qve();Object.keys(Gt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Gt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Gt[T]}})});var tt=SS();Object.keys(tt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===tt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return tt[T]}})});var ct=Gve();Object.keys(ct).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ct[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ct[T]}})});var _t=n9();Object.keys(_t).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===_t[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return _t[T]}})});var Vt=i9();Object.keys(Vt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Vt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Vt[T]}})});var bt=Hve();Object.keys(bt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===bt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return bt[T]}})});var ar=Yve();Object.keys(ar).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ar[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ar[T]}})});var hr=Zve();Object.keys(hr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===hr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return hr[T]}})});var xr=Xve();Object.keys(xr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===xr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return xr[T]}})});var sr=Kve();Object.keys(sr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===sr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return sr[T]}})});var Br=dO();Object.keys(Br).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Br[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Br[T]}})});var hn=Qve();Object.keys(hn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===hn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return hn[T]}})});var Vn=Jve();Object.keys(Vn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Vn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Vn[T]}})});var Yr=e0e();Object.keys(Yr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Yr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Yr[T]}})});var Un=lO();Object.keys(Un).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Un[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Un[T]}})});var Si=t0e();Object.keys(Si).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Si[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Si[T]}})});var di=r0e();Object.keys(di).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===di[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return di[T]}})});var Ii=n0e();Object.keys(Ii).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ii[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ii[T]}})});var Xn=i0e();Object.keys(Xn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Xn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Xn[T]}})});var Go=o0e();Object.keys(Go).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Go[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Go[T]}})});var Lo=cO();Object.keys(Lo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Lo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Lo[T]}})});var co=s0e();Object.keys(co).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===co[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return co[T]}})});var Ko=a0e();Object.keys(Ko).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ko[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ko[T]}})});var ds=l0e();Object.keys(ds).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ds[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ds[T]}})});var Bo=c0e();Object.keys(Bo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Bo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Bo[T]}})});var ra=s9();Object.keys(ra).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ra[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ra[T]}})});var va=o9();Object.keys(va).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===va[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return va[T]}})});var xa=u0e();Object.keys(xa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===xa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return xa[T]}})});var Bs=h9();Object.keys(Bs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Bs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Bs[T]}})});var Qo=f9();Object.keys(Qo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Qo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Qo[T]}})});var na=p9();Object.keys(na).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===na[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return na[T]}})});var hs=b0e();Object.keys(hs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===hs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return hs[T]}})});var Cl=w0e();Object.keys(Cl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Cl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Cl[T]}})});var Al=S0e();Object.keys(Al).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Al[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Al[T]}})});var io=T0e();Object.keys(io).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===io[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return io[T]}})});var js=E0e();Object.keys(js).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===js[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return js[T]}})});var ba=P0e();Object.keys(ba).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ba[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ba[T]}})});var wa=I0e();Object.keys(wa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===wa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return wa[T]}})});var Ps=M0e();Object.keys(Ps).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ps[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ps[T]}})});var Is=C0e();Object.keys(Is).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Is[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Is[T]}})});var _i=A0e();Object.keys(_i).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===_i[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return _i[T]}})});var Zi=m9();Object.keys(Zi).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Zi[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Zi[T]}})});var ia=PS();Object.keys(ia).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ia[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ia[T]}})});var fs=l9();Object.keys(fs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===fs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return fs[T]}})});var Ms=g9();Object.keys(Ms).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ms[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ms[T]}})});var Dc=D0e();Object.keys(Dc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Dc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Dc[T]}})});var rc=R0e();Object.keys(rc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===rc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return rc[T]}})});var ru=y9();Object.keys(ru).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ru[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ru[T]}})});var ll=O0e();Object.keys(ll).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ll[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ll[T]}})});var St=v9();Object.keys(St).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===St[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return St[T]}})});var Ns=fO();Object.keys(Ns).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ns[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ns[T]}})});var Dl=x_();Object.keys(Dl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Dl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Dl[T]}})});var Ka=L0e();Object.keys(Ka).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ka[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ka[T]}})});var vn=z0e();Object.keys(vn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===vn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return vn[T]}})});var So=F0e();Object.keys(So).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===So[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return So[T]}})});var Sa=k0e();Object.keys(Sa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Sa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Sa[T]}})});var cl=B0e();Object.keys(cl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===cl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return cl[T]}})});var qe=JH();Object.keys(qe).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===qe[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return qe[T]}})});var ie=j0e();Object.keys(ie).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ie[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ie[T]}})});var le=N0e();Object.keys(le).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===le[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return le[T]}})});var we=V0e();Object.keys(we).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===we[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return we[T]}})});var Oe=mO();Object.keys(Oe).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Oe[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Oe[T]}})});var Le=U0e();Object.keys(Le).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Le[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Le[T]}})});var Ue=ES();Object.keys(Ue).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ue[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ue[T]}})});var nt=$0e();Object.keys(nt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===nt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return nt[T]}})});var We=W0e();Object.keys(We).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===We[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return We[T]}})});var Je=q0e();Object.keys(Je).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Je[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Je[T]}})});var Ot=G0e();Object.keys(Ot).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ot[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ot[T]}})});var Pt=H0e();Object.keys(Pt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Pt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Pt[T]}})});var gr=Y0e();Object.keys(gr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===gr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return gr[T]}})});var jr=Z0e();Object.keys(jr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===jr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return jr[T]}})});var yr=X0e();Object.keys(yr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===yr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return yr[T]}})});var Cr=K0e();Object.keys(Cr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Cr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Cr[T]}})});var Zr=Q0e();Object.keys(Zr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Zr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Zr[T]}})});var on=J0e();Object.keys(on).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===on[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return on[T]}})});var Cn=KH();Object.keys(Cn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Cn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Cn[T]}})});var Mi=exe();Object.keys(Mi).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Mi[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Mi[T]}})});var Qi=txe();Object.keys(Qi).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Qi[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Qi[T]}})});var Ti=rxe();Object.keys(Ti).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ti[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ti[T]}})});var si=nxe();Object.keys(si).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===si[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return si[T]}})});var Ln=ixe();Object.keys(Ln).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ln[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ln[T]}})});var rn=r9();Object.keys(rn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===rn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return rn[T]}})});var fi=_9();Object.keys(fi).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===fi[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return fi[T]}})});var Ei=kxe();Object.keys(Ei).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ei[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ei[T]}})});var $n=Bxe();Object.keys($n).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===$n[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return $n[T]}})});var ii=jxe();Object.keys(ii).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ii[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ii[T]}})});var Ji=Lx();Object.keys(Ji).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ji[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ji[T]}})});var To=M9();Object.keys(To).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===To[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return To[T]}})});var ps=C9();Object.keys(ps).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ps[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ps[T]}})});var Oa=Nxe();Object.keys(Oa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Oa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Oa[T]}})});var uo=D9();Object.keys(uo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===uo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return uo[T]}})});var Cs=R9();Object.keys(Cs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Cs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Cs[T]}})});var Jo=O9();Object.keys(Jo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Jo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Jo[T]}})});var As=z9();Object.keys(As).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===As[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return As[T]}})});var Ho=gO();Object.keys(Ho).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ho[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ho[T]}})});var Ds=F9();Object.keys(Ds).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ds[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ds[T]}})});var nc=NH();Object.keys(nc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===nc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return nc[T]}})});var yi=VH();Object.keys(yi).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===yi[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return yi[T]}})});var ic=Vxe();Object.keys(ic).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ic[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ic[T]}})});var oc=Uxe();Object.keys(oc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===oc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return oc[T]}})});var es=$xe();Object.keys(es).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===es[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return es[T]}})});var Rs=Wxe();Object.keys(Rs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Rs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Rs[T]}})});var ts=qxe();Object.keys(ts).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ts[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ts[T]}})});var Os=Gxe();Object.keys(Os).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Os[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Os[T]}})});var Ta=Hxe();Object.keys(Ta).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ta[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ta[T]}})});var Vs=Yxe();Object.keys(Vs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Vs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Vs[T]}})});var Us=Zxe();Object.keys(Us).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Us[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Us[T]}})});var $s=Xxe();Object.keys($s).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===$s[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return $s[T]}})});var jo=Kxe();Object.keys(jo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===jo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return jo[T]}})});var oa=Qxe();Object.keys(oa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===oa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return oa[T]}})});var ul=Xm();Object.keys(ul).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ul[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ul[T]}})});var Ea=Jxe();Object.keys(Ea).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ea[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ea[T]}})});var Ws=yS();Object.keys(Ws).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ws[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ws[T]}})});var La=ebe();Object.keys(La).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===La[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return La[T]}})});var ms=tbe();Object.keys(ms).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ms[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ms[T]}})});var Rl=rbe();Object.keys(Rl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Rl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Rl[T]}})});var Rc=nbe();Object.keys(Rc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Rc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Rc[T]}})});var dl=ibe();Object.keys(dl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===dl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return dl[T]}})});var hl=x9();Object.keys(hl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===hl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return hl[T]}})});var bn=obe();Object.keys(bn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===bn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return bn[T]}})});var Ol=k9();Object.keys(Ol).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ol[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ol[T]}})});var za=sbe();Object.keys(za).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===za[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return za[T]}})});var Fa=abe();Object.keys(Fa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Fa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Fa[T]}})});var Ge=YH();Object.keys(Ge).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ge[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ge[T]}})});var yt=lbe();Object.keys(yt).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===yt[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return yt[T]}})});var Ht=cbe();Object.keys(Ht).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ht[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ht[T]}})});var Xr=ube();Object.keys(Xr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Xr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Xr[T]}})});var jn=dbe();Object.keys(jn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===jn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return jn[T]}})});var Ri=ZH();Object.keys(Ri).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ri[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ri[T]}})});var Ui=hbe();Object.keys(Ui).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ui[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ui[T]}})});var ai=fbe();Object.keys(ai).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ai[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ai[T]}})});var Oi=pbe();Object.keys(Oi).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Oi[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Oi[T]}})});var eo=mbe();Object.keys(eo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===eo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return eo[T]}})});var Yo=gbe();Object.keys(Yo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Yo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Yo[T]}})});var qs=Qm();Object.keys(qs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===qs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return qs[T]}})});var ka=_be();Object.keys(ka).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ka[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ka[T]}})});var sa=ybe();Object.keys(sa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===sa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return sa[T]}})});var pi=vbe();Object.keys(pi).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===pi[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return pi[T]}})});var sc=xbe();Object.keys(sc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===sc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return sc[T]}})});var Iu=bbe();Object.keys(Iu).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Iu[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Iu[T]}})});var Oc=wbe();Object.keys(Oc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Oc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Oc[T]}})});var zn=Sbe();Object.keys(zn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===zn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return zn[T]}})});var Mu=P9();Object.keys(Mu).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Mu[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Mu[T]}})});var rd=Tbe();Object.keys(rd).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===rd[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return rd[T]}})});var nu=Ebe();Object.keys(nu).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===nu[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return nu[T]}})});var Lr=Jm();Object.keys(Lr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Lr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Lr[T]}})});var iu=Pbe();Object.keys(iu).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===iu[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return iu[T]}})});var Ll=Ibe();Object.keys(Ll).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ll[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ll[T]}})});var Ba=Mbe();Object.keys(Ba).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ba[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ba[T]}})});var ja=Cbe();Object.keys(ja).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ja[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ja[T]}})});var ac=Abe();Object.keys(ac).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ac[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ac[T]}})});var br=Dbe();Object.keys(br).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===br[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return br[T]}})});var wn=Rbe();Object.keys(wn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===wn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return wn[T]}})});var Dn=Obe();Object.keys(Dn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Dn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Dn[T]}})});var aa=Lbe();Object.keys(aa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===aa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return aa[T]}})});var ou=zbe();Object.keys(ou).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ou[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ou[T]}})});var Fn=Fbe();Object.keys(Fn).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Fn[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Fn[T]}})});var Cu=kbe();Object.keys(Cu).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Cu[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Cu[T]}})});var Lc=Bbe();Object.keys(Lc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Lc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Lc[T]}})});var Au=jbe();Object.keys(Au).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Au[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Au[T]}})});var Zo=Nbe();Object.keys(Zo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Zo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Zo[T]}})});var ho=Vbe();Object.keys(ho).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ho[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ho[T]}})});var Bf=IS();Object.keys(Bf).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Bf[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Bf[T]}})});var Du=Ube();Object.keys(Du).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Du[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Du[T]}})});var zd=$be();Object.keys(zd).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===zd[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return zd[T]}})});var su=Wbe();Object.keys(su).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===su[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return su[T]}})});var nd=E9();Object.keys(nd).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===nd[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return nd[T]}})});var Fd=T9();Object.keys(Fd).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Fd[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Fd[T]}})});var Ru=WH();Object.keys(Ru).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ru[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ru[T]}})});var No=qbe();Object.keys(No).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===No[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return No[T]}})});var zl=Gbe();Object.keys(zl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===zl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return zl[T]}})});var Gs=_O();Object.keys(Gs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Gs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Gs[T]}})});var id=Hbe();Object.keys(id).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===id[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return id[T]}})});var lc=Ybe();Object.keys(lc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===lc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return lc[T]}})});var fo=S9();Object.keys(fo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===fo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return fo[T]}})});var fl=Zbe();Object.keys(fl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===fl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return fl[T]}})});var pl=Xbe();Object.keys(pl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===pl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return pl[T]}})});var Xi=xS();Object.keys(Xi).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Xi[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Xi[T]}})});var en=Kbe();Object.keys(en).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===en[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return en[T]}})});var pr=I9();Object.keys(pr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===pr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return pr[T]}})});var cc=Vp();Object.keys(cc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===cc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return cc[T]}})});var Nr=Ox();Object.keys(Nr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Nr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Nr[T]}})});var au=A9();Object.keys(au).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===au[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return au[T]}})});var od=TS();Object.keys(od).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===od[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return od[T]}})});var Vr=uO();Object.keys(Vr).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Vr[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Vr[T]}})});var lu=L9();Object.keys(lu).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===lu[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return lu[T]}})});var Ou=Qbe();Object.keys(Ou).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Ou[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Ou[T]}})});var cu=Jbe();Object.keys(cu).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===cu[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return cu[T]}})});var la=kf();Object.keys(la).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===la[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return la[T]}})});var sd=pO();Object.keys(sd).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===sd[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return sd[T]}})});var Eo=hO();Object.keys(Eo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Eo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Eo[T]}})});var gs=e1e();Object.keys(gs).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===gs[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return gs[T]}})});var uc=t1e();Object.keys(uc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===uc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return uc[T]}})});var dc=r1e();Object.keys(dc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===dc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return dc[T]}})});var Qa=MS();Object.keys(Qa).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Qa[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Qa[T]}})});var Vo=n1e();Object.keys(Vo).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Vo[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Vo[T]}})});var Rh=t9();Object.keys(Rh).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Rh[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Rh[T]}})});var Oh=i1e();Object.keys(Oh).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Oh[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Oh[T]}})});var Lu=o1e();Object.keys(Lu).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Lu[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Lu[T]}})});var hc=B9();Object.keys(hc).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===hc[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return hc[T]}})});var Lh=s1e();Object.keys(Lh).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Lh[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Lh[T]}})});var Na=a1e();Object.keys(Na).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Na[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Na[T]}})});var zh=l1e();Object.keys(zh).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===zh[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return zh[T]}})});var ca=c1e();Object.keys(ca).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ca[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ca[T]}})});var Fl=Sr();Object.keys(Fl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Fl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Fl[T]}})});var kl=b9();Object.keys(kl).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===kl[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return kl[T]}})});var Fh=u1e();Object.keys(Fh).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===Fh[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return Fh[T]}})});var kd=d1e();Object.keys(kd).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===kd[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return kd[T]}})});var kh=h1e();Object.keys(kh).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===kh[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return kh[T]}})});var ml=f1e();Object.keys(ml).forEach(function(T){T==="default"||T==="__esModule"||T in e&&e[T]===ml[T]||Object.defineProperty(e,T,{enumerable:!0,get:function(){return ml[T]}})})})(iE)),iE}var LU;function CS(){if(LU)return zg;LU=1,Object.defineProperty(zg,"__esModule",{value:!0}),zg.rangeShape=zg.default=void 0;var e=x(Ld()),r=p(jp()),a=p(v_()),u=b_();function p(G){return G&&G.__esModule?G:{default:G}}function y(G){if(typeof WeakMap!="function")return null;var H=new WeakMap,Z=new WeakMap;return(y=function(J){return J?Z:H})(G)}function x(G,H){if(G&&G.__esModule)return G;if(G===null||typeof G!="object"&&typeof G!="function")return{default:G};var Z=y(H);if(Z&&Z.has(G))return Z.get(G);var J={__proto__:null},se=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var pe in G)if(pe!=="default"&&Object.prototype.hasOwnProperty.call(G,pe)){var ve=se?Object.getOwnPropertyDescriptor(G,pe):null;ve&&(ve.get||ve.set)?Object.defineProperty(J,pe,ve):J[pe]=G[pe]}return J.default=G,Z&&Z.set(G,J),J}function i(){return i=Object.assign?Object.assign.bind():function(G){for(var H=1;H<arguments.length;H++){var Z=arguments[H];for(var J in Z)Object.prototype.hasOwnProperty.call(Z,J)&&(G[J]=Z[J])}return G},i.apply(this,arguments)}function C(G,H,Z){return H=R(H),H in G?Object.defineProperty(G,H,{value:Z,enumerable:!0,configurable:!0,writable:!0}):G[H]=Z,G}function R(G){var H=z(G,"string");return typeof H=="symbol"?H:String(H)}function z(G,H){if(typeof G!="object"||!G)return G;var Z=G[Symbol.toPrimitive];if(Z!==void 0){var J=Z.call(G,H);if(typeof J!="object")return J;throw new TypeError("@@toPrimitive must return a primitive value.")}return(H==="string"?String:Number)(G)}let F=class extends e.Component{constructor(H,Z){super(H,Z),C(this,"handleKeyEvent",J=>{const{day:se,onMouseDown:pe,onMouseUp:ve}=this.props;[13,32].includes(J.keyCode)&&(J.type==="keydown"?pe(se):ve(se))}),C(this,"handleMouseEvent",J=>{const{day:se,disabled:pe,onPreviewChange:ve,onMouseEnter:Ne,onMouseDown:_e,onMouseUp:Re}=this.props,ke={};if(pe){ve();return}switch(J.type){case"mouseenter":Ne(se),ve(se),ke.hover=!0;break;case"blur":case"mouseleave":ke.hover=!1;break;case"mousedown":ke.active=!0,_e(se);break;case"mouseup":J.stopPropagation(),ke.active=!1,Re(se);break;case"focus":ve(se);break}Object.keys(ke).length&&this.setState(ke)}),C(this,"getClassNames",()=>{const{isPassive:J,isToday:se,isWeekend:pe,isStartOfWeek:ve,isEndOfWeek:Ne,isStartOfMonth:_e,isEndOfMonth:Re,disabled:ke,styles:ze}=this.props;return(0,a.default)(ze.day,{[ze.dayPassive]:J,[ze.dayDisabled]:ke,[ze.dayToday]:se,[ze.dayWeekend]:pe,[ze.dayStartOfWeek]:ve,[ze.dayEndOfWeek]:Ne,[ze.dayStartOfMonth]:_e,[ze.dayEndOfMonth]:Re,[ze.dayHovered]:this.state.hover,[ze.dayActive]:this.state.active})}),C(this,"renderPreviewPlaceholder",()=>{const{preview:J,day:se,styles:pe}=this.props;if(!J)return null;const ve=J.startDate?(0,u.endOfDay)(J.startDate):null,Ne=J.endDate?(0,u.startOfDay)(J.endDate):null,_e=(!ve||(0,u.isAfter)(se,ve))&&(!Ne||(0,u.isBefore)(se,Ne)),Re=!_e&&(0,u.isSameDay)(se,ve),ke=!_e&&(0,u.isSameDay)(se,Ne);return e.default.createElement("span",{className:(0,a.default)({[pe.dayStartPreview]:Re,[pe.dayInPreview]:_e,[pe.dayEndPreview]:ke}),style:{color:J.color}})}),C(this,"renderSelectionPlaceholders",()=>{const{styles:J,ranges:se,day:pe}=this.props;return this.props.displayMode==="date"?(0,u.isSameDay)(this.props.day,this.props.date)?e.default.createElement("span",{className:J.selected,style:{color:this.props.color}}):null:se.reduce((Ne,_e)=>{let Re=_e.startDate,ke=_e.endDate;Re&&ke&&(0,u.isBefore)(ke,Re)&&([Re,ke]=[ke,Re]),Re=Re?(0,u.endOfDay)(Re):null,ke=ke?(0,u.startOfDay)(ke):null;const ze=(!Re||(0,u.isAfter)(pe,Re))&&(!ke||(0,u.isBefore)(pe,ke)),et=!ze&&(0,u.isSameDay)(pe,Re),ht=!ze&&(0,u.isSameDay)(pe,ke);return ze||et||ht?[...Ne,{isStartEdge:et,isEndEdge:ht,isInRange:ze,..._e}]:Ne},[]).map((Ne,_e)=>e.default.createElement("span",{key:_e,className:(0,a.default)({[J.startEdge]:Ne.isStartEdge,[J.endEdge]:Ne.isEndEdge,[J.inRange]:Ne.isInRange}),style:{color:Ne.color||this.props.color}}))}),this.state={hover:!1,active:!1}}render(){const{dayContentRenderer:H}=this.props;return e.default.createElement("button",i({type:"button",onMouseEnter:this.handleMouseEvent,onMouseLeave:this.handleMouseEvent,onFocus:this.handleMouseEvent,onMouseDown:this.handleMouseEvent,onMouseUp:this.handleMouseEvent,onBlur:this.handleMouseEvent,onPauseCapture:this.handleMouseEvent,onKeyDown:this.handleKeyEvent,onKeyUp:this.handleKeyEvent,className:this.getClassNames(this.props.styles)},this.props.disabled||this.props.isPassive?{tabIndex:-1}:{},{style:{color:this.props.color}}),this.renderSelectionPlaceholders(),this.renderPreviewPlaceholder(),e.default.createElement("span",{className:this.props.styles.dayNumber},H?.(this.props.day)||e.default.createElement("span",null,(0,u.format)(this.props.day,this.props.dayDisplayFormat))))}};F.defaultProps={};const V=zg.rangeShape=r.default.shape({startDate:r.default.object,endDate:r.default.object,color:r.default.string,key:r.default.string,autoFocus:r.default.bool,disabled:r.default.bool,showDateDisplay:r.default.bool});return F.propTypes={day:r.default.object.isRequired,dayDisplayFormat:r.default.string,date:r.default.object,ranges:r.default.arrayOf(V),preview:r.default.shape({startDate:r.default.object,endDate:r.default.object,color:r.default.string}),onPreviewChange:r.default.func,previewColor:r.default.string,disabled:r.default.bool,isPassive:r.default.bool,isToday:r.default.bool,isWeekend:r.default.bool,isStartOfWeek:r.default.bool,isEndOfWeek:r.default.bool,isStartOfMonth:r.default.bool,isEndOfMonth:r.default.bool,color:r.default.string,displayMode:r.default.oneOf(["dateRange","date"]),styles:r.default.object,onMouseDown:r.default.func,onMouseUp:r.default.func,onMouseEnter:r.default.func,dayContentRenderer:r.default.func},zg.default=F,zg}var s0={},Fg={},zU;function AS(){if(zU)return Fg;zU=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.calcFocusDate=u,Fg.findNextRangeIndex=p,Fg.generateStyles=x,Fg.getMonthDisplayRange=y;var e=a(v_()),r=b_();function a(i){return i&&i.__esModule?i:{default:i}}function u(i,C){const{shownDate:R,date:z,months:F,ranges:V,focusedRange:G,displayMode:H}=C;let Z;if(H==="dateRange"){const se=V[G[0]]||{};Z={start:se.startDate,end:se.endDate}}else Z={start:z,end:z};Z.start=(0,r.startOfMonth)(Z.start||new Date),Z.end=(0,r.endOfMonth)(Z.end||Z.start);const J=Z.start||Z.end||R||new Date;return i?(0,r.differenceInCalendarMonths)(Z.start,Z.end)>F?i:J:R||J}function p(i){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const R=i.findIndex((z,F)=>F>C&&z.autoFocus!==!1&&!z.disabled);return R!==-1?R:i.findIndex(z=>z.autoFocus!==!1&&!z.disabled)}function y(i,C,R){const z=(0,r.startOfMonth)(i,C),F=(0,r.endOfMonth)(i,C),V=(0,r.startOfWeek)(z,C);let G=(0,r.endOfWeek)(F,C);return R&&(0,r.differenceInCalendarDays)(G,V)<=34&&(G=(0,r.addDays)(G,7)),{start:V,end:G,startDateOfMonth:z,endDateOfMonth:F}}function x(i){return i.length?i.filter(R=>!!R).reduce((R,z)=>(Object.keys(z).forEach(F=>{R[F]=(0,e.default)(R[F],z[F])}),R),{}):{}}return Fg}var FU;function p1e(){if(FU)return s0;FU=1,Object.defineProperty(s0,"__esModule",{value:!0}),s0.default=void 0;var e=i(Ld()),r=y(jp()),a=i(CS()),u=b_(),p=AS();function y(F){return F&&F.__esModule?F:{default:F}}function x(F){if(typeof WeakMap!="function")return null;var V=new WeakMap,G=new WeakMap;return(x=function(H){return H?G:V})(F)}function i(F,V){if(F&&F.__esModule)return F;if(F===null||typeof F!="object"&&typeof F!="function")return{default:F};var G=x(V);if(G&&G.has(F))return G.get(F);var H={__proto__:null},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var J in F)if(J!=="default"&&Object.prototype.hasOwnProperty.call(F,J)){var se=Z?Object.getOwnPropertyDescriptor(F,J):null;se&&(se.get||se.set)?Object.defineProperty(H,J,se):H[J]=F[J]}return H.default=F,G&&G.set(F,H),H}function C(){return C=Object.assign?Object.assign.bind():function(F){for(var V=1;V<arguments.length;V++){var G=arguments[V];for(var H in G)Object.prototype.hasOwnProperty.call(G,H)&&(F[H]=G[H])}return F},C.apply(this,arguments)}function R(F,V,G){const H=new Date;return e.default.createElement("div",{className:F.weekDays},(0,u.eachDayOfInterval)({start:(0,u.startOfWeek)(H,V),end:(0,u.endOfWeek)(H,V)}).map((Z,J)=>e.default.createElement("span",{className:F.weekDay,key:J},(0,u.format)(Z,G,V))))}let z=class extends e.PureComponent{render(){const V=new Date,{displayMode:G,focusedRange:H,drag:Z,styles:J,disabledDates:se,disabledDay:pe}=this.props,ve=this.props.minDate&&(0,u.startOfDay)(this.props.minDate),Ne=this.props.maxDate&&(0,u.endOfDay)(this.props.maxDate),_e=(0,p.getMonthDisplayRange)(this.props.month,this.props.dateOptions,this.props.fixedHeight);let Re=this.props.ranges;if(G==="dateRange"&&Z.status){let{startDate:ze,endDate:et}=Z.range;Re=Re.map((ht,Xt)=>Xt!==H[0]?ht:{...ht,startDate:ze,endDate:et})}const ke=this.props.showPreview&&!Z.disablePreview;return e.default.createElement("div",{className:J.month,style:this.props.style},this.props.showMonthName?e.default.createElement("div",{className:J.monthName},(0,u.format)(this.props.month,this.props.monthDisplayFormat,this.props.dateOptions)):null,this.props.showWeekDays&&R(J,this.props.dateOptions,this.props.weekdayDisplayFormat),e.default.createElement("div",{className:J.days,onMouseLeave:this.props.onMouseLeave},(0,u.eachDayOfInterval)({start:_e.start,end:_e.end}).map((ze,et)=>{const ht=(0,u.isSameDay)(ze,_e.startDateOfMonth),Xt=(0,u.isSameDay)(ze,_e.endDateOfMonth),Ir=ve&&(0,u.isBefore)(ze,ve)||Ne&&(0,u.isAfter)(ze,Ne),nr=se.some(Or=>(0,u.isSameDay)(Or,ze)),Fr=pe(ze);return e.default.createElement(a.default,C({},this.props,{ranges:Re,day:ze,preview:ke?this.props.preview:null,isWeekend:(0,u.isWeekend)(ze,this.props.dateOptions),isToday:(0,u.isSameDay)(ze,V),isStartOfWeek:(0,u.isSameDay)(ze,(0,u.startOfWeek)(ze,this.props.dateOptions)),isEndOfWeek:(0,u.isSameDay)(ze,(0,u.endOfWeek)(ze,this.props.dateOptions)),isStartOfMonth:ht,isEndOfMonth:Xt,key:et,disabled:Ir||nr||Fr,isPassive:!(0,u.isWithinInterval)(ze,{start:_e.startDateOfMonth,end:_e.endDateOfMonth}),styles:J,onMouseDown:this.props.onDragSelectionStart,onMouseUp:this.props.onDragSelectionEnd,onMouseEnter:this.props.onDragSelectionMove,dragRange:Z.range,drag:Z.status}))})))}};return z.defaultProps={},z.propTypes={style:r.default.object,styles:r.default.object,month:r.default.object,drag:r.default.object,dateOptions:r.default.object,disabledDates:r.default.array,disabledDay:r.default.func,preview:r.default.shape({startDate:r.default.object,endDate:r.default.object}),showPreview:r.default.bool,displayMode:r.default.oneOf(["dateRange","date"]),minDate:r.default.object,maxDate:r.default.object,ranges:r.default.arrayOf(a.rangeShape),focusedRange:r.default.arrayOf(r.default.number),onDragSelectionStart:r.default.func,onDragSelectionEnd:r.default.func,onDragSelectionMove:r.default.func,onMouseLeave:r.default.func,monthDisplayFormat:r.default.string,weekdayDisplayFormat:r.default.string,dayDisplayFormat:r.default.string,showWeekDays:r.default.bool,showMonthName:r.default.bool,fixedHeight:r.default.bool},s0.default=z,s0}var a0={},kU;function m1e(){if(kU)return a0;kU=1,Object.defineProperty(a0,"__esModule",{value:!0}),a0.default=void 0;var e=x(Ld()),r=p(jp()),a=p(v_()),u=b_();function p(F){return F&&F.__esModule?F:{default:F}}function y(F){if(typeof WeakMap!="function")return null;var V=new WeakMap,G=new WeakMap;return(y=function(H){return H?G:V})(F)}function x(F,V){if(F&&F.__esModule)return F;if(F===null||typeof F!="object"&&typeof F!="function")return{default:F};var G=y(V);if(G&&G.has(F))return G.get(F);var H={__proto__:null},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var J in F)if(J!=="default"&&Object.prototype.hasOwnProperty.call(F,J)){var se=Z?Object.getOwnPropertyDescriptor(F,J):null;se&&(se.get||se.set)?Object.defineProperty(H,J,se):H[J]=F[J]}return H.default=F,G&&G.set(F,H),H}function i(F,V,G){return V=C(V),V in F?Object.defineProperty(F,V,{value:G,enumerable:!0,configurable:!0,writable:!0}):F[V]=G,F}function C(F){var V=R(F,"string");return typeof V=="symbol"?V:String(V)}function R(F,V){if(typeof F!="object"||!F)return F;var G=F[Symbol.toPrimitive];if(G!==void 0){var H=G.call(F,V);if(typeof H!="object")return H;throw new TypeError("@@toPrimitive must return a primitive value.")}return(V==="string"?String:Number)(F)}let z=class extends e.PureComponent{constructor(V,G){super(V,G),i(this,"onKeyDown",H=>{const{value:Z}=this.state;H.key==="Enter"&&this.update(Z)}),i(this,"onChange",H=>{this.setState({value:H.target.value,changed:!0,invalid:!1})}),i(this,"onBlur",()=>{const{value:H}=this.state;this.update(H)}),this.state={invalid:!1,changed:!1,value:this.formatDate(V)}}componentDidUpdate(V){const{value:G}=V;(0,u.isEqual)(G,this.props.value)||this.setState({value:this.formatDate(this.props)})}formatDate(V){let{value:G,dateDisplayFormat:H,dateOptions:Z}=V;return G&&(0,u.isValid)(G)?(0,u.format)(G,H,Z):""}update(V){const{invalid:G,changed:H}=this.state;if(G||!H||!V)return;const{onChange:Z,dateDisplayFormat:J,dateOptions:se}=this.props,pe=(0,u.parse)(V,J,new Date,se);(0,u.isValid)(pe)?this.setState({changed:!1},()=>Z(pe)):this.setState({invalid:!0})}render(){const{className:V,readOnly:G,placeholder:H,ariaLabel:Z,disabled:J,onFocus:se}=this.props,{value:pe,invalid:ve}=this.state;return e.default.createElement("span",{className:(0,a.default)("rdrDateInput",V)},e.default.createElement("input",{readOnly:G,disabled:J,value:pe,placeholder:H,"aria-label":Z,onKeyDown:this.onKeyDown,onChange:this.onChange,onBlur:this.onBlur,onFocus:se}),ve&&e.default.createElement("span",{className:"rdrWarning"},""))}};return z.propTypes={value:r.default.object,placeholder:r.default.string,disabled:r.default.bool,readOnly:r.default.bool,dateOptions:r.default.object,dateDisplayFormat:r.default.string,ariaLabel:r.default.string,className:r.default.string,onFocus:r.default.func.isRequired,onChange:r.default.func.isRequired},z.defaultProps={readOnly:!0,disabled:!1,dateDisplayFormat:"MMM D, YYYY"},a0.default=z,a0}var V1={},BU;function g1e(){return BU||(BU=1,(function(e){(function(r,a){a(e,Ld(),lW())})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:V1,function(r,a,u){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;function p(ct){"@babel/helpers - typeof";return p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_t){return typeof _t}:function(_t){return _t&&typeof Symbol=="function"&&_t.constructor===Symbol&&_t!==Symbol.prototype?"symbol":typeof _t},p(ct)}function y(ct,_t){if(!(ct instanceof _t))throw new TypeError("Cannot call a class as a function")}function x(ct,_t){for(var Vt=0;Vt<_t.length;Vt++){var bt=_t[Vt];bt.enumerable=bt.enumerable||!1,bt.configurable=!0,"value"in bt&&(bt.writable=!0),Object.defineProperty(ct,pe(bt.key),bt)}}function i(ct,_t,Vt){return _t&&x(ct.prototype,_t),Vt&&x(ct,Vt),Object.defineProperty(ct,"prototype",{writable:!1}),ct}function C(ct,_t,Vt){return _t=V(_t),R(ct,F()?Reflect.construct(_t,Vt||[],V(ct).constructor):_t.apply(ct,Vt))}function R(ct,_t){if(_t&&(p(_t)=="object"||typeof _t=="function"))return _t;if(_t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return z(ct)}function z(ct){if(ct===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ct}function F(){try{var ct=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(F=function(){return!!ct})()}function V(ct){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_t){return _t.__proto__||Object.getPrototypeOf(_t)},V(ct)}function G(ct,_t){if(typeof _t!="function"&&_t!==null)throw new TypeError("Super expression must either be null or a function");ct.prototype=Object.create(_t&&_t.prototype,{constructor:{value:ct,writable:!0,configurable:!0}}),Object.defineProperty(ct,"prototype",{writable:!1}),_t&&H(ct,_t)}function H(ct,_t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Vt,bt){return Vt.__proto__=bt,Vt},H(ct,_t)}function Z(ct,_t){var Vt=Object.keys(ct);if(Object.getOwnPropertySymbols){var bt=Object.getOwnPropertySymbols(ct);_t&&(bt=bt.filter(function(ar){return Object.getOwnPropertyDescriptor(ct,ar).enumerable})),Vt.push.apply(Vt,bt)}return Vt}function J(ct){for(var _t=1;_t<arguments.length;_t++){var Vt=arguments[_t]!=null?arguments[_t]:{};_t%2?Z(Object(Vt),!0).forEach(function(bt){se(ct,bt,Vt[bt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ct,Object.getOwnPropertyDescriptors(Vt)):Z(Object(Vt)).forEach(function(bt){Object.defineProperty(ct,bt,Object.getOwnPropertyDescriptor(Vt,bt))})}return ct}function se(ct,_t,Vt){return(_t=pe(_t))in ct?Object.defineProperty(ct,_t,{value:Vt,enumerable:!0,configurable:!0,writable:!0}):ct[_t]=Vt,ct}function pe(ct){var _t=ve(ct,"string");return p(_t)=="symbol"?_t:_t+""}function ve(ct,_t){if(p(ct)!="object"||!ct)return ct;var Vt=ct[Symbol.toPrimitive];if(Vt!==void 0){var bt=Vt.call(ct,_t);if(p(bt)!="object")return bt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_t==="string"?String:Number)(ct)}var Ne={x:"clientWidth",y:"clientHeight"},_e={x:"clientTop",y:"clientLeft"},Re={x:"innerWidth",y:"innerHeight"},ke={x:"offsetWidth",y:"offsetHeight"},ze={x:"offsetLeft",y:"offsetTop"},et={x:"overflowX",y:"overflowY"},ht={x:"scrollWidth",y:"scrollHeight"},Xt={x:"scrollLeft",y:"scrollTop"},Ir={x:"width",y:"height"},nr=function(){},Fr=(function(){if(typeof window>"u")return!1;var ct=!1;try{document.createElement("div").addEventListener("test",nr,{get passive(){return ct=!0,!1}})}catch{}return ct})()?{passive:!0}:!1,Or="ReactList failed to reach a stable state.",or=40,lt=function(_t,Vt){for(var bt in Vt)if(_t[bt]!==Vt[bt])return!1;return!0},Et=function(_t){for(var Vt=_t.props.axis,bt=_t.getEl(),ar=et[Vt];bt=bt.parentElement;)switch(window.getComputedStyle(bt)[ar]){case"auto":case"scroll":case"overlay":return bt}return window},qt=function(_t){var Vt=_t.props.axis,bt=_t.scrollParent;return bt===window?window[Re[Vt]]:bt[Ne[Vt]]},Gt=function(_t,Vt){var bt=_t.length,ar=_t.minSize,hr=_t.type,xr=Vt.from,sr=Vt.size,Br=Vt.itemsPerRow;sr=Math.max(sr,ar);var hn=sr%Br;return hn&&(sr+=Br-hn),sr>bt&&(sr=bt),xr=hr==="simple"||!xr?0:Math.max(Math.min(xr,bt-sr),0),(hn=xr%Br)&&(xr-=hn,sr+=hn),xr===Vt.from&&sr===Vt.size?Vt:J(J({},Vt),{},{from:xr,size:sr})},tt=r.default=(function(ct){function _t(Vt){var bt;return y(this,_t),bt=C(this,_t,[Vt]),bt.state=Gt(Vt,{itemsPerRow:1,from:Vt.initialIndex,size:0}),bt.cache={},bt.cachedScrollPosition=null,bt.prevPrevState={},bt.unstable=!1,bt.updateCounter=0,bt}return G(_t,ct),i(_t,[{key:"componentDidMount",value:function(){this.updateFrameAndClearCache=this.updateFrameAndClearCache.bind(this),window.addEventListener("resize",this.updateFrameAndClearCache),this.updateFrame(this.scrollTo.bind(this,this.props.initialIndex))}},{key:"componentDidUpdate",value:function(bt){var ar=this;if(this.props.axis!==bt.axis&&this.clearSizeCache(),!this.unstable){if(++this.updateCounter>or)return this.unstable=!0,console.error(Or);this.updateCounterTimeoutId||(this.updateCounterTimeoutId=setTimeout(function(){ar.updateCounter=0,delete ar.updateCounterTimeoutId},0)),this.updateFrame()}}},{key:"maybeSetState",value:function(bt,ar){if(lt(this.state,bt))return ar();this.setState(bt,ar)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateFrameAndClearCache),this.scrollParent.removeEventListener("scroll",this.updateFrameAndClearCache,Fr),this.scrollParent.removeEventListener("mousewheel",nr,Fr)}},{key:"getOffset",value:function(bt){var ar=this.props.axis,hr=bt[_e[ar]]||0,xr=ze[ar];do hr+=bt[xr]||0;while(bt=bt.offsetParent);return hr}},{key:"getEl",value:function(){return this.el||this.items}},{key:"getScrollPosition",value:function(){if(typeof this.cachedScrollPosition=="number")return this.cachedScrollPosition;var bt=this.scrollParent,ar=this.props.axis,hr=Xt[ar],xr=bt===window?document.body[hr]||document.documentElement[hr]:bt[hr],sr=this.getScrollSize()-this.props.scrollParentViewportSizeGetter(this),Br=Math.max(0,Math.min(xr,sr)),hn=this.getEl();return this.cachedScrollPosition=this.getOffset(bt)+Br-this.getOffset(hn),this.cachedScrollPosition}},{key:"setScroll",value:function(bt){var ar=this.scrollParent,hr=this.props.axis;if(bt+=this.getOffset(this.getEl()),ar===window)return window.scrollTo(0,bt);bt-=this.getOffset(this.scrollParent),ar[Xt[hr]]=bt}},{key:"getScrollSize",value:function(){var bt=this.scrollParent,ar=document,hr=ar.body,xr=ar.documentElement,sr=ht[this.props.axis];return bt===window?Math.max(hr[sr],xr[sr]):bt[sr]}},{key:"hasDeterminateSize",value:function(){var bt=this.props,ar=bt.itemSizeGetter,hr=bt.type;return hr==="uniform"||ar}},{key:"getStartAndEnd",value:function(){var bt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.threshold,ar=this.getScrollPosition(),hr=Math.max(0,ar-bt),xr=ar+this.props.scrollParentViewportSizeGetter(this)+bt;return this.hasDeterminateSize()&&(xr=Math.min(xr,this.getSpaceBefore(this.props.length))),{start:hr,end:xr}}},{key:"getItemSizeAndItemsPerRow",value:function(){var bt=this.props,ar=bt.axis,hr=bt.useStaticSize,xr=this.state,sr=xr.itemSize,Br=xr.itemsPerRow;if(hr&&sr&&Br)return{itemSize:sr,itemsPerRow:Br};var hn=this.items.children;if(!hn.length)return{};var Vn=hn[0],Yr=Vn[ke[ar]],Un=Math.abs(Yr-sr);if((isNaN(Un)||Un>=1)&&(sr=Yr),!sr)return{};var Si=ze[ar],di=Vn[Si];Br=1;for(var Ii=hn[Br];Ii&&Ii[Si]===di;Ii=hn[Br])++Br;return{itemSize:sr,itemsPerRow:Br}}},{key:"clearSizeCache",value:function(){this.cachedScrollPosition=null}},{key:"updateFrameAndClearCache",value:function(bt){return this.clearSizeCache(),this.updateFrame(bt)}},{key:"updateFrame",value:function(bt){switch(this.updateScrollParent(),typeof bt!="function"&&(bt=nr),this.props.type){case"simple":return this.updateSimpleFrame(bt);case"variable":return this.updateVariableFrame(bt);case"uniform":return this.updateUniformFrame(bt)}}},{key:"updateScrollParent",value:function(){var bt=this.scrollParent;this.scrollParent=this.props.scrollParentGetter(this),bt!==this.scrollParent&&(bt&&(bt.removeEventListener("scroll",this.updateFrameAndClearCache),bt.removeEventListener("mousewheel",nr)),this.clearSizeCache(),this.scrollParent.addEventListener("scroll",this.updateFrameAndClearCache,Fr),this.scrollParent.addEventListener("mousewheel",nr,Fr))}},{key:"updateSimpleFrame",value:function(bt){var ar=this.getStartAndEnd(),hr=ar.end,xr=this.items.children,sr=0;if(xr.length){var Br=this.props.axis,hn=xr[0],Vn=xr[xr.length-1];sr=this.getOffset(Vn)+Vn[ke[Br]]-this.getOffset(hn)}if(sr>hr)return bt();var Yr=this.props,Un=Yr.pageSize,Si=Yr.length,di=Math.min(this.state.size+Un,Si);this.maybeSetState({size:di},bt)}},{key:"updateVariableFrame",value:function(bt){this.props.itemSizeGetter||this.cacheSizes();for(var ar=this.getStartAndEnd(),hr=ar.start,xr=ar.end,sr=this.props,Br=sr.length,hn=sr.pageSize,Vn=0,Yr=0,Un=0,Si=Br-1;Yr<Si;){var di=this.getSizeOfItem(Yr);if(di==null||Vn+di>hr)break;Vn+=di,++Yr}for(var Ii=Br-Yr;Un<Ii&&Vn<xr;){var Xn=this.getSizeOfItem(Yr+Un);if(Xn==null){Un=Math.min(Un+hn,Ii);break}Vn+=Xn,++Un}this.maybeSetState(Gt(this.props,{from:Yr,itemsPerRow:1,size:Un}),bt)}},{key:"updateUniformFrame",value:function(bt){var ar=this.getItemSizeAndItemsPerRow(),hr=ar.itemSize,xr=ar.itemsPerRow;if(!hr||!xr)return bt();var sr=this.getStartAndEnd(),Br=sr.start,hn=sr.end,Vn=Gt(this.props,{from:Math.floor(Br/hr)*xr,size:(Math.ceil((hn-Br)/hr)+1)*xr,itemsPerRow:xr}),Yr=Vn.from,Un=Vn.size;return this.maybeSetState({itemsPerRow:xr,from:Yr,itemSize:hr,size:Un},bt)}},{key:"getSpaceBefore",value:function(bt){var ar=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ar[bt]!=null)return ar[bt];var hr=this.state,xr=hr.itemSize,sr=hr.itemsPerRow;if(xr)return ar[bt]=Math.floor(bt/sr)*xr;for(var Br=bt;Br>0&&ar[--Br]==null;);for(var hn=ar[Br]||0,Vn=Br;Vn<bt;++Vn){ar[Vn]=hn;var Yr=this.getSizeOfItem(Vn);if(Yr==null)break;hn+=Yr}return ar[bt]=hn}},{key:"cacheSizes",value:function(){for(var bt=this.cache,ar=this.state.from,hr=this.items.children,xr=ke[this.props.axis],sr=0,Br=hr.length;sr<Br;++sr)bt[ar+sr]=hr[sr][xr]}},{key:"getSizeOfItem",value:function(bt){var ar=this.cache,hr=this.items,xr=this.props,sr=xr.axis,Br=xr.itemSizeGetter,hn=xr.itemSizeEstimator,Vn=xr.type,Yr=this.state,Un=Yr.from,Si=Yr.itemSize,di=Yr.size;if(Si)return Si;if(Br)return Br(bt);if(bt in ar)return ar[bt];if(Vn==="simple"&&bt>=Un&&bt<Un+di&&hr){var Ii=hr.children[bt-Un];if(Ii)return Ii[ke[sr]]}if(hn)return hn(bt,ar)}},{key:"scrollTo",value:function(bt){bt!=null&&this.setScroll(this.getSpaceBefore(bt))}},{key:"scrollAround",value:function(bt){var ar=this.getScrollPosition(),hr=this.getSpaceBefore(bt),xr=hr-this.props.scrollParentViewportSizeGetter(this)+this.getSizeOfItem(bt),sr=Math.min(xr,hr),Br=Math.max(xr,hr);if(ar<=sr)return this.setScroll(sr);if(ar>Br)return this.setScroll(Br)}},{key:"getVisibleRange",value:function(){for(var bt=this.state,ar=bt.from,hr=bt.size,xr=this.getStartAndEnd(0),sr=xr.start,Br=xr.end,hn={},Vn,Yr,Un=ar;Un<ar+hr;++Un){var Si=this.getSpaceBefore(Un,hn),di=Si+this.getSizeOfItem(Un);Vn==null&&di>sr&&(Vn=Un),Vn!=null&&Si<Br&&(Yr=Un)}return[Vn,Yr]}},{key:"renderItems",value:function(){for(var bt=this,ar=this.props,hr=ar.itemRenderer,xr=ar.itemsRenderer,sr=this.state,Br=sr.from,hn=sr.size,Vn=[],Yr=0;Yr<hn;++Yr)Vn.push(hr(Br+Yr,Yr));return xr(Vn,function(Un){return bt.items=Un})}},{key:"render",value:function(){var bt=this,ar=this.props,hr=ar.axis,xr=ar.length,sr=ar.type,Br=ar.useTranslate3d,hn=this.state,Vn=hn.from,Yr=hn.itemsPerRow,Un=this.renderItems();if(sr==="simple")return Un;var Si={position:"relative"},di={},Ii=Math.ceil(xr/Yr)*Yr,Xn=this.getSpaceBefore(Ii,di);Xn&&(Si[Ir[hr]]=Xn,hr==="x"&&(Si.overflowX="hidden"));var Go=this.getSpaceBefore(Vn,di),Lo=hr==="x"?Go:0,co=hr==="y"?Go:0,Ko=Br?"translate3d(".concat(Lo,"px, ").concat(co,"px, 0)"):"translate(".concat(Lo,"px, ").concat(co,"px)"),ds={msTransform:Ko,WebkitTransform:Ko,transform:Ko};return(0,u.jsx)("div",{style:Si,ref:function(ra){return bt.el=ra},children:(0,u.jsx)("div",{style:ds,children:Un})})}}],[{key:"getDerivedStateFromProps",value:function(bt,ar){var hr=Gt(bt,ar);return hr===ar?null:hr}}])})(a.Component);se(tt,"displayName","ReactList"),se(tt,"defaultProps",{axis:"y",itemRenderer:function(_t,Vt){return(0,u.jsx)("div",{children:_t},Vt)},itemsRenderer:function(_t,Vt){return(0,u.jsx)("div",{ref:Vt,children:_t})},length:0,minSize:1,pageSize:10,scrollParentGetter:Et,scrollParentViewportSizeGetter:qt,threshold:100,type:"simple",useStaticSize:!1,useTranslate3d:!1})})})(V1)),V1}function _1e(e,r){if(e===r)return!0;if(!e||!r)return!1;var a=Object.keys(e),u=Object.keys(r),p=a.length;if(u.length!==p)return!1;for(var y=0;y<p;y++){var x=a[y];if(e[x]!==r[x]||!Object.prototype.hasOwnProperty.call(r,x))return!1}return!0}function y1e(e,r){if(e===r)return!0;if(!e||!r)return!1;var a=e.length;if(r.length!==a)return!1;for(var u=0;u<a;u++)if(e[u]!==r[u])return!1;return!0}const v1e=Object.freeze(Object.defineProperty({__proto__:null,shallowEqualArrays:y1e,shallowEqualObjects:_1e},Symbol.toStringTag,{value:"Module"})),x1e=aQ(v1e);var l0={},jU;function DS(){return jU||(jU=1,Object.defineProperty(l0,"__esModule",{value:!0}),l0.default=void 0,l0.default={dateRangeWrapper:"rdrDateRangeWrapper",calendarWrapper:"rdrCalendarWrapper",dateDisplay:"rdrDateDisplay",dateDisplayItem:"rdrDateDisplayItem",dateDisplayItemActive:"rdrDateDisplayItemActive",monthAndYearWrapper:"rdrMonthAndYearWrapper",monthAndYearPickers:"rdrMonthAndYearPickers",nextPrevButton:"rdrNextPrevButton",month:"rdrMonth",weekDays:"rdrWeekDays",weekDay:"rdrWeekDay",days:"rdrDays",day:"rdrDay",dayNumber:"rdrDayNumber",dayPassive:"rdrDayPassive",dayToday:"rdrDayToday",dayStartOfWeek:"rdrDayStartOfWeek",dayEndOfWeek:"rdrDayEndOfWeek",daySelected:"rdrDaySelected",dayDisabled:"rdrDayDisabled",dayStartOfMonth:"rdrDayStartOfMonth",dayEndOfMonth:"rdrDayEndOfMonth",dayWeekend:"rdrDayWeekend",dayStartPreview:"rdrDayStartPreview",dayInPreview:"rdrDayInPreview",dayEndPreview:"rdrDayEndPreview",dayHovered:"rdrDayHovered",dayActive:"rdrDayActive",inRange:"rdrInRange",endEdge:"rdrEndEdge",startEdge:"rdrStartEdge",prevButton:"rdrPprevButton",nextButton:"rdrNextButton",selected:"rdrSelected",months:"rdrMonths",monthPicker:"rdrMonthPicker",yearPicker:"rdrYearPicker",dateDisplayWrapper:"rdrDateDisplayWrapper",definedRangesWrapper:"rdrDefinedRangesWrapper",staticRanges:"rdrStaticRanges",staticRange:"rdrStaticRange",inputRanges:"rdrInputRanges",inputRange:"rdrInputRange",inputRangeInput:"rdrInputRangeInput",dateRangePickerWrapper:"rdrDateRangePickerWrapper",staticRangeLabel:"rdrStaticRangeLabel",staticRangeSelected:"rdrStaticRangeSelected",monthName:"rdrMonthName",infiniteMonths:"rdrInfiniteMonths",monthsVertical:"rdrMonthsVertical",monthsHorizontal:"rdrMonthsHorizontal"}),l0}var c0={},NU;function b1e(){if(NU)return c0;NU=1,Object.defineProperty(c0,"__esModule",{value:!0}),c0.ariaLabelsShape=void 0;var e=r(jp());function r(a){return a&&a.__esModule?a:{default:a}}return c0.ariaLabelsShape=e.default.shape({dateInput:e.default.objectOf(e.default.shape({startDate:e.default.string,endDate:e.default.string})),monthPicker:e.default.string,yearPicker:e.default.string,prevButton:e.default.string,nextButton:e.default.string}),c0}var VU;function j9(){if(VU)return i0;VU=1,Object.defineProperty(i0,"__esModule",{value:!0}),i0.default=void 0;var e=Z(Ld()),r=G(jp()),a=CS(),u=G(p1e()),p=G(m1e()),y=AS(),x=G(v_()),i=G(g1e()),C=x1e,R=b_(),z=a9(),F=G(DS()),V=b1e();function G(_e){return _e&&_e.__esModule?_e:{default:_e}}function H(_e){if(typeof WeakMap!="function")return null;var Re=new WeakMap,ke=new WeakMap;return(H=function(ze){return ze?ke:Re})(_e)}function Z(_e,Re){if(_e&&_e.__esModule)return _e;if(_e===null||typeof _e!="object"&&typeof _e!="function")return{default:_e};var ke=H(Re);if(ke&&ke.has(_e))return ke.get(_e);var ze={__proto__:null},et=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ht in _e)if(ht!=="default"&&Object.prototype.hasOwnProperty.call(_e,ht)){var Xt=et?Object.getOwnPropertyDescriptor(_e,ht):null;Xt&&(Xt.get||Xt.set)?Object.defineProperty(ze,ht,Xt):ze[ht]=_e[ht]}return ze.default=_e,ke&&ke.set(_e,ze),ze}function J(){return J=Object.assign?Object.assign.bind():function(_e){for(var Re=1;Re<arguments.length;Re++){var ke=arguments[Re];for(var ze in ke)Object.prototype.hasOwnProperty.call(ke,ze)&&(_e[ze]=ke[ze])}return _e},J.apply(this,arguments)}function se(_e,Re,ke){return Re=pe(Re),Re in _e?Object.defineProperty(_e,Re,{value:ke,enumerable:!0,configurable:!0,writable:!0}):_e[Re]=ke,_e}function pe(_e){var Re=ve(_e,"string");return typeof Re=="symbol"?Re:String(Re)}function ve(_e,Re){if(typeof _e!="object"||!_e)return _e;var ke=_e[Symbol.toPrimitive];if(ke!==void 0){var ze=ke.call(_e,Re);if(typeof ze!="object")return ze;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Re==="string"?String:Number)(_e)}let Ne=class aD extends e.PureComponent{constructor(Re,ke){var ze;super(Re,ke),ze=this,se(this,"focusToDate",function(et){let ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ze.props,Xt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!ht.scroll.enabled){if(Xt&&ht.preventSnapRefocus){const Fr=(0,R.differenceInCalendarMonths)(et,ze.state.focusedDate),Or=ht.calendarFocus==="forwards"&&Fr>=0,or=ht.calendarFocus==="backwards"&&Fr<=0;if((Or||or)&&Math.abs(Fr)<ht.months)return}ze.setState({focusedDate:et});return}const Ir=(0,R.differenceInCalendarMonths)(et,ht.minDate,ze.dateOptions),nr=ze.list.getVisibleRange();Xt&&nr.includes(Ir)||(ze.isFirstRender=!0,ze.list.scrollTo(Ir),ze.setState({focusedDate:et}))}),se(this,"updateShownDate",function(){let et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ze.props;const ht=et.scroll.enabled?{...et,months:ze.list.getVisibleRange().length}:et,Xt=(0,y.calcFocusDate)(ze.state.focusedDate,ht);ze.focusToDate(Xt,ht)}),se(this,"updatePreview",et=>{if(!et){this.setState({preview:null});return}const ht={startDate:et,endDate:et,color:this.props.color};this.setState({preview:ht})}),se(this,"changeShownDate",function(et){let ht=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set";const{focusedDate:Xt}=ze.state,{onShownDateChange:Ir,minDate:nr,maxDate:Fr}=ze.props,Or={monthOffset:()=>(0,R.addMonths)(Xt,et),setMonth:()=>(0,R.setMonth)(Xt,et),setYear:()=>(0,R.setYear)(Xt,et),set:()=>et},or=(0,R.min)([(0,R.max)([Or[ht](),nr]),Fr]);ze.focusToDate(or,ze.props,!1),Ir&&Ir(or)}),se(this,"handleRangeFocusChange",(et,ht)=>{this.props.onRangeFocusChange&&this.props.onRangeFocusChange([et,ht])}),se(this,"handleScroll",()=>{const{onShownDateChange:et,minDate:ht}=this.props,{focusedDate:Xt}=this.state,{isFirstRender:Ir}=this,nr=this.list.getVisibleRange();if(nr[0]===void 0)return;const Fr=(0,R.addMonths)(ht,nr[0]||0);!(0,R.isSameMonth)(Fr,Xt)&&!Ir&&(this.setState({focusedDate:Fr}),et&&et(Fr)),this.isFirstRender=!1}),se(this,"renderMonthAndYear",(et,ht,Xt)=>{const{showMonthArrow:Ir,minDate:nr,maxDate:Fr,showMonthAndYearPickers:Or,ariaLabels:or}=Xt,lt=(Fr||aD.defaultProps.maxDate).getFullYear(),Et=(nr||aD.defaultProps.minDate).getFullYear(),qt=this.styles;return e.default.createElement("div",{onMouseUp:Gt=>Gt.stopPropagation(),className:qt.monthAndYearWrapper},Ir?e.default.createElement("button",{type:"button",className:(0,x.default)(qt.nextPrevButton,qt.prevButton),onClick:()=>ht(-1,"monthOffset"),"aria-label":or.prevButton},e.default.createElement("i",null)):null,Or?e.default.createElement("span",{className:qt.monthAndYearPickers},e.default.createElement("span",{className:qt.monthPicker},e.default.createElement("select",{value:et.getMonth(),onChange:Gt=>ht(Gt.target.value,"setMonth"),"aria-label":or.monthPicker},this.state.monthNames.map((Gt,tt)=>e.default.createElement("option",{key:tt,value:tt},Gt)))),e.default.createElement("span",{className:qt.monthAndYearDivider}),e.default.createElement("span",{className:qt.yearPicker},e.default.createElement("select",{value:et.getFullYear(),onChange:Gt=>ht(Gt.target.value,"setYear"),"aria-label":or.yearPicker},new Array(lt-Et+1).fill(lt).map((Gt,tt)=>{const ct=Gt-tt;return e.default.createElement("option",{key:ct,value:ct},ct)})))):e.default.createElement("span",{className:qt.monthAndYearPickers},this.state.monthNames[et.getMonth()]," ",et.getFullYear()),Ir?e.default.createElement("button",{type:"button",className:(0,x.default)(qt.nextPrevButton,qt.nextButton),onClick:()=>ht(1,"monthOffset"),"aria-label":or.nextButton},e.default.createElement("i",null)):null)}),se(this,"renderDateDisplay",()=>{const{focusedRange:et,color:ht,ranges:Xt,rangeColors:Ir,dateDisplayFormat:nr,editableDateInputs:Fr,startDatePlaceholder:Or,endDatePlaceholder:or,ariaLabels:lt}=this.props,Et=Ir[et[0]]||ht,qt=this.styles;return e.default.createElement("div",{className:qt.dateDisplayWrapper},Xt.map((Gt,tt)=>Gt.showDateDisplay===!1||Gt.disabled&&!Gt.showDateDisplay?null:e.default.createElement("div",{className:qt.dateDisplay,key:tt,style:{color:Gt.color||Et}},e.default.createElement(p.default,{className:(0,x.default)(qt.dateDisplayItem,{[qt.dateDisplayItemActive]:et[0]===tt&&et[1]===0}),readOnly:!Fr,disabled:Gt.disabled,value:Gt.startDate,placeholder:Or,dateOptions:this.dateOptions,dateDisplayFormat:nr,ariaLabel:lt.dateInput&&lt.dateInput[Gt.key]&&lt.dateInput[Gt.key].startDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(tt,0)}),e.default.createElement(p.default,{className:(0,x.default)(qt.dateDisplayItem,{[qt.dateDisplayItemActive]:et[0]===tt&&et[1]===1}),readOnly:!Fr,disabled:Gt.disabled,value:Gt.endDate,placeholder:or,dateOptions:this.dateOptions,dateDisplayFormat:nr,ariaLabel:lt.dateInput&&lt.dateInput[Gt.key]&&lt.dateInput[Gt.key].endDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(tt,1)}))))}),se(this,"onDragSelectionStart",et=>{const{onChange:ht,dragSelectionEnabled:Xt}=this.props;Xt?this.setState({drag:{status:!0,range:{startDate:et,endDate:et},disablePreview:!0}}):ht&&ht(et)}),se(this,"onDragSelectionEnd",et=>{const{updateRange:ht,displayMode:Xt,onChange:Ir,dragSelectionEnabled:nr}=this.props;if(!nr)return;if(Xt==="date"||!this.state.drag.status){Ir&&Ir(et);return}const Fr={startDate:this.state.drag.range.startDate,endDate:et};Xt!=="dateRange"||(0,R.isSameDay)(Fr.startDate,et)?this.setState({drag:{status:!1,range:{}}},()=>Ir&&Ir(et)):this.setState({drag:{status:!1,range:{}}},()=>{ht&&ht(Fr)})}),se(this,"onDragSelectionMove",et=>{const{drag:ht}=this.state;!ht.status||!this.props.dragSelectionEnabled||this.setState({drag:{status:ht.status,range:{startDate:ht.range.startDate,endDate:et},disablePreview:!0}})}),se(this,"estimateMonthSize",(et,ht)=>{const{direction:Xt,minDate:Ir}=this.props,{scrollArea:nr}=this.state;if(ht&&(this.listSizeCache=ht,ht[et]))return ht[et];if(Xt==="horizontal")return nr.monthWidth;const Fr=(0,R.addMonths)(Ir,et),{start:Or,end:or}=(0,y.getMonthDisplayRange)(Fr,this.dateOptions);return(0,R.differenceInDays)(or,Or,this.dateOptions)+1>35?nr.longMonthHeight:nr.monthHeight}),this.dateOptions={locale:Re.locale},Re.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=Re.weekStartsOn),this.styles=(0,y.generateStyles)([F.default,Re.classNames]),this.listSizeCache={},this.isFirstRender=!0,this.state={monthNames:this.getMonthNames(),focusedDate:(0,y.calcFocusDate)(null,Re),drag:{status:!1,range:{startDate:null,endDate:null},disablePreview:!1},scrollArea:this.calcScrollArea(Re)}}getMonthNames(){return[...Array(12).keys()].map(Re=>this.props.locale.localize.month(Re))}calcScrollArea(Re){const{direction:ke,months:ze,scroll:et}=Re;if(!et.enabled)return{enabled:!1};const ht=et.longMonthHeight||et.monthHeight;return ke==="vertical"?{enabled:!0,monthHeight:et.monthHeight||220,longMonthHeight:ht||260,calendarWidth:"auto",calendarHeight:(et.calendarHeight||ht||240)*ze}:{enabled:!0,monthWidth:et.monthWidth||332,calendarWidth:(et.calendarWidth||et.monthWidth||332)*ze,monthHeight:ht||300,calendarHeight:ht||300}}componentDidMount(){this.props.scroll.enabled&&setTimeout(()=>this.focusToDate(this.state.focusedDate))}componentDidUpdate(Re){const ze={dateRange:"ranges",date:"date"}[this.props.displayMode];this.props[ze]!==Re[ze]&&this.updateShownDate(this.props),(Re.locale!==this.props.locale||Re.weekStartsOn!==this.props.weekStartsOn)&&(this.dateOptions={locale:this.props.locale},this.props.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=this.props.weekStartsOn),this.setState({monthNames:this.getMonthNames()})),(0,C.shallowEqualObjects)(Re.scroll,this.props.scroll)||this.setState({scrollArea:this.calcScrollArea(this.props)})}renderWeekdays(){const Re=new Date;return e.default.createElement("div",{className:this.styles.weekDays},(0,R.eachDayOfInterval)({start:(0,R.startOfWeek)(Re,this.dateOptions),end:(0,R.endOfWeek)(Re,this.dateOptions)}).map((ke,ze)=>e.default.createElement("span",{className:this.styles.weekDay,key:ze},(0,R.format)(ke,this.props.weekdayDisplayFormat,this.dateOptions))))}render(){const{showDateDisplay:Re,onPreviewChange:ke,scroll:ze,direction:et,disabledDates:ht,disabledDay:Xt,maxDate:Ir,minDate:nr,rangeColors:Fr,color:Or,navigatorRenderer:or,className:lt,preview:Et}=this.props,{scrollArea:qt,focusedDate:Gt}=this.state,tt=et==="vertical",ct=or||this.renderMonthAndYear,_t=this.props.ranges.map((Vt,bt)=>({...Vt,color:Vt.color||Fr[bt]||Or}));return e.default.createElement("div",{className:(0,x.default)(this.styles.calendarWrapper,lt),onMouseUp:()=>this.setState({drag:{status:!1,range:{}}}),onMouseLeave:()=>{this.setState({drag:{status:!1,range:{}}})}},Re&&this.renderDateDisplay(),ct(Gt,this.changeShownDate,this.props),ze.enabled?e.default.createElement("div",null,tt&&this.renderWeekdays(this.dateOptions),e.default.createElement("div",{className:(0,x.default)(this.styles.infiniteMonths,tt?this.styles.monthsVertical:this.styles.monthsHorizontal),onMouseLeave:()=>ke&&ke(),style:{width:qt.calendarWidth+11,height:qt.calendarHeight+11},onScroll:this.handleScroll},e.default.createElement(i.default,{length:(0,R.differenceInCalendarMonths)((0,R.endOfMonth)(Ir),(0,R.addDays)((0,R.startOfMonth)(nr),-1),this.dateOptions),treshold:500,type:"variable",ref:Vt=>this.list=Vt,itemSizeEstimator:this.estimateMonthSize,axis:tt?"y":"x",itemRenderer:(Vt,bt)=>{const ar=(0,R.addMonths)(nr,Vt);return e.default.createElement(u.default,J({},this.props,{onPreviewChange:ke||this.updatePreview,preview:Et||this.state.preview,ranges:_t,key:bt,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:ht,disabledDay:Xt,month:ar,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>ke&&ke(),styles:this.styles,style:tt?{height:this.estimateMonthSize(Vt)}:{height:qt.monthHeight,width:this.estimateMonthSize(Vt)},showMonthName:!0,showWeekDays:!tt}))}}))):e.default.createElement("div",{className:(0,x.default)(this.styles.months,tt?this.styles.monthsVertical:this.styles.monthsHorizontal)},new Array(this.props.months).fill(null).map((Vt,bt)=>{let ar=(0,R.addMonths)(this.state.focusedDate,bt);return this.props.calendarFocus==="backwards"&&(ar=(0,R.subMonths)(this.state.focusedDate,this.props.months-1-bt)),e.default.createElement(u.default,J({},this.props,{onPreviewChange:ke||this.updatePreview,preview:Et||this.state.preview,ranges:_t,key:bt,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:ht,disabledDay:Xt,month:ar,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>ke&&ke(),styles:this.styles,showWeekDays:!tt||bt===0,showMonthName:!tt||bt>0}))})))}};return Ne.defaultProps={showMonthArrow:!0,showMonthAndYearPickers:!0,disabledDates:[],disabledDay:()=>{},classNames:{},locale:z.enUS,ranges:[],focusedRange:[0,0],dateDisplayFormat:"MMM d, yyyy",monthDisplayFormat:"MMM yyyy",weekdayDisplayFormat:"E",dayDisplayFormat:"d",showDateDisplay:!0,showPreview:!0,displayMode:"date",months:1,color:"#3d91ff",scroll:{enabled:!1},direction:"vertical",maxDate:(0,R.addYears)(new Date,20),minDate:(0,R.addYears)(new Date,-100),rangeColors:["#3d91ff","#3ecf8e","#fed14c"],startDatePlaceholder:"Early",endDatePlaceholder:"Continuous",editableDateInputs:!1,dragSelectionEnabled:!0,fixedHeight:!1,calendarFocus:"forwards",preventSnapRefocus:!1,ariaLabels:{}},Ne.propTypes={showMonthArrow:r.default.bool,showMonthAndYearPickers:r.default.bool,disabledDates:r.default.array,disabledDay:r.default.func,minDate:r.default.object,maxDate:r.default.object,date:r.default.object,onChange:r.default.func,onPreviewChange:r.default.func,onRangeFocusChange:r.default.func,classNames:r.default.object,locale:r.default.object,shownDate:r.default.object,onShownDateChange:r.default.func,ranges:r.default.arrayOf(a.rangeShape),preview:r.default.shape({startDate:r.default.object,endDate:r.default.object,color:r.default.string}),dateDisplayFormat:r.default.string,monthDisplayFormat:r.default.string,weekdayDisplayFormat:r.default.string,weekStartsOn:r.default.number,dayDisplayFormat:r.default.string,focusedRange:r.default.arrayOf(r.default.number),initialFocusedRange:r.default.arrayOf(r.default.number),months:r.default.number,className:r.default.string,showDateDisplay:r.default.bool,showPreview:r.default.bool,displayMode:r.default.oneOf(["dateRange","date"]),color:r.default.string,updateRange:r.default.func,scroll:r.default.shape({enabled:r.default.bool,monthHeight:r.default.number,longMonthHeight:r.default.number,monthWidth:r.default.number,calendarWidth:r.default.number,calendarHeight:r.default.number}),direction:r.default.oneOf(["vertical","horizontal"]),startDatePlaceholder:r.default.string,endDatePlaceholder:r.default.string,navigatorRenderer:r.default.func,rangeColors:r.default.arrayOf(r.default.string),editableDateInputs:r.default.bool,dragSelectionEnabled:r.default.bool,fixedHeight:r.default.bool,calendarFocus:r.default.string,preventSnapRefocus:r.default.bool,ariaLabels:V.ariaLabelsShape},i0.default=Ne,i0}var UU;function N9(){if(UU)return n0;UU=1,Object.defineProperty(n0,"__esModule",{value:!0}),n0.default=void 0;var e=z(Ld()),r=C(jp()),a=C(j9()),u=CS(),p=AS(),y=b_(),x=C(v_()),i=C(DS());function C(J){return J&&J.__esModule?J:{default:J}}function R(J){if(typeof WeakMap!="function")return null;var se=new WeakMap,pe=new WeakMap;return(R=function(ve){return ve?pe:se})(J)}function z(J,se){if(J&&J.__esModule)return J;if(J===null||typeof J!="object"&&typeof J!="function")return{default:J};var pe=R(se);if(pe&&pe.has(J))return pe.get(J);var ve={__proto__:null},Ne=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _e in J)if(_e!=="default"&&Object.prototype.hasOwnProperty.call(J,_e)){var Re=Ne?Object.getOwnPropertyDescriptor(J,_e):null;Re&&(Re.get||Re.set)?Object.defineProperty(ve,_e,Re):ve[_e]=J[_e]}return ve.default=J,pe&&pe.set(J,ve),ve}function F(){return F=Object.assign?Object.assign.bind():function(J){for(var se=1;se<arguments.length;se++){var pe=arguments[se];for(var ve in pe)Object.prototype.hasOwnProperty.call(pe,ve)&&(J[ve]=pe[ve])}return J},F.apply(this,arguments)}function V(J,se,pe){return se=G(se),se in J?Object.defineProperty(J,se,{value:pe,enumerable:!0,configurable:!0,writable:!0}):J[se]=pe,J}function G(J){var se=H(J,"string");return typeof se=="symbol"?se:String(se)}function H(J,se){if(typeof J!="object"||!J)return J;var pe=J[Symbol.toPrimitive];if(pe!==void 0){var ve=pe.call(J,se);if(typeof ve!="object")return ve;throw new TypeError("@@toPrimitive must return a primitive value.")}return(se==="string"?String:Number)(J)}let Z=class extends e.Component{constructor(se,pe){var ve;super(se,pe),ve=this,V(this,"calcNewSelection",function(Ne){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const Re=ve.props.focusedRange||ve.state.focusedRange,{ranges:ke,onChange:ze,maxDate:et,moveRangeOnFirstSelection:ht,retainEndDateOnFirstSelection:Xt,disabledDates:Ir}=ve.props,nr=Re[0],Fr=ke[nr];if(!Fr||!ze)return{};let{startDate:Or,endDate:or}=Fr;const lt=new Date;let Et;if(!_e)Or=Ne.startDate,or=Ne.endDate;else if(Re[1]===0){const tt=(0,y.differenceInCalendarDays)(or||lt,Or),ct=()=>ht?(0,y.addDays)(Ne,tt):Xt?!or||(0,y.isBefore)(Ne,or)?or:Ne:Ne||lt;Or=Ne,or=ct(),et&&(or=(0,y.min)([or,et])),Et=[Re[0],1]}else or=Ne;let qt=Re[1]===0;(0,y.isBefore)(or,Or)&&(qt=!qt,[Or,or]=[or,Or]);const Gt=Ir.filter(tt=>(0,y.isWithinInterval)(tt,{start:Or,end:or}));return Gt.length>0&&(qt?Or=(0,y.addDays)((0,y.max)(Gt),1):or=(0,y.addDays)((0,y.min)(Gt),-1)),Et||(Et=[(0,p.findNextRangeIndex)(ve.props.ranges,Re[0]),0]),{wasValid:!(Gt.length>0),range:{startDate:Or,endDate:or},nextFocusRange:Et}}),V(this,"setSelection",(Ne,_e)=>{const{onChange:Re,ranges:ke,onRangeFocusChange:ze}=this.props,ht=(this.props.focusedRange||this.state.focusedRange)[0],Xt=ke[ht];if(!Xt)return;const Ir=this.calcNewSelection(Ne,_e);Re({[Xt.key||`range${ht+1}`]:{...Xt,...Ir.range}}),this.setState({focusedRange:Ir.nextFocusRange,preview:null}),ze&&ze(Ir.nextFocusRange)}),V(this,"handleRangeFocusChange",Ne=>{this.setState({focusedRange:Ne}),this.props.onRangeFocusChange&&this.props.onRangeFocusChange(Ne)}),V(this,"updatePreview",Ne=>{if(!Ne){this.setState({preview:null});return}const{rangeColors:_e,ranges:Re}=this.props,ke=this.props.focusedRange||this.state.focusedRange,ze=Re[ke[0]]?.color||_e[ke[0]]||ze;this.setState({preview:{...Ne.range,color:ze}})}),this.state={focusedRange:se.initialFocusedRange||[(0,p.findNextRangeIndex)(se.ranges),0],preview:null},this.styles=(0,p.generateStyles)([i.default,se.classNames])}render(){return e.default.createElement(a.default,F({focusedRange:this.state.focusedRange,onRangeFocusChange:this.handleRangeFocusChange,preview:this.state.preview,onPreviewChange:se=>{this.updatePreview(se?this.calcNewSelection(se):null)}},this.props,{displayMode:"dateRange",className:(0,x.default)(this.styles.dateRangeWrapper,this.props.className),onChange:this.setSelection,updateRange:se=>this.setSelection(se,!1),ref:se=>{this.calendar=se}}))}};return Z.defaultProps={classNames:{},ranges:[],moveRangeOnFirstSelection:!1,retainEndDateOnFirstSelection:!1,rangeColors:["#3d91ff","#3ecf8e","#fed14c"],disabledDates:[]},Z.propTypes={...a.default.propTypes,onChange:r.default.func,onRangeFocusChange:r.default.func,className:r.default.string,ranges:r.default.arrayOf(u.rangeShape),moveRangeOnFirstSelection:r.default.bool,retainEndDateOnFirstSelection:r.default.bool},n0.default=Z,n0}var u0={},d0={},Rm={},$U;function V9(){if($U)return Rm;$U=1,Object.defineProperty(Rm,"__esModule",{value:!0}),Rm.createStaticRanges=u,Rm.defaultStaticRanges=Rm.defaultInputRanges=void 0;var e=b_();const r={startOfWeek:(0,e.startOfWeek)(new Date),endOfWeek:(0,e.endOfWeek)(new Date),startOfLastWeek:(0,e.startOfWeek)((0,e.addDays)(new Date,-7)),endOfLastWeek:(0,e.endOfWeek)((0,e.addDays)(new Date,-7)),startOfToday:(0,e.startOfDay)(new Date),endOfToday:(0,e.endOfDay)(new Date),startOfYesterday:(0,e.startOfDay)((0,e.addDays)(new Date,-1)),endOfYesterday:(0,e.endOfDay)((0,e.addDays)(new Date,-1)),startOfMonth:(0,e.startOfMonth)(new Date),endOfMonth:(0,e.endOfMonth)(new Date),startOfLastMonth:(0,e.startOfMonth)((0,e.addMonths)(new Date,-1)),endOfLastMonth:(0,e.endOfMonth)((0,e.addMonths)(new Date,-1))},a={range:{},isSelected(p){const y=this.range();return(0,e.isSameDay)(p.startDate,y.startDate)&&(0,e.isSameDay)(p.endDate,y.endDate)}};function u(p){return p.map(y=>({...a,...y}))}return Rm.defaultStaticRanges=u([{label:"Today",range:()=>({startDate:r.startOfToday,endDate:r.endOfToday})},{label:"Yesterday",range:()=>({startDate:r.startOfYesterday,endDate:r.endOfYesterday})},{label:"This Week",range:()=>({startDate:r.startOfWeek,endDate:r.endOfWeek})},{label:"Last Week",range:()=>({startDate:r.startOfLastWeek,endDate:r.endOfLastWeek})},{label:"This Month",range:()=>({startDate:r.startOfMonth,endDate:r.endOfMonth})},{label:"Last Month",range:()=>({startDate:r.startOfLastMonth,endDate:r.endOfLastMonth})}]),Rm.defaultInputRanges=[{label:"days up to today",range(p){return{startDate:(0,e.addDays)(r.startOfToday,(Math.max(Number(p),1)-1)*-1),endDate:r.endOfToday}},getCurrentValue(p){return(0,e.isSameDay)(p.endDate,r.endOfToday)?p.startDate?(0,e.differenceInCalendarDays)(r.endOfToday,p.startDate)+1:"":"-"}},{label:"days starting today",range(p){const y=new Date;return{startDate:y,endDate:(0,e.addDays)(y,Math.max(Number(p),1)-1)}},getCurrentValue(p){return(0,e.isSameDay)(p.startDate,r.startOfToday)?p.endDate?(0,e.differenceInCalendarDays)(p.endDate,r.startOfToday)+1:"":"-"}}],Rm}var h0={},WU;function w1e(){if(WU)return h0;WU=1,Object.defineProperty(h0,"__esModule",{value:!0}),h0.default=void 0;var e=p(Ld()),r=a(jp());function a(F){return F&&F.__esModule?F:{default:F}}function u(F){if(typeof WeakMap!="function")return null;var V=new WeakMap,G=new WeakMap;return(u=function(H){return H?G:V})(F)}function p(F,V){if(F&&F.__esModule)return F;if(F===null||typeof F!="object"&&typeof F!="function")return{default:F};var G=u(V);if(G&&G.has(F))return G.get(F);var H={__proto__:null},Z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var J in F)if(J!=="default"&&Object.prototype.hasOwnProperty.call(F,J)){var se=Z?Object.getOwnPropertyDescriptor(F,J):null;se&&(se.get||se.set)?Object.defineProperty(H,J,se):H[J]=F[J]}return H.default=F,G&&G.set(F,H),H}function y(F,V,G){return V=x(V),V in F?Object.defineProperty(F,V,{value:G,enumerable:!0,configurable:!0,writable:!0}):F[V]=G,F}function x(F){var V=i(F,"string");return typeof V=="symbol"?V:String(V)}function i(F,V){if(typeof F!="object"||!F)return F;var G=F[Symbol.toPrimitive];if(G!==void 0){var H=G.call(F,V);if(typeof H!="object")return H;throw new TypeError("@@toPrimitive must return a primitive value.")}return(V==="string"?String:Number)(F)}const C=0,R=99999;let z=class extends e.Component{constructor(V,G){super(V,G),y(this,"onChange",H=>{const{onChange:Z}=this.props;let J=parseInt(H.target.value,10);J=isNaN(J)?0:Math.max(Math.min(R,J),C),Z(J)})}shouldComponentUpdate(V){const{value:G,label:H,placeholder:Z}=this.props;return G!==V.value||H!==V.label||Z!==V.placeholder}render(){const{label:V,placeholder:G,value:H,styles:Z,onBlur:J,onFocus:se}=this.props;return e.default.createElement("div",{className:Z.inputRange},e.default.createElement("input",{className:Z.inputRangeInput,placeholder:G,value:H,min:C,max:R,onChange:this.onChange,onFocus:se,onBlur:J}),e.default.createElement("span",{className:Z.inputRangeLabel},V))}};return z.propTypes={value:r.default.oneOfType([r.default.string,r.default.number]),label:r.default.oneOfType([r.default.element,r.default.node]).isRequired,placeholder:r.default.string,styles:r.default.shape({inputRange:r.default.string,inputRangeInput:r.default.string,inputRangeLabel:r.default.string}).isRequired,onBlur:r.default.func.isRequired,onFocus:r.default.func.isRequired,onChange:r.default.func.isRequired},z.defaultProps={value:"",placeholder:"-"},h0.default=z,h0}var qU;function U9(){if(qU)return d0;qU=1,Object.defineProperty(d0,"__esModule",{value:!0}),d0.default=void 0;var e=R(Ld()),r=i(jp()),a=i(DS()),u=V9(),p=CS(),y=i(w1e()),x=i(v_());function i(H){return H&&H.__esModule?H:{default:H}}function C(H){if(typeof WeakMap!="function")return null;var Z=new WeakMap,J=new WeakMap;return(C=function(se){return se?J:Z})(H)}function R(H,Z){if(H&&H.__esModule)return H;if(H===null||typeof H!="object"&&typeof H!="function")return{default:H};var J=C(Z);if(J&&J.has(H))return J.get(H);var se={__proto__:null},pe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ve in H)if(ve!=="default"&&Object.prototype.hasOwnProperty.call(H,ve)){var Ne=pe?Object.getOwnPropertyDescriptor(H,ve):null;Ne&&(Ne.get||Ne.set)?Object.defineProperty(se,ve,Ne):se[ve]=H[ve]}return se.default=H,J&&J.set(H,se),se}function z(H,Z,J){return Z=F(Z),Z in H?Object.defineProperty(H,Z,{value:J,enumerable:!0,configurable:!0,writable:!0}):H[Z]=J,H}function F(H){var Z=V(H,"string");return typeof Z=="symbol"?Z:String(Z)}function V(H,Z){if(typeof H!="object"||!H)return H;var J=H[Symbol.toPrimitive];if(J!==void 0){var se=J.call(H,Z);if(typeof se!="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Z==="string"?String:Number)(H)}let G=class extends e.Component{constructor(Z){super(Z),z(this,"handleRangeChange",J=>{const{onChange:se,ranges:pe,focusedRange:ve}=this.props,Ne=pe[ve[0]];!se||!Ne||se({[Ne.key||`range${ve[0]+1}`]:{...Ne,...J}})}),this.state={rangeOffset:0,focusedInput:-1}}getRangeOptionValue(Z){const{ranges:J=[],focusedRange:se=[]}=this.props;if(typeof Z.getCurrentValue!="function")return"";const pe=J[se[0]]||{};return Z.getCurrentValue(pe)||""}getSelectedRange(Z,J){const se=Z.findIndex(ve=>!ve.startDate||!ve.endDate||ve.disabled?!1:J.isSelected(ve));return{selectedRange:Z[se],focusedRangeIndex:se}}render(){const{headerContent:Z,footerContent:J,onPreviewChange:se,inputRanges:pe,staticRanges:ve,ranges:Ne,renderStaticRangeLabel:_e,rangeColors:Re,className:ke}=this.props;return e.default.createElement("div",{className:(0,x.default)(a.default.definedRangesWrapper,ke)},Z,e.default.createElement("div",{className:a.default.staticRanges},ve.map((ze,et)=>{const{selectedRange:ht,focusedRangeIndex:Xt}=this.getSelectedRange(Ne,ze);let Ir;return ze.hasCustomRendering?Ir=_e(ze):Ir=ze.label,e.default.createElement("button",{type:"button",className:(0,x.default)(a.default.staticRange,{[a.default.staticRangeSelected]:!!ht}),style:{color:ht?ht.color||Re[Xt]:null},key:et,onClick:()=>this.handleRangeChange(ze.range(this.props)),onFocus:()=>se&&se(ze.range(this.props)),onMouseOver:()=>se&&se(ze.range(this.props)),onMouseLeave:()=>{se&&se()}},e.default.createElement("span",{tabIndex:-1,className:a.default.staticRangeLabel},Ir))})),e.default.createElement("div",{className:a.default.inputRanges},pe.map((ze,et)=>e.default.createElement(y.default,{key:et,styles:a.default,label:ze.label,onFocus:()=>this.setState({focusedInput:et,rangeOffset:0}),onBlur:()=>this.setState({rangeOffset:0}),onChange:ht=>this.handleRangeChange(ze.range(ht,this.props)),value:this.getRangeOptionValue(ze)}))),J)}};return G.propTypes={inputRanges:r.default.array,staticRanges:r.default.array,ranges:r.default.arrayOf(p.rangeShape),focusedRange:r.default.arrayOf(r.default.number),onPreviewChange:r.default.func,onChange:r.default.func,footerContent:r.default.any,headerContent:r.default.any,rangeColors:r.default.arrayOf(r.default.string),className:r.default.string,renderStaticRangeLabel:r.default.func},G.defaultProps={inputRanges:u.defaultInputRanges,staticRanges:u.defaultStaticRanges,ranges:[],rangeColors:["#3d91ff","#3ecf8e","#fed14c"],focusedRange:[0,0]},d0.default=G,d0}var GU;function S1e(){if(GU)return u0;GU=1,Object.defineProperty(u0,"__esModule",{value:!0}),u0.default=void 0;var e=R(Ld()),r=i(jp()),a=i(N9()),u=i(U9()),p=AS(),y=i(v_()),x=i(DS());function i(V){return V&&V.__esModule?V:{default:V}}function C(V){if(typeof WeakMap!="function")return null;var G=new WeakMap,H=new WeakMap;return(C=function(Z){return Z?H:G})(V)}function R(V,G){if(V&&V.__esModule)return V;if(V===null||typeof V!="object"&&typeof V!="function")return{default:V};var H=C(G);if(H&&H.has(V))return H.get(V);var Z={__proto__:null},J=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var se in V)if(se!=="default"&&Object.prototype.hasOwnProperty.call(V,se)){var pe=J?Object.getOwnPropertyDescriptor(V,se):null;pe&&(pe.get||pe.set)?Object.defineProperty(Z,se,pe):Z[se]=V[se]}return Z.default=V,H&&H.set(V,Z),Z}function z(){return z=Object.assign?Object.assign.bind():function(V){for(var G=1;G<arguments.length;G++){var H=arguments[G];for(var Z in H)Object.prototype.hasOwnProperty.call(H,Z)&&(V[Z]=H[Z])}return V},z.apply(this,arguments)}let F=class extends e.Component{constructor(G){super(G),this.state={focusedRange:[(0,p.findNextRangeIndex)(G.ranges),0]},this.styles=(0,p.generateStyles)([x.default,G.classNames])}render(){const{focusedRange:G}=this.state;return e.default.createElement("div",{className:(0,y.default)(this.styles.dateRangePickerWrapper,this.props.className)},e.default.createElement(u.default,z({focusedRange:G,onPreviewChange:H=>this.dateRange.updatePreview(H?this.dateRange.calcNewSelection(H,typeof H=="string"):null)},this.props,{range:this.props.ranges[G[0]],className:void 0})),e.default.createElement(a.default,z({onRangeFocusChange:H=>this.setState({focusedRange:H}),focusedRange:G},this.props,{ref:H=>this.dateRange=H,className:void 0})))}};return F.defaultProps={},F.propTypes={...a.default.propTypes,...u.default.propTypes,className:r.default.string},u0.default=F,u0}var HU;function T1e(){return HU||(HU=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Calendar",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"DateRange",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"DateRangePicker",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"DefinedRange",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"createStaticRanges",{enumerable:!0,get:function(){return y.createStaticRanges}}),Object.defineProperty(e,"defaultInputRanges",{enumerable:!0,get:function(){return y.defaultInputRanges}}),Object.defineProperty(e,"defaultStaticRanges",{enumerable:!0,get:function(){return y.defaultStaticRanges}});var r=x(N9()),a=x(j9()),u=x(S1e()),p=x(U9()),y=V9();function x(i){return i&&i.__esModule?i:{default:i}}})(rE)),rE}var $9=T1e();function yO({mode:e="home"}){const{filters:r,setFilter:a,applyFilters:u,clearAllFilters:p}=QR(),{countries:y}=Dx(),x=kp(),[i,C]=ge.useState(!1),[R,z]=ge.useState([{startDate:new Date,endDate:new Date,key:"selection"}]),F=Object.values(r).some(G=>G!==""),V=X.jsxs(X.Fragment,{children:[X.jsxs(f_,{isOpen:i,onClose:()=>C(!1),children:[X.jsx(y_,{}),X.jsxs(p_,{bg:"white",borderRadius:"lg",children:[X.jsx(__,{children:"Select Date Range"}),X.jsx(g_,{}),X.jsx(m_,{children:X.jsx($9.DateRange,{editableDateInputs:!0,onChange:G=>z([G.selection]),moveRangeOnFirstSelection:!1,ranges:R})}),X.jsx(Cx,{children:X.jsx(wo,{colorScheme:"purple",onClick:()=>{a("dateFrom",R[0].startDate.toISOString().split("T")[0]),a("dateTo",R[0].endDate.toISOString().split("T")[0]),C(!1)},children:"Apply"})})]})]}),X.jsxs(Mh,{columns:[1,5],spacing:3,children:[X.jsx(El,{placeholder:"Find a Destination",value:r.search,onChange:G=>a("search",G.target.value),color:e==="home"?"white":"black",borderColor:e==="home"?"whiteAlpha.500":"gray.300",_placeholder:{color:e==="home"?"white":"gray.500"}}),X.jsxs(nD,{placeholder:"Price Range",onChange:G=>{const H=G.target.value;if(!H){a("priceMin",""),a("priceMax","");return}H==="$0-$500"?(a("priceMin",0),a("priceMax",500)):H==="$500-$1000"?(a("priceMin",500),a("priceMax",1e3)):H==="$1000+"&&(a("priceMin",1e3),a("priceMax",""))},color:e==="home"?"white":"black",borderColor:e==="home"?"whiteAlpha.500":"gray.300",children:[X.jsx("option",{children:"$0-$500"}),X.jsx("option",{children:"$500-$1000"}),X.jsx("option",{children:"$1000+"})]}),X.jsx(nD,{placeholder:"All Countries",value:r.country,onChange:G=>a("country",G.target.value),color:e==="home"?"white":"black",borderColor:e==="home"?"whiteAlpha.500":"gray.300",children:y.map(G=>X.jsx("option",{value:G,children:G},G))}),X.jsx(wo,{variant:e==="home"?"outline":"solid",borderColor:e==="home"?"whiteAlpha.500":"gray.300",color:e==="home"?"white":"black",onClick:()=>C(!0),children:r.dateFrom&&r.dateTo?`${r.dateFrom}  ${r.dateTo}`:"Select Date Range"}),X.jsx(wo,{colorScheme:"purple",rightIcon:X.jsx(sD,{}),onClick:async()=>{await u(),e==="home"&&x("/tours")},children:e==="home"?"Discover":"Apply"})]})]});return e==="home"?X.jsxs(LH,{children:[X.jsx(Mn,{children:X.jsx(MH,{variant:"soft-rounded",colorScheme:"purple",mb:4,children:X.jsxs(Ic,{justify:"space-between",align:"center",children:[X.jsxs(CH,{justifyContent:"center",flex:"1",children:[X.jsx(hw,{color:"white",children:"Destinations"}),X.jsx(hw,{color:"white",onClick:()=>x("/tours"),children:"Tours"}),X.jsx(hw,{color:"white",onClick:()=>x("/packages"),children:"Packages"})]}),X.jsx(mo,{as:Sve,boxSize:6,cursor:"pointer",color:F?"white":"whiteAlpha.400",onClick:()=>F&&p(),_hover:{color:F?"purple.300":"whiteAlpha.400"}})]})})}),V]}):X.jsx(Mn,{children:V})}function E1e(){const{setFilter:e,clearAllFilters:r,fetchHomepageStats:a,formattedStats:u}=QR(),{tours:p,miniGridTours:y,fetchCountries:x,fetchTours:i,loading:C}=Dx(),R=ge.useRef(!1),z={backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},F=kp(),V=KR(Re=>Re.setCurrentTour),[G,H]=ge.useState(!1),[Z,J]=ge.useState([{startDate:new Date,endDate:new Date,key:"selection"}]),se=Re=>{V(Re),F(`/tour/${Re.slug}`)};ge.useEffect(()=>{R.current||(R.current=!0,a(),i(),x(),r())},[]);const pe=({end:Re,duration:ke=1200})=>{const[ze,et]=ge.useState(0);return ge.useEffect(()=>{let ht=0;const Xt=parseInt(Re.replace(/[^0-9]/g,""))||0;if(Xt===0)return et(0);const Ir=Xt/(ke/16),nr=setInterval(()=>{ht+=Ir,ht>=Xt?(clearInterval(nr),et(Xt)):et(Math.floor(ht))},16);return()=>clearInterval(nr)},[Re]),X.jsx(X.Fragment,{children:ze.toLocaleString()})},ve=Re=>({Philippines:"",Japan:"",France:"",Thailand:"",Nepal:""})[Re]||"",Ne=new URLSearchParams(window.location.search).get("success"),_e=({value:Re,label:ke,icon:ze})=>X.jsxs(Wo,{bg:"white",p:5,borderRadius:"xl",shadow:"md",_hover:{shadow:"xl",transform:"translateY(-px)"},transition:"0.2s",children:[X.jsx(mo,{as:ze,boxSize:8,color:"purple.400"}),X.jsx(ko,{fontSize:"4xl",fontWeight:"bold",children:Re}),X.jsx(zr,{fontSize:"lg",color:"gray.600",children:ke})]});return C?X.jsx(Ad,{textAlign:"center",py:10,children:X.jsx(zr,{children:"Loading tours..."})}):p.length?X.jsxs(Mn,{children:[X.jsxs(f_,{isOpen:G,onClose:()=>H(!1),children:[X.jsx(y_,{}),X.jsxs(p_,{bg:"white",borderRadius:"lg",children:[X.jsx(__,{children:"Select Date Range"}),X.jsx(g_,{}),X.jsx(m_,{children:X.jsx($9.DateRange,{editableDateInputs:!0,onChange:Re=>J([Re.selection]),moveRangeOnFirstSelection:!1,ranges:Z})}),X.jsx(Cx,{children:X.jsx(wo,{colorScheme:"purple",onClick:()=>{e("dateFrom",Z[0].startDate.toISOString().split("T")[0]),e("dateTo",Z[0].startDate.toISOString().split("T")[0]),H(!1)},children:"Apply"})})]})]}),X.jsx(Mn,{w:"100%",h:"100vh",backgroundImage:"url(/img/origbg.webp)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",color:"white",children:X.jsxs(Wo,{position:"relative",top:"40%",transform:"translateY(-40%)",spacing:6,textAlign:"center",zIndex:"1",children:[X.jsxs(ko,{fontSize:["3xl","5xl"],fontWeight:"extrabold",children:["Make Travel Easy,",X.jsx("br",{})," Enjoy More Fun"]}),X.jsx(zr,{fontSize:"lg",maxW:"lg",children:"Experience travel that's simple, exciting, and worry-free."}),X.jsx(yO,{mode:"home"})]})}),Ne&&X.jsxs(Mn,{bg:"green.50",border:"1px solid",borderColor:"green.200",borderRadius:"lg",p:4,mb:6,children:[X.jsx(ko,{size:"md",color:"green.600",children:" Booking Confirmed!"}),X.jsx(zr,{children:"Your tour has been successfully booked."})]}),X.jsxs(Ad,{maxW:"7xl",py:20,textAlign:"center",children:[X.jsx(ko,{mb:2,children:"Trusted by travelers around the globe."}),X.jsx(zr,{color:"gray.600",mb:10,children:"Real numbers from our growing community."}),X.jsxs(Mh,{columns:[1,3],spacing:10,mb:16,children:[X.jsx(_e,{value:X.jsx(pe,{end:u?.totalTours||"0"}),label:"Tours Available",icon:sD}),X.jsx(_e,{value:X.jsx(pe,{end:u?.totalReviews||"0"}),label:"Verified Reviews",icon:Op}),X.jsx(_e,{value:X.jsx(pe,{end:u?.totalBookings||"0"}),label:"Successful Bookings",icon:sD})]}),X.jsx(ko,{size:"md",mb:6,children:"Where People Travel Most"}),X.jsx(Fi,{justify:"center",spacing:4,wrap:"wrap",mb:14,children:u?.topCountries?.length>0?u.topCountries.map(Re=>X.jsxs(Mn,{px:4,py:2,borderRadius:"full",bg:"purple.50",color:"purple.600",fontWeight:"semibold",shadow:"sm",children:[ve(Re.country)," ",Re.country]},Re.country)):X.jsx(zr,{children:"No country data available"})}),X.jsx(ko,{size:"md",mb:6,children:"Top Rated Adventures"}),X.jsx(Mh,{columns:[1,3],spacing:6,children:u?.topRatedTours?.map(Re=>X.jsx(BH,{tour:Re},Re._id))})]}),X.jsxs(Ad,{maxW:"7xl",py:20,children:[X.jsx(ko,{textAlign:"center",mb:2,children:"Unveil the incredible experiences that await you"}),X.jsx(zr,{textAlign:"center",color:"gray.600",mb:12,children:"at your thoughtfully selected destinations."}),X.jsxs(h_,{templateColumns:["1fr","2fr 3fr"],gap:6,children:[X.jsx(Ch,{bgImage:"url(/img/lbg-1.jpg)",bgSize:"cover",bgPos:"center",borderRadius:"xl",position:"relative",minH:"700px",overflow:"hidden",children:X.jsxs(Wo,{position:"absolute",top:"70%",left:"10%",transform:"translateY(-50%)",align:"flex-start",color:"white",spacing:6,children:[X.jsxs(ko,{fontSize:"5xl",fontWeight:"bold",lineHeight:"1.3",children:["Soak in the ",X.jsx("br",{})," beauty of",X.jsx("br",{})," nature."]}),X.jsx(Fi,{bg:"rgb(255, 255, 255)",borderRadius:"full",p:1,w:"100%",h:"40%",spacing:"2",overflow:"hidden",...z,children:[1,2,3,4,5].map(Re=>X.jsx($m,{src:`/img/lbg-${Re}.jpg`,w:"60px",h:"40px",objectFit:"cover",borderRightRadius:Re===5?"full":"5",borderLeftRadius:Re===1?"full":"5"},Re))})]})}),X.jsx(Ch,{children:X.jsx(Mh,{columns:[1,2],spacing:10,h:"100%",children:y.map(Re=>X.jsxs(Mn,{bg:"white",onClick:()=>se(Re),_hover:{transform:"translateY(-3px)",transition:"0.3s"},children:[X.jsxs(Mn,{position:"relative",children:[X.jsx($m,{src:Re.imageCover,alt:Re.name,fallbackSrc:c_,w:"100%",h:"100%",objectFit:"cover",borderRadius:15}),X.jsxs(Mn,{position:"absolute",top:"10px",right:"10px",bg:"white",px:2.5,py:1,borderRadius:"full",display:"flex",alignItems:"center",gap:1,boxShadow:"sm",children:[X.jsx(mo,{as:Op,color:"yellow.400",boxSize:4}),X.jsx(zr,{fontWeight:"bold",fontSize:"sm",children:Re.ratingsAverage?.toFixed(1)||"4.9"})]})]}),X.jsxs(Mn,{px:4,py:4,children:[X.jsxs(Fi,{justify:"space-between",mb:1,children:[X.jsx(ko,{fontSize:"md",noOfLines:1,children:Re.name}),X.jsxs(zr,{fontWeight:"semibold",color:"gray.700",children:["$",Re.price.toLocaleString()]})]}),X.jsx(zr,{fontSize:"sm",color:"gray.500",noOfLines:2,children:Re.summary})]})]},Re._id))})})]})]}),X.jsxs(Mn,{bgImage:"url(./public/img/lbg-4.jpg)",bgSize:"cover",bgPos:"center",py:40,textAlign:"center",color:"white",position:"relative",children:[X.jsx(Mn,{position:"absolute",inset:"0",bg:"rgba(0, 0, 0, 0.55)"}),X.jsxs(Wo,{position:"relative",spacing:6,children:[X.jsx(ko,{fontSize:["3xl","5xl"],children:"Begin your exciting adventure into nature today."}),X.jsx(wo,{size:"lg",colorScheme:"purple",borderRadius:"full",children:"Sign Up"})]})]})]}):X.jsx(Ad,{textAlign:"center",py:10,children:X.jsx(zr,{children:"No tours available."})})}function vO(e,r){e.indexOf(r)===-1&&e.push(r)}function xO(e,r){const a=e.indexOf(r);a>-1&&e.splice(a,1)}const Lp=(e,r,a)=>a>r?r:a<e?e:a;let bO=()=>{};const zp={},W9=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function q9(e){return typeof e=="object"&&e!==null}const G9=e=>/^0[^.\s]+$/u.test(e);function wO(e){let r;return()=>(r===void 0&&(r=e()),r)}const Od=e=>e,P1e=(e,r)=>a=>r(e(a)),zx=(...e)=>e.reduce(P1e),ax=(e,r,a)=>{const u=r-e;return u===0?1:(a-e)/u};class SO{constructor(){this.subscriptions=[]}add(r){return vO(this.subscriptions,r),()=>xO(this.subscriptions,r)}notify(r,a,u){const p=this.subscriptions.length;if(p)if(p===1)this.subscriptions[0](r,a,u);else for(let y=0;y<p;y++){const x=this.subscriptions[y];x&&x(r,a,u)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Lf=e=>e*1e3,Dd=e=>e/1e3;function H9(e,r){return r?e*(1e3/r):0}const Y9=(e,r,a)=>(((1-3*a+3*r)*e+(3*a-6*r))*e+3*r)*e,I1e=1e-7,M1e=12;function C1e(e,r,a,u,p){let y,x,i=0;do x=r+(a-r)/2,y=Y9(x,u,p)-e,y>0?a=x:r=x;while(Math.abs(y)>I1e&&++i<M1e);return x}function Fx(e,r,a,u){if(e===r&&a===u)return Od;const p=y=>C1e(y,0,1,e,a);return y=>y===0||y===1?y:Y9(p(y),r,u)}const Z9=e=>r=>r<=.5?e(2*r)/2:(2-e(2*(1-r)))/2,X9=e=>r=>1-e(1-r),K9=Fx(.33,1.53,.69,.99),TO=X9(K9),Q9=Z9(TO),J9=e=>(e*=2)<1?.5*TO(e):.5*(2-Math.pow(2,-10*(e-1))),EO=e=>1-Math.sin(Math.acos(e)),e7=X9(EO),t7=Z9(EO),A1e=Fx(.42,0,1,1),D1e=Fx(0,0,.58,1),r7=Fx(.42,0,.58,1),R1e=e=>Array.isArray(e)&&typeof e[0]!="number",n7=e=>Array.isArray(e)&&typeof e[0]=="number",O1e={linear:Od,easeIn:A1e,easeInOut:r7,easeOut:D1e,circIn:EO,circInOut:t7,circOut:e7,backIn:TO,backInOut:Q9,backOut:K9,anticipate:J9},L1e=e=>typeof e=="string",YU=e=>{if(n7(e)){bO(e.length===4);const[r,a,u,p]=e;return Fx(r,a,u,p)}else if(L1e(e))return O1e[e];return e},i7=ge.createContext({}),o7=ge.createContext({strict:!1}),s7=ge.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),RS=ge.createContext({});function OS(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function lx(e){return typeof e=="string"||Array.isArray(e)}const PO=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],IO=["initial",...PO];function LS(e){return OS(e.animate)||IO.some(r=>lx(e[r]))}function a7(e){return!!(LS(e)||e.variants)}function z1e(e,r){if(LS(e)){const{initial:a,animate:u}=e;return{initial:a===!1||lx(a)?a:void 0,animate:lx(u)?u:void 0}}return e.inherit!==!1?r:{}}function F1e(e){const{initial:r,animate:a}=z1e(e,ge.useContext(RS));return ge.useMemo(()=>({initial:r,animate:a}),[ZU(r),ZU(a)])}function ZU(e){return Array.isArray(e)?e.join(" "):e}const U1=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function k1e(e,r){let a=new Set,u=new Set,p=!1,y=!1;const x=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function C(z){x.has(z)&&(R.schedule(z),e()),z(i)}const R={schedule:(z,F=!1,V=!1)=>{const H=V&&p?a:u;return F&&x.add(z),H.has(z)||H.add(z),z},cancel:z=>{u.delete(z),x.delete(z)},process:z=>{if(i=z,p){y=!0;return}p=!0,[a,u]=[u,a],a.forEach(C),a.clear(),p=!1,y&&(y=!1,R.process(z))}};return R}const B1e=40;function l7(e,r){let a=!1,u=!0;const p={delta:0,timestamp:0,isProcessing:!1},y=()=>a=!0,x=U1.reduce((ve,Ne)=>(ve[Ne]=k1e(y),ve),{}),{setup:i,read:C,resolveKeyframes:R,preUpdate:z,update:F,preRender:V,render:G,postRender:H}=x,Z=()=>{const ve=zp.useManualTiming?p.timestamp:performance.now();a=!1,zp.useManualTiming||(p.delta=u?1e3/60:Math.max(Math.min(ve-p.timestamp,B1e),1)),p.timestamp=ve,p.isProcessing=!0,i.process(p),C.process(p),R.process(p),z.process(p),F.process(p),V.process(p),G.process(p),H.process(p),p.isProcessing=!1,a&&r&&(u=!1,e(Z))},J=()=>{a=!0,u=!0,p.isProcessing||e(Z)};return{schedule:U1.reduce((ve,Ne)=>{const _e=x[Ne];return ve[Ne]=(Re,ke=!1,ze=!1)=>(a||J(),_e.schedule(Re,ke,ze)),ve},{}),cancel:ve=>{for(let Ne=0;Ne<U1.length;Ne++)x[U1[Ne]].cancel(ve)},state:p,steps:x}}const{schedule:ks,cancel:Wm,state:ec,steps:WC}=l7(typeof requestAnimationFrame<"u"?requestAnimationFrame:Od,!0);let fw;function j1e(){fw=void 0}const Su={now:()=>(fw===void 0&&Su.set(ec.isProcessing||zp.useManualTiming?ec.timestamp:performance.now()),fw),set:e=>{fw=e,queueMicrotask(j1e)}},c7=e=>r=>typeof r=="string"&&r.startsWith(e),u7=c7("--"),N1e=c7("var(--"),MO=e=>N1e(e)?V1e.test(e.split("/*")[0].trim()):!1,V1e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,rv={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},cx={...rv,transform:e=>Lp(0,1,e)},$1={...rv,default:1},j0=e=>Math.round(e*1e5)/1e5,CO=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function U1e(e){return e==null}const $1e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,AO=(e,r)=>a=>!!(typeof a=="string"&&$1e.test(a)&&a.startsWith(e)||r&&!U1e(a)&&Object.prototype.hasOwnProperty.call(a,r)),d7=(e,r,a)=>u=>{if(typeof u!="string")return u;const[p,y,x,i]=u.match(CO);return{[e]:parseFloat(p),[r]:parseFloat(y),[a]:parseFloat(x),alpha:i!==void 0?parseFloat(i):1}},W1e=e=>Lp(0,255,e),qC={...rv,transform:e=>Math.round(W1e(e))},qg={test:AO("rgb","red"),parse:d7("red","green","blue"),transform:({red:e,green:r,blue:a,alpha:u=1})=>"rgba("+qC.transform(e)+", "+qC.transform(r)+", "+qC.transform(a)+", "+j0(cx.transform(u))+")"};function q1e(e){let r="",a="",u="",p="";return e.length>5?(r=e.substring(1,3),a=e.substring(3,5),u=e.substring(5,7),p=e.substring(7,9)):(r=e.substring(1,2),a=e.substring(2,3),u=e.substring(3,4),p=e.substring(4,5),r+=r,a+=a,u+=u,p+=p),{red:parseInt(r,16),green:parseInt(a,16),blue:parseInt(u,16),alpha:p?parseInt(p,16)/255:1}}const lD={test:AO("#"),parse:q1e,transform:qg.transform},kx=e=>({test:r=>typeof r=="string"&&r.endsWith(e)&&r.split(" ").length===1,parse:parseFloat,transform:r=>`${r}${e}`}),Fm=kx("deg"),zf=kx("%"),ui=kx("px"),G1e=kx("vh"),H1e=kx("vw"),XU={...zf,parse:e=>zf.parse(e)/100,transform:e=>zf.transform(e*100)},_y={test:AO("hsl","hue"),parse:d7("hue","saturation","lightness"),transform:({hue:e,saturation:r,lightness:a,alpha:u=1})=>"hsla("+Math.round(e)+", "+zf.transform(j0(r))+", "+zf.transform(j0(a))+", "+j0(cx.transform(u))+")"},Ya={test:e=>qg.test(e)||lD.test(e)||_y.test(e),parse:e=>qg.test(e)?qg.parse(e):_y.test(e)?_y.parse(e):lD.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?qg.transform(e):_y.transform(e),getAnimatableNone:e=>{const r=Ya.parse(e);return r.alpha=0,Ya.transform(r)}},Y1e=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Z1e(e){return isNaN(e)&&typeof e=="string"&&(e.match(CO)?.length||0)+(e.match(Y1e)?.length||0)>0}const h7="number",f7="color",X1e="var",K1e="var(",KU="${}",Q1e=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ux(e){const r=e.toString(),a=[],u={color:[],number:[],var:[]},p=[];let y=0;const i=r.replace(Q1e,C=>(Ya.test(C)?(u.color.push(y),p.push(f7),a.push(Ya.parse(C))):C.startsWith(K1e)?(u.var.push(y),p.push(X1e),a.push(C)):(u.number.push(y),p.push(h7),a.push(parseFloat(C))),++y,KU)).split(KU);return{values:a,split:i,indexes:u,types:p}}function p7(e){return ux(e).values}function m7(e){const{split:r,types:a}=ux(e),u=r.length;return p=>{let y="";for(let x=0;x<u;x++)if(y+=r[x],p[x]!==void 0){const i=a[x];i===h7?y+=j0(p[x]):i===f7?y+=Ya.transform(p[x]):y+=p[x]}return y}}const J1e=e=>typeof e=="number"?0:Ya.test(e)?Ya.getAnimatableNone(e):e;function ewe(e){const r=p7(e);return m7(e)(r.map(J1e))}const qm={test:Z1e,parse:p7,createTransformer:m7,getAnimatableNone:ewe};function GC(e,r,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(r-e)*6*a:a<1/2?r:a<2/3?e+(r-e)*(2/3-a)*6:e}function twe({hue:e,saturation:r,lightness:a,alpha:u}){e/=360,r/=100,a/=100;let p=0,y=0,x=0;if(!r)p=y=x=a;else{const i=a<.5?a*(1+r):a+r-a*r,C=2*a-i;p=GC(C,i,e+1/3),y=GC(C,i,e),x=GC(C,i,e-1/3)}return{red:Math.round(p*255),green:Math.round(y*255),blue:Math.round(x*255),alpha:u}}function kw(e,r){return a=>a>0?r:e}const ta=(e,r,a)=>e+(r-e)*a,HC=(e,r,a)=>{const u=e*e,p=a*(r*r-u)+u;return p<0?0:Math.sqrt(p)},rwe=[lD,qg,_y],nwe=e=>rwe.find(r=>r.test(e));function QU(e){const r=nwe(e);if(!r)return!1;let a=r.parse(e);return r===_y&&(a=twe(a)),a}const JU=(e,r)=>{const a=QU(e),u=QU(r);if(!a||!u)return kw(e,r);const p={...a};return y=>(p.red=HC(a.red,u.red,y),p.green=HC(a.green,u.green,y),p.blue=HC(a.blue,u.blue,y),p.alpha=ta(a.alpha,u.alpha,y),qg.transform(p))},cD=new Set(["none","hidden"]);function iwe(e,r){return cD.has(e)?a=>a<=0?e:r:a=>a>=1?r:e}function owe(e,r){return a=>ta(e,r,a)}function DO(e){return typeof e=="number"?owe:typeof e=="string"?MO(e)?kw:Ya.test(e)?JU:lwe:Array.isArray(e)?g7:typeof e=="object"?Ya.test(e)?JU:swe:kw}function g7(e,r){const a=[...e],u=a.length,p=e.map((y,x)=>DO(y)(y,r[x]));return y=>{for(let x=0;x<u;x++)a[x]=p[x](y);return a}}function swe(e,r){const a={...e,...r},u={};for(const p in a)e[p]!==void 0&&r[p]!==void 0&&(u[p]=DO(e[p])(e[p],r[p]));return p=>{for(const y in u)a[y]=u[y](p);return a}}function awe(e,r){const a=[],u={color:0,var:0,number:0};for(let p=0;p<r.values.length;p++){const y=r.types[p],x=e.indexes[y][u[y]],i=e.values[x]??0;a[p]=i,u[y]++}return a}const lwe=(e,r)=>{const a=qm.createTransformer(r),u=ux(e),p=ux(r);return u.indexes.var.length===p.indexes.var.length&&u.indexes.color.length===p.indexes.color.length&&u.indexes.number.length>=p.indexes.number.length?cD.has(e)&&!p.values.length||cD.has(r)&&!u.values.length?iwe(e,r):zx(g7(awe(u,p),p.values),a):kw(e,r)};function _7(e,r,a){return typeof e=="number"&&typeof r=="number"&&typeof a=="number"?ta(e,r,a):DO(e)(e,r)}const cwe=e=>{const r=({timestamp:a})=>e(a);return{start:(a=!0)=>ks.update(r,a),stop:()=>Wm(r),now:()=>ec.isProcessing?ec.timestamp:Su.now()}},y7=(e,r,a=10)=>{let u="";const p=Math.max(Math.round(r/a),2);for(let y=0;y<p;y++)u+=Math.round(e(y/(p-1))*1e4)/1e4+", ";return`linear(${u.substring(0,u.length-2)})`},Bw=2e4;function RO(e){let r=0;const a=50;let u=e.next(r);for(;!u.done&&r<Bw;)r+=a,u=e.next(r);return r>=Bw?1/0:r}function uwe(e,r=100,a){const u=a({...e,keyframes:[0,r]}),p=Math.min(RO(u),Bw);return{type:"keyframes",ease:y=>u.next(p*y).value/r,duration:Dd(p)}}const dwe=5;function v7(e,r,a){const u=Math.max(r-dwe,0);return H9(a-e(u),r-u)}const ya={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},YC=.001;function hwe({duration:e=ya.duration,bounce:r=ya.bounce,velocity:a=ya.velocity,mass:u=ya.mass}){let p,y,x=1-r;x=Lp(ya.minDamping,ya.maxDamping,x),e=Lp(ya.minDuration,ya.maxDuration,Dd(e)),x<1?(p=R=>{const z=R*x,F=z*e,V=z-a,G=uD(R,x),H=Math.exp(-F);return YC-V/G*H},y=R=>{const F=R*x*e,V=F*a+a,G=Math.pow(x,2)*Math.pow(R,2)*e,H=Math.exp(-F),Z=uD(Math.pow(R,2),x);return(-p(R)+YC>0?-1:1)*((V-G)*H)/Z}):(p=R=>{const z=Math.exp(-R*e),F=(R-a)*e+1;return-YC+z*F},y=R=>{const z=Math.exp(-R*e),F=(a-R)*(e*e);return z*F});const i=5/e,C=pwe(p,y,i);if(e=Lf(e),isNaN(C))return{stiffness:ya.stiffness,damping:ya.damping,duration:e};{const R=Math.pow(C,2)*u;return{stiffness:R,damping:x*2*Math.sqrt(u*R),duration:e}}}const fwe=12;function pwe(e,r,a){let u=a;for(let p=1;p<fwe;p++)u=u-e(u)/r(u);return u}function uD(e,r){return e*Math.sqrt(1-r*r)}const mwe=["duration","bounce"],gwe=["stiffness","damping","mass"];function e$(e,r){return r.some(a=>e[a]!==void 0)}function _we(e){let r={velocity:ya.velocity,stiffness:ya.stiffness,damping:ya.damping,mass:ya.mass,isResolvedFromDuration:!1,...e};if(!e$(e,gwe)&&e$(e,mwe))if(e.visualDuration){const a=e.visualDuration,u=2*Math.PI/(a*1.2),p=u*u,y=2*Lp(.05,1,1-(e.bounce||0))*Math.sqrt(p);r={...r,mass:ya.mass,stiffness:p,damping:y}}else{const a=hwe(e);r={...r,...a,mass:ya.mass},r.isResolvedFromDuration=!0}return r}function jw(e=ya.visualDuration,r=ya.bounce){const a=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:r}:e;let{restSpeed:u,restDelta:p}=a;const y=a.keyframes[0],x=a.keyframes[a.keyframes.length-1],i={done:!1,value:y},{stiffness:C,damping:R,mass:z,duration:F,velocity:V,isResolvedFromDuration:G}=_we({...a,velocity:-Dd(a.velocity||0)}),H=V||0,Z=R/(2*Math.sqrt(C*z)),J=x-y,se=Dd(Math.sqrt(C/z)),pe=Math.abs(J)<5;u||(u=pe?ya.restSpeed.granular:ya.restSpeed.default),p||(p=pe?ya.restDelta.granular:ya.restDelta.default);let ve;if(Z<1){const _e=uD(se,Z);ve=Re=>{const ke=Math.exp(-Z*se*Re);return x-ke*((H+Z*se*J)/_e*Math.sin(_e*Re)+J*Math.cos(_e*Re))}}else if(Z===1)ve=_e=>x-Math.exp(-se*_e)*(J+(H+se*J)*_e);else{const _e=se*Math.sqrt(Z*Z-1);ve=Re=>{const ke=Math.exp(-Z*se*Re),ze=Math.min(_e*Re,300);return x-ke*((H+Z*se*J)*Math.sinh(ze)+_e*J*Math.cosh(ze))/_e}}const Ne={calculatedDuration:G&&F||null,next:_e=>{const Re=ve(_e);if(G)i.done=_e>=F;else{let ke=_e===0?H:0;Z<1&&(ke=_e===0?Lf(H):v7(ve,_e,Re));const ze=Math.abs(ke)<=u,et=Math.abs(x-Re)<=p;i.done=ze&&et}return i.value=i.done?x:Re,i},toString:()=>{const _e=Math.min(RO(Ne),Bw),Re=y7(ke=>Ne.next(_e*ke).value,_e,30);return _e+"ms "+Re},toTransition:()=>{}};return Ne}jw.applyToOptions=e=>{const r=uwe(e,100,jw);return e.ease=r.ease,e.duration=Lf(r.duration),e.type="keyframes",e};function dD({keyframes:e,velocity:r=0,power:a=.8,timeConstant:u=325,bounceDamping:p=10,bounceStiffness:y=500,modifyTarget:x,min:i,max:C,restDelta:R=.5,restSpeed:z}){const F=e[0],V={done:!1,value:F},G=ze=>i!==void 0&&ze<i||C!==void 0&&ze>C,H=ze=>i===void 0?C:C===void 0||Math.abs(i-ze)<Math.abs(C-ze)?i:C;let Z=a*r;const J=F+Z,se=x===void 0?J:x(J);se!==J&&(Z=se-F);const pe=ze=>-Z*Math.exp(-ze/u),ve=ze=>se+pe(ze),Ne=ze=>{const et=pe(ze),ht=ve(ze);V.done=Math.abs(et)<=R,V.value=V.done?se:ht};let _e,Re;const ke=ze=>{G(V.value)&&(_e=ze,Re=jw({keyframes:[V.value,H(V.value)],velocity:v7(ve,ze,V.value),damping:p,stiffness:y,restDelta:R,restSpeed:z}))};return ke(0),{calculatedDuration:null,next:ze=>{let et=!1;return!Re&&_e===void 0&&(et=!0,Ne(ze),ke(ze)),_e!==void 0&&ze>=_e?Re.next(ze-_e):(!et&&Ne(ze),V)}}}function ywe(e,r,a){const u=[],p=a||zp.mix||_7,y=e.length-1;for(let x=0;x<y;x++){let i=p(e[x],e[x+1]);if(r){const C=Array.isArray(r)?r[x]||Od:r;i=zx(C,i)}u.push(i)}return u}function vwe(e,r,{clamp:a=!0,ease:u,mixer:p}={}){const y=e.length;if(bO(y===r.length),y===1)return()=>r[0];if(y===2&&r[0]===r[1])return()=>r[1];const x=e[0]===e[1];e[0]>e[y-1]&&(e=[...e].reverse(),r=[...r].reverse());const i=ywe(r,u,p),C=i.length,R=z=>{if(x&&z<e[0])return r[0];let F=0;if(C>1)for(;F<e.length-2&&!(z<e[F+1]);F++);const V=ax(e[F],e[F+1],z);return i[F](V)};return a?z=>R(Lp(e[0],e[y-1],z)):R}function xwe(e,r){const a=e[e.length-1];for(let u=1;u<=r;u++){const p=ax(0,r,u);e.push(ta(a,1,p))}}function bwe(e){const r=[0];return xwe(r,e.length-1),r}function wwe(e,r){return e.map(a=>a*r)}function Swe(e,r){return e.map(()=>r||r7).splice(0,e.length-1)}function N0({duration:e=300,keyframes:r,times:a,ease:u="easeInOut"}){const p=R1e(u)?u.map(YU):YU(u),y={done:!1,value:r[0]},x=wwe(a&&a.length===r.length?a:bwe(r),e),i=vwe(x,r,{ease:Array.isArray(p)?p:Swe(r,p)});return{calculatedDuration:e,next:C=>(y.value=i(C),y.done=C>=e,y)}}const Twe=e=>e!==null;function OO(e,{repeat:r,repeatType:a="loop"},u,p=1){const y=e.filter(Twe),i=p<0||r&&a!=="loop"&&r%2===1?0:y.length-1;return!i||u===void 0?y[i]:u}const Ewe={decay:dD,inertia:dD,tween:N0,keyframes:N0,spring:jw};function x7(e){typeof e.type=="string"&&(e.type=Ewe[e.type])}class LO{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(r=>{this.resolve=r})}notifyFinished(){this.resolve()}then(r,a){return this.finished.then(r,a)}}const Pwe=e=>e/100;class zO extends LO{constructor(r){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:a}=this.options;a&&a.updatedAt!==Su.now()&&this.tick(Su.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=r,this.initAnimation(),this.play(),r.autoplay===!1&&this.pause()}initAnimation(){const{options:r}=this;x7(r);const{type:a=N0,repeat:u=0,repeatDelay:p=0,repeatType:y,velocity:x=0}=r;let{keyframes:i}=r;const C=a||N0;C!==N0&&typeof i[0]!="number"&&(this.mixKeyframes=zx(Pwe,_7(i[0],i[1])),i=[0,100]);const R=C({...r,keyframes:i});y==="mirror"&&(this.mirroredGenerator=C({...r,keyframes:[...i].reverse(),velocity:-x})),R.calculatedDuration===null&&(R.calculatedDuration=RO(R));const{calculatedDuration:z}=R;this.calculatedDuration=z,this.resolvedDuration=z+p,this.totalDuration=this.resolvedDuration*(u+1)-p,this.generator=R}updateTime(r){const a=Math.round(r-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(r,a=!1){const{generator:u,totalDuration:p,mixKeyframes:y,mirroredGenerator:x,resolvedDuration:i,calculatedDuration:C}=this;if(this.startTime===null)return u.next(0);const{delay:R=0,keyframes:z,repeat:F,repeatType:V,repeatDelay:G,type:H,onUpdate:Z,finalKeyframe:J}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,r):this.speed<0&&(this.startTime=Math.min(r-p/this.speed,this.startTime)),a?this.currentTime=r:this.updateTime(r);const se=this.currentTime-R*(this.playbackSpeed>=0?1:-1),pe=this.playbackSpeed>=0?se<0:se>p;this.currentTime=Math.max(se,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=p);let ve=this.currentTime,Ne=u;if(F){const ze=Math.min(this.currentTime,p)/i;let et=Math.floor(ze),ht=ze%1;!ht&&ze>=1&&(ht=1),ht===1&&et--,et=Math.min(et,F+1),!!(et%2)&&(V==="reverse"?(ht=1-ht,G&&(ht-=G/i)):V==="mirror"&&(Ne=x)),ve=Lp(0,1,ht)*i}const _e=pe?{done:!1,value:z[0]}:Ne.next(ve);y&&(_e.value=y(_e.value));let{done:Re}=_e;!pe&&C!==null&&(Re=this.playbackSpeed>=0?this.currentTime>=p:this.currentTime<=0);const ke=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Re);return ke&&H!==dD&&(_e.value=OO(z,this.options,J,this.speed)),Z&&Z(_e.value),ke&&this.finish(),_e}then(r,a){return this.finished.then(r,a)}get duration(){return Dd(this.calculatedDuration)}get iterationDuration(){const{delay:r=0}=this.options||{};return this.duration+Dd(r)}get time(){return Dd(this.currentTime)}set time(r){r=Lf(r),this.currentTime=r,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=r:this.driver&&(this.startTime=this.driver.now()-r/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(r){this.updateTime(Su.now());const a=this.playbackSpeed!==r;this.playbackSpeed=r,a&&(this.time=Dd(this.currentTime))}play(){if(this.isStopped)return;const{driver:r=cwe,startTime:a}=this.options;this.driver||(this.driver=r(p=>this.tick(p))),this.options.onPlay?.();const u=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=u):this.holdTime!==null?this.startTime=u-this.holdTime:this.startTime||(this.startTime=a??u),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Su.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(r){return this.startTime=0,this.tick(r,!0)}attachTimeline(r){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),r.observe(this)}}function Iwe(e){for(let r=1;r<e.length;r++)e[r]??(e[r]=e[r-1])}const Gg=e=>e*180/Math.PI,hD=e=>{const r=Gg(Math.atan2(e[1],e[0]));return fD(r)},Mwe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:hD,rotateZ:hD,skewX:e=>Gg(Math.atan(e[1])),skewY:e=>Gg(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},fD=e=>(e=e%360,e<0&&(e+=360),e),t$=hD,r$=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),n$=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Cwe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:r$,scaleY:n$,scale:e=>(r$(e)+n$(e))/2,rotateX:e=>fD(Gg(Math.atan2(e[6],e[5]))),rotateY:e=>fD(Gg(Math.atan2(-e[2],e[0]))),rotateZ:t$,rotate:t$,skewX:e=>Gg(Math.atan(e[4])),skewY:e=>Gg(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function pD(e){return e.includes("scale")?1:0}function mD(e,r){if(!e||e==="none")return pD(r);const a=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let u,p;if(a)u=Cwe,p=a;else{const i=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);u=Mwe,p=i}if(!p)return pD(r);const y=u[r],x=p[1].split(",").map(Dwe);return typeof y=="function"?y(x):x[y]}const Awe=(e,r)=>{const{transform:a="none"}=getComputedStyle(e);return mD(a,r)};function Dwe(e){return parseFloat(e.trim())}const nv=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],iv=new Set(nv),i$=e=>e===rv||e===ui,Rwe=new Set(["x","y","z"]),Owe=nv.filter(e=>!Rwe.has(e));function Lwe(e){const r=[];return Owe.forEach(a=>{const u=e.getValue(a);u!==void 0&&(r.push([a,u.get()]),u.set(a.startsWith("scale")?1:0))}),r}const t_={width:({x:e},{paddingLeft:r="0",paddingRight:a="0"})=>e.max-e.min-parseFloat(r)-parseFloat(a),height:({y:e},{paddingTop:r="0",paddingBottom:a="0"})=>e.max-e.min-parseFloat(r)-parseFloat(a),top:(e,{top:r})=>parseFloat(r),left:(e,{left:r})=>parseFloat(r),bottom:({y:e},{top:r})=>parseFloat(r)+(e.max-e.min),right:({x:e},{left:r})=>parseFloat(r)+(e.max-e.min),x:(e,{transform:r})=>mD(r,"x"),y:(e,{transform:r})=>mD(r,"y")};t_.translateX=t_.x;t_.translateY=t_.y;const r_=new Set;let gD=!1,_D=!1,yD=!1;function b7(){if(_D){const e=Array.from(r_).filter(u=>u.needsMeasurement),r=new Set(e.map(u=>u.element)),a=new Map;r.forEach(u=>{const p=Lwe(u);p.length&&(a.set(u,p),u.render())}),e.forEach(u=>u.measureInitialState()),r.forEach(u=>{u.render();const p=a.get(u);p&&p.forEach(([y,x])=>{u.getValue(y)?.set(x)})}),e.forEach(u=>u.measureEndState()),e.forEach(u=>{u.suspendedScrollY!==void 0&&window.scrollTo(0,u.suspendedScrollY)})}_D=!1,gD=!1,r_.forEach(e=>e.complete(yD)),r_.clear()}function w7(){r_.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(_D=!0)})}function zwe(){yD=!0,w7(),b7(),yD=!1}class FO{constructor(r,a,u,p,y,x=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...r],this.onComplete=a,this.name=u,this.motionValue=p,this.element=y,this.isAsync=x}scheduleResolve(){this.state="scheduled",this.isAsync?(r_.add(this),gD||(gD=!0,ks.read(w7),ks.resolveKeyframes(b7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:r,name:a,element:u,motionValue:p}=this;if(r[0]===null){const y=p?.get(),x=r[r.length-1];if(y!==void 0)r[0]=y;else if(u&&a){const i=u.readValue(a,x);i!=null&&(r[0]=i)}r[0]===void 0&&(r[0]=x),p&&y===void 0&&p.set(r[0])}Iwe(r)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(r=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,r),r_.delete(this)}cancel(){this.state==="scheduled"&&(r_.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Fwe=e=>e.startsWith("--");function kwe(e,r,a){Fwe(r)?e.style.setProperty(r,a):e.style[r]=a}const Bwe=wO(()=>window.ScrollTimeline!==void 0),jwe={};function Nwe(e,r){const a=wO(e);return()=>jwe[r]??a()}const S7=Nwe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),P0=([e,r,a,u])=>`cubic-bezier(${e}, ${r}, ${a}, ${u})`,o$={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:P0([0,.65,.55,1]),circOut:P0([.55,0,1,.45]),backIn:P0([.31,.01,.66,-.59]),backOut:P0([.33,1.53,.69,.99])};function T7(e,r){if(e)return typeof e=="function"?S7()?y7(e,r):"ease-out":n7(e)?P0(e):Array.isArray(e)?e.map(a=>T7(a,r)||o$.easeOut):o$[e]}function Vwe(e,r,a,{delay:u=0,duration:p=300,repeat:y=0,repeatType:x="loop",ease:i="easeOut",times:C}={},R=void 0){const z={[r]:a};C&&(z.offset=C);const F=T7(i,p);Array.isArray(F)&&(z.easing=F);const V={delay:u,duration:p,easing:Array.isArray(F)?"linear":F,fill:"both",iterations:y+1,direction:x==="reverse"?"alternate":"normal"};return R&&(V.pseudoElement=R),e.animate(z,V)}function E7(e){return typeof e=="function"&&"applyToOptions"in e}function Uwe({type:e,...r}){return E7(e)&&S7()?e.applyToOptions(r):(r.duration??(r.duration=300),r.ease??(r.ease="easeOut"),r)}class $we extends LO{constructor(r){if(super(),this.finishedTime=null,this.isStopped=!1,!r)return;const{element:a,name:u,keyframes:p,pseudoElement:y,allowFlatten:x=!1,finalKeyframe:i,onComplete:C}=r;this.isPseudoElement=!!y,this.allowFlatten=x,this.options=r,bO(typeof r.type!="string");const R=Uwe(r);this.animation=Vwe(a,u,p,R,y),R.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!y){const z=OO(p,this.options,i,this.speed);this.updateMotionValue?this.updateMotionValue(z):kwe(a,u,z),this.animation.cancel()}C?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:r}=this;r==="idle"||r==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const r=this.animation.effect?.getComputedTiming?.().duration||0;return Dd(Number(r))}get iterationDuration(){const{delay:r=0}=this.options||{};return this.duration+Dd(r)}get time(){return Dd(Number(this.animation.currentTime)||0)}set time(r){this.finishedTime=null,this.animation.currentTime=Lf(r)}get speed(){return this.animation.playbackRate}set speed(r){r<0&&(this.finishedTime=null),this.animation.playbackRate=r}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(r){this.animation.startTime=r}attachTimeline({timeline:r,observe:a}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,r&&Bwe()?(this.animation.timeline=r,Od):a(this)}}const P7={anticipate:J9,backInOut:Q9,circInOut:t7};function Wwe(e){return e in P7}function qwe(e){typeof e.ease=="string"&&Wwe(e.ease)&&(e.ease=P7[e.ease])}const s$=10;class Gwe extends $we{constructor(r){qwe(r),x7(r),super(r),r.startTime&&(this.startTime=r.startTime),this.options=r}updateMotionValue(r){const{motionValue:a,onUpdate:u,onComplete:p,element:y,...x}=this.options;if(!a)return;if(r!==void 0){a.set(r);return}const i=new zO({...x,autoplay:!1}),C=Lf(this.finishedTime??this.time);a.setWithVelocity(i.sample(C-s$).value,i.sample(C).value,s$),i.stop()}}const a$=(e,r)=>r==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(qm.test(e)||e==="0")&&!e.startsWith("url("));function Hwe(e){const r=e[0];if(e.length===1)return!0;for(let a=0;a<e.length;a++)if(e[a]!==r)return!0}function Ywe(e,r,a,u){const p=e[0];if(p===null)return!1;if(r==="display"||r==="visibility")return!0;const y=e[e.length-1],x=a$(p,r),i=a$(y,r);return!x||!i?!1:Hwe(e)||(a==="spring"||E7(a))&&u}function vD(e){e.duration=0,e.type="keyframes"}const Zwe=new Set(["opacity","clipPath","filter","transform"]),Xwe=wO(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Kwe(e){const{motionValue:r,name:a,repeatDelay:u,repeatType:p,damping:y,type:x}=e;if(!(r?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:C,transformTemplate:R}=r.owner.getProps();return Xwe()&&a&&Zwe.has(a)&&(a!=="transform"||!R)&&!C&&!u&&p!=="mirror"&&y!==0&&x!=="inertia"}const Qwe=40;class Jwe extends LO{constructor({autoplay:r=!0,delay:a=0,type:u="keyframes",repeat:p=0,repeatDelay:y=0,repeatType:x="loop",keyframes:i,name:C,motionValue:R,element:z,...F}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Su.now();const V={autoplay:r,delay:a,type:u,repeat:p,repeatDelay:y,repeatType:x,name:C,motionValue:R,element:z,...F},G=z?.KeyframeResolver||FO;this.keyframeResolver=new G(i,(H,Z,J)=>this.onKeyframesResolved(H,Z,V,!J),C,R,z),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(r,a,u,p){this.keyframeResolver=void 0;const{name:y,type:x,velocity:i,delay:C,isHandoff:R,onUpdate:z}=u;this.resolvedAt=Su.now(),Ywe(r,y,x,i)||((zp.instantAnimations||!C)&&z?.(OO(r,u,a)),r[0]=r[r.length-1],vD(u),u.repeat=0);const V={startTime:p?this.resolvedAt?this.resolvedAt-this.createdAt>Qwe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...u,keyframes:r},G=!R&&Kwe(V)?new Gwe({...V,element:V.motionValue.owner.current}):new zO(V);G.finished.then(()=>this.notifyFinished()).catch(Od),this.pendingTimeline&&(this.stopTimeline=G.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=G}get finished(){return this._animation?this.animation.finished:this._finished}then(r,a){return this.finished.finally(r).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),zwe()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(r){this.animation.time=r}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(r){this.animation.speed=r}get startTime(){return this.animation.startTime}attachTimeline(r){return this._animation?this.stopTimeline=this.animation.attachTimeline(r):this.pendingTimeline=r,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const eSe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function tSe(e){const r=eSe.exec(e);if(!r)return[,];const[,a,u,p]=r;return[`--${a??u}`,p]}function I7(e,r,a=1){const[u,p]=tSe(e);if(!u)return;const y=window.getComputedStyle(r).getPropertyValue(u);if(y){const x=y.trim();return W9(x)?parseFloat(x):x}return MO(p)?I7(p,r,a+1):p}function kO(e,r){return e?.[r]??e?.default??e}const M7=new Set(["width","height","top","left","right","bottom",...nv]),rSe={test:e=>e==="auto",parse:e=>e},C7=e=>r=>r.test(e),A7=[rv,ui,zf,Fm,H1e,G1e,rSe],l$=e=>A7.find(C7(e));function nSe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||G9(e):!0}const iSe=new Set(["brightness","contrast","saturate","opacity"]);function oSe(e){const[r,a]=e.slice(0,-1).split("(");if(r==="drop-shadow")return e;const[u]=a.match(CO)||[];if(!u)return e;const p=a.replace(u,"");let y=iSe.has(r)?1:0;return u!==a&&(y*=100),r+"("+y+p+")"}const sSe=/\b([a-z-]*)\(.*?\)/gu,xD={...qm,getAnimatableNone:e=>{const r=e.match(sSe);return r?r.map(oSe).join(" "):e}},c$={...rv,transform:Math.round},aSe={rotate:Fm,rotateX:Fm,rotateY:Fm,rotateZ:Fm,scale:$1,scaleX:$1,scaleY:$1,scaleZ:$1,skew:Fm,skewX:Fm,skewY:Fm,distance:ui,translateX:ui,translateY:ui,translateZ:ui,x:ui,y:ui,z:ui,perspective:ui,transformPerspective:ui,opacity:cx,originX:XU,originY:XU,originZ:ui},BO={borderWidth:ui,borderTopWidth:ui,borderRightWidth:ui,borderBottomWidth:ui,borderLeftWidth:ui,borderRadius:ui,radius:ui,borderTopLeftRadius:ui,borderTopRightRadius:ui,borderBottomRightRadius:ui,borderBottomLeftRadius:ui,width:ui,maxWidth:ui,height:ui,maxHeight:ui,top:ui,right:ui,bottom:ui,left:ui,padding:ui,paddingTop:ui,paddingRight:ui,paddingBottom:ui,paddingLeft:ui,margin:ui,marginTop:ui,marginRight:ui,marginBottom:ui,marginLeft:ui,backgroundPositionX:ui,backgroundPositionY:ui,...aSe,zIndex:c$,fillOpacity:cx,strokeOpacity:cx,numOctaves:c$},lSe={...BO,color:Ya,backgroundColor:Ya,outlineColor:Ya,fill:Ya,stroke:Ya,borderColor:Ya,borderTopColor:Ya,borderRightColor:Ya,borderBottomColor:Ya,borderLeftColor:Ya,filter:xD,WebkitFilter:xD},D7=e=>lSe[e];function R7(e,r){let a=D7(e);return a!==xD&&(a=qm),a.getAnimatableNone?a.getAnimatableNone(r):void 0}const cSe=new Set(["auto","none","0"]);function uSe(e,r,a){let u=0,p;for(;u<e.length&&!p;){const y=e[u];typeof y=="string"&&!cSe.has(y)&&ux(y).values.length&&(p=e[u]),u++}if(p&&a)for(const y of r)e[y]=R7(a,p)}class dSe extends FO{constructor(r,a,u,p,y){super(r,a,u,p,y,!0)}readKeyframes(){const{unresolvedKeyframes:r,element:a,name:u}=this;if(!a||!a.current)return;super.readKeyframes();for(let C=0;C<r.length;C++){let R=r[C];if(typeof R=="string"&&(R=R.trim(),MO(R))){const z=I7(R,a.current);z!==void 0&&(r[C]=z),C===r.length-1&&(this.finalKeyframe=R)}}if(this.resolveNoneKeyframes(),!M7.has(u)||r.length!==2)return;const[p,y]=r,x=l$(p),i=l$(y);if(x!==i)if(i$(x)&&i$(i))for(let C=0;C<r.length;C++){const R=r[C];typeof R=="string"&&(r[C]=parseFloat(R))}else t_[u]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:r,name:a}=this,u=[];for(let p=0;p<r.length;p++)(r[p]===null||nSe(r[p]))&&u.push(p);u.length&&uSe(r,u,a)}measureInitialState(){const{element:r,unresolvedKeyframes:a,name:u}=this;if(!r||!r.current)return;u==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=t_[u](r.measureViewportBox(),window.getComputedStyle(r.current)),a[0]=this.measuredOrigin;const p=a[a.length-1];p!==void 0&&r.getValue(u,p).jump(p,!1)}measureEndState(){const{element:r,name:a,unresolvedKeyframes:u}=this;if(!r||!r.current)return;const p=r.getValue(a);p&&p.jump(this.measuredOrigin,!1);const y=u.length-1,x=u[y];u[y]=t_[a](r.measureViewportBox(),window.getComputedStyle(r.current)),x!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=x),this.removedTransforms?.length&&this.removedTransforms.forEach(([i,C])=>{r.getValue(i).set(C)}),this.resolveNoneKeyframes()}}function hSe(e,r,a){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let u=document;const p=a?.[e]??u.querySelectorAll(e);return p?Array.from(p):[]}return Array.from(e)}const O7=(e,r)=>r&&typeof e=="number"?r.transform(e):e;function fSe(e){return q9(e)&&"offsetHeight"in e}const u$=30,pSe=e=>!isNaN(parseFloat(e));class mSe{constructor(r,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=u=>{const p=Su.now();if(this.updatedAt!==p&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(u),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const y of this.dependents)y.dirty()},this.hasAnimated=!1,this.setCurrent(r),this.owner=a.owner}setCurrent(r){this.current=r,this.updatedAt=Su.now(),this.canTrackVelocity===null&&r!==void 0&&(this.canTrackVelocity=pSe(this.current))}setPrevFrameValue(r=this.current){this.prevFrameValue=r,this.prevUpdatedAt=this.updatedAt}onChange(r){return this.on("change",r)}on(r,a){this.events[r]||(this.events[r]=new SO);const u=this.events[r].add(a);return r==="change"?()=>{u(),ks.read(()=>{this.events.change.getSize()||this.stop()})}:u}clearListeners(){for(const r in this.events)this.events[r].clear()}attach(r,a){this.passiveEffect=r,this.stopPassiveEffect=a}set(r){this.passiveEffect?this.passiveEffect(r,this.updateAndNotify):this.updateAndNotify(r)}setWithVelocity(r,a,u){this.set(a),this.prev=void 0,this.prevFrameValue=r,this.prevUpdatedAt=this.updatedAt-u}jump(r,a=!0){this.updateAndNotify(r),this.prev=r,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(r){this.dependents||(this.dependents=new Set),this.dependents.add(r)}removeDependent(r){this.dependents&&this.dependents.delete(r)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const r=Su.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||r-this.updatedAt>u$)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,u$);return H9(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(r){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=r(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Uy(e,r){return new mSe(e,r)}const{schedule:jO}=l7(queueMicrotask,!1),Th={x:!1,y:!1};function L7(){return Th.x||Th.y}function gSe(e){return e==="x"||e==="y"?Th[e]?null:(Th[e]=!0,()=>{Th[e]=!1}):Th.x||Th.y?null:(Th.x=Th.y=!0,()=>{Th.x=Th.y=!1})}function z7(e,r){const a=hSe(e),u=new AbortController,p={passive:!0,...r,signal:u.signal};return[a,p,()=>u.abort()]}function d$(e){return!(e.pointerType==="touch"||L7())}function _Se(e,r,a={}){const[u,p,y]=z7(e,a),x=i=>{if(!d$(i))return;const{target:C}=i,R=r(C,i);if(typeof R!="function"||!C)return;const z=F=>{d$(F)&&(R(F),C.removeEventListener("pointerleave",z))};C.addEventListener("pointerleave",z,p)};return u.forEach(i=>{i.addEventListener("pointerenter",x,p)}),y}const F7=(e,r)=>r?e===r?!0:F7(e,r.parentElement):!1,NO=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,ySe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function vSe(e){return ySe.has(e.tagName)||e.tabIndex!==-1}const pw=new WeakSet;function h$(e){return r=>{r.key==="Enter"&&e(r)}}function ZC(e,r){e.dispatchEvent(new PointerEvent("pointer"+r,{isPrimary:!0,bubbles:!0}))}const xSe=(e,r)=>{const a=e.currentTarget;if(!a)return;const u=h$(()=>{if(pw.has(a))return;ZC(a,"down");const p=h$(()=>{ZC(a,"up")}),y=()=>ZC(a,"cancel");a.addEventListener("keyup",p,r),a.addEventListener("blur",y,r)});a.addEventListener("keydown",u,r),a.addEventListener("blur",()=>a.removeEventListener("keydown",u),r)};function f$(e){return NO(e)&&!L7()}function bSe(e,r,a={}){const[u,p,y]=z7(e,a),x=i=>{const C=i.currentTarget;if(!f$(i))return;pw.add(C);const R=r(C,i),z=(G,H)=>{window.removeEventListener("pointerup",F),window.removeEventListener("pointercancel",V),pw.has(C)&&pw.delete(C),f$(G)&&typeof R=="function"&&R(G,{success:H})},F=G=>{z(G,C===window||C===document||a.useGlobalTarget||F7(C,G.target))},V=G=>{z(G,!1)};window.addEventListener("pointerup",F,p),window.addEventListener("pointercancel",V,p)};return u.forEach(i=>{(a.useGlobalTarget?window:i).addEventListener("pointerdown",x,p),fSe(i)&&(i.addEventListener("focus",R=>xSe(R,p)),!vSe(i)&&!i.hasAttribute("tabindex")&&(i.tabIndex=0))}),y}function k7(e){return q9(e)&&"ownerSVGElement"in e}function wSe(e){return k7(e)&&e.tagName==="svg"}const Ac=e=>!!(e&&e.getVelocity),SSe=[...A7,Ya,qm],TSe=e=>SSe.find(C7(e));function p$(e,r){return r.max===r.min?0:e/(r.max-r.min)*100}const f0={correct:(e,r)=>{if(!r.target)return e;if(typeof e=="string")if(ui.test(e))e=parseFloat(e);else return e;const a=p$(e,r.target.x),u=p$(e,r.target.y);return`${a}% ${u}%`}},ESe={correct:(e,{treeScale:r,projectionDelta:a})=>{const u=e,p=qm.parse(e);if(p.length>5)return u;const y=qm.createTransformer(e),x=typeof p[0]!="number"?1:0,i=a.x.scale*r.x,C=a.y.scale*r.y;p[0+x]/=i,p[1+x]/=C;const R=ta(i,C,.5);return typeof p[2+x]=="number"&&(p[2+x]/=R),typeof p[3+x]=="number"&&(p[3+x]/=R),y(p)}},bD={borderRadius:{...f0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:f0,borderTopRightRadius:f0,borderBottomLeftRadius:f0,borderBottomRightRadius:f0,boxShadow:ESe};function B7(e,{layout:r,layoutId:a}){return iv.has(e)||e.startsWith("origin")||(r||a!==void 0)&&(!!bD[e]||e==="opacity")}const PSe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ISe=nv.length;function MSe(e,r,a){let u="",p=!0;for(let y=0;y<ISe;y++){const x=nv[y],i=e[x];if(i===void 0)continue;let C=!0;if(typeof i=="number"?C=i===(x.startsWith("scale")?1:0):C=parseFloat(i)===0,!C||a){const R=O7(i,BO[x]);if(!C){p=!1;const z=PSe[x]||x;u+=`${z}(${R}) `}a&&(r[x]=R)}}return u=u.trim(),a?u=a(r,p?"":u):p&&(u="none"),u}function VO(e,r,a){const{style:u,vars:p,transformOrigin:y}=e;let x=!1,i=!1;for(const C in r){const R=r[C];if(iv.has(C)){x=!0;continue}else if(u7(C)){p[C]=R;continue}else{const z=O7(R,BO[C]);C.startsWith("origin")?(i=!0,y[C]=z):u[C]=z}}if(r.transform||(x||a?u.transform=MSe(r,e.transform,a):u.transform&&(u.transform="none")),i){const{originX:C="50%",originY:R="50%",originZ:z=0}=y;u.transformOrigin=`${C} ${R} ${z}`}}const UO=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function j7(e,r,a){for(const u in r)!Ac(r[u])&&!B7(u,a)&&(e[u]=r[u])}function CSe({transformTemplate:e},r){return ge.useMemo(()=>{const a=UO();return VO(a,r,e),Object.assign({},a.vars,a.style)},[r])}function ASe(e,r){const a=e.style||{},u={};return j7(u,a,e),Object.assign(u,CSe(e,r)),u}function DSe(e,r){const a={},u=ASe(e,r);return e.drag&&e.dragListener!==!1&&(a.draggable=!1,u.userSelect=u.WebkitUserSelect=u.WebkitTouchCallout="none",u.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=u,a}const RSe={offset:"stroke-dashoffset",array:"stroke-dasharray"},OSe={offset:"strokeDashoffset",array:"strokeDasharray"};function LSe(e,r,a=1,u=0,p=!0){e.pathLength=1;const y=p?RSe:OSe;e[y.offset]=ui.transform(-u);const x=ui.transform(r),i=ui.transform(a);e[y.array]=`${x} ${i}`}function N7(e,{attrX:r,attrY:a,attrScale:u,pathLength:p,pathSpacing:y=1,pathOffset:x=0,...i},C,R,z){if(VO(e,i,R),C){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:F,style:V}=e;F.transform&&(V.transform=F.transform,delete F.transform),(V.transform||F.transformOrigin)&&(V.transformOrigin=F.transformOrigin??"50% 50%",delete F.transformOrigin),V.transform&&(V.transformBox=z?.transformBox??"fill-box",delete F.transformBox),r!==void 0&&(F.x=r),a!==void 0&&(F.y=a),u!==void 0&&(F.scale=u),p!==void 0&&LSe(F,p,y,x,!1)}const V7=()=>({...UO(),attrs:{}}),U7=e=>typeof e=="string"&&e.toLowerCase()==="svg";function zSe(e,r,a,u){const p=ge.useMemo(()=>{const y=V7();return N7(y,r,U7(u),e.transformTemplate,e.style),{...y.attrs,style:{...y.style}}},[r]);if(e.style){const y={};j7(y,e.style,e),p.style={...y,...p.style}}return p}const FSe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Nw(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||FSe.has(e)}let $7=e=>!Nw(e);function kSe(e){typeof e=="function"&&($7=r=>r.startsWith("on")?!Nw(r):e(r))}try{kSe(require("@emotion/is-prop-valid").default)}catch{}function BSe(e,r,a){const u={};for(const p in e)p==="values"&&typeof e.values=="object"||($7(p)||a===!0&&Nw(p)||!r&&!Nw(p)||e.draggable&&p.startsWith("onDrag"))&&(u[p]=e[p]);return u}const jSe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function $O(e){return typeof e!="string"||e.includes("-")?!1:!!(jSe.indexOf(e)>-1||/[A-Z]/u.test(e))}function NSe(e,r,a,{latestValues:u},p,y=!1){const i=($O(e)?zSe:DSe)(r,u,p,e),C=BSe(r,typeof e=="string",y),R=e!==ge.Fragment?{...C,...i,ref:a}:{},{children:z}=r,F=ge.useMemo(()=>Ac(z)?z.get():z,[z]);return ge.createElement(e,{...R,children:F})}const WO=ge.createContext(null);function m$(e){const r=[{},{}];return e?.values.forEach((a,u)=>{r[0][u]=a.get(),r[1][u]=a.getVelocity()}),r}function qO(e,r,a,u){if(typeof r=="function"){const[p,y]=m$(u);r=r(a!==void 0?a:e.custom,p,y)}if(typeof r=="string"&&(r=e.variants&&e.variants[r]),typeof r=="function"){const[p,y]=m$(u);r=r(a!==void 0?a:e.custom,p,y)}return r}function VSe(e){const r=ge.useRef(null);return r.current===null&&(r.current=e()),r.current}function mw(e){return Ac(e)?e.get():e}function USe({scrapeMotionValuesFromProps:e,createRenderState:r},a,u,p){return{latestValues:$Se(a,u,p,e),renderState:r()}}function $Se(e,r,a,u){const p={},y=u(e,{});for(const V in y)p[V]=mw(y[V]);let{initial:x,animate:i}=e;const C=LS(e),R=a7(e);r&&R&&!C&&e.inherit!==!1&&(x===void 0&&(x=r.initial),i===void 0&&(i=r.animate));let z=a?a.initial===!1:!1;z=z||x===!1;const F=z?i:x;if(F&&typeof F!="boolean"&&!OS(F)){const V=Array.isArray(F)?F:[F];for(let G=0;G<V.length;G++){const H=qO(e,V[G]);if(H){const{transitionEnd:Z,transition:J,...se}=H;for(const pe in se){let ve=se[pe];if(Array.isArray(ve)){const Ne=z?ve.length-1:0;ve=ve[Ne]}ve!==null&&(p[pe]=ve)}for(const pe in Z)p[pe]=Z[pe]}}}return p}const W7=e=>(r,a)=>{const u=ge.useContext(RS),p=ge.useContext(WO),y=()=>USe(e,r,u,p);return a?y():VSe(y)};function GO(e,r,a){const{style:u}=e,p={};for(const y in u)(Ac(u[y])||r.style&&Ac(r.style[y])||B7(y,e)||a?.getValue(y)?.liveStyle!==void 0)&&(p[y]=u[y]);return p}const WSe=W7({scrapeMotionValuesFromProps:GO,createRenderState:UO});function q7(e,r,a){const u=GO(e,r,a);for(const p in e)if(Ac(e[p])||Ac(r[p])){const y=nv.indexOf(p)!==-1?"attr"+p.charAt(0).toUpperCase()+p.substring(1):p;u[y]=e[p]}return u}const qSe=W7({scrapeMotionValuesFromProps:q7,createRenderState:V7}),HO=typeof window<"u",g$={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},$y={};for(const e in g$)$y[e]={isEnabled:r=>g$[e].some(a=>!!r[a])};function GSe(e){for(const r in e)$y[r]={...$y[r],...e[r]}}const HSe=Symbol.for("motionComponentSymbol");function yy(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function YSe(e,r,a){return ge.useCallback(u=>{u&&e.onMount&&e.onMount(u),r&&(u?r.mount(u):r.unmount()),a&&(typeof a=="function"?a(u):yy(a)&&(a.current=u))},[r])}const YO=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),ZSe="framerAppearId",G7="data-"+YO(ZSe),H7=ge.createContext({}),XSe=HO?ge.useLayoutEffect:ge.useEffect;function KSe(e,r,a,u,p){const{visualElement:y}=ge.useContext(RS),x=ge.useContext(o7),i=ge.useContext(WO),C=ge.useContext(s7).reducedMotion,R=ge.useRef(null);u=u||x.renderer,!R.current&&u&&(R.current=u(e,{visualState:r,parent:y,props:a,presenceContext:i,blockInitialAnimation:i?i.initial===!1:!1,reducedMotionConfig:C}));const z=R.current,F=ge.useContext(H7);z&&!z.projection&&p&&(z.type==="html"||z.type==="svg")&&QSe(R.current,a,p,F);const V=ge.useRef(!1);ge.useInsertionEffect(()=>{z&&V.current&&z.update(a,i)});const G=a[G7],H=ge.useRef(!!G&&!window.MotionHandoffIsComplete?.(G)&&window.MotionHasOptimisedAnimation?.(G));return XSe(()=>{z&&(V.current=!0,window.MotionIsMounted=!0,z.updateFeatures(),z.scheduleRenderMicrotask(),H.current&&z.animationState&&z.animationState.animateChanges())}),ge.useEffect(()=>{z&&(!H.current&&z.animationState&&z.animationState.animateChanges(),H.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(G)}),H.current=!1),z.enteringChildren=void 0)}),z}function QSe(e,r,a,u){const{layoutId:p,layout:y,drag:x,dragConstraints:i,layoutScroll:C,layoutRoot:R,layoutCrossfade:z}=r;e.projection=new a(e.latestValues,r["data-framer-portal-id"]?void 0:Y7(e.parent)),e.projection.setOptions({layoutId:p,layout:y,alwaysMeasureLayout:!!x||i&&yy(i),visualElement:e,animationType:typeof y=="string"?y:"both",initialPromotionConfig:u,crossfade:z,layoutScroll:C,layoutRoot:R})}function Y7(e){if(e)return e.options.allowProjection!==!1?e.projection:Y7(e.parent)}function JSe(e,{forwardMotionProps:r=!1}={},a,u){a&&GSe(a);const p=$O(e)?qSe:WSe;function y(i,C){let R;const z={...ge.useContext(s7),...i,layoutId:eTe(i)},{isStatic:F}=z,V=F1e(i),G=p(i,F);if(!F&&HO){tTe();const H=rTe(z);R=H.MeasureLayout,V.visualElement=KSe(e,G,z,u,H.ProjectionNode)}return X.jsxs(RS.Provider,{value:V,children:[R&&V.visualElement?X.jsx(R,{visualElement:V.visualElement,...z}):null,NSe(e,i,YSe(G,V.visualElement,C),G,F,r)]})}y.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const x=ge.forwardRef(y);return x[HSe]=e,x}function eTe({layoutId:e}){const r=ge.useContext(i7).id;return r&&e!==void 0?r+"-"+e:e}function tTe(e,r){ge.useContext(o7).strict}function rTe(e){const{drag:r,layout:a}=$y;if(!r&&!a)return{};const u={...r,...a};return{MeasureLayout:r?.isEnabled(e)||a?.isEnabled(e)?u.MeasureLayout:void 0,ProjectionNode:u.ProjectionNode}}function Z7({top:e,left:r,right:a,bottom:u}){return{x:{min:r,max:a},y:{min:e,max:u}}}function nTe({x:e,y:r}){return{top:r.min,right:e.max,bottom:r.max,left:e.min}}function iTe(e,r){if(!r)return e;const a=r({x:e.left,y:e.top}),u=r({x:e.right,y:e.bottom});return{top:a.y,left:a.x,bottom:u.y,right:u.x}}function XC(e){return e===void 0||e===1}function wD({scale:e,scaleX:r,scaleY:a}){return!XC(e)||!XC(r)||!XC(a)}function Ng(e){return wD(e)||X7(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function X7(e){return _$(e.x)||_$(e.y)}function _$(e){return e&&e!=="0%"}function Vw(e,r,a){const u=e-a,p=r*u;return a+p}function y$(e,r,a,u,p){return p!==void 0&&(e=Vw(e,p,u)),Vw(e,a,u)+r}function SD(e,r=0,a=1,u,p){e.min=y$(e.min,r,a,u,p),e.max=y$(e.max,r,a,u,p)}function K7(e,{x:r,y:a}){SD(e.x,r.translate,r.scale,r.originPoint),SD(e.y,a.translate,a.scale,a.originPoint)}const v$=.999999999999,x$=1.0000000000001;function oTe(e,r,a,u=!1){const p=a.length;if(!p)return;r.x=r.y=1;let y,x;for(let i=0;i<p;i++){y=a[i],x=y.projectionDelta;const{visualElement:C}=y.options;C&&C.props.style&&C.props.style.display==="contents"||(u&&y.options.layoutScroll&&y.scroll&&y!==y.root&&xy(e,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),x&&(r.x*=x.x.scale,r.y*=x.y.scale,K7(e,x)),u&&Ng(y.latestValues)&&xy(e,y.latestValues))}r.x<x$&&r.x>v$&&(r.x=1),r.y<x$&&r.y>v$&&(r.y=1)}function vy(e,r){e.min=e.min+r,e.max=e.max+r}function b$(e,r,a,u,p=.5){const y=ta(e.min,e.max,p);SD(e,r,a,y,u)}function xy(e,r){b$(e.x,r.x,r.scaleX,r.scale,r.originX),b$(e.y,r.y,r.scaleY,r.scale,r.originY)}function Q7(e,r){return Z7(iTe(e.getBoundingClientRect(),r))}function sTe(e,r,a){const u=Q7(e,a),{scroll:p}=r;return p&&(vy(u.x,p.offset.x),vy(u.y,p.offset.y)),u}const w$=()=>({translate:0,scale:1,origin:0,originPoint:0}),by=()=>({x:w$(),y:w$()}),S$=()=>({min:0,max:0}),sl=()=>({x:S$(),y:S$()}),TD={current:null},J7={current:!1};function aTe(){if(J7.current=!0,!!HO)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),r=()=>TD.current=e.matches;e.addEventListener("change",r),r()}else TD.current=!1}const lTe=new WeakMap;function cTe(e,r,a){for(const u in r){const p=r[u],y=a[u];if(Ac(p))e.addValue(u,p);else if(Ac(y))e.addValue(u,Uy(p,{owner:e}));else if(y!==p)if(e.hasValue(u)){const x=e.getValue(u);x.liveStyle===!0?x.jump(p):x.hasAnimated||x.set(p)}else{const x=e.getStaticValue(u);e.addValue(u,Uy(x!==void 0?x:p,{owner:e}))}}for(const u in a)r[u]===void 0&&e.removeValue(u);return r}const T$=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class uTe{scrapeMotionValuesFromProps(r,a,u){return{}}constructor({parent:r,props:a,presenceContext:u,reducedMotionConfig:p,blockInitialAnimation:y,visualState:x},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=FO,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const V=Su.now();this.renderScheduledAt<V&&(this.renderScheduledAt=V,ks.render(this.render,!1,!0))};const{latestValues:C,renderState:R}=x;this.latestValues=C,this.baseTarget={...C},this.initialValues=a.initial?{...C}:{},this.renderState=R,this.parent=r,this.props=a,this.presenceContext=u,this.depth=r?r.depth+1:0,this.reducedMotionConfig=p,this.options=i,this.blockInitialAnimation=!!y,this.isControllingVariants=LS(a),this.isVariantNode=a7(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(r&&r.current);const{willChange:z,...F}=this.scrapeMotionValuesFromProps(a,{},this);for(const V in F){const G=F[V];C[V]!==void 0&&Ac(G)&&G.set(C[V])}}mount(r){this.current=r,lTe.set(r,this),this.projection&&!this.projection.instance&&this.projection.mount(r),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,u)=>this.bindToMotionValue(u,a)),J7.current||aTe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:TD.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Wm(this.notifyUpdate),Wm(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const a=this.features[r];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(r){this.children.add(r),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(r)}removeChild(r){this.children.delete(r),this.enteringChildren&&this.enteringChildren.delete(r)}bindToMotionValue(r,a){this.valueSubscriptions.has(r)&&this.valueSubscriptions.get(r)();const u=iv.has(r);u&&this.onBindTransform&&this.onBindTransform();const p=a.on("change",x=>{this.latestValues[r]=x,this.props.onUpdate&&ks.preRender(this.notifyUpdate),u&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let y;window.MotionCheckAppearSync&&(y=window.MotionCheckAppearSync(this,r,a)),this.valueSubscriptions.set(r,()=>{p(),y&&y(),a.owner&&a.stop()})}sortNodePosition(r){return!this.current||!this.sortInstanceNodePosition||this.type!==r.type?0:this.sortInstanceNodePosition(this.current,r.current)}updateFeatures(){let r="animation";for(r in $y){const a=$y[r];if(!a)continue;const{isEnabled:u,Feature:p}=a;if(!this.features[r]&&p&&u(this.props)&&(this.features[r]=new p(this)),this.features[r]){const y=this.features[r];y.isMounted?y.update():(y.mount(),y.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):sl()}getStaticValue(r){return this.latestValues[r]}setStaticValue(r,a){this.latestValues[r]=a}update(r,a){(r.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=r,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let u=0;u<T$.length;u++){const p=T$[u];this.propEventSubscriptions[p]&&(this.propEventSubscriptions[p](),delete this.propEventSubscriptions[p]);const y="on"+p,x=r[y];x&&(this.propEventSubscriptions[p]=this.on(p,x))}this.prevMotionValues=cTe(this,this.scrapeMotionValuesFromProps(r,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(r){return this.props.variants?this.props.variants[r]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(r){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(r),()=>a.variantChildren.delete(r)}addValue(r,a){const u=this.values.get(r);a!==u&&(u&&this.removeValue(r),this.bindToMotionValue(r,a),this.values.set(r,a),this.latestValues[r]=a.get())}removeValue(r){this.values.delete(r);const a=this.valueSubscriptions.get(r);a&&(a(),this.valueSubscriptions.delete(r)),delete this.latestValues[r],this.removeValueFromRenderState(r,this.renderState)}hasValue(r){return this.values.has(r)}getValue(r,a){if(this.props.values&&this.props.values[r])return this.props.values[r];let u=this.values.get(r);return u===void 0&&a!==void 0&&(u=Uy(a===null?void 0:a,{owner:this}),this.addValue(r,u)),u}readValue(r,a){let u=this.latestValues[r]!==void 0||!this.current?this.latestValues[r]:this.getBaseTargetFromProps(this.props,r)??this.readValueFromInstance(this.current,r,this.options);return u!=null&&(typeof u=="string"&&(W9(u)||G9(u))?u=parseFloat(u):!TSe(u)&&qm.test(a)&&(u=R7(r,a)),this.setBaseTarget(r,Ac(u)?u.get():u)),Ac(u)?u.get():u}setBaseTarget(r,a){this.baseTarget[r]=a}getBaseTarget(r){const{initial:a}=this.props;let u;if(typeof a=="string"||typeof a=="object"){const y=qO(this.props,a,this.presenceContext?.custom);y&&(u=y[r])}if(a&&u!==void 0)return u;const p=this.getBaseTargetFromProps(this.props,r);return p!==void 0&&!Ac(p)?p:this.initialValues[r]!==void 0&&u===void 0?void 0:this.baseTarget[r]}on(r,a){return this.events[r]||(this.events[r]=new SO),this.events[r].add(a)}notify(r,...a){this.events[r]&&this.events[r].notify(...a)}scheduleRenderMicrotask(){jO.render(this.render)}}class eY extends uTe{constructor(){super(...arguments),this.KeyframeResolver=dSe}sortInstanceNodePosition(r,a){return r.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(r,a){return r.style?r.style[a]:void 0}removeValueFromRenderState(r,{vars:a,style:u}){delete a[r],delete u[r]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:r}=this.props;Ac(r)&&(this.childSubscription=r.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function tY(e,{style:r,vars:a},u,p){const y=e.style;let x;for(x in r)y[x]=r[x];p?.applyProjectionStyles(y,u);for(x in a)y.setProperty(x,a[x])}function dTe(e){return window.getComputedStyle(e)}class hTe extends eY{constructor(){super(...arguments),this.type="html",this.renderInstance=tY}readValueFromInstance(r,a){if(iv.has(a))return this.projection?.isProjecting?pD(a):Awe(r,a);{const u=dTe(r),p=(u7(a)?u.getPropertyValue(a):u[a])||0;return typeof p=="string"?p.trim():p}}measureInstanceViewportBox(r,{transformPagePoint:a}){return Q7(r,a)}build(r,a,u){VO(r,a,u.transformTemplate)}scrapeMotionValuesFromProps(r,a,u){return GO(r,a,u)}}const rY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function fTe(e,r,a,u){tY(e,r,void 0,u);for(const p in r.attrs)e.setAttribute(rY.has(p)?p:YO(p),r.attrs[p])}class pTe extends eY{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=sl}getBaseTargetFromProps(r,a){return r[a]}readValueFromInstance(r,a){if(iv.has(a)){const u=D7(a);return u&&u.default||0}return a=rY.has(a)?a:YO(a),r.getAttribute(a)}scrapeMotionValuesFromProps(r,a,u){return q7(r,a,u)}build(r,a,u){N7(r,a,this.isSVGTag,u.transformTemplate,u.style)}renderInstance(r,a,u,p){fTe(r,a,u,p)}mount(r){this.isSVGTag=U7(r.tagName),super.mount(r)}}const mTe=(e,r)=>$O(e)?new pTe(r):new hTe(r,{allowProjection:e!==ge.Fragment});function Dy(e,r,a){const u=e.getProps();return qO(u,r,a!==void 0?a:u.custom,e)}const ED=e=>Array.isArray(e);function gTe(e,r,a){e.hasValue(r)?e.getValue(r).set(a):e.addValue(r,Uy(a))}function _Te(e){return ED(e)?e[e.length-1]||0:e}function yTe(e,r){const a=Dy(e,r);let{transitionEnd:u={},transition:p={},...y}=a||{};y={...y,...u};for(const x in y){const i=_Te(y[x]);gTe(e,x,i)}}function vTe(e){return!!(Ac(e)&&e.add)}function PD(e,r){const a=e.getValue("willChange");if(vTe(a))return a.add(r);if(!a&&zp.WillChange){const u=new zp.WillChange("auto");e.addValue("willChange",u),u.add(r)}}function nY(e){return e.props[G7]}const xTe=e=>e!==null;function bTe(e,{repeat:r,repeatType:a="loop"},u){const p=e.filter(xTe),y=r&&a!=="loop"&&r%2===1?0:p.length-1;return p[y]}const wTe={type:"spring",stiffness:500,damping:25,restSpeed:10},STe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),TTe={type:"keyframes",duration:.8},ETe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},PTe=(e,{keyframes:r})=>r.length>2?TTe:iv.has(e)?e.startsWith("scale")?STe(r[1]):wTe:ETe;function ITe({when:e,delay:r,delayChildren:a,staggerChildren:u,staggerDirection:p,repeat:y,repeatType:x,repeatDelay:i,from:C,elapsed:R,...z}){return!!Object.keys(z).length}const ZO=(e,r,a,u={},p,y)=>x=>{const i=kO(u,e)||{},C=i.delay||u.delay||0;let{elapsed:R=0}=u;R=R-Lf(C);const z={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:r.getVelocity(),...i,delay:-R,onUpdate:V=>{r.set(V),i.onUpdate&&i.onUpdate(V)},onComplete:()=>{x(),i.onComplete&&i.onComplete()},name:e,motionValue:r,element:y?void 0:p};ITe(i)||Object.assign(z,PTe(e,z)),z.duration&&(z.duration=Lf(z.duration)),z.repeatDelay&&(z.repeatDelay=Lf(z.repeatDelay)),z.from!==void 0&&(z.keyframes[0]=z.from);let F=!1;if((z.type===!1||z.duration===0&&!z.repeatDelay)&&(vD(z),z.delay===0&&(F=!0)),(zp.instantAnimations||zp.skipAnimations)&&(F=!0,vD(z),z.delay=0),z.allowFlatten=!i.type&&!i.ease,F&&!y&&r.get()!==void 0){const V=bTe(z.keyframes,i);if(V!==void 0){ks.update(()=>{z.onUpdate(V),z.onComplete()});return}}return i.isSync?new zO(z):new Jwe(z)};function MTe({protectedKeys:e,needsAnimating:r},a){const u=e.hasOwnProperty(a)&&r[a]!==!0;return r[a]=!1,u}function iY(e,r,{delay:a=0,transitionOverride:u,type:p}={}){let{transition:y=e.getDefaultTransition(),transitionEnd:x,...i}=r;u&&(y=u);const C=[],R=p&&e.animationState&&e.animationState.getState()[p];for(const z in i){const F=e.getValue(z,e.latestValues[z]??null),V=i[z];if(V===void 0||R&&MTe(R,z))continue;const G={delay:a,...kO(y||{},z)},H=F.get();if(H!==void 0&&!F.isAnimating&&!Array.isArray(V)&&V===H&&!G.velocity)continue;let Z=!1;if(window.MotionHandoffAnimation){const se=nY(e);if(se){const pe=window.MotionHandoffAnimation(se,z,ks);pe!==null&&(G.startTime=pe,Z=!0)}}PD(e,z),F.start(ZO(z,F,V,e.shouldReduceMotion&&M7.has(z)?{type:!1}:G,e,Z));const J=F.animation;J&&C.push(J)}return x&&Promise.all(C).then(()=>{ks.update(()=>{x&&yTe(e,x)})}),C}function oY(e,r,a,u=0,p=1){const y=Array.from(e).sort((R,z)=>R.sortNodePosition(z)).indexOf(r),x=e.size,i=(x-1)*u;return typeof a=="function"?a(y,x):p===1?y*u:i-y*u}function ID(e,r,a={}){const u=Dy(e,r,a.type==="exit"?e.presenceContext?.custom:void 0);let{transition:p=e.getDefaultTransition()||{}}=u||{};a.transitionOverride&&(p=a.transitionOverride);const y=u?()=>Promise.all(iY(e,u,a)):()=>Promise.resolve(),x=e.variantChildren&&e.variantChildren.size?(C=0)=>{const{delayChildren:R=0,staggerChildren:z,staggerDirection:F}=p;return CTe(e,r,C,R,z,F,a)}:()=>Promise.resolve(),{when:i}=p;if(i){const[C,R]=i==="beforeChildren"?[y,x]:[x,y];return C().then(()=>R())}else return Promise.all([y(),x(a.delay)])}function CTe(e,r,a=0,u=0,p=0,y=1,x){const i=[];for(const C of e.variantChildren)C.notify("AnimationStart",r),i.push(ID(C,r,{...x,delay:a+(typeof u=="function"?0:u)+oY(e.variantChildren,C,u,p,y)}).then(()=>C.notify("AnimationComplete",r)));return Promise.all(i)}function ATe(e,r,a={}){e.notify("AnimationStart",r);let u;if(Array.isArray(r)){const p=r.map(y=>ID(e,y,a));u=Promise.all(p)}else if(typeof r=="string")u=ID(e,r,a);else{const p=typeof r=="function"?Dy(e,r,a.custom):r;u=Promise.all(iY(e,p,a))}return u.then(()=>{e.notify("AnimationComplete",r)})}function sY(e,r){if(!Array.isArray(r))return!1;const a=r.length;if(a!==e.length)return!1;for(let u=0;u<a;u++)if(r[u]!==e[u])return!1;return!0}const DTe=IO.length;function aY(e){if(!e)return;if(!e.isControllingVariants){const a=e.parent?aY(e.parent)||{}:{};return e.props.initial!==void 0&&(a.initial=e.props.initial),a}const r={};for(let a=0;a<DTe;a++){const u=IO[a],p=e.props[u];(lx(p)||p===!1)&&(r[u]=p)}return r}const RTe=[...PO].reverse(),OTe=PO.length;function LTe(e){return r=>Promise.all(r.map(({animation:a,options:u})=>ATe(e,a,u)))}function zTe(e){let r=LTe(e),a=E$(),u=!0;const p=C=>(R,z)=>{const F=Dy(e,z,C==="exit"?e.presenceContext?.custom:void 0);if(F){const{transition:V,transitionEnd:G,...H}=F;R={...R,...H,...G}}return R};function y(C){r=C(e)}function x(C){const{props:R}=e,z=aY(e.parent)||{},F=[],V=new Set;let G={},H=1/0;for(let J=0;J<OTe;J++){const se=RTe[J],pe=a[se],ve=R[se]!==void 0?R[se]:z[se],Ne=lx(ve),_e=se===C?pe.isActive:null;_e===!1&&(H=J);let Re=ve===z[se]&&ve!==R[se]&&Ne;if(Re&&u&&e.manuallyAnimateOnMount&&(Re=!1),pe.protectedKeys={...G},!pe.isActive&&_e===null||!ve&&!pe.prevProp||OS(ve)||typeof ve=="boolean")continue;const ke=FTe(pe.prevProp,ve);let ze=ke||se===C&&pe.isActive&&!Re&&Ne||J>H&&Ne,et=!1;const ht=Array.isArray(ve)?ve:[ve];let Xt=ht.reduce(p(se),{});_e===!1&&(Xt={});const{prevResolvedValues:Ir={}}=pe,nr={...Ir,...Xt},Fr=lt=>{ze=!0,V.has(lt)&&(et=!0,V.delete(lt)),pe.needsAnimating[lt]=!0;const Et=e.getValue(lt);Et&&(Et.liveStyle=!1)};for(const lt in nr){const Et=Xt[lt],qt=Ir[lt];if(G.hasOwnProperty(lt))continue;let Gt=!1;ED(Et)&&ED(qt)?Gt=!sY(Et,qt):Gt=Et!==qt,Gt?Et!=null?Fr(lt):V.add(lt):Et!==void 0&&V.has(lt)?Fr(lt):pe.protectedKeys[lt]=!0}pe.prevProp=ve,pe.prevResolvedValues=Xt,pe.isActive&&(G={...G,...Xt}),u&&e.blockInitialAnimation&&(ze=!1);const Or=Re&&ke;ze&&(!Or||et)&&F.push(...ht.map(lt=>{const Et={type:se};if(typeof lt=="string"&&u&&!Or&&e.manuallyAnimateOnMount&&e.parent){const{parent:qt}=e,Gt=Dy(qt,lt);if(qt.enteringChildren&&Gt){const{delayChildren:tt}=Gt.transition||{};Et.delay=oY(qt.enteringChildren,e,tt)}}return{animation:lt,options:Et}}))}if(V.size){const J={};if(typeof R.initial!="boolean"){const se=Dy(e,Array.isArray(R.initial)?R.initial[0]:R.initial);se&&se.transition&&(J.transition=se.transition)}V.forEach(se=>{const pe=e.getBaseTarget(se),ve=e.getValue(se);ve&&(ve.liveStyle=!0),J[se]=pe??null}),F.push({animation:J})}let Z=!!F.length;return u&&(R.initial===!1||R.initial===R.animate)&&!e.manuallyAnimateOnMount&&(Z=!1),u=!1,Z?r(F):Promise.resolve()}function i(C,R){if(a[C].isActive===R)return Promise.resolve();e.variantChildren?.forEach(F=>F.animationState?.setActive(C,R)),a[C].isActive=R;const z=x(C);for(const F in a)a[F].protectedKeys={};return z}return{animateChanges:x,setActive:i,setAnimateFunction:y,getState:()=>a,reset:()=>{a=E$()}}}function FTe(e,r){return typeof r=="string"?r!==e:Array.isArray(r)?!sY(r,e):!1}function kg(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function E$(){return{animate:kg(!0),whileInView:kg(),whileHover:kg(),whileTap:kg(),whileDrag:kg(),whileFocus:kg(),exit:kg()}}class eg{constructor(r){this.isMounted=!1,this.node=r}update(){}}class kTe extends eg{constructor(r){super(r),r.animationState||(r.animationState=zTe(r))}updateAnimationControlsSubscription(){const{animate:r}=this.node.getProps();OS(r)&&(this.unmountControls=r.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:r}=this.node.getProps(),{animate:a}=this.node.prevProps||{};r!==a&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let BTe=0;class jTe extends eg{constructor(){super(...arguments),this.id=BTe++}update(){if(!this.node.presenceContext)return;const{isPresent:r,onExitComplete:a}=this.node.presenceContext,{isPresent:u}=this.node.prevPresenceContext||{};if(!this.node.animationState||r===u)return;const p=this.node.animationState.setActive("exit",!r);a&&!r&&p.then(()=>{a(this.id)})}mount(){const{register:r,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),r&&(this.unmount=r(this.id))}unmount(){}}const NTe={animation:{Feature:kTe},exit:{Feature:jTe}};function dx(e,r,a,u={passive:!0}){return e.addEventListener(r,a,u),()=>e.removeEventListener(r,a)}function Bx(e){return{point:{x:e.pageX,y:e.pageY}}}const VTe=e=>r=>NO(r)&&e(r,Bx(r));function V0(e,r,a,u){return dx(e,r,VTe(a),u)}const lY=1e-4,UTe=1-lY,$Te=1+lY,cY=.01,WTe=0-cY,qTe=0+cY;function Qc(e){return e.max-e.min}function GTe(e,r,a){return Math.abs(e-r)<=a}function P$(e,r,a,u=.5){e.origin=u,e.originPoint=ta(r.min,r.max,e.origin),e.scale=Qc(a)/Qc(r),e.translate=ta(a.min,a.max,e.origin)-e.originPoint,(e.scale>=UTe&&e.scale<=$Te||isNaN(e.scale))&&(e.scale=1),(e.translate>=WTe&&e.translate<=qTe||isNaN(e.translate))&&(e.translate=0)}function U0(e,r,a,u){P$(e.x,r.x,a.x,u?u.originX:void 0),P$(e.y,r.y,a.y,u?u.originY:void 0)}function I$(e,r,a){e.min=a.min+r.min,e.max=e.min+Qc(r)}function HTe(e,r,a){I$(e.x,r.x,a.x),I$(e.y,r.y,a.y)}function M$(e,r,a){e.min=r.min-a.min,e.max=e.min+Qc(r)}function Uw(e,r,a){M$(e.x,r.x,a.x),M$(e.y,r.y,a.y)}function Md(e){return[e("x"),e("y")]}const uY=({current:e})=>e?e.ownerDocument.defaultView:null,C$=(e,r)=>Math.abs(e-r);function YTe(e,r){const a=C$(e.x,r.x),u=C$(e.y,r.y);return Math.sqrt(a**2+u**2)}class dY{constructor(r,a,{transformPagePoint:u,contextWindow:p=window,dragSnapToOrigin:y=!1,distanceThreshold:x=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const V=QC(this.lastMoveEventInfo,this.history),G=this.startEvent!==null,H=YTe(V.offset,{x:0,y:0})>=this.distanceThreshold;if(!G&&!H)return;const{point:Z}=V,{timestamp:J}=ec;this.history.push({...Z,timestamp:J});const{onStart:se,onMove:pe}=this.handlers;G||(se&&se(this.lastMoveEvent,V),this.startEvent=this.lastMoveEvent),pe&&pe(this.lastMoveEvent,V)},this.handlePointerMove=(V,G)=>{this.lastMoveEvent=V,this.lastMoveEventInfo=KC(G,this.transformPagePoint),ks.update(this.updatePoint,!0)},this.handlePointerUp=(V,G)=>{this.end();const{onEnd:H,onSessionEnd:Z,resumeAnimation:J}=this.handlers;if(this.dragSnapToOrigin&&J&&J(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const se=QC(V.type==="pointercancel"?this.lastMoveEventInfo:KC(G,this.transformPagePoint),this.history);this.startEvent&&H&&H(V,se),Z&&Z(V,se)},!NO(r))return;this.dragSnapToOrigin=y,this.handlers=a,this.transformPagePoint=u,this.distanceThreshold=x,this.contextWindow=p||window;const i=Bx(r),C=KC(i,this.transformPagePoint),{point:R}=C,{timestamp:z}=ec;this.history=[{...R,timestamp:z}];const{onSessionStart:F}=a;F&&F(r,QC(C,this.history)),this.removeListeners=zx(V0(this.contextWindow,"pointermove",this.handlePointerMove),V0(this.contextWindow,"pointerup",this.handlePointerUp),V0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(r){this.handlers=r}end(){this.removeListeners&&this.removeListeners(),Wm(this.updatePoint)}}function KC(e,r){return r?{point:r(e.point)}:e}function A$(e,r){return{x:e.x-r.x,y:e.y-r.y}}function QC({point:e},r){return{point:e,delta:A$(e,hY(r)),offset:A$(e,ZTe(r)),velocity:XTe(r,.1)}}function ZTe(e){return e[0]}function hY(e){return e[e.length-1]}function XTe(e,r){if(e.length<2)return{x:0,y:0};let a=e.length-1,u=null;const p=hY(e);for(;a>=0&&(u=e[a],!(p.timestamp-u.timestamp>Lf(r)));)a--;if(!u)return{x:0,y:0};const y=Dd(p.timestamp-u.timestamp);if(y===0)return{x:0,y:0};const x={x:(p.x-u.x)/y,y:(p.y-u.y)/y};return x.x===1/0&&(x.x=0),x.y===1/0&&(x.y=0),x}function KTe(e,{min:r,max:a},u){return r!==void 0&&e<r?e=u?ta(r,e,u.min):Math.max(e,r):a!==void 0&&e>a&&(e=u?ta(a,e,u.max):Math.min(e,a)),e}function D$(e,r,a){return{min:r!==void 0?e.min+r:void 0,max:a!==void 0?e.max+a-(e.max-e.min):void 0}}function QTe(e,{top:r,left:a,bottom:u,right:p}){return{x:D$(e.x,a,p),y:D$(e.y,r,u)}}function R$(e,r){let a=r.min-e.min,u=r.max-e.max;return r.max-r.min<e.max-e.min&&([a,u]=[u,a]),{min:a,max:u}}function JTe(e,r){return{x:R$(e.x,r.x),y:R$(e.y,r.y)}}function e2e(e,r){let a=.5;const u=Qc(e),p=Qc(r);return p>u?a=ax(r.min,r.max-u,e.min):u>p&&(a=ax(e.min,e.max-p,r.min)),Lp(0,1,a)}function t2e(e,r){const a={};return r.min!==void 0&&(a.min=r.min-e.min),r.max!==void 0&&(a.max=r.max-e.min),a}const MD=.35;function r2e(e=MD){return e===!1?e=0:e===!0&&(e=MD),{x:O$(e,"left","right"),y:O$(e,"top","bottom")}}function O$(e,r,a){return{min:L$(e,r),max:L$(e,a)}}function L$(e,r){return typeof e=="number"?e:e[r]||0}const n2e=new WeakMap;class i2e{constructor(r){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=sl(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=r}start(r,{snapToCursor:a=!1,distanceThreshold:u}={}){const{presenceContext:p}=this.visualElement;if(p&&p.isPresent===!1)return;const y=F=>{const{dragSnapToOrigin:V}=this.getProps();V?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(Bx(F).point)},x=(F,V)=>{const{drag:G,dragPropagation:H,onDragStart:Z}=this.getProps();if(G&&!H&&(this.openDragLock&&this.openDragLock(),this.openDragLock=gSe(G),!this.openDragLock))return;this.latestPointerEvent=F,this.latestPanInfo=V,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Md(se=>{let pe=this.getAxisMotionValue(se).get()||0;if(zf.test(pe)){const{projection:ve}=this.visualElement;if(ve&&ve.layout){const Ne=ve.layout.layoutBox[se];Ne&&(pe=Qc(Ne)*(parseFloat(pe)/100))}}this.originPoint[se]=pe}),Z&&ks.postRender(()=>Z(F,V)),PD(this.visualElement,"transform");const{animationState:J}=this.visualElement;J&&J.setActive("whileDrag",!0)},i=(F,V)=>{this.latestPointerEvent=F,this.latestPanInfo=V;const{dragPropagation:G,dragDirectionLock:H,onDirectionLock:Z,onDrag:J}=this.getProps();if(!G&&!this.openDragLock)return;const{offset:se}=V;if(H&&this.currentDirection===null){this.currentDirection=o2e(se),this.currentDirection!==null&&Z&&Z(this.currentDirection);return}this.updateAxis("x",V.point,se),this.updateAxis("y",V.point,se),this.visualElement.render(),J&&J(F,V)},C=(F,V)=>{this.latestPointerEvent=F,this.latestPanInfo=V,this.stop(F,V),this.latestPointerEvent=null,this.latestPanInfo=null},R=()=>Md(F=>this.getAnimationState(F)==="paused"&&this.getAxisMotionValue(F).animation?.play()),{dragSnapToOrigin:z}=this.getProps();this.panSession=new dY(r,{onSessionStart:y,onStart:x,onMove:i,onSessionEnd:C,resumeAnimation:R},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:z,distanceThreshold:u,contextWindow:uY(this.visualElement)})}stop(r,a){const u=r||this.latestPointerEvent,p=a||this.latestPanInfo,y=this.isDragging;if(this.cancel(),!y||!p||!u)return;const{velocity:x}=p;this.startAnimation(x);const{onDragEnd:i}=this.getProps();i&&ks.postRender(()=>i(u,p))}cancel(){this.isDragging=!1;const{projection:r,animationState:a}=this.visualElement;r&&(r.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:u}=this.getProps();!u&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(r,a,u){const{drag:p}=this.getProps();if(!u||!W1(r,p,this.currentDirection))return;const y=this.getAxisMotionValue(r);let x=this.originPoint[r]+u[r];this.constraints&&this.constraints[r]&&(x=KTe(x,this.constraints[r],this.elastic[r])),y.set(x)}resolveConstraints(){const{dragConstraints:r,dragElastic:a}=this.getProps(),u=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,p=this.constraints;r&&yy(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&u?this.constraints=QTe(u.layoutBox,r):this.constraints=!1,this.elastic=r2e(a),p!==this.constraints&&u&&this.constraints&&!this.hasMutatedConstraints&&Md(y=>{this.constraints!==!1&&this.getAxisMotionValue(y)&&(this.constraints[y]=t2e(u.layoutBox[y],this.constraints[y]))})}resolveRefConstraints(){const{dragConstraints:r,onMeasureDragConstraints:a}=this.getProps();if(!r||!yy(r))return!1;const u=r.current,{projection:p}=this.visualElement;if(!p||!p.layout)return!1;const y=sTe(u,p.root,this.visualElement.getTransformPagePoint());let x=JTe(p.layout.layoutBox,y);if(a){const i=a(nTe(x));this.hasMutatedConstraints=!!i,i&&(x=Z7(i))}return x}startAnimation(r){const{drag:a,dragMomentum:u,dragElastic:p,dragTransition:y,dragSnapToOrigin:x,onDragTransitionEnd:i}=this.getProps(),C=this.constraints||{},R=Md(z=>{if(!W1(z,a,this.currentDirection))return;let F=C&&C[z]||{};x&&(F={min:0,max:0});const V=p?200:1e6,G=p?40:1e7,H={type:"inertia",velocity:u?r[z]:0,bounceStiffness:V,bounceDamping:G,timeConstant:750,restDelta:1,restSpeed:10,...y,...F};return this.startAxisValueAnimation(z,H)});return Promise.all(R).then(i)}startAxisValueAnimation(r,a){const u=this.getAxisMotionValue(r);return PD(this.visualElement,r),u.start(ZO(r,u,0,a,this.visualElement,!1))}stopAnimation(){Md(r=>this.getAxisMotionValue(r).stop())}pauseAnimation(){Md(r=>this.getAxisMotionValue(r).animation?.pause())}getAnimationState(r){return this.getAxisMotionValue(r).animation?.state}getAxisMotionValue(r){const a=`_drag${r.toUpperCase()}`,u=this.visualElement.getProps(),p=u[a];return p||this.visualElement.getValue(r,(u.initial?u.initial[r]:void 0)||0)}snapToCursor(r){Md(a=>{const{drag:u}=this.getProps();if(!W1(a,u,this.currentDirection))return;const{projection:p}=this.visualElement,y=this.getAxisMotionValue(a);if(p&&p.layout){const{min:x,max:i}=p.layout.layoutBox[a];y.set(r[a]-ta(x,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:r,dragConstraints:a}=this.getProps(),{projection:u}=this.visualElement;if(!yy(a)||!u||!this.constraints)return;this.stopAnimation();const p={x:0,y:0};Md(x=>{const i=this.getAxisMotionValue(x);if(i&&this.constraints!==!1){const C=i.get();p[x]=e2e({min:C,max:C},this.constraints[x])}});const{transformTemplate:y}=this.visualElement.getProps();this.visualElement.current.style.transform=y?y({},""):"none",u.root&&u.root.updateScroll(),u.updateLayout(),this.resolveConstraints(),Md(x=>{if(!W1(x,r,null))return;const i=this.getAxisMotionValue(x),{min:C,max:R}=this.constraints[x];i.set(ta(C,R,p[x]))})}addListeners(){if(!this.visualElement.current)return;n2e.set(this.visualElement,this);const r=this.visualElement.current,a=V0(r,"pointerdown",C=>{const{drag:R,dragListener:z=!0}=this.getProps();R&&z&&this.start(C)}),u=()=>{const{dragConstraints:C}=this.getProps();yy(C)&&C.current&&(this.constraints=this.resolveRefConstraints())},{projection:p}=this.visualElement,y=p.addEventListener("measure",u);p&&!p.layout&&(p.root&&p.root.updateScroll(),p.updateLayout()),ks.read(u);const x=dx(window,"resize",()=>this.scalePositionWithinConstraints()),i=p.addEventListener("didUpdate",(({delta:C,hasLayoutChanged:R})=>{this.isDragging&&R&&(Md(z=>{const F=this.getAxisMotionValue(z);F&&(this.originPoint[z]+=C[z].translate,F.set(F.get()+C[z].translate))}),this.visualElement.render())}));return()=>{x(),a(),y(),i&&i()}}getProps(){const r=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:u=!1,dragPropagation:p=!1,dragConstraints:y=!1,dragElastic:x=MD,dragMomentum:i=!0}=r;return{...r,drag:a,dragDirectionLock:u,dragPropagation:p,dragConstraints:y,dragElastic:x,dragMomentum:i}}}function W1(e,r,a){return(r===!0||r===e)&&(a===null||a===e)}function o2e(e,r=10){let a=null;return Math.abs(e.y)>r?a="y":Math.abs(e.x)>r&&(a="x"),a}class s2e extends eg{constructor(r){super(r),this.removeGroupControls=Od,this.removeListeners=Od,this.controls=new i2e(r)}mount(){const{dragControls:r}=this.node.getProps();r&&(this.removeGroupControls=r.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Od}unmount(){this.removeGroupControls(),this.removeListeners()}}const z$=e=>(r,a)=>{e&&ks.postRender(()=>e(r,a))};class a2e extends eg{constructor(){super(...arguments),this.removePointerDownListener=Od}onPointerDown(r){this.session=new dY(r,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:uY(this.node)})}createPanHandlers(){const{onPanSessionStart:r,onPanStart:a,onPan:u,onPanEnd:p}=this.node.getProps();return{onSessionStart:z$(r),onStart:z$(a),onMove:u,onEnd:(y,x)=>{delete this.session,p&&ks.postRender(()=>p(y,x))}}}mount(){this.removePointerDownListener=V0(this.node.current,"pointerdown",r=>this.onPointerDown(r))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function l2e(e=!0){const r=ge.useContext(WO);if(r===null)return[!0,null];const{isPresent:a,onExitComplete:u,register:p}=r,y=ge.useId();ge.useEffect(()=>{if(e)return p(y)},[e]);const x=ge.useCallback(()=>e&&u&&u(y),[y,u,e]);return!a&&u?[!1,x]:[!0]}const gw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let JC=!1;class c2e extends ge.Component{componentDidMount(){const{visualElement:r,layoutGroup:a,switchLayoutGroup:u,layoutId:p}=this.props,{projection:y}=r;y&&(a.group&&a.group.add(y),u&&u.register&&p&&u.register(y),JC&&y.root.didUpdate(),y.addEventListener("animationComplete",()=>{this.safeToRemove()}),y.setOptions({...y.options,onExitComplete:()=>this.safeToRemove()})),gw.hasEverUpdated=!0}getSnapshotBeforeUpdate(r){const{layoutDependency:a,visualElement:u,drag:p,isPresent:y}=this.props,{projection:x}=u;return x&&(x.isPresent=y,JC=!0,p||r.layoutDependency!==a||a===void 0||r.isPresent!==y?x.willUpdate():this.safeToRemove(),r.isPresent!==y&&(y?x.promote():x.relegate()||ks.postRender(()=>{const i=x.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:r}=this.props.visualElement;r&&(r.root.didUpdate(),jO.postRender(()=>{!r.currentAnimation&&r.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:r,layoutGroup:a,switchLayoutGroup:u}=this.props,{projection:p}=r;JC=!0,p&&(p.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(p),u&&u.deregister&&u.deregister(p))}safeToRemove(){const{safeToRemove:r}=this.props;r&&r()}render(){return null}}function fY(e){const[r,a]=l2e(),u=ge.useContext(i7);return X.jsx(c2e,{...e,layoutGroup:u,switchLayoutGroup:ge.useContext(H7),isPresent:r,safeToRemove:a})}function u2e(e,r,a){const u=Ac(e)?e:Uy(e);return u.start(ZO("",u,r,a)),u.animation}const d2e=(e,r)=>e.depth-r.depth;class h2e{constructor(){this.children=[],this.isDirty=!1}add(r){vO(this.children,r),this.isDirty=!0}remove(r){xO(this.children,r),this.isDirty=!0}forEach(r){this.isDirty&&this.children.sort(d2e),this.isDirty=!1,this.children.forEach(r)}}function f2e(e,r){const a=Su.now(),u=({timestamp:p})=>{const y=p-a;y>=r&&(Wm(u),e(y-r))};return ks.setup(u,!0),()=>Wm(u)}const pY=["TopLeft","TopRight","BottomLeft","BottomRight"],p2e=pY.length,F$=e=>typeof e=="string"?parseFloat(e):e,k$=e=>typeof e=="number"||ui.test(e);function m2e(e,r,a,u,p,y){p?(e.opacity=ta(0,a.opacity??1,g2e(u)),e.opacityExit=ta(r.opacity??1,0,_2e(u))):y&&(e.opacity=ta(r.opacity??1,a.opacity??1,u));for(let x=0;x<p2e;x++){const i=`border${pY[x]}Radius`;let C=B$(r,i),R=B$(a,i);if(C===void 0&&R===void 0)continue;C||(C=0),R||(R=0),C===0||R===0||k$(C)===k$(R)?(e[i]=Math.max(ta(F$(C),F$(R),u),0),(zf.test(R)||zf.test(C))&&(e[i]+="%")):e[i]=R}(r.rotate||a.rotate)&&(e.rotate=ta(r.rotate||0,a.rotate||0,u))}function B$(e,r){return e[r]!==void 0?e[r]:e.borderRadius}const g2e=mY(0,.5,e7),_2e=mY(.5,.95,Od);function mY(e,r,a){return u=>u<e?0:u>r?1:a(ax(e,r,u))}function j$(e,r){e.min=r.min,e.max=r.max}function wh(e,r){j$(e.x,r.x),j$(e.y,r.y)}function N$(e,r){e.translate=r.translate,e.scale=r.scale,e.originPoint=r.originPoint,e.origin=r.origin}function V$(e,r,a,u,p){return e-=r,e=Vw(e,1/a,u),p!==void 0&&(e=Vw(e,1/p,u)),e}function y2e(e,r=0,a=1,u=.5,p,y=e,x=e){if(zf.test(r)&&(r=parseFloat(r),r=ta(x.min,x.max,r/100)-x.min),typeof r!="number")return;let i=ta(y.min,y.max,u);e===y&&(i-=r),e.min=V$(e.min,r,a,i,p),e.max=V$(e.max,r,a,i,p)}function U$(e,r,[a,u,p],y,x){y2e(e,r[a],r[u],r[p],r.scale,y,x)}const v2e=["x","scaleX","originX"],x2e=["y","scaleY","originY"];function $$(e,r,a,u){U$(e.x,r,v2e,a?a.x:void 0,u?u.x:void 0),U$(e.y,r,x2e,a?a.y:void 0,u?u.y:void 0)}function W$(e){return e.translate===0&&e.scale===1}function gY(e){return W$(e.x)&&W$(e.y)}function q$(e,r){return e.min===r.min&&e.max===r.max}function b2e(e,r){return q$(e.x,r.x)&&q$(e.y,r.y)}function G$(e,r){return Math.round(e.min)===Math.round(r.min)&&Math.round(e.max)===Math.round(r.max)}function _Y(e,r){return G$(e.x,r.x)&&G$(e.y,r.y)}function H$(e){return Qc(e.x)/Qc(e.y)}function Y$(e,r){return e.translate===r.translate&&e.scale===r.scale&&e.originPoint===r.originPoint}class w2e{constructor(){this.members=[]}add(r){vO(this.members,r),r.scheduleRender()}remove(r){if(xO(this.members,r),r===this.prevLead&&(this.prevLead=void 0),r===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(r){const a=this.members.findIndex(p=>r===p);if(a===0)return!1;let u;for(let p=a;p>=0;p--){const y=this.members[p];if(y.isPresent!==!1){u=y;break}}return u?(this.promote(u),!0):!1}promote(r,a){const u=this.lead;if(r!==u&&(this.prevLead=u,this.lead=r,r.show(),u)){u.instance&&u.scheduleRender(),r.scheduleRender(),r.resumeFrom=u,a&&(r.resumeFrom.preserveOpacity=!0),u.snapshot&&(r.snapshot=u.snapshot,r.snapshot.latestValues=u.animationValues||u.latestValues),r.root&&r.root.isUpdating&&(r.isLayoutDirty=!0);const{crossfade:p}=r.options;p===!1&&u.hide()}}exitAnimationComplete(){this.members.forEach(r=>{const{options:a,resumingFrom:u}=r;a.onExitComplete&&a.onExitComplete(),u&&u.options.onExitComplete&&u.options.onExitComplete()})}scheduleRender(){this.members.forEach(r=>{r.instance&&r.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function S2e(e,r,a){let u="";const p=e.x.translate/r.x,y=e.y.translate/r.y,x=a?.z||0;if((p||y||x)&&(u=`translate3d(${p}px, ${y}px, ${x}px) `),(r.x!==1||r.y!==1)&&(u+=`scale(${1/r.x}, ${1/r.y}) `),a){const{transformPerspective:R,rotate:z,rotateX:F,rotateY:V,skewX:G,skewY:H}=a;R&&(u=`perspective(${R}px) ${u}`),z&&(u+=`rotate(${z}deg) `),F&&(u+=`rotateX(${F}deg) `),V&&(u+=`rotateY(${V}deg) `),G&&(u+=`skewX(${G}deg) `),H&&(u+=`skewY(${H}deg) `)}const i=e.x.scale*r.x,C=e.y.scale*r.y;return(i!==1||C!==1)&&(u+=`scale(${i}, ${C})`),u||"none"}const eA=["","X","Y","Z"],T2e=1e3;let E2e=0;function tA(e,r,a,u){const{latestValues:p}=r;p[e]&&(a[e]=p[e],r.setStaticValue(e,0),u&&(u[e]=0))}function yY(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:r}=e.options;if(!r)return;const a=nY(r);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:p,layoutId:y}=e.options;window.MotionCancelOptimisedAnimation(a,"transform",ks,!(p||y))}const{parent:u}=e;u&&!u.hasCheckedOptimisedAppear&&yY(u)}function vY({attachResizeListener:e,defaultParent:r,measureScroll:a,checkIsScrollRoot:u,resetTransform:p}){return class{constructor(x={},i=r?.()){this.id=E2e++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(M2e),this.nodes.forEach(R2e),this.nodes.forEach(O2e),this.nodes.forEach(C2e)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=x,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let C=0;C<this.path.length;C++)this.path[C].shouldResetTransform=!0;this.root===this&&(this.nodes=new h2e)}addEventListener(x,i){return this.eventHandlers.has(x)||this.eventHandlers.set(x,new SO),this.eventHandlers.get(x).add(i)}notifyListeners(x,...i){const C=this.eventHandlers.get(x);C&&C.notify(...i)}hasListeners(x){return this.eventHandlers.has(x)}mount(x){if(this.instance)return;this.isSVG=k7(x)&&!wSe(x),this.instance=x;const{layoutId:i,layout:C,visualElement:R}=this.options;if(R&&!R.current&&R.mount(x),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(C||i)&&(this.isLayoutDirty=!0),e){let z,F=0;const V=()=>this.root.updateBlockedByResize=!1;ks.read(()=>{F=window.innerWidth}),e(x,()=>{const G=window.innerWidth;G!==F&&(F=G,this.root.updateBlockedByResize=!0,z&&z(),z=f2e(V,250),gw.hasAnimatedSinceResize&&(gw.hasAnimatedSinceResize=!1,this.nodes.forEach(K$)))})}i&&this.root.registerSharedNode(i,this),this.options.animate!==!1&&R&&(i||C)&&this.addEventListener("didUpdate",({delta:z,hasLayoutChanged:F,hasRelativeLayoutChanged:V,layout:G})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const H=this.options.transition||R.getDefaultTransition()||B2e,{onLayoutAnimationStart:Z,onLayoutAnimationComplete:J}=R.getProps(),se=!this.targetLayout||!_Y(this.targetLayout,G),pe=!F&&V;if(this.options.layoutRoot||this.resumeFrom||pe||F&&(se||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const ve={...kO(H,"layout"),onPlay:Z,onComplete:J};(R.shouldReduceMotion||this.options.layoutRoot)&&(ve.delay=0,ve.type=!1),this.startAnimation(ve),this.setAnimationOrigin(z,pe)}else F||K$(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=G})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const x=this.getStack();x&&x.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Wm(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(L2e),this.animationId++)}getTransformTemplate(){const{visualElement:x}=this.options;return x&&x.getProps().transformTemplate}willUpdate(x=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&yY(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let z=0;z<this.path.length;z++){const F=this.path[z];F.shouldResetTransform=!0,F.updateScroll("snapshot"),F.options.layoutRoot&&F.willUpdate(!1)}const{layoutId:i,layout:C}=this.options;if(i===void 0&&!C)return;const R=this.getTransformTemplate();this.prevTransformTemplateValue=R?R(this.latestValues,""):void 0,this.updateSnapshot(),x&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Z$);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(X$);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(D2e),this.nodes.forEach(P2e),this.nodes.forEach(I2e)):this.nodes.forEach(X$),this.clearAllSnapshots();const i=Su.now();ec.delta=Lp(0,1e3/60,i-ec.timestamp),ec.timestamp=i,ec.isProcessing=!0,WC.update.process(ec),WC.preRender.process(ec),WC.render.process(ec),ec.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,jO.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(A2e),this.sharedNodes.forEach(z2e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ks.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ks.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Qc(this.snapshot.measuredBox.x)&&!Qc(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let C=0;C<this.path.length;C++)this.path[C].updateScroll();const x=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=sl(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,x?x.layoutBox:void 0)}updateScroll(x="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===x&&(i=!1),i&&this.instance){const C=u(this.instance);this.scroll={animationId:this.root.animationId,phase:x,isRoot:C,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:C}}}resetTransform(){if(!p)return;const x=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!gY(this.projectionDelta),C=this.getTransformTemplate(),R=C?C(this.latestValues,""):void 0,z=R!==this.prevTransformTemplateValue;x&&this.instance&&(i||Ng(this.latestValues)||z)&&(p(this.instance,R),this.shouldResetTransform=!1,this.scheduleRender())}measure(x=!0){const i=this.measurePageBox();let C=this.removeElementScroll(i);return x&&(C=this.removeTransform(C)),j2e(C),{animationId:this.root.animationId,measuredBox:i,layoutBox:C,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:x}=this.options;if(!x)return sl();const i=x.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(N2e))){const{scroll:R}=this.root;R&&(vy(i.x,R.offset.x),vy(i.y,R.offset.y))}return i}removeElementScroll(x){const i=sl();if(wh(i,x),this.scroll?.wasRoot)return i;for(let C=0;C<this.path.length;C++){const R=this.path[C],{scroll:z,options:F}=R;R!==this.root&&z&&F.layoutScroll&&(z.wasRoot&&wh(i,x),vy(i.x,z.offset.x),vy(i.y,z.offset.y))}return i}applyTransform(x,i=!1){const C=sl();wh(C,x);for(let R=0;R<this.path.length;R++){const z=this.path[R];!i&&z.options.layoutScroll&&z.scroll&&z!==z.root&&xy(C,{x:-z.scroll.offset.x,y:-z.scroll.offset.y}),Ng(z.latestValues)&&xy(C,z.latestValues)}return Ng(this.latestValues)&&xy(C,this.latestValues),C}removeTransform(x){const i=sl();wh(i,x);for(let C=0;C<this.path.length;C++){const R=this.path[C];if(!R.instance||!Ng(R.latestValues))continue;wD(R.latestValues)&&R.updateSnapshot();const z=sl(),F=R.measurePageBox();wh(z,F),$$(i,R.latestValues,R.snapshot?R.snapshot.layoutBox:void 0,z)}return Ng(this.latestValues)&&$$(i,this.latestValues),i}setTargetDelta(x){this.targetDelta=x,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(x){this.options={...this.options,...x,crossfade:x.crossfade!==void 0?x.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ec.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(x=!1){const i=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=i.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=i.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=i.isSharedProjectionDirty);const C=!!this.resumingFrom||this!==i;if(!(x||C&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:z,layoutId:F}=this.options;if(!this.layout||!(z||F))return;this.resolvedRelativeTargetAt=ec.timestamp;const V=this.getClosestProjectingParent();V&&this.linkedParentVersion!==V.layoutVersion&&!V.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(V&&V.layout?this.createRelativeTarget(V,this.layout.layoutBox,V.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=sl(),this.targetWithTransforms=sl()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),HTe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):wh(this.target,this.layout.layoutBox),K7(this.target,this.targetDelta)):wh(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,V&&!!V.resumingFrom==!!this.resumingFrom&&!V.options.layoutScroll&&V.target&&this.animationProgress!==1?this.createRelativeTarget(V,this.target,V.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||wD(this.parent.latestValues)||X7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(x,i,C){this.relativeParent=x,this.linkedParentVersion=x.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=sl(),this.relativeTargetOrigin=sl(),Uw(this.relativeTargetOrigin,i,C),wh(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const x=this.getLead(),i=!!this.resumingFrom||this!==x;let C=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(C=!1),i&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(C=!1),this.resolvedRelativeTargetAt===ec.timestamp&&(C=!1),C)return;const{layout:R,layoutId:z}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(R||z))return;wh(this.layoutCorrected,this.layout.layoutBox);const F=this.treeScale.x,V=this.treeScale.y;oTe(this.layoutCorrected,this.treeScale,this.path,i),x.layout&&!x.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(x.target=x.layout.layoutBox,x.targetWithTransforms=sl());const{target:G}=x;if(!G){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(N$(this.prevProjectionDelta.x,this.projectionDelta.x),N$(this.prevProjectionDelta.y,this.projectionDelta.y)),U0(this.projectionDelta,this.layoutCorrected,G,this.latestValues),(this.treeScale.x!==F||this.treeScale.y!==V||!Y$(this.projectionDelta.x,this.prevProjectionDelta.x)||!Y$(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",G))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(x=!0){if(this.options.visualElement?.scheduleRender(),x){const i=this.getStack();i&&i.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=by(),this.projectionDelta=by(),this.projectionDeltaWithTransform=by()}setAnimationOrigin(x,i=!1){const C=this.snapshot,R=C?C.latestValues:{},z={...this.latestValues},F=by();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const V=sl(),G=C?C.source:void 0,H=this.layout?this.layout.source:void 0,Z=G!==H,J=this.getStack(),se=!J||J.members.length<=1,pe=!!(Z&&!se&&this.options.crossfade===!0&&!this.path.some(k2e));this.animationProgress=0;let ve;this.mixTargetDelta=Ne=>{const _e=Ne/1e3;Q$(F.x,x.x,_e),Q$(F.y,x.y,_e),this.setTargetDelta(F),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Uw(V,this.layout.layoutBox,this.relativeParent.layout.layoutBox),F2e(this.relativeTarget,this.relativeTargetOrigin,V,_e),ve&&b2e(this.relativeTarget,ve)&&(this.isProjectionDirty=!1),ve||(ve=sl()),wh(ve,this.relativeTarget)),Z&&(this.animationValues=z,m2e(z,R,this.latestValues,_e,pe,se)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_e},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(x){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Wm(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ks.update(()=>{gw.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Uy(0)),this.currentAnimation=u2e(this.motionValue,[0,1e3],{...x,velocity:0,isSync:!0,onUpdate:i=>{this.mixTargetDelta(i),x.onUpdate&&x.onUpdate(i)},onStop:()=>{},onComplete:()=>{x.onComplete&&x.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const x=this.getStack();x&&x.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(T2e),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const x=this.getLead();let{targetWithTransforms:i,target:C,layout:R,latestValues:z}=x;if(!(!i||!C||!R)){if(this!==x&&this.layout&&R&&xY(this.options.animationType,this.layout.layoutBox,R.layoutBox)){C=this.target||sl();const F=Qc(this.layout.layoutBox.x);C.x.min=x.target.x.min,C.x.max=C.x.min+F;const V=Qc(this.layout.layoutBox.y);C.y.min=x.target.y.min,C.y.max=C.y.min+V}wh(i,C),xy(i,z),U0(this.projectionDeltaWithTransform,this.layoutCorrected,i,z)}}registerSharedNode(x,i){this.sharedNodes.has(x)||this.sharedNodes.set(x,new w2e),this.sharedNodes.get(x).add(i);const R=i.options.initialPromotionConfig;i.promote({transition:R?R.transition:void 0,preserveFollowOpacity:R&&R.shouldPreserveFollowOpacity?R.shouldPreserveFollowOpacity(i):void 0})}isLead(){const x=this.getStack();return x?x.lead===this:!0}getLead(){const{layoutId:x}=this.options;return x?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:x}=this.options;return x?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:x}=this.options;if(x)return this.root.sharedNodes.get(x)}promote({needsReset:x,transition:i,preserveFollowOpacity:C}={}){const R=this.getStack();R&&R.promote(this,C),x&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const x=this.getStack();return x?x.relegate(this):!1}resetSkewAndRotation(){const{visualElement:x}=this.options;if(!x)return;let i=!1;const{latestValues:C}=x;if((C.z||C.rotate||C.rotateX||C.rotateY||C.rotateZ||C.skewX||C.skewY)&&(i=!0),!i)return;const R={};C.z&&tA("z",x,R,this.animationValues);for(let z=0;z<eA.length;z++)tA(`rotate${eA[z]}`,x,R,this.animationValues),tA(`skew${eA[z]}`,x,R,this.animationValues);x.render();for(const z in R)x.setStaticValue(z,R[z]),this.animationValues&&(this.animationValues[z]=R[z]);x.scheduleRender()}applyProjectionStyles(x,i){if(!this.instance||this.isSVG)return;if(!this.isVisible){x.visibility="hidden";return}const C=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,x.visibility="",x.opacity="",x.pointerEvents=mw(i?.pointerEvents)||"",x.transform=C?C(this.latestValues,""):"none";return}const R=this.getLead();if(!this.projectionDelta||!this.layout||!R.target){this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=mw(i?.pointerEvents)||""),this.hasProjected&&!Ng(this.latestValues)&&(x.transform=C?C({},""):"none",this.hasProjected=!1);return}x.visibility="";const z=R.animationValues||R.latestValues;this.applyTransformsToTarget();let F=S2e(this.projectionDeltaWithTransform,this.treeScale,z);C&&(F=C(z,F)),x.transform=F;const{x:V,y:G}=this.projectionDelta;x.transformOrigin=`${V.origin*100}% ${G.origin*100}% 0`,R.animationValues?x.opacity=R===this?z.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:z.opacityExit:x.opacity=R===this?z.opacity!==void 0?z.opacity:"":z.opacityExit!==void 0?z.opacityExit:0;for(const H in bD){if(z[H]===void 0)continue;const{correct:Z,applyTo:J,isCSSVariable:se}=bD[H],pe=F==="none"?z[H]:Z(z[H],R);if(J){const ve=J.length;for(let Ne=0;Ne<ve;Ne++)x[J[Ne]]=pe}else se?this.options.visualElement.renderState.vars[H]=pe:x[H]=pe}this.options.layoutId&&(x.pointerEvents=R===this?mw(i?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(x=>x.currentAnimation?.stop()),this.root.nodes.forEach(Z$),this.root.sharedNodes.clear()}}}function P2e(e){e.updateLayout()}function I2e(e){const r=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:u}=e.layout,{animationType:p}=e.options,y=r.source!==e.layout.source;p==="size"?Md(z=>{const F=y?r.measuredBox[z]:r.layoutBox[z],V=Qc(F);F.min=a[z].min,F.max=F.min+V}):xY(p,r.layoutBox,a)&&Md(z=>{const F=y?r.measuredBox[z]:r.layoutBox[z],V=Qc(a[z]);F.max=F.min+V,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[z].max=e.relativeTarget[z].min+V)});const x=by();U0(x,a,r.layoutBox);const i=by();y?U0(i,e.applyTransform(u,!0),r.measuredBox):U0(i,a,r.layoutBox);const C=!gY(x);let R=!1;if(!e.resumeFrom){const z=e.getClosestProjectingParent();if(z&&!z.resumeFrom){const{snapshot:F,layout:V}=z;if(F&&V){const G=sl();Uw(G,r.layoutBox,F.layoutBox);const H=sl();Uw(H,a,V.layoutBox),_Y(G,H)||(R=!0),z.options.layoutRoot&&(e.relativeTarget=H,e.relativeTargetOrigin=G,e.relativeParent=z)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:r,delta:i,layoutDelta:x,hasLayoutChanged:C,hasRelativeLayoutChanged:R})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function M2e(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function C2e(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function A2e(e){e.clearSnapshot()}function Z$(e){e.clearMeasurements()}function X$(e){e.isLayoutDirty=!1}function D2e(e){const{visualElement:r}=e.options;r&&r.getProps().onBeforeLayoutMeasure&&r.notify("BeforeLayoutMeasure"),e.resetTransform()}function K$(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function R2e(e){e.resolveTargetDelta()}function O2e(e){e.calcProjection()}function L2e(e){e.resetSkewAndRotation()}function z2e(e){e.removeLeadSnapshot()}function Q$(e,r,a){e.translate=ta(r.translate,0,a),e.scale=ta(r.scale,1,a),e.origin=r.origin,e.originPoint=r.originPoint}function J$(e,r,a,u){e.min=ta(r.min,a.min,u),e.max=ta(r.max,a.max,u)}function F2e(e,r,a,u){J$(e.x,r.x,a.x,u),J$(e.y,r.y,a.y,u)}function k2e(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const B2e={duration:.45,ease:[.4,0,.1,1]},eW=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),tW=eW("applewebkit/")&&!eW("chrome/")?Math.round:Od;function rW(e){e.min=tW(e.min),e.max=tW(e.max)}function j2e(e){rW(e.x),rW(e.y)}function xY(e,r,a){return e==="position"||e==="preserve-aspect"&&!GTe(H$(r),H$(a),.2)}function N2e(e){return e!==e.root&&e.scroll?.wasRoot}const V2e=vY({attachResizeListener:(e,r)=>dx(e,"resize",r),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rA={current:void 0},bY=vY({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!rA.current){const e=new V2e({});e.mount(window),e.setOptions({layoutScroll:!0}),rA.current=e}return rA.current},resetTransform:(e,r)=>{e.style.transform=r!==void 0?r:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),U2e={pan:{Feature:a2e},drag:{Feature:s2e,ProjectionNode:bY,MeasureLayout:fY}};function nW(e,r,a){const{props:u}=e;e.animationState&&u.whileHover&&e.animationState.setActive("whileHover",a==="Start");const p="onHover"+a,y=u[p];y&&ks.postRender(()=>y(r,Bx(r)))}class $2e extends eg{mount(){const{current:r}=this.node;r&&(this.unmount=_Se(r,(a,u)=>(nW(this.node,u,"Start"),p=>nW(this.node,p,"End"))))}unmount(){}}class W2e extends eg{constructor(){super(...arguments),this.isActive=!1}onFocus(){let r=!1;try{r=this.node.current.matches(":focus-visible")}catch{r=!0}!r||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=zx(dx(this.node.current,"focus",()=>this.onFocus()),dx(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function iW(e,r,a){const{props:u}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&u.whileTap&&e.animationState.setActive("whileTap",a==="Start");const p="onTap"+(a==="End"?"":a),y=u[p];y&&ks.postRender(()=>y(r,Bx(r)))}class q2e extends eg{mount(){const{current:r}=this.node;r&&(this.unmount=bSe(r,(a,u)=>(iW(this.node,u,"Start"),(p,{success:y})=>iW(this.node,p,y?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const CD=new WeakMap,nA=new WeakMap,G2e=e=>{const r=CD.get(e.target);r&&r(e)},H2e=e=>{e.forEach(G2e)};function Y2e({root:e,...r}){const a=e||document;nA.has(a)||nA.set(a,{});const u=nA.get(a),p=JSON.stringify(r);return u[p]||(u[p]=new IntersectionObserver(H2e,{root:e,...r})),u[p]}function Z2e(e,r,a){const u=Y2e(r);return CD.set(e,a),u.observe(e),()=>{CD.delete(e),u.unobserve(e)}}const X2e={some:0,all:1};class K2e extends eg{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:r={}}=this.node.getProps(),{root:a,margin:u,amount:p="some",once:y}=r,x={root:a?a.current:void 0,rootMargin:u,threshold:typeof p=="number"?p:X2e[p]},i=C=>{const{isIntersecting:R}=C;if(this.isInView===R||(this.isInView=R,y&&!R&&this.hasEnteredView))return;R&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",R);const{onViewportEnter:z,onViewportLeave:F}=this.node.getProps(),V=R?z:F;V&&V(C)};return Z2e(this.node.current,x,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:r,prevProps:a}=this.node;["amount","margin","root"].some(Q2e(r,a))&&this.startObserver()}unmount(){}}function Q2e({viewport:e={}},{viewport:r={}}={}){return a=>e[a]!==r[a]}const J2e={inView:{Feature:K2e},tap:{Feature:q2e},focus:{Feature:W2e},hover:{Feature:$2e}},eEe={layout:{ProjectionNode:bY,MeasureLayout:fY}},tEe={...NTe,...J2e,...U2e,...eEe};function rEe(e,r){return JSe(e,r,tEe,mTe)}const nEe=rEe("div");function wY({children:e}){return X.jsx(nEe,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.45,ease:"easeOut"},children:e})}function iEe(){const{filters:e,filteredTours:r,loading:a}=QR(),{tours:u,loading:p}=Dx(),x=Object.values(e).some(C=>C!=="")?r:u,i=p||a;return X.jsx(wY,{children:X.jsxs(Mn,{py:28,children:[X.jsxs(Ad,{maxW:"7xl",mb:8,children:[X.jsxs(ko,{children:[x.length," Tours Found"]}),X.jsx(zr,{color:"gray.500",children:"Refine your search"})]}),X.jsx(Ad,{maxW:"7xl",mb:10,children:X.jsx(yO,{mode:"tours"})}),X.jsx(Ad,{maxW:"7xl",children:i?X.jsx(zr,{children:"Loading..."}):x.length===0?X.jsx(zr,{children:"No tours match your filters."}):X.jsx(Mh,{columns:[1,2,3],spacing:8,children:x.map(C=>X.jsx(BH,{tour:C},C._id))})})]})})}const oEe=async e=>(await Ni.get(`/booking/checkout-session/${e}`)).data.url,sEe=async()=>(await Ni.get("/booking/my-bookings")).data.data.bookings;var _w={exports:{}},aEe=_w.exports,oW;function lEe(){return oW||(oW=1,(function(e,r){(function(a,u){e.exports=u()})(aEe,(function(){var a,u,p;function y(i,C){if(!a)a=C;else if(!u)u=C;else{var R="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",z={};a(z),p=C(z),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(p.workerUrl=window.URL.createObjectURL(new Blob([R],{type:"text/javascript"})))}}y(["exports"],(function(i){var C=1e-6,R=typeof Float32Array<"u"?Float32Array:Array;function z(s,t){var o=t[0],c=t[1],d=t[2],m=t[3],g=o*m-d*c;return g?(s[0]=m*(g=1/g),s[1]=-c*g,s[2]=-d*g,s[3]=o*g,s):null}function F(){var s=new R(9);return R!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function V(s,t){var o=t[0],c=t[1],d=t[2],m=t[3],g=t[4],b=t[5],P=t[6],I=t[7],O=t[8];return s[0]=g*O-b*I,s[1]=d*I-c*O,s[2]=c*b-d*g,s[3]=b*P-m*O,s[4]=o*O-d*P,s[5]=d*m-o*b,s[6]=m*I-g*P,s[7]=c*P-o*I,s[8]=o*g-c*m,s}function G(s,t,o){var c=t[0],d=t[1],m=t[2],g=t[3],b=t[4],P=t[5],I=t[6],O=t[7],L=t[8],k=o[0],$=o[1],W=o[2],Q=o[3],te=o[4],ne=o[5],ue=o[6],he=o[7],me=o[8];return s[0]=k*c+$*g+W*I,s[1]=k*d+$*b+W*O,s[2]=k*m+$*P+W*L,s[3]=Q*c+te*g+ne*I,s[4]=Q*d+te*b+ne*O,s[5]=Q*m+te*P+ne*L,s[6]=ue*c+he*g+me*I,s[7]=ue*d+he*b+me*O,s[8]=ue*m+he*P+me*L,s}function H(){var s=new R(16);return R!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s}function Z(s){var t=new R(16);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],t}function J(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function se(s,t){var o=t[0],c=t[1],d=t[2],m=t[3],g=t[4],b=t[5],P=t[6],I=t[7],O=t[8],L=t[9],k=t[10],$=t[11],W=t[12],Q=t[13],te=t[14],ne=t[15],ue=o*b-c*g,he=o*P-d*g,me=o*I-m*g,Ae=c*P-d*b,Pe=c*I-m*b,Fe=d*I-m*P,Be=O*Q-L*W,Ve=O*te-k*W,at=O*ne-$*W,Ze=L*te-k*Q,ft=L*ne-$*Q,xt=k*ne-$*te,Ct=ue*xt-he*ft+me*Ze+Ae*at-Pe*Ve+Fe*Be;return Ct?(s[0]=(b*xt-P*ft+I*Ze)*(Ct=1/Ct),s[1]=(d*ft-c*xt-m*Ze)*Ct,s[2]=(Q*Fe-te*Pe+ne*Ae)*Ct,s[3]=(k*Pe-L*Fe-$*Ae)*Ct,s[4]=(P*at-g*xt-I*Ve)*Ct,s[5]=(o*xt-d*at+m*Ve)*Ct,s[6]=(te*me-W*Fe-ne*he)*Ct,s[7]=(O*Fe-k*me+$*he)*Ct,s[8]=(g*ft-b*at+I*Be)*Ct,s[9]=(c*at-o*ft-m*Be)*Ct,s[10]=(W*Pe-Q*me+ne*ue)*Ct,s[11]=(L*me-O*Pe-$*ue)*Ct,s[12]=(b*Ve-g*Ze-P*Be)*Ct,s[13]=(o*Ze-c*Ve+d*Be)*Ct,s[14]=(Q*he-W*Ae-te*ue)*Ct,s[15]=(O*Ae-L*he+k*ue)*Ct,s):null}function pe(s,t,o){var c=t[0],d=t[1],m=t[2],g=t[3],b=t[4],P=t[5],I=t[6],O=t[7],L=t[8],k=t[9],$=t[10],W=t[11],Q=t[12],te=t[13],ne=t[14],ue=t[15],he=o[0],me=o[1],Ae=o[2],Pe=o[3];return s[0]=he*c+me*b+Ae*L+Pe*Q,s[1]=he*d+me*P+Ae*k+Pe*te,s[2]=he*m+me*I+Ae*$+Pe*ne,s[3]=he*g+me*O+Ae*W+Pe*ue,s[4]=(he=o[4])*c+(me=o[5])*b+(Ae=o[6])*L+(Pe=o[7])*Q,s[5]=he*d+me*P+Ae*k+Pe*te,s[6]=he*m+me*I+Ae*$+Pe*ne,s[7]=he*g+me*O+Ae*W+Pe*ue,s[8]=(he=o[8])*c+(me=o[9])*b+(Ae=o[10])*L+(Pe=o[11])*Q,s[9]=he*d+me*P+Ae*k+Pe*te,s[10]=he*m+me*I+Ae*$+Pe*ne,s[11]=he*g+me*O+Ae*W+Pe*ue,s[12]=(he=o[12])*c+(me=o[13])*b+(Ae=o[14])*L+(Pe=o[15])*Q,s[13]=he*d+me*P+Ae*k+Pe*te,s[14]=he*m+me*I+Ae*$+Pe*ne,s[15]=he*g+me*O+Ae*W+Pe*ue,s}function ve(s,t,o){var c,d,m,g,b,P,I,O,L,k,$,W,Q=o[0],te=o[1],ne=o[2];return t===s?(s[12]=t[0]*Q+t[4]*te+t[8]*ne+t[12],s[13]=t[1]*Q+t[5]*te+t[9]*ne+t[13],s[14]=t[2]*Q+t[6]*te+t[10]*ne+t[14],s[15]=t[3]*Q+t[7]*te+t[11]*ne+t[15]):(d=t[1],m=t[2],g=t[3],b=t[4],P=t[5],I=t[6],O=t[7],L=t[8],k=t[9],$=t[10],W=t[11],s[0]=c=t[0],s[1]=d,s[2]=m,s[3]=g,s[4]=b,s[5]=P,s[6]=I,s[7]=O,s[8]=L,s[9]=k,s[10]=$,s[11]=W,s[12]=c*Q+b*te+L*ne+t[12],s[13]=d*Q+P*te+k*ne+t[13],s[14]=m*Q+I*te+$*ne+t[14],s[15]=g*Q+O*te+W*ne+t[15]),s}function Ne(s,t,o){var c=o[0],d=o[1],m=o[2];return s[0]=t[0]*c,s[1]=t[1]*c,s[2]=t[2]*c,s[3]=t[3]*c,s[4]=t[4]*d,s[5]=t[5]*d,s[6]=t[6]*d,s[7]=t[7]*d,s[8]=t[8]*m,s[9]=t[9]*m,s[10]=t[10]*m,s[11]=t[11]*m,s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s}function _e(s,t,o){var c=Math.sin(o),d=Math.cos(o),m=t[4],g=t[5],b=t[6],P=t[7],I=t[8],O=t[9],L=t[10],k=t[11];return t!==s&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[4]=m*d+I*c,s[5]=g*d+O*c,s[6]=b*d+L*c,s[7]=P*d+k*c,s[8]=I*d-m*c,s[9]=O*d-g*c,s[10]=L*d-b*c,s[11]=k*d-P*c,s}function Re(s,t,o){var c=Math.sin(o),d=Math.cos(o),m=t[0],g=t[1],b=t[2],P=t[3],I=t[8],O=t[9],L=t[10],k=t[11];return t!==s&&(s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=m*d-I*c,s[1]=g*d-O*c,s[2]=b*d-L*c,s[3]=P*d-k*c,s[8]=m*c+I*d,s[9]=g*c+O*d,s[10]=b*c+L*d,s[11]=P*c+k*d,s}function ke(s,t,o){var c=Math.sin(o),d=Math.cos(o),m=t[0],g=t[1],b=t[2],P=t[3],I=t[4],O=t[5],L=t[6],k=t[7];return t!==s&&(s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=m*d+I*c,s[1]=g*d+O*c,s[2]=b*d+L*c,s[3]=P*d+k*c,s[4]=I*d-m*c,s[5]=O*d-g*c,s[6]=L*d-b*c,s[7]=k*d-P*c,s}function ze(s,t){return s[0]=t[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function et(s,t,o){var c,d,m,g=o[0],b=o[1],P=o[2],I=Math.sqrt(g*g+b*b+P*P);return I<C?null:(g*=I=1/I,b*=I,P*=I,c=Math.sin(t),d=Math.cos(t),s[0]=g*g*(m=1-d)+d,s[1]=b*g*m+P*c,s[2]=P*g*m-b*c,s[3]=0,s[4]=g*b*m-P*c,s[5]=b*b*m+d,s[6]=P*b*m+g*c,s[7]=0,s[8]=g*P*m+b*c,s[9]=b*P*m-g*c,s[10]=P*P*m+d,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}function ht(s,t){var o=t[0],c=t[1],d=t[2],m=t[4],g=t[5],b=t[6],P=t[8],I=t[9],O=t[10];return s[0]=Math.sqrt(o*o+c*c+d*d),s[1]=Math.sqrt(m*m+g*g+b*b),s[2]=Math.sqrt(P*P+I*I+O*O),s}function Xt(s,t){var o=t[0],c=t[1],d=t[2],m=t[3],g=o+o,b=c+c,P=d+d,I=o*g,O=c*g,L=c*b,k=d*g,$=d*b,W=d*P,Q=m*g,te=m*b,ne=m*P;return s[0]=1-L-W,s[1]=O+ne,s[2]=k-te,s[3]=0,s[4]=O-ne,s[5]=1-I-W,s[6]=$+Q,s[7]=0,s[8]=k+te,s[9]=$-Q,s[10]=1-I-L,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}var Ir=pe;function nr(){var s=new R(3);return R!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Fr(s){var t=new R(3);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t}function Or(s){var t=s[0],o=s[1],c=s[2];return Math.sqrt(t*t+o*o+c*c)}function or(s,t,o){var c=new R(3);return c[0]=s,c[1]=t,c[2]=o,c}function lt(s,t,o,c){return s[0]=t,s[1]=o,s[2]=c,s}function Et(s,t,o){return s[0]=t[0]+o[0],s[1]=t[1]+o[1],s[2]=t[2]+o[2],s}function qt(s,t,o){return s[0]=t[0]-o[0],s[1]=t[1]-o[1],s[2]=t[2]-o[2],s}function Gt(s,t,o){return s[0]=t[0]*o[0],s[1]=t[1]*o[1],s[2]=t[2]*o[2],s}function tt(s,t,o){return s[0]=Math.min(t[0],o[0]),s[1]=Math.min(t[1],o[1]),s[2]=Math.min(t[2],o[2]),s}function ct(s,t,o){return s[0]=Math.max(t[0],o[0]),s[1]=Math.max(t[1],o[1]),s[2]=Math.max(t[2],o[2]),s}function _t(s,t,o){return s[0]=t[0]*o,s[1]=t[1]*o,s[2]=t[2]*o,s}function Vt(s,t,o,c){return s[0]=t[0]+o[0]*c,s[1]=t[1]+o[1]*c,s[2]=t[2]+o[2]*c,s}function bt(s,t){var o=t[0]-s[0],c=t[1]-s[1],d=t[2]-s[2];return Math.sqrt(o*o+c*c+d*d)}function ar(s,t){var o=t[0]-s[0],c=t[1]-s[1],d=t[2]-s[2];return o*o+c*c+d*d}function hr(s){var t=s[0],o=s[1],c=s[2];return t*t+o*o+c*c}function xr(s,t){return s[0]=-t[0],s[1]=-t[1],s[2]=-t[2],s}function sr(s,t){var o=t[0],c=t[1],d=t[2],m=o*o+c*c+d*d;return m>0&&(m=1/Math.sqrt(m)),s[0]=t[0]*m,s[1]=t[1]*m,s[2]=t[2]*m,s}function Br(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]}function hn(s,t,o){var c=t[0],d=t[1],m=t[2],g=o[0],b=o[1],P=o[2];return s[0]=d*P-m*b,s[1]=m*g-c*P,s[2]=c*b-d*g,s}function Vn(s,t,o,c){var d=t[0],m=t[1],g=t[2];return s[0]=d+c*(o[0]-d),s[1]=m+c*(o[1]-m),s[2]=g+c*(o[2]-g),s}function Yr(s,t,o){var c=t[0],d=t[1],m=t[2],g=o[3]*c+o[7]*d+o[11]*m+o[15];return s[0]=(o[0]*c+o[4]*d+o[8]*m+o[12])/(g=g||1),s[1]=(o[1]*c+o[5]*d+o[9]*m+o[13])/g,s[2]=(o[2]*c+o[6]*d+o[10]*m+o[14])/g,s}function Un(s,t,o){var c=t[0],d=t[1],m=t[2];return s[0]=c*o[0]+d*o[3]+m*o[6],s[1]=c*o[1]+d*o[4]+m*o[7],s[2]=c*o[2]+d*o[5]+m*o[8],s}function Si(s,t,o){var c=o[0],d=o[1],m=o[2],g=o[3],b=t[0],P=t[1],I=t[2],O=d*I-m*P,L=m*b-c*I,k=c*P-d*b;return s[0]=b+g*(O+=O)+d*(k+=k)-m*(L+=L),s[1]=P+g*L+m*O-c*k,s[2]=I+g*k+c*L-d*O,s}function di(s){return s[0]=0,s[1]=0,s[2]=0,s}function Ii(s,t){return s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]}var Xn=qt,Go=Gt,Lo=Or;function co(){var s=new R(4);return R!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0,s[3]=0),s}function Ko(s,t,o){return s[0]=t[0]*o,s[1]=t[1]*o,s[2]=t[2]*o,s[3]=t[3]*o,s}function ds(s,t){var o=t[0],c=t[1],d=t[2],m=t[3],g=o*o+c*c+d*d+m*m;return g>0&&(g=1/Math.sqrt(g)),s[0]=o*g,s[1]=c*g,s[2]=d*g,s[3]=m*g,s}function Bo(s,t,o){var c=t[0],d=t[1],m=t[2],g=t[3];return s[0]=o[0]*c+o[4]*d+o[8]*m+o[12]*g,s[1]=o[1]*c+o[5]*d+o[9]*m+o[13]*g,s[2]=o[2]*c+o[6]*d+o[10]*m+o[14]*g,s[3]=o[3]*c+o[7]*d+o[11]*m+o[15]*g,s}function ra(){var s=new R(4);return R!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function va(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function xa(s,t,o){o*=.5;var c=t[0],d=t[1],m=t[2],g=t[3],b=Math.sin(o),P=Math.cos(o);return s[0]=c*P+g*b,s[1]=d*P+m*b,s[2]=m*P-d*b,s[3]=g*P-c*b,s}function Bs(s,t,o){o*=.5;var c=t[0],d=t[1],m=t[2],g=t[3],b=Math.sin(o),P=Math.cos(o);return s[0]=c*P-m*b,s[1]=d*P+g*b,s[2]=m*P+c*b,s[3]=g*P-d*b,s}nr(),co();var Qo,na,hs,Cl=ds,Al=(Qo=nr(),na=or(1,0,0),hs=or(0,1,0),function(s,t,o){var c=Br(t,o);return c<-.999999?(hn(Qo,na,t),Lo(Qo)<1e-6&&hn(Qo,hs,t),sr(Qo,Qo),(function(d,m,g){g*=.5;var b=Math.sin(g);d[0]=b*m[0],d[1]=b*m[1],d[2]=b*m[2],d[3]=Math.cos(g)})(s,Qo,Math.PI),s):c>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(hn(Qo,t,o),s[0]=Qo[0],s[1]=Qo[1],s[2]=Qo[2],s[3]=1+c,Cl(s,s))});function io(){var s=new R(2);return R!=Float32Array&&(s[0]=0,s[1]=0),s}function js(s,t){var o=new R(2);return o[0]=s,o[1]=t,o}function ba(s,t,o){return s[0]=t,s[1]=o,s}function wa(s,t,o){return s[0]=t[0]+o[0],s[1]=t[1]+o[1],s}function Ps(s,t,o){return s[0]=t[0]-o[0],s[1]=t[1]-o[1],s}function Is(s,t,o){return s[0]=t[0]*o,s[1]=t[1]*o,s}function _i(s){var t=s[0],o=s[1];return Math.sqrt(t*t+o*o)}function Zi(s,t){var o=t[0],c=t[1],d=o*o+c*c;return d>0&&(d=1/Math.sqrt(d)),s[0]=t[0]*d,s[1]=t[1]*d,s}function ia(s,t){return s[0]*t[0]+s[1]*t[1]}ra(),ra(),F();var fs,Ms,Dc=Ps;function rc(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}io();var ru=(function(){if(Ms)return fs;function s(t,o,c,d){this.cx=3*t,this.bx=3*(c-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(d-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=o,this.p2x=c,this.p2y=d}return Ms=1,fs=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,o){if(o===void 0&&(o=1e-6),t<0)return 0;if(t>1)return 1;for(var c=t,d=0;d<8;d++){var m=this.sampleCurveX(c)-t;if(Math.abs(m)<o)return c;var g=this.sampleCurveDerivativeX(c);if(Math.abs(g)<1e-6)break;c-=m/g}var b=0,P=1;for(c=t,d=0;d<20&&(m=this.sampleCurveX(c),!(Math.abs(m-t)<o));d++)t>m?b=c:P=c,c=.5*(P-b)+b;return c},solve:function(t,o){return this.sampleCurveY(this.solveCurveX(t,o))}},fs})(),ll=rc(ru);function St(s,t){this.x=s,this.y=t}function Ns(s,t){if(Array.isArray(s)){if(!Array.isArray(t)||s.length!==t.length)return!1;for(let o=0;o<s.length;o++)if(!Ns(s[o],t[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&t!==null){if(typeof t!="object"||Object.keys(s).length!==Object.keys(t).length)return!1;for(const o in s)if(!Ns(s[o],t[o]))return!1;return!0}return s===t}St.prototype={clone(){return new St(this.x,this.y)},add(s){return this.clone()._add(s)},sub(s){return this.clone()._sub(s)},multByPoint(s){return this.clone()._multByPoint(s)},divByPoint(s){return this.clone()._divByPoint(s)},mult(s){return this.clone()._mult(s)},div(s){return this.clone()._div(s)},rotate(s){return this.clone()._rotate(s)},rotateAround(s,t){return this.clone()._rotateAround(s,t)},matMult(s){return this.clone()._matMult(s)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(s){return this.x===s.x&&this.y===s.y},dist(s){return Math.sqrt(this.distSqr(s))},distSqr(s){const t=s.x-this.x,o=s.y-this.y;return t*t+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith(s){return this.angleWithSep(s.x,s.y)},angleWithSep(s,t){return Math.atan2(this.x*t-this.y*s,this.x*s+this.y*t)},_matMult(s){const t=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=t,this},_add(s){return this.x+=s.x,this.y+=s.y,this},_sub(s){return this.x-=s.x,this.y-=s.y,this},_mult(s){return this.x*=s,this.y*=s,this},_div(s){return this.x/=s,this.y/=s,this},_multByPoint(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint(s){return this.x/=s.x,this.y/=s.y,this},_unit(){return this._div(this.mag()),this},_perp(){const s=this.y;return this.y=this.x,this.x=-s,this},_rotate(s){const t=Math.cos(s),o=Math.sin(s),c=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=c,this},_rotateAround(s,t){const o=Math.cos(s),c=Math.sin(s),d=t.y+c*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-c*(this.y-t.y),this.y=d,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:St},St.convert=function(s){if(s instanceof St)return s;if(Array.isArray(s))return new St(+s[0],+s[1]);if(s.x!==void 0&&s.y!==void 0)return new St(+s.x,+s.y);throw new Error("Expected [x, y] or {x, y} point format")};const Dl=Math.PI/180,Ka=180/Math.PI;function vn(s){return s*Dl}function So(s){return s*Ka}const Sa=[[0,0],[1,0],[1,1],[0,1]];function cl(s){if(s<=0)return 0;if(s>=1)return 1;const t=s*s,o=t*s;return 4*(s<.5?o:3*(s-t)+o-.75)}function qe(s,t,o,c){const d=new ll(s,t,o,c);return function(m){return d.solve(m)}}const ie=qe(.25,.1,.25,1);function le(s,t,o){return Math.min(o,Math.max(t,s))}function we(s,t,o){return(o=le((o-s)/(t-s),0,1))*o*(3-2*o)}function Oe(s,t,o){const c=o-t,d=((s-t)%c+c)%c+t;return d===t?o:d}function Le(s,t,o){if(!s.length)return o(null,[]);let c=s.length;const d=new Array(s.length);let m=null;s.forEach(((g,b)=>{t(g,((P,I)=>{P&&(m=P),d[b]=I,--c==0&&o(m,d)}))}))}let Ue=1;function nt(){return Ue++}function We(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log2(s)))}function Je(s,t){s.forEach((o=>{t[o]&&(t[o]=t[o].bind(t))}))}function Ot(s,t,o){const c={};for(const d in s)c[d]=t.call(this,s[d],d,s);return c}function Pt(s,t,o){const c={};for(const d in s)t.call(this,s[d],d,s)&&(c[d]=s[d]);return c}function gr(s){return Array.isArray(s)?s.map(gr):typeof s=="object"&&s?Ot(s,gr):s}function jr(s,t){for(let o=0;o<s.length;o++)if(t.indexOf(s[o])>=0)return!0;return!1}const yr={};function Cr(s){yr[s]||(typeof console<"u"&&console.warn(s),yr[s]=!0)}function Zr(s,t,o){return(o.y-s.y)*(t.x-s.x)>(t.y-s.y)*(o.x-s.x)}function on(s){let t=0;for(let o,c,d=0,m=s.length,g=m-1;d<m;g=d++)o=s[d],c=s[g],t+=(c.x-o.x)*(o.y+c.y);return t}function Cn([s,t,o]){const c=vn(t+90),d=vn(o);return{x:s*Math.cos(c)*Math.sin(d),y:s*Math.sin(c)*Math.sin(d),z:s*Math.cos(d),azimuthal:t,polar:o}}function Mi(s){return(typeof self<"u"||s!==void 0)&&typeof WorkerGlobalScope<"u"&&(s!==void 0?s:self)instanceof WorkerGlobalScope}function Qi(s){const t={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((o,c,d,m)=>{const g=d||m;return t[c]=!g||g.toLowerCase(),""})),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t}let Ti=null;function si(s,t){return[s[4*t],s[4*t+1],s[4*t+2],s[4*t+3]]}function Ln(s,t,o,c){for(;t<o;){const d=t+o>>1;s[d]<c?t=d+1:o=d}return t}function rn(s,t,o,c){for(;t<o;){const d=t+o>>1;s[d]<=c?t=d+1:o=d}return t}function fi(s){return s>0?1/(1.001-s):1+s}function Ei(s){return s>0?1-1/(1.001-s):-s}function $n(s,t,o){return(s-t.min)*(o.max-o.min)/(t.max-t.min)+o.min}const ii={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ii.API_URL)return null;try{const s=new URL(ii.API_URL);return s.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":s.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.3.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Ji(s){return ii.API_URL_REGEX.test(s)}function To(s){return ii.API_SPRITE_REGEX.test(s)}let ps,Oa,uo,Cs,Jo,As;function Ho(){return ps==null&&(ps=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),ps}const Ds={now:()=>Cs!==void 0?Cs:performance.now(),setNow(s){Cs=s},restoreNow(){Cs=void 0},frame(s){const t=requestAnimationFrame(s);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(s,t=0){const{width:o,height:c}=s;Jo||(Jo=document.createElement("canvas"));const d=Jo.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return(o>Jo.width||c>Jo.height)&&(Jo.width=o,Jo.height=c),d.clearRect(-t,-t,o+2*t,c+2*t),d.drawImage(s,0,0,o,c),d.getImageData(-t,-t,o+2*t,c+2*t)},resolveURL:s=>(Oa||(Oa=document.createElement("a")),Oa.href=s,Oa.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(uo==null&&(uo=window.matchMedia("(prefers-reduced-motion: reduce)")),uo.matches)},hasCanvasFingerprintNoise(){if(As!==void 0)return As;if(!Ho())return As=!1,!1;const s=new OffscreenCanvas(85,1),t=s.getContext("2d",{willReadFrequently:!0});let o=0;for(let d=0;d<s.width;++d)t.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,t.fillRect(d,0,1,1);const c=t.getImageData(0,0,s.width,s.height);o=0;for(let d=0;d<c.data.length;++d)if(d%4!=3&&o++!==c.data[d])return As=!0,!0;return As=!1,!1}};function nc(s,t){const o=s.indexOf("?");if(o<0)return`${s}?${new URLSearchParams(t).toString()}`;const c=new URLSearchParams(s.slice(o));for(const d in t)c.set(d,t[d]);return`${s.slice(0,o)}?${c.toString()}`}function yi(s,t={persistentParams:[]}){const o=s.indexOf("?");if(o<0)return s;const c=new URLSearchParams,d=new URLSearchParams(s.slice(o));for(const g of t.persistentParams){const b=d.get(g);b&&c.set(g,b)}const m=c.toString();return`${s.slice(0,o)}${m.length>0?`?${m}`:""}`}const ic="mapbox-tiles";let oc=500,es=50;const Rs=["language","worldview","jobid"];let ts,Os;function Ta(){try{return caches}catch{}}function Vs(){const s=Ta();s&&ts==null&&(ts=s.open(ic))}let Us=1/0;const $s={supported:!1,testSupport:function(s){!ul&&oa&&(Ea?La(s):jo=s)}};let jo,oa,ul=!1,Ea=!1;const Ws=typeof self<"u"?self:{};function La(s){const t=s.createTexture();s.bindTexture(s.TEXTURE_2D,t);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,oa),s.isContextLost())return;$s.supported=!0}catch{}s.deleteTexture(t),ul=!0}Ws.document&&(oa=Ws.document.createElement("img"),oa.onload=function(){jo&&La(jo),jo=null,Ea=!0},oa.onerror=function(){ul=!0,jo=null},oa.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ms={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(ms);class Rl extends Error{constructor(t,o,c){o===401&&Ji(c)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=o,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Rc=Mi()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,dl=function(s,t){if(!(/^file:/.test(o=s.url)||/^file:/.test(Rc())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return(function(c,d){const m=new AbortController,g=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Rc(),referrerPolicy:c.referrerPolicy,signal:m.signal});let b=!1,P=!1;const I=(O=g.url).indexOf("sku=")>0&&Ji(O);var O;c.type==="json"&&g.headers.set("Accept","application/json");const L=($,W,Q)=>{if(P)return;if($&&$.message!=="SecurityError"&&Cr($.toString()),W&&Q)return k(W);const te=Date.now();fetch(g).then((ne=>{if(ne.ok){const ue=I?ne.clone():null;return k(ne,ue,te)}return d(new Rl(ne.statusText,ne.status,c.url))})).catch((ne=>{ne.name!=="AbortError"&&d(new Error(`${ne.message} ${c.url}`))}))},k=($,W,Q)=>{(c.type==="arrayBuffer"?$.arrayBuffer():c.type==="json"?$.json():$.text()).then((te=>{P||(W&&Q&&(function(ne,ue,he){if(Vs(),ts==null)return;const me=Qi(ue.headers.get("Cache-Control")||"");if(me["no-store"])return;const Ae={status:ue.status,statusText:ue.statusText,headers:new Headers};ue.headers.forEach(((Be,Ve)=>Ae.headers.set(Ve,Be))),me["max-age"]&&Ae.headers.set("Expires",new Date(he+1e3*me["max-age"]).toUTCString());const Pe=Ae.headers.get("Expires");if(!Pe||new Date(Pe).getTime()-he<42e4)return;let Fe=yi(ne.url,{persistentParams:Rs});if(ue.status===206){const Be=ne.headers.get("Range");if(!Be)return;Ae.status=200,Fe=nc(Fe,{range:Be})}(function(Be,Ve){if(Os===void 0)try{new Response(new ReadableStream),Os=!0}catch{Os=!1}Os?Ve(Be.body):Be.blob().then(Ve).catch((at=>Cr(at.message)))})(ue,(Be=>{const Ve=new Response((at=ue.status)!==200&&at!==404&&[101,103,204,205,304].includes(at)?null:Be,Ae);var at;Vs(),ts?.then((Ze=>Ze.put(Fe,Ve))).catch((Ze=>Cr(Ze.message)))}))})(g,W,Q),b=!0,d(null,te,$.headers))})).catch((te=>{P||d(new Error(te.message))}))};return I?(function($,W){if(Vs(),ts==null)return W(null);ts.then((Q=>{let te=yi($.url,{persistentParams:Rs});const ne=$.headers.get("Range");ne&&(te=nc(te,{range:ne})),Q.match(te).then((ue=>{const he=(function(me){if(!me)return!1;const Ae=new Date(me.headers.get("Expires")||0),Pe=Qi(me.headers.get("Cache-Control")||"");return Number(Ae)>Date.now()&&!Pe["no-cache"]})(ue);Q.delete(te).catch(W),he&&Q.put(te,ue.clone()).catch(W),W(null,ue,he)})).catch(W)})).catch(W)})(g,L):L(null,null),{cancel:()=>{P=!0,b||m.abort()}}})(s,t);if(Mi(self)&&self.worker.actor)return self.worker.actor.send("getResource",s,t,void 0,!0)}var o;return(function(c,d){const m=new XMLHttpRequest;m.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const g in c.headers)m.setRequestHeader(g,c.headers[g]);return c.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=c.credentials==="include",m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let g=m.response;if(c.type==="json")try{g=JSON.parse(m.response)}catch(P){return d(P)}const b=new Headers;m.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((P=>{const I=P.split(": "),O=I.shift(),L=I.join(": ");b.append(O,L)})),d(null,g,b)}else d(new Rl(m.statusText,m.status,c.url))},m.send(c.body),{cancel:()=>m.abort()}})(s,t)},hl=function(s,t){return dl(Object.assign(s,{type:"arrayBuffer"}),t)};function bn(s){const t=document.createElement("a");return t.href=s,t.protocol===location.protocol&&t.host===location.host}const Ol="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let za,Fa;za=[],Fa=0;const Ge=function(s,t){if($s.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),Fa>=ii.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:s,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return za.push(m),m}Fa++;let o=!1;const c=()=>{if(!o)for(o=!0,Fa--;za.length&&Fa<ii.MAX_PARALLEL_IMAGE_REQUESTS;){const m=za.shift(),{requestParameters:g,callback:b,cancelled:P}=m;P||(m.cancel=Ge(g,b).cancel)}},d=hl(s,((m,g,b)=>{c(),m?t(m):g&&(self.createImageBitmap?(function(P,I){const O=new Blob([new Uint8Array(P)],{type:"image/png"});createImageBitmap(O).then((L=>{I(null,L)})).catch((L=>{I(new Error(`Could not load image because of ${L.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(g,((P,I)=>t(P,I,b))):(function(P,I){const O=new Image;O.onload=()=>{I(null,O),URL.revokeObjectURL(O.src),O.onload=null,requestAnimationFrame((()=>{O.src=Ol}))},O.onerror=()=>I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new Blob([new Uint8Array(P)],{type:"image/png"});O.src=P.byteLength?URL.createObjectURL(L):Ol})(g,((P,I)=>t(P,I,b))))}));return{cancel:()=>{d.cancel(),c()}}};var yt,Ht,Xr,jn={exports:{}},Ri={exports:{}},Ui={exports:{}},ai=(function(){if(Xr)return jn.exports;Xr=1;var s=(yt||(yt=1,Ri.exports=function(o,c){var d,m,g,b,P,I,O,L;for(m=o.length-(d=3&o.length),g=c,P=3432918353,I=461845907,L=0;L<m;)O=255&o.charCodeAt(L)|(255&o.charCodeAt(++L))<<8|(255&o.charCodeAt(++L))<<16|(255&o.charCodeAt(++L))<<24,++L,g=27492+(65535&(b=5*(65535&(g=(g^=O=(65535&(O=(O=(65535&O)*P+(((O>>>16)*P&65535)<<16)&4294967295)<<15|O>>>17))*I+(((O>>>16)*I&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(O=0,d){case 3:O^=(255&o.charCodeAt(L+2))<<16;case 2:O^=(255&o.charCodeAt(L+1))<<8;case 1:g^=O=(65535&(O=(O=(65535&(O^=255&o.charCodeAt(L)))*P+(((O>>>16)*P&65535)<<16)&4294967295)<<15|O>>>17))*I+(((O>>>16)*I&65535)<<16)&4294967295}return g^=o.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),Ri.exports),t=(Ht||(Ht=1,Ui.exports=function(o,c){for(var d,m=o.length,g=c^m,b=0;m>=4;)d=1540483477*(65535&(d=255&o.charCodeAt(b)|(255&o.charCodeAt(++b))<<8|(255&o.charCodeAt(++b))<<16|(255&o.charCodeAt(++b))<<24))+((1540483477*(d>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),m-=4,++b;switch(m){case 3:g^=(255&o.charCodeAt(b+2))<<16;case 2:g^=(255&o.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&o.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),Ui.exports);return jn.exports=s,jn.exports.murmur3=s,jn.exports.murmur2=t,jn.exports})(),Oi=rc(ai);class eo{constructor(t,...o){Object.assign(this,o[0]||{}),this.type=t}}class Yo extends eo{constructor(t,o={}){super("error",Object.assign({error:t},o))}}function qs(s,t,o){o[s]&&o[s].indexOf(t)!==-1||(o[s]=o[s]||[],o[s].push(t))}function ka(s,t,o){if(o&&o[s]){const c=o[s].indexOf(t);c!==-1&&o[s].splice(c,1)}}class sa{on(t,o){return this._listeners=this._listeners||{},qs(t,o,this._listeners),this}off(t,o){return ka(t,o,this._listeners),ka(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},qs(t,o,this._oneTimeListeners),this):new Promise((c=>{this.once(t,c)}))}fire(t,o){const c=typeof t=="string"?new eo(t,o):t,d=c.type;if(this.listens(d)){c.target=this;const m=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const P of m)P.call(this,c);const g=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const P of g)ka(d,P,this._oneTimeListeners),P.call(this,c);const b=this._eventedParent;if(b){const P=typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData;Object.assign(c,P),b.fire(c)}}else c instanceof Yo&&console.error(c.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}class pi{constructor(t){typeof t=="string"?this.name=t:(this.name=t.name,this.iconsetId=t.iconsetId)}static from(t){return new pi(t)}static toString(t){return t.iconsetId?`${t.name}${t.iconsetId}`:t.name}static parse(t){const[o,c]=t.split("");return new pi({name:o,iconsetId:c})}static isEqual(t,o){return t.name===o.name&&t.iconsetId===o.iconsetId}toString(){return pi.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var sc,Iu={},Oc=(function(){if(sc)return Iu;sc=1;var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function t(m){return(m=Math.round(m))<0?0:m>255?255:m}function o(m){return t(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function c(m){return(g=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:g>1?1:g;var g}function d(m,g,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?m+(g-m)*b*6:2*b<1?g:3*b<2?m+(g-m)*(2/3-b)*6:m}try{Iu.parseCSSColor=function(m){var g,b=m.replace(/ /g,"").toLowerCase();if(b in s)return s[b].slice();if(b[0]==="#")return b.length===4?(g=parseInt(b.substr(1),16))>=0&&g<=4095?[(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1]:null:b.length===7&&(g=parseInt(b.substr(1),16))>=0&&g<=16777215?[(16711680&g)>>16,(65280&g)>>8,255&g,1]:null;var P=b.indexOf("("),I=b.indexOf(")");if(P!==-1&&I+1===b.length){var O=b.substr(0,P),L=b.substr(P+1,I-(P+1)).split(","),k=1;switch(O){case"rgba":if(L.length!==4)return null;k=c(L.pop());case"rgb":return L.length!==3?null:[o(L[0]),o(L[1]),o(L[2]),k];case"hsla":if(L.length!==4)return null;k=c(L.pop());case"hsl":if(L.length!==3)return null;var $=(parseFloat(L[0])%360+360)%360/360,W=c(L[1]),Q=c(L[2]),te=Q<=.5?Q*(W+1):Q+W-Q*W,ne=2*Q-te;return[t(255*d(ne,te,$+1/3)),t(255*d(ne,te,$)),t(255*d(ne,te,$-1/3)),k];default:return null}}return null}}catch{}return Iu})();class zn{constructor(t,o,c,d=1){this.r=t,this.g=o,this.b=c,this.a=d}static parse(t){if(!t)return;if(t instanceof zn)return t;if(typeof t!="string")return;const o=Oc.parseCSSColor(t);return o?new zn(o[0]/255,o[1]/255,o[2]/255,o[3]):void 0}toString(){const[t,o,c,d]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*t)},${Math.round(255*o)},${Math.round(255*c)},${d})`}toNonPremultipliedRenderColor(t){const{r:o,g:c,b:d,a:m}=this;return new rd(t,o,c,d,m)}toPremultipliedRenderColor(t){const{r:o,g:c,b:d,a:m}=this;return new nu(t,o*m,c*m,d*m,m)}clone(){return new zn(this.r,this.g,this.b,this.a)}}class Mu{constructor(t,o,c,d,m,g=!1){if(this.premultiplied=!1,this.premultiplied=g,t){const b=t.image.height,P=b*b;this.premultiplied?(o=m===0?0:o/m*(b-1),c=m===0?0:c/m*(b-1),d=m===0?0:d/m*(b-1)):(o*=b-1,c*=b-1,d*=b-1);const I=Math.floor(o),O=Math.floor(c),L=Math.floor(d),k=Math.ceil(o),$=Math.ceil(c),W=Math.ceil(d),Q=o-I,te=c-O,ne=d-L,ue=t.image.data,he=4*(I+O*P+L*b),me=4*(I+O*P+W*b),Ae=4*(I+$*P+L*b),Pe=4*(I+$*P+W*b),Fe=4*(k+O*P+L*b),Be=4*(k+O*P+W*b),Ve=4*(k+$*P+L*b),at=4*(k+$*P+W*b);if(he<0||at>=ue.length)throw new Error("out of range");this.r=Lr(Lr(Lr(ue[he],ue[me],ne),Lr(ue[Ae],ue[Pe],ne),te),Lr(Lr(ue[Fe],ue[Be],ne),Lr(ue[Ve],ue[at],ne),te),Q)/255*(this.premultiplied?m:1),this.g=Lr(Lr(Lr(ue[he+1],ue[me+1],ne),Lr(ue[Ae+1],ue[Pe+1],ne),te),Lr(Lr(ue[Fe+1],ue[Be+1],ne),Lr(ue[Ve+1],ue[at+1],ne),te),Q)/255*(this.premultiplied?m:1),this.b=Lr(Lr(Lr(ue[he+2],ue[me+2],ne),Lr(ue[Ae+2],ue[Pe+2],ne),te),Lr(Lr(ue[Fe+2],ue[Be+2],ne),Lr(ue[Ve+2],ue[at+2],ne),te),Q)/255*(this.premultiplied?m:1),this.a=m}else this.r=o,this.g=c,this.b=d,this.a=m}toArray(){const{r:t,g:o,b:c,a:d}=this;return[255*t,255*o,255*c,d]}toHslaArray(){let{r:t,g:o,b:c,a:d}=this;if(this.premultiplied){if(d===0)return[0,0,0,0];const W=1/d;t*=W,o*=W,c*=W}const m=Math.min(Math.max(t,0),1),g=Math.min(Math.max(o,0),1),b=Math.min(Math.max(c,0),1),P=Math.min(m,g,b),I=Math.max(m,g,b),O=I-P,L=.5*(P+I);if(O===0)return[0,0,100*L,d];const k=L>.5?O/(2-I-P):O/(I+P);let $;switch(I){case m:$=60*((g-b)/O+(g<b?6:0));break;case g:$=60*((b-m)/O+2);break;default:$=60*((m-g)/O+4)}return[$,100*k,100*L,d]}toArray01(){const{r:t,g:o,b:c,a:d}=this;return[t,o,c,d]}toArray01Scaled(t){const{r:o,g:c,b:d}=this;return[o*t,c*t,d*t]}toArray01Linear(){const{r:t,g:o,b:c,a:d}=this;return[Math.pow(t,2.2),Math.pow(o,2.2),Math.pow(c,2.2),d]}}class rd extends Mu{constructor(t,o,c,d,m){super(t,o,c,d,m,!1)}}class nu extends Mu{constructor(t,o,c,d,m){super(t,o,c,d,m,!0)}}function Lr(s,t,o){return s*(1-o)+t*o}function iu(s,t,o){return s.map(((c,d)=>Lr(c,t[d],o)))}zn.black=new zn(0,0,0,1),zn.white=new zn(1,1,1,1),zn.transparent=new zn(0,0,0,0),zn.red=new zn(1,0,0,1),zn.blue=new zn(0,0,1,1);var Ll=Object.freeze({__proto__:null,array:iu,color:function(s,t,o){return new zn(Lr(s.r,t.r,o),Lr(s.g,t.g,o),Lr(s.b,t.b,o),Lr(s.a,t.a,o))},number:Lr});class Ba extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class ja{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[c,d]of o)this.bindings[c]=d}concat(t){return new ja(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ac={kind:"null"},br={kind:"number"},wn={kind:"string"},Dn={kind:"boolean"},aa={kind:"color"},ou={kind:"object"},Fn={kind:"value"},Cu={kind:"collator"},Lc={kind:"formatted"},Au={kind:"resolvedImage"};function Zo(s,t){return{kind:"array",itemType:s,N:t}}function ho(s){if(s.kind==="array"){const t=ho(s.itemType);return typeof s.N=="number"?`array<${t}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${t}>`}return s.kind}const Bf=[ac,br,wn,Dn,aa,Lc,ou,Zo(Fn),Au];function Du(s,t){if(t.kind==="error")return null;if(s.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Du(s.itemType,t.itemType))&&(typeof s.N!="number"||s.N===t.N))return null}else{if(s.kind===t.kind)return null;if(s.kind==="value"){for(const o of Bf)if(!Du(o,t))return null}}return`Expected ${ho(s)} but found ${ho(t)} instead.`}function zd(s,t){return t.some((o=>o.kind===s.kind))}function su(s,t){return t.some((o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s))}function nd(s,t){return s.kind==="array"&&t.kind==="array"?s.N===t.N&&nd(s.itemType,t.itemType):s.kind===t.kind}class Fd{constructor(t,o,c){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ru{constructor(t,o,c,d,m){this.text=t.normalize?t.normalize():t,this.image=o,this.scale=c,this.fontStack=d,this.textColor=m}}class No{constructor(t){this.sections=t}static fromString(t){return new No([new Ru(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||!!t.image&&t.image.hasPrimary()))}static factory(t){return t instanceof No?t:No.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const o of this.sections){if(o.image){const d=o.image.getPrimary().id.toString();t.push(["image",d]);continue}t.push(o.text);const c={};o.fontStack&&(c["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(c["font-scale"]=o.scale),o.textColor&&(c["text-color"]=["rgba"].concat(o.textColor.toNonPremultipliedRenderColor(null).toArray())),t.push(c)}return t}}class zl{constructor(t,o={}){if(this.id=pi.from(t),this.options=Object.assign({},o),o.transform){const{a:c,b:d,c:m,d:g,e:b,f:P}=o.transform;this.options.transform=new DOMMatrix([c,d,m,g,b,P])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:t,b:o,c,d,e:m,f:g}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:t,b:o,c,d,e:m,f:g}})}static parse(t){let o,c,d,m;try{({name:o,iconsetId:c,params:d,transform:m}=JSON.parse(t)||{})}catch{return null}if(!o)return null;const{a:g,b,c:P,d:I,e:O,f:L}=m||{};return new zl({name:o,iconsetId:c},{params:d,transform:new DOMMatrix([g,b,P,I,O,L])})}scaleSelf(t,o){return this.options.transform.scaleSelf(t,o),this}}class Gs{constructor(t,o,c,d,m=!1){this.primaryId=pi.from(t),this.primaryOptions=o,c&&(this.secondaryId=pi.from(c)),this.secondaryOptions=d,this.available=m}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new zl(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new zl(this.secondaryId,this.secondaryOptions):null}static from(t){return typeof t=="string"?Gs.build({name:t}):t}static build(t,o,c,d){return!t||typeof t=="object"&&!("name"in t)?null:new Gs(t,c,o,d)}}function id(s,t,o,c){return typeof s=="number"&&s>=0&&s<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[s,t,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[s,t,o,c]:[s,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function lc(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof zn||s instanceof Fd||s instanceof No||s instanceof Gs)return!0;if(Array.isArray(s)){for(const t of s)if(!lc(t))return!1;return!0}if(typeof s=="object"){for(const t in s)if(!lc(s[t]))return!1;return!0}return!1}function fo(s){if(s===null)return ac;if(typeof s=="string")return wn;if(typeof s=="boolean")return Dn;if(typeof s=="number")return br;if(s instanceof zn)return aa;if(s instanceof Fd)return Cu;if(s instanceof No)return Lc;if(s instanceof Gs)return Au;if(Array.isArray(s)){const t=s.length;let o;for(const c of s){const d=fo(c);if(o){if(o===d)continue;o=Fn;break}o=d}return Zo(o||Fn,t)}return ou}function fl(s){const t=typeof s;return s===null?"":t==="string"||t==="number"||t==="boolean"?String(s):s instanceof No||s instanceof Gs||s instanceof zn?s.toString():JSON.stringify(s)}class pl{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!lc(t[1]))return o.error("invalid value");const c=t[1];let d=fo(c);const m=o.expectedType;return d.kind!=="array"||d.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(d=m),new pl(d,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof zn?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof No?this.value.serialize():this.value}}class Xi{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const en={string:wn,number:br,boolean:Dn,object:ou};class pr{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let c,d=1;const m=t[0];if(m==="array"){let b,P;if(t.length>2){const I=t[1];if(typeof I!="string"||!(I in en)||I==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=en[I],d++}else b=Fn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);P=t[2],d++}c=Zo(b,P)}else c=en[m];const g=[];for(;d<t.length;d++){const b=o.parse(t[d],d,Fn);if(!b)return null;g.push(b)}return new pr(c,g)}evaluate(t){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(t);if(!Du(this.type,fo(c)))return c;if(o===this.args.length-1)throw new Xi(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${ho(fo(c))} but was expected to be of type ${ho(this.type)}.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,o=[t.kind];if(t.kind==="array"){const c=t.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){o.push(c.kind);const d=t.N;(typeof d=="number"||this.args.length>1)&&o.push(d)}}return o.concat(this.args.map((c=>c.serialize())))}}class cc{constructor(t){this.type=Lc,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const d=[];let m=!1;for(let g=1;g<=t.length-1;++g){const b=t[g];if(m&&typeof b=="object"&&!Array.isArray(b)){m=!1;let P=null;if(b["font-scale"]&&(P=o.parseObjectValue(b["font-scale"],g,"font-scale",br),!P))return null;let I=null;if(b["text-font"]&&(I=o.parseObjectValue(b["text-font"],g,"text-font",Zo(wn)),!I))return null;let O=null;if(b["text-color"]&&(O=o.parseObjectValue(b["text-color"],g,"text-color",aa),!O))return null;const L=d[d.length-1];L.scale=P,L.font=I,L.textColor=O}else{const P=o.parse(t[g],g,Fn);if(!P)return null;const I=P.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:P,scale:null,font:null,textColor:null})}}return new cc(d)}evaluate(t){return new No(this.sections.map((o=>{const c=o.content.evaluate(t);return nd(fo(c),Au)?new Ru("",c,null,null,null):new Ru(fl(c),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)})))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const o of this.sections){t.push(o.content.serialize());const c={};o.scale&&(c["font-scale"]=o.scale.serialize()),o.font&&(c["text-font"]=o.font.serialize()),o.textColor&&(c["text-color"]=o.textColor.serialize()),t.push(c)}return t}}class Nr{constructor(t,o,c,d){this._imageWarnHistory={},this.type=Au,this.namePrimary=t,this.nameSecondary=o,c&&(this.paramsPrimary=c.params,this.iconsetIdPrimary=c.iconset?c.iconset.id:void 0),d&&(this.paramsSecondary=d.params,this.iconsetIdSecondary=d.iconset?d.iconset.id:void 0)}static parse(t,o){if(t.length<2)return o.error("Expected two or more arguments.");let c=1;const d=[];function m(){if(c<t.length){const b=o.parse(t[c],c++,wn);return b?(d.push({image:b,options:{}}),!0):(o.error(d.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function g(){if(c<t.length){const P=t[c];if((b=P)===null||typeof b!="object"||Array.isArray(b))return!0;const I=P.params,O=P.iconset,L=o.concat(c);if(!I&&!O)return c++,!0;if(I){if(typeof I!="object"||I.constructor!==Object)return L.error('Image options "params" should be an object'),!1;const k={},$=L.concat(void 0,"params");for(const W in I){if(!W)return $.error("Image parameter name should be non-empty"),!1;const Q=$.concat(void 0,W).parse(I[W],void 0,aa,void 0,{typeAnnotation:"coerce"});if(!Q)return!1;k[W]=Q}d[d.length-1].options.params=k}if(O){if(typeof O!="object"||O.constructor!==Object)return L.error('Image options "iconset" should be an object'),!1;if(!O.id)return L.error('Image options "iconset" should have an "id" property'),!1;d[d.length-1].options.iconset=O}return c++,!0}var b;return!0}for(let b=0;b<2;b++)if(!m()||!g())return;return new Nr(d[0].image,d[1]?d[1].image:void 0,d[0].options,d[1]?d[1].options:void 0)}evaluateParams(t,o){const c={};if(o){for(const d in o)if(o[d])try{c[d]=o[d].evaluate(t)}catch{continue}if(Object.keys(c).length!==0)return{params:c}}}evaluate(t){const o={name:this.namePrimary.evaluate(t),iconsetId:this.iconsetIdPrimary},c=this.nameSecondary?{name:this.nameSecondary.evaluate(t),iconsetId:this.iconsetIdSecondary}:void 0,d=Gs.build(o,c,this.paramsPrimary?this.evaluateParams(t,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(t,this.paramsSecondary):void 0);if(d&&t.availableImages){const m=d.getPrimary().id;if(d.available=t.availableImages.some((g=>pi.isEqual(g,m))),d.available){const g=d.getSecondary()?d.getSecondary().id:null;g&&(d.available=t.availableImages.some((b=>pi.isEqual(b,g))))}}return d}eachChild(t){if(t(this.namePrimary),this.paramsPrimary)for(const o in this.paramsPrimary)this.paramsPrimary[o]&&t(this.paramsPrimary[o]);if(this.nameSecondary&&(t(this.nameSecondary),this.paramsSecondary))for(const o in this.paramsSecondary)this.paramsSecondary[o]&&t(this.paramsSecondary[o])}outputDefined(){return!1}serializeOptions(t,o){const c={};if(o&&(c.iconset={id:o}),t){c.params={};for(const d in t)t[d]&&(c.params[d]=t[d].serialize())}return Object.keys(c).length>0?c:void 0}serialize(){const t=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const o=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);o&&t.push(o)}if(this.nameSecondary&&(t.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const o=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);o&&t.push(o)}return t}}function au(s){return Vr(s)?"string":lu(s)?"number":Ou(s)?"boolean":Array.isArray(s)?"array":s===null?"null":od(s)?"object":typeof s}function od(s){return s!=null&&!Array.isArray(s)&&typeof s!="function"&&!(s instanceof String||s instanceof Number||s instanceof Boolean)&&typeof s=="object"}function Vr(s){return typeof s=="string"||s instanceof String}function lu(s){return typeof s=="number"||s instanceof Number}function Ou(s){return typeof s=="boolean"||s instanceof Boolean}const cu={"to-boolean":Dn,"to-color":aa,"to-number":br,"to-string":wn};class la{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const c=t[0],d=[];let m=ac;if(c==="to-array"){if(!Array.isArray(t[1]))return null;const g=t[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);m=Zo(o.expectedType.itemType,g)}else{if(!(g>0&&lc(t[1][0])))return null;m=Zo(fo(t[1][0]),g)}for(let b=0;b<g;b++){const P=t[1][b];let I;if(Array.isArray(P))I=o.parse(P,void 0,m.itemType);else{const O=au(P);if(O!==m.itemType.kind)return o.error(`Expected ${m.itemType.kind} but found ${O}.`);I=o.registry.literal.parse(["literal",P===void 0?null:P],o)}if(!I)return null;d.push(I)}}else{if((c==="to-boolean"||c==="to-string")&&t.length!==2)return o.error("Expected one argument.");m=cu[c];for(let g=1;g<t.length;g++){const b=o.parse(t[g],g,Fn);if(!b)return null;d.push(b)}}return new la(m,d)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let o,c;for(const d of this.args){if(o=d.evaluate(t),c=null,o instanceof zn)return o;if(typeof o=="string"){const m=t.parseColor(o);if(m)return m}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:id(o[0],o[1],o[2],o[3]),!c))return new zn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Xi(c||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const c of this.args){if(o=c.evaluate(t),o===null)return 0;const d=Number(o);if(!isNaN(d))return d}throw new Xi(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?No.fromString(fl(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Gs.build(fl(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map((o=>o.evaluate(t))):fl(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new cc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Nr(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild((o=>{t.push(o.serialize())})),t}}const sd=["Unknown","Point","LineString","Polygon"];class Eo{constructor(t,o,c){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=o,this.iconImageUseTheme=c}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?sd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:c,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*o-t[0])+this.featureDistanceData.bearing[1]*(d*o-t[1])}return 0}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=zn.parse(t)),o}getConfig(t){return this.options?this.options.get(t):null}}class gs{constructor(t,o,c,d,m){this.name=t,this.type=o,this._evaluate=c,this.args=d,this._overloadIndex=m}evaluate(t){if(!this._evaluate){const o=gs.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,o){const c=t[0],d=gs.definitions[c];if(!d)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,g=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,b=[];let P=null,I=-1;for(const[O,L]of g){if(Array.isArray(O)&&O.length!==t.length-1)continue;b.push(O),I++,P=new hd(o.registry,o.path,null,o.scope,void 0,o._scope,o.options,o.iconImageUseTheme);const k=[];let $=!1;for(let W=1;W<t.length;W++){const Q=t[W],te=Array.isArray(O)?O[W-1]:O.type,ne=P.parse(Q,1+k.length,te);if(!ne){$=!0;break}k.push(ne)}if(!$)if(Array.isArray(O)&&O.length!==k.length)P.error(`Expected ${O.length} arguments, but found ${k.length} instead.`);else{for(let W=0;W<k.length;W++){const Q=Array.isArray(O)?O[W]:O.type,te=k[W];P.concat(W+1).checkSubtype(Q,te.type)}if(P.errors.length===0)return new gs(c,m,L,k,I)}}if(b.length===1)o.errors.push(...P.errors);else{const O=(b.length?b:g.map((([k])=>k))).map(uc).join(" | "),L=[];for(let k=1;k<t.length;k++){const $=o.parse(t[k],1+L.length);if(!$)return null;L.push(ho($.type))}o.error(`Expected arguments of type ${O}, but found (${L.join(", ")}) instead.`)}return null}static register(t,o){gs.definitions=o;for(const c in o)t[c]=gs}}function uc(s){return Array.isArray(s)?`(${s.map(ho).join(", ")})`:`(${ho(s.type)}...)`}class dc{constructor(t,o,c){this.type=Cu,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const d=c["case-sensitive"]===void 0?o.parse(!1,1,Dn):o.parseObjectValue(c["case-sensitive"],1,"case-sensitive",Dn);if(!d)return null;const m=c["diacritic-sensitive"]===void 0?o.parse(!1,1,Dn):o.parseObjectValue(c["diacritic-sensitive"],1,"diacritic-sensitive",Dn);if(!m)return null;let g=null;return c.locale&&(g=o.parseObjectValue(c.locale,1,"locale",wn),!g)?null:new dc(d,m,g)}evaluate(t){return new Fd(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}function Qa(s,t,o=0,c=s.length-1,d=Rh){for(;c>o;){if(c-o>600){const P=c-o+1,I=t-o+1,O=Math.log(P),L=.5*Math.exp(2*O/3),k=.5*Math.sqrt(O*L*(P-L)/P)*(I-P/2<0?-1:1);Qa(s,t,Math.max(o,Math.floor(t-I*L/P+k)),Math.min(c,Math.floor(t+(P-I)*L/P+k)),d)}const m=s[t];let g=o,b=c;for(Vo(s,o,t),d(s[c],m)>0&&Vo(s,o,c);g<b;){for(Vo(s,g,b),g++,b--;d(s[g],m)<0;)g++;for(;d(s[b],m)>0;)b--}d(s[o],m)===0?Vo(s,o,b):(b++,Vo(s,b,c)),b<=t&&(o=b+1),t<=b&&(c=b-1)}}function Vo(s,t,o){const c=s[t];s[t]=s[o],s[o]=c}function Rh(s,t){return s<t?-1:s>t?1:0}function Oh(s){let t=0;for(let o,c,d=0,m=s.length,g=m-1;d<m;g=d++)o=s[d],c=s[g],t+=(c.x-o.x)*(o.y+c.y);return t}function Lu(s,t){s[0]=Math.min(s[0],t[0]),s[1]=Math.min(s[1],t[1]),s[2]=Math.max(s[2],t[0]),s[3]=Math.max(s[3],t[1])}function hc(s,t){return!(s[0]<=t[0]||s[2]>=t[2]||s[1]<=t[1]||s[3]>=t[3])}function Lh(s,t,o){const c=s[0]-t[0],d=s[1]-t[1],m=s[0]-o[0],g=s[1]-o[1];return c*g-m*d==0&&c*m<=0&&d*g<=0}function Na(s,t,o=!1){let c=!1;for(let b=0,P=t.length;b<P;b++){const I=t[b];for(let O=0,L=I.length,k=L-1;O<L;k=O++){const $=I[k],W=I[O];if(Lh(s,$,W))return o;(m=$)[1]>(d=s)[1]!=(g=W)[1]>d[1]&&d[0]<(g[0]-m[0])*(d[1]-m[1])/(g[1]-m[1])+m[0]&&(c=!c)}}var d,m,g;return c}function zh(s,t,o,c){const d=c[0]-o[0],m=c[1]-o[1],g=(s[0]-o[0])*m-d*(s[1]-o[1]),b=(t[0]-o[0])*m-d*(t[1]-o[1]);return g>0&&b<0||g<0&&b>0}function ca(s,t,o,c){return(d=[c[0]-o[0],c[1]-o[1]])[0]*(m=[t[0]-s[0],t[1]-s[1]])[1]-d[1]*m[0]!=0&&!(!zh(s,t,o,c)||!zh(o,c,s,t));var d,m}function Fl(s){const t=new St(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),o=new St(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const c of s[0])t.x>c.x&&(t.x=c.x),t.y>c.y&&(t.y=c.y),o.x<c.x&&(o.x=c.x),o.y<c.y&&(o.y=c.y);return{min:t,max:o}}const kl=8192;function Fh(s,t){const o=(180+s[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(o*d*kl),Math.round(c*d*kl)]}function kd(s,t){for(let o=0;o<t.length;o++)if(Na(s,t[o]))return!0;return!1}function kh(s,t,o){for(const c of o)for(let d=0,m=c.length,g=m-1;d<m;g=d++)if(ca(s,t,c[g],c[d]))return!0;return!1}function ml(s,t){for(let o=0;o<s.length;++o)if(!Na(s[o],t))return!1;for(let o=0;o<s.length-1;++o)if(kh(s[o],s[o+1],t))return!1;return!0}function T(s,t){for(let o=0;o<t.length;o++)if(ml(s,t[o]))return!0;return!1}function tg(s,t,o){const c=[];for(let d=0;d<s.length;d++){const m=[];for(let g=0;g<s[d].length;g++){const b=Fh(s[d][g],o);Lu(t,b),m.push(b)}c.push(m)}return c}function zu(s,t,o){const c=[];for(let d=0;d<s.length;d++){const m=tg(s[d],t,o);c.push(m)}return c}function jf(s,t,o,c){if(s[0]<o[0]||s[0]>o[2]){const d=.5*c;let m=s[0]-o[0]>d?-c:o[0]-s[0]>d?c:0;m===0&&(m=s[0]-o[2]>d?-c:o[2]-s[0]>d?c:0),s[0]+=m}Lu(t,s)}function Bd(s,t,o,c){const d=Math.pow(2,c.z)*kl,m=[c.x*kl,c.y*kl],g=[];if(!s)return g;for(const b of s)for(const P of b){const I=[P.x+m[0],P.y+m[1]];jf(I,t,o,d),g.push(I)}return g}function gl(s,t,o,c){const d=Math.pow(2,c.z)*kl,m=[c.x*kl,c.y*kl],g=[];if(!s)return g;for(const P of s){const I=[];for(const O of P){const L=[O.x+m[0],O.y+m[1]];Lu(t,L),I.push(L)}g.push(I)}if(t[2]-t[0]<=d/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const P of g)for(const I of P)jf(I,t,o,d)}var b;return g}class ad{constructor(t,o){this.type=Dn,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(lc(t[1])){const c=t[1];if(c.type==="FeatureCollection")for(let d=0;d<c.features.length;++d){const m=c.features[d].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new ad(c,c.features[d].geometry)}else if(c.type==="Feature"){const d=c.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new ad(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new ad(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(o,c){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=o.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const b=tg(c.coordinates,m,g),P=Bd(o.geometry(),d,m,g);if(!hc(d,m))return!1;for(const I of P)if(!Na(I,b))return!1}if(c.type==="MultiPolygon"){const b=zu(c.coordinates,m,g),P=Bd(o.geometry(),d,m,g);if(!hc(d,m))return!1;for(const I of P)if(!kd(I,b))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(o,c){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=o.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const b=tg(c.coordinates,m,g),P=gl(o.geometry(),d,m,g);if(!hc(d,m))return!1;for(const I of P)if(!ml(I,b))return!1}if(c.type==="MultiPolygon"){const b=zu(c.coordinates,m,g),P=gl(o.geometry(),d,m,g);if(!hc(d,m))return!1;for(const I of P)if(!T(I,b))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const ld={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},cd=1/298.257223563,Nf=cd*(2-cd),jd=Math.PI/180;class Fu{static fromTile(t,o,c){const d=Math.PI*(1-2*(t+.5)/Math.pow(2,o)),m=Math.atan(.5*(Math.exp(d)-Math.exp(-d)))/jd;return new Fu(m,c)}static get units(){return ld}constructor(t,o){if(t===void 0)throw new Error("No latitude given.");if(o&&!ld[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(ld).join(", ")}`);const c=6378.137*jd*(o?ld[o]:1),d=Math.cos(t*jd),m=1/(1-Nf*(1-d*d)),g=Math.sqrt(m);this.kx=c*g*d,this.ky=c*g*m*(1-Nf)}distance(t,o){const c=_l(t[0]-o[0])*this.kx,d=(t[1]-o[1])*this.ky;return Math.sqrt(c*c+d*d)}bearing(t,o){const c=_l(o[0]-t[0])*this.kx;return Math.atan2(c,(o[1]-t[1])*this.ky)/jd}destination(t,o,c){const d=c*jd;return this.offset(t,Math.sin(d)*o,Math.cos(d)*o)}offset(t,o,c){return[t[0]+o/this.kx,t[1]+c/this.ky]}lineDistance(t){let o=0;for(let c=0;c<t.length-1;c++)o+=this.distance(t[c],t[c+1]);return o}area(t){let o=0;for(let c=0;c<t.length;c++){const d=t[c];for(let m=0,g=d.length,b=g-1;m<g;b=m++)o+=_l(d[m][0]-d[b][0])*(d[m][1]+d[b][1])*(c?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(t,o){let c=0;if(o<=0)return t[0];for(let d=0;d<t.length-1;d++){const m=t[d],g=t[d+1],b=this.distance(m,g);if(c+=b,c>o)return Vf(m,g,(o-(c-b))/b)}return t[t.length-1]}pointToSegmentDistance(t,o,c){let[d,m]=o,g=_l(c[0]-d)*this.kx,b=(c[1]-m)*this.ky;if(g!==0||b!==0){const P=(_l(t[0]-d)*this.kx*g+(t[1]-m)*this.ky*b)/(g*g+b*b);P>1?(d=c[0],m=c[1]):P>0&&(d+=g/this.kx*P,m+=b/this.ky*P)}return g=_l(t[0]-d)*this.kx,b=(t[1]-m)*this.ky,Math.sqrt(g*g+b*b)}pointOnLine(t,o){let c=1/0,d=t[0][0],m=t[0][1],g=0,b=0;for(let P=0;P<t.length-1;P++){let I=t[P][0],O=t[P][1],L=_l(t[P+1][0]-I)*this.kx,k=(t[P+1][1]-O)*this.ky,$=0;L===0&&k===0||($=(_l(o[0]-I)*this.kx*L+(o[1]-O)*this.ky*k)/(L*L+k*k),$>1?(I=t[P+1][0],O=t[P+1][1]):$>0&&(I+=L/this.kx*$,O+=k/this.ky*$)),L=_l(o[0]-I)*this.kx,k=(o[1]-O)*this.ky;const W=L*L+k*k;W<c&&(c=W,d=I,m=O,g=P,b=$)}return{point:[d,m],index:g,t:Math.max(0,Math.min(1,b))}}lineSlice(t,o,c){let d=this.pointOnLine(c,t),m=this.pointOnLine(c,o);if(d.index>m.index||d.index===m.index&&d.t>m.t){const I=d;d=m,m=I}const g=[d.point],b=d.index+1,P=m.index;!$p(c[b],g[0])&&b<=P&&g.push(c[b]);for(let I=b+1;I<=P;I++)g.push(c[I]);return $p(c[P],m.point)||g.push(m.point),g}lineSliceAlong(t,o,c){let d=0;const m=[];for(let g=0;g<c.length-1;g++){const b=c[g],P=c[g+1],I=this.distance(b,P);if(d+=I,d>t&&m.length===0&&m.push(Vf(b,P,(t-(d-I))/I)),d>=o)return m.push(Vf(b,P,(o-(d-I))/I)),m;d>t&&m.push(P)}return m}bufferPoint(t,o){const c=o/this.ky,d=o/this.kx;return[t[0]-d,t[1]-c,t[0]+d,t[1]+c]}bufferBBox(t,o){const c=o/this.ky,d=o/this.kx;return[t[0]-d,t[1]-c,t[2]+d,t[3]+c]}insideBBox(t,o){return _l(t[0]-o[0])>=0&&_l(t[0]-o[2])<=0&&t[1]>=o[1]&&t[1]<=o[3]}}function $p(s,t){return s[0]===t[0]&&s[1]===t[1]}function Vf(s,t,o){const c=_l(t[0]-s[0]);return[s[0]+c*o,s[1]+(t[1]-s[1])*o]}function _l(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s}class Uf{constructor(t=[],o=((c,d)=>c<d?-1:c>d?1:0)){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:c}=this,d=o[t];for(;t>0;){const m=t-1>>1,g=o[m];if(c(d,g)>=0)break;o[t]=g,t=m}o[t]=d}_down(t){const{data:o,compare:c}=this,d=this.length>>1,m=o[t];for(;t<d;){let g=1+(t<<1);const b=g+1;if(b<this.length&&c(o[b],o[g])<0&&(g=b),c(o[g],m)>=0)break;o[t]=o[g],t=g}o[t]=m}}var Ut=8192;function Wp(s,t){return t.dist-s.dist}const Bl=100,ud=50;function Nd(s){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==s.length)return!1;for(let o=0;o<t.length;o++)if(t[o]!==s[o])return!1;return!0}function $f(s){return s[1]-s[0]+1}function uu(s,t){const o=s[1]>=s[0]&&s[1]<t;return o||console.warn("Distance Expression: Index is out of range"),o}function dd(s,t){if(s[0]>s[1])return[null,null];const o=$f(s);if(t){if(o===2)return[s,null];const c=Math.floor(o/2);return[[s[0],s[0]+c],[s[0]+c,s[1]]]}{if(o===1)return[s,null];const c=Math.floor(o/2)-1;return[[s[0],s[0]+c],[s[0]+c+1,s[1]]]}}function fc(s,t){const o=[1/0,1/0,-1/0,-1/0];if(!uu(t,s.length))return o;for(let c=t[0];c<=t[1];++c)Lu(o,s[c]);return o}function xn(s){const t=[1/0,1/0,-1/0,-1/0];for(let o=0;o<s.length;++o)for(let c=0;c<s[o].length;++c)Lu(t,s[o][c]);return t}function Vd(s,t,o){if(Nd(s)||Nd(t))return NaN;let c=0,d=0;return s[2]<t[0]&&(c=t[0]-s[2]),s[0]>t[2]&&(c=s[0]-t[2]),s[1]>t[3]&&(d=s[1]-t[3]),s[3]<t[1]&&(d=t[1]-s[3]),o.distance([0,0],[c,d])}function Uo(s){return 360*s-180}function rg(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Ud(s,t){const o=Math.pow(2,t.z),c=(s.y/Ut+t.y)/o;return[Uo((s.x/Ut+t.x)/o),rg(c)]}function Wf(s,t){const o=[];for(let c=0;c<s.length;++c)o.push(Ud(s[c],t));return o}function $i(s,t,o){const c=o.pointOnLine(t,s).point;return o.distance(s,c)}function qp(s,t,o,c,d){const m=o.slice(c[0],c[1]+1);let g=1/0;for(let b=t[0];b<=t[1];++b)if((g=Math.min(g,$i(s[b],m,d)))===0)return 0;return g}function $d(s,t,o,c,d){const m=Math.min(d.pointToSegmentDistance(s,o,c),d.pointToSegmentDistance(t,o,c)),g=Math.min(d.pointToSegmentDistance(o,s,t),d.pointToSegmentDistance(c,s,t));return Math.min(m,g)}function Gp(s,t,o,c,d){if(!uu(t,s.length)||!uu(c,o.length))return NaN;let m=1/0;for(let g=t[0];g<t[1];++g)for(let b=c[0];b<c[1];++b){if(ca(s[g],s[g+1],o[b],o[b+1]))return 0;m=Math.min(m,$d(s[g],s[g+1],o[b],o[b+1],d))}return m}function Bh(s,t,o,c,d){if(!uu(t,s.length)||!uu(c,o.length))return NaN;let m=1/0;for(let g=t[0];g<=t[1];++g)for(let b=c[0];b<=c[1];++b)if((m=Math.min(m,d.distance(s[g],o[b])))===0)return m;return m}function w_(s,t,o){if(Na(s,t,!0))return 0;let c=1/0;for(const d of t){const m=d.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(d[0]!==d[m-1]&&(c=Math.min(c,o.pointToSegmentDistance(s,d[m-1],d[0])))===0||(c=Math.min(c,$i(s,d,o)))===0)return c}return c}function ov(s,t,o,c){if(!uu(t,s.length))return NaN;for(let m=t[0];m<=t[1];++m)if(Na(s[m],o,!0))return 0;let d=1/0;for(let m=t[0];m<t[1];++m)for(const g of o)for(let b=0,P=g.length,I=P-1;b<P;I=b++){if(ca(s[m],s[m+1],g[I],g[b]))return 0;d=Math.min(d,$d(s[m],s[m+1],g[I],g[b],c))}return d}function S_(s,t){for(const o of s)for(let c=0;c<=o.length-1;++c)if(Na(o[c],t,!0))return!0;return!1}function T_(s,t,o,c=1/0){const d=xn(s),m=xn(t);if(c!==1/0&&Vd(d,m,o)>=c)return c;if(hc(d,m)){if(S_(s,t))return 0}else if(S_(t,s))return 0;let g=c;for(const b of s)for(let P=0,I=b.length,O=I-1;P<I;O=P++)for(const L of t)for(let k=0,$=L.length,W=$-1;k<$;W=k++){if(ca(b[O],b[P],L[W],L[k]))return 0;g=Math.min(g,$d(b[O],b[P],L[W],L[k],o))}return g}function Wd(s,t,o,c,d,m,g){if(m===null||g===null)return;const b=Vd(fc(c,m),fc(d,g),o);b<t&&s.push({dist:b,range1:m,range2:g})}function Hp(s,t,o,c,d=1/0){let m=Math.min(c.distance(s[0],o[0][0]),d);if(m===0)return m;const g=new Uf([{dist:0,range1:[0,s.length-1],range2:[0,0]}],Wp),b=t?ud:Bl,P=xn(o);for(;g.length;){const I=g.pop();if(I.dist>=m)continue;const O=I.range1;if($f(O)<=b){if(!uu(O,s.length))return NaN;if(t){const L=ov(s,O,o,c);if((m=Math.min(m,L))===0)return m}else for(let L=O[0];L<=O[1];++L){const k=w_(s[L],o,c);if((m=Math.min(m,k))===0)return m}}else{const L=dd(O,t);if(L[0]!==null){const k=Vd(fc(s,L[0]),P,c);k<m&&g.push({dist:k,range1:L[0],range2:[0,0]})}if(L[1]!==null){const k=Vd(fc(s,L[1]),P,c);k<m&&g.push({dist:k,range1:L[1],range2:[0,0]})}}}return m}function Yp(s,t,o,c,d,m=1/0){let g=Math.min(m,d.distance(s[0],o[0]));if(g===0)return g;const b=new Uf([{dist:0,range1:[0,s.length-1],range2:[0,o.length-1]}],Wp),P=t?ud:Bl,I=c?ud:Bl;for(;b.length;){const O=b.pop();if(O.dist>=g)continue;const L=O.range1,k=O.range2;if($f(L)<=P&&$f(k)<=I){if(!uu(L,s.length)||!uu(k,o.length))return NaN;if(t&&c?g=Math.min(g,Gp(s,L,o,k,d)):t||c?t&&!c?g=Math.min(g,qp(o,k,s,L,d)):!t&&c&&(g=Math.min(g,qp(s,L,o,k,d))):g=Math.min(g,Bh(s,L,o,k,d)),g===0)return g}else{const $=dd(L,t),W=dd(k,c);Wd(b,g,d,s,o,$[0],W[0]),Wd(b,g,d,s,o,$[0],W[1]),Wd(b,g,d,s,o,$[1],W[0]),Wd(b,g,d,s,o,$[1],W[1])}}return g}function qf(s,t,o,c,d=1/0){let m=d;const g=fc(s,[0,s.length-1]);for(const b of o)if(!(m!==1/0&&Vd(g,fc(b,[0,b.length-1]),c)>=m)&&(m=Math.min(m,Yp(s,t,b,!0,c,m)),m===0))return m;return m}function jh(s,t,o,c,d=1/0){let m=d;const g=fc(s,[0,s.length-1]);for(const b of o){if(m!==1/0&&Vd(g,xn(b),c)>=m)continue;const P=Hp(s,t,b,c,m);if(isNaN(P))return P;if((m=Math.min(m,P))===0)return m}return m}function Gf(s){return s==="Point"||s==="MultiPoint"||s==="LineString"||s==="MultiLineString"||s==="Polygon"||s==="MultiPolygon"}class qd{constructor(t,o){this.type=br,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(lc(t[1])){const c=t[1];if(c.type==="FeatureCollection"){for(let d=0;d<c.features.length;++d)if(Gf(c.features[d].geometry.type))return new qd(c,c.features[d].geometry)}else if(c.type==="Feature"){if(Gf(c.geometry.type))return new qd(c,c.geometry)}else if(Gf(c.type))return new qd(c,c)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const o=t.geometry(),c=t.canonicalID();if(o!=null&&c!=null){if(t.geometryType()==="Point")return(function(d,m,g){const b=[];for(const I of d)for(const O of I)b.push(Ud(O,m));const P=new Fu(b[0][1],"meters");return g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString"?Yp(b,!1,g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",P):g.type==="MultiLineString"?qf(b,!1,g.coordinates,P):g.type==="Polygon"||g.type==="MultiPolygon"?jh(b,!1,g.type==="Polygon"?[g.coordinates]:g.coordinates,P):null})(o,c,this.geometries);if(t.geometryType()==="LineString")return(function(d,m,g){const b=[];for(const I of d){const O=[];for(const L of I)O.push(Ud(L,m));b.push(O)}const P=new Fu(b[0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return qf(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",b,P);if(g.type==="MultiLineString"){let I=1/0;for(let O=0;O<g.coordinates.length;O++){const L=qf(g.coordinates[O],!0,b,P,I);if(isNaN(L))return L;if((I=Math.min(I,L))===0)return I}return I}if(g.type==="Polygon"||g.type==="MultiPolygon"){let I=1/0;for(let O=0;O<b.length;O++){const L=jh(b[O],!0,g.type==="Polygon"?[g.coordinates]:g.coordinates,P,I);if(isNaN(L))return L;if((I=Math.min(I,L))===0)return I}return I}return null})(o,c,this.geometries);if(t.geometryType()==="Polygon")return(function(d,m,g){const b=[];for(const I of(function(O,L){const k=O.length;if(k<=1)return[O];const $=[];let W,Q;for(let te=0;te<k;te++){const ne=Oh(O[te]);ne!==0&&(O[te].area=Math.abs(ne),Q===void 0&&(Q=ne<0),Q===ne<0?(W&&$.push(W),W=[O[te]]):W.push(O[te]))}return W&&$.push(W),$})(d)){const O=[];for(let L=0;L<I.length;++L)O.push(Wf(I[L],m));b.push(O)}const P=new Fu(b[0][0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return jh(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",b,P);if(g.type==="MultiLineString"){let I=1/0;for(let O=0;O<g.coordinates.length;O++){const L=jh(g.coordinates[O],!0,b,P,I);if(isNaN(L))return L;if((I=Math.min(I,L))===0)return I}return I}return g.type==="Polygon"||g.type==="MultiPolygon"?(function(I,O,L){let k=1/0;for(const $ of I)for(const W of O){const Q=T_($,W,L,k);if(isNaN(Q))return Q;if((k=Math.min(k,Q))===0)return k}return k})(g.type==="Polygon"?[g.coordinates]:g.coordinates,b,P):null})(o,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Gd(s){if(s instanceof gs&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof ad||s instanceof qd)return!1;if(s instanceof zc)return s.featureConstant;let t=!0;return s.eachChild((o=>{t&&!Gd(o)&&(t=!1)})),t}function Hf(s){if(s instanceof gs&&s.name==="feature-state")return!1;let t=!0;return s.eachChild((o=>{t&&!Hf(o)&&(t=!1)})),t}function Nh(s,t){if(s instanceof gs&&t.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild((c=>{o&&!Nh(c,t)&&(o=!1)})),o}function Zp(s,t,o){return[s,t,o].filter(Boolean).join("")}function du(s,t){switch(s){case"string":return fl(t);case"number":return+t;case"boolean":return!!t;case"color":return zn.parse(t);case"formatted":return No.fromString(fl(t));case"resolvedImage":return Gs.build(fl(t))}return t}function ng(s,t,o,c){return c!==void 0&&(s=c*Math.round(s/c)),t!==void 0&&s<t&&(s=t),o!==void 0&&s>o&&(s=o),s}class zc{constructor(t,o,c,d=!1){this.type=t,this.key=o,this.scope=c,this.featureConstant=d}static parse(t,o){let c=o.expectedType;if(c==null&&(c=Fn),t.length<2||t.length>3)return o.error("Invalid number of arguments for 'config' expression.");const d=o.parse(t[1],1);if(!(d instanceof pl))return o.error("Key name of 'config' expression must be a string literal.");let m,g=!0;const b=fl(d.value);if(t.length>=3){const P=o.parse(t[2],2);if(!(P instanceof pl))return o.error("Scope of 'config' expression must be a string literal.");m=fl(P.value)}if(o.options){const P=Zp(b,m,o._scope),I=o.options.get(P);I&&(g=Gd(I.value||I.default))}return new zc(c,b,m,g)}evaluate(t){const o=Zp(this.key,this.scope,t.scope),c=t.getConfig(o);if(!c)return null;const{type:d,value:m,values:g,minValue:b,maxValue:P,stepValue:I}=c,O=c.default.evaluate(t);let L=O;if(m){const k=t.scope;t.scope=(k||"").split("").slice(1).join(""),L=m.evaluate(t),t.scope=k}return d&&(L=du(d,L)),L===void 0||b===void 0&&P===void 0&&I===void 0||(typeof L=="number"?L=ng(L,b,P,I):Array.isArray(L)&&(L=L.map((k=>typeof k=="number"?ng(k,b,P,I):k)))),m!==void 0&&L!==void 0&&g&&!g.includes(L)&&(L=O,d&&(L=du(d,L))),(d&&d!==this.type||L!==void 0&&!nd(fo(L),this.type))&&(L=du(this.type.kind,L)),L}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.scope),t}}class jl{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=t[1];return o.scope.has(c)?new jl(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class hd{constructor(t,o=[],c,d=new ja,m=[],g,b,P){this.registry=t,this.path=o,this.key=o.map((I=>typeof I=="string"?`['${I}']`:`[${I}]`)).join(""),this.scope=d,this.errors=m,this.expectedType=c,this._scope=g,this.options=b,this.iconImageUseTheme=P}parse(t,o,c,d,m={}){return o||c?this.concat(o,null,c,d)._parse(t,m):this._parse(t,m)}parseObjectValue(t,o,c,d,m,g={}){return this.concat(o,c,d,m)._parse(t,g)}_parse(t,o){function c(d,m,g){return g==="assert"?new pr(m,[d]):g==="coerce"?new la(m,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(d){let m=d.parse(t,this);if(!m)return null;if(this.expectedType){const g=this.expectedType,b=m.type;if(g.kind!=="string"&&g.kind!=="number"&&g.kind!=="boolean"&&g.kind!=="object"&&g.kind!=="array"||b.kind!=="value")if(g.kind!=="color"&&g.kind!=="formatted"&&g.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(g,b))return null}else m=c(m,g,o.typeAnnotation||"coerce");else m=c(m,g,o.typeAnnotation||"assert")}if(!(m instanceof pl)&&m.type.kind!=="resolvedImage"&&Fc(m)){const g=new Eo(this._scope,this.options,this.iconImageUseTheme);try{m=new pl(m.type,m.evaluate(g))}catch(b){return this.error(b.message),null}}return m}return la.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,c,d){let m=typeof t=="number"?this.path.concat(t):this.path;m=typeof o=="string"?m.concat(o):m;const g=d?this.scope.concat(d):this.scope;return new hd(this.registry,m,c||null,g,this.errors,this._scope,this.options,this.iconImageUseTheme)}error(t,...o){const c=`${this.key}${o.map((d=>`[${d}]`)).join("")}`;this.errors.push(new Ba(c,t))}checkSubtype(t,o){const c=Du(t,o);return c&&this.error(c),c}}function Fc(s){if(s instanceof jl)return Fc(s.boundExpression);if(s instanceof gs&&s.name==="error"||s instanceof dc||s instanceof ad||s instanceof qd||s instanceof zc)return!1;const t=s instanceof la||s instanceof pr;let o=!0;return s.eachChild((c=>{o=t?o&&Fc(c):o&&c instanceof pl})),!!o&&Gd(s)&&Nh(s,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Vh(s,t){const o=s.length-1;let c,d,m=0,g=o,b=0;for(;m<=g;)if(b=Math.floor((m+g)/2),c=s[b],d=s[b+1],c<=t){if(b===o||t<d)return b;m=b+1}else{if(!(c>t))throw new Xi("Input is not a number.");g=b-1}return 0}class Yf{constructor(t,o,c){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[d,m]of c)this.labels.push(d),this.outputs.push(m)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(t[1],1,br);if(!c)return null;const d=[];let m=null;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);for(let g=1;g<t.length;g+=2){const b=g===1?-1/0:t[g],P=t[g+1],I=g,O=g+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(d.length&&d[d.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const L=o.parse(P,O,m);if(!L)return null;m=m||L.type,d.push([b,L])}return new Yf(m,c,d)}evaluate(t){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(t);const d=this.input.evaluate(t);if(d<=o[0])return c[0].evaluate(t);const m=o.length;return d>=o[m-1]?c[m-1].evaluate(t):c[Vh(o,d)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t}}const E_=.95047,fd=1.08883,Uh=4/29,kc=6/29,Hd=3*kc*kc,ig=kc*kc*kc,Yd=Math.PI/180,pd=180/Math.PI;function Po(s){return s>ig?Math.pow(s,1/3):s/Hd+Uh}function vo(s){return s>kc?s*s*s:Hd*(s-Uh)}function Bc(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Hs(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Ls(s){const t=Hs(s.r),o=Hs(s.g),c=Hs(s.b),d=Po((.4124564*t+.3575761*o+.1804375*c)/E_),m=Po((.2126729*t+.7151522*o+.072175*c)/1);return{l:116*m-16,a:500*(d-m),b:200*(m-Po((.0193339*t+.119192*o+.9503041*c)/fd)),alpha:s.a}}function ku(s){let t=(s.l+16)/116,o=isNaN(s.a)?t:t+s.a/500,c=isNaN(s.b)?t:t-s.b/200;return t=1*vo(t),o=E_*vo(o),c=fd*vo(c),new zn(Bc(3.2404542*o-1.5371385*t-.4985314*c),Bc(-.969266*o+1.8760108*t+.041556*c),Bc(.0556434*o-.2040259*t+1.0572252*c),s.alpha)}function Zd(s,t,o){const c=t-s;return s+o*(c>180||c<-180?c-360*Math.round(c/360):c)}const ua={forward:Ls,reverse:ku,interpolate:function(s,t,o){return{l:Lr(s.l,t.l,o),a:Lr(s.a,t.a,o),b:Lr(s.b,t.b,o),alpha:Lr(s.alpha,t.alpha,o)}}},hu={forward:function(s){const{l:t,a:o,b:c}=Ls(s),d=Math.atan2(c,o)*pd;return{h:d<0?d+360:d,c:Math.sqrt(o*o+c*c),l:t,alpha:s.a}},reverse:function(s){const t=s.h*Yd,o=s.c;return ku({l:s.l,a:Math.cos(t)*o,b:Math.sin(t)*o,alpha:s.alpha})},interpolate:function(s,t,o){return{h:Zd(s.h,t.h,o),c:Lr(s.c,t.c,o),l:Lr(s.l,t.l,o),alpha:Lr(s.alpha,t.alpha,o)}}};var Zf=Object.freeze({__proto__:null,hcl:hu,lab:ua});class yl{constructor(t,o,c,d,m){this.type=t,this.operator=o,this.interpolation=c,this.input=d,this.labels=[],this.outputs=[];for(const[g,b]of m)this.labels.push(g),this.outputs.push(b)}static interpolationFactor(t,o,c,d){let m=0;if(t.name==="exponential")m=$h(o,t.base,c,d);else if(t.name==="linear")m=$h(o,1,c,d);else if(t.name==="cubic-bezier"){const g=t.controlPoints;m=new ll(g[0],g[1],g[2],g[3]).solve($h(o,1,c,d))}return m}static parse(t,o){let[c,d,m,...g]=t;if(!Array.isArray(d)||d.length===0)return o.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const I=d[1];if(typeof I!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:I}}else{if(d[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const I=d.slice(1);if(I.length!==4||I.some((O=>typeof O!="number"||O<0||O>1)))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:I}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length-1>3&&(t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(m=o.parse(m,2,br),!m)return null;const b=[];let P=null;c==="interpolate-hcl"||c==="interpolate-lab"?P=aa:o.expectedType&&o.expectedType.kind!=="value"&&(P=o.expectedType);for(let I=0;I<g.length;I+=2){const O=g[I],L=g[I+1],k=I+3,$=I+4;if(typeof O!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(b.length&&b[b.length-1][0]>=O)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',k);const W=o.parse(L,$,P);if(!W)return null;P=P||W.type,b.push([O,W])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new yl(P,c,d,m,b):o.error(`Type ${ho(P)} is not interpolatable.`)}evaluate(t){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(t);const d=this.input.evaluate(t);if(d<=o[0])return c[0].evaluate(t);const m=o.length;if(d>=o[m-1])return c[m-1].evaluate(t);const g=Vh(o,d),b=yl.interpolationFactor(this.interpolation,d,o[g],o[g+1]),P=c[g].evaluate(t),I=c[g+1].evaluate(t);return this.operator==="interpolate"?Ll[this.type.kind.toLowerCase()](P,I,b):this.operator==="interpolate-hcl"?hu.reverse(hu.interpolate(hu.forward(P),hu.forward(I),b)):ua.reverse(ua.interpolate(ua.forward(P),ua.forward(I),b))}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const o=[this.operator,t,this.input.serialize()];for(let c=0;c<this.labels.length;c++)o.push(this.labels[c],this.outputs[c].serialize());return o}}function $h(s,t,o,c){const d=c-o,m=s-o;return d===0?0:t===1?m/d:(Math.pow(t,m)-1)/(Math.pow(t,d)-1)}class Wh{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let c=null;const d=o.expectedType;d&&d.kind!=="value"&&(c=d);const m=[];for(const b of t.slice(1)){const P=o.parse(b,1+m.length,c,void 0,{typeAnnotation:"omit"});if(!P)return null;c=c||P.type,m.push(P)}const g=d&&m.some((b=>Du(d,b.type)));return new Wh(g?Fn:c,m)}evaluate(t){let o,c=null,d=0;for(const m of this.args){if(d++,c=m.evaluate(t),c&&c instanceof Gs&&!c.available&&(o||(o=c),c=null,d===this.args.length))return o;if(c!==null)break}return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((o=>{t.push(o.serialize())})),t}}class Nl{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let m=1;m<t.length-1;m+=2){const g=t[m];if(typeof g!="string")return o.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return o.error("Variable names must contain only alphanumeric characters or '_'.",m);const b=o.parse(t[m+1],m+1);if(!b)return null;c.push([g,b])}const d=o.parse(t[t.length-1],t.length-1,o.expectedType,c);return d?new Nl(c,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[o,c]of this.bindings)t.push(o,c.serialize());return t.push(this.result.serialize()),t}}class qh{constructor(t,o,c){this.type=t,this.index=o,this.input=c}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,br),d=o.parse(t[2],2,Zo(o.expectedType||Fn));return c&&d?new qh(d.type.itemType,c,d):null}evaluate(t){const o=this.index.evaluate(t),c=this.input.evaluate(t);if(o<0)throw new Xi("Array index out of bounds: negative index");if(o>=c.length)throw new Xi("Array index out of bounds: index exceeds array size");if(o!==Math.floor(o))throw new Xi("Array index must be an integer. Use at-interpolated for fractional indices");return c[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Xf{constructor(t,o,c){this.type=t,this.index=o,this.input=c}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,br),d=o.parse(t[2],2,Zo(o.expectedType||Fn));return c&&d?new Xf(d.type.itemType,c,d):null}evaluate(t){const o=this.index.evaluate(t),c=this.input.evaluate(t);if(o<0)throw new Xi(`Array index out of bounds: ${o} < 0.`);if(o>c.length-1)throw new Xi(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o===Math.floor(o))return c[o];const d=Math.floor(o),m=Math.ceil(o),g=c[d],b=c[m];if(typeof g!="number"||typeof b!="number")throw new Xi(`Cannot interpolate between non-number values at index ${o}.`);const P=o-d;return g*(1-P)+b*P}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class Xp{constructor(t,o){this.type=Dn,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,Fn),d=o.parse(t[2],2,Fn);return c&&d?zd(c.type,[Dn,wn,br,ac,Fn])?new Xp(c,d):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ho(c.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(c==null)return!1;if(!su(o,["boolean","string","number","null"]))throw new Xi(`Expected first argument to be of type boolean, string, number or null, but found ${ho(fo(o))} instead.`);if(!su(c,["string","array"]))throw new Xi(`Expected second argument to be of type array or string, but found ${ho(fo(c))} instead.`);return c.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Kf{constructor(t,o,c){this.type=br,this.needle=t,this.haystack=o,this.fromIndex=c}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,Fn),d=o.parse(t[2],2,Fn);if(!c||!d)return null;if(!zd(c.type,[Dn,wn,br,ac,Fn]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ho(c.type)} instead`);if(t.length===4){const m=o.parse(t[3],3,br);return m?new Kf(c,d,m):null}return new Kf(c,d)}evaluate(t){const o=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!su(o,["boolean","string","number","null"]))throw new Xi(`Expected first argument to be of type boolean, string, number or null, but found ${ho(fo(o))} instead.`);if(!su(c,["string","array"]))throw new Xi(`Expected second argument to be of type array or string, but found ${ho(fo(c))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(t);return c.indexOf(o,d)}return c.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class jc{constructor(t,o,c,d,m,g){this.inputType=t,this.type=o,this.input=c,this.cases=d,this.outputs=m,this.otherwise=g}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let c,d;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);const m={},g=[];for(let I=2;I<t.length-1;I+=2){let O=t[I];const L=t[I+1];Array.isArray(O)||(O=[O]);const k=o.concat(I);if(O.length===0)return k.error("Expected at least one branch label.");for(const W of O){if(typeof W!="number"&&typeof W!="string")return k.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return k.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return k.error("Numeric branch labels must be integer values.");if(c){if(k.checkSubtype(c,fo(W)))return null}else c=fo(W);if(m[String(W)]!==void 0)return k.error("Branch labels must be unique.");m[String(W)]=g.length}const $=o.parse(L,I,d);if(!$)return null;d=d||$.type,g.push($)}const b=o.parse(t[1],1,Fn);if(!b)return null;const P=o.parse(t[t.length-1],t.length-1,d);return P?b.type.kind!=="value"&&o.concat(1).checkSubtype(c,b.type)?null:new jc(c,d,b,m,g,P):null}evaluate(t){const o=this.input.evaluate(t);return(nd(fo(o),this.inputType)&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),c=[],d={};for(const g of o){const b=d[this.cases[g]];b===void 0?(d[this.cases[g]]=c.length,c.push([this.cases[g],[g]])):c[b][1].push(g)}const m=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,b]of c)t.push(b.length===1?m(b[0]):b.map(m)),t.push(this.outputs[g].serialize());return t.push(this.otherwise.serialize()),t}}class Nc{constructor(t,o,c){this.type=t,this.branches=o,this.otherwise=c}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const d=[];for(let g=1;g<t.length-1;g+=2){const b=o.parse(t[g],g,Dn);if(!b)return null;const P=o.parse(t[g+1],g+1,c);if(!P)return null;d.push([b,P]),c=c||P.type}const m=o.parse(t[t.length-1],t.length-1,c);return m?new Nc(c,d,m):null}evaluate(t){for(const[o,c]of this.branches)if(o.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,c]of this.branches)t(o),t(c);t(this.otherwise)}outputDefined(){return this.branches.every((([t,o])=>o.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((o=>{t.push(o.serialize())})),t}}class Bu{constructor(t,o,c,d){this.type=t,this.input=o,this.beginIndex=c,this.endIndex=d}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,Fn),d=o.parse(t[2],2,br);if(!c||!d)return null;if(!zd(c.type,[Zo(Fn),wn,Fn]))return o.error(`Expected first argument to be of type array or string, but found ${ho(c.type)} instead`);if(t.length===4){const m=o.parse(t[3],3,br);return m?new Bu(c.type,c,d,m):null}return new Bu(c.type,c,d)}evaluate(t){const o=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!su(o,["string","array"]))throw new Xi(`Expected first argument to be of type array or string, but found ${ho(fo(o))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(t);return o.slice(c,d)}return o.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class Xd{constructor(t,o){this.type=Zo(wn),this.str=t,this.delimiter=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,wn),d=o.parse(t[2],2,wn);return c&&d?new Xd(c,d):void 0}evaluate(t){const o=this.str.evaluate(t),c=this.delimiter.evaluate(t);return o.split(c)}eachChild(t){t(this.str),t(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function Qf(s,t){return s==="=="||s==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Vl(s,t,o,c){return c.compare(t,o)===0}function Pa(s,t,o){const c=s!=="=="&&s!=="!=";return class SY{constructor(m,g,b){this.type=Dn,this.lhs=m,this.rhs=g,this.collator=b,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const b=m[0];let P=g.parse(m[1],1,Fn);if(!P)return null;if(!Qf(b,P.type))return g.concat(1).error(`"${b}" comparisons are not supported for type '${ho(P.type)}'.`);let I=g.parse(m[2],2,Fn);if(!I)return null;if(!Qf(b,I.type))return g.concat(2).error(`"${b}" comparisons are not supported for type '${ho(I.type)}'.`);if(P.type.kind!==I.type.kind&&P.type.kind!=="value"&&I.type.kind!=="value")return g.error(`Cannot compare types '${ho(P.type)}' and '${ho(I.type)}'.`);c&&(P.type.kind==="value"&&I.type.kind!=="value"?P=new pr(I.type,[P]):P.type.kind!=="value"&&I.type.kind==="value"&&(I=new pr(P.type,[I])));let O=null;if(m.length===4){if(P.type.kind!=="string"&&I.type.kind!=="string"&&P.type.kind!=="value"&&I.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(O=g.parse(m[3],3,Cu),!O)return null}return new SY(P,I,O)}evaluate(m){const g=this.lhs.evaluate(m),b=this.rhs.evaluate(m);if(c&&this.hasUntypedArgument){const P=fo(g),I=fo(b);if(P.kind!==I.kind||P.kind!=="string"&&P.kind!=="number")throw new Xi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${P.kind}, ${I.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const P=fo(g),I=fo(b);if(P.kind!=="string"||I.kind!=="string")return t(m,g,b)}return this.collator?o(m,g,b,this.collator.evaluate(m)):t(m,g,b)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[s];return this.eachChild((g=>{m.push(g.serialize())})),m}}}const md=Pa("==",(function(s,t,o){return t===o}),Vl),fu=Pa("!=",(function(s,t,o){return t!==o}),(function(s,t,o,c){return!Vl(0,t,o,c)})),ju=Pa("<",(function(s,t,o){return t<o}),(function(s,t,o,c){return c.compare(t,o)<0})),Kd=Pa(">",(function(s,t,o){return t>o}),(function(s,t,o,c){return c.compare(t,o)>0})),P_=Pa("<=",(function(s,t,o){return t<=o}),(function(s,t,o,c){return c.compare(t,o)<=0})),Gh=Pa(">=",(function(s,t,o){return t>=o}),(function(s,t,o,c){return c.compare(t,o)>=0}));class Jf{constructor(t,o,c,d,m,g){this.type=wn,this.number=t,this.locale=o,this.currency=c,this.unit=d,this.minFractionDigits=m,this.maxFractionDigits=g}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const c=o.parse(t[1],1,br);if(!c)return null;const d=t[2];if(typeof d!="object"||Array.isArray(d))return o.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=o.parseObjectValue(d.locale,2,"locale",wn),!m))return null;let g=null;if(d.currency&&(g=o.parseObjectValue(d.currency,2,"currency",wn),!g))return null;let b=null;if(d.unit&&(b=o.parseObjectValue(d.unit,2,"unit",wn),!b))return null;let P=null;if(d["min-fraction-digits"]&&(P=o.parseObjectValue(d["min-fraction-digits"],2,"min-fraction-digits",br),!P))return null;let I=null;return d["max-fraction-digits"]&&(I=o.parseObjectValue(d["max-fraction-digits"],2,"max-fraction-digits",br),!I)?null:new Jf(c,m,g,b,P,I)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Ja{constructor(t){this.type=br,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=o.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ho(c.type)} instead.`):new Ja(c):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Xi(`Expected value to be of type string or array, but found ${ho(fo(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild((o=>{t.push(o.serialize())})),t}}function vl(s){return function(){s=1831565813+(s|=0)|0;let t=Math.imul(s^s>>>15,1|s);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const go={"==":md,"!=":fu,">":Kd,"<":ju,">=":Gh,"<=":P_,array:pr,at:qh,"at-interpolated":Xf,boolean:pr,case:Nc,coalesce:Wh,collator:dc,format:cc,image:Nr,in:Xp,"index-of":Kf,interpolate:yl,"interpolate-hcl":yl,"interpolate-lab":yl,length:Ja,let:Nl,literal:pl,match:jc,number:pr,"number-format":Jf,object:pr,slice:Bu,step:Yf,string:pr,"to-boolean":la,"to-color":la,"to-number":la,"to-string":la,var:jl,within:ad,distance:qd,config:zc,split:Xd};function Ul(s,[t,o,c,d]){t=t.evaluate(s),o=o.evaluate(s),c=c.evaluate(s);const m=d?d.evaluate(s):1,g=id(t,o,c,m);if(g)throw new Xi(g);return new zn(t/255,o/255,c/255,m)}function og(s,[t,o,c,d]){t=t.evaluate(s),o=o.evaluate(s),c=c.evaluate(s);const m=d?d.evaluate(s):1,g=(function(I,O,L,k){return typeof I=="number"&&I>=0&&I<=360?typeof O=="number"&&O>=0&&O<=100&&typeof L=="number"&&L>=0&&L<=100?k===void 0||typeof k=="number"&&k>=0&&k<=1?null:`Invalid hsla value [${[I,O,L,k].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof k=="number"?[I,O,L,k]:[I,O,L]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof k=="number"?[I,O,L,k]:[I,O,L]).join(", ")}]: 'h' must be between 0 and 360.`})(t,o,c,m);if(g)throw new Xi(g);const b=`hsla(${t}, ${o}%, ${c}%, ${m})`,P=zn.parse(b);if(!P)throw new Xi(`Failed to parse HSLA color: ${b}`);return P}function sg(s,t){return s in t}function Hh(s,t){const o=t[s];return o===void 0?null:o}function Vc(s){return{type:s}}function Yh(s){if(s instanceof zc)return new Set([s.key]);let t=new Set;return s.eachChild((o=>{t=new Set([...t,...Yh(o)])})),t}function Qd(s){if(s instanceof gs&&s.name==="is-active-floor")return!0;let t=!1;return s.eachChild((o=>{!t&&Qd(o)&&(t=!0)})),t}function gd(s){return{result:"success",value:s}}function $l(s){return{result:"error",value:s}}function ep(s,t){return!!s&&!!s.parameters&&s.parameters.indexOf(t)>-1}function Kp(s){return s["property-type"]==="data-driven"}function Jd(s){return ep(s.expression,"measure-light")}function Zh(s){return ep(s.expression,"zoom")}function tp(s){return!!s.expression&&s.expression.interpolated}function rp(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function _d(s){return s}function np(s,t){const o=t.type==="color",c=s.stops&&typeof s.stops[0][0]=="object",d=c||!(c||s.property!==void 0),m=s.type||(tp(t)?"exponential":"interval");if(o&&((s=Object.assign({},s)).stops&&(s.stops=s.stops.map((I=>[I[0],zn.parse(I[1])]))),s.default=zn.parse(s.default?s.default:t.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!Zf[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let g,b,P;if(m==="exponential")g=Jp;else if(m==="interval")g=Wl;else if(m==="categorical"){g=Qp,b=Object.create(null);for(const I of s.stops)b[I[0]]=I[1];P=typeof s.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);g=ag}if(c){const I={},O=[];for(let $=0;$<s.stops.length;$++){const W=s.stops[$],Q=W[0].zoom;I[Q]===void 0&&(I[Q]={zoom:Q,type:s.type,property:s.property,default:s.default,stops:[]},O.push(Q)),I[Q].stops.push([W[0].value,W[1]])}const L=[];for(const $ of O)L.push([I[$].zoom,np(I[$],t)]);const k={name:"linear"};return{kind:"composite",interpolationType:k,interpolationFactor:yl.interpolationFactor.bind(void 0,k),zoomStops:L.map(($=>$[0])),evaluate:({zoom:$},W)=>Jp({stops:L,base:s.base},t,$).evaluate($,W)}}if(d){const I=m==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:yl.interpolationFactor.bind(void 0,I),zoomStops:s.stops.map((O=>O[0])),evaluate:({zoom:O})=>g(s,t,O,b,P)}}return{kind:"source",evaluate(I,O){const L=O&&O.properties?O.properties[s.property]:void 0;return L===void 0?Nu(s.default,t.default):g(s,t,L,b,P)}}}function Nu(s,t,o){return s!==void 0?s:t!==void 0?t:o!==void 0?o:void 0}function Qp(s,t,o,c,d){return Nu(typeof o===d?c[o]:void 0,s.default,t.default)}function Wl(s,t,o){if(!lu(o))return Nu(s.default,t.default);const c=s.stops.length;if(c===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[c-1][0])return s.stops[c-1][1];const d=Vh(s.stops.map((m=>m[0])),o);return s.stops[d][1]}function Jp(s,t,o){const c=s.base!==void 0?s.base:1;if(!lu(o))return Nu(s.default,t.default);const d=s.stops.length;if(d===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[d-1][0])return s.stops[d-1][1];const m=Vh(s.stops.map((O=>O[0])),o),g=(function(O,L,k,$){const W=$-k,Q=O-k;return W===0?0:L===1?Q/W:(Math.pow(L,Q)-1)/(Math.pow(L,W)-1)})(o,c,s.stops[m][0],s.stops[m+1][0]),b=s.stops[m][1],P=s.stops[m+1][1];let I=Ll[t.type]||_d;if(s.colorSpace&&s.colorSpace!=="rgb"){const O=Zf[s.colorSpace];I=(L,k)=>O.reverse(O.interpolate(O.forward(L),O.forward(k),g))}return typeof b.evaluate=="function"?{evaluate(...O){const L=b.evaluate.apply(void 0,O),k=P.evaluate.apply(void 0,O);if(L!==void 0&&k!==void 0)return I(L,k,g)}}:I(b,P,g)}function ag(s,t,o){return t.type==="color"?o=zn.parse(o):t.type==="formatted"?o=No.fromString(o.toString()):t.type==="resolvedImage"?o=Gs.build(o.toString()):au(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0),Nu(o,s.default,t.default)}gs.register(go,{error:[{kind:"error"},[wn],(s,[t])=>{throw new Xi(t.evaluate(s))}],typeof:[wn,[Fn],(s,[t])=>ho(fo(t.evaluate(s)))],"to-rgba":[Zo(br,4),[aa],(s,[t])=>t.evaluate(s).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[Zo(br,4),[aa],(s,[t])=>t.evaluate(s).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[aa,[br,br,br],Ul],rgba:[aa,[br,br,br,br],Ul],hsl:[aa,[br,br,br],og],hsla:[aa,[br,br,br,br],og],has:{type:Dn,overloads:[[[wn],(s,[t])=>sg(t.evaluate(s),s.properties())],[[wn,ou],(s,[t,o])=>sg(t.evaluate(s),o.evaluate(s))]]},get:{type:Fn,overloads:[[[wn],(s,[t])=>Hh(t.evaluate(s),s.properties())],[[wn,ou],(s,[t,o])=>Hh(t.evaluate(s),o.evaluate(s))]]},"feature-state":[Fn,[wn],(s,[t])=>Hh(t.evaluate(s),s.featureState||{})],properties:[ou,[],s=>s.properties()],"geometry-type":[wn,[],s=>s.geometryType()],worldview:[wn,[],s=>s.globals.worldview||""],"is-active-floor":[Dn,Vc(wn),(s,t)=>{if(!(s.globals.activeFloors&&s.globals.activeFloors.size>0))return!1;const o=s.globals.activeFloors;return t.some((c=>{const d=c.evaluate(s);return o.has(d)}))}],id:[Fn,[],s=>s.id()],zoom:[br,[],s=>s.globals.zoom],pitch:[br,[],s=>s.globals.pitch||0],"distance-from-center":[br,[],s=>s.distanceFromCenter()],"measure-light":[br,[wn],(s,[t])=>s.measureLight(t.evaluate(s))],"heatmap-density":[br,[],s=>s.globals.heatmapDensity||0],"line-progress":[br,[],s=>s.globals.lineProgress||0],"raster-value":[br,[],s=>s.globals.rasterValue||0],"raster-particle-speed":[br,[],s=>s.globals.rasterParticleSpeed||0],"sky-radial-progress":[br,[],s=>s.globals.skyRadialProgress||0],accumulated:[Fn,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[br,Vc(br),(s,t)=>{let o=0;for(const c of t)o+=c.evaluate(s);return o}],"*":[br,Vc(br),(s,t)=>{let o=1;for(const c of t)o*=c.evaluate(s);return o}],"-":{type:br,overloads:[[[br,br],(s,[t,o])=>t.evaluate(s)-o.evaluate(s)],[[br],(s,[t])=>-t.evaluate(s)]]},"/":[br,[br,br],(s,[t,o])=>t.evaluate(s)/o.evaluate(s)],"%":[br,[br,br],(s,[t,o])=>t.evaluate(s)%o.evaluate(s)],ln2:[br,[],()=>Math.LN2],pi:[br,[],()=>Math.PI],e:[br,[],()=>Math.E],"^":[br,[br,br],(s,[t,o])=>Math.pow(t.evaluate(s),o.evaluate(s))],sqrt:[br,[br],(s,[t])=>Math.sqrt(t.evaluate(s))],log10:[br,[br],(s,[t])=>Math.log(t.evaluate(s))/Math.LN10],ln:[br,[br],(s,[t])=>Math.log(t.evaluate(s))],log2:[br,[br],(s,[t])=>Math.log2(t.evaluate(s))],sin:[br,[br],(s,[t])=>Math.sin(t.evaluate(s))],cos:[br,[br],(s,[t])=>Math.cos(t.evaluate(s))],tan:[br,[br],(s,[t])=>Math.tan(t.evaluate(s))],asin:[br,[br],(s,[t])=>Math.asin(t.evaluate(s))],acos:[br,[br],(s,[t])=>Math.acos(t.evaluate(s))],atan:[br,[br],(s,[t])=>Math.atan(t.evaluate(s))],min:[br,Vc(br),(s,t)=>Math.min(...t.map((o=>o.evaluate(s))))],max:[br,Vc(br),(s,t)=>Math.max(...t.map((o=>o.evaluate(s))))],abs:[br,[br],(s,[t])=>Math.abs(t.evaluate(s))],round:[br,[br],(s,[t])=>{const o=t.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[br,[br],(s,[t])=>Math.floor(t.evaluate(s))],ceil:[br,[br],(s,[t])=>Math.ceil(t.evaluate(s))],"filter-==":[Dn,[wn,Fn],(s,[t,o])=>s.properties()[t.value]===o.value],"filter-id-==":[Dn,[Fn],(s,[t])=>s.id()===t.value],"filter-type-==":[Dn,[wn],(s,[t])=>s.geometryType()===t.value],"filter-<":[Dn,[wn,Fn],(s,[t,o])=>{const c=s.properties()[t.value],d=o.value;return typeof c==typeof d&&c<d}],"filter-id-<":[Dn,[Fn],(s,[t])=>{const o=s.id(),c=t.value;return typeof o==typeof c&&o<c}],"filter->":[Dn,[wn,Fn],(s,[t,o])=>{const c=s.properties()[t.value],d=o.value;return typeof c==typeof d&&c>d}],"filter-id->":[Dn,[Fn],(s,[t])=>{const o=s.id(),c=t.value;return typeof o==typeof c&&o>c}],"filter-<=":[Dn,[wn,Fn],(s,[t,o])=>{const c=s.properties()[t.value],d=o.value;return typeof c==typeof d&&c<=d}],"filter-id-<=":[Dn,[Fn],(s,[t])=>{const o=s.id(),c=t.value;return typeof o==typeof c&&o<=c}],"filter->=":[Dn,[wn,Fn],(s,[t,o])=>{const c=s.properties()[t.value],d=o.value;return typeof c==typeof d&&c>=d}],"filter-id->=":[Dn,[Fn],(s,[t])=>{const o=s.id(),c=t.value;return typeof o==typeof c&&o>=c}],"filter-has":[Dn,[Fn],(s,[t])=>t.value in s.properties()],"filter-has-id":[Dn,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Dn,[Zo(wn)],(s,[t])=>t.value.indexOf(s.geometryType())>=0],"filter-id-in":[Dn,[Zo(Fn)],(s,[t])=>t.value.indexOf(s.id())>=0],"filter-in-small":[Dn,[wn,Zo(Fn)],(s,[t,o])=>o.value.indexOf(s.properties()[t.value])>=0],"filter-in-large":[Dn,[wn,Zo(Fn)],(s,[t,o])=>(function(c,d,m,g){for(;m<=g;){const b=m+g>>1;if(d[b]===c)return!0;d[b]>c?g=b-1:m=b+1}return!1})(s.properties()[t.value],o.value,0,o.value.length-1)],all:{type:Dn,overloads:[[[Dn,Dn],(s,[t,o])=>t.evaluate(s)&&o.evaluate(s)],[Vc(Dn),(s,t)=>{for(const o of t)if(!o.evaluate(s))return!1;return!0}]]},any:{type:Dn,overloads:[[[Dn,Dn],(s,[t,o])=>t.evaluate(s)||o.evaluate(s)],[Vc(Dn),(s,t)=>{for(const o of t)if(o.evaluate(s))return!0;return!1}]]},"!":[Dn,[Dn],(s,[t])=>!t.evaluate(s)],"is-supported-script":[Dn,[wn],(s,[t])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(t.evaluate(s))}],upcase:[wn,[wn],(s,[t])=>t.evaluate(s).toUpperCase()],downcase:[wn,[wn],(s,[t])=>t.evaluate(s).toLowerCase()],concat:[wn,Vc(Fn),(s,t)=>t.map((o=>fl(o.evaluate(s)))).join("")],"resolved-locale":[wn,[Cu],(s,[t])=>t.evaluate(s).resolvedLocale()],random:[br,[br,br,Fn],(s,t)=>{const[o,c,d]=t.map((g=>g.evaluate(s)));if(o>c||o===c)return o;let m;if(typeof d=="string")m=(function(g){let b=0;if(g.length===0)return b;for(let P=0;P<g.length;P++)b=(b<<5)-b+g.charCodeAt(P),b|=0;return b})(d);else{if(typeof d!="number")throw new Xi(`Invalid seed input: ${d}`);m=d}return o+vl(m)()*(c-o)}]});class Xh{constructor(t,o,c,d,m){this.expression=t,this._warningHistory={},this._scope=c,this._options=d,this._iconImageUseTheme=m,this._evaluator=new Eo(c,d,m),this._defaultValue=o?(function(g){return g.type==="color"&&(rp(g.default)||Array.isArray(g.default))?new zn(0,0,0,0):g.type==="color"?zn.parse(g.default)||null:g.default===void 0?null:g.default})(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=Yh(t),this.isIndoorDependent=Qd(t)}evaluateWithoutErrorHandling(t,o,c,d,m,g,b,P){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=d||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(t,o,c,d,m,g,b,P,I){this._evaluator||(this._evaluator=new Eo(this._scope,this._options,this._iconImageUseTheme)),this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=P||null,this._evaluator.iconImageUseTheme=I||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new Xi(`Expected value to be one of ${Object.keys(this._enumValues).map((L=>JSON.stringify(L))).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${O.message}`)),this._defaultValue}}}function Kh(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in go}function el(s,t,o,c,d){const m=new hd(go,[],t?(function(b){const P={color:aa,string:wn,number:br,enum:wn,boolean:Dn,formatted:Lc,resolvedImage:Au};return b.type==="array"?Zo(P[b.value]||Fn,b.length):P[b.type]})(t):void 0,void 0,void 0,o,c,d),g=m.parse(s,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?gd(new Xh(g,t,o,c,d)):$l(m.errors)}class Va{constructor(t,o,c,d){this.kind=t,this._styleExpression=o,this.isLightConstant=c,this.isLineProgressConstant=d,this.isStateDependent=t!=="constant"&&!Hf(o.expression),this.configDependencies=Yh(o.expression),this.isIndoorDependent=Qd(o.expression)}evaluateWithoutErrorHandling(t,o,c,d,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,o,c,d,m,g)}evaluate(t,o,c,d,m,g,b){return this._styleExpression.evaluate(t,o,c,d,m,g,void 0,void 0,b)}}class xl{constructor(t,o,c,d,m,g){this.kind=t,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!Hf(o.expression),this.isIndoorDependent=Qd(o.expression),this.isLightConstant=m,this.isLineProgressConstant=g,this.configDependencies=Yh(o.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,o,c,d,m,g){return this._styleExpression.evaluateWithoutErrorHandling(t,o,c,d,m,g)}evaluate(t,o,c,d,m,g){return this._styleExpression.evaluate(t,o,c,d,m,g)}interpolationFactor(t,o,c){return this.interpolationType?yl.interpolationFactor(this.interpolationType,t,o,c):0}}function ip(s,t,o,c,d){if((s=el(s,t,o,c,d)).result==="error")return s;const m=s.value.expression,g=Gd(m);if(!g&&!Kp(t))return $l([new Ba("","data expressions not supported")]);const b=Nh(m,["zoom","pitch","distance-from-center"]);if(!b&&!Zh(t))return $l([new Ba("","zoom expressions not supported")]);const P=Nh(m,["measure-light"]);if(!P&&!Jd(t))return $l([new Ba("","measure-light expression not supported")]);const I=Nh(m,["line-progress"]);if(!I&&!(function(k){return ep(k.expression,"line-progress")})(t))return $l([new Ba("","line-progress expression not supported")]);const O=t.expression&&t.expression.relaxZoomRestriction,L=pc(m);return L||b||O?L instanceof Ba?$l([L]):L instanceof yl&&!tp(t)?$l([new Ba("",'"interpolate" expressions cannot be used with this property')]):gd(L?new xl(g&&I?"camera":"composite",s.value,L.labels,L instanceof yl?L.interpolation:void 0,P,I):new Va(g&&I?"constant":"source",s.value,P,I)):$l([new Ba("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class op{constructor(t,o){this._parameters=t,this._specification=o,Object.assign(this,np(this._parameters,this._specification))}static deserialize(t){return new op(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function pc(s){let t=null;if(s instanceof Nl)t=pc(s.result);else if(s instanceof Wh){for(const o of s.args)if(t=pc(o),t)break}else(s instanceof Yf||s instanceof yl)&&s.input instanceof gs&&s.input.name==="zoom"&&(t=s);return t instanceof Ba||s.eachChild((o=>{const c=pc(o);c instanceof Ba?t=c:t&&c&&t!==c&&(t=new Ba("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}var mc,Qh,lg=(function(){if(Qh)return mc;Qh=1,mc=t;var s=3;function t(o,c,d){var m=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var g=new Int32Array(this.arrayBuffer);o=g[0],this.d=(c=g[1])+2*(d=g[2]);for(var b=0;b<this.d*this.d;b++){var P=g[s+b],I=g[s+b+1];m.push(P===I?null:g.subarray(P,I))}var O=g[s+m.length+1];this.keys=g.subarray(g[s+m.length],O),this.bboxes=g.subarray(O),this.insert=this._insertReadonly}else{this.d=c+2*d;for(var L=0;L<this.d*this.d;L++)m.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=o,this.padding=d,this.scale=c/o,this.uid=0;var k=d/c*o;this.min=-k,this.max=o+k}return t.prototype.insert=function(o,c,d,m,g){this._forEachCell(c,d,m,g,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(g)},t.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},t.prototype._insertCell=function(o,c,d,m,g,b){this.cells[g].push(b)},t.prototype.query=function(o,c,d,m,g){var b=this.min,P=this.max;if(o<=b&&c<=b&&P<=d&&P<=m&&!g)return Array.prototype.slice.call(this.keys);var I=[];return this._forEachCell(o,c,d,m,this._queryCell,I,{},g),I},t.prototype._queryCell=function(o,c,d,m,g,b,P,I){var O=this.cells[g];if(O!==null)for(var L=this.keys,k=this.bboxes,$=0;$<O.length;$++){var W=O[$];if(P[W]===void 0){var Q=4*W;(I?I(k[Q+0],k[Q+1],k[Q+2],k[Q+3]):o<=k[Q+2]&&c<=k[Q+3]&&d>=k[Q+0]&&m>=k[Q+1])?(P[W]=!0,b.push(L[W])):P[W]=!1}}},t.prototype._forEachCell=function(o,c,d,m,g,b,P,I){for(var O=this._convertToCellCoord(o),L=this._convertToCellCoord(c),k=this._convertToCellCoord(d),$=this._convertToCellCoord(m),W=O;W<=k;W++)for(var Q=L;Q<=$;Q++){var te=this.d*Q+W;if((!I||I(this._convertFromCellCoord(W),this._convertFromCellCoord(Q),this._convertFromCellCoord(W+1),this._convertFromCellCoord(Q+1)))&&g.call(this,o,c,d,m,te,b,P,I))return}},t.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},t.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},t.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,c=s+this.cells.length+1+1,d=0,m=0;m<this.cells.length;m++)d+=this.cells[m].length;var g=new Int32Array(c+d+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var b=c,P=0;P<o.length;P++){var I=o[P];g[s+P]=b,g.set(I,b),b+=I.length}return g[s+o.length]=b,g.set(this.keys,b),g[s+o.length+1]=b+=this.keys.length,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer},mc})(),tl=rc(lg);const ql={};function cr(s,t,o={}){Object.defineProperty(s,"_classRegistryKey",{value:t,writable:!1}),ql[t]={klass:s,omit:o.omit||[]}}cr(Object,"Object"),tl.serialize=function(s,t){const o=s.toArrayBuffer();return t&&t.add(o),{buffer:o}},tl.deserialize=function(s){return new tl(s.buffer)},Object.defineProperty(tl,"name",{value:"Grid"}),cr(tl,"Grid"),delete St.prototype.constructor,typeof DOMMatrix<"u"&&cr(DOMMatrix,"DOMMatrix"),cr(zn,"Color"),cr(Error,"Error"),cr(No,"Formatted"),cr(Ru,"FormattedSection"),cr(Rl,"AJAXError"),cr(Gs,"ResolvedImage"),cr(op,"StylePropertyFunction"),cr(Xh,"StyleExpression",{omit:["_evaluator"]}),cr(pi,"ImageId"),cr(zl,"ImageVariant"),cr(xl,"ZoomDependentExpression"),cr(Va,"ZoomConstantExpression"),cr(gs,"CompoundExpression",{omit:["_evaluate"]});for(const s in go)ql[go[s]._classRegistryKey]||cr(go[s],`Expression${s}`);function em(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function gc(s){return self.ImageBitmap&&s instanceof ImageBitmap}function Vu(s,t){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(em(s)||gc(s))return t&&t.add(s),s;if(ArrayBuffer.isView(s))return t&&t.add(s.buffer),s;if(s instanceof ImageData)return t&&t.add(s.data.buffer),s;if(Array.isArray(s)){const o=[];for(const c of s)o.push(Vu(c,t));return o}if(s instanceof Map){const o={$name:"Map",entries:[]};for(const[c,d]of s.entries())o.entries.push(Vu(c),Vu(d,t));return o}if(s instanceof Set){const o={$name:"Set"};let c=0;for(const d of s.values())o[++c]=Vu(d);return o}if(s instanceof DOMMatrix){const o={$name:"DOMMatrix"},c=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const d of c)o[d]=s[d];return o}if(typeof s=="bigint")return{$name:"BigInt",value:s.toString()};if(typeof s=="object"){const o=s.constructor,c=o._classRegistryKey;if(!c)throw new Error(`Can't serialize object of unregistered class "${o.name}".`);const d=o.serialize?o.serialize(s,t):{};if(!o.serialize){for(const m in s)s.hasOwnProperty(m)&&(ql[c].omit.indexOf(m)>=0||(d[m]=Vu(s[m],t)));s instanceof Error&&(d.message=s.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(d.$name=c),d}throw new Error("can't serialize object of type "+typeof s)}function _c(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||em(s)||gc(s)||ArrayBuffer.isView(s)||s instanceof ImageData)return s;if(Array.isArray(s))return s.map(_c);if(typeof s=="object"){const t=s.$name||"Object";if(t==="Map"){const d=s.entries||[],m=new Map;for(let g=0;g<d.length;g+=2)m.set(_c(d[g]),_c(d[g+1]));return m}if(t==="Set"){const d=new Set;for(const m of Object.keys(s))m!=="$name"&&d.add(_c(s[m]));return d}if(t==="DOMMatrix"){let d;return d=s.is2D?[s.a,s.b,s.c,s.d,s.e,s.f]:[s.m11,s.m12,s.m13,s.m14,s.m21,s.m22,s.m23,s.m24,s.m31,s.m32,s.m33,s.m34,s.m41,s.m42,s.m43,s.m44],new DOMMatrix(d)}if(t==="BigInt")return BigInt(s.value);const{klass:o}=ql[t];if(!o)throw new Error(`Can't deserialize unregistered class "${t}".`);if(o.deserialize)return o.deserialize(s);const c=Object.create(o.prototype);for(const d of Object.keys(s))d!=="$name"&&(c[d]=_c(s[d]));return c}throw new Error("can't deserialize object of type "+typeof s)}const Mr={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519,Osage:s=>s>=66736&&s<=66815,"CJK Unified Ideographs Extension B":s=>s>=131072&&s<=173791};function eh(s){for(const t of s)if(ef(t.charCodeAt(0)))return!0;return!1}function Jh(s){for(const t of s)if(!pu(t.charCodeAt(0)))return!1;return!0}function pu(s){return!(Mr.Arabic(s)||Mr["Arabic Supplement"](s)||Mr["Arabic Extended-A"](s)||Mr["Arabic Presentation Forms-A"](s)||Mr["Arabic Presentation Forms-B"](s))}function ef(s){return!(s!==746&&s!==747&&(s<4352||!(Mr["Bopomofo Extended"](s)||Mr.Bopomofo(s)||Mr["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||Mr["CJK Compatibility Ideographs"](s)||Mr["CJK Compatibility"](s)||Mr["CJK Radicals Supplement"](s)||Mr["CJK Strokes"](s)||!(!Mr["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||Mr["CJK Unified Ideographs Extension A"](s)||Mr["CJK Unified Ideographs"](s)||Mr["Enclosed CJK Letters and Months"](s)||Mr["Hangul Compatibility Jamo"](s)||Mr["Hangul Jamo Extended-A"](s)||Mr["Hangul Jamo Extended-B"](s)||Mr["Hangul Jamo"](s)||Mr["Hangul Syllables"](s)||Mr.Hiragana(s)||Mr["Ideographic Description Characters"](s)||Mr.Kanbun(s)||Mr["Kangxi Radicals"](s)||Mr["Katakana Phonetic Extensions"](s)||Mr.Katakana(s)&&s!==12540||!(!Mr["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!Mr["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||Mr["Unified Canadian Aboriginal Syllabics"](s)||Mr["Unified Canadian Aboriginal Syllabics Extended"](s)||Mr["Vertical Forms"](s)||Mr["Yijing Hexagram Symbols"](s)||Mr["Yi Syllables"](s)||Mr["Yi Radicals"](s))))}function yd(s){return!(ef(s)||(function(t){return!!(Mr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Mr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Mr["Letterlike Symbols"](t)||Mr["Number Forms"](t)||Mr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Mr["Control Pictures"](t)&&t!==9251||Mr["Optical Character Recognition"](t)||Mr["Enclosed Alphanumerics"](t)||Mr["Geometric Shapes"](t)||Mr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Mr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Mr["CJK Symbols and Punctuation"](t)||Mr.Katakana(t)||Mr["Private Use Area"](t)||Mr["CJK Compatibility Forms"](t)||Mr["Small Form Variants"](t)||Mr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(s))}function tm(s){return Mr.Arabic(s)||Mr["Arabic Supplement"](s)||Mr["Arabic Extended-A"](s)||Mr["Arabic Presentation Forms-A"](s)||Mr["Arabic Presentation Forms-B"](s)}function rm(s){return s>=1424&&s<=2303||Mr["Arabic Presentation Forms-A"](s)||Mr["Arabic Presentation Forms-B"](s)}function rs(s,t){return!(!t&&rm(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||Mr.Khmer(s))}function nm(s){for(const t of s)if(rm(t.charCodeAt(0)))return!0;return!1}const Ua={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let sp=null,Ys=Ua.unavailable,mu=null;const vd=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(Ys=Ua.error),sp&&sp(s)};function $o(){_s.fire(new eo("pluginStateChange",{pluginStatus:Ys,pluginURL:mu}))}const _s=new sa,zs=function(){return Ys},tf=function(){if(Ys!==Ua.deferred||!mu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ys=Ua.loading,$o(),mu&&hl({url:mu},(s=>{s?vd(s):(Ys=Ua.loaded,$o())}))},da={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ys===Ua.loaded||da.applyArabicShaping!=null,isLoading:()=>Ys===Ua.loading,setState(s){Ys=s.pluginStatus,mu=s.pluginURL},isParsing:()=>Ys===Ua.parsing,isParsed:()=>Ys===Ua.parsed,getPluginURL:()=>mu};class mi{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness,this.worldview=o.worldview,this.activeFloors=o.activeFloors):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return(function(o,c){for(const d of o)if(!rs(d.charCodeAt(0),c))return!1;return!0})(t,da.isLoaded())}}class ap{constructor(t,o,c,d,m){this.property=t,this.value=o,this.expression=(function(g,b,P,I,O){if(rp(g))return new op(g,b);if(Kh(g)||Array.isArray(g)&&g.length>0){const L=ip(g,b,P,I,O);if(L.result==="error")throw new Error(L.value.map((k=>`${k.key}: ${k.message}`)).join(", "));return L.value}{let L=g;return typeof g=="string"&&b.type==="color"&&(L=zn.parse(g)),{kind:"constant",configDependencies:new Set,isIndoorDependent:!1,evaluate:()=>L}}})(o===void 0?t.specification.default:o,t.specification,c,d,m)}isIndoorDependent(){return this.expression.isIndoorDependent}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,c,d){return this.property.possiblyEvaluate(this,t,o,c,d)}}class ys{constructor(t,o,c,d){this.property=t,this.value=new ap(t,void 0,o,c,d)}transitioned(t,o){return new om(this.property,this.value,o,Object.assign({},t.transition,this.transition),t.now)}untransitioned(){return new om(this.property,this.value,null,{},0)}}class im{constructor(t,o,c,d){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=o,this._options=c,this._iconImageUseTheme=d,this._isIndoorDependent=!1,this.configDependencies=new Set}getValue(t){return gr(this._values[t].value.value)}setValue(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new ys(this._values[t].property,this._scope,this._options,this._iconImageUseTheme)),this._values[t].value=new ap(this._values[t].property,o===null?void 0:gr(o),this._scope,this._options,this._iconImageUseTheme),this._values[t].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].value.expression.configDependencies]),this._isIndoorDependent=this._isIndoorDependent||this._values[t].value.isIndoorDependent())}setTransitionOrValue(t,o){o&&(this._options=o);const c=this._properties.properties;if(t)for(const d in t){const m=t[d];if(d.endsWith("-transition")){const g=d.slice(0,-11);c[g]&&this.setTransition(g,m)}else c.hasOwnProperty(d)&&this.setValue(d,m)}}getTransition(t){return gr(this._values[t].transition)}setTransition(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new ys(this._values[t].property)),this._values[t].transition=gr(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(t[o]=c);const d=this.getTransition(o);d!==void 0&&(t[`${o}-transition`]=d)}return t}transitioned(t,o){const c=new Uc(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].transitioned(t,o._values[d]);return c}untransitioned(){const t=new Uc(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}isIndoorDependent(){return this._isIndoorDependent}}class om{constructor(t,o,c,d,m){const g=d.delay||0,b=d.duration||0;m=m||0,this.property=t,this.value=o,this.begin=m+g,this.end=this.begin+b,t.specification.transition&&(d.delay||d.duration)&&(this.prior=c)}possiblyEvaluate(t,o,c){const d=t.now||0,m=this.value.possiblyEvaluate(t,o,c),g=this.prior;if(g){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return g.possiblyEvaluate(t,o,c);{const b=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,o,c),m,cl(b))}}return m}}class Uc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,c){const d=new $c(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(t,o,c);return d}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class yc{constructor(t,o,c,d){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=o,this._options=c,this._iconImageUseTheme=d,this._isIndoorDependent=!1,this.configDependencies=new Set}getValue(t){return gr(this._values[t].value)}setValue(t,o){this._values[t]=new ap(this._values[t].property,o===null?void 0:gr(o),this._scope,this._options,this._iconImageUseTheme),this._values[t].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].expression.configDependencies]),this._isIndoorDependent=this._isIndoorDependent||this._values[t].isIndoorDependent())}serialize(){const t={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(t[o]=c)}return t}possiblyEvaluate(t,o,c,d){const m=new $c(this._properties);for(const g of Object.keys(this._values))m._values[g]=this._values[g].possiblyEvaluate(t,o,c,d);return m}isIndoorDependent(){return this._isIndoorDependent}}class ns{constructor(t,o,c,d){this.property=t,this.value=o,this.parameters=c,this.iconImageUseTheme=d}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,c,d){return this.property.evaluate(this.value,this.parameters,t,o,c,d,this.iconImageUseTheme)}}class $c{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class zt{constructor(t){this.specification=t}possiblyEvaluate(t,o){return t.expression.evaluate(o)}interpolate(t,o,c){const d=Ll[this.specification.type];return d?d(t,o,c):t}}class tr{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,c,d,m){return t.expression.kind==="constant"||t.expression.kind==="camera"?new ns(this,{kind:"constant",value:t.expression.evaluate(o,null,{},c,d,void 0,m)},o):new ns(this,t.expression,o,m)}interpolate(t,o,c){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new ns(this,{kind:"constant",value:void 0},t.parameters);const d=Ll[this.specification.type];return d?new ns(this,{kind:"constant",value:d(t.value.value,o.value.value,c)},t.parameters):t}evaluate(t,o,c,d,m,g,b){return t.kind==="constant"?t.value:t.evaluate(o,c,d,m,g,void 0,b)}}class th{constructor(t){this.specification=t}possiblyEvaluate(t,o,c,d){return!!t.expression.evaluate(o,null,{},c,d)}interpolate(){return!1}}class to{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new mi(0,{});for(const c in t){const d=t[c];d.specification.overridable&&this.overridableProperties.push(c);const m=this.defaultPropertyValues[c]=new ap(d,void 0),g=this.defaultTransitionablePropertyValues[c]=new ys(d);this.defaultTransitioningPropertyValues[c]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=m.possiblyEvaluate(o)}}}cr(tr,"DataDrivenProperty"),cr(zt,"DataConstantProperty"),cr(th,"ColorRampProperty");var Ye=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"modelNodeOverride":{"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360}},"modelNodeOverrides":{"*":{"type":"modelNodeOverride"}},"modelMaterialOverride":{"model-color":{"type":"color"},"model-color-mix-intensity":{"type":"number"},"model-opacity":{"type":"number"},"model-emissive-strength":{"type":"number"}},"modelMaterialOverrides":{"*":{"type":"modelMaterialOverride"}},"modelSourceModel":{"uri":{"type":"string"},"position":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[-180,-90],"maximum":[180,90]},"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360},"nodeOverrides":{"type":"modelNodeOverrides"},"materialOverrides":{"type":"modelMaterialOverrides"},"nodeOverrideNames":{"type":"array","value":"string"},"materialOverrideNames":{"type":"array","value":"string"},"featureProperties":{"type":"*"}},"modelSourceModels":{"*":{"type":"modelSourceModel"}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"},"models":{"type":"modelSourceModels"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"boolean","expression":{"parameters":["zoom","pitch","feature","feature-state","measure-light","distance-from-center"]},"property-type":"data-driven"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-unit-width":{"type":"number","minimum":1,"maximum":20,"default":3.1,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flip-roof-orientation":{"property-type":"data-driven","type":"boolean","default":false,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":[0.1,0.1],"maximum":[10,10],"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"use-theme":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":[0.1,0.1],"maximum":[10,10],"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor_source":{"sourceId":{"type":"string"},"sourceLayers":{"type":"array","value":"string"}},"indoor":{"*":{"type":"indoor_source"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"building-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]},"model-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{}}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function sm(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function rh(s){if(Array.isArray(s))return s.map(rh);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const t={};for(const o in s)t[o]=rh(s[o]);return t}return sm(s)}function nh(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const t of s.slice(1))if(!nh(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function lp(s,t="",o=null,c="fill"){if(s==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};nh(s)||(s=rl(s));const d=s;let m=!0;try{m=(function(O){if(!ih(O))return O;let L=rh(O);return gu(L),L=cp(L),L})(d)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(d,null,2)}
        `)}let g=null,b=null;if(c!=="background"&&c!=="sky"&&c!=="slot"){b=Ye[`filter_${c}`];const O=el(m,b,t,o);if(O.result==="error")throw new Error(O.value.map((L=>`${L.key}: ${L.message}`)).join(", "));g=(L,k,$)=>O.value.evaluate(L,k,{},$)}let P=null,I=null;if(m!==d){const O=el(d,b,t,o);if(O.result==="error")throw new Error(O.value.map((L=>`${L.key}: ${L.message}`)).join(", "));P=(L,k,$,W,Q)=>O.value.evaluate(L,k,{},$,void 0,void 0,W,Q),I=!Gd(O.value.expression)}return{filter:g,dynamicFilter:P||void 0,needGeometry:cg(m),needFeature:!!I}}function cp(s){if(!Array.isArray(s))return s;const t=(function(o){if(am.has(o[0])){for(let c=1;c<o.length;c++)if(ih(o[c]))return!0}return o})(s);return t===!0?t:t.map((o=>cp(o)))}function gu(s){let t=!1;const o=[];if(s[0]==="case"){for(let c=1;c<s.length-1;c+=2)t=t||ih(s[c]),o.push(s[c+1]);o.push(s[s.length-1])}else if(s[0]==="match"){t=t||ih(s[1]);for(let c=2;c<s.length-1;c+=2)o.push(s[c+1]);o.push(s[s.length-1])}else if(s[0]==="step"){t=t||ih(s[1]);for(let c=1;c<s.length-1;c+=2)o.push(s[c+1])}t&&(s.length=0,s.push("any",...o));for(let c=1;c<s.length;c++)gu(s[c])}function ih(s){if(!Array.isArray(s))return!1;if((t=s[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let o=1;o<s.length;o++)if(ih(s[o]))return!0;return!1}const am=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function up(s,t){return s<t?-1:s>t?1:0}function cg(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let t=1;t<s.length;t++)if(cg(s[t]))return!0;return!1}function rl(s){if(!s)return!0;const t=s[0];return s.length<=1?t!=="any":t==="=="?lm(s[1],s[2],"=="):t==="!="?dp(lm(s[1],s[2],"==")):t==="<"||t===">"||t==="<="||t===">="?lm(s[1],s[2],t):t==="any"?(o=s.slice(1),["any"].concat(o.map(rl))):t==="all"?["all"].concat(s.slice(1).map(rl)):t==="none"?["all"].concat(s.slice(1).map(rl).map(dp)):t==="in"?cm(s[1],s.slice(2)):t==="!in"?dp(cm(s[1],s.slice(2))):t==="has"?ug(s[1]):t!=="!has"||dp(ug(s[1]));var o}function lm(s,t,o){switch(s){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,s,t]}}function cm(s,t){if(t.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((o=>typeof o!=typeof t[0]))?["filter-in-large",s,["literal",t.sort(up)]]:["filter-in-small",s,["literal",t]]}}function ug(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function dp(s){return["!",s]}const oh="";function xd(s,t){return t?`${s}${oh}${t}`:s}let dg;const hg=()=>dg||(dg=new to({"icon-size":new tr(Ye.layout_symbol["icon-size"]),"icon-image":new tr(Ye.layout_symbol["icon-image"]),"icon-rotate":new tr(Ye.layout_symbol["icon-rotate"]),"icon-offset":new tr(Ye.layout_symbol["icon-offset"])}));class sv{constructor(t,o,c,d,m,g){this.cachedIconPrimary=null;const b=el(t,Ye.appearance.condition);if(b.result==="success"&&(this.condition=b.value),this.name=o,c){this.properties=new $c(hg()),this.unevaluatedLayout=new yc(hg(),d,m,g);for(const P in c)this.unevaluatedLayout.setValue(P,c[P])}}hasCachedIconPrimary(){return this.cachedIconPrimary!==null}setCachedIconPrimary(t){this.cachedIconPrimary=t}getCachedIconPrimary(){return this.cachedIconPrimary}isActive(t){return!(this.condition||!t.isHidden||this.name!=="hidden")||this.condition.evaluate(t.globals,t.feature,t.featureState,t.canonical)}getCondition(){return this.condition}getName(){return this.name}getProperty(t){return this.properties.get(t)}getUnevaluatedProperties(){return this.unevaluatedLayout}recalculate(t,o,c){this.unevaluatedLayout&&(this.properties=this.unevaluatedLayout.possiblyEvaluate(t,void 0,o,c))}serialize(){const t={};return t.condition=this.condition.expression.serialize(),this.name&&(t.name=this.name),this.unevaluatedLayout&&(t.properties=this.unevaluatedLayout.serialize()),t}}const fg="-transition",av=new Set(["fill","line","background","hillshade","raster"]);class Ia extends sa{constructor(t,o,c,d,m,g){if(super(),this.id=t.id,this.fqid=xd(this.id,c),this.type=t.type,this.scope=c,this.lut=d,this.options=m,this.iconImageUseTheme=g,this.appearances=new Array,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.expressionDependencies={isIndoorDependent:!1,configDependencies:new Set},t.type!=="custom"){if(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type&&t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"){this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter;const b=el(this.filter,Ye[`filter_${t.type}`]);b.result!=="error"&&(this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...b.value.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||b.value.isIndoorDependent)}if(t.slot&&(this.slot=t.slot),t.appearances&&this.setAppearances(t.appearances),o.layout&&(this._unevaluatedLayout=new yc(o.layout,this.scope,m,this.iconImageUseTheme),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...this._unevaluatedLayout.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||this._unevaluatedLayout.isIndoorDependent()),o.paint){this._transitionablePaint=new im(o.paint,this.scope,m);for(const b in t.paint)this.setPaintProperty(b,t.paint[b]);for(const b in t.layout)this.setLayoutProperty(b,t.layout[b]);this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...this._transitionablePaint.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||this._transitionablePaint.isIndoorDependent(),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new $c(o.paint)}}}onAdd(t){}onRemove(t){}isDraped(t){return!this.is3D(!0)&&av.has(this.type)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o){if(this.type==="custom"&&t==="visibility")return void(this.visibility=o);const c=this._unevaluatedLayout;c._properties.properties[t]&&(c.setValue(t,o),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...c.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||c.isIndoorDependent(),t==="visibility"&&this.possiblyEvaluateVisibility())}setAppearances(t){this.appearances=[],t.forEach((o=>{this.appearances.push(new sv(o.condition,o.name,o.properties,this.scope,this.options,this.iconImageUseTheme))}))}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(t){return t.endsWith(fg)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}isPaintProperty(t){return!!this._transitionablePaint._properties.properties[t]}setPaintProperty(t,o){const c=this._transitionablePaint,d=c._properties.properties;if(t.endsWith(fg)){const L=t.slice(0,-11);return d[L]&&c.setTransition(L,o||void 0),!1}if(!d[t])return!1;const m=c._values[t],g=m.value.isDataDriven(),b=m.value;c.setValue(t,o),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...c.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||c.isIndoorDependent(),this._handleSpecialPaintPropertyUpdate(t);const P=c._values[t].value,I=P.isDataDriven(),O=t.endsWith("pattern")||t==="line-dasharray";return I||g||O||this._handleOverridablePaintPropertyUpdate(t,b,P)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,o,c){return null}_handleOverridablePaintPropertyUpdate(t,o,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o,this.iconImageUseTheme)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){const t={id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.appearances.length!==0&&(t.appearances=this.appearances.map((o=>o.serialize()))),Pt(t,((o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length)))}is3D(t){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof ns&&Kp(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}for(const t of this.appearances)if(!Hf(t.condition.expression))return!0;return!1}compileFilter(t){this._filterCompiled||(this._featureFilter=lp(this.filter,this.scope,t),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&(t.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}getAppearances(){return this.appearances}queryRenderedFeatures(t,o,c){return{}}queryRadius(t){}queryIntersectsFeature(t,o,c,d,m,g,b,P,I){}}const I_={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rf{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ci{constructor(){this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&o.add(t.arrayBuffer),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function pn(s,t=1){let o=0,c=0;return{members:s.map((d=>{const m=I_[d.type].BYTES_PER_ELEMENT,g=o=pg(o,Math.max(t,m)),b=d.components||1;return c=Math.max(c,m),o+=m*b,{name:d.name,type:d.type,components:b,offset:g}})),size:pg(o,Math.max(c,t)),alignment:t}}function pg(s,t){return Math.ceil(s/t)*t}class nl extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const d=2*t;return this.int16[d+0]=o,this.int16[d+1]=c,t}}nl.prototype.bytesPerElement=4,cr(nl,"StructArrayLayout2i4");class sh extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c)}emplace(t,o,c,d){const m=3*t;return this.int16[m+0]=o,this.int16[m+1]=c,this.int16[m+2]=d,t}}sh.prototype.bytesPerElement=6,cr(sh,"StructArrayLayout3i6");class $a extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,d)}emplace(t,o,c,d,m){const g=4*t;return this.int16[g+0]=o,this.int16[g+1]=c,this.int16[g+2]=d,this.int16[g+3]=m,t}}$a.prototype.bytesPerElement=8,cr($a,"StructArrayLayout4i8");class Wc extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}Wc.prototype.bytesPerElement=4,cr(Wc,"StructArrayLayout1f4");class nf extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c)}emplace(t,o,c,d){const m=4*t,g=2*t;return this.int16[m+0]=o,this.int16[m+1]=c,this.float32[g+1]=d,t}}nf.prototype.bytesPerElement=8,cr(nf,"StructArrayLayout2i1f8");class um extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c)}emplace(t,o,c,d){const m=4*t;return this.int16[m+0]=o,this.int16[m+1]=c,this.int16[m+2]=d,t}}um.prototype.bytesPerElement=8,cr(um,"StructArrayLayout3i8");class hp extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,c,d,m)}emplace(t,o,c,d,m,g){const b=5*t;return this.int16[b+0]=o,this.int16[b+1]=c,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=g,t}}hp.prototype.bytesPerElement=10,cr(hp,"StructArrayLayout5i10");class fp extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,c,d,m,g,b)}emplace(t,o,c,d,m,g,b,P){const I=6*t,O=12*t,L=3*t;return this.int16[I+0]=o,this.int16[I+1]=c,this.uint8[O+4]=d,this.uint8[O+5]=m,this.uint8[O+6]=g,this.uint8[O+7]=b,this.float32[L+2]=P,t}}fp.prototype.bytesPerElement=12,cr(fp,"StructArrayLayout2i4ub1f12");class il extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c)}emplace(t,o,c,d){const m=3*t;return this.float32[m+0]=o,this.float32[m+1]=c,this.float32[m+2]=d,t}}il.prototype.bytesPerElement=12,cr(il,"StructArrayLayout3f12");class Gl extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,c,d,m)}emplace(t,o,c,d,m,g){const b=6*t,P=3*t;return this.uint16[b+0]=o,this.uint16[b+1]=c,this.uint16[b+2]=d,this.uint16[b+3]=m,this.float32[P+2]=g,t}}Gl.prototype.bytesPerElement=12,cr(Gl,"StructArrayLayout4ui1f12");class Uu extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,d)}emplace(t,o,c,d,m){const g=4*t;return this.uint16[g+0]=o,this.uint16[g+1]=c,this.uint16[g+2]=d,this.uint16[g+3]=m,t}}Uu.prototype.bytesPerElement=8,cr(Uu,"StructArrayLayout4ui8");class of extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,c,d,m,g)}emplace(t,o,c,d,m,g,b){const P=6*t;return this.int16[P+0]=o,this.int16[P+1]=c,this.int16[P+2]=d,this.int16[P+3]=m,this.int16[P+4]=g,this.int16[P+5]=b,t}}of.prototype.bytesPerElement=12,cr(of,"StructArrayLayout6i12");class dm extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b,P,I,O,L,k){const $=this.length;return this.resize($+1),this.emplace($,t,o,c,d,m,g,b,P,I,O,L,k)}emplace(t,o,c,d,m,g,b,P,I,O,L,k,$){const W=12*t;return this.int16[W+0]=o,this.int16[W+1]=c,this.int16[W+2]=d,this.int16[W+3]=m,this.uint16[W+4]=g,this.uint16[W+5]=b,this.uint16[W+6]=P,this.uint16[W+7]=I,this.int16[W+8]=O,this.int16[W+9]=L,this.int16[W+10]=k,this.int16[W+11]=$,t}}dm.prototype.bytesPerElement=24,cr(dm,"StructArrayLayout4i4ui4i24");class ah extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,c,d,m,g)}emplace(t,o,c,d,m,g,b){const P=10*t,I=5*t;return this.int16[P+0]=o,this.int16[P+1]=c,this.int16[P+2]=d,this.float32[I+2]=m,this.float32[I+3]=g,this.float32[I+4]=b,t}}ah.prototype.bytesPerElement=20,cr(ah,"StructArrayLayout3i3f20");class $u extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,d)}emplace(t,o,c,d,m){const g=4*t;return this.float32[g+0]=o,this.float32[g+1]=c,this.float32[g+2]=d,this.float32[g+3]=m,t}}$u.prototype.bytesPerElement=16,cr($u,"StructArrayLayout4f16");class hm extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}hm.prototype.bytesPerElement=4,cr(hm,"StructArrayLayout1ul4");class Hl extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const d=2*t;return this.uint16[d+0]=o,this.uint16[d+1]=c,t}}Hl.prototype.bytesPerElement=4,cr(Hl,"StructArrayLayout2ui4");class fm extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b,P,I,O,L,k,$){const W=this.length;return this.resize(W+1),this.emplace(W,t,o,c,d,m,g,b,P,I,O,L,k,$)}emplace(t,o,c,d,m,g,b,P,I,O,L,k,$,W){const Q=20*t,te=10*t;return this.int16[Q+0]=o,this.int16[Q+1]=c,this.int16[Q+2]=d,this.int16[Q+3]=m,this.int16[Q+4]=g,this.float32[te+3]=b,this.float32[te+4]=P,this.float32[te+5]=I,this.float32[te+6]=O,this.int16[Q+14]=L,this.uint32[te+8]=k,this.uint16[Q+18]=$,this.uint16[Q+19]=W,t}}fm.prototype.bytesPerElement=40,cr(fm,"StructArrayLayout5i4f1i1ul2ui40");class pm extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,c,d,m,g,b)}emplace(t,o,c,d,m,g,b,P){const I=8*t;return this.int16[I+0]=o,this.int16[I+1]=c,this.int16[I+2]=d,this.int16[I+4]=m,this.int16[I+5]=g,this.int16[I+6]=b,this.int16[I+7]=P,t}}pm.prototype.bytesPerElement=16,cr(pm,"StructArrayLayout3i2i2i16");class Zs extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,c,d,m)}emplace(t,o,c,d,m,g){const b=4*t,P=8*t;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=d,this.int16[P+6]=m,this.int16[P+7]=g,t}}Zs.prototype.bytesPerElement=16,cr(Zs,"StructArrayLayout2f1f2i16");class Fs extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,c,d,m,g)}emplace(t,o,c,d,m,g,b){const P=20*t,I=5*t;return this.uint8[P+0]=o,this.uint8[P+1]=c,this.float32[I+1]=d,this.float32[I+2]=m,this.float32[I+3]=g,this.float32[I+4]=b,t}}Fs.prototype.bytesPerElement=20,cr(Fs,"StructArrayLayout2ub4f20");class Li extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c)}emplace(t,o,c,d){const m=3*t;return this.uint16[m+0]=o,this.uint16[m+1]=c,this.uint16[m+2]=d,t}}Li.prototype.bytesPerElement=6,cr(Li,"StructArrayLayout3ui6");class lh extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue,he,me,Ae){const Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue,he,me,Ae)}emplace(t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue,he,me,Ae,Pe){const Fe=30*t,Be=15*t,Ve=60*t;return this.int16[Fe+0]=o,this.int16[Fe+1]=c,this.int16[Fe+2]=d,this.float32[Be+2]=m,this.float32[Be+3]=g,this.uint16[Fe+8]=b,this.uint16[Fe+9]=P,this.uint32[Be+5]=I,this.uint32[Be+6]=O,this.uint32[Be+7]=L,this.uint16[Fe+16]=k,this.uint16[Fe+17]=$,this.uint16[Fe+18]=W,this.float32[Be+10]=Q,this.float32[Be+11]=te,this.uint8[Ve+48]=ne,this.uint8[Ve+49]=ue,this.uint8[Ve+50]=he,this.uint32[Be+13]=me,this.int16[Fe+28]=Ae,this.uint8[Ve+58]=Pe,t}}lh.prototype.bytesPerElement=60,cr(lh,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class mm extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue,he,me,Ae,Pe,Fe,Be,Ve,at,Ze,ft,xt,Ct,Wt,Rt,wt){const Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue,he,me,Ae,Pe,Fe,Be,Ve,at,Ze,ft,xt,Ct,Wt,Rt,wt)}emplace(t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue,he,me,Ae,Pe,Fe,Be,Ve,at,Ze,ft,xt,Ct,Wt,Rt,wt,Dt){const ot=20*t,it=40*t,At=80*t;return this.float32[ot+0]=o,this.float32[ot+1]=c,this.int16[it+4]=d,this.int16[it+5]=m,this.int16[it+6]=g,this.int16[it+7]=b,this.int16[it+8]=P,this.int16[it+9]=I,this.int16[it+10]=O,this.int16[it+11]=L,this.int16[it+12]=k,this.uint16[it+13]=$,this.uint16[it+14]=W,this.uint16[it+15]=Q,this.uint16[it+16]=te,this.uint16[it+17]=ne,this.uint16[it+18]=ue,this.uint16[it+19]=he,this.uint16[it+20]=me,this.uint16[it+21]=Ae,this.uint16[it+22]=Pe,this.uint16[it+23]=Fe,this.uint16[it+24]=Be,this.uint16[it+25]=Ve,this.uint16[it+26]=at,this.uint16[it+27]=Ze,this.uint32[ot+14]=ft,this.float32[ot+15]=xt,this.float32[ot+16]=Ct,this.float32[ot+17]=Wt,this.float32[ot+18]=Rt,this.uint8[At+76]=wt,this.uint16[it+39]=Dt,t}}mm.prototype.bytesPerElement=80,cr(mm,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class gm extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,c,d,m,g)}emplace(t,o,c,d,m,g,b){const P=6*t;return this.float32[P+0]=o,this.float32[P+1]=c,this.float32[P+2]=d,this.float32[P+3]=m,this.float32[P+4]=g,this.float32[P+5]=b,t}}gm.prototype.bytesPerElement=24,cr(gm,"StructArrayLayout6f24");class bd extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,c,d,m)}emplace(t,o,c,d,m,g){const b=5*t;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=d,this.float32[b+3]=m,this.float32[b+4]=g,t}}bd.prototype.bytesPerElement=20,cr(bd,"StructArrayLayout5f20");class pp extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,c,d,m,g,b)}emplace(t,o,c,d,m,g,b,P){const I=7*t;return this.float32[I+0]=o,this.float32[I+1]=c,this.float32[I+2]=d,this.float32[I+3]=m,this.float32[I+4]=g,this.float32[I+5]=b,this.float32[I+6]=P,t}}pp.prototype.bytesPerElement=28,cr(pp,"StructArrayLayout7f28");class sf extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b,P,I,O,L){const k=this.length;return this.resize(k+1),this.emplace(k,t,o,c,d,m,g,b,P,I,O,L)}emplace(t,o,c,d,m,g,b,P,I,O,L,k){const $=11*t;return this.float32[$+0]=o,this.float32[$+1]=c,this.float32[$+2]=d,this.float32[$+3]=m,this.float32[$+4]=g,this.float32[$+5]=b,this.float32[$+6]=P,this.float32[$+7]=I,this.float32[$+8]=O,this.float32[$+9]=L,this.float32[$+10]=k,t}}sf.prototype.bytesPerElement=44,cr(sf,"StructArrayLayout11f44");class mp extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b,P,I){const O=this.length;return this.resize(O+1),this.emplace(O,t,o,c,d,m,g,b,P,I)}emplace(t,o,c,d,m,g,b,P,I,O){const L=9*t;return this.float32[L+0]=o,this.float32[L+1]=c,this.float32[L+2]=d,this.float32[L+3]=m,this.float32[L+4]=g,this.float32[L+5]=b,this.float32[L+6]=P,this.float32[L+7]=I,this.float32[L+8]=O,t}}mp.prototype.bytesPerElement=36,cr(mp,"StructArrayLayout9f36");class Wu extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const d=2*t;return this.float32[d+0]=o,this.float32[d+1]=c,t}}Wu.prototype.bytesPerElement=8,cr(Wu,"StructArrayLayout2f8");class _m extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,d)}emplace(t,o,c,d,m){const g=6*t;return this.uint32[3*t+0]=o,this.uint16[g+2]=c,this.uint16[g+3]=d,this.uint16[g+4]=m,t}}_m.prototype.bytesPerElement=12,cr(_m,"StructArrayLayout1ul3ui12");class af extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}af.prototype.bytesPerElement=2,cr(af,"StructArrayLayout1ui2");class lf extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te){const ne=this.length;return this.resize(ne+1),this.emplace(ne,t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te)}emplace(t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne){const ue=16*t;return this.float32[ue+0]=o,this.float32[ue+1]=c,this.float32[ue+2]=d,this.float32[ue+3]=m,this.float32[ue+4]=g,this.float32[ue+5]=b,this.float32[ue+6]=P,this.float32[ue+7]=I,this.float32[ue+8]=O,this.float32[ue+9]=L,this.float32[ue+10]=k,this.float32[ue+11]=$,this.float32[ue+12]=W,this.float32[ue+13]=Q,this.float32[ue+14]=te,this.float32[ue+15]=ne,t}}lf.prototype.bytesPerElement=64,cr(lf,"StructArrayLayout16f64");class ch extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,d,m,g,b){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,c,d,m,g,b)}emplace(t,o,c,d,m,g,b,P){const I=10*t,O=5*t;return this.uint16[I+0]=o,this.uint16[I+1]=c,this.uint16[I+2]=d,this.uint16[I+3]=m,this.float32[O+2]=g,this.float32[O+3]=b,this.float32[O+4]=P,t}}ch.prototype.bytesPerElement=20,cr(ch,"StructArrayLayout4ui3f20");class gp extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.int16[1*t+0]=o,t}}gp.prototype.bytesPerElement=2,cr(gp,"StructArrayLayout1i2");class uh extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint8[1*t+0]=o,t}}uh.prototype.bytesPerElement=1,cr(uh,"StructArrayLayout1ub1");class mg extends rf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}mg.prototype.size=40;class gg extends fm{get(t){return new mg(this,t)}}cr(gg,"CollisionBoxArray");class cf extends rf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}cf.prototype.size=60;class uf extends lh{get(t){return new cf(this,t)}}cr(uf,"PlacedSymbolArray");class df extends rf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}df.prototype.size=80;class _u extends mm{get(t){return new df(this,t)}}cr(_u,"SymbolInstanceArray");class _g extends Wc{getoffsetX(t){return this.float32[1*t+0]}}cr(_g,"GlyphOffsetArray");class yg extends nl{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}cr(yg,"SymbolLineVertexArray");class hf extends rf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}hf.prototype.size=12;class vg extends _m{get(t){return new hf(this,t)}}cr(vg,"FeatureIndexArray");class xg extends Hl{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}cr(xg,"FillExtrusionCentroidArray");class ff extends rf{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}ff.prototype.size=6;class Ma extends sh{get(t){return new ff(this,t)}}cr(Ma,"FillExtrusionWallArray");const M_=pn([{name:"a_pos",components:2,type:"Int16"}],4),lv=pn([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),ym=pn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Wn{constructor(t=[]){this.segments=t}_prepareSegment(t,o,c,d){let m=this.segments[this.segments.length-1];return t>Wn.MAX_VERTEX_ARRAY_LENGTH&&Cr(`Max vertices per segment is ${Wn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!m||m.vertexLength+t>Wn.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:o,primitiveOffset:c,vertexLength:0,primitiveLength:0},d!==void 0&&(m.sortKey=d),this.segments.push(m)),m}prepareSegment(t,o,c,d){return this._prepareSegment(t,o.length,c.length,d)}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,c,d){return new Wn([{vertexOffset:t,primitiveOffset:o,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])}}function C_(s,t){return 256*(s=le(Math.floor(s),0,255))+le(Math.floor(t),0,255)}Wn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,cr(Wn,"SegmentVector");const dn=pn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),pf=pn([{name:"a_pattern_b",components:4,type:"Uint16"}]),bg=pn([{name:"a_dash",components:4,type:"Uint16"}]);class mf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,o,c,d){this.ids.push(_p(t)),this.positions.push(o,c,d)}eachPosition(t,o){const c=_p(t);let d=0,m=this.ids.length-1;for(;d<m;){const g=d+m>>1;this.ids[g]>=c?m=g:d=g+1}for(;this.ids[d]===c;)o(this.positions[3*d],this.positions[3*d+1],this.positions[3*d+2]),d++}static serialize(t,o){const c=new Float64Array(t.ids),d=new Uint32Array(t.positions);return dh(c,d,0,c.length-1),o&&(o.add(c.buffer),o.add(d.buffer)),{ids:c,positions:d}}static deserialize(t){const o=new mf;let c;o.ids=t.ids,o.positions=t.positions;for(const d of o.ids)d!==c&&o.uniqueIds.push(d),c=d;return o.indexed=!0,o}}function _p(s){const t=+s;return Number.isSafeInteger(t)?t:Oi(String(s))}function dh(s,t,o,c){for(;o<c;){const d=s[o+c>>1];let m=o-1,g=c+1;for(;;){do m++;while(s[m]<d);do g--;while(s[g]>d);if(m>=g)break;hh(s,m,g),hh(t,3*m,3*g),hh(t,3*m+1,3*g+1),hh(t,3*m+2,3*g+2)}g-o<c-g?(dh(s,t,o,g),o=g+1):(dh(s,t,g+1,c),c=g)}}function hh(s,t,o){const c=s[t];s[t]=s[o],s[o]=c}cr(mf,"FeaturePositionMap");class bl{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,o),this.initialized=!0),!!this.location}set(t,o,c){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class yp extends bl{constructor(t){super(t),this.current=0}set(t,o,c){this.fetchUniformLocation(t,o)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class xo extends bl{constructor(t){super(t),this.current=0}set(t,o,c){this.fetchUniformLocation(t,o)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class qc extends bl{constructor(t){super(t),this.current=[0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class wd extends bl{constructor(t){super(t),this.current=[0,0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class fh extends bl{constructor(t){super(t),this.current=[0,0,0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class Xs extends bl{constructor(t){super(t),this.current=zn.transparent.toPremultipliedRenderColor(null)}set(t,o,c){this.fetchUniformLocation(t,o)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const vc=new Float32Array(16);class xc extends bl{constructor(t){super(t),this.current=vc}set(t,o,c){if(this.fetchUniformLocation(t,o)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let d=1;d<16;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const A_=new Float32Array(9),wg=new Float32Array(4);class Yl extends bl{constructor(t){super(t),this.current=wg}set(t,o,c){if(this.fetchUniformLocation(t,o)){for(let d=0;d<4;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function vm(s){return[C_(255*s.r,255*s.g),C_(255*s.b,255*s.a)]}function Zl(s,t,o,c,d,m,g,b){return!!s&&(s.kind==="composite"||s.kind==="source"?s.evaluate(new mi(0,{brightness:m,worldview:b}),t,o,d,c,g)==="none":s.value==="none")}class xm{constructor(t,o,c,d){this.value=t,this.uniformNames=o.map((m=>`u_${m}`)),this.type=c,this.context=d}setUniform(t,o,c,d,m){const g=d.constantOr(this.value);o.set(t,m,g instanceof zn?g.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.kind==="constant"&&this.lutExpression.value==="none"?null:this.context.lut):g)}getBinding(t,o){return this.type==="color"?new Xs(t):new xo(t)}}class gf{constructor(t,o){this.uniformNames=o.map((c=>`u_${c}`)),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(t,o){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br),this.patternTransition=o?o.tl.concat(o.br):this.pattern}setUniform(t,o,c,d,m){let g=null;m!=="u_pattern"&&m!=="u_dash"||(g=this.pattern),m==="u_pattern_b"&&(g=this.patternTransition),m==="u_pixel_ratio"&&(g=this.pixelRatio),g&&o.set(t,m,g)}getBinding(t,o){return o==="u_pattern"||o==="u_pattern_b"||o==="u_dash"?new fh(t):new xo(t)}}class yu{constructor(t,o,c,d){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map((m=>({name:`a_${m}`,type:"Float32",components:c==="color"?2:1,offset:0}))),this.paintVertexArray=new d}populatePaintArray(t,o,c,d,m,g,b,P){const I=this.paintVertexArray.length,O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new mi(0,{brightness:g,worldview:P}),o,{},m,d,b):this.expression.kind==="constant"&&this.expression.value,L=Zl(this.lutExpression,o,{},d,m,g,b,P);this.paintVertexArray.resize(t),this._setPaintValue(I,t,O,L?null:this.context.lut)}updatePaintArray(t,o,c,d,m,g,b,P){const I=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:b,worldview:P},c,d,void 0,m):this.expression.kind==="constant"&&this.expression.value,O=Zl(this.lutExpression,c,d,m,void 0,b,void 0,P);this._setPaintValue(t,o,I,O?null:this.context.lut)}_setPaintValue(t,o,c,d){if(this.type==="color"){const m=vm(c.toPremultipliedRenderColor(d));for(let g=t;g<o;g++)this.paintVertexArray.emplace(g,m[0],m[1])}else{for(let m=t;m<o;m++)this.paintVertexArray.emplace(m,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bc{constructor(t,o,c,d,m,g){this.expression=t,this.uniformNames=o.map((b=>`u_${b}_t`)),this.type=c,this.useIntegerZoom=d,this.context=m,this.maxValue=0,this.paintVertexAttributes=o.map((b=>({name:`a_${b}`,type:"Float32",components:c==="color"?4:2,offset:0}))),this.paintVertexArray=new g}populatePaintArray(t,o,c,d,m,g,b,P){const I=this.expression.evaluate(new mi(this.context.zoom,{brightness:g,worldview:P}),o,{},m,d,b),O=this.expression.evaluate(new mi(this.context.zoom+1,{brightness:g,worldview:P}),o,{},m,d,b),L=Zl(this.lutExpression,o,{},d,m,g,b,P),k=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(k,t,I,O,L?null:this.context.lut)}updatePaintArray(t,o,c,d,m,g,b,P){const I=this.expression.evaluate({zoom:this.context.zoom,brightness:b,worldview:P},c,d,void 0,m),O=this.expression.evaluate({zoom:this.context.zoom+1,brightness:b,worldview:P},c,d,void 0,m),L=Zl(this.lutExpression,c,d,m,void 0,b,void 0,P);this._setPaintValue(t,o,I,O,L?null:this.context.lut)}_setPaintValue(t,o,c,d,m){if(this.type==="color"){const g=vm(c.toPremultipliedRenderColor(m)),b=vm(c.toPremultipliedRenderColor(m));for(let P=t;P<o;P++)this.paintVertexArray.emplace(P,g[0],g[1],b[0],b[1])}else{for(let g=t;g<o;g++)this.paintVertexArray.emplace(g,c,d);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o,c,d,m){const g=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,b=le(this.expression.interpolationFactor(g,this.context.zoom,this.context.zoom+1),0,1);o.set(t,m,b)}getBinding(t,o){return new xo(t)}}class Ks{constructor(t,o,c,d,m){this.expression=t,this.layerId=m,this.paintVertexAttributes=(c==="array"?bg:dn).members;for(let g=0;g<o.length;++g);this.paintVertexArray=new d,this.paintTransitionVertexArray=new Uu}populatePaintArray(t,o,c,d){const m=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(m,t,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(t,o,c,d,m,g,b){this._setPaintValues(t,o,c.patterns&&c.patterns[this.layerId],g)}_setPaintValues(t,o,c,d){if(!d||!c)return;const m=d[c[0]],g=d[c[1]];if(m){if(m){const{tl:b,br:P,pixelRatio:I}=m;for(let O=t;O<o;O++)this.paintVertexArray.emplace(O,b[0],b[1],P[0],P[1],I)}if(g){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:b,br:P}=g;for(let I=t;I<o;I++)this.paintTransitionVertexArray.emplace(I,b[0],b[1],P[0],P[1])}}}upload(t){const o=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,o)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=t.createVertexBuffer(this.paintTransitionVertexArray,pf.members,o))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class qu{constructor(t,o,c=(()=>!0)){this.binders={},this._buffers=[],this.context=o;const d=[];for(const m in t.paint._values){const g=t.paint.get(m);if(m.endsWith("-use-theme")||!c(m)||!(g instanceof ns&&Kp(g.property.specification)))continue;const b=wc(m,t.type),P=g.value,I=g.property.specification.type,O=!!g.property.useIntegerZoom,L=m==="line-dasharray"||m.endsWith("pattern"),k=t.paint.get(`${m}-use-theme`),$=m==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant"||k&&k.value.kind!=="constant";if(P.kind!=="constant"||$)if(P.kind==="source"||$||L){const W=as(m,I,"source");this.binders[m]=L?new Ks(P,b,I,W,t.id):new yu(P,b,I,W),d.push(`/a_${m}`)}else{const W=as(m,I,"composite");this.binders[m]=new bc(P,b,I,O,o,W),d.push(`/z_${m}`)}else this.binders[m]=L?new gf(P.value,b):new xm(P.value,b,I,o),d.push(`/u_${m}`);k&&(this.binders[m].lutExpression=k.value)}this.cacheKey=d.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof yu||o instanceof bc?o.maxValue:0}populatePaintArrays(t,o,c,d,m,g,b,P){for(const I in this.binders){const O=this.binders[I];O.context=this.context,(O instanceof yu||O instanceof bc||O instanceof Ks)&&O.populatePaintArray(t,o,c,d,m,g,b,P)}}setConstantPatternPositions(t,o){for(const c in this.binders){const d=this.binders[c];d instanceof gf&&d.setConstantPatternPositions(t,o)}}getPatternTransitionVertexBuffer(t){const o=this.binders[t];return o instanceof Ks?o.paintTransitionVertexBuffer:null}updatePaintArrays(t,o,c,d,m,g,b,P,I,O){let L=!1;const k=Object.keys(t),$=k.length!==0&&!P,W=$?k:o.uniqueIds;this.context.lut=m.lut;for(const Q in this.binders){const te=this.binders[Q];if(te.context=this.context,(te instanceof yu||te instanceof bc||te instanceof Ks)&&te.expression&&te.expression.kind&&te.expression.kind!=="constant"&&(te.expression.isStateDependent===!0||te.expression.isLightConstant===!1)){const ne=m.paint.get(Q);te.expression=ne.value;for(const ue of W){const he=t[ue.toString()];o.eachPosition(ue,((me,Ae,Pe)=>{const Fe=d.feature(me);te.updatePaintArray(Ae,Pe,Fe,he,g,b,I,O)}))}if(!$)for(const ue of c.uniqueIds){const he=t[ue.toString()];c.eachPosition(ue,((me,Ae,Pe)=>{const Fe=d.feature(me);te.updatePaintArray(Ae,Pe,Fe,he,g,b,I,O)}))}L=!0}}return L}defines(){const t=[];for(const o in this.binders){const c=this.binders[o];(c instanceof xm||c instanceof gf)&&t.push(...c.uniformNames.map((d=>`#define HAS_UNIFORM_${d}`)))}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const o=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof xm||d instanceof gf||d instanceof bc)for(const m of d.uniformNames)o.push({name:m,property:c,binding:d.getBinding(t,m)})}return o}setUniforms(t,o,c,d,m){for(const{name:g,property:b,binding:P}of c)this.binders[b].setUniform(t,P,m,d.get(b),g)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const o=this.binders[t];(o instanceof yu||o instanceof bc||o instanceof Ks)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer),o instanceof Ks&&o.paintTransitionVertexBuffer&&this._buffers.push(o.paintTransitionVertexBuffer)}}upload(t){for(const o in this.binders){const c=this.binders[o];(c instanceof yu||c instanceof bc||c instanceof Ks)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof yu||o instanceof bc||o instanceof Ks)&&o.destroy()}}}class wl{constructor(t,o,c=(()=>!0)){this.programConfigurations={};for(const d of t)this.programConfigurations[d.id]=new qu(d,o,c);this.needsUpload=!1,this._featureMap=new mf,this._featureMapWithoutIds=new mf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,o,c,d,m,g,b,P,I){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(t,o,d,m,g,b,P,I);o.id!==void 0?this._featureMap.add(o.id,c,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,c,d,m,g,b,P){for(const I of c)this.needsUpload=this.programConfigurations[I.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,o,I,d,m,g,b||0,P)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Sg={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function wc(s,t){return Sg[s]||[s.replace(`${t}-`,"").replace(/-/g,"_")]}const Ki={"line-pattern":{source:Gl,composite:Gl},"fill-pattern":{source:Gl,composite:Gl},"fill-extrusion-pattern":{source:Gl,composite:Gl},"line-dasharray":{source:Uu,composite:Uu}},ha={color:{source:Wu,composite:$u},number:{source:Wc,composite:Wu}};function as(s,t,o){const c=Ki[s];return c&&c[o]||ha[t][o]}cr(xm,"ConstantBinder"),cr(gf,"PatternConstantBinder"),cr(yu,"SourceExpressionBinder"),cr(Ks,"PatternCompositeBinder"),cr(bc,"CompositeExpressionBinder"),cr(qu,"ProgramConfiguration",{omit:["_buffers"]}),cr(wl,"ProgramConfigurationSet");const oo=Ut/Math.PI/2,h=5,n=6,l=16383,f=64,v=[f,32,16],w=-oo,E=oo;function M(s,t,o,c=oo){return o=vn(o),[s*Math.sin(o)*c,-t*c,s*Math.cos(o)*c]}function D(s,t,o){return M(Math.cos(vn(s)),Math.sin(vn(s)),t,o)}const B=63710088e-1,j=2*Math.PI*B;class q{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new q(Oe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,c=this.lat*o,d=t.lat*o,m=Math.sin(c)*Math.sin(d)+Math.cos(c)*Math.cos(d)*Math.cos((t.lng-this.lng)*o);return B*Math.acos(Math.min(m,1))}toBounds(t=0){const o=360*t/40075017,c=o/Math.cos(Math.PI/180*this.lat);return new U({lng:this.lng-c,lat:this.lat-o},{lng:this.lng+c,lat:this.lat+o})}toEcef(t){return D(this.lat,this.lng,oo+t*oo/B)}static convert(t){if(t instanceof q)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new q(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new q(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class U{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof q?new q(t.lng,t.lat):q.convert(t),this}setSouthWest(t){return this._sw=t instanceof q?new q(t.lng,t.lat):q.convert(t),this}extend(t){const o=this._sw,c=this._ne;let d,m;if(t instanceof q)d=t,m=t;else{if(!(t instanceof U))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(U.convert(t)):this.extend(q.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(q.convert(t)):this;if(d=t._sw,m=t._ne,!d||!m)return this}return o||c?(o.lng=Math.min(d.lng,o.lng),o.lat=Math.min(d.lat,o.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new q(d.lng,d.lat),this._ne=new q(m.lng,m.lat)),this}getCenter(){return new q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new q(this.getWest(),this.getNorth())}getSouthEast(){return new q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:c}=q.convert(t);let d=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(t){if(t)return t instanceof U?t:new U(t)}}const Y=0,ee=25.5;function re(s){return j*Math.cos(s*Math.PI/180)}function ce(s){return(180+s)/360}function ae(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function de(s,t){return s/re(t)}function ye(s){return 360*s-180}function fe(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Me(s,t){return s*re(fe(t))}const xe=85.051129;function Ce(s){return Math.cos(vn(le(s,-xe,xe)))}function Te(s,t){const o=le(t,Y,ee),c=Math.pow(2,o);return Ce(s)*j/(512*c)}function be(s){return 1/Math.cos(s*Math.PI/180)}function De(s,t=0){const o=Math.exp(Math.PI*(1-(s.y+t/Ut)/(1<<s.z)*2));return 80150034*o/(o*o+1)/Ut/(1<<s.z)}class He{constructor(t,o,c=0){this.x=+t,this.y=+o,this.z=+c}static fromLngLat(t,o=0){const c=q.convert(t);return new He(ce(c.lng),ae(c.lat),de(o,c.lat))}toLngLat(){return new q(ye(this.x),fe(this.y))}toAltitude(){return Me(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/j*be(fe(this.y))}}function $e(s,t,o,c,d,m,g,b,P){const I=(t+c)/2,O=(o+d)/2,L=new St(I,O);b(L),(function(k,$,W,Q,te,ne){const ue=W-te,he=Q-ne;return Math.abs((Q-$)*ue-(W-k)*he)/Math.hypot(ue,he)})(L.x,L.y,m.x,m.y,g.x,g.y)>=P?($e(s,t,o,I,O,m,L,b,P),$e(s,I,O,c,d,L,g,b,P)):s.push(g)}function st(s,t,o){let c=s[0],d=c.x,m=c.y;t(c);const g=[c];for(let b=1;b<s.length;b++){const P=s[b],{x:I,y:O}=P;t(P),$e(g,d,m,I,O,c,P,t,o),d=I,m=O,c=P}return g}function Qe(s,t,o,c){if(c(t,o)){const d=t.add(o)._mult(.5);Qe(s,t,d,c),Qe(s,d,o,c)}else s.push(o)}function pt(s,t){let o=s[0];const c=[o];for(let d=1;d<s.length;d++){const m=s[d];Qe(c,o,m,t),o=m}return c}const Ft=Math.pow(2,14)-1,Xe=-Ft-1;function je(s,t){const o=Math.round(s.x*t),c=Math.round(s.y*t);return s.x=le(o,Xe,Ft),s.y=le(c,Xe,Ft),(o<s.x||o>s.x+1||c<s.y||c>s.y+1)&&Cr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function dt(s,t,o){const c=s.loadGeometry(),d=s.extent,m=Ut/d;if(t&&o&&o.projection.isReprojectedInTileSpace){const g=1<<t.z,{scale:b,x:P,y:I,projection:O}=o,L=k=>{const $=ye((t.x+k.x/d)/g),W=fe((t.y+k.y/d)/g),Q=O.project($,W);k.x=(Q.x*b-P)*d,k.y=(Q.y*b-I)*d};for(let k=0;k<c.length;k++)if(s.type!==1)c[k]=st(c[k],L,1);else{const $=[];for(const W of c[k])W.x<0||W.x>=d||W.y<0||W.y>=d||(L(W),$.push(W));c[k]=$}}for(const g of c)for(const b of g)je(b,m);return c}function rt(s,t){return{type:s.type,id:s.id,properties:s.properties,geometry:t?dt(s):[]}}class Mt{constructor(t,o,c,d,m){this.properties={},this.extent=c,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=d,this._values=m,t.readFields($t,this,o)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const o=t.readVarint()+t.pos,c=[];let d,m=1,g=0,b=0,P=0;for(;t.pos<o;){if(g<=0){const I=t.readVarint();m=7&I,g=I>>3}if(g--,m===1||m===2)b+=t.readSVarint(),P+=t.readSVarint(),m===1&&(d&&c.push(d),d=[]),d&&d.push(new St(b,P));else{if(m!==7)throw new Error(`unknown command ${m}`);d&&d.push(d[0].clone())}}return d&&c.push(d),c}bbox(){const t=this._pbf;t.pos=this._geometry;const o=t.readVarint()+t.pos;let c=1,d=0,m=0,g=0,b=1/0,P=-1/0,I=1/0,O=-1/0;for(;t.pos<o;){if(d<=0){const L=t.readVarint();c=7&L,d=L>>3}if(d--,c===1||c===2)m+=t.readSVarint(),g+=t.readSVarint(),m<b&&(b=m),m>P&&(P=m),g<I&&(I=g),g>O&&(O=g);else if(c!==7)throw new Error(`unknown command ${c}`)}return[b,I,P,O]}toGeoJSON(t,o,c){const d=this.extent*Math.pow(2,c),m=this.extent*t,g=this.extent*o,b=this.loadGeometry();function P(k){return[360*(k.x+m)/d-180,360/Math.PI*Math.atan(Math.exp((1-2*(k.y+g)/d)*Math.PI))-90]}function I(k){return k.map(P)}let O;if(this.type===1){const k=[];for(const W of b)k.push(W[0]);const $=I(k);O=k.length===1?{type:"Point",coordinates:$[0]}:{type:"MultiPoint",coordinates:$}}else if(this.type===2){const k=b.map(I);O=k.length===1?{type:"LineString",coordinates:k[0]}:{type:"MultiLineString",coordinates:k}}else{if(this.type!==3)throw new Error("unknown feature type");{const k=(function(W){const Q=W.length;if(Q<=1)return[W];const te=[];let ne,ue;for(let he=0;he<Q;he++){const me=fr(W[he]);me!==0&&(ue===void 0&&(ue=me<0),ue===me<0?(ne&&te.push(ne),ne=[W[he]]):ne&&ne.push(W[he]))}return ne&&te.push(ne),te})(b),$=[];for(const W of k)$.push(W.map(I));O=$.length===1?{type:"Polygon",coordinates:$[0]}:{type:"MultiPolygon",coordinates:$}}}const L={type:"Feature",geometry:O,properties:this.properties};return this.id!=null&&(L.id=this.id),L}}function $t(s,t,o){s===1?t.id=o.readVarint():s===2?(function(c,d){const m=c.readVarint()+c.pos;for(;c.pos<m;){const g=d._keys[c.readVarint()],b=d._values[c.readVarint()];d.properties[g]=b}})(o,t):s===3?t.type=o.readVarint():s===4&&(t._geometry=o.pos)}function fr(s){let t=0;for(let o,c,d=0,m=s.length,g=m-1;d<m;g=d++)o=s[d],c=s[g],t+=(c.x-o.x)*(o.y+c.y);return t}Mt.types=["Unknown","Point","LineString","Polygon"];class kt{constructor(t,o){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Nt,this,o),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const o=this._pbf.readVarint()+this._pbf.pos;return new Mt(this._pbf,o,this.extent,this._keys,this._values)}}function Nt(s,t,o){s===15?t.version=o.readVarint():s===1?t.name=o.readString():s===5?t.extent=o.readVarint():s===2?t._features.push(o.pos):s===3?t._keys.push(o.readString()):s===4&&t._values.push((function(c){let d=null;const m=c.readVarint()+c.pos;for(;c.pos<m;){const g=c.readVarint()>>3;d=g===1?c.readString():g===2?c.readFloat():g===3?c.readDouble():g===4?c.readVarint64():g===5?c.readVarint():g===6?c.readSVarint():g===7?c.readBoolean():null}if(d==null)throw new Error("unknown feature value");return d})(o))}class mr{constructor(t,o){this.layers=t.readFields(lr,{},o)}}function lr(s,t,o){if(s===3){const c=new kt(o,o.readVarint()+o.pos);c.length&&(t[c.name]=c)}}const Qt="3d_elevation_id",ur="level";class Dr{constructor(){this._valid=!1}reset(t){return this.feature=t,this._valid=!0,this._geometry=t.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(t,o){return this._valid&&t(o(this._geometry)),this}require(t,o,c){return this.get(t,!0,o,c)}optional(t,o,c){return this.get(t,!1,o,c)}success(){return this._valid}get(t,o,c,d){const m=this.feature.properties.hasOwnProperty(t)?+this.feature.properties[t]:void 0;return this._valid&&m!==void 0&&!Number.isNaN(m)?c(d?d(m):m):o&&(this._valid=!1),this}}class _n{constructor(t,o){this.featureFunc=t,this.vertexFunc=o}parseFeature(t,o,c){return this.featureFunc(t,o,c)}parseVertex(t,o,c){return this.vertexFunc(t,o,c)}}const Kr=new _n(((s,t,o)=>s.reset(t).require(Qt,(c=>{o.id=c})).optional("fixed_height_relative",(c=>{o.constantHeight=c}),Wr.decodeRelativeHeight).geometry((c=>{o.bounds=c}),Fl).success()),((s,t,o)=>s.reset(t).require(Qt,(c=>{o.id=c})).require("elevation_idx",(c=>{o.idx=c})).require("extent",(c=>{o.extent=c})).require("height_relative",(c=>{o.height=c}),Wr.decodeRelativeHeight).geometry((c=>{o.position=c}),Wr.getPoint).success())),hi=new _n(((s,t,o)=>s.reset(t).require(Qt,(c=>{o.id=c})).optional("fixed_height",(c=>{o.constantHeight=c}),Wr.decodeMetricHeight).geometry((c=>{o.bounds=c}),Fl).success()),((s,t,o)=>s.reset(t).require(Qt,(c=>{o.id=c})).require("elevation_idx",(c=>{o.idx=c})).require("extent",(c=>{o.extent=c})).require("height",(c=>{o.height=c}),Wr.decodeMetricHeight).geometry((c=>{o.position=c}),Wr.getPoint).success()));class Wr{static getPoint(t){return js(t[0][0].x,t[0][0].y)}static decodeRelativeHeight(t){return 1e-4*t*5}static decodeMetricHeight(t){return 1e-4*t}static getVersionSchema(t){return t?t==="1.0.1"?hi:void 0:Kr}static parse(t){const o=[],c=[],d=t.length,m=new Dr;for(let g=0;g<d;g++){const b=t.feature(g),P=b.properties.version,I=Wr.getVersionSchema(P);if(I===void 0){Cr(`Unknown elevation feature version number ${P||"(unknown)"}`);continue}const O=b.properties.type;if(!O)continue;const L=Mt.types[b.type];if(L==="Point"&&O==="curve_point"){const k={};I.parseVertex(m,b,k)&&o.push(k)}else if(L==="Polygon"&&O==="curve_meta"){const k={};I.parseFeature(m,b,k)&&c.push(k)}}return{vertices:o,features:c}}}class Sn{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,c){const d=ia(o,this.dir);if(Math.abs(d)<1e-6)return!1;const m=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1])/d;return c[0]=this.pos[0]+this.dir[0]*m,c[1]=this.pos[1]+this.dir[1]*m,!0}}class sn{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,c){const d=Br(o,this.dir);if(Math.abs(d)<1e-6)return!1;const m=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1]+(t[2]-this.pos[2])*o[2])/d;return c[0]=this.pos[0]+this.dir[0]*m,c[1]=this.pos[1]+this.dir[1]*m,c[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(t,o,c){if((function($,W){var Q=$[0],te=$[1],ne=$[2],ue=W[0],he=W[1],me=W[2];return Math.abs(Q-ue)<=C*Math.max(1,Math.abs(Q),Math.abs(ue))&&Math.abs(te-he)<=C*Math.max(1,Math.abs(te),Math.abs(he))&&Math.abs(ne-me)<=C*Math.max(1,Math.abs(ne),Math.abs(me))})(this.pos,t)||o===0)return c[0]=c[1]=c[2]=0,!1;const[d,m,g]=this.dir,b=this.pos[0]-t[0],P=this.pos[1]-t[1],I=this.pos[2]-t[2],O=d*d+m*m+g*g,L=2*(b*d+P*m+I*g),k=L*L-4*O*(b*b+P*P+I*I-o*o);if(k<0){const $=Math.max(-L/2,0),W=b+d*$,Q=P+m*$,te=I+g*$,ne=Math.hypot(W,Q,te);return c[0]=W*o/ne,c[1]=Q*o/ne,c[2]=te*o/ne,!1}{const $=(-L-Math.sqrt(k))/(2*O);if($<0){const W=Math.hypot(b,P,I);return c[0]=b*o/W,c[1]=P*o/W,c[2]=I*o/W,!1}return c[0]=b+d*$,c[1]=P+m*$,c[2]=I+g*$,!0}}}class ti{constructor(t,o,c,d,m){this.TL=t,this.TR=o,this.BR=c,this.BL=d,this.horizon=m}static fromInvProjectionMatrix(t,o,c){const d=[-1,1,1],m=[1,1,1],g=[1,-1,1],b=[-1,-1,1],P=Yr(d,d,t),I=Yr(m,m,t),O=Yr(g,g,t),L=Yr(b,b,t);return new ti(P,I,O,L,o/c)}}function Tn(s,t,o){let c=1/0,d=-1/0;const m=[];for(const g of s){Xn(m,g,t);const b=Br(m,o);c=Math.min(c,b),d=Math.max(d,b)}return[c,d]}function vi(s,t){let o=!0;for(let c=0;c<s.planes.length;c++){const d=s.planes[c];let m=0;for(let g=0;g<t.length;g++)m+=+(Br(d,t[g])+d[3]>=0);if(m===0)return 0;m!==t.length&&(o=!1)}return o?2:1}function yn(s,t){for(const o of s.projections){const c=Tn(t,s.points[0],o.axis);if(o.projection[1]<c[0]||o.projection[0]>c[1])return 0}return 1}function nn(s,t){let o=0;const c=[0,0,0,0];for(let g=0;g<s.length;g++)c[0]=s[g][0],c[1]=s[g][1],c[2]=s[g][2],c[3]=1,(d=c)[0]*(m=t)[0]+d[1]*m[1]+d[2]*m[2]+d[3]*m[3]>=0&&o++;var d,m;return o}class qn{constructor(t,o){this.points=t||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=Jr.fromPoints(this.points),this.projections=[],this.frustumEdges=[Xn([],this.points[2],this.points[3]),Xn([],this.points[0],this.points[3]),Xn([],this.points[4],this.points[0]),Xn([],this.points[5],this.points[1]),Xn([],this.points[6],this.points[2]),Xn([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const d=[0,-c[2],c[1]],m=[c[2],0,-c[0]];this.projections.push({axis:d,projection:Tn(this.points,this.points[0],d)}),this.projections.push({axis:m,projection:Tn(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(t,o,c,d){const m=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((I=>{const O=Bo([],I,t),L=1/O[3]/o*m;return(k=O)[0]=($=O)[0]*(W=[L,L,d?1/O[3]:L,L])[0],k[1]=$[1]*W[1],k[2]=$[2]*W[2],k[3]=$[3]*W[3],k;var k,$,W})),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((I=>{const O=sr([],hn([],Xn([],g[I[0]],g[I[1]]),Xn([],g[I[2]],g[I[1]]))),L=-Br(O,g[I[1]]);return O.concat(L)})),P=[];for(let I=0;I<g.length;I++)P.push([g[I][0],g[I][1],g[I][2]]);return new qn(P,b)}intersectsPrecise(t,o,c){for(let d=0;d<o.length;d++)if(!nn(t,o[d]))return 0;for(let d=0;d<this.planes.length;d++)if(!nn(t,this.planes[d]))return 0;for(const d of c)for(const m of this.frustumEdges){const g=hn([],d,m),b=Or(g);if(b===0)continue;_t(g,g,1/b);const P=Tn(this.points,this.points[0],g),I=Tn(t,this.points[0],g);if(P[0]>I[1]||I[0]>P[1])return 0}return 1}containsPoint(t){for(const o of this.planes){const c=o[3];if(Br([o[0],o[1],o[2]],t)+c<0)return!1}return!0}}class Jr{static fromPoints(t){const o=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const d of t)tt(o,o,d),ct(c,c,d);return new Jr(o,c)}static fromTileIdAndHeight(t,o,c){const d=1<<t.canonical.z,m=t.canonical.x,g=t.canonical.y;return new Jr([m/d,g/d,o],[(m+1)/d,(g+1)/d,c])}static applyTransform(t,o){const c=t.getCorners();for(let d=0;d<c.length;++d)Yr(c[d],c[d],o);return Jr.fromPoints(c)}static applyTransformFast(t,o){const c=[o[12],o[13],o[14]],d=[...c];for(let m=0;m<3;m++)for(let g=0;g<3;g++){const b=o[4*g+m],P=b*t.min[g],I=b*t.max[g];c[m]+=Math.min(P,I),d[m]+=Math.max(P,I)}return new Jr(c,d)}static projectAabbCorners(t,o){const c=t.getCorners();for(let d=0;d<c.length;++d)Yr(c[d],c[d],o);return c}constructor(t,o){this.min=t,this.max=o,this.center=_t([],Et([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],c=Fr(this.min),d=Fr(this.max);for(let m=0;m<o.length;m++)c[m]=o[m]?this.min[m]:this.center[m],d[m]=o[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new Jr(c,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,o=this.max;return[[t[0],t[1],t[2]],[o[0],t[1],t[2]],[o[0],o[1],t[2]],[t[0],o[1],t[2]],[t[0],t[1],o[2]],[o[0],t[1],o[2]],[o[0],o[1],o[2]],[t[0],o[1],o[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?vi(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?vi(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,o){return o||this.intersects(t)?yn(t,this.getCorners()):0}intersectsPreciseFlat(t,o){return o||this.intersectsFlat(t)?yn(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let o=0;o<3;++o)if(this.min[o]>t.max[o]||t.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t.min[o]),this.max[o]=Math.max(this.max[o],t.max[o])}encapsulatePoint(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t[o]),this.max[o]=Math.max(this.max[o],t[o])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}cr(Jr,"Aabb");class xi{constructor(t,o){this.feature=t,this.metersToTile=o,this.index=0}get(){const t=this.feature.vertices[this.index],o=this.feature.vertexProps[this.index].dir,c=o[1],d=-o[0],m=(t.extent+1)*this.metersToTile;return[new St(Math.trunc(t.position[0]+c*m),Math.trunc(t.position[1]+d*m)),new St(Math.trunc(t.position[0]-c*m),Math.trunc(t.position[1]-d*m))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class Pn{constructor(t,o,c,d,m,g){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this._tmpVec2=[io(),io(),io(),io(),io(),io(),io()],this.id=t,this.heightRange={min:c,max:c},this.safeArea=o,this.constantHeight=c,this.constantHeight==null&&(this.constantHeight!=null||d.length!==0)){this.vertices=d,this.edges=m,this.edges=this.edges.filter((b=>{return b.a<this.vertices.length&&b.b<this.vertices.length&&!((P=this.vertices[b.a].position)[0]===(I=this.vertices[b.b].position)[0]&&P[1]===I[1]);var P,I})),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const b of this.vertices)this.vertexProps.push({dir:js(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,b.height),this.heightRange.max=Math.max(this.heightRange.max,b.height);for(const b of this.edges){const P=this.vertices[b.a].position,I=this.vertices[b.b].position,O=Ps(io(),I,P),L=_i(O),k=Is(io(),O,1/L);this.edgeProps.push({vec:O,dir:k,len:L});const $=this.vertexProps[b.a].dir,W=this.vertexProps[b.b].dir;wa($,$,k),wa(W,W,k)}for(const b of this.vertexProps)b.dir[0]===0&&b.dir[1]===0||Zi(b.dir,b.dir);this.tessellate(g)}}pointElevation(t){if(this.constantHeight!=null)return this.constantHeight;const o=this.getClosestEdge(t);if(o==null)return 0;const[c,d]=o;return Lr(this.vertices[this.edges[c].a].height,this.vertices[this.edges[c].b].height,d)}computeSlopeNormal(t,o){const c=this.getClosestEdge(t);if(!c)return or(0,0,1);const d=c[0],m=this.edges[d],g=this.edgeProps[d].vec,b=or(g[0],g[1],(this.vertices[m.b].height-this.vertices[m.a].height)*o),P=or(b[1],-b[0],0);hn(P,P,b);const I=Or(P);return I>0?_t(P,P,1/I):lt(P,0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(t){if(this.edges.length===0)return;let o=0,c=Number.POSITIVE_INFINITY,d=0;const[m,g,b,P,I,O,L]=this._tmpVec2;ba(L,t.x,t.y);const k=new Sn(L,null);for(let $=0;$<this.edges.length;$++){const W=this.edges[$],Q=this.edgeProps[$].dir;k.dir=Q;const te=this.vertices[W.a].position,ne=this.vertices[W.b].position,ue=k.intersectsPlane(te,this.vertexProps[W.a].dir,m),he=k.intersectsPlane(ne,this.vertexProps[W.b].dir,g);if(!ue||!he)continue;Ps(b,g,m),Ps(P,L,m);const me=ia(b,b),Ae=me>0?ia(P,b)/me:0,Pe=le(Ae,0,1),Fe=Math.abs((Ae-Pe)*this.edgeProps[$].len);Ps(I,L,te),ba(O,Q[1],-Q[0]);const Be=Fe+Math.abs(ia(I,O));Be<c&&(o=$,c=Be,d=Pe)}return[o,d]}tessellate(t){const o=nr(),c=nr(),d=nr(),m=nr();for(let g=this.edges.length-1;g>=0;--g){const b=this.edges[g].a,P=this.edges[g].b,{position:I,height:O,extent:L}=this.vertices[b],{position:k,height:$,extent:W}=this.vertices[P],Q=this.vertexProps[b].dir,te=this.vertexProps[P].dir;if(lt(o,I[0]/t,I[1]/t,O),lt(c,k[0]/t,k[1]/t,$),lt(d,Q[1],-Q[0],0),_t(d,d,L),lt(m,te[1],-te[0],0),_t(m,m,W),this.distSqLines(or(o[0]+.5*d[0],o[1]+.5*d[1],o[2]+.5*d[2]),or(c[0]-.5*m[0],c[1]-.5*m[1],c[2]-.5*m[2]),or(o[0]-.5*d[0],o[1]-.5*d[1],o[2]-.5*d[2]),or(c[0]+.5*m[0],c[1]+.5*m[1],c[2]+.5*m[2]))<=.0025000000000000005)continue;const ne=this.vertices.length,ue=wa(io(),I,k);this.vertices.push({position:Is(ue,ue,.5),height:.5*(O+$),extent:.5*(L+W)});const he=wa(io(),Q,te);this.vertexProps.push({dir:Zi(he,he)}),this.edges.splice(g,1),this.edgeProps.splice(g,1),this.edges.push({a:b,b:ne}),this.edges.push({a:ne,b:P});const me=Ps(io(),this.vertices[ne].position,I),Ae=_i(me),Pe={vec:me,dir:Is(io(),me,1/Ae),len:Ae};this.edgeProps.push(Pe),this.edgeProps.push(Pe)}}distSqLines(t,o,c,d){const m=qt(nr(),o,t),g=qt(nr(),d,c),b=qt(nr(),t,c),P=Br(m,m),I=Br(m,g),O=Br(m,b),L=Br(g,g),k=Br(g,b),$=P*L-I*I;if($===0)return ar(Vn(m,c,d,Br(b,g)/Br(g,g)),t);const W=(P*k-I*O)/$;return ar(Vn(m,t,o,(I*k-O*L)/$),Vn(g,c,d,W))}}class qr{static parseFrom(t,o){const c=Wr.parse(t);if(!c)return[];let{vertices:d,features:m}=c;const g=1/De(o);m.sort(((O,L)=>O.id-L.id)),d.sort(((O,L)=>O.id-L.id||O.idx-L.idx)),d=d.filter(((O,L,k)=>L===k.findIndex(($=>$.id===O.id&&$.idx===O.idx))));const b=new Array;let P=0;const I=d.length;for(const O of m){if(O.constantHeight){b.push(new Pn(O.id,O.bounds,O.constantHeight));continue}for(;P!==I&&d[P].id<O.id;)P++;if(P===I||d[P].id!==O.id)continue;const L=new Array,k=new Array,$=P;for(;P!==I&&d[P].id===O.id;){const W=d[P];if(L.push({position:W.position,height:W.height,extent:W.extent}),P!==$&&d[P-1].idx===W.idx-1){const Q=P-$;k.push({a:Q-1,b:Q})}P++}b.push(new Pn(O.id,O.bounds,void 0,L,k,g))}return b}static getElevationFeature(t,o){if(!o)return;const c=+t.properties[Qt];return Number.isNaN(c)?void 0:o.find((d=>d.id===c))}}class En{constructor(t,o){this.zScale=1,this.xOffset=0,this.yOffset=0,t.equals(o)||(this.zScale=Math.pow(2,o.z-t.z),this.xOffset=(t.x*this.zScale-o.x)*Ut,this.yOffset=(t.y*this.zScale-o.y)*Ut)}constantElevation(t,o){if(t.constantHeight!=null)return this.computeBiasedHeight(t.constantHeight,o)}pointElevation(t,o,c){const d=this.constantElevation(o,c);return d??(t.x=t.x*this.zScale+this.xOffset,t.y=t.y*this.zScale+this.yOffset,this.computeBiasedHeight(o.pointElevation(t),c))}computeBiasedHeight(t,o){return o<=0?t:t+o*we(0,o,t>=0?t:Math.abs(.5*t))}}cr(Pn,"ElevationFeature");class zi{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new nl,this.indexArray=new Li,this.segments=new Wn,this.programConfigurations=new wl(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new Wc),this.worldview=t.worldview,this.hasAppearances=null}updateFootprints(t,o){}updateAppearances(t,o,c,d){}populate(t,o,c,d){const m=this.layers[0],g=[];let b=null;m.type==="circle"&&(b=m.layout.get("circle-sort-key"));for(const{feature:I,id:O,index:L,sourceLayerIndex:k}of t){const $=this.layers[0]._featureFilter.needGeometry,W=rt(I,$);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom,{worldview:this.worldview,activeFloors:o.activeFloors}),W,c))continue;const Q=b?b.evaluate(W,{},c):void 0,te={id:O,properties:I.properties,type:I.type,sourceLayerIndex:k,index:L,geometry:$?W.geometry:dt(I,c,d),patterns:{},sortKey:Q};g.push(te)}b&&g.sort(((I,O)=>I.sortKey-O.sortKey));let P=null;d.projection.name==="globe"&&(this.globeExtVertexArray=new of,P=d.projection);for(const I of g){const{geometry:O,index:L,sourceLayerIndex:k}=I,$=t[L].feature;this.addFeature(I,O,L,o.availableImages,c,P,o.brightness,o.elevationFeatures),o.featureIndex.insert($,O,L,k,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(t,o,c,d,m,g,b){this.programConfigurations.updatePaintArrays(t,o,m,c,d,g,b,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,M_.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,ym.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=t.createVertexBuffer(this.elevatedLayoutVertexArray,lv.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(t,o,c,d,m,g,b,P){let I;this.elevationMode!=="none"&&(I=qr.getElevationFeature(t,P));for(const O of o)for(const L of O){const k=L.x,$=L.y;if(k<0||k>=Ut||$<0||$>=Ut)continue;if(g){const te=g.projectTilePoint(k,$,m),ne=g.upVector(m,k,$);this.addGlobeExtVertex(te,ne),this.addGlobeExtVertex(te,ne),this.addGlobeExtVertex(te,ne),this.addGlobeExtVertex(te,ne)}const W=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),Q=W.vertexLength;if(this.addCircleVertex(k,$,-1,-1),this.addCircleVertex(k,$,1,-1),this.addCircleVertex(k,$,1,1),this.addCircleVertex(k,$,-1,1),this.elevationMode!=="none"){const te=I?I.pointElevation(new St(k,$)):0;this.hasElevation=this.hasElevation||te!==0;for(let ne=0;ne<4;ne++)this.elevatedLayoutVertexArray.emplaceBack(te)}this.indexArray.emplaceBack(Q,Q+1,Q+2),this.indexArray.emplaceBack(Q,Q+2,Q+3),W.vertexLength+=4,W.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},d,m,b,void 0,this.worldview)}addCircleVertex(t,o,c,d){this.layoutVertexArray.emplaceBack(2*t+(c+1)/2,2*o+(d+1)/2)}addGlobeExtVertex(t,o){this.globeExtVertexArray.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}}function _o(s,t){for(let o=0;o<s.length;o++)if(is(t,s[o]))return!0;for(let o=0;o<t.length;o++)if(is(s,t[o]))return!0;return!!Ca(s,t)}function ki(s,t,o){return!!is(s,t)||!!xs(t,s,o)}function so(s,t){if(s.length===1)return Kl(t,s[0]);for(let o=0;o<t.length;o++){const c=t[o];for(let d=0;d<c.length;d++)if(is(s,c[d]))return!0}for(let o=0;o<s.length;o++)if(Kl(t,s[o]))return!0;for(let o=0;o<t.length;o++)if(Ca(s,t[o]))return!0;return!1}function Wa(s,t,o){if(s.length>1){if(Ca(s,t))return!0;for(let c=0;c<t.length;c++)if(xs(t[c],s,o))return!0}for(let c=0;c<s.length;c++)if(xs(s[c],t,o))return!0;return!1}function Ca(s,t){if(s.length===0||t.length===0)return!1;for(let o=0;o<s.length-1;o++){const c=s[o],d=s[o+1];for(let m=0;m<t.length-1;m++)if(ls(c,d,t[m],t[m+1]))return!0}return!1}function ls(s,t,o,c){return Zr(s,o,c)!==Zr(t,o,c)&&Zr(s,t,o)!==Zr(s,t,c)}function vs(s,t,o){return(s.x-o.x)*(t.y-o.y)-(s.y-o.y)*(t.x-o.x)}function Sl(s,t,o,c){const d=vs(s,t,c),m=vs(s,t,o);if(Math.sign(d)===Math.sign(m))return;const g=vs(o,c,s),b=g+m-d;return Math.sign(g)!==Math.sign(b)?[g/(g-b),m/(m-d)]:void 0}function xs(s,t,o){const c=o*o;if(t.length===1)return s.distSqr(t[0])<c;for(let d=1;d<t.length;d++)if(Xl(s,t[d-1],t[d])<c)return!0;return!1}function Xl(s,t,o){const c=t.distSqr(o);if(c===0)return s.distSqr(t);const d=((s.x-t.x)*(o.x-t.x)+(s.y-t.y)*(o.y-t.y))/c;return s.distSqr(d<0?t:d>1?o:o.sub(t)._mult(d)._add(t))}function Kl(s,t){let o,c,d,m=!1;for(let g=0;g<s.length;g++){o=s[g];for(let b=0,P=o.length-1;b<o.length;P=b++)c=o[b],d=o[P],c.y>t.y!=d.y>t.y&&t.x<(d.x-c.x)*(t.y-c.y)/(d.y-c.y)+c.x&&(m=!m)}return m}function is(s,t){let o=!1;for(let c=0,d=s.length-1;c<s.length;d=c++){const m=s[c],g=s[d];m.y>t.y!=g.y>t.y&&t.x<(g.x-m.x)*(t.y-m.y)/(g.y-m.y)+m.x&&(o=!o)}return o}function Bi(s,t,o,c,d){for(const g of s)if(t<=g.x&&o<=g.y&&c>=g.x&&d>=g.y)return!0;const m=[new St(t,o),new St(t,d),new St(c,d),new St(c,o)];if(s.length>2){for(const g of m)if(is(s,g))return!0}for(let g=0;g<s.length-1;g++)if(ao(s[g],s[g+1],m))return!0;return!1}function ao(s,t,o){const c=o[0],d=o[2];if(s.x<c.x&&t.x<c.x||s.x>d.x&&t.x>d.x||s.y<c.y&&t.y<c.y||s.y>d.y&&t.y>d.y)return!1;const m=Zr(s,t,o[0]);return m!==Zr(s,t,o[1])||m!==Zr(s,t,o[2])||m!==Zr(s,t,o[3])}function li(s,t,o,c,d,m){let g=t.y-s.y,b=s.x-t.x;if(m=m||0){const P=g*g+b*b;if(P===0)return!0;const I=Math.sqrt(P);g/=I,b/=I}return!((o.x-s.x)*g+(o.y-s.y)*b-m<0||(c.x-s.x)*g+(c.y-s.y)*b-m<0||(d.x-s.x)*g+(d.y-s.y)*b-m<0)}function yo(s,t,o,c,d,m,g){return!(li(s,t,c,d,m,g)||li(t,o,c,d,m,g)||li(o,s,c,d,m,g)||li(c,d,s,t,o,g)||li(d,m,s,t,o,g)||li(m,c,s,t,o,g))}function bs(s,t,o){const c=t.paint.get(s).value;return c.kind==="constant"?c.value:o.programConfigurations.get(t.id).getMaxValue(s)}function ji(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Ql(s,t,o,c,d){if(!t[0]&&!t[1])return s;const m=St.convert(t)._mult(d);o==="viewport"&&m._rotate(-c);const g=[];for(let b=0;b<s.length;b++)g.push(s[b].sub(m));return g}function vu(s,t,o,c){const d=St.convert(s)._mult(c);return t==="viewport"&&d._rotate(-o),d}let Gu,Hu;function _(s,t,o){var c=2*Math.PI*6378137/256/Math.pow(2,o);return[s*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}cr(zi,"CircleBucket",{omit:["layers"]});class S{constructor(t,o,c){this.z=t,this.x=o,this.y=c,this.key=K(0,t,t,o,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}isChildOf(t){const o=this.z-t.z;return t.z===0||t.z<this.z&&t.x===this.x>>o&&t.y===this.y>>o}url(t,o){const c=(function(m,g,b){var P=_(256*m,256*(g=Math.pow(2,b)-g-1),b),I=_(256*(m+1),256*(g+1),b);return P[0]+","+P[1]+","+I[0]+","+I[1]})(this.x,this.y,this.z),d=(function(m,g,b){let P,I="";for(let O=m;O>0;O--)P=1<<O-1,I+=(g&P?1:0)+(b&P?2:0);return I})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class A{constructor(t,o){this.wrap=t,this.canonical=o,this.key=K(t,o.z,o.z,o.x,o.y)}}class N{constructor(t,o,c,d,m){this.overscaledZ=t,this.wrap=o,this.canonical=new S(c,+d,+m),this.key=o===0&&t===c?this.canonical.key:K(o,t,c,d,m)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const o=this.canonical.z-t;return t>this.canonical.z?new N(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new N(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o=!0){if(this.overscaledZ===t&&o)return this.key;if(t>this.canonical.z)return K(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-t;return K(this.wrap*+o,t,t,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new N(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,d=2*this.canonical.y;return[new N(o,this.wrap,o,c,d),new N(o,this.wrap,o,c+1,d),new N(o,this.wrap,o,c,d+1),new N(o,this.wrap,o,c+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new N(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new N(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new A(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function K(s,t,o,c,d){const m=1<<Math.min(o,22);let g=m*(d%m)+c%m;return s&&o<22&&(g+=m*m*((s<0?-2*s-1:2*s)%(1<<2*(22-o)))),16*(32*g+o)+(t-o)}const oe=[s=>{let t=s.canonical.x-1,o=s.wrap;return t<0&&(t=(1<<s.canonical.z)-1,o--),new N(s.overscaledZ,o,s.canonical.z,t,s.canonical.y)},s=>{let t=s.canonical.x+1,o=s.wrap;return t===1<<s.canonical.z&&(t=0,o++),new N(s.overscaledZ,o,s.canonical.z,t,s.canonical.y)},s=>new N(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,(s.canonical.y===0?1<<s.canonical.z:s.canonical.y)-1),s=>new N(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y===(1<<s.canonical.z)-1?0:s.canonical.y+1)];cr(S,"CanonicalTileID"),cr(N,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Ee=pn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ke}=Ee,ut=pn([{name:"a_pos_3",components:3,type:"Int16"}]);var Yt=pn([{name:"a_pos",type:"Int16",components:2}]);function Er(s){return s*oo/B}const Ar=[new Jr([w,w,w],[E,E,E]),new Jr([w,w,w],[0,0,E]),new Jr([0,w,w],[E,0,E]),new Jr([w,0,w],[0,E,E]),new Jr([0,0,w],[E,E,E])];function Pr(s,t,o,c=!0){const d=_t([],s._camera.position,s.worldSize),m=[t,o,1,1];Bo(m,m,s.pixelMatrixInverse),Ko(m,m,1/m[3]);const g=sr([],Xn([],m,d)),b=s.globeMatrix,P=[b[12],b[13],b[14]],I=Xn([],P,d),O=Or(I),L=sr([],I),k=s.worldSize/(2*Math.PI),$=Br(L,g),W=Math.asin(k/O);if(W<Math.acos($)){if(!c)return null;const at=[],Ze=[];_t(at,g,O/$),sr(Ze,Xn(Ze,at,I)),sr(g,Et(g,I,_t(g,Ze,Math.tan(W)*O)))}const Q=[];new sn(d,g).closestPointOnSphere(P,k,Q);const te=sr([],si(b,0)),ne=sr([],si(b,1)),ue=sr([],si(b,2)),he=Br(te,Q),me=Br(ne,Q),Ae=Br(ue,Q),Pe=So(Math.asin(-me/k));let Fe=So(Math.atan2(he,Ae));Fe=s.center.lng+(function(at,Ze){const ft=(Ze-at+180)%360-180;return ft<-180?ft+360:ft})(s.center.lng,Fe);const Be=ce(Fe),Ve=le(ae(Pe),0,1);return new He(Be,Ve)}class un{constructor(t,o,c){this.a=Xn([],t,c),this.b=Xn([],o,c),this.center=c;const d=sr([],this.a),m=sr([],this.b);this.angle=Math.acos(Br(d,m))}}function fn(s,t){if(s.angle===0)return null;let o;return o=s.a[t]===0?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[t]/s.a[t]/Math.sin(s.angle)-1/Math.tan(s.angle)),o<0||o>1?null:(function(c,d,m,g){const b=Math.sin(m);return c*(Math.sin((1-g)*m)/b)+d*(Math.sin(g*m)/b)})(s.a[t],s.b[t],s.angle,le(o,0,1))+s.center[t]}function an(s){if(s.z<=1)return Ar[s.z+2*s.y+s.x];const t=kr(Bt(s));return Jr.fromPoints(t)}function Io(s,t,o){return _t(s,s,1-o),Vt(s,s,t,o)}function Lt(s,t,o){for(const c of s)Yr(c,c,t),_t(c,c,o)}function vt(s,t,o,c){const d=t/s.worldSize,m=s.globeMatrix;if(o.z<=1){const Ve=an(o).getCorners();return Lt(Ve,m,d),Jr.fromPoints(Ve)}const g=Bt(o,c),b=kr(g,oo+Er(s._tileCoverLift));Lt(b,m,d);const P=Number.MAX_VALUE,I=[-P,-P,-P],O=[P,P,P];if(g.contains(s.center)){for(const Ze of b)tt(O,O,Ze),ct(I,I,Ze);I[2]=0;const Ve=s.point,at=[Ve.x*d,Ve.y*d,0];return tt(O,O,at),ct(I,I,at),new Jr(O,I)}if(s._tileCoverLift>0){for(const Ve of b)tt(O,O,Ve),ct(I,I,Ve);return new Jr(O,I)}const L=[m[12]*d,m[13]*d,m[14]*d],k=g.getCenter(),$=le(s.center.lat,-xe,xe),W=le(k.lat,-xe,xe),Q=ce(s.center.lng),te=ae($);let ne=Q-ce(k.lng);const ue=te-ae(W);ne>.5?ne-=1:ne<-.5&&(ne+=1);let he=0;Math.abs(ne)>Math.abs(ue)?he=ne>=0?1:3:(he=ue>=0?0:2,Vt(L,L,[m[4]*d,m[5]*d,m[6]*d],-Math.sin(vn(ue>=0?g.getSouth():g.getNorth()))*oo));const me=b[he],Ae=b[(he+1)%4],Pe=new un(me,Ae,L),Fe=[fn(Pe,0)||me[0],fn(Pe,1)||me[1],fn(Pe,2)||me[2]],Be=bm(s.zoom);if(Be>0){const Ve=(function({x:Ze,y:ft,z:xt},Ct,Wt,Rt,wt){const Dt=1/(1<<xt);let ot=Ze*Dt,it=ot+Dt,At=ft*Dt,jt=At+Dt,It=0;const dr=(ot+it)/2-Rt;return dr>.5?It=-1:dr<-.5&&(It=1),ot=((ot+It)*Ct-(Rt*=Ct))*Wt+Rt,it=((it+It)*Ct-Rt)*Wt+Rt,At=(At*Ct-(wt*=Ct))*Wt+wt,jt=(jt*Ct-wt)*Wt+wt,[[ot,jt,0],[it,jt,0],[it,At,0],[ot,At,0]]})(o,t,s._pixelsPerMercatorPixel,Q,te);for(let Ze=0;Ze<b.length;Ze++)Io(b[Ze],Ve[Ze],Be);const at=Et([],Ve[he],Ve[(he+1)%4]);_t(at,at,.5),Io(Fe,at,Be)}for(const Ve of b)tt(O,O,Ve),ct(I,I,Ve);return O[2]=Math.min(me[2],Ae[2]),tt(O,O,Fe),ct(I,I,Fe),new Jr(O,I)}function Bt({x:s,y:t,z:o},c=!1){const d=1/(1<<o),m=new q(ye(s*d),t===(1<<o)-1&&c?-90:fe((t+1)*d)),g=new q(ye((s+1)*d),t===0&&c?90:fe(t*d));return new U(m,g)}function kr(s,t=oo){const o=vn(s.getNorth()),c=vn(s.getSouth()),d=Math.cos(o),m=Math.cos(c),g=Math.sin(o),b=Math.sin(c),P=s.getWest(),I=s.getEast();return[M(m,b,P,t),M(m,b,I,t),M(d,g,I,t),M(d,g,P,t)]}function mn(s,t,o,c){const d=1<<o.z,m=(s/Ut+o.x)/d;return D(fe((t/Ut+o.y)/d),ye(m),c)}function In({min:s,max:t}){return l/Math.max(t[0]-s[0],t[1]-s[1],t[2]-s[2])}const Rn=new Float64Array(16);function Gn(s){const t=In(s),o=ze(Rn,[t,t,t]);return ve(o,o,xr([],s.min))}function fa(s){const t=(c=s.min,(o=Rn)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=c[0],o[13]=c[1],o[14]=c[2],o[15]=1,o);var o,c;const d=1/In(s);return Ne(t,t,[d,d,d])}function ro(s){const t=Ut/(2*Math.PI);return s/(2*Math.PI)/t}function ph(s,t){return Ut/(512*Math.pow(2,s))*In(an(t))}function jx(s,t,o,c,d){const m=ro(o),g=[s,t,-o/(2*Math.PI)],b=J(new Float64Array(16));return ve(b,b,g),Ne(b,b,[m,m,m]),_e(b,b,vn(-d)),Re(b,b,vn(-c)),b}function bm(s){return we(h,n,s)}function XO(s,t){const o=D(t.lat,t.lng),c=(function(W){const Q=D(W._center.lat,W._center.lng);let te=hn([],or(0,1,0),Q);const ne=et([],-W.angle,Q);te=Yr(te,te,ne),et(ne,-W._pitch,te);const ue=sr([],Q);return _t(ue,ue,Er(W.cameraToCenterDistance/W.pixelsPerMeter)),Yr(ue,ue,ne),Et([],Q,ue)})(s);return g=(d=qt([],c,o))[0],b=d[1],P=d[2],I=(m=o)[0],O=m[1],L=m[2],$=(k=Math.sqrt((g*g+b*b+P*P)*(I*I+O*O+L*L)))&&Br(d,m)/k,Math.acos(Math.min(Math.max($,-1),1));var d,m,g,b,P,I,O,L,k,$}function zS(s,t){return XO(s,t)>Math.PI/2*1.01}const KO=vn(85),EY=Math.cos(KO),PY=Math.sin(KO),IY=H(),QO=s=>{const t=[];return s.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),s.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function JO(s,t,o,c,d,m,g,b,P){if(m&&s.queryGeometry.isAboveHorizon)return!1;m&&(P*=s.pixelToTileUnitsFactor);const I=s.tileID.canonical,O=o.projection.upVectorScale(I,o.center.lat,o.worldSize).metersToTile;for(const L of t)for(const k of L){const $=k.add(b),W=d&&o.elevation?o.elevation.exaggeration()*d.getElevationAt($.x,$.y,!0):0,Q=o.projection.projectTilePoint($.x,$.y,I);if(W>0){const he=o.projection.upVector(I,$.x,$.y);Q.x+=he[0]*O*W,Q.y+=he[1]*O*W,Q.z+=he[2]*O*W}const te=m?$:MY(Q.x,Q.y,Q.z,c),ne=m?s.tilespaceRays.map((he=>AY(he,W))):s.queryGeometry.screenGeometry,ue=Bo([],[Q.x,Q.y,Q.z,1],c);if(!g&&m?P*=ue[3]/o.cameraToCenterDistance:g&&!m&&(P*=o.cameraToCenterDistance/ue[3]),m){const he=fe((k.y/Ut+I.y)/(1<<I.z));P/=o.projection.pixelsPerMeter(he,1)/de(1,he)}if(ki(ne,te,P))return!0}return!1}function MY(s,t,o,c){const d=Bo([],[s,t,o,1],c);return new St(d[0]/d[3],d[1]/d[3])}const eL=or(0,0,0),CY=or(0,0,1);function AY(s,t){const o=nr();return eL[2]=t,s.intersectsPlane(eL,CY,o),new St(o[0],o[1])}class tL extends zi{}let rL,nL,iL,oL;function sL(s,{width:t,height:o},c,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*o*c)throw new RangeError("mismatched image size")}else d=new Uint8Array(t*o*c);return s.width=t,s.height=o,s.data=d,s}function aL(s,t,o){const{width:c,height:d}=t;c===s.width&&d===s.height||(FS(s,t,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,c),height:Math.min(s.height,d)},o,null),s.width=c,s.height=d,s.data=t.data)}function FS(s,t,o,c,d,m,g,b){if(d.width===0||d.height===0)return t;if(d.width>s.width||d.height>s.height||o.x>s.width-d.width||o.y>s.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||c.x>t.width-d.width||c.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const P=s.data,I=t.data,O=m===4&&b;for(let L=0;L<d.height;L++){const k=((o.y+L)*s.width+o.x)*m,$=((c.y+L)*t.width+c.x)*m;if(O)for(let W=0;W<d.width;W++){const Q=k+W*m+3,te=$+W*m;I[te+0]=255,I[te+1]=255,I[te+2]=255,I[te+3]=P[Q]}else if(g)for(let W=0;W<d.width;W++){const Q=k+W*m,te=$+W*m,ne=new zn(P[Q+0]/255,P[Q+1]/255,P[Q+2]/255,P[Q+3]).toNonPremultipliedRenderColor(g).toArray();I[te+0]=ne[0],I[te+1]=ne[1],I[te+2]=ne[2],I[te+3]=ne[3]}else for(let W=0;W<d.width*m;W++)I[$+W]=P[k+W]}return t}cr(tL,"HeatmapBucket",{omit:["layers"]});class wm{constructor(t,o){sL(this,t,1,o)}resize(t){aL(this,new wm(t),1)}clone(){return new wm({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,c,d,m){FS(t,o,c,d,m,1,null)}}class qa{constructor(t,o){sL(this,t,4,o)}resize(t){aL(this,new qa(t),4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new qa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,c,d,m,g,b){FS(t,o,c,d,m,4,g,b)}}class lL{constructor(t,o){this.width=t.width,this.height=t.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function cv(s){const t={},o=s.resolution||256,c=s.clips?s.clips.length:1,d=s.image||new qa({width:o,height:c}),m=(g,b,P)=>{t[s.evaluationKey]=P;const I=s.expression.evaluate(t),O=I?I.toNonPremultipliedRenderColor(null):null;O&&(d.data[g+b+0]=Math.floor(255*O.r),d.data[g+b+1]=Math.floor(255*O.g),d.data[g+b+2]=Math.floor(255*O.b),d.data[g+b+3]=Math.floor(255*O.a))};if(s.clips)for(let g=0,b=0;g<c;++g,b+=4*o)for(let P=0,I=0;P<o;P++,I+=4){const O=P/(o-1),{start:L,end:k}=s.clips[g];m(b,I,L*(1-O)+k*O)}else for(let g=0,b=0;g<o;g++,b+=4)m(0,b,g/(o-1));return d}cr(wm,"AlphaImage"),cr(qa,"RGBAImage");const DY=pn([{name:"a_pos",components:2,type:"Int16"}],4),RY=pn([{name:"a_road_z_offset",components:1,type:"Float32"}],4),OY=pn([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),LY=pn([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function D_(s,t,o=2){const c=t&&t.length,d=c?t[0]*o:s.length;let m=cL(s,0,d,o,!0);const g=[];if(!m||m.next===m.prev)return g;let b,P,I;if(c&&(m=(function(O,L,k,$){const W=[];for(let Q=0,te=L.length;Q<te;Q++){const ne=cL(O,L[Q]*$,Q<te-1?L[Q+1]*$:O.length,$,!1);ne===ne.next&&(ne.steiner=!0),W.push(UY(ne))}W.sort(jY);for(let Q=0;Q<W.length;Q++)k=NY(W[Q],k);return k})(s,t,m,o)),s.length>80*o){b=s[0],P=s[1];let O=b,L=P;for(let k=o;k<d;k+=o){const $=s[k],W=s[k+1];$<b&&(b=$),W<P&&(P=W),$>O&&(O=$),W>L&&(L=W)}I=Math.max(O-b,L-P),I=I!==0?32767/I:0}return uv(m,g,o,b,P,I,0),g}function cL(s,t,o,c,d){let m;if(d===(function(g,b,P,I){let O=0;for(let L=b,k=P-I;L<P;L+=I)O+=(g[k]-g[L])*(g[L+1]+g[k+1]),k=L;return O})(s,t,o,c)>0)for(let g=t;g<o;g+=c)m=fL(g/c|0,s[g],s[g+1],m);else for(let g=o-c;g>=t;g-=c)m=fL(g/c|0,s[g],s[g+1],m);return m&&R_(m,m.next)&&(fv(m),m=m.next),m}function Tg(s,t){if(!s)return s;t||(t=s);let o,c=s;do if(o=!1,c.steiner||!R_(c,c.next)&&Qs(c.prev,c,c.next)!==0)c=c.next;else{if(fv(c),c=t=c.prev,c===c.next)break;o=!0}while(o||c!==t);return t}function uv(s,t,o,c,d,m,g){if(!s)return;!g&&m&&(function(P,I,O,L){let k=P;do k.z===0&&(k.z=kS(k.x,k.y,I,O,L)),k.prevZ=k.prev,k.nextZ=k.next,k=k.next;while(k!==P);k.prevZ.nextZ=null,k.prevZ=null,(function($){let W,Q=1;do{let te,ne=$;$=null;let ue=null;for(W=0;ne;){W++;let he=ne,me=0;for(let Pe=0;Pe<Q&&(me++,he=he.nextZ,he);Pe++);let Ae=Q;for(;me>0||Ae>0&&he;)me!==0&&(Ae===0||!he||ne.z<=he.z)?(te=ne,ne=ne.nextZ,me--):(te=he,he=he.nextZ,Ae--),ue?ue.nextZ=te:$=te,te.prevZ=ue,ue=te;ne=he}ue.nextZ=null,Q*=2}while(W>1)})(k)})(s,c,d,m);let b=s;for(;s.prev!==s.next;){const P=s.prev,I=s.next;if(m?FY(s,c,d,m):zY(s))t.push(P.i,s.i,I.i),fv(s),s=I.next,b=I.next;else if((s=I)===b){g?g===1?uv(s=kY(Tg(s),t),t,o,c,d,m,2):g===2&&BY(s,t,o,c,d,m):uv(Tg(s),t,o,c,d,m,1);break}}}function zY(s){const t=s.prev,o=s,c=s.next;if(Qs(t,o,c)>=0)return!1;const d=t.x,m=o.x,g=c.x,b=t.y,P=o.y,I=c.y,O=Math.min(d,m,g),L=Math.min(b,P,I),k=Math.max(d,m,g),$=Math.max(b,P,I);let W=c.next;for(;W!==t;){if(W.x>=O&&W.x<=k&&W.y>=L&&W.y<=$&&dv(d,b,m,P,g,I,W.x,W.y)&&Qs(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function FY(s,t,o,c){const d=s.prev,m=s,g=s.next;if(Qs(d,m,g)>=0)return!1;const b=d.x,P=m.x,I=g.x,O=d.y,L=m.y,k=g.y,$=Math.min(b,P,I),W=Math.min(O,L,k),Q=Math.max(b,P,I),te=Math.max(O,L,k),ne=kS($,W,t,o,c),ue=kS(Q,te,t,o,c);let he=s.prevZ,me=s.nextZ;for(;he&&he.z>=ne&&me&&me.z<=ue;){if(he.x>=$&&he.x<=Q&&he.y>=W&&he.y<=te&&he!==d&&he!==g&&dv(b,O,P,L,I,k,he.x,he.y)&&Qs(he.prev,he,he.next)>=0||(he=he.prevZ,me.x>=$&&me.x<=Q&&me.y>=W&&me.y<=te&&me!==d&&me!==g&&dv(b,O,P,L,I,k,me.x,me.y)&&Qs(me.prev,me,me.next)>=0))return!1;me=me.nextZ}for(;he&&he.z>=ne;){if(he.x>=$&&he.x<=Q&&he.y>=W&&he.y<=te&&he!==d&&he!==g&&dv(b,O,P,L,I,k,he.x,he.y)&&Qs(he.prev,he,he.next)>=0)return!1;he=he.prevZ}for(;me&&me.z<=ue;){if(me.x>=$&&me.x<=Q&&me.y>=W&&me.y<=te&&me!==d&&me!==g&&dv(b,O,P,L,I,k,me.x,me.y)&&Qs(me.prev,me,me.next)>=0)return!1;me=me.nextZ}return!0}function kY(s,t){let o=s;do{const c=o.prev,d=o.next.next;!R_(c,d)&&dL(c,o,o.next,d)&&hv(c,d)&&hv(d,c)&&(t.push(c.i,o.i,d.i),fv(o),fv(o.next),o=s=d),o=o.next}while(o!==s);return Tg(o)}function BY(s,t,o,c,d,m){let g=s;do{let b=g.next.next;for(;b!==g.prev;){if(g.i!==b.i&&$Y(g,b)){let P=hL(g,b);return g=Tg(g,g.next),P=Tg(P,P.next),uv(g,t,o,c,d,m,0),void uv(P,t,o,c,d,m,0)}b=b.next}g=g.next}while(g!==s)}function jY(s,t){let o=s.x-t.x;return o===0&&(o=s.y-t.y,o===0)&&(o=(s.next.y-s.y)/(s.next.x-s.x)-(t.next.y-t.y)/(t.next.x-t.x)),o}function NY(s,t){const o=(function(d,m){let g=m;const b=d.x,P=d.y;let I,O=-1/0;if(R_(d,g))return g;do{if(R_(d,g.next))return g.next;if(P<=g.y&&P>=g.next.y&&g.next.y!==g.y){const Q=g.x+(P-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(Q<=b&&Q>O&&(O=Q,I=g.x<g.next.x?g:g.next,Q===b))return I}g=g.next}while(g!==m);if(!I)return null;const L=I,k=I.x,$=I.y;let W=1/0;g=I;do{if(b>=g.x&&g.x>=k&&b!==g.x&&uL(P<$?b:O,P,k,$,P<$?O:b,P,g.x,g.y)){const Q=Math.abs(P-g.y)/(b-g.x);hv(g,d)&&(Q<W||Q===W&&(g.x>I.x||g.x===I.x&&VY(I,g)))&&(I=g,W=Q)}g=g.next}while(g!==L);return I})(s,t);if(!o)return t;const c=hL(o,s);return Tg(c,c.next),Tg(o,o.next)}function VY(s,t){return Qs(s.prev,s,t.prev)<0&&Qs(t.next,s,s.next)<0}function kS(s,t,o,c,d){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*d|0)|s<<8))|s<<4))|s<<2))|s<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function UY(s){let t=s,o=s;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==s);return o}function uL(s,t,o,c,d,m,g,b){return(d-g)*(t-b)>=(s-g)*(m-b)&&(s-g)*(c-b)>=(o-g)*(t-b)&&(o-g)*(m-b)>=(d-g)*(c-b)}function dv(s,t,o,c,d,m,g,b){return!(s===g&&t===b)&&uL(s,t,o,c,d,m,g,b)}function $Y(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!(function(o,c){let d=o;do{if(d.i!==o.i&&d.next.i!==o.i&&d.i!==c.i&&d.next.i!==c.i&&dL(d,d.next,o,c))return!0;d=d.next}while(d!==o);return!1})(s,t)&&(hv(s,t)&&hv(t,s)&&(function(o,c){let d=o,m=!1;const g=(o.x+c.x)/2,b=(o.y+c.y)/2;do d.y>b!=d.next.y>b&&d.next.y!==d.y&&g<(d.next.x-d.x)*(b-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next;while(d!==o);return m})(s,t)&&(Qs(s.prev,s,t.prev)||Qs(s,t.prev,t))||R_(s,t)&&Qs(s.prev,s,s.next)>0&&Qs(t.prev,t,t.next)>0)}function Qs(s,t,o){return(t.y-s.y)*(o.x-t.x)-(t.x-s.x)*(o.y-t.y)}function R_(s,t){return s.x===t.x&&s.y===t.y}function dL(s,t,o,c){const d=Vx(Qs(s,t,o)),m=Vx(Qs(s,t,c)),g=Vx(Qs(o,c,s)),b=Vx(Qs(o,c,t));return d!==m&&g!==b||!(d!==0||!Nx(s,o,t))||!(m!==0||!Nx(s,c,t))||!(g!==0||!Nx(o,s,c))||!(b!==0||!Nx(o,t,c))}function Nx(s,t,o){return t.x<=Math.max(s.x,o.x)&&t.x>=Math.min(s.x,o.x)&&t.y<=Math.max(s.y,o.y)&&t.y>=Math.min(s.y,o.y)}function Vx(s){return s>0?1:s<0?-1:0}function hv(s,t){return Qs(s.prev,s,s.next)<0?Qs(s,t,s.next)>=0&&Qs(s,s.prev,t)>=0:Qs(s,t,s.prev)<0||Qs(s,s.next,t)<0}function hL(s,t){const o=BS(s.i,s.x,s.y),c=BS(t.i,t.x,t.y),d=s.next,m=t.prev;return s.next=t,t.prev=s,o.next=d,d.prev=o,c.next=o,o.prev=c,m.next=c,c.prev=m,c}function fL(s,t,o,c){const d=BS(s,t,o);return c?(d.next=c.next,d.prev=c,c.next.prev=d,c.next=d):(d.prev=d,d.next=d),d}function fv(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function BS(s,t,o){return{i:s,x:t,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function pv(s,t){const o=s.length;if(o<=1)return[s];const c=[];let d,m;for(let g=0;g<o;g++){const b=on(s[g]);b!==0&&(s[g].area=Math.abs(b),m===void 0&&(m=b<0),m===b<0?(d&&c.push(d),d=[s[g]]):d.push(s[g]))}if(d&&c.push(d),t>1)for(let g=0;g<c.length;g++)c[g].length<=t||(Qa(c[g],t,1,c[g].length-1,WY),c[g]=c[g].slice(0,t));return c}function WY(s,t){return t.area-s.area}function pL(s,t,o=1){if(!s)return null;const c=typeof s=="string"?Gs.from(s).getPrimary():s.getPrimary(),d=typeof s=="string"?null:s.getSecondary();for(const m of[c,d]){if(!m)continue;const g=m.id.toString();t.has(g)||t.set(g,[]),m.scaleSelf(o),t.get(g).push(m)}return{primary:c.toString(),secondary:d?d.toString():null}}function jS(s,t,o,c){const d=c.patternDependencies;let m=!1;for(const g of t){const b=g.paint.get(`${s}-pattern`);b.isConstant()||(m=!0),pL(b.constantOr(null),d,o)&&(m=!0)}return m}function NS(s,t,o,c,d,m){const g=m.patternDependencies;for(const b of t){const P=b.paint.get(`${s}-pattern`).value;if(P.kind!=="constant"){let I=P.evaluate({zoom:c},o,{},m.availableImages);I=I&&I.name?I.name:I;const O=pL(I,g,d);if(!O)continue;const{primary:L,secondary:k}=O;L&&(o.patterns[b.id]=[L,k].filter(Boolean))}}return o}class mL{constructor(){this.polygons=new Map}add(t,...o){const c=this.polygons.get(t);c?c.push(...o):this.polygons.set(t,o)}merge(t){for(const[o,c]of t.polygons)this.add(o,...c)}}class vp{constructor(){this.portals=[]}static isOnBorder(t,o){return t<=0&&o<=0||t>=Ut&&o>=Ut}static evaluate(t){if(t.length===0)return new vp;let o=[];for(const P of t)o.push(...P.portals);if(o.length===0)return new vp;for(const P of o){const I=P.va,O=P.vb;(vp.isOnBorder(I.x,O.x)||vp.isOnBorder(I.y,O.y))&&(P.type="border")}const c=o.filter((P=>P.type!=="unevaluated")),d=o.filter((P=>P.type==="unevaluated"));if(d.length===0)return new vp;d.sort(((P,I)=>P.hash===I.hash?P.isTunnel===I.isTunnel?0:P.isTunnel?-1:1:P.hash<I.hash?1:-1)),o=c.concat(d);let m=c.length,g=m,b=m;do if(g++,g===o.length||o[m].hash!==o[g].hash){if(g-m==2){b<m&&(o[b]=o[m],o[m]=null);const P=o[b],I=o[g-1];P.type=P.isTunnel!==I.isTunnel?"tunnel":"polygon",P.connection={a:P.connection.a,b:I.connection.a},b++}m=g}while(m!==o.length);return o.splice(b),o.sort(((P,I)=>P.hash<I.hash?1:-1)),{portals:o}}}cr(vp,"ElevationPortalGraph"),cr(mL,"ElevationPolygons");class qY{constructor(t,o,c){this.outPositions=t,this.outNormals=o,this.outIndices=c,this.vertexLookup=new Map}addVertex(t,o,c){let d=t[2];c!=null&&(d*=c);const m=`${t[0]},${t[1]},${t[2]},${o[0]},${o[1]},${o[2]}`,g=this.vertexLookup.get(m);if(g!=null)return g;const b=this.outPositions.length;this.vertexLookup.set(m,b);const P=Math.trunc(16384*o[0]),I=Math.trunc(16384*o[1]),O=Math.trunc(16384*o[2]);return this.outPositions.emplaceBack(t[0],t[1],d),this.outNormals.emplaceBack(P,I,O),b}addTriangle(t,o,c){this.outIndices.emplaceBack(t,o,c)}addTriangles(t,o,c){if(t.length===0)return;const d=c.length===1,m=nr(),g=nr();for(let b=0;b<t.length;b+=3){const P=o[t[b+0]],I=o[t[b+1]],O=o[t[b+2]],L=d?c[0]:c[t[b+1]],k=d?c[0]:c[t[b+2]];lt(m,P.x,P.y,d?c[0]:c[t[b+0]]);const $=this.addVertex(m,g);lt(m,I.x,I.y,L);const W=this.addVertex(m,g);lt(m,O.x,O.y,k);const Q=this.addVertex(m,g);this.outIndices.emplaceBack($,W,Q)}}addQuad(t,o,c,d,m,g){const b=this.addVertex(t,m,g),P=this.addVertex(o,m,g),I=this.addVertex(c,m,g),O=this.addVertex(d,m,g);this.addTriangle(b,P,I),this.addTriangle(I,O,b)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}}class Gc{constructor(t,o,c,d){this.unevaluatedPortals=new vp,this.portalPolygons=new mL,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new nf,this.vertexNormals=new um,this.indexArray=new Li,this.tileToMeters=De(t),this.bridgeProgramConfigurations=new wl(o,{zoom:c,lut:d},(m=>m!=="fill-tunnel-structure-color")),this.tunnelProgramConfigurations=new wl(o,{zoom:c,lut:d},(m=>m!=="fill-bridge-guard-rail-color"))}addVertices(t,o){const c=this.unevalVertices.length;for(let d=0;d<t.length;d++)this.unevalVertices.push(t[d]),this.unevalHeights.push(o[d]);return c}addTriangles(t,o,c){const d=c?this.unevalTunnelTriangles:this.unevalTriangles;for(const m of t)d.push(m+o)}addRenderableRing(t,o,c,d,m,g){const b=[new St(m.min.x,m.min.y),new St(m.max.x,m.min.y),new St(m.max.x,m.max.y),new St(m.min.x,m.max.y)];for(let P=0;P<c-1;P++){const I=o+P,O=I+1,L=this.unevalVertices[I],k=this.unevalVertices[O];if(!(L.x>=m.min.x&&L.x<=m.max.x&&L.y>=m.min.y&&L.y<=m.max.y||k.x>=m.min.x&&k.x<=m.max.x&&k.y>=m.min.y&&k.y<=m.max.y||ao(L,k,b))||this.isOnBorder(L.x,k.x)||this.isOnBorder(L.y,k.y))continue;const $=Gc.computeEdgeHash(this.unevalVertices[I],this.unevalVertices[O]);let W,Q=this.vertexHashLookup.get(Gc.computePosHash(L));Q!=null?W=Q.next:(Q=this.vertexHashLookup.get(Gc.computePosHash(k)),W=Q!=null?Q.prev:$),this.unevalEdges.push({polygonIdx:t,a:I,b:O,hash:$,portalHash:W,isTunnel:d,type:"unevaluated",featureInfo:g})}}addPortalCandidates(t,o,c,d,m){if(o.length===0)return;this.portalPolygons.add(t,{geometry:o,zLevel:m});const g=o[0];this.vertexHashLookup.clear();let b=Gc.computeEdgeHash(g[g.length-2],g[g.length-1]);for(let P=0;P<g.length-1;P++){const I=g[P+0],O=g[P+1],L=js(O.x-I.x,O.y-I.y),k=_i(L);if(k===0)continue;let $="unevaluated";const W=d.pointElevation(I),Q=d.pointElevation(O);Math.abs(W)<.01&&Math.abs(Q)<.01?$="entrance":(this.isOnBorder(I.x,O.x)||this.isOnBorder(I.y,O.y))&&($="border");const te=Gc.computeEdgeHash(I,O);this.unevaluatedPortals.portals.push({connection:{a:t,b:void 0},va:I,vb:O,vab:L,length:k,hash:te,isTunnel:c,type:$});const ne=Gc.computePosHash(I);this.vertexHashLookup.set(ne,{prev:b,next:te}),b=te}}construct(t){if(this.unevalVertices.length===0)return;const o=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),c=k=>{k.primitiveLength=this.indexArray.length-k.primitiveOffset},d=new qY(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(t.portals,this.unevalEdges);const m=o(),g=o(),b=o(),P=(k,$)=>{k.sort(((Q,te)=>Q.type===$&&te.type!==$?-1:Q.type!==$&&te.type===$?1:0));const W=k.findIndex((Q=>Q.type!==$));return W>=0?W:k.length};let I=0;this.unevalEdges.length>0&&(I=P(this.unevalEdges,"none"),this.constructBridgeStructures(d,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:I},this.tileToMeters)),c(b);const O=o(),L=o();if(this.unevalEdges.length>0){const k=this.unevalEdges.splice(I),$=P(k,"tunnel")+I;this.unevalEdges.push(...k),this.constructTunnelStructures(d,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:I},{min:I,max:$})}c(O),d.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),c(L),d.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),c(g),d.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),c(m),this.maskSegments=Wn.simpleSegment(0,L.primitiveOffset,0,L.primitiveLength),this.depthSegments=Wn.simpleSegment(0,g.primitiveOffset,0,g.primitiveLength),this.renderableBridgeSegments=Wn.simpleSegment(0,b.primitiveOffset,0,b.primitiveLength),this.renderableTunnelSegments=Wn.simpleSegment(0,O.primitiveOffset,0,O.primitiveLength),this.shadowCasterSegments=Wn.simpleSegment(0,m.primitiveOffset,0,m.primitiveLength)}update(t,o,c,d,m,g,b,P){this.bridgeProgramConfigurations.updatePaintArrays(t,o,m,c,d,g,b,P),this.tunnelProgramConfigurations.updatePaintArrays(t,o,m,c,d,g,b,P)}upload(t){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=t.createVertexBuffer(this.vertexPositions,OY.members),this.vertexBufferNormal=t.createVertexBuffer(this.vertexNormals,LY.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(t),this.tunnelProgramConfigurations.upload(t))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(t,o,c,d,m){const g=(b,P)=>{for(let I=0;I<P.length-1;I++){const O=P[I].featureIndex,L=P[I+1].vertexStart,k=t.feature(O);b.populatePaintArrays(L,k,O,{},c,o,d,void 0,m)}};g(this.bridgeProgramConfigurations,this.bridgeFeatureSections),g(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(t,o,c,d,m){const g=new Map;for(let b=d;b<m;b++){const P=c[b],I=P.a,O=P.b,L=Gc.computePosHash(t[I]),k=Gc.computePosHash(t[O]);let $=g.get(L);$||($={},g.set(L,$));let W=g.get(k);W||(W={},g.set(k,W)),o[I]<=0&&o[O]<=0||($.to=O,W.from=I)}return g}isTerminalVertex(t,o){const c=Gc.computePosHash(this.unevalVertices[t]),d=o.get(c);return!d||!d.from||!d.to}constructBridgeStructures(t,o,c,d,m,g){t.clearVertexLookup();const b=this.computeVertexConnections(o,c,d,m.min,m.max),P=1/g,I=.5*P,O=(Wt,Rt)=>lt(Wt,o[Rt].x,o[Rt].y,c[Rt]*P),L=nr(),k=nr(),$=nr(),W=nr(),Q=nr(),te=(Wt,Rt)=>{const wt=b.get(Gc.computePosHash(o[Rt])),Dt=wt.from,ot=wt.to;if(!Dt||!ot)return;O(L,Dt),O(k,Rt),O($,ot),di(W),Ii(L,k)||(Xn(Q,k,L),sr(W,Q)),Ii($,k)||(Xn(Q,$,k),Et(W,W,sr(Q,Q)));const it=Lo(W);return it>0?_t(Wt,W,1/it):void 0};let ne=Number.POSITIVE_INFINITY;this.sortSubarray(d,m.min,m.max,((Wt,Rt)=>Wt.featureInfo.featureIndex-Rt.featureInfo.featureIndex));const ue=nr(),he=nr(),me=nr(),Ae=nr(),Pe=nr(),Fe=nr(),Be=nr(),Ve=nr(),at=nr(),Ze=[nr(),nr(),nr(),nr()],ft=[nr(),nr(),nr(),nr()],xt=[{coord:new St(0,0),height:0},{coord:new St(0,0),height:0}],Ct=(Wt,Rt)=>Wt>Rt;for(let Wt=m.min;Wt<m.max;Wt++){const Rt=d[Wt];if(!Rt.featureInfo.guardRailEnabled||!this.prepareEdgePoints(xt,o,c,Rt,Ct))continue;const[wt,Dt]=xt;if(lt(ue,wt.coord.x,wt.coord.y,P*wt.height),lt(he,Dt.coord.x,Dt.coord.y,P*Dt.height),Ii(ue,he))continue;Xn(me,he,ue),sr(me,me);const ot=te(Ve,Rt.a)||me,it=te(at,Rt.b)||me;lt(Ae,ot[1],-ot[0],0),sr(Ae,Ae),lt(Pe,it[1],-it[0],0),sr(Pe,Pe),hn(Ve,Ae,ot),sr(Fe,Ve),hn(Ve,Pe,it),sr(Be,Ve),Et(Ze[0],ue,_t(Ve,Xn(Ve,Ae,Fe),I)),Et(Ze[1],ue,_t(Ve,Et(Ve,Ae,Fe),I)),Et(Ze[2],ue,_t(Ve,Fe,I)),Ze[3]=ue,Et(ft[0],he,_t(Ve,Xn(Ve,Pe,Be),I)),Et(ft[1],he,_t(Ve,Et(Ve,Pe,Be),I)),Et(ft[2],he,_t(Ve,Be,I)),ft[3]=he,ne=this.addFeatureSection(Rt.featureInfo.featureIndex,ne,this.bridgeFeatureSections,t);const At=t.addVertex(Ze[0],Ae,g),jt=t.addVertex(Ze[1],Ae,g),It=t.addVertex(ft[0],Pe,g),dr=t.addVertex(ft[1],Pe,g);t.addTriangle(At,jt,It),t.addTriangle(jt,dr,It);const _r=t.addVertex(Ze[1],Fe,g),ir=t.addVertex(Ze[2],Fe,g),Jt=t.addVertex(ft[1],Be,g),Hr=t.addVertex(ft[2],Be,g);t.addTriangle(_r,ir,Jt),t.addTriangle(ir,Hr,Jt),xr(Ae,Ae),xr(Pe,Pe);const rr=t.addVertex(Ze[2],Ae,g),Rr=t.addVertex(Ze[3],Ae,g),Qr=t.addVertex(ft[2],Pe,g),gn=t.addVertex(ft[3],Pe,g);t.addTriangle(rr,Rr,Qr),t.addTriangle(Rr,gn,Qr);const kn=this.isTerminalVertex(Rt.a,b),tn=this.isTerminalVertex(Rt.b,b);wt.height<.01&&kn&&t.addQuad(Ze[3],Ze[2],Ze[1],Ze[0],xr(ot,ot),g),Dt.height<.01&&tn&&t.addQuad(ft[0],ft[1],ft[2],ft[3],it,g)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:t.getVertexCount()})}constructTunnelStructures(t,o,c,d,m,g){t.clearVertexLookup();let b=Number.POSITIVE_INFINITY;const P=(ne,ue)=>ne.featureInfo.featureIndex-ue.featureInfo.featureIndex;this.sortSubarray(d,m.min,m.max,P),this.sortSubarray(d,g.min,g.max,P);const I=ne=>sr(ne,ne),O=[{coord:new St(0,0),height:0},{coord:new St(0,0),height:0}],L=(ne,ue)=>ne<ue,k=nr(),$=nr(),W=nr(),Q=nr(),te=nr();for(let ne=m.min;ne<m.max;ne++){if(!this.prepareEdgePoints(O,o,c,d[ne],L))continue;const[ue,he]=O,me=I(lt(te,-(he.coord.y-ue.coord.y),he.coord.x-ue.coord.x,0));b=this.addFeatureSection(d[ne].featureInfo.featureIndex,b,this.tunnelFeatureSections,t),t.addQuad(lt(k,ue.coord.x,ue.coord.y,ue.height),lt($,he.coord.x,he.coord.y,he.height),lt(W,he.coord.x,he.coord.y,d[ne].isTunnel?-.1:0),lt(Q,ue.coord.x,ue.coord.y,d[ne].isTunnel?-.1:0),me)}for(let ne=g.min;ne<g.max;ne++){const ue=d[ne];ue.isTunnel&&([ue.a,ue.b]=[ue.b,ue.a]);const he=o[ue.a],me=o[ue.b],Ae=I(lt(te,-(me.y-he.y),me.x-he.x,0));b=this.addFeatureSection(ue.featureInfo.featureIndex,b,this.tunnelFeatureSections,t),t.addQuad(lt(k,me.x,me.y,0),lt($,he.x,he.y,0),lt(W,he.x,he.y,c[ue.a]+4),lt(Q,me.x,me.y,c[ue.b]+4),Ae),t.addQuad(lt(k,he.x,he.y,0),lt($,me.x,me.y,0),lt(W,me.x,me.y,c[ue.b]+4),lt(Q,he.x,he.y,c[ue.a]+4),Ae)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:t.getVertexCount()})}setElevatedPoint(t,o,c,d){t.coord.x=o,t.coord.y=c,t.height=d}prepareEdgePoints(t,o,c,d,m){let g=o[d.a].x,b=o[d.a].y,P=o[d.b].x,I=o[d.b].y,O=c[d.a],L=c[d.b];const k=m(O,0),$=m(L,0);if(k&&$)return this.setElevatedPoint(t[0],g,b,O),this.setElevatedPoint(t[1],P,I,L),!0;if(!k&&!$)return!1;if(k){if(!$){const W=L/(L-O);P=Lr(P,g,W),I=Lr(I,b,W),L=Lr(L,O,W)}}else{const W=O/(O-L);g=Lr(g,P,W),b=Lr(b,I,W),O=Lr(O,L,W)}return this.setElevatedPoint(t[0],g,b,O),this.setElevatedPoint(t[1],P,I,L),!0}prepareEdges(t,o){if(o.length===0)return;o.sort(((b,P)=>b.hash===P.hash?P.polygonIdx-b.polygonIdx:P.hash>b.hash?1:-1));let c=0,d=0,m=0,g=o[c].polygonIdx;do d++,(d===o.length||o[c].hash!==o[d].hash)&&((d-c==1||o[d-1].polygonIdx!==g)&&(m<c&&(o[m]=o[c],o[c]=null),o[m].type="none",m++),c=d,c!==o.length&&(g=o[c].polygonIdx));while(c!==o.length);if(o.splice(m),o.length!==0&&t.length!==0){o.sort(((I,O)=>I.portalHash<O.portalHash?1:-1));let b=0,P=0;for(;b!==o.length&&P!==t.length;){const I=o[b],O=t[P];I.portalHash>O.hash?b++:O.hash>I.portalHash?P++:(I.type=O.type,b++)}}}isOnBorder(t,o){return t<=0&&o<=0||t>=Ut&&o>=Ut}addFeatureSection(t,o,c,d){return t!==o&&(o=t,c.push({featureIndex:t,vertexStart:d.getVertexCount()}),d.clearVertexLookup()),o}sortSubarray(t,o,c,d){const m=t.slice(o,c);m.sort(d),t.splice(o,m.length,...m)}static computeEdgeHash(t,o){return(t.y===o.y&&t.x>o.x||t.y>o.y)&&([t,o]=[o,t]),BigInt(Gc.computePosHash(t))<<32n|BigInt(Gc.computePosHash(o))}static computePosHash(t){return((65535&t.x)<<16|65535&t.y)>>>0}}var gL,_L={exports:{}},yL=(gL||(gL=1,(function(s,t){(function(o){function c(Ie,Se){return Ie>Se?1:Ie<Se?-1:0}var d=function(Ie,Se){Ie===void 0&&(Ie=c),Se===void 0&&(Se=!1),this._compare=Ie,this._root=null,this._size=0,this._noDuplicates=!!Se},m={size:{configurable:!0}};function g(Ie,Se,mt,Zt,gt){var er=gt-Zt;if(er>0){var Tr=Zt+Math.floor(er/2),wr={key:Se[Tr],data:mt[Tr],parent:Ie};return wr.left=g(wr,Se,mt,Zt,Tr),wr.right=g(wr,Se,mt,Tr+1,gt),wr}return null}function b(Ie,Se,mt,Zt,gt){if(!(mt>=Zt)){for(var er=Ie[mt+Zt>>1],Tr=mt-1,wr=Zt+1;;){do Tr++;while(gt(Ie[Tr],er)<0);do wr--;while(gt(Ie[wr],er)>0);if(Tr>=wr)break;var ln=Ie[Tr];Ie[Tr]=Ie[wr],Ie[wr]=ln,ln=Se[Tr],Se[Tr]=Se[wr],Se[wr]=ln}b(Ie,Se,mt,wr,gt),b(Ie,Se,wr+1,Zt,gt)}}d.prototype.rotateLeft=function(Ie){var Se=Ie.right;Se&&(Ie.right=Se.left,Se.left&&(Se.left.parent=Ie),Se.parent=Ie.parent),Ie.parent?Ie===Ie.parent.left?Ie.parent.left=Se:Ie.parent.right=Se:this._root=Se,Se&&(Se.left=Ie),Ie.parent=Se},d.prototype.rotateRight=function(Ie){var Se=Ie.left;Se&&(Ie.left=Se.right,Se.right&&(Se.right.parent=Ie),Se.parent=Ie.parent),Ie.parent?Ie===Ie.parent.left?Ie.parent.left=Se:Ie.parent.right=Se:this._root=Se,Se&&(Se.right=Ie),Ie.parent=Se},d.prototype._splay=function(Ie){for(;Ie.parent;){var Se=Ie.parent;Se.parent?Se.left===Ie&&Se.parent.left===Se?(this.rotateRight(Se.parent),this.rotateRight(Se)):Se.right===Ie&&Se.parent.right===Se?(this.rotateLeft(Se.parent),this.rotateLeft(Se)):Se.left===Ie&&Se.parent.right===Se?(this.rotateRight(Se),this.rotateLeft(Se)):(this.rotateLeft(Se),this.rotateRight(Se)):Se.left===Ie?this.rotateRight(Se):this.rotateLeft(Se)}},d.prototype.splay=function(Ie){for(var Se,mt,Zt,gt,er;Ie.parent;)(mt=(Se=Ie.parent).parent)&&mt.parent?((Zt=mt.parent).left===mt?Zt.left=Ie:Zt.right=Ie,Ie.parent=Zt):(Ie.parent=null,this._root=Ie),gt=Ie.left,er=Ie.right,Ie===Se.left?(mt&&(mt.left===Se?(Se.right?(mt.left=Se.right,mt.left.parent=mt):mt.left=null,Se.right=mt,mt.parent=Se):(gt?(mt.right=gt,gt.parent=mt):mt.right=null,Ie.left=mt,mt.parent=Ie)),er?(Se.left=er,er.parent=Se):Se.left=null,Ie.right=Se,Se.parent=Ie):(mt&&(mt.right===Se?(Se.left?(mt.right=Se.left,mt.right.parent=mt):mt.right=null,Se.left=mt,mt.parent=Se):(er?(mt.left=er,er.parent=mt):mt.left=null,Ie.right=mt,mt.parent=Ie)),gt?(Se.right=gt,gt.parent=Se):Se.right=null,Ie.left=Se,Se.parent=Ie)},d.prototype.replace=function(Ie,Se){Ie.parent?Ie===Ie.parent.left?Ie.parent.left=Se:Ie.parent.right=Se:this._root=Se,Se&&(Se.parent=Ie.parent)},d.prototype.minNode=function(Ie){if(Ie===void 0&&(Ie=this._root),Ie)for(;Ie.left;)Ie=Ie.left;return Ie},d.prototype.maxNode=function(Ie){if(Ie===void 0&&(Ie=this._root),Ie)for(;Ie.right;)Ie=Ie.right;return Ie},d.prototype.insert=function(Ie,Se){var mt=this._root,Zt=null,gt=this._compare;if(this._noDuplicates)for(;mt;){if(Zt=mt,gt(mt.key,Ie)===0)return;mt=gt(mt.key,Ie)<0?mt.right:mt.left}else for(;mt;)Zt=mt,mt=gt(mt.key,Ie)<0?mt.right:mt.left;return mt={key:Ie,data:Se,left:null,right:null,parent:Zt},Zt?gt(Zt.key,mt.key)<0?Zt.right=mt:Zt.left=mt:this._root=mt,this.splay(mt),this._size++,mt},d.prototype.find=function(Ie){for(var Se=this._root,mt=this._compare;Se;){var Zt=mt(Se.key,Ie);if(Zt<0)Se=Se.right;else{if(!(Zt>0))return Se;Se=Se.left}}return null},d.prototype.contains=function(Ie){for(var Se=this._root,mt=this._compare;Se;){var Zt=mt(Ie,Se.key);if(Zt===0)return!0;Se=Zt<0?Se.left:Se.right}return!1},d.prototype.remove=function(Ie){var Se=this.find(Ie);if(!Se)return!1;if(this.splay(Se),Se.left)if(Se.right){var mt=this.minNode(Se.right);mt.parent!==Se&&(this.replace(mt,mt.right),mt.right=Se.right,mt.right.parent=mt),this.replace(Se,mt),mt.left=Se.left,mt.left.parent=mt}else this.replace(Se,Se.left);else this.replace(Se,Se.right);return this._size--,!0},d.prototype.removeNode=function(Ie){if(!Ie)return!1;if(this.splay(Ie),Ie.left)if(Ie.right){var Se=this.minNode(Ie.right);Se.parent!==Ie&&(this.replace(Se,Se.right),Se.right=Ie.right,Se.right.parent=Se),this.replace(Ie,Se),Se.left=Ie.left,Se.left.parent=Se}else this.replace(Ie,Ie.left);else this.replace(Ie,Ie.right);return this._size--,!0},d.prototype.erase=function(Ie){var Se=this.find(Ie);if(Se){this.splay(Se);var mt=Se.left,Zt=Se.right,gt=null;mt&&(mt.parent=null,gt=this.maxNode(mt),this.splay(gt),this._root=gt),Zt&&(mt?gt.right=Zt:this._root=Zt,Zt.parent=gt),this._size--}},d.prototype.pop=function(){var Ie=this._root,Se=null;if(Ie){for(;Ie.left;)Ie=Ie.left;Se={key:Ie.key,data:Ie.data},this.remove(Ie.key)}return Se},d.prototype.next=function(Ie){var Se=Ie;if(Se)if(Se.right)for(Se=Se.right;Se&&Se.left;)Se=Se.left;else for(Se=Ie.parent;Se&&Se.right===Ie;)Ie=Se,Se=Se.parent;return Se},d.prototype.prev=function(Ie){var Se=Ie;if(Se)if(Se.left)for(Se=Se.left;Se&&Se.right;)Se=Se.right;else for(Se=Ie.parent;Se&&Se.left===Ie;)Ie=Se,Se=Se.parent;return Se},d.prototype.forEach=function(Ie){for(var Se=this._root,mt=[],Zt=!1,gt=0;!Zt;)Se?(mt.push(Se),Se=Se.left):mt.length>0?(Ie(Se=mt.pop(),gt++),Se=Se.right):Zt=!0;return this},d.prototype.range=function(Ie,Se,mt,Zt){for(var gt=[],er=this._compare,Tr=this._root;gt.length!==0||Tr;)if(Tr)gt.push(Tr),Tr=Tr.left;else{if(er((Tr=gt.pop()).key,Se)>0)break;if(er(Tr.key,Ie)>=0&&mt.call(Zt,Tr))return this;Tr=Tr.right}return this},d.prototype.keys=function(){for(var Ie=this._root,Se=[],mt=[],Zt=!1;!Zt;)Ie?(Se.push(Ie),Ie=Ie.left):Se.length>0?(Ie=Se.pop(),mt.push(Ie.key),Ie=Ie.right):Zt=!0;return mt},d.prototype.values=function(){for(var Ie=this._root,Se=[],mt=[],Zt=!1;!Zt;)Ie?(Se.push(Ie),Ie=Ie.left):Se.length>0?(Ie=Se.pop(),mt.push(Ie.data),Ie=Ie.right):Zt=!0;return mt},d.prototype.at=function(Ie){for(var Se=this._root,mt=[],Zt=!1,gt=0;!Zt;)if(Se)mt.push(Se),Se=Se.left;else if(mt.length>0){if(Se=mt.pop(),gt===Ie)return Se;gt++,Se=Se.right}else Zt=!0;return null},d.prototype.load=function(Ie,Se,mt){if(Ie===void 0&&(Ie=[]),Se===void 0&&(Se=[]),mt===void 0&&(mt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Zt=Ie.length;return mt&&b(Ie,Se,0,Zt-1,this._compare),this._root=g(null,Ie,Se,0,Zt),this._size=Zt,this},d.prototype.min=function(){var Ie=this.minNode(this._root);return Ie?Ie.key:null},d.prototype.max=function(){var Ie=this.maxNode(this._root);return Ie?Ie.key:null},d.prototype.isEmpty=function(){return this._root===null},m.size.get=function(){return this._size},d.createTree=function(Ie,Se,mt,Zt,gt){return new d(mt,gt).load(Ie,Se,Zt)},Object.defineProperties(d.prototype,m);var P=0,I=1,O=2,L=3,k=0,$=1,W=2,Q=3;function te(Ie,Se,mt){Se===null?(Ie.inOut=!1,Ie.otherInOut=!0):(Ie.isSubject===Se.isSubject?(Ie.inOut=!Se.inOut,Ie.otherInOut=Se.otherInOut):(Ie.inOut=!Se.otherInOut,Ie.otherInOut=Se.isVertical()?!Se.inOut:Se.inOut),Se&&(Ie.prevInResult=!ne(Se,mt)||Se.isVertical()?Se.prevInResult:Se));var Zt=ne(Ie,mt);Ie.resultTransition=Zt?(function(gt,er){var Tr,wr=!gt.inOut,ln=!gt.otherInOut;switch(er){case k:Tr=wr&&ln;break;case $:Tr=wr||ln;break;case Q:Tr=wr^ln;break;case W:Tr=gt.isSubject?wr&&!ln:ln&&!wr}return Tr?1:-1})(Ie,mt):0}function ne(Ie,Se){switch(Ie.type){case P:switch(Se){case k:return!Ie.otherInOut;case $:return Ie.otherInOut;case W:return Ie.isSubject&&Ie.otherInOut||!Ie.isSubject&&!Ie.otherInOut;case Q:return!0}break;case O:return Se===k||Se===$;case L:return Se===W;case I:return!1}return!1}var ue=function(Ie,Se,mt,Zt,gt){this.left=Se,this.point=Ie,this.otherEvent=mt,this.isSubject=Zt,this.type=gt||P,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},he={inResult:{configurable:!0}};function me(Ie,Se){return Ie[0]===Se[0]&&Ie[1]===Se[1]}ue.prototype.isBelow=function(Ie){var Se=this.point,mt=this.otherEvent.point;return this.left?(Se[0]-Ie[0])*(mt[1]-Ie[1])-(mt[0]-Ie[0])*(Se[1]-Ie[1])>0:(mt[0]-Ie[0])*(Se[1]-Ie[1])-(Se[0]-Ie[0])*(mt[1]-Ie[1])>0},ue.prototype.isAbove=function(Ie){return!this.isBelow(Ie)},ue.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},he.inResult.get=function(){return this.resultTransition!==0},ue.prototype.clone=function(){var Ie=new ue(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ie.contourId=this.contourId,Ie.resultTransition=this.resultTransition,Ie.prevInResult=this.prevInResult,Ie.isExteriorRing=this.isExteriorRing,Ie.inOut=this.inOut,Ie.otherInOut=this.otherInOut,Ie},Object.defineProperties(ue.prototype,he);var Ae=11102230246251565e-32,Pe=134217729,Fe=(3+8*Ae)*Ae;function Be(Ie,Se,mt,Zt,gt){var er,Tr,wr,ln,Ur=Se[0],vr=Zt[0],Hn=0,bi=0;vr>Ur==vr>-Ur?(er=Ur,Ur=Se[++Hn]):(er=vr,vr=Zt[++bi]);var Gr=0;if(Hn<Ie&&bi<mt)for(vr>Ur==vr>-Ur?(wr=er-((Tr=Ur+er)-Ur),Ur=Se[++Hn]):(wr=er-((Tr=vr+er)-vr),vr=Zt[++bi]),er=Tr,wr!==0&&(gt[Gr++]=wr);Hn<Ie&&bi<mt;)vr>Ur==vr>-Ur?(wr=er-((Tr=er+Ur)-(ln=Tr-er))+(Ur-ln),Ur=Se[++Hn]):(wr=er-((Tr=er+vr)-(ln=Tr-er))+(vr-ln),vr=Zt[++bi]),er=Tr,wr!==0&&(gt[Gr++]=wr);for(;Hn<Ie;)wr=er-((Tr=er+Ur)-(ln=Tr-er))+(Ur-ln),Ur=Se[++Hn],er=Tr,wr!==0&&(gt[Gr++]=wr);for(;bi<mt;)wr=er-((Tr=er+vr)-(ln=Tr-er))+(vr-ln),vr=Zt[++bi],er=Tr,wr!==0&&(gt[Gr++]=wr);return er===0&&Gr!==0||(gt[Gr++]=er),Gr}function Ve(Ie){return new Float64Array(Ie)}var at=33306690738754716e-32,Ze=22204460492503146e-32,ft=11093356479670487e-47,xt=Ve(4),Ct=Ve(8),Wt=Ve(12),Rt=Ve(16),wt=Ve(4);function Dt(Ie,Se,mt){var Zt=(function(gt,er,Tr,wr,ln,Ur){var vr=(er-Ur)*(Tr-ln),Hn=(gt-ln)*(wr-Ur),bi=vr-Hn;if(vr===0||Hn===0||vr>0!=Hn>0)return bi;var Gr=Math.abs(vr+Hn);return Math.abs(bi)>=at*Gr?bi:-(function(On,wi,ci,po,Wi,Ai,gi){var Jn,cn,ei,Di,$r,Bn,qi,bo,zo,cs,Gi,os,Sc,ss,Yc,Ga,Zu,Tc,Zc=On-Wi,Ha=ci-Wi,Xc=wi-Ai,Xu=po-Ai;xt[0]=(Yc=(bo=Zc-(qi=(Bn=Pe*Zc)-(Bn-Zc)))*(cs=Xu-(zo=(Bn=Pe*Xu)-(Bn-Xu)))-((ss=Zc*Xu)-qi*zo-bo*zo-qi*cs))-((Gi=Yc-(Zu=(bo=Xc-(qi=(Bn=Pe*Xc)-(Bn-Xc)))*(cs=Ha-(zo=(Bn=Pe*Ha)-(Bn-Ha)))-((Ga=Xc*Ha)-qi*zo-bo*zo-qi*cs)))+($r=Yc-Gi))+($r-Zu),xt[1]=(Sc=ss-((os=ss+Gi)-($r=os-ss))+(Gi-$r))-((Gi=Sc-Ga)+($r=Sc-Gi))+($r-Ga),xt[2]=os-((Tc=os+Gi)-($r=Tc-os))+(Gi-$r),xt[3]=Tc;var ma=(function(Mm,xf){for(var Ab=xf[0],K_=1;K_<4;K_++)Ab+=xf[K_];return Ab})(0,xt),Tl=Ze*gi;if(ma>=Tl||-ma>=Tl||(Jn=On-(Zc+($r=On-Zc))+($r-Wi),ei=ci-(Ha+($r=ci-Ha))+($r-Wi),cn=wi-(Xc+($r=wi-Xc))+($r-Ai),Di=po-(Xu+($r=po-Xu))+($r-Ai),Jn===0&&cn===0&&ei===0&&Di===0)||(Tl=ft*gi+Fe*Math.abs(ma),(ma+=Zc*Di+Xu*Jn-(Xc*ei+Ha*cn))>=Tl||-ma>=Tl))return ma;wt[0]=(Yc=(bo=Jn-(qi=(Bn=Pe*Jn)-(Bn-Jn)))*(cs=Xu-(zo=(Bn=Pe*Xu)-(Bn-Xu)))-((ss=Jn*Xu)-qi*zo-bo*zo-qi*cs))-((Gi=Yc-(Zu=(bo=cn-(qi=(Bn=Pe*cn)-(Bn-cn)))*(cs=Ha-(zo=(Bn=Pe*Ha)-(Bn-Ha)))-((Ga=cn*Ha)-qi*zo-bo*zo-qi*cs)))+($r=Yc-Gi))+($r-Zu),wt[1]=(Sc=ss-((os=ss+Gi)-($r=os-ss))+(Gi-$r))-((Gi=Sc-Ga)+($r=Sc-Gi))+($r-Ga),wt[2]=os-((Tc=os+Gi)-($r=Tc-os))+(Gi-$r),wt[3]=Tc;var vf=Be(4,xt,4,wt,Ct);wt[0]=(Yc=(bo=Zc-(qi=(Bn=Pe*Zc)-(Bn-Zc)))*(cs=Di-(zo=(Bn=Pe*Di)-(Bn-Di)))-((ss=Zc*Di)-qi*zo-bo*zo-qi*cs))-((Gi=Yc-(Zu=(bo=Xc-(qi=(Bn=Pe*Xc)-(Bn-Xc)))*(cs=ei-(zo=(Bn=Pe*ei)-(Bn-ei)))-((Ga=Xc*ei)-qi*zo-bo*zo-qi*cs)))+($r=Yc-Gi))+($r-Zu),wt[1]=(Sc=ss-((os=ss+Gi)-($r=os-ss))+(Gi-$r))-((Gi=Sc-Ga)+($r=Sc-Gi))+($r-Ga),wt[2]=os-((Tc=os+Gi)-($r=Tc-os))+(Gi-$r),wt[3]=Tc;var Im=Be(vf,Ct,4,wt,Wt);wt[0]=(Yc=(bo=Jn-(qi=(Bn=Pe*Jn)-(Bn-Jn)))*(cs=Di-(zo=(Bn=Pe*Di)-(Bn-Di)))-((ss=Jn*Di)-qi*zo-bo*zo-qi*cs))-((Gi=Yc-(Zu=(bo=cn-(qi=(Bn=Pe*cn)-(Bn-cn)))*(cs=ei-(zo=(Bn=Pe*ei)-(Bn-ei)))-((Ga=cn*ei)-qi*zo-bo*zo-qi*cs)))+($r=Yc-Gi))+($r-Zu),wt[1]=(Sc=ss-((os=ss+Gi)-($r=os-ss))+(Gi-$r))-((Gi=Sc-Ga)+($r=Sc-Gi))+($r-Ga),wt[2]=os-((Tc=os+Gi)-($r=Tc-os))+(Gi-$r),wt[3]=Tc;var X_=Be(Im,Wt,4,wt,Rt);return Rt[X_-1]})(gt,er,Tr,wr,ln,Ur,Gr)})(Ie[0],Ie[1],Se[0],Se[1],mt[0],mt[1]);return Zt>0?-1:Zt<0?1:0}function ot(Ie,Se){var mt=Ie.point,Zt=Se.point;return mt[0]>Zt[0]?1:mt[0]<Zt[0]?-1:mt[1]!==Zt[1]?mt[1]>Zt[1]?1:-1:(function(gt,er,Tr,wr){return gt.left!==er.left?gt.left?1:-1:Dt(Tr,gt.otherEvent.point,er.otherEvent.point)!==0?gt.isBelow(er.otherEvent.point)?-1:1:!gt.isSubject&&er.isSubject?1:-1})(Ie,Se,mt)}function it(Ie,Se,mt){var Zt=new ue(Se,!1,Ie,Ie.isSubject),gt=new ue(Se,!0,Ie.otherEvent,Ie.isSubject);return me(Ie.point,Ie.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ie),Zt.contourId=gt.contourId=Ie.contourId,ot(gt,Ie.otherEvent)>0&&(Ie.otherEvent.left=!0,gt.left=!1),Ie.otherEvent.otherEvent=gt,Ie.otherEvent=Zt,mt.push(gt),mt.push(Zt),mt}function At(Ie,Se){return Ie[0]*Se[1]-Ie[1]*Se[0]}function jt(Ie,Se){return Ie[0]*Se[0]+Ie[1]*Se[1]}function It(Ie,Se,mt){var Zt=(function(ln,Ur,vr,Hn,bi){var Gr=[Ur[0]-ln[0],Ur[1]-ln[1]],On=[Hn[0]-vr[0],Hn[1]-vr[1]];function wi(Bn,qi,bo){return[Bn[0]+qi*bo[0],Bn[1]+qi*bo[1]]}var ci=[vr[0]-ln[0],vr[1]-ln[1]],po=At(Gr,On),Wi=po*po,Ai=jt(Gr,Gr);if(Wi>0){var gi=At(ci,On)/po;if(gi<0||gi>1)return null;var Jn=At(ci,Gr)/po;return Jn<0||Jn>1?null:gi===0||gi===1?[wi(ln,gi,Gr)]:Jn===0||Jn===1?[wi(vr,Jn,On)]:[wi(ln,gi,Gr)]}if((Wi=(po=At(ci,Gr))*po)>0)return null;var cn=jt(Gr,ci)/Ai,ei=cn+jt(Gr,On)/Ai,Di=Math.min(cn,ei),$r=Math.max(cn,ei);return Di<=1&&$r>=0?Di===1?[wi(ln,Di>0?Di:0,Gr)]:$r===0?[wi(ln,$r<1?$r:1,Gr)]:[wi(ln,Di>0?Di:0,Gr),wi(ln,$r<1?$r:1,Gr)]:null})(Ie.point,Ie.otherEvent.point,Se.point,Se.otherEvent.point),gt=Zt?Zt.length:0;if(gt===0||gt===1&&(me(Ie.point,Se.point)||me(Ie.otherEvent.point,Se.otherEvent.point))||gt===2&&Ie.isSubject===Se.isSubject)return 0;if(gt===1)return me(Ie.point,Zt[0])||me(Ie.otherEvent.point,Zt[0])||it(Ie,Zt[0],mt),me(Se.point,Zt[0])||me(Se.otherEvent.point,Zt[0])||it(Se,Zt[0],mt),1;var er=[],Tr=!1,wr=!1;return me(Ie.point,Se.point)?Tr=!0:ot(Ie,Se)===1?er.push(Se,Ie):er.push(Ie,Se),me(Ie.otherEvent.point,Se.otherEvent.point)?wr=!0:ot(Ie.otherEvent,Se.otherEvent)===1?er.push(Se.otherEvent,Ie.otherEvent):er.push(Ie.otherEvent,Se.otherEvent),Tr&&wr||Tr?(Se.type=I,Ie.type=Se.inOut===Ie.inOut?O:L,Tr&&!wr&&it(er[1].otherEvent,er[0].point,mt),2):wr?(it(er[0],er[1].point,mt),3):er[0]!==er[3].otherEvent?(it(er[0],er[1].point,mt),it(er[1],er[2].point,mt),3):(it(er[0],er[1].point,mt),it(er[3].otherEvent,er[2].point,mt),3)}function dr(Ie,Se){if(Ie===Se)return 0;if(Dt(Ie.point,Ie.otherEvent.point,Se.point)!==0||Dt(Ie.point,Ie.otherEvent.point,Se.otherEvent.point)!==0)return me(Ie.point,Se.point)?Ie.isBelow(Se.otherEvent.point)?-1:1:Ie.point[0]===Se.point[0]?Ie.point[1]<Se.point[1]?-1:1:ot(Ie,Se)===1?Se.isAbove(Ie.point)?-1:1:Ie.isBelow(Se.point)?-1:1;if(Ie.isSubject!==Se.isSubject)return Ie.isSubject?-1:1;var mt=Ie.point,Zt=Se.point;return mt[0]===Zt[0]&&mt[1]===Zt[1]?(mt=Ie.otherEvent.point)[0]===(Zt=Se.otherEvent.point)[0]&&mt[1]===Zt[1]?0:Ie.contourId>Se.contourId?1:-1:ot(Ie,Se)===1?1:-1}var _r=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function ir(Ie,Se,mt,Zt){var gt,er=Ie+1,Tr=Se[Ie].point,wr=Se.length;for(er<wr&&(gt=Se[er].point);er<wr&&gt[0]===Tr[0]&&gt[1]===Tr[1];){if(!mt[er])return er;++er<wr&&(gt=Se[er].point)}for(er=Ie-1;mt[er]&&er>Zt;)er--;return er}_r.prototype.isExterior=function(){return this.holeOf==null};var Jt=rr,Hr=rr;function rr(Ie,Se){if(!(this instanceof rr))return new rr(Ie,Se);if(this.data=Ie||[],this.length=this.data.length,this.compare=Se||Rr,this.length>0)for(var mt=(this.length>>1)-1;mt>=0;mt--)this._down(mt)}function Rr(Ie,Se){return Ie<Se?-1:Ie>Se?1:0}rr.prototype={push:function(Ie){this.data.push(Ie),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ie=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ie}},peek:function(){return this.data[0]},_up:function(Ie){for(var Se=this.data,mt=this.compare,Zt=Se[Ie];Ie>0;){var gt=Ie-1>>1,er=Se[gt];if(mt(Zt,er)>=0)break;Se[Ie]=er,Ie=gt}Se[Ie]=Zt},_down:function(Ie){for(var Se=this.data,mt=this.compare,Zt=this.length>>1,gt=Se[Ie];Ie<Zt;){var er=1+(Ie<<1),Tr=er+1,wr=Se[er];if(Tr<this.length&&mt(Se[Tr],wr)<0&&(er=Tr,wr=Se[Tr]),mt(wr,gt)>=0)break;Se[Ie]=wr,Ie=er}Se[Ie]=gt}},Jt.default=Hr;var Qr=Math.max,gn=Math.min,kn=0;function tn(Ie,Se,mt,Zt,gt,er){var Tr,wr,ln,Ur,vr,Hn;for(Tr=0,wr=Ie.length-1;Tr<wr;Tr++)if(Ur=Ie[Tr+1],vr=new ue(ln=Ie[Tr],!1,void 0,Se),Hn=new ue(Ur,!1,vr,Se),vr.otherEvent=Hn,ln[0]!==Ur[0]||ln[1]!==Ur[1]){vr.contourId=Hn.contourId=mt,er||(vr.isExteriorRing=!1,Hn.isExteriorRing=!1),ot(vr,Hn)>0?Hn.left=!0:vr.left=!0;var bi=ln[0],Gr=ln[1];gt[0]=gn(gt[0],bi),gt[1]=gn(gt[1],Gr),gt[2]=Qr(gt[2],bi),gt[3]=Qr(gt[3],Gr),Zt.push(vr),Zt.push(Hn)}}var Kn=[];function Qn(Ie,Se,mt){typeof Ie[0][0][0]=="number"&&(Ie=[Ie]),typeof Se[0][0][0]=="number"&&(Se=[Se]);var Zt=(function(Gr,On,wi){var ci=null;return Gr.length*On.length==0&&(wi===k?ci=Kn:wi===W?ci=Gr:wi!==$&&wi!==Q||(ci=Gr.length===0?On:Gr)),ci})(Ie,Se,mt);if(Zt)return Zt===Kn?null:Zt;var gt=[1/0,1/0,-1/0,-1/0],er=[1/0,1/0,-1/0,-1/0],Tr=(function(Gr,On,wi,ci,po){var Wi,Ai,gi,Jn,cn,ei,Di=new Jt(null,ot);for(gi=0,Jn=Gr.length;gi<Jn;gi++)for(cn=0,ei=(Wi=Gr[gi]).length;cn<ei;cn++)(Ai=cn===0)&&kn++,tn(Wi[cn],!0,kn,Di,wi,Ai);for(gi=0,Jn=On.length;gi<Jn;gi++)for(cn=0,ei=(Wi=On[gi]).length;cn<ei;cn++)Ai=cn===0,po===W&&(Ai=!1),Ai&&kn++,tn(Wi[cn],!1,kn,Di,ci,Ai);return Di})(Ie,Se,gt,er,mt);if(Zt=(function(Gr,On,wi,ci,po){var Wi=null;return(wi[0]>ci[2]||ci[0]>wi[2]||wi[1]>ci[3]||ci[1]>wi[3])&&(po===k?Wi=Kn:po===W?Wi=Gr:po!==$&&po!==Q||(Wi=Gr.concat(On))),Wi})(Ie,Se,gt,er,mt))return Zt===Kn?null:Zt;for(var wr=(function(Gr){var On,wi,ci=(function(gi){var Jn,cn,ei,Di,$r=[];for(cn=0,ei=gi.length;cn<ei;cn++)((Jn=gi[cn]).left&&Jn.inResult||!Jn.left&&Jn.otherEvent.inResult)&&$r.push(Jn);for(var Bn=!1;!Bn;)for(Bn=!0,cn=0,ei=$r.length;cn<ei;cn++)cn+1<ei&&ot($r[cn],$r[cn+1])===1&&(Di=$r[cn],$r[cn]=$r[cn+1],$r[cn+1]=Di,Bn=!1);for(cn=0,ei=$r.length;cn<ei;cn++)(Jn=$r[cn]).otherPos=cn;for(cn=0,ei=$r.length;cn<ei;cn++)(Jn=$r[cn]).left||(Di=Jn.otherPos,Jn.otherPos=Jn.otherEvent.otherPos,Jn.otherEvent.otherPos=Di);return $r})(Gr),po={},Wi=[],Ai=function(){if(!po[On]){var gi=Wi.length,Jn=(function($r,Bn,qi){var bo=new _r;if($r.prevInResult!=null){var zo=$r.prevInResult,cs=zo.outputContourId;if(zo.resultTransition>0){var Gi=Bn[cs];if(Gi.holeOf!=null){var os=Gi.holeOf;Bn[os].holeIds.push(qi),bo.holeOf=os,bo.depth=Bn[cs].depth}else Bn[cs].holeIds.push(qi),bo.holeOf=cs,bo.depth=Bn[cs].depth+1}else bo.holeOf=null,bo.depth=Bn[cs].depth}else bo.holeOf=null,bo.depth=0;return bo})(ci[On],Wi,gi),cn=function($r){po[$r]=!0,$r<ci.length&&ci[$r]&&(ci[$r].outputContourId=gi)},ei=On,Di=On;for(Jn.points.push(ci[On].point);cn(ei),cn(ei=ci[ei].otherPos),Jn.points.push(ci[ei].point),!((ei=ir(ei,ci,po,Di))==Di||ei>=ci.length)&&ci[ei];);Wi.push(Jn)}};for(On=0,wi=ci.length;On<wi;On++)Ai();return Wi})((function(Gr,On,wi,ci,po,Wi){for(var Ai,gi,Jn,cn=new d(dr),ei=[],Di=Math.min(ci[2],po[2]);Gr.length!==0;){var $r=Gr.pop();if(ei.push($r),Wi===k&&$r.point[0]>Di||Wi===W&&$r.point[0]>ci[2])break;if($r.left){gi=Ai=cn.insert($r),Ai=Ai!==(Jn=cn.minNode())?cn.prev(Ai):null,gi=cn.next(gi);var Bn=Ai?Ai.key:null;if(te($r,Bn,Wi),gi&&It($r,gi.key,Gr)===2&&(te($r,Bn,Wi),te(gi.key,$r,Wi)),Ai&&It(Ai.key,$r,Gr)===2){var qi=Ai;te(Bn,(qi=qi!==Jn?cn.prev(qi):null)?qi.key:null,Wi),te($r,Bn,Wi)}}else gi=Ai=cn.find($r=$r.otherEvent),Ai&&gi&&(Ai=Ai!==Jn?cn.prev(Ai):null,gi=cn.next(gi),cn.remove($r),gi&&Ai&&It(Ai.key,gi.key,Gr))}return ei})(Tr,0,0,gt,er,mt)),ln=[],Ur=0;Ur<wr.length;Ur++){var vr=wr[Ur];if(vr.isExterior()){for(var Hn=[vr.points],bi=0;bi<vr.holeIds.length;bi++)Hn.push(wr[vr.holeIds[bi]].points);ln.push(Hn)}}return ln}var no={UNION:$,DIFFERENCE:W,INTERSECTION:k,XOR:Q};o.diff=function(Ie,Se){return Qn(Ie,Se,W)},o.intersection=function(Ie,Se){return Qn(Ie,Se,k)},o.operations=no,o.union=function(Ie,Se){return Qn(Ie,Se,$)},o.xor=function(Ie,Se){return Qn(Ie,Se,Q)},Object.defineProperty(o,"__esModule",{value:!0})})(t)})(0,_L.exports)),_L.exports);function Ux(s,t,o,c){const d=[],m=c===0?(g,b,P,I,O,L)=>{g.push(new St(L,P+(L-b)/(I-b)*(O-P)))}:(g,b,P,I,O,L)=>{g.push(new St(b+(L-P)/(O-P)*(I-b),L))};for(const g of s){const b=[];for(const P of g){if(P.length<=2)continue;const I=[];for(let k=0;k<P.length-1;k++){const $=P[k].x,W=P[k].y,Q=P[k+1].x,te=P[k+1].y,ne=c===0?$:W,ue=c===0?Q:te;ne<t?ue>t&&m(I,$,W,Q,te,t):ne>o?ue<o&&m(I,$,W,Q,te,o):I.push(P[k]),ue<t&&ne>=t&&m(I,$,W,Q,te,t),ue>o&&ne<=o&&m(I,$,W,Q,te,o)}let O=P[P.length-1];const L=c===0?O.x:O.y;L>=t&&L<=o&&I.push(O),I.length&&(O=I[I.length-1],I[0].x===O.x&&I[0].y===O.y||I.push(I[0]),b.push(I))}b.length&&d.push(b)}return d}function GY(s,t){const o=VS(s),c=VS([t]),d=yL.intersection(o,c);return d==null?[]:vL(d)}function HY(s,t){let c=VS(s,65536);const d=[];for(;t.valid();t.next()){const[m,g]=t.get(),b=m.x*65536,P=m.y*65536,I=g.x*65536,O=g.y*65536,L=I-b,k=O-P,$=Math.hypot(L,k);if($===0)continue;const W=Math.trunc(k/$*3),Q=-Math.trunc(L/$*3);d.push([[[b,P],[I,O],[I+W,O+Q],[b+W,P+Q],[b,P]]])}return d.length>0&&(c=yL.diff(c,d)),vL(c,1/65536)}function VS(s,t=1){return[s.map((o=>o.map((c=>[c.x*t,c.y*t]))))]}function vL(s,t=1){return s.map((o=>o.map(((c,d)=>{const m=c.map((g=>new St(g[0]*t,g[1]*t).round()));return d>0&&m.reverse(),m}))))}class US{constructor(t,o){this.layoutVertexArray=new nl,this.indexArray=new Li,this.lineIndexArray=new Hl,this.triangleSegments=new Wn,this.lineSegments=new Wn,this.programConfigurations=new wl(t.layers,{zoom:t.zoom,lut:t.lut}),this.uploaded=!1,o&&(this.elevatedLayoutVertexArray=new Wc)}update(t,o,c,d,m,g,b,P){this.programConfigurations.updatePaintArrays(t,o,m,c,d,g,b,P)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,DY.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.lineIndexBuffer=t.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=t.createVertexBuffer(this.elevatedLayoutVertexArray,RY.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(t,o,c,d,m,g,b){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,c,d,m,g,void 0,b)}}class $S{constructor(t){this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=t.lut,this.bufferData=new US(t,!1),this.elevationBufferData=new US(t,!0),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.projection=t.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=t.sourceLayerIndex,this.worldview=t.worldview,this.hasAppearances=null}updateFootprints(t,o){}updateAppearances(t,o,c,d){}populate(t,o,c,d){this.hasPattern=jS("fill",this.layers,this.pixelRatio,o);const m=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:b,id:P,index:I,sourceLayerIndex:O}of t){const L=this.layers[0]._featureFilter.needGeometry,k=rt(b,L);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom,{worldview:this.worldview,activeFloors:o.activeFloors}),k,c))continue;const $=m?m.evaluate(k,{},c,o.availableImages):void 0,W={id:P,properties:b.properties,type:b.type,sourceLayerIndex:O,index:I,geometry:L?k.geometry:dt(b,c,d),patterns:{},sortKey:$};g.push(W)}m&&g.sort(((b,P)=>b.sortKey-P.sortKey));for(const b of g){const{geometry:P,index:I,sourceLayerIndex:O}=b;if(this.hasPattern){const L=NS("fill",this.layers,b,this.zoom,this.pixelRatio,o);this.patternFeatures.push(L)}else this.addFeature(b,P,I,c,{},o.availableImages,o.brightness,o.elevationFeatures);o.featureIndex.insert(t[I].feature,P,I,O,this.index)}}update(t,o,c,d,m,g,b){this.bufferData.update(t,o,c,d,m,g,b,this.worldview),this.elevationBufferData.update(t,o,c,d,m,g,b,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(t,o,c,d,m,g,b,this.worldview)}addFeatures(t,o,c,d,m,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,c,d,g,t.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(t){this.bufferData.upload(t),this.elevationBufferData.upload(t),this.elevatedStructures&&this.elevatedStructures.upload(t)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(t,o,c,d,m,g=[],b,P){const I=pv(o,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(t,I,d,c,P):this.addGeometry(I,this.bufferData),this.bufferData.populatePaintArrays(t,c,m,g,d,b,this.worldview),this.elevationBufferData.populatePaintArrays(t,c,m,g,d,b,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(t,o,c,d,m){this.elevatedStructures&&(this.elevatedStructures.construct(t),this.elevatedStructures.populatePaintArrays(o,c,d,m,this.worldview))}addElevatedRoadFeature(t,o,c,d,m){const g=new Array,b=qr.getElevationFeature(t,m);if(!b)return void this.addGeometry(o,this.bufferData);{const I=this.clipPolygonsToTile(o,1);I.length>0&&g.push({polygons:I,elevationFeature:b,elevationTileID:c})}const P={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(t,{},c),featureIndex:d};for(const I of g)if(I.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Gc(I.elevationTileID,this.layers,this.zoom,this.lut));const L=I.elevationFeature.isTunnel();let k=0;t.properties.hasOwnProperty(ur)&&(k=+t.properties[ur]);for(const $ of I.polygons)this.elevatedStructures.addPortalCandidates(I.elevationFeature.id,$,L,I.elevationFeature,k)}I.elevationFeature.constantHeight==null&&(I.polygons=this.prepareElevatedPolygons(I.polygons,I.elevationFeature,I.elevationTileID));const O=new En(c,I.elevationTileID);this.addElevatedGeometry(I.polygons,O,I.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,d,P)}}addElevatedGeometry(t,o,c,d,m,g){const b={elevation:c,elevationSampler:o,bias:d,index:m,featureInfo:g},[P,I]=this.addGeometry(t,this.elevationBufferData,b);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:P,max:I}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,P),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,I))}addGeometry(t,o,c){let d=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,g=null;c&&(g=c.elevationSampler.constantElevation(c.elevation,c.bias),g!=null&&(d=g,m=g));const b=(P,I,O)=>{if(c!=null)if(I.push(P),g!=null)o.elevatedLayoutVertexArray.emplaceBack(g),O.push(g);else{const L=c.elevationSampler.pointElevation(P,c.elevation,c.bias);o.elevatedLayoutVertexArray.emplaceBack(L),O.push(L),d=Math.min(d,L),m=Math.max(m,L)}};for(const P of t){let I=0;for(const he of P)I+=he.length;const O=o.triangleSegments.prepareSegment(I,o.layoutVertexArray,o.indexArray),L=O.vertexLength,k=[],$=[],W=[],Q=[],te=[],ne=o.layoutVertexArray.length;for(const he of P){if(he.length===0)continue;he!==P[0]&&$.push(k.length/2);const me=o.lineSegments.prepareSegment(he.length,o.layoutVertexArray,o.lineIndexArray),Ae=me.vertexLength;c&&te.push(o.layoutVertexArray.length-ne),b(he[0],W,Q),o.layoutVertexArray.emplaceBack(he[0].x,he[0].y),o.lineIndexArray.emplaceBack(Ae+he.length-1,Ae),k.push(he[0].x),k.push(he[0].y);for(let Pe=1;Pe<he.length;Pe++)b(he[Pe],W,Q),o.layoutVertexArray.emplaceBack(he[Pe].x,he[Pe].y),o.lineIndexArray.emplaceBack(Ae+Pe-1,Ae+Pe),k.push(he[Pe].x),k.push(he[Pe].y);me.vertexLength+=he.length,me.primitiveLength+=he.length}const ue=D_(k,$);for(let he=0;he<ue.length;he+=3)o.indexArray.emplaceBack(L+ue[he],L+ue[he+1],L+ue[he+2]);if(ue.length>0&&c&&this.elevationMode==="hd-road-base"){const he=c.elevation.isTunnel(),me=c.elevation.safeArea,Ae=this.elevatedStructures.addVertices(W,Q);this.elevatedStructures.addTriangles(ue,Ae,he);const Pe=te.length;if(Pe>0){for(let Fe=0;Fe<Pe-1;Fe++)this.elevatedStructures.addRenderableRing(c.index,te[Fe]+Ae,te[Fe+1]-te[Fe],he,me,c.featureInfo);this.elevatedStructures.addRenderableRing(c.index,te[Pe-1]+Ae,W.length-te[Pe-1],he,me,c.featureInfo)}}O.vertexLength+=I,O.primitiveLength+=ue.length/3}return[d,m]}prepareElevatedPolygons(t,o,c){const d=1/De(c),m=[];for(const g of t){const b=HY(g,new xi(o,d));m.push(...b)}return m}clipPolygonsToTile(t,o){const c=-o,d=-o,m=Ut+o,g=Ut+o;let b=0;const P=[],I=[];for(;b<t.length;b++){const k=t[b],$=Fl(k);($.min.x>=c&&$.max.x<=m&&$.min.y>=d&&$.max.y<=g?P:I).push(k)}if(P.length===t.length)return t;const O=[new St(c,d),new St(m,d),new St(m,g),new St(c,g),new St(c,d)],L=P;for(const k of I)L.push(...GY(k,O));return L}}let xL,bL,wL,SL;cr($S,"FillBucket",{omit:["layers","patternFeatures"]}),cr(US,"FillBufferData"),cr(Gc,"ElevatedStructures");class $x{constructor(t,o,c,d){if(this.triangleCount=o.length/3,this.min=new St(0,0),this.max=new St(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0)return;const[m,g]=[t[0].clone(),t[0].clone()];for(let L=1;L<t.length;++L){const k=t[L];m.x=Math.min(m.x,k.x),m.y=Math.min(m.y,k.y),g.x=Math.max(g.x,k.x),g.y=Math.max(g.y,k.y)}if(d){const L=Math.ceil(Math.max(g.x-m.x,g.y-m.y)/d);c=Math.max(c,L)}if(c===0)return;this.min=m,this.max=g;const b=this.max.sub(this.min);b.x=Math.max(b.x,1),b.y=Math.max(b.y,1);const P=Math.max(b.x,b.y)/c;this.cellsX=Math.max(1,Math.ceil(b.x/P)),this.cellsY=Math.max(1,Math.ceil(b.y/P)),this.xScale=1/P,this.yScale=1/P;const I=[];for(let L=0;L<this.triangleCount;L++){const k=t[o[3*L+0]].sub(this.min),$=t[o[3*L+1]].sub(this.min),W=t[o[3*L+2]].sub(this.min),Q=_f(Math.floor(Math.min(k.x,$.x,W.x)),this.xScale,this.cellsX),te=_f(Math.floor(Math.max(k.x,$.x,W.x)),this.xScale,this.cellsX),ne=_f(Math.floor(Math.min(k.y,$.y,W.y)),this.yScale,this.cellsY),ue=_f(Math.floor(Math.max(k.y,$.y,W.y)),this.yScale,this.cellsY),he=new St(0,0),me=new St(0,0),Ae=new St(0,0),Pe=new St(0,0);for(let Fe=ne;Fe<=ue;++Fe){he.y=me.y=Fe*P,Ae.y=Pe.y=(Fe+1)*P;for(let Be=Q;Be<=te;++Be)he.x=Ae.x=Be*P,me.x=Pe.x=(Be+1)*P,(yo(k,$,W,he,me,Pe)||yo(k,$,W,he,Pe,Ae))&&I.push({cellIdx:Fe*this.cellsX+Be,triIdx:L})}}if(I.length===0)return;I.sort(((L,k)=>L.cellIdx-k.cellIdx||L.triIdx-k.triIdx));let O=0;for(;O<I.length;){const L=I[O].cellIdx,k={start:this.payload.length,len:0};for(;O<I.length&&I[O].cellIdx===L;)++k.len,this.payload.push(I[O++].triIdx);this.cells[L]=k}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(t,o){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>t.x||t.y>this.max.y||this.min.y>t.y)return;const c=_f(t.x-this.min.x,this.xScale,this.cellsX),d=_f(t.y-this.min.y,this.yScale,this.cellsY),m=this.cells[d*this.cellsX+c];if(m){this._lazyInitLookup();for(let g=0;g<m.len;g++){const b=this.payload[m.start+g],P=Math.floor(b/8),I=1<<b%8;if(!(this.lookup[P]&I)&&(this.lookup[P]|=I,o.push(b),o.length===this.triangleCount))return}}}query(t,o,c){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>o.x||t.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const d=_f(t.x-this.min.x,this.xScale,this.cellsX),m=_f(o.x-this.min.x,this.xScale,this.cellsX),g=_f(t.y-this.min.y,this.yScale,this.cellsY),b=_f(o.y-this.min.y,this.yScale,this.cellsY);for(let P=g;P<=b;P++)for(let I=d;I<=m;I++){const O=this.cells[P*this.cellsX+I];if(O)for(let L=0;L<O.len;L++){const k=this.payload[O.start+L],$=Math.floor(k/8),W=1<<k%8;if(!(this.lookup[$]&W)&&(this.lookup[$]|=W,c.push(k),c.length===this.triangleCount))return}}}}function _f(s,t,o){return Math.max(0,Math.min(o-1,Math.floor(s*t)))}cr($x,"TriangleGridIndex");class TL{constructor(t){this.zoom=t.zoom,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.footprints=[],this.worldview=t.worldview,this.hasAppearances=null}updateFootprints(t,o){for(const c of this.footprints)o.push({footprint:c,id:t})}updateAppearances(t,o,c,d){}populate(t,o,c,d){const m=[];for(const{feature:g,id:b,index:P,sourceLayerIndex:I}of t){const O=this.layers[0]._featureFilter.needGeometry,L=rt(g,O);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom,{worldview:this.worldview,activeFloors:o.activeFloors}),L,c))continue;const k={id:b,properties:g.properties,type:g.type,sourceLayerIndex:I,index:P,geometry:O?L.geometry:dt(g,c,d),patterns:{}};m.push(k)}for(const g of m){const{geometry:b,index:P,sourceLayerIndex:I}=g;this.addFeature(g,b,P,c,{},o.availableImages,o.brightness),o.featureIndex.insert(t[P].feature,b,P,I,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(t){}update(t,o,c,d,m,g,b){}destroy(){}addFeature(t,o,c,d,m,g=[],b){for(const P of pv(o,2)){const I=[],O=[],L=[],k=new St(1/0,1/0),$=new St(-1/0,-1/0);for(const te of P)if(te.length!==0){te!==P[0]&&L.push(O.length/2);for(let ne=0;ne<te.length;ne++)O.push(te[ne].x),O.push(te[ne].y),I.push(te[ne]),k.x=Math.min(k.x,te[ne].x),k.y=Math.min(k.y,te[ne].y),$.x=Math.max($.x,te[ne].x),$.y=Math.max($.y,te[ne].y)}const W=D_(O,L),Q=new $x(I,W,8,256);this.footprints.push({vertices:I,indices:W,grid:Q,min:k,max:$})}}}cr(TL,"ClipBucket",{omit:["layers"]});const YY=pn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ZY=pn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),XY=pn([{name:"a_flood_light_ground_radius",components:1,type:"Float32"}]),KY=pn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),QY=pn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),JY=pn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),eZ=pn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:tZ}=YY,mv=Number.MAX_SAFE_INTEGER,EL=mv-1;function PL(s,t,o,c){return s.order<t||s.order===mv||!(s.clipMask&o)||(function(d,m){return m.length!==0&&m.find((g=>g===d))===void 0})(c,s.clipScope)}function Wx(s,t){return s.x-t.x||s.y-t.y}function IL(s,t){return Wx(s.min,t.min)===0&&Wx(s.max,t.max)===0}function WS(s,t){return!(s.min.x>t.max.x||s.max.x<t.min.x||s.min.y>t.max.y||s.max.y<t.min.y)}function qx(s,t){if(s.length!==t.length)return!1;for(let o=0;o<s.length;o++)if(s[o].sourceId!==t[o].sourceId||!IL(s[o],t[o])||s[o].order!==t[o].order||s[o].clipMask!==t[o].clipMask||!Ns(s[o].clipScope,t[o].clipScope))return!1;return!0}function ML(s,t,o){const c=1/Ut,d=1/(1<<o.canonical.z),m=(t.x*c+o.canonical.x)*d+o.wrap,g=(t.y*c+o.canonical.y)*d;return{min:new St((s.x*c+o.canonical.x)*d+o.wrap,(s.y*c+o.canonical.y)*d),max:new St(m,g)}}function rZ(s,t,o){const c=1<<o.canonical.z,d=((t.x-o.wrap)*c-o.canonical.x)*Ut,m=(t.y*c-o.canonical.y)*Ut;return{min:new St(((s.x-o.wrap)*c-o.canonical.x)*Ut,(s.y*c-o.canonical.y)*Ut),max:new St(d,m)}}function qS(s,t,o,c,d,m,g){const b=s.indices,P=s.vertices,I=[];for(let O=c;O<c+d;O+=3){const L=t[o[O+0]+m],k=t[o[O+1]+m],$=t[o[O+2]+m],W=Math.min(L.x,k.x,$.x),Q=Math.max(L.x,k.x,$.x),te=Math.min(L.y,k.y,$.y),ne=Math.max(L.y,k.y,$.y);I.length=0,s.grid.query(new St(W,te),new St(Q,ne),I);for(let ue=0;ue<I.length;ue++){const he=I[ue];if(yo(P[b[3*he+0]],P[b[3*he+1]],P[b[3*he+2]],L,k,$,g))return!0}}return!1}function CL(s,t,o,c){if(!s||!o)return!1;let d=s.vertices;if(!t.canonical.equals(c.canonical)||t.wrap!==c.wrap){if(o.vertices.length<s.vertices.length)return CL(o,c,s,t);const m=t.canonical,g=c.canonical,b=Math.pow(2,g.z-m.z);d=s.vertices.map((P=>new St((P.x+m.x*Ut)*b-g.x*Ut,(P.y+m.y*Ut)*b-g.y*Ut)))}return qS(o,d,s.indices,0,s.indices.length,0,0)}function AL(s,t,o,c){const d=Math.pow(2,c.z-o.z);return new St((s+o.x*Ut)*d-c.x*Ut,(t+o.y*Ut)*d-c.y*Ut)}function GS(s,t){const o=[];t.grid.queryPoint(s,o);const c=t.indices,d=t.vertices;for(let m=0;m<o.length;m++){const g=o[m];if(is([d[c[3*g+0]],d[c[3*g+1]],d[c[3*g+2]]],s))return!0}return!1}const HS=[new St(0,0),new St(Ut,0),new St(Ut,Ut),new St(0,Ut)];function DL(s,t){const o=[];let c=[];if(!t||s.length<2)return[s];if(s.length===2)return ao(s[0],s[1],HS)?[s]:[];for(let d=0;d<s.length+2;d++){const m=s[d%s.length],g=s[(d+1)%s.length],b=ao(d===0?s[s.length-1]:s[(d-1)%s.length],m,HS),P=ao(m,g,HS),I=b||P;I&&c.push(m),I&&P||c.length>0&&(c.length>1&&o.push(c),c=[])}return c.length>1&&o.push(c),o}const YS=Mt.types,nZ=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],iZ=["fill-extrusion-flood-light-ground-radius"],oZ=Math.pow(2,13),sZ=Math.pow(2,15)-1,RL=new St(0,1),Sm=2147483648,OL=7,LL=450;function gv(s,t,o,c,d,m,g,b){s.emplaceBack((t<<1)+g,(o<<1)+m,(Math.floor(c*oZ)<<1)+d,Math.round(b))}function _v(s,t,o){s.emplaceBack(t.x*Ut,t.y*Ut,o?1:0)}function Gx(s,t,o,c,d,m){s.emplaceBack(t.x,t.y,(o.x<<1)+c,(o.y<<1)+d,m)}function yv(s,t,o){s.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class zL{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class FL{constructor(){this.centroidXY=new St(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new St(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new St(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new St(this.max.x-this.min.x,this.max.y-this.min.y)}}class kL{constructor(){this.acc=new St(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,o){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=o.x,t.min.y=t.max.y=o.y)}appendEdge(t,o,c){this.accCount++,this.acc._add(o);let d=!!this.borders;o.x<t.min.x?(t.min.x=o.x,d=!0):o.x>t.max.x&&(t.max.x=o.x,d=!0),o.y<t.min.y?(t.min.y=o.y,d=!0):o.y>t.max.y&&(t.max.y=o.y,d=!0),((o.x===0||o.x===Ut)&&o.x===c.x)!=((o.y===0||o.y===Ut)&&o.y===c.y)&&this.processBorderOverlap(o,c),d&&this.checkBorderIntersection(o,c)}checkBorderIntersection(t,o){o.x<0!=t.x<0&&this.addBorderIntersection(0,Lr(o.y,t.y,(0-o.x)/(t.x-o.x))),o.x>Ut!=t.x>Ut&&this.addBorderIntersection(1,Lr(o.y,t.y,(Ut-o.x)/(t.x-o.x))),o.y<0!=t.y<0&&this.addBorderIntersection(2,Lr(o.x,t.x,(0-o.y)/(t.y-o.y))),o.y>Ut!=t.y>Ut&&this.addBorderIntersection(3,Lr(o.x,t.x,(Ut-o.y)/(t.y-o.y)))}addBorderIntersection(t,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[t];o<c[0]&&(c[0]=o),o>c[1]&&(c[1]=o)}processBorderOverlap(t,o){if(t.x===o.x){if(t.y===o.y)return;const c=t.x===0?0:1;this.addBorderIntersection(c,o.y),this.addBorderIntersection(c,t.y)}else{const c=t.y===0?2:3;this.addBorderIntersection(c,o.x),this.addBorderIntersection(c,t.x)}}centroid(){return this.accCount===0?new St(0,0):new St(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((t,o)=>t+ +(o[0]!==Number.MAX_VALUE)),0):0}}function BL(s,t){const o=s.add(t)._unit(),c=le(s.x*o.x+s.y*o.y,-1,1);var d,m,g;return d=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(d)))/4*sZ*((m=s).x*(g=t).y-m.y*g.x<0?-1:1)}const aZ=[s=>s.x<0,s=>s.x>Ut,s=>s.y<0,s=>s.y>Ut];function lZ(s,t,o,c){const d=[4];if(c===0)return d;o._mult(c);const m=s.sub(o),g=t.sub(o),b=[s,t,m,g];for(let P=0;P<4;P++)for(const I of b)if(aZ[P](I)){d.push(P);break}return d}class ZS{constructor(t){this.groundRadiusArray=null,this.groundRadiusBuffer=null,this.vertexArray=new hp,this.indexArray=new Li,this.programConfigurations=new wl(t.layers,{zoom:t.zoom,lut:t.lut},(o=>iZ.includes(o))),this._segments=new Wn,this.hiddenByLandmarkVertexArray=new uh,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Wn}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,o,c,d=!1){const m=t.length;if(m>2){let g=Math.max(0,this._segments.get().length-1);const b=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[g].length);let P;g!==this._segments.get().length-1&&(g++,this._segmentToGroundQuads[g]=[],this._segmentToRegionTriCounts[g]=[0,0,0,0,0]);{const I=t[0],O=t[1];P=BL(I.sub(t[m-1])._perp()._unit(),O.sub(I)._perp()._unit())}for(let I=0;I<m;I++){const O=I===m-1?0:I+1,L=t[I],k=t[O],$=t[O===m-1?0:O+1],W=k.sub(L)._perp()._unit(),Q=BL(W,$.sub(k)._perp()._unit()),te=P,ne=Q;if(XS(L,k,o)||d&&VL(L,o)&&VL(k,o)){P=Q;continue}const ue=b.vertexLength;Gx(this.vertexArray,L,k,1,1,te),Gx(this.vertexArray,L,k,1,0,te),Gx(this.vertexArray,L,k,0,1,ne),Gx(this.vertexArray,L,k,0,0,ne),b.vertexLength+=4;const he=lZ(L,k,W,c);for(const me of he)this._segmentToGroundQuads[g].push({id:ue,region:me}),this._segmentToRegionTriCounts[g][me]+=2,b.primitiveLength+=2;P=Q}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),o=t.length;for(let c=0;c<o;c++)this._segmentToGroundQuads[c].sort(((d,m)=>d.region-m.region));for(let c=0;c<o;c++){const d=this._segmentToGroundQuads[c],m=t[c],g=this._segmentToRegionTriCounts[c];g.reduce(((P,I)=>P+I),0);let b=0;for(let P=0;P<=4;P++){const I=g[P];if(I!==0){let O=this.regionSegments[P];O||(O=this.regionSegments[P]=new Wn);const L={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+b,vertexLength:m.vertexLength,primitiveLength:I};O.get().push(L)}b+=I}for(let P=0;P<d.length;P++){const I=d[P].id;this.indexArray.emplaceBack(I,I+1,I+3),this.indexArray.emplaceBack(I,I+3,I+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,o,c,d,m,g,b){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,o,c,d,m,g,void 0,b)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,ZY.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.groundRadiusArray!=null&&(this.groundRadiusBuffer=t.createVertexBuffer(this.groundRadiusArray,XY.members)))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,o,c,d,m,g,b,P){this.hasData()&&this.programConfigurations.updatePaintArrays(t,o,c,d,m,g,b,P)}updateHiddenByLandmark(t){this.updateHiddenByLandmarkRange(t.groundVertexArrayOffset,t.groundVertexCount,!!(t.flags&Sm))}updateHiddenByLandmarkRange(t,o,c){if(!this.hasData())return;const d=o+t;if(o!==0){for(let m=t;m<d;++m)this.hiddenByLandmarkVertexArray.emplace(m,c?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,JY.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this.groundRadiusBuffer&&this.groundRadiusBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const o=this.regionSegments[t];o&&o.destroy()}}}}class Hx{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.pixelRatio=t.pixelRatio,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Li,this.footprintVertices=new nl,this.footprintSegments=[],this.layoutVertexArray=new $a,this.centroidVertexArray=new xg,this.wallVertexArray=new Ma,this.indexArray=new Li,this.programConfigurations=new wl(t.layers,{zoom:t.zoom,lut:t.lut},(o=>nZ.includes(o))),this.segments=new Wn,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.groundEffect=new ZS(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=t.worldview,this.hasAppearances=null}updateFootprints(t,o){}updateAppearances(t,o,c,d){}populate(t,o,c,d){this.features=[],this.hasPattern=jS("fill-extrusion",this.layers,this.pixelRatio,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=De(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:m,id:g,index:b,sourceLayerIndex:P}of t){const I=this.layers[0]._featureFilter.needGeometry,O=rt(m,I);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom,{worldview:this.worldview,activeFloors:o.activeFloors}),O,c))continue;const L={id:g,sourceLayerIndex:P,index:b,geometry:I?O.geometry:dt(m,c,d),properties:m.properties,type:m.type,patterns:{}},k=this.layoutVertexArray.length,$=YS[L.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:m.id,feature:NS("fill-extrusion",this.layers,L,this.zoom,this.pixelRatio,o)});else if(this.wallMode)for(const W of L.geometry)for(const Q of DL(W,$))this.addFeature(m.id,L,[Q],b,c,{},o.availableImages,d,o.brightness);else this.addFeature(m.id,L,L.geometry,b,c,{},o.availableImages,d,o.brightness);o.featureIndex.insert(m,L.geometry,b,P,this.index,k)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,o,c,d,m,g){for(const{featureId:b,feature:P}of this.features){const I=YS[P.type]==="Polygon",{geometry:O}=P;if(this.wallMode)for(const L of O)for(const k of DL(L,I))this.addFeature(b,P,[k],P.index,o,c,d,m,g);else this.addFeature(b,P,O,P.index,o,c,d,m,g)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,o,c,d,m,g,b){this.programConfigurations.updatePaintArrays(t,o,m,c,d,g,b,this.worldview),this.groundEffect.update(t,o,m,c,d,g,b,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tZ),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.wallVertexBuffer=t.createVertexBuffer(this.wallVertexArray,QY.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,eZ.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,KY.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,c,d,m,g,b,P,I){const O=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,L=[new St(0,0),new St(Ut,Ut)],k=P.projection,$=k.name==="globe",W=this.wallMode||YS[o.type]==="Polygon",Q=new kL;Q.centroidDataIndex=this.centroidData.length;const te=new FL;te.buildingId=t,o.properties&&o.properties.hasOwnProperty("building_id")&&(te.buildingId=o.properties.building_id);const ne=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},m)<=0,ue=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},m);let he;if(te.height=ue,te.vertexArrayOffset=this.layoutVertexArray.length,te.groundVertexArrayOffset=this.groundEffect.vertexArray.length,$&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new of),this.wallMode){if($)return void Cr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(c.length!==1)return;he=(function(Ze){const ft=Ze[0].x===Ze[Ze.length-1].x&&Ze[0].y===Ze[Ze.length-1].y;(function(ir){let Jt=0;const Hr=ir.length;for(let rr=0;rr<Hr;rr++)Jt+=(ir[(rr+1)%Hr].x-ir[rr].x)*(ir[(rr+1)%Hr].y+ir[rr].y);return Jt>=0})(Ze)||(Ze=Ze.reverse());const Ct={geometry:[],joinNormals:[],indices:[]},Wt=[],Rt=[],wt=[];let Dt=Ze.length;for(;Dt>=2&&Ze[Dt-1].equals(Ze[Dt-2]);)Dt--;if(Dt<(ft?3:2))return Ct;let ot,it,At,jt,It,dr=0;for(;dr<Dt-1&&Ze[dr].equals(Ze[dr+1]);)dr++;ft&&(ot=Ze[Dt-2],It=Ze[dr].sub(ot)._unit()._perp());for(let ir=dr;ir<Dt;ir++){if(At=ir===Dt-1?ft?Ze[dr+1]:void 0:Ze[ir+1],At&&Ze[ir].equals(At))continue;It&&(jt=It),ot&&(it=ot),ot=Ze[ir],It=At?At.sub(ot)._unit()._perp():jt,jt=jt||It;let Jt=jt.add(It);Jt.x===0&&Jt.y===0||Jt._unit();const Hr=Jt.x*It.x+Jt.y*It.y,rr=Hr!==0?1/Hr:1/0,Rr=jt.x*It.y-jt.y*It.x>0;let Qr="miter";const gn=2;Qr==="miter"&&rr>gn&&(Qr="bevel"),Qr==="bevel"&&(rr>100&&(Qr="flipbevel"),rr<gn&&(Qr="miter"));const kn=(tn,Kn,Qn,no)=>{const Ie=new St(tn.x,tn.y),Se=new St(tn.x,tn.y);Ie.x+=Kn.x*no,Ie.y+=Kn.y*no,Se.x-=Kn.x*Math.max(Qn,1),Se.y-=Kn.y*Math.max(Qn,1),wt.push(Kn),Wt.push(Ie),Rt.push(Se)};if(Qr==="miter")Jt._mult(rr),kn(ot,Jt,0,0);else if(Qr==="flipbevel")Jt=It.mult(-1),kn(ot,Jt,0,0),kn(ot,Jt.mult(-1),0,0);else{const tn=-Math.sqrt(rr*rr-1),Kn=Rr?tn:0,Qn=Rr?0:tn;it&&kn(ot,jt,Kn,Qn),At&&kn(ot,It,Kn,Qn)}}Ct.geometry=[...Wt,...Rt.reverse(),Wt[0]],Ct.joinNormals=[...wt,...wt.reverse(),wt[wt.length-1]];const _r=Ct.geometry.length-1;for(let ir=0;ir<_r/2;ir++)if(ir+1<_r/2){let Jt=ir,Hr=ir+1,rr=_r-1-ir,Rr=_r-2-ir;Jt=Jt===0?_r-1:Jt-1,Hr=Hr===0?_r-1:Hr-1,rr=rr===0?_r-1:rr-1,Rr=Rr===0?_r-1:Rr-1,Ct.indices.push(rr),Ct.indices.push(Hr),Ct.indices.push(Jt),Ct.indices.push(rr),Ct.indices.push(Rr),Ct.indices.push(Hr)}return Ct})(c[0]),c=[he.geometry]}const me=(Ze,ft)=>Ze<(ft.length-1)/2||Ze===ft.length-1,Ae=this.wallMode?[c]:pv(c,500);for(let Ze=Ae.length-1;Ze>=0;Ze--){const ft=Ae[Ze];(ft.length===0||(Pe=ft[0]).every((xt=>xt.x<=0))||Pe.every((xt=>xt.x>=Ut))||Pe.every((xt=>xt.y<=0))||Pe.every((xt=>xt.y>=Ut)))&&Ae.splice(Ze,1)}var Pe;let Fe;if($)Fe=qL(Ae,L,m);else{Fe=[];for(const Ze of Ae)Fe.push({polygon:Ze,bounds:L})}const Be=W?this.edgeRadius:0,Ve=Be>0&&this.zoom<17,at=(Ze,ft)=>{if(Ze.length===0)return!1;const xt=Ze[Ze.length-1];return ft.x===xt.x&&ft.y===xt.y};for(const{polygon:Ze,bounds:ft}of Fe){let xt=0,Ct=0;for(const Dt of Ze)W&&!Dt[0].equals(Dt[Dt.length-1])&&Dt.push(Dt[0]),Ct+=W?Dt.length-1:Dt.length;const Wt=this.segments.prepareSegment((W?5:4)*Ct,this.layoutVertexArray,this.indexArray);te.footprintSegIdx<0&&(te.footprintSegIdx=this.footprintSegments.length),te.polygonSegIdx<0&&(te.polygonSegIdx=this.polygonSegments.length);const Rt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},wt=new zL;if(wt.vertexOffset=this.footprintVertices.length,wt.indexOffset=3*this.footprintIndices.length,wt.ringIndices=[],W){const Dt=[],ot=[];xt=Wt.vertexLength;for(let At=0;At<Ze.length;At++){const jt=Ze[At];jt.length&&At!==0&&ot.push(Dt.length/2);const It=[];let dr,_r;dr=jt[1].sub(jt[0])._perp()._unit(),wt.ringIndices.push(jt.length-1);for(let ir=1;ir<jt.length;ir++){const Jt=jt[ir],Hr=jt[ir===jt.length-1?1:ir+1],rr=Jt.clone();if(Be){_r=Hr.sub(Jt)._perp()._unit();const Rr=dr.add(_r)._unit(),Qr=Be*Math.min(4,1/(dr.x*Rr.x+dr.y*Rr.y));rr.x+=Qr*Rr.x,rr.y+=Qr*Rr.y,rr.x=Math.round(rr.x),rr.y=Math.round(rr.y),dr=_r}if(!ne||Be!==0&&!Ve||at(It,rr)||It.push(rr),gv(this.layoutVertexArray,rr.x,rr.y,0,0,1,1,0),this.wallMode){const Rr=me(ir,jt);_v(this.wallVertexArray,he.joinNormals[ir],!Rr)}Wt.vertexLength++,this.footprintVertices.emplaceBack(Jt.x,Jt.y),Dt.push(Jt.x,Jt.y),$&&yv(this.layoutVertexExtArray,k.projectTilePoint(rr.x,rr.y,m),k.upVector(m,rr.x,rr.y))}ne&&(Be===0||Ve)&&(It.length!==0&&at(It,It[0])&&It.pop(),this.groundEffect.addData(It,ft,O))}const it=this.wallMode?he.indices:D_(Dt,ot);for(let At=0;At<it.length;At+=3)this.footprintIndices.emplaceBack(wt.vertexOffset+it[At+0],wt.vertexOffset+it[At+1],wt.vertexOffset+it[At+2]),this.indexArray.emplaceBack(xt+it[At],xt+it[At+2],xt+it[At+1]),Wt.primitiveLength++;wt.indexCount+=it.length,wt.vertexCount+=this.footprintVertices.length-wt.vertexOffset}for(let Dt=0;Dt<Ze.length;Dt++){const ot=Ze[Dt];Q.startRing(te,ot[0]);let it=ot.length>4&&UL(ot[ot.length-2],ot[0],ot[1]),At=Be?cZ(ot[ot.length-2],ot[0],ot[1],Be):0;const jt=[];let It,dr,_r;dr=ot[1].sub(ot[0])._perp()._unit();let ir=!0;for(let Jt=1,Hr=0;Jt<ot.length;Jt++){let rr=ot[Jt-1],Rr=ot[Jt];const Qr=ot[Jt===ot.length-1?1:Jt+1];if(Q.appendEdge(te,Rr,rr),XS(Rr,rr,ft)){Be&&(dr=Qr.sub(Rr)._perp()._unit(),ir=!ir);continue}const gn=Rr.sub(rr)._perp(),kn=gn.x/(Math.abs(gn.x)+Math.abs(gn.y)),tn=gn.y>0?1:0,Kn=rr.dist(Rr);if(Hr+Kn>32768&&(Hr=0),Be){_r=Qr.sub(Rr)._perp()._unit();let Se=NL(rr,Rr,Qr,jL(dr,_r),Be);isNaN(Se)&&(Se=0);const mt=Rr.sub(rr)._unit();rr=rr.add(mt.mult(At))._round(),Rr=Rr.add(mt.mult(-Se))._round(),At=Se,dr=_r,ne&&this.zoom>=17&&(at(jt,rr)||jt.push(rr),at(jt,Rr)||jt.push(Rr))}const Qn=Wt.vertexLength,no=ot.length>4&&UL(rr,Rr,Qr);let Ie=$L(Hr,it,ir);if(gv(this.layoutVertexArray,rr.x,rr.y,kn,tn,0,0,Ie),gv(this.layoutVertexArray,rr.x,rr.y,kn,tn,0,1,Ie),this.wallMode){const Se=me(Jt-1,ot),mt=he.joinNormals[Jt-1];_v(this.wallVertexArray,mt,Se),_v(this.wallVertexArray,mt,Se)}if(Hr+=Kn,Ie=$L(Hr,no,!ir),it=no,gv(this.layoutVertexArray,Rr.x,Rr.y,kn,tn,0,0,Ie),gv(this.layoutVertexArray,Rr.x,Rr.y,kn,tn,0,1,Ie),this.wallMode){const Se=me(Jt,ot),mt=he.joinNormals[Jt];_v(this.wallVertexArray,mt,Se),_v(this.wallVertexArray,mt,Se)}if(Wt.vertexLength+=4,this.indexArray.emplaceBack(Qn+0,Qn+1,Qn+2),this.indexArray.emplaceBack(Qn+1,Qn+3,Qn+2),Wt.primitiveLength+=2,Be){const Se=xt+(Jt===1?ot.length-2:Jt-2),mt=Jt===1?xt:Se+1;if(this.indexArray.emplaceBack(Qn+1,Se,Qn+3),this.indexArray.emplaceBack(Se,mt,Qn+3),Wt.primitiveLength+=2,It===void 0&&(It=Qn),!XS(Qr,ot[Jt],ft)){const Zt=Jt===ot.length-1?It:Wt.vertexLength;this.indexArray.emplaceBack(Qn+2,Qn+3,Zt),this.indexArray.emplaceBack(Qn+3,Zt+1,Zt),this.indexArray.emplaceBack(Qn+3,mt,Zt+1),Wt.primitiveLength+=3}ir=!ir}if($){const Se=this.layoutVertexExtArray,mt=k.projectTilePoint(rr.x,rr.y,m),Zt=k.projectTilePoint(Rr.x,Rr.y,m),gt=k.upVector(m,rr.x,rr.y),er=k.upVector(m,Rr.x,Rr.y);yv(Se,mt,gt),yv(Se,mt,gt),yv(Se,Zt,er),yv(Se,Zt,er)}}W&&(xt+=ot.length-1),ne&&Be&&this.zoom>=17&&(jt.length!==0&&at(jt,jt[0])&&jt.pop(),this.groundEffect.addData(jt,ft,O,Be>0))}this.footprintSegments.push(wt),Rt.triangleCount=this.indexArray.length-Rt.triangleArrayOffset,this.polygonSegments.push(Rt),++te.footprintSegLen,++te.polygonSegLen}if(te.vertexCount=this.layoutVertexArray.length-te.vertexArrayOffset,te.groundVertexCount=this.groundEffect.vertexArray.length-te.groundVertexArrayOffset,te.vertexCount!==0){if(te.centroidXY=Q.borders?RL:this.encodeCentroid(Q,te),this.centroidData.push(te),Q.borders){this.featuresOnBorder.push(Q);const Ze=this.featuresOnBorder.length-1;for(let ft=0;ft<Q.borders.length;ft++)Q.borders[ft][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ft].push(Ze)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,g,b,m,I,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(o,d,g,b,m,I,this.worldview),this.maxHeight=Math.max(this.maxHeight,ue)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort(((o,c)=>this.featuresOnBorder[o].borders[t][0]-this.featuresOnBorder[c].borders[t][0]))}splitToSubtiles(){const t=[];for(let b=0;b<this.centroidData.length;b++){const P=this.centroidData[b],I=+(P.min.y+P.max.y>Ut),O=2*I+(+(P.min.x+P.max.x>Ut)^I);for(let L=0;L<P.polygonSegLen;L++){const k=P.polygonSegIdx+L;t.push({centroidIdx:b,subtile:O,polygonSegmentIdx:k,triangleSegmentIdx:this.polygonSegments[k].triangleSegIdx})}}const o=new Li;t.sort(((b,P)=>b.triangleSegmentIdx===P.triangleSegmentIdx?b.subtile-P.subtile:b.triangleSegmentIdx-P.triangleSegmentIdx));let c=0,d=0,m=0;for(const b of t){if(b.triangleSegmentIdx!==c)break;m++}const g=t.length;for(;d!==t.length;){c=t[d].triangleSegmentIdx;let b=0,P=d,I=d;for(let O=P;O<m&&t[O].subtile===b;O++)I++;for(;P!==m;){const O=t[P];b=O.subtile;const L=this.centroidData[O.centroidIdx].min.clone(),k=this.centroidData[O.centroidIdx].max.clone(),$={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let W=P;W<I;W++){const Q=t[W],te=this.polygonSegments[Q.polygonSegmentIdx],ne=this.centroidData[Q.centroidIdx].min,ue=this.centroidData[Q.centroidIdx].max,he=this.indexArray.uint16;for(let me=te.triangleArrayOffset;me<te.triangleArrayOffset+te.triangleCount;me++)o.emplaceBack(he[3*me],he[3*me+1],he[3*me+2]);$.primitiveLength+=te.triangleCount,L.x=Math.min(L.x,ne.x),L.y=Math.min(L.y,ne.y),k.x=Math.max(k.x,ue.x),k.y=Math.max(k.y,ue.y)}$.primitiveLength>0&&this.triangleSubSegments.push({segment:$,min:L,max:k}),P=I;for(let W=P;W<m&&t[W].subtile===t[P].subtile;W++)I++}d=m;for(let O=d;O<g&&t[O].triangleSegmentIdx===t[d].triangleSegmentIdx;O++)m++}o._trim(),this.indexArray=o}getVisibleSegments(t,o,c){const d=new Wn;if(this.wallMode){for(const Q of this.triangleSubSegments)d.segments.push(Q.segment);return d}let m=0,g=0;const b=1<<t.canonical.z;if(o){const Q=o.getMinMaxForTile(t);Q&&(m=Q.min,g=Q.max)}g+=this.maxHeight;const P=t.toUnwrapped();let I;const O=[P.canonical.x/b+P.wrap,P.canonical.y/b],L=[(P.canonical.x+1)/b+P.wrap,(P.canonical.y+1)/b],k=(Q,te,ne)=>[Q[0]*(1-ne[0])+te[0]*ne[0],Q[1]*(1-ne[1])+te[1]*ne[1]],$=[],W=[];for(const Q of this.triangleSubSegments){$[0]=Q.min.x/Ut,$[1]=Q.min.y/Ut,W[0]=Q.max.x/Ut,W[1]=Q.max.y/Ut;const te=k(O,L,$),ne=k(O,L,W);if(new Jr([te[0],te[1],m],[ne[0],ne[1],g]).intersectsPrecise(c)===0){I&&(d.segments.push(I),I=void 0);continue}const ue=Q.segment;I&&I.vertexOffset!==ue.vertexOffset&&(d.segments.push(I),I=void 0),I?(I.vertexLength+=ue.vertexLength,I.primitiveLength+=ue.primitiveLength):I={vertexOffset:ue.vertexOffset,primitiveLength:ue.primitiveLength,vertexLength:ue.vertexLength,primitiveOffset:ue.primitiveOffset,sortKey:void 0,vaos:{}}}return I&&d.segments.push(I),d}encodeCentroid(t,o){const c=t.centroid(),d=o.span(),m=Math.min(7,Math.round(d.x*this.tileToMeter/10)),g=Math.min(7,Math.round(d.y*this.tileToMeter/10));return new St(le(c.x,1,Ut-1)<<3|m,le(c.y,1,Ut-1)<<3|g)}encodeBorderCentroid(t){if(!t.borders)return new St(0,0);const o=t.borders,c=Number.MAX_VALUE;if(o[0][0]!==c||o[1][0]!==c){const d=o[0][0]!==c?0:1;return new St(6|(o[0][0]!==c?0:65528),(o[d][0]+o[d][1])/2<<3|6)}{const d=o[2][0]!==c?2:3;return new St((o[d][0]+o[d][1])/2<<3|6,6|(o[2][0]!==c?0:65528))}}showCentroid(t){const o=this.centroidData[t.centroidDataIndex];o.flags&=2147483647,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const o=t.vertexArrayOffset,c=t.vertexCount+t.vertexArrayOffset,d=t.flags&Sm?RL:t.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==d.y||m!==d.x){for(let g=o;g<c;++g)this.centroidVertexArray.emplace(g,d.x,d.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,o,c){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const d=o.getReplacementRegionsForTile(t.toUnwrapped());if(qx(this.activeReplacements,d))return;if(this.activeReplacements=d,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const g of this.centroidData)g.flags&=2147483647;const m=[];for(const g of this.activeReplacements){if(g.order<c)continue;const b=Math.max(1,Math.pow(2,g.footprintTileId.canonical.z-t.canonical.z));if(g.footprint.buildingId){const P=g.footprint.buildingId;for(const I of this.centroidData)I.buildingId===P&&(I.flags|=Sm)}else for(const P of this.centroidData)if(!(P.flags&Sm||g.min.x>P.max.x||P.min.x>g.max.x||g.min.y>P.max.y||P.min.y>g.max.y))for(let I=0;I<P.footprintSegLen;I++){const O=this.footprintSegments[P.footprintSegIdx+I];if(m.length=0,uZ(this.footprintVertices,O.vertexOffset,O.vertexCount,g.footprintTileId.canonical,t.canonical,m),qS(g.footprint,m,this.footprintIndices.uint16,O.indexOffset,O.indexCount,-O.vertexOffset,-b)){P.flags|=Sm;break}}}for(const g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,o,c){let d=!1;for(let m=0;m<c.footprintSegLen;m++){const g=this.footprintSegments[c.footprintSegIdx+m];let b=0;for(const P of g.ringIndices){for(let I=b,O=P+b-1;I<P+b;O=I++){const L=this.footprintVertices.int16[2*(I+g.vertexOffset)+0],k=this.footprintVertices.int16[2*(I+g.vertexOffset)+1],$=this.footprintVertices.int16[2*(O+g.vertexOffset)+1];k>o!=$>o&&t<(this.footprintVertices.int16[2*(O+g.vertexOffset)+0]-L)*(o-k)/($-k)+L&&(d=!d)}b=P}}return d}getHeightAtTileCoord(t,o){let c=Number.NEGATIVE_INFINITY,d=!0;const m=4*(t+Ut)*Ut+(o+Ut);if(this.partLookup.hasOwnProperty(m)){const g=this.partLookup[m];return g?{height:g.height,hidden:!!(g.flags&Sm)}:void 0}for(const g of this.centroidData)t>g.max.x||g.min.x>t||o>g.max.y||g.min.y>o||g.height<=c||this.footprintContainsPoint(t,o,g)&&(c=g.height,this.partLookup[m]=g,d=!!(g.flags&Sm));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:d};this.partLookup[m]=void 0}}function jL(s,t){const o=s.add(t)._unit();return s.x*o.x+s.y*o.y}function cZ(s,t,o,c){const d=t.sub(s)._perp()._unit(),m=o.sub(t)._perp()._unit();return NL(s,t,o,jL(d,m),c)}function NL(s,t,o,c,d){const m=Math.sqrt(1-c*c);return Math.min(s.dist(t)/3,t.dist(o)/3,d*m/c)}function XS(s,t,o){return s.x<o[0].x&&t.x<o[0].x||s.x>o[1].x&&t.x>o[1].x||s.y<o[0].y&&t.y<o[0].y||s.y>o[1].y&&t.y>o[1].y}function VL(s,t){return s.x<t[0].x||s.x>t[1].x||s.y<t[0].y||s.y>t[1].y}function UL(s,t,o){if(s.x<0||s.x>=Ut||t.x<0||t.x>=Ut||o.x<0||o.x>=Ut)return!1;const c=o.sub(t),d=c.perp(),m=s.sub(t);return(c.x*m.x+c.y*m.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(m.x*m.x+m.y*m.y))>-.866&&d.x*m.x+d.y*m.y<0}function $L(s,t,o){const c=t?2|s:-3&s;return o?1|c:-2&c}function WL(){const s=Math.PI/32,t=Math.tan(s),o=B;return o*Math.sqrt(1+2*t*t)-o}function qL(s,t,o){const c=1<<o.z,d=ye(o.x/c),m=ye((o.x+1)/c),g=fe(o.y/c),b=fe((o.y+1)/c);return(function(P,I,O,L,k=0,$){const W=[];if(!P.length||!O||!L)return W;const Q=(Pe,Fe)=>{for(const Be of Pe)W.push({polygon:Be,bounds:Fe})},te=Math.ceil(Math.log2(O)),ne=Math.ceil(Math.log2(L)),ue=te-ne,he=[];for(let Pe=0;Pe<Math.abs(ue);Pe++)he.push(ue>0?0:1);for(let Pe=0;Pe<Math.min(te,ne);Pe++)he.push(0),he.push(1);let me=P;if(me=Ux(me,I[0].y-k,I[1].y+k,1),me=Ux(me,I[0].x-k,I[1].x+k,0),!me.length)return W;const Ae=[];for(he.length?Ae.push({polygons:me,bounds:I,depth:0}):Q(me,I);Ae.length;){const Pe=Ae.pop(),Fe=Pe.depth,Be=he[Fe],Ve=Pe.bounds[0],at=Pe.bounds[1],Ze=Be===0?Ve.x:Ve.y,ft=Be===0?at.x:at.y,xt=$?$(Be,Ze,ft):.5*(Ze+ft),Ct=Ux(Pe.polygons,Ze-k,xt+k,Be),Wt=Ux(Pe.polygons,xt-k,ft+k,Be);if(Ct.length){const Rt=[Ve,new St(Be===0?xt:at.x,Be===1?xt:at.y)];he.length>Fe+1?Ae.push({polygons:Ct,bounds:Rt,depth:Fe+1}):Q(Ct,Rt)}if(Wt.length){const Rt=[new St(Be===0?xt:Ve.x,Be===1?xt:Ve.y),at];he.length>Fe+1?Ae.push({polygons:Wt,bounds:Rt,depth:Fe+1}):Q(Wt,Rt)}}return W})(s,t,Math.ceil((m-d)/11.25),Math.ceil((g-b)/11.25),1,((P,I,O)=>{if(P===0)return .5*(I+O);{const L=fe((o.y+I/Ut)/c);return(ae(.5*(fe((o.y+O/Ut)/c)+L))*c-o.y)*Ut}}))}function uZ(s,t,o,c,d,m){const g=Math.pow(2,c.z-d.z);for(let b=0;b<o;b++){let P=s.int16[2*(b+t)+0],I=s.int16[2*(b+t)+1];P=(P+d.x*Ut)*g-c.x*Ut,I=(I+d.y*Ut)*g-c.y*Ut,m.push(new St(P,I))}}let GL,HL;cr(Hx,"FillExtrusionBucket",{omit:["layers","features"]}),cr(FL,"PartData"),cr(zL,"FootprintSegment"),cr(kL,"BorderCentroidData"),cr(ZS,"GroundEffect");class Eg extends St{constructor(t,o,c){super(t,o),this.z=c}}class YL extends Eg{constructor(t,o,c,d){super(t,o,c),this.w=d}}function ZL(s,t,o,c){const d=o==="x"?"y":"x",m=(c-s[o])/(t[o]-s[o]);s[d]=Math.round(s[d]+(t[d]-s[d])*m),s[o]=c,s.hasOwnProperty("z")&&(s.z=Lr(s.z,t.z,m)),s.hasOwnProperty("w")&&(s.w=Lr(s.w,t.w,m))}function XL(s,t,o,c){const d=o,m=c;for(const g of["x","y"]){let b=s,P=t;b[g]>=P[g]&&(b=t,P=s),b[g]<d&&P[g]>d&&ZL(b,P,g,d),b[g]<m&&P[g]>m&&ZL(P,b,g,m)}}function Yx(s,t,o,c,d,m){const g=[];for(let b=0;b<s.length;b++){const P=s[b];let I;const O=g.length;let L=0;for(let k=0;k<P.length-1;k++){let $=P[k],W=P[k+1],Q=0;const te=L;let ne,ue;m&&(Q=Math.hypot(W.x-$.x,W.y-$.y),L+=Q,ne=$,ue=W),$.x<t&&W.x<t||($.x<t?$=new St(t,$.y+(t-$.x)/(W.x-$.x)*(W.y-$.y))._round():W.x<t&&(W=new St(t,$.y+(t-$.x)/(W.x-$.x)*(W.y-$.y))._round()),$.y<o&&W.y<o||($.y<o?$=new St($.x+(o-$.y)/(W.y-$.y)*(W.x-$.x),o)._round():W.y<o&&(W=new St($.x+(o-$.y)/(W.y-$.y)*(W.x-$.x),o)._round()),$.x>=c&&W.x>=c||($.x>=c?$=new St(c,$.y+(c-$.x)/(W.x-$.x)*(W.y-$.y))._round():W.x>=c&&(W=new St(c,$.y+(c-$.x)/(W.x-$.x)*(W.y-$.y))._round()),$.y>=d&&W.y>=d||($.y>=d?$=new St($.x+(d-$.y)/(W.y-$.y)*(W.x-$.x),d)._round():W.y>=d&&(W=new St($.x+(d-$.y)/(W.y-$.y)*(W.x-$.x),d)._round()),I&&$.equals(I[I.length-1])||(I=[$],g.push(I),m&&m.push({progress:{min:te+KL(ne,ue,$)*Q,max:1},parentIndex:b,prevPoint:ne,nextPoint:ue})),I.push(W),m&&(m[m.length-1].progress.max=te+KL(ne,ue,W)*Q,m[m.length-1].nextPoint=ue)))))}if(m&&L>0)for(let k=O;k<g.length;k++)m[k].progress.min/=L,m[k].progress.max/=L}return g}function dZ(s,t,o,c,d){if(s.length<2)return void c.push(s);const m=[];for(;t.valid();){const[I,O]=t.get();for(let L=0;L<s.length-1;L++){const k=s[L],$=s[L+1],W=Sl(k,$,I,O);if(W){const[Q]=W,te=new St(Lr(k.x,$.x,Q),Lr(k.y,$.y,Q));m.push({t:L+Q,distance:0,point:te})}}t.next()}if(m.length===0)return void c.push(s);m.sort(((I,O)=>I.t-O.t));let g=0,b=0,P=[];for(c.push(P);g!==s.length;){if(b===m.length){for(;g!==s.length;)P.length!==0&&P[P.length-1].equals(s[g])||P.push(s[g]),g++;break}m[b].t<=g?(P.length!==0&&P[P.length-1].equals(m[b].point)||P.push(m[b].point),Math.trunc(m[b].t),b++):(P.length!==0&&P[P.length-1].equals(s[g])||P.push(s[g]),g++)}}function KL(s,t,o){return s.x!==t.x?(o.x-s.x)/(t.x-s.x):s.y!==t.y?(o.y-s.y)/(t.y-s.y):0}function vv(s,t){return s.x*t.x+s.y*t.y}function QL(s,t){if(s.length===1){let o=0;const c=t[o++];let d;for(;!d||c.equals(d);)if(d=t[o++],!d)return 1/0;for(;o<t.length;o++){const m=t[o],g=s[0],b=d.sub(c),P=m.sub(c),I=g.sub(c),O=vv(b,b),L=vv(b,P),k=vv(P,P),$=vv(I,b),W=vv(I,P),Q=O*k-L*L,te=(k*$-L*W)/Q,ne=(O*W-L*$)/Q,ue=c.z*(1-te-ne)+d.z*te+m.z*ne;if(isFinite(ue))return ue}return 1/0}{let o=1/0;for(const c of t)o=Math.min(o,c.z);return o}}function JL(s,t,o){let c=1/0;so(o,t)&&(c=QL(o,t[0]));for(let d=0;d<t.length;d++){const m=t[d],g=s[d];for(let b=0;b<m.length-1;b++){const P=m[b],I=[P,m[b+1],g[b+1],g[b],P];_o(o,I)&&(c=Math.min(c,QL(o,I)))}}return c!==1/0&&c}function ez(s,t,o,c,d,m,g,b,P,I,O){return s.projection.name==="globe"?(function(L,k,$,W,Q,te,ne,ue,he,me,Ae){const Pe=[],Fe=[],Be=L.projection.upVectorScale(Ae,L.center.lat,L.worldSize).metersToTile,Ve=[0,0,0,1],at=[0,0,0,1],Ze=(xt,Ct,Wt,Rt)=>{xt[0]=Ct,xt[1]=Wt,xt[2]=Rt,xt[3]=1},ft=WL();$>0&&($+=ft),W+=ft;for(const xt of k){const Ct=[],Wt=[];for(const Rt of xt){const wt=Rt.x+Q.x,Dt=Rt.y+Q.y,ot=L.projection.projectTilePoint(wt,Dt,Ae),it=L.projection.upVector(Ae,Rt.x,Rt.y);let At=$,jt=W;if(ne){const It=tz(wt,Dt,$,W,ne,ue,he,me);At+=It.base,jt+=It.top}$!==0?Ze(Ve,ot.x+it[0]*Be*At,ot.y+it[1]*Be*At,ot.z+it[2]*Be*At):Ze(Ve,ot.x,ot.y,ot.z),Ze(at,ot.x+it[0]*Be*jt,ot.y+it[1]*Be*jt,ot.z+it[2]*Be*jt),Yr(Ve,Ve,te),Yr(at,at,te),Ct.push(new Eg(Ve[0],Ve[1],Ve[2])),Wt.push(new Eg(at[0],at[1],at[2]))}Pe.push(Ct),Fe.push(Wt)}return[Pe,Fe]})(s,t,o,c,d,m,g,b,P,I,O):g?(function(L,k,$,W,Q,te,ne,ue,he){const me=[],Ae=[],Pe=[0,0,0,1];for(const Fe of L){const Be=[],Ve=[];for(const at of Fe){const Ze=at.x+W.x,ft=at.y+W.y,xt=tz(Ze,ft,k,$,te,ne,ue,he);Pe[0]=Ze,Pe[1]=ft,Pe[2]=xt.base,Pe[3]=1,Bo(Pe,Pe,Q),Pe[3]=Math.max(Pe[3],1e-5);const Ct=new Eg(Pe[0]/Pe[3],Pe[1]/Pe[3],Pe[2]/Pe[3]);Pe[0]=Ze,Pe[1]=ft,Pe[2]=xt.top,Pe[3]=1,Bo(Pe,Pe,Q),Pe[3]=Math.max(Pe[3],1e-5);const Wt=new Eg(Pe[0]/Pe[3],Pe[1]/Pe[3],Pe[2]/Pe[3]);Be.push(Ct),Ve.push(Wt)}me.push(Be),Ae.push(Ve)}return[me,Ae]})(t,o,c,d,m,g,b,P,I):(function(L,k,$,W,Q){const te=[],ne=[],ue=Q[8]*k,he=Q[9]*k,me=Q[10]*k,Ae=Q[11]*k,Pe=Q[8]*$,Fe=Q[9]*$,Be=Q[10]*$,Ve=Q[11]*$;for(const at of L){const Ze=[],ft=[];for(const xt of at){const Ct=xt.x+W.x,Wt=xt.y+W.y,Rt=Q[0]*Ct+Q[4]*Wt+Q[12],wt=Q[1]*Ct+Q[5]*Wt+Q[13],Dt=Q[2]*Ct+Q[6]*Wt+Q[14],ot=Q[3]*Ct+Q[7]*Wt+Q[15],it=Rt+ue,At=wt+he,jt=Dt+me,It=Math.max(ot+Ae,1e-5),dr=Rt+Pe,_r=wt+Fe,ir=Dt+Be,Jt=Math.max(ot+Ve,1e-5);Ze.push(new Eg(it/It,At/It,jt/It)),ft.push(new Eg(dr/Jt,_r/Jt,ir/Jt))}te.push(Ze),ne.push(ft)}return[te,ne]})(t,o,c,d,m)}function tz(s,t,o,c,d,m,g,b){const P=g*d.getElevationAt(s,t,!0,!0),I=m[0]!==0,O=I?m[1]===0?g*(m[0]/OL-LL):g*(function(L,k,$){const W=Math.floor(k[0]/8),Q=Math.floor(k[1]/8),te=10*(k[0]-8*W),ne=10*(k[1]-8*Q),ue=L.getElevationAt(W,Q,!0,!0),he=L.getMeterToDEM($),me=Math.floor(.5*(te*he-1)),Ae=Math.floor(.5*(ne*he-1)),Pe=L.tileCoordToPixel(W,Q),Fe=2*me+1,Be=2*Ae+1,Ve=(function(Wt,Rt,wt,Dt,ot){return[Wt.getElevationAtPixel(Rt,wt,!0),Wt.getElevationAtPixel(Rt+ot,wt,!0),Wt.getElevationAtPixel(Rt,wt+ot,!0),Wt.getElevationAtPixel(Rt+Dt,wt+ot,!0)]})(L,Pe.x-me,Pe.y-Ae,Fe,Be),at=Math.abs(Ve[0]-Ve[1]),Ze=Math.abs(Ve[2]-Ve[3]),ft=Math.abs(Ve[0]-Ve[2])+Math.abs(Ve[1]-Ve[3]),xt=Math.min(.25,.5*he*(at+Ze)/Fe),Ct=Math.min(.25,.5*he*ft/Be);return ue+Math.max(xt*te,Ct*ne)})(d,m,b):P;return{base:P+(o===0?-1:o),top:I?Math.max(O+c,P+o+2):P+c}}class hZ{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class fZ{constructor(){this.tasks={},this.taskQueue=[],Je(["process"],this),this.invoker=new hZ(this.process),this.nextId=0}add(t,o){const c=this.nextId++,d=(function({type:m,isSymbolTile:g,zoom:b}){return b=b||0,m==="message"?0:m!=="maybePrepare"||g?m!=="parseTile"||g?m==="parseTile"&&g?300-b:m==="maybePrepare"&&g?400-b:500:200-b:100-b})(o);if(d===0){try{t()}finally{}return null}return this.tasks[c]={fn:t,metadata:o,priority:d,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((c=>!!this.tasks[c])),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const o=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let t=null,o=1/0;for(let d=0;d<this.taskQueue.length;d++){const m=this.tasks[this.taskQueue[d]];m.priority<o&&(o=m.priority,t=d)}if(t===null)return null;const c=this.taskQueue[t];return this.taskQueue.splice(t,1),c}remove(){this.invoker.remove()}}class rz{constructor(t,o,c){this.target=t,this.parent=o,this.mapId=c,this.callbacks={},this.cancelCallbacks={},Je(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new fZ}send(t,o,c,d,m=!1,g){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=g,this.callbacks[b]=c);const P=new Set;return this.target.postMessage({id:b,type:t,hasCallback:!!c,targetMapId:d,mustQueue:m,sourceMapId:this.mapId,data:Vu(o,P)},P),{cancel:()=>{c&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(t){const o=t.data;if(!o)return;const c=o.id;if(c&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const d=this.cancelCallbacks[c];delete this.cancelCallbacks[c],d&&d.cancel()}else if(o.mustQueue||Mi(self)){const d=this.callbacks[c],m=this.scheduler.add((()=>this.processTask(c,o)),d&&d.metadata||{type:"message"});m&&(this.cancelCallbacks[c]=m)}else this.processTask(c,o)}processTask(t,o){if(delete this.cancelCallbacks[t],o.type==="<response>"){const c=this.callbacks[t];delete this.callbacks[t],c&&(o.error?c(_c(o.error)):c(null,_c(o.data)))}else{const c=new Set,d=o.hasCallback?(g,b)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:g?Vu(g):null,data:Vu(b,c)},c)}:()=>{},m=_c(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,m,d);else if(this.parent.getWorkerSource){const g=o.type.split("."),{source:b,scope:P}=m;this.parent.getWorkerSource(o.sourceMapId,g[0],b,P)[g[1]](m,d)}else d(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var xv={workerUrl:"",workerClass:null,workerParams:void 0};const KS="mapboxgl_preloaded_worker_pool";class Pg{constructor(){this.active={}}acquire(t,o=Pg.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(xv.workerClass!=null?new xv.workerClass:new self.Worker(xv.workerUrl,xv.workerParams));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach((o=>{o.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[KS]}numActive(){return Object.keys(this.active).length}}Pg.workerCount=2;class O_{constructor(t,o,c="Worker",d=Pg.workerCount){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=nt();const m=this.workerPool.acquire(this.id,d);for(let g=0;g<m.length;g++){const b=new O_.Actor(m[g],o,this.id);b.name=`${c} ${g}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(t,o,c){Le(this.actors,((d,m)=>{d.send(t,o,m)}),c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((t=>{t.remove()})),this.actors=[],this.workerPool.release(this.id)}}let bv,QS;function Zx(){return bv||(bv=new Pg),bv}O_.Actor=rz;class pZ{constructor(t){this.module=t}createIntArray(t){const o=new Int32Array(t),c=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heap32.set(o,c/o.BYTES_PER_ELEMENT),c}createFloatArray(t){const o=new Float32Array(t),c=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heapF32.set(o,c/o.BYTES_PER_ELEMENT),c}createStringBuffer(t){const o=this.module.malloc(t.length+1);for(let c=0;c<t.length;++c)this.module.heapU8[o+c]=t.charCodeAt(c);return this.module.heapU8[o+t.length]=0,o}readStringBuffer(t){let o="";for(;this.module.heapU8[t]!==0;)o+=String.fromCharCode(this.module.heapU8[t]),++t;return o}setStyle(t){const o=t.entranceColorRgb,c=t.facadeGlazingColorRgb,d=t.roofColorRgb,m=t.wallColorRgb,g=t.normalScale;this.module.setStyle(o[0],o[1],o[2],c[0],c[1],c[2],d[0],d[1],d[2],m[0],m[1],m[2],g[0],g[1],g[2],t.tileToMeters)}setAOOptions(t,o){this.module.setAOOptions(t?1:0,o)}setMetricOptions(t,o){this.module.setMetricOptions(t?1:0,o)}setStructuralOptions(t){this.module.setStructuralOptions(t?1:0)}setFacadeOptions(t,o){this.module.setFacadeOptions(t,o?1:0)}setFauxFacadeOptions(t,o,c){this.module.setFauxFacadeOptions(t?1:0,o?1:0,c)}setFacadeClassifierOptions(t){this.module.setFacadeClassifierOptions(t)}generateMesh(t,o){for(const b of t){const P=this.createStringBuffer(b.roofType),I=[0],O=[];for(const $ of b.coordinates)if(Array.isArray($)){for(const W of $)O.push(W.x),O.push(W.y);I.push(O.length)}const L=this.createIntArray(I),k=this.createFloatArray(O);this.module.addFeature(b.id,b.sourceId,b.minHeight,b.height,P,b.roofType.length,k,L,I.length-1),this.module.free(P),this.module.free(L),this.module.free(k)}for(const b of o){let P;P=b.entrances?JSON.parse(b.entrances):[];const I=this.createFloatArray(P),O=[];for(const k of b.coordinates)O.push(k.x),O.push(k.y);const L=this.createFloatArray(O);this.module.addFacade(b.sourceId,b.crossPerc,b.distanceToRoad,I,P.length,L,O.length),this.module.free(I),this.module.free(L)}if(!this.module.generateMesh()){const b=this.module.getLastError();return this.readStringBuffer(b)}const c=this.module.getMeshCount(),d=new Array(c);for(let b=0;b<c;b++){const P=this.module.getPositionsPtr(b),I=this.module.getPositionsLength(b),O=new Float32Array(this.module.heapF32.buffer,P,I),L=this.module.getNormalsPtr(b),k=this.module.getNormalsLength(b),$=new Float32Array(this.module.heapF32.buffer,L,k),W=this.module.getColorsPtr(b),Q=this.module.getColorsLength(b),te=new Uint8Array(this.module.heapU8.buffer,W,Q),ne=this.module.getAOPtr(b),ue=this.module.getAOLength(b),he=new Float32Array(this.module.heapF32.buffer,ne,ue),me=this.module.getUVPtr(b),Ae=this.module.getUVLength(b),Pe=new Float32Array(this.module.heapF32.buffer,me,Ae),Fe=this.module.getFauxFacadePtr(b),Be=this.module.getFauxFacadeLength(b),Ve=new Uint8Array(this.module.heapU8.buffer,Fe,Be),at=this.module.getIndicesPtr(b),Ze=this.module.getIndicesLength(b),ft=new Int32Array(this.module.heap32.buffer,at,Ze),xt=this.module.getBuildingPart(b),Ct=this.readStringBuffer(xt);d[b]={positions:O,normals:$,colors:te,ao:he,uv:Pe,isFauxFacade:Ve,indices:ft,buildingPart:Ct}}const m=this.module.getRingCount(),g=[];for(let b=0;b<m;b++){const P=this.module.getRingPtr(b),I=this.module.getRingLength(b),O=new Float32Array(this.module.heapF32.buffer,P,I);g.push(O)}return{meshes:d,outerRingLength:this.module.getOuterRingLength(),modifiedPolygonRings:g}}}let wv,JS,mh,L_,eT,z_=null,F_=null,nz=null,Xx=null;function iz(){return Mi(self)&&self.worker.dracoUrl?self.worker.dracoUrl:JS||ii.DRACO_URL}function oz(){if(Mi(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(L_)return L_;const s=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return L_=WebAssembly.validate(s)?ii.MESHOPT_SIMD_URL:ii.MESHOPT_URL,L_}function mZ(){return Xx}const Kx={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},gZ={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Sv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function sz(s,t,o){const c=o.json.bufferViews.length,d=o.buffers.length;t.bufferView=c,o.json.bufferViews[c]={buffer:d,byteLength:s.byteLength},o.buffers[d]=s}const tT="KHR_draco_mesh_compression";function _Z(s,t){const o=s.extensions&&s.extensions[tT];if(!o)return;const c=new mh.Decoder,d=uz(t,o.bufferView),m=new mh.Mesh;if(!c.DecodeArrayToMesh(d,d.byteLength,m))throw new Error("Failed to decode Draco mesh");const g=t.json.accessors[s.indices],b=Kx[g.componentType],P=g.count*b.BYTES_PER_ELEMENT,I=mh._malloc(P);b===Uint16Array?c.GetTrianglesUInt16Array(m,P,I):c.GetTrianglesUInt32Array(m,P,I),sz(mh.memory.buffer.slice(I,I+P),g,t),mh._free(I);for(const O of Object.keys(o.attributes)){const L=c.GetAttributeByUniqueId(m,o.attributes[O]),k=t.json.accessors[s.attributes[O]],$=gZ[k.componentType],W=k.count*Sv[k.type]*Kx[k.componentType].BYTES_PER_ELEMENT,Q=mh._malloc(W);c.GetAttributeDataArrayForAllPoints(m,L,mh[$],W,Q),sz(mh.memory.buffer.slice(Q,Q+W),k,t),mh._free(Q)}c.destroy(),m.destroy(),delete s.extensions[tT]}const Qx="EXT_meshopt_compression";function yZ(s,t){if(!s.extensions||!s.extensions[Qx])return;const o=s.extensions[Qx],c=new Uint8Array(t.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),d=new Uint8Array(o.count*o.byteStride);eT.decodeGltfBuffer(d,o.count,o.byteStride,c,o.mode,o.filter),s.buffer=t.buffers.length,s.byteOffset=0,t.buffers[s.buffer]=d.buffer,delete s.extensions[Qx]}const az=1179937895,lz=new TextDecoder("utf8");function cz(s,t){return new URL(s,t).href}function vZ(s,t,o,c){return fetch(cz(s.uri,c)).then((d=>d.arrayBuffer())).then((d=>{t.buffers[o]=d}))}function uz(s,t){const o=s.json.bufferViews[t];return new Uint8Array(s.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function xZ(s,t,o,c){if(s.uri){const d=cz(s.uri,c);return fetch(d).then((m=>m.blob())).then((m=>createImageBitmap(m))).then((m=>{t.images[o]=m}))}if(s.bufferView!==void 0){const d=uz(t,s.bufferView),m=new Blob([d],{type:s.mimeType});return createImageBitmap(m).then((g=>{t.images[o]=g}))}}function dz(s,t=0,o){const c={json:null,images:[],buffers:[]};if(new Uint32Array(s,t,1)[0]===az){const O=new Uint32Array(s,t);let L=2;const k=(O[L++]>>2)-3,$=O[L++]>>2;if(L++,c.json=JSON.parse(lz.decode(O.subarray(L,L+$))),L+=$,L<k){const W=O[L++];L++;const Q=t+(L<<2);c.buffers[0]=s.slice(Q,Q+W)}}else c.json=JSON.parse(lz.decode(new Uint8Array(s,t)));const{buffers:d,images:m,meshes:g,extensionsUsed:b,bufferViews:P}=c.json;let I=Promise.resolve();if(d){const O=[];for(let L=0;L<d.length;L++){const k=d[L];k.uri?O.push(vZ(k,c,L,o)):c.buffers[L]||(c.buffers[L]=null)}I=Promise.all(O)}return I.then((()=>{const O=[],L=b&&b.includes(tT),k=b&&b.includes(Qx);if(L&&O.push((function(){if(!mh)return wv??(wv=(function($){let W,Q=null;function te(){W=new Uint8Array(Q.buffer)}function ne(){throw new Error("Unexpected Draco error.")}const ue={a:{a:ne,d:function(he,me,Ae){return W.copyWithin(he,me,me+Ae)},c:function(he){const me=W.length,Ae=Math.max(he>>>0,Math.ceil(1.2*me)),Pe=Math.ceil((Ae-me)/65536);try{return Q.grow(Pe),te(),!0}catch{return!1}},b:ne}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming($,ue):$.then((he=>he.arrayBuffer())).then((he=>WebAssembly.instantiate(he,ue)))).then((he=>{const{Rb:me,Qb:Ae,P:Pe,T:Fe,X:Be,Ja:Ve,La:at,Qa:Ze,Va:ft,Wa:xt,eb:Ct,jb:Wt,f:Rt,e:wt,yb:Dt,zb:ot,Ab:it,Bb:At,Db:jt,Gb:It}=he.instance.exports;Q=wt;const dr=(()=>{let _r=0,ir=0,Jt=0,Hr=0;return rr=>{Jt&&(me(Hr),me(_r),ir+=Jt,Jt=_r=0),_r||(ir+=128,_r=Ae(ir));const Rr=rr.length+7&-8;let Qr=_r;Rr>=ir&&(Jt=Rr,Qr=Hr=Ae(Rr));for(let gn=0;gn<rr.length;gn++)W[Qr+gn]=rr[gn];return Qr}})();return te(),Rt(),{memory:wt,_free:me,_malloc:Ae,Mesh:class{constructor(){this.ptr=Pe()}destroy(){Fe(this.ptr)}},Decoder:class{constructor(){this.ptr=Ve()}destroy(){Wt(this.ptr)}DecodeArrayToMesh(_r,ir,Jt){const Hr=dr(_r),rr=at(this.ptr,Hr,ir,Jt.ptr);return!!Be(rr)}GetAttributeByUniqueId(_r,ir){return{ptr:Ze(this.ptr,_r.ptr,ir)}}GetTrianglesUInt16Array(_r,ir,Jt){ft(this.ptr,_r.ptr,ir,Jt)}GetTrianglesUInt32Array(_r,ir,Jt){xt(this.ptr,_r.ptr,ir,Jt)}GetAttributeDataArrayForAllPoints(_r,ir,Jt,Hr,rr){Ct(this.ptr,_r.ptr,ir.ptr,Jt,Hr,rr)}},DT_INT8:Dt(),DT_UINT8:ot(),DT_INT16:it(),DT_UINT16:At(),DT_UINT32:jt(),DT_FLOAT32:It()}}))})(fetch(iz())),wv.then(($=>{mh=$,wv=void 0})))})()),k&&O.push((function(){if(eT)return;const $=(function(W){let Q;const te=WebAssembly.instantiateStreaming(W,{}).then((he=>{Q=he.instance,Q.exports.__wasm_call_ctors()})),ne={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ue={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:te,supported:!0,decodeGltfBuffer(he,me,Ae,Pe,Fe,Be){(function(Ve,at,Ze,ft,xt,Ct,Wt){const Rt=Ve.exports.sbrk,wt=ft+3&-4,Dt=Rt(wt*xt),ot=Rt(Ct.length),it=new Uint8Array(Ve.exports.memory.buffer);it.set(Ct,ot);const At=at(Dt,ft,xt,ot,Ct.length);if(At===0&&Wt&&Wt(Dt,wt,xt),Ze.set(it.subarray(Dt,Dt+ft*xt)),Rt(Dt-Rt(0)),At!==0)throw new Error(`Malformed buffer data: ${At}`)})(Q,Q.exports[ue[Fe]],he,me,Ae,Pe,Q.exports[ne[Be]])}}})(fetch(oz()));return $.ready.then((()=>{eT=$}))})()),m)for(let $=0;$<m.length;$++)O.push(xZ(m[$],c,$,o));return(O.length?Promise.all(O):Promise.resolve()).then((()=>{if(L&&g)for(const{primitives:$}of g)for(const W of $)_Z(W,c);if(k&&g&&P)for(const $ of P)yZ($,c);return c}))}))}function hz(s){return fetch(s).then((t=>t.arrayBuffer())).then((t=>dz(t,0,s)))}function rT(s){switch(s){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function nT(s){switch(s){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class iT{constructor(t,o,c,d){this.context=t,this.format=c,this.useMipmap=d&&d.useMipmap,this.texture=t.gl.createTexture(),this.update(o,{premultiply:d&&d.premultiply})}update(t,o){const c=t&&t instanceof HTMLVideoElement&&t.width===0?t.videoWidth:t.width,d=t&&t instanceof HTMLVideoElement&&t.height===0?t.videoHeight:t.height,{context:m}=this,{gl:g}=m,{x:b,y:P}=o&&o.position?o.position:{x:0,y:0},I=b+c,O=P+d;!this.size||this.size[0]===I&&this.size[1]===O||(g.bindTexture(g.TEXTURE_2D,null),g.deleteTexture(this.texture),this.texture=g.createTexture(),this.size=null),g.bindTexture(g.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA8&&(!o||o.premultiply!==!1));const L=t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap;if(!this.size&&I>0&&O>0){const k=this.useMipmap?Math.floor(Math.log2(Math.max(I,O)))+1:1;g.texStorage2D(g.TEXTURE_2D,k,this.format,I,O),this.size=[I,O]}this.size&&(L?g.texSubImage2D(g.TEXTURE_2D,0,b,P,rT(this.format),nT(this.format),t):"data"in t&&t.data&&g.texSubImage2D(g.TEXTURE_2D,0,b,P,c,d,rT(this.format),nT(this.format),t.data)),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,o,c=!1){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),t!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!c?t===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),o!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(t,o,c,d,m){const{context:g}=this,{gl:b}=g;b.bindTexture(b.TEXTURE_2D,this.texture),o!==this.magFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,o),this.magFilter=o),t!==this.minFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,this.useMipmap?t===b.NEAREST?b.NEAREST_MIPMAP_NEAREST:b.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),c!==this.wrapS&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,c),this.wrapS=c),d!==this.wrapT&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,d),this.wrapT=d),m!==this.compareMode&&(m?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_MODE,b.COMPARE_REF_TO_TEXTURE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_FUNC,m)):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_MODE,b.NONE),this.compareMode=m)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Tv{constructor(t,o){this.context=t,this.texture=o}bind(t,o){const{context:c}=this,{gl:d}=c;d.bindTexture(d.TEXTURE_2D,this.texture),t!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,t),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,t),this.minFilter=t),o!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,o),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,o),this.wrapS=o)}}const bZ=pn([{name:"a_pos_3f",components:3,type:"Float32"}]),wZ=pn([{name:"a_color_3f",components:3,type:"Float32"}]),SZ=pn([{name:"a_color_4f",components:4,type:"Float32"}]),TZ=pn([{name:"a_uv_2f",components:2,type:"Float32"}]),EZ=pn([{name:"a_normal_3f",components:3,type:"Float32"}]),PZ=pn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),IZ=pn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function fz(s,t){const o=Jx(s.projection,s.zoom,s.width,s.height),c=(function(m,g,b,P,I){const O=new q(b.lng-180*Tm,b.lat),L=new q(b.lng+180*Tm,b.lat),k=m.project(O.lng,O.lat),$=m.project(L.lng,L.lat),W=-Math.atan2($.y-k.y,$.x-k.x),Q=He.fromLngLat(b);Q.y=le(Q.y,-1+Tm,1-Tm);const te=Q.toLngLat(),ne=m.project(te.lng,te.lat),ue=He.fromLngLat(te);ue.x+=Tm;const he=ue.toLngLat(),me=m.project(he.lng,he.lat),Ae=mz(me.x-ne.x,me.y-ne.y,W),Pe=He.fromLngLat(te);Pe.y+=Tm;const Fe=Pe.toLngLat(),Be=m.project(Fe.lng,Fe.lat),Ve=mz(Be.x-ne.x,Be.y-ne.y,W),at=Math.abs(Ae.x)/Math.abs(Ve.y),Ze=J([]);ke(Ze,Ze,-W*(1-(I?0:P)));const ft=J([]);return Ne(ft,ft,[1,1-(1-at)*P,1]),ft[4]=-Ve.x/Ve.y*P,ke(ft,ft,W),pe(ft,Ze,ft),ft})(s.projection,0,s.center,o,t),d=pz(s);return Ne(c,c,[d,d,1]),c}function pz(s){const t=s.projection,o=Jx(s.projection,s.zoom,s.width,s.height),c=oT(t,s.center),d=oT(t,q.convert(t.center));return Math.pow(2,c*o+(1-o)*d)}function Jx(s,t,o,c,d=1/0){const m=s.range;if(!m)return 0;const g=Math.min(d,Math.max(o,c)),b=Math.log2(g/1024);return we(m[0]+b,m[1]+b,t)}const Tm=1/4e4;function oT(s,t){const o=le(t.lat,-xe,xe),c=new q(t.lng-180*Tm,o),d=new q(t.lng+180*Tm,o),m=s.project(c.lng,o),g=s.project(d.lng,o),b=He.fromLngLat(c),P=He.fromLngLat(d),I=g.x-m.x,O=g.y-m.y,L=P.x-b.x,k=P.y-b.y,$=Math.sqrt((L*L+k*k)/(I*I+O*O));return Math.log2($)}function mz(s,t,o){const c=Math.cos(o),d=Math.sin(o);return{x:s*c-t*d,y:s*d+t*c}}function gz(s,t,o){J(s),ke(s,s,vn(t[2])),_e(s,s,vn(t[0])),Re(s,s,vn(t[1])),Ne(s,s,o),pe(s,s,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function eb(s,t,o,c,d,m,g,b){const P=[o[0]-t[0],o[1]-t[1],0],I=[c[0]-t[0],c[1]-t[1],0];if(Or(P)<1e-12||Or(I)<1e-12)return va(s);const O=hn([],P,I);sr(O,O),qt(I,c,t),P[2]=(m-d)*b,I[2]=(g-d)*b;const L=P;return hn(L,P,I),sr(L,L),Al(s,O,L)}function tb(s,t,o=!1){const c=bm(t.zoom),d=(function(m,g,b){const P=g.worldSize,I=[m[12],m[13],m[14]],O=fe(I[1]/P),L=ye(I[0]/P),k=J([]),$=de(1,O)*P,W=de(1,0)*P*Te(O,g.zoom),Q=1/ro(P);let te=W*Q;if(b){const me=Jx(g.projection,g.zoom,g.width,g.height,1024);te=Q*g.projection.pixelSpaceConversion(g.center.lat,P,me)}const ne=D(O,L);Et(ne,ne,_t([],sr([],ne),$*te*I[2]));const ue=(function(me){const Ae=[me[0],me[1],me[2]];let Pe=[0,1,0];const Fe=hn([],Pe,Ae);return hn(Pe,Ae,Fe),hr(Pe)===0&&(Pe=[0,1,0],hn(Fe,Ae,Pe)),sr(Fe,Fe),sr(Pe,Pe),sr(Ae,Ae),[Fe[0],Fe[1],Fe[2],0,Pe[0],Pe[1],Pe[2],0,Ae[0],Ae[1],Ae[2],0,me[0],me[1],me[2],1]})(ne);Ne(k,k,[te,te,te*$]),ve(k,k,[-I[0],-I[1],-I[2]]);const he=pe([],g.globeMatrix,ue);return pe(he,he,k),pe(he,he,m),he})(s,t,o);if(c>0){const m=(function(g,b){const P=b.worldSize,I=de(1,0)*P*Te(b.center.lat,b.zoom)/ro(P),O=de(1,b.center.lat)*P,L=J([]);Re(L,L,vn(b.center.lng)),_e(L,L,vn(b.center.lat)),ve(L,L,[0,0,oo]),Ne(L,L,[I,I,I*O]);const k=b.point;return ve(L,L,[-k.x,-k.y,0]),pe(L,L,g),pe(L,b.globeMatrix,L)})(s,t);return(function(g,b,P){const I=(W,Q,te)=>{const ne=Or(W),ue=Or(Q),he=Io(W,Q,te);return _t(he,he,1/Or(he)*Lr(ne,ue,te))},O=I([g[0],g[1],g[2]],[b[0],b[1],b[2]],P),L=I([g[4],g[5],g[6]],[b[4],b[5],b[6]],P),k=I([g[8],g[9],g[10]],[b[8],b[9],b[10]],P),$=Io([g[12],g[13],g[14]],[b[12],b[13],b[14]],P);return[O[0],O[1],O[2],0,L[0],L[1],L[2],0,k[0],k[1],k[2],0,$[0],$[1],$[2],1]})(d,m,c)}return d}function sT(s,t,o,c){const d=Jr.projectAabbCorners(c,o);let m=Number.MAX_VALUE;for(let b=0;b<d.length;++b){const P=d[b];P[0]=(.5*P[0]+.5)*t.width,P[1]=(.5-.5*P[1])*t.height,P[2]<m&&(m=P[2])}const g=(function(b){const P=[];let I=0;for(let $=1;$<b.length;$++)(b[$][0]<b[I][0]||b[$][0]===b[I][0]&&b[$][1]<b[I][1])&&(I=$);let O,L=I;const k=new Uint8Array(b.length);do{if(k[L])break;P.push(new St(b[L][0],b[L][1])),k[L]=1,O=(L+1)%b.length;for(let $=0;$<b.length;$++){if(b[$][0]===b[O][0]&&b[$][1]===b[O][1]||b[$][0]===b[L][0]&&b[$][1]===b[L][1])continue;const W=[b[$][0]-b[L][0],b[$][1]-b[L][1]],Q=[b[O][0]-b[L][0],b[O][1]-b[L][1]],te=W[0]*Q[1]-W[1]*Q[0];(te>0||te===0&&W[0]*Q[0]+W[1]*Q[1]>=0&&W[0]*W[0]+W[1]*W[1]>Q[0]*Q[0]+Q[1]*Q[1])&&(O=$)}L=O}while(L!==I);return P.length>0&&P.push(P[0]),P})(d);if(_o(s,g))return m}const Ig=64,k_={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function rb(s,t,o,c,d,m,g,b,P,I=!1){const O=o.zoom,L=o.project(c),k=Te(c.lat,O),$=1/k;J(s),ve(s,s,[L.x+g[0]*$,L.y+g[1]*$,g[2]]);let W=1,Q=1;const te=o.worldSize;if(I){if(o.projection.name==="mercator"){let me=0;o.elevation&&(me=o.elevation.getAtPointOrZero(new He(L.x/te,L.y/te),0));const Ae=Bo([],[L.x,L.y,me,1],o.projMatrix)[3]/o.cameraToCenterDistance;W=Ae,Q=Ae*Te(o.center.lat,O)}else if(o.projection.name==="globe"){const me=tb(s,o),Ae=[0,0,0,1];Bo(Ae,Ae,pe([],o.projMatrix,me));const Pe=Ae[3]/o.cameraToCenterDistance,Fe=bm(O),Be=o.projection.pixelsPerMeter(c.lat,te)*Te(c.lat,O),Ve=o.projection.pixelsPerMeter(o.center.lat,te)*Te(o.center.lat,O);W=Pe/Lr(Be,Ce(o.center.lat),Fe),Q=Pe*k/Be,W*=Ve,Q*=Ve}}else W=$;Ne(s,s,[W,W,Q]);const ne=[...s],ue=t.orientation,he=[];if(gz(he,[ue[0]+(d?d[0]:0),ue[1]+(d?d[1]:0),ue[2]+(d?d[2]:0)],m),pe(s,ne,he),b&&o.elevation){let me=0;const Ae=[];if(P&&o.elevation){me=(function(Fe,Be,Ve,at,Ze){const ft=Be.elevation;if(!ft)return 0;const xt=Jr.projectAabbCorners(Ve,at),Ct=de(1,Ze.lat)*Be.worldSize,Wt=(function(ir,Jt){const Hr=[0,0,1],rr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Rr of rr){const Qr=ir[Rr.corners[0]],gn=ir[Rr.corners[1]],kn=ir[Rr.corners[2]],tn=[gn[0]-Qr[0],gn[1]-Qr[1],Jt*(gn[2]-Qr[2])],Kn=hn(tn,tn,[kn[0]-Qr[0],kn[1]-Qr[1],Jt*(kn[2]-Qr[2])]);sr(Kn,Kn),Rr.dotProductWithUp=Br(Kn,Hr)}return rr.sort(((Rr,Qr)=>Rr.dotProductWithUp-Qr.dotProductWithUp)),rr[0].corners})(xt,Ct),Rt=xt[Wt[0]],wt=xt[Wt[1]],Dt=xt[Wt[2]],ot=xt[Wt[3]],it=ft.getAtPointOrZero(new He(Rt[0]/Be.worldSize,Rt[1]/Be.worldSize),0),At=ft.getAtPointOrZero(new He(wt[0]/Be.worldSize,wt[1]/Be.worldSize),0),jt=ft.getAtPointOrZero(new He(Dt[0]/Be.worldSize,Dt[1]/Be.worldSize),0),It=ft.getAtPointOrZero(new He(ot[0]/Be.worldSize,ot[1]/Be.worldSize),0),dr=(it+It)/2,_r=(At+jt)/2;return dr>_r?At<jt?eb(Fe,wt,ot,Rt,At,It,it,Ct):eb(Fe,Dt,Rt,ot,jt,it,It,Ct):it<It?eb(Fe,Rt,wt,Dt,it,At,jt,Ct):eb(Fe,ot,Dt,wt,It,jt,At,Ct),Math.max(dr,_r)})(Ae,o,t.aabb,s,c);const Pe=pe([],Xt([],Ae),he);pe(s,ne,Pe)}else me=o.elevation.getAtPointOrZero(new He(L.x/te,L.y/te),0);me!==0&&(s[14]+=me)}}class _z{constructor(t,o,c,d,m){this.materialOverrides=new Map,this.nodeOverrides=new Map,this.materialOverrideNames=[],this.nodeOverrideNames=[],this.featureProperties={},this.id=t,this.uri=o,this.position=c!=null?new q(c[0],c[1]):new q(0,0),this.orientation=d??[0,0,0],this.nodes=m,this.uploaded=!1,this.aabb=new Jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,o){pe(t.globalMatrix,o,t.localMatrix);const c=this.nodeOverrides.get(t.name);if(c!==void 0){const g=[];m=c.orientation,J(d=g),Re(d,d,vn(m[1])),ke(d,d,vn(m[2])),_e(d,d,vn(m[0])),pe(t.globalMatrix,t.globalMatrix,g)}var d,m;if(t.meshes)for(const g of t.meshes){const b=Jr.applyTransformFast(g.aabb,t.globalMatrix);this.aabb.encapsulate(b)}if(t.children)for(const g of t.children)this._applyTransformations(g,t.globalMatrix)}computeBoundsAndApplyParent(){const t=J([]);this.aabb=new Jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const o of this.nodes)this._applyTransformations(o,t)}computeModelMatrix(t,o,c,d,m,g,b=!1){rb(this.matrix,this,t.transform,this.position,o,c,d,m,g,b)}upload(t){if(!this.uploaded){for(const o of this.nodes)aT(o,t);for(const o of this.nodes)nb(o);this.uploaded=!0}}destroy(){for(const t of this.nodes)lT(t)}}function Ev(s,t,o=!1){s.uploaded||(s.gfxTexture=new iT(t,s.image,o?t.gl.R8:t.gl.RGBA8,{useMipmap:s.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),s.uploaded=!0,s.image=null)}function MZ(s,t,o){s.indexBuffer=t.createIndexBuffer(s.indexArray,!1,!0),s.vertexBuffer=t.createVertexBuffer(s.vertexArray,bZ.members,!1,!0),s.normalArray&&(s.normalBuffer=t.createVertexBuffer(s.normalArray,EZ.members,!1,!0)),s.texcoordArray&&(s.texcoordBuffer=t.createVertexBuffer(s.texcoordArray,TZ.members,!1,!0)),s.colorArray&&(s.colorBuffer=t.createVertexBuffer(s.colorArray,(s.colorArray.bytesPerElement===12?wZ:SZ).members,!1,!0)),s.featureArray&&(s.pbrBuffer=t.createVertexBuffer(s.featureArray,IZ.members,!0)),s.segments=Wn.simpleSegment(0,0,s.vertexArray.length,s.indexArray.length);const c=s.material;c.pbrMetallicRoughness.baseColorTexture&&Ev(c.pbrMetallicRoughness.baseColorTexture,t),c.pbrMetallicRoughness.metallicRoughnessTexture&&Ev(c.pbrMetallicRoughness.metallicRoughnessTexture,t),c.normalTexture&&Ev(c.normalTexture,t),c.occlusionTexture&&Ev(c.occlusionTexture,t,o),c.emissionTexture&&Ev(c.emissionTexture,t)}function aT(s,t,o){if(s.meshes)for(const c of s.meshes)MZ(c,t,o);if(s.children)for(const c of s.children)aT(c,t,o)}function nb(s){if(s.meshes)for(const t of s.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(s.children)for(const t of s.children)nb(t)}function lT(s){if(s.meshes)for(const o of s.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((t=o.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(s.children)for(const o of s.children)lT(o)}function Mg(s,t){const o=s.json.bufferViews[t.bufferView],c=Kx[t.componentType];return new c(s.buffers[o.buffer],(t.byteOffset||0)+(o.byteOffset||0),t.count*(o.byteStride&&o.byteStride!==Sv[t.type]*c.BYTES_PER_ELEMENT?o.byteStride/c.BYTES_PER_ELEMENT:Sv[t.type]))}function cT(s,t,o,c){const d=Kx[t.componentType],m=(function(O){switch(O){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}})(d),g=s.json.bufferViews[t.bufferView],b=g.byteStride?g.byteStride/d.BYTES_PER_ELEMENT:Sv[t.type],P=o.float32,I=P.length/o.capacity;for(let O=0,L=0;O<t.count*b;O+=b,L+=I)for(let k=0;k<I;k++)P[L+k]=c[O+k]*m;o._trim()}function CZ(s,t,o){const c=s.indices,d=s.attributes,m={};m.indexArray=new Li;const g=t.json.accessors[c],b=g.count/3;m.indexArray.reserve(b);const P=Mg(t,g);for(let k=0;k<b;k++)m.indexArray.emplaceBack(P[3*k],P[3*k+1],P[3*k+2]);m.indexArray._trim(),m.vertexArray=new il;const I=t.json.accessors[d.POSITION];m.vertexArray.reserve(I.count);const O=Mg(t,I);for(let k=0;k<I.count;k++)m.vertexArray.emplaceBack(O[3*k],O[3*k+1],O[3*k+2]);if(m.vertexArray._trim(),m.aabb=new Jr(I.min,I.max),m.centroid=(function(k,$){const W=[0,0,0],Q=k.length;if(Q>0){for(let te=0;te<Q;te++){const ne=3*k[te];W[0]+=$[ne],W[1]+=$[ne+1],W[2]+=$[ne+2]}W[0]/=Q,W[1]/=Q,W[2]/=Q}return W})(P,O),d.COLOR_0!==void 0){const k=t.json.accessors[d.COLOR_0],$=Sv[k.type],W=Mg(t,k);m.colorArray=$===3?new il:new $u,m.colorArray.resize(k.count),cT(t,k,m.colorArray,W)}if(d.NORMAL!==void 0){m.normalArray=new il;const k=t.json.accessors[d.NORMAL];m.normalArray.resize(k.count);const $=Mg(t,k);cT(t,k,m.normalArray,$)}if(d.TEXCOORD_0!==void 0&&o.length>0){m.texcoordArray=new Wu;const k=t.json.accessors[d.TEXCOORD_0];m.texcoordArray.resize(k.count);const $=Mg(t,k);cT(t,k,m.texcoordArray,$)}if(d._FEATURE_ID_RGBA4444!==void 0){const k=t.json.accessors[d._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=Mg(t,k))}d._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(Mg(t,t.json.accessors[d._FEATURE_RGBA4444]).buffer));const L=s.material;return m.material=(function(k,$){const{emissiveFactor:W=[0,0,0],alphaMode:Q="OPAQUE",alphaCutoff:te=.5,normalTexture:ne,occlusionTexture:ue,emissiveTexture:he,doubleSided:me,name:Ae}=k,{baseColorFactor:Pe=[1,1,1,1],metallicFactor:Fe=1,roughnessFactor:Be=1,baseColorTexture:Ve,metallicRoughnessTexture:at}=k.pbrMetallicRoughness||{},Ze=ue?$[ue.index]:void 0;if(ue&&ue.extensions&&ue.extensions.KHR_texture_transform&&Ze){const ft=ue.extensions.KHR_texture_transform;Ze.offsetScale=[ft.offset[0],ft.offset[1],ft.scale[0],ft.scale[1]]}return{name:Ae,pbrMetallicRoughness:{baseColorFactor:new zn(...Pe),metallicFactor:Fe,roughnessFactor:Be,baseColorTexture:Ve?$[Ve.index]:void 0,metallicRoughnessTexture:at?$[at.index]:void 0},doubleSided:me,emissiveFactor:new zn(...W),alphaMode:Q,alphaCutoff:te,normalTexture:ne?$[ne.index]:void 0,occlusionTexture:Ze,emissionTexture:he?$[he.index]:void 0,defined:k.defined===void 0}})(L!==void 0?t.json.materials[L]:{defined:!1},o),m}function yz(s,t,o){const{matrix:c,rotation:d,translation:m,scale:g,mesh:b,extras:P,children:I,name:O}=s,L={};if(L.name=O,L.localMatrix=c||(function(k,$,W,Q){var te=$[0],ne=$[1],ue=$[2],he=$[3],me=te+te,Ae=ne+ne,Pe=ue+ue,Fe=te*me,Be=te*Ae,Ve=te*Pe,at=ne*Ae,Ze=ne*Pe,ft=ue*Pe,xt=he*me,Ct=he*Ae,Wt=he*Pe,Rt=Q[0],wt=Q[1],Dt=Q[2];return k[0]=(1-(at+ft))*Rt,k[1]=(Be+Wt)*Rt,k[2]=(Ve-Ct)*Rt,k[3]=0,k[4]=(Be-Wt)*wt,k[5]=(1-(Fe+ft))*wt,k[6]=(Ze+xt)*wt,k[7]=0,k[8]=(Ve+Ct)*Dt,k[9]=(Ze-xt)*Dt,k[10]=(1-(Fe+at))*Dt,k[11]=0,k[12]=W[0],k[13]=W[1],k[14]=W[2],k[15]=1,k})([],d||[0,0,0,1],m||[0,0,0],g||[1,1,1]),L.globalMatrix=Z(L.localMatrix),b!==void 0){L.meshes=o[b];const k=L.anchor=[0,0];for(const $ of L.meshes){const{min:W,max:Q}=$.aabb;k[0]+=W[0]+Q[0],k[1]+=W[1]+Q[1]}k[0]=Math.floor(k[0]/L.meshes.length/2),k[1]=Math.floor(k[1]/L.meshes.length/2)}if(P&&(P.id&&(L.id=P.id),P.lights&&(L.lights=(function(k){if(!k.length)return[];const $=(function(ue){const he=atob(ue),me=new Uint8Array(he.length);for(let Ae=0;Ae<he.length;Ae++)me[Ae]=he.codePointAt(Ae);return me})(k),W=[],Q=$.length/24,te=new Uint16Array($.buffer),ne=new Float32Array($.buffer);for(let ue=0;ue<Q;ue++){const he=te[2*ue*6]/30,me=te[2*ue*6+1]/30,Ae=te[2*ue*6+10]/100,Pe=ne[6*ue+1],Fe=ne[6*ue+2],Be=ne[6*ue+3],Ve=ne[6*ue+4],at=Be-Pe,Ze=Ve-Fe,ft=Math.hypot(at,Ze);W.push({pos:[Pe+.5*at,Fe+.5*Ze,me],normal:[Ze/ft,-at/ft,0],width:ft,height:he,depth:Ae,points:[Pe,Fe,Be,Ve]})}return W})(P.lights)),P.MAPBOX_geometry_bloom&&(L.isGeometryBloom=P.MAPBOX_geometry_bloom)),I){const k=[];for(const $ of I)k.push(yz(t.json.nodes[$],t,o));L.children=k}return L}function AZ(s){if(s.vertices.length===0||s.indices.length===0)return null;const t=new $x(s.vertices,s.indices,8,256),[o,c]=[t.min.clone(),t.max.clone()];return{vertices:s.vertices,indices:s.indices,grid:t,min:o,max:c}}function DZ(s){if(!s.extras||!s.extras.ground)return null;const t=s.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const o=t[0];if(!o||!Array.isArray(o)||o.length===0)return null;const c=[];for(const g of o){if(!Array.isArray(g)||g.length!==2)continue;const b=g[0],P=g[1];typeof b=="number"&&typeof P=="number"&&c.push(new St(b,P))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let d=0;for(let g=0;g<c.length;g++){const b=c[g],P=c[(g+1)%c.length],I=c[(g+2)%c.length];d+=(b.x-P.x)*(I.y-P.y)-(I.x-P.x)*(b.y-P.y)}d>0&&c.reverse();const m=D_(c.flatMap((g=>[g.x,g.y])),[]);return m.length===0?null:{vertices:c,indices:m}}function RZ(s,t){const o=[],c=[];let d=0;const m=[];for(const g of s){d=o.length;const b=g.vertexArray.float32,P=g.indexArray.uint16;for(let I=0;I<g.vertexArray.length;I++)m[0]=b[3*I+0],m[1]=b[3*I+1],m[2]=b[3*I+2],Yr(m,m,t),o.push(new St(m[0],m[1]));for(let I=0;I<3*g.indexArray.length;I++)c.push(P[I]+d)}if(c.length%3!=0)return null;for(let g=0;g<c.length;g+=3){const b=o[c[g+0]],P=o[c[g+1]],I=o[c[g+2]];(b.x-P.x)*(I.y-P.y)-(I.x-P.x)*(b.y-P.y)>0&&([c[g+1],c[g+2]]=[c[g+2],c[g+1]])}return{vertices:o,indices:c}}function uT(s){const t=(function(P,I){const O=[],L=WebGL2RenderingContext;if(P.json.textures)for(const k of P.json.textures){const $={magFilter:L.LINEAR,minFilter:L.NEAREST,wrapS:L.REPEAT,wrapT:L.REPEAT};k.sampler!==void 0&&Object.assign($,P.json.samplers[k.sampler]),O.push({image:I[k.source],sampler:$,uploaded:!1})}return O})(s,s.images),o=(function(P,I){const O=[];for(const L of P.json.meshes){const k=[];for(const $ of L.primitives)k.push(CZ($,P,I));O.push(k)}return O})(s,t),{scenes:c,scene:d,nodes:m}=s.json,g=c?c[d||0].nodes:[...m.keys()],b=[];for(const P of g)b.push(yz(m[P],s,o));return(function(P,I,O){const L={},k=new Set;for(let $=0;$<P.length;$++){const W=O[I[$]];if(!W.extras)continue;const Q=W.extras["mapbox:footprint:version"],te=W.extras["mapbox:footprint:id"];(Q||te)&&k.add($),Q==="1.0.0"&&te&&(L[te]=$)}for(let $=0;$<P.length;$++){if(k.has($))continue;const W=P[$],Q=O[I[$]];if(!Q.extras)continue;let te=null;W.id in L&&(te=RZ(P[L[W.id]].meshes,W.localMatrix)),te||(te=DZ(Q)),te&&(W.footprint=AZ(te))}if(k.size>0){const $=Array.from(k.values()).sort(((W,Q)=>W-Q));for(let W=$.length-1;W>=0;W--)P.splice($[W],1)}})(b,g,s.json.nodes),b}function OZ(s){s.heightmap=new Float32Array(4096),s.heightmap.fill(-1);const t=s.vertexArray.float32,o=s.aabb.min[0]-1,c=s.aabb.min[1]-1,d=Ig/(s.aabb.max[0]-o+2),m=Ig/(s.aabb.max[1]-c+2);for(let g=0;g<t.length;g+=3){const b=t[g+2],P=(t[g+0]-o)*d|0,I=(t[g+1]-c)*m|0;b>s.heightmap[I*Ig+P]&&(s.heightmap[I*Ig+P]=b)}}function vz(s,t,o,c,d){o.reserve(o.length+4*s.length),c.reserve(c.length+10*s.length),d.reserve(d.length+10*s.length);let m=c.length;for(const g of s){const b=Math.min(10,Math.max(4,1.3*g.height))*t,P=[-g.normal[1],g.normal[0],0],I=Math.min(.29,.1*g.width/g.depth),O=g.width-2*g.depth*t*(I+.01),L=Vt([],g.pos,P,O/2),k=Vt([],g.pos,P,-O/2),$=[L[0],L[1],L[2]+g.height],W=[k[0],k[1],k[2]+g.height],Q=Vt([],g.normal,P,I);_t(Q,Q,b);const te=Vt([],g.normal,P,-I);_t(te,te,b),Et(Q,L,Q),Et(te,k,te),L[2]+=.1,k[2]+=.1,c.emplaceBack(Q[0],Q[1],Q[2]),c.emplaceBack(te[0],te[1],te[2]),c.emplaceBack(L[0],L[1],L[2]),c.emplaceBack(k[0],k[1],k[2]),c.emplaceBack($[0],$[1],$[2]),c.emplaceBack(W[0],W[1],W[2]),c.emplaceBack(L[0],L[1],L[2]),c.emplaceBack(k[0],k[1],k[2]),c.emplaceBack(Q[0],Q[1],Q[2]),c.emplaceBack(te[0],te[1],te[2]);const ne=O/b/2;d.emplaceBack(-ne-I,-1,ne,.8),d.emplaceBack(ne+I,-1,ne,.8),d.emplaceBack(-ne,0,ne,1.3),d.emplaceBack(ne,0,ne,1.3),d.emplaceBack(ne+I,-.8,ne,.7),d.emplaceBack(ne+I,-.8,ne,.7),d.emplaceBack(0,0,ne,1.3),d.emplaceBack(0,0,ne,1.3),d.emplaceBack(ne+I,-1.2,ne,.8),d.emplaceBack(ne+I,-1.2,ne,.8),o.emplaceBack(6+m,4+m,8+m),o.emplaceBack(7+m,9+m,5+m),o.emplaceBack(0+m,1+m,2+m),o.emplaceBack(1+m,3+m,2+m),m+=10}}function LZ(s,t){const o={};o.indexArray=new Li,o.vertexArray=new il,o.colorArray=new $u,vz(s,t,o.indexArray,o.vertexArray,o.colorArray);const c={defined:!0};c.emissiveFactor=zn.black;const d={};return d.baseColorFactor=zn.white,c.pbrMetallicRoughness=d,o.material=c,o.aabb=new Jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}const xz=pn([{name:"a_pos_3f",components:3,type:"Float32"}]),zZ=pn([{name:"a_normal_3",components:3,type:"Int16"}]),FZ=pn([{name:"a_centroid_3",components:3,type:"Int16"}]),bz=pn([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),kZ=pn([{name:"a_faux_facade_color_emissive",components:2,type:"Uint16"}]),BZ=pn([{name:"a_faux_facade_data",components:4,type:"Uint16"}]),jZ=pn([{name:"a_faux_facade_vertical_range",components:2,type:"Uint16"}]),NZ=pn([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),VZ=pn([{name:"a_flood_light_wall_radius_1i16",components:1,type:"Uint16"}]),wz=Mt.types,ib=32767;function UZ(s,t){const o=Ut+t;for(const c of s)for(const d of c)if(d.x<-t||d.x>o||d.y<-t||d.y>o)return!1;return!0}class Sz{constructor(){this.layoutVertexArray=new il,this.layoutAttenuationArray=new $u,this.layoutColorArray=new Hl,this.indexArray=new Li,this.indexArrayForConflation=new Li,this.segmentsBucket=new Wn}}class dT{constructor(){this.layoutVertexArray=new il,this.layoutNormalArray=new sh,this.layoutCentroidArray=new sh,this.layoutColorArray=new Hl,this.layoutFacadePaintArray=null,this.layoutFacadeDataArray=null,this.layoutFacadeVerticalRangeArray=null,this.layoutFloodLightDataArray=new af,this.layoutAOArray=new Wc,this.indexArray=new Li,this.indexArrayForConflation=new Li,this.segmentsBucket=new Wn,this.entranceBloom=new Sz}}class Tz{constructor(t){this.colorBufferUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.buildingWithoutFacade=new dT,this.buildingWithFacade=new dT,this.indexArrayForConflationUploaded=!1,this.featureFootprintLookup=new Map,this.footprintLookup={},this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.worldview=t.worldview,this.lut=t.lut,this.buildingWithFacade.layoutFacadePaintArray=new Hl,this.buildingWithFacade.layoutFacadeDataArray=new Uu,this.buildingWithFacade.layoutFacadeVerticalRangeArray=new Hl,this.programConfigurations=new wl(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.projection=t.projection,this.groundEffect=new ZS(t),this.groundEffect.groundRadiusArray=new Wc,this.hasAppearances=null}updateFootprints(t,o){for(const c of this.footprints)o.push({footprint:c,id:t})}updateAppearances(t,o,c,d){}prepare(){return(function(){if(Xx!=null||nz!=null)return null;if(F_!=null)return F_;const t=fetch(ii.BUILDING_GEN_URL);return F_=(function(o){let c,d,m,g;function b(){c=new Uint8Array(g.buffer),d=new Int32Array(g.buffer),m=new Float32Array(g.buffer)}function P(){throw new Error("Unexpected BuildingGen error.")}const I=()=>{},O={a:{a:P,f:function(L){const k=c.length,$=Math.max(L>>>0,Math.ceil(1.2*k)),W=Math.ceil(($-k)/65536);try{return g.grow(W),b(),!0}catch{return!1}},g:P,b:I,c:I,d:I,e:I}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(o,O):o.then((L=>L.arrayBuffer())).then((L=>WebAssembly.instantiate(L,O)))).then((L=>{const k=L.instance.exports;return(0,k.g)(),g=k.f,b(),new pZ({setStyle:k.h,setAOOptions:k.i,setMetricOptions:k.j,setStructuralOptions:k.k,setFacadeOptions:k.l,setFauxFacadeOptions:k.m,setFacadeClassifierOptions:k.n,addFeature:k.o,addFacade:k.p,generateMesh:k.q,getLastError:k.r,getOuterRingLength:k.s,getMeshCount:k.t,getPositionsPtr:k.u,getPositionsLength:k.v,getNormalsPtr:k.w,getNormalsLength:k.x,getColorsPtr:k.y,getColorsLength:k.z,getAOPtr:k.A,getAOLength:k.B,getUVPtr:k.C,getUVLength:k.D,getFauxFacadePtr:k.E,getFauxFacadeLength:k.F,getIndicesPtr:k.G,getIndicesLength:k.H,getBuildingPart:k.I,getRingCount:k.J,getRingPtr:k.K,getRingLength:k.L,free:k.M,malloc:k.N,heapU8:c,heap32:d,heapF32:m})}))})(t).then((o=>(F_=null,Xx=o,Xx))).catch((o=>{Cr("Could not load building-gen"),F_=null,nz=o})),F_})()}populate(t,o,c,d){const m=mZ();if(!m)return;const g=De(c);this.tileToMeter=g,this.brightness=o.brightness,m.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,g],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:g,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),m.setAOOptions(!1,.3),m.setMetricOptions(!1,16),m.setStructuralOptions(!0),m.setFacadeClassifierOptions(3);const b=new Map,P=new Map;for(const{feature:I}of t){if(wz[I.type]!=="LineString"){b.set(I.id,I.properties.source_id);continue}const O=this.layers[0]._featureFilter.needGeometry,L=rt(I,O);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),L,c))continue;const k=O?L.geometry:dt(I,c,d),$=[];for(const ne of k)for(const ue of ne)$.push({x:ue.x,y:ue.y});const W={coordinates:$,crossPerc:I.properties.cross_perc,distanceToRoad:I.properties.distance_to_road,entrances:I.properties.entrances,sourceId:0},Q=I.properties.source_id;let te=P.get(Q);te||(te=[],P.set(Q,te)),te.push(W)}this.maxHeight=0;for(const{feature:I,id:O,index:L,sourceLayerIndex:k}of t){if(wz[I.type]==="LineString")continue;const $=this.layers[0]._featureFilter.needGeometry,W=rt(I,$);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom),W,c))continue;const Q=$?W.geometry:dt(I,c,d),te=pv(Q,500);if(!UZ(Q,163))continue;const ne=this.layers[0],ue=ne.layout.get("building-roof-shape").evaluate(I,{},c);if(ue==="flat")continue;const he=ne.layout.get("building-base").evaluate(I,{},c),me=ne.layout.get("building-height").evaluate(I,{},c),Ae=ne.layout.get("building-flood-light-ground-radius").evaluate(I,{},c),Pe=ne.paint.get("building-ambient-occlusion-intensity"),Fe=Ae/this.tileToMeter;let Be=ne.layout.get("building-flood-light-wall-radius").evaluate(I,{},c);Be=le(Be,0,2048);const Ve=Be/2048*ib,at=b.get(O);let Ze;Ze=P.has(at)?P.get(at):[];const ft=Ze.length!==0&&ne.layout.get("building-facade").evaluate(I,{},c);m.setFacadeOptions(4,!0),m.setFauxFacadeOptions(ft,!1,1);let xt=0,Ct=0,Wt=0,Rt=0,wt=0,Dt=0;if(ft){let gt=Math.round(ne.layout.get("building-facade-floors").evaluate(I,{},c));if(he===0){gt=Math.max(1,gt-(Ze.length>0?1:0));let Tr=4;if(me>100){const wr=[10,13,15];Tr=wr[I.id?I.id%wr.length:0],m.setFacadeOptions(Tr,!0)}wt=1.6803*Tr/g}else wt=he/g;Dt=me/g,wt=Math.min(wt,Dt),Wt=ne.layout.get("building-facade-unit-width").evaluate(I,{},c)/g,Rt=(Dt-wt)/gt,m.setFauxFacadeOptions(!0,!0,Wt);const er=ne.layout.get("building-facade-window").evaluate(I,{},c);xt=er[0],Ct=er[1]}const ot=[],it=new St(1/0,1/0),At=new St(-1/0,-1/0),jt=new St(0,0);let It=0;for(const gt of te)if(gt.length>0){const er=[];for(const Tr of gt){const wr=[];for(let ln=Tr.length-1;ln>=0;ln--){const Ur=Tr[ln];wr.push({x:Ur.x,y:Ur.y}),it.x=Math.min(it.x,Ur.x),it.y=Math.min(it.y,Ur.y),At.x=Math.max(At.x,Ur.x),At.y=Math.max(At.y,Ur.y),jt.x+=Ur.x,jt.y+=Ur.y,It++}er.push(wr)}ot.push({id:I.id?I.id:0,height:me,minHeight:he,sourceId:0,roofType:ue,coordinates:er})}jt.x/=It||1,jt.y/=It||1;const dr=m.generateMesh(ot,Ze);if(typeof dr=="string"){Cr(`Unable to generate building ${I.id}: ${dr}`);continue}if(dr.meshes.length===0||dr.modifiedPolygonRings.length===0)continue;let _r=0;for(const gt of dr.meshes)_r+=gt.positions.length/3;const ir=ft?this.buildingWithFacade:this.buildingWithoutFacade,Jt=ir.segmentsBucket.prepareSegment(_r,ir.layoutVertexArray,ir.indexArray),Hr=[];let rr=null,Rr=0,Qr=-1;const gn=ir.layoutVertexArray.length,kn=ir.indexArray.length;let tn=0;for(const gt of dr.meshes){const er=ir.layoutVertexArray.length;if(gt.buildingPart==="entrance"){const vr=new Array;for(let On=0;On<gt.positions.length;On+=12){const wi=gt.positions[On+0],ci=gt.positions[On+1],po=gt.positions[On+3],Wi=gt.positions[On+4],Ai=gt.positions[On+2],gi=gt.positions[On+8]-Ai,Jn=1,cn=po-wi,ei=Wi-ci,Di=Math.hypot(cn,ei);vr.push({pos:[wi+.5*cn,ci+.5*ei,Ai],normal:[ei/Di,-cn/Di,0],width:Di,height:gi,depth:Jn,points:[wi,ci,po,Wi]})}const Hn=ir.entranceBloom.segmentsBucket.prepareSegment(10*vr.length,ir.entranceBloom.layoutVertexArray,ir.entranceBloom.indexArray),bi=ir.entranceBloom.layoutVertexArray.length;Rr=ir.entranceBloom.indexArray.length,vz(vr,.5/this.tileToMeter,ir.entranceBloom.indexArray,ir.entranceBloom.layoutVertexArray,ir.entranceBloom.layoutAttenuationArray);const Gr=ir.entranceBloom.layoutVertexArray.length-bi;Qr=ir.entranceBloom.indexArray.length-Rr;for(let On=0;On<Gr;On++)ir.entranceBloom.layoutColorArray.emplaceBack(65535,65535);Hn.vertexLength+=Gr,Hn.primitiveLength+=Qr,rr={part:gt.buildingPart,vertexOffset:bi,vertexLength:Gr}}for(let vr=0;vr<gt.positions.length;vr+=3)tn=Math.max(tn,gt.positions[vr+2]),ir.layoutVertexArray.emplaceBack(gt.positions[vr],gt.positions[vr+1],gt.positions[vr+2]);const Tr=Math.floor(jt.x),wr=Math.floor(jt.y),ln=Math.floor(tn);for(let vr=0;vr<gt.positions.length;vr+=3)ir.layoutCentroidArray.emplaceBack(Tr,wr,ln),ir.layoutFloodLightDataArray.emplaceBack(gt.buildingPart==="wall"?Ve:0);for(let vr=0;vr<gt.normals.length;vr+=3)ir.layoutNormalArray.emplaceBack(gt.normals[vr+0]*ib,gt.normals[vr+1]*ib,gt.normals[vr+2]*ib);for(let vr=0;vr<gt.ao.length;vr++)ir.layoutAOArray.emplaceBack(gt.ao[vr]);for(let vr=0;vr<gt.colors.length;vr+=3){const Hn=1+(gt.ao[vr/3]-1)*Pe;ir.layoutColorArray.emplaceBack(gt.colors[vr]*Hn<<8|gt.colors[vr+1]*Hn,gt.colors[vr+2]*Hn<<8)}if(ft){for(let vr=0;vr<gt.positions.length;vr+=3)ir.layoutFacadePaintArray.emplaceBack(65535,255);for(let vr=0;vr<gt.isFauxFacade.length;vr++)if(gt.isFauxFacade[vr]){const Hn=1|Math.min(65535,Math.floor(gt.uv[2*vr]*dr.outerRingLength)),bi=Math.floor(255*xt)<<8|Math.floor(255*Ct),Gr=Math.floor(65535*Math.min(1,Wt/Ut)),On=Math.floor(65535*Math.min(1,Rt/Ut));ir.layoutFacadeDataArray.emplaceBack(Hn,bi,Gr,On);const wi=Math.floor(65535*Math.min(1,wt/Ut)),ci=Math.floor(65535*Math.min(1,Dt/Ut));ir.layoutFacadeVerticalRangeArray.emplaceBack(wi,ci)}else ir.layoutFacadeDataArray.emplaceBack(0,0,0,0),ir.layoutFacadeVerticalRangeArray.emplaceBack(0,0)}const Ur=Jt.vertexLength;for(let vr=0;vr<gt.indices.length;vr+=3)ir.indexArray.emplaceBack(Ur+gt.indices[vr],Ur+gt.indices[vr+1],Ur+gt.indices[vr+2]);Jt.vertexLength+=gt.positions.length/3,Jt.primitiveLength+=gt.indices.length/3,(gt.buildingPart==="roof"||gt.buildingPart==="wall"||gt.buildingPart==="facade_glazing"||gt.buildingPart==="entrance")&&Hr.push({part:gt.buildingPart,vertexOffset:er,vertexLength:gt.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,tn),this.buildingFeatures.push({promoteId:O,feature:W,hasFauxFacade:ft,segment:Jt,parts:Hr,buildingBloom:rr});const Kn=ir.indexArray.length-kn,Qn=[],no=[],Ie=new St(1/0,1/0),Se=new St(-1/0,-1/0),mt=this.groundEffect.vertexArray.length;for(const gt of dr.modifiedPolygonRings){const er=[],Tr=new St(1/0,1/0),wr=new St(-1/0,-1/0);for(let ln=0;ln<gt.length;ln+=2){const Ur=gt.length-ln-2;Tr.x=Math.min(Tr.x,gt[Ur]),Tr.y=Math.min(Tr.y,gt[Ur+1]),wr.x=Math.max(wr.x,gt[Ur]),wr.y=Math.max(wr.y,gt[Ur+1]);const vr=new St(gt[Ur],gt[Ur+1]);er.push(vr),Qn.push(vr.x,vr.y),no.push(vr.clone())}Ie.x=Math.min(Ie.x,Tr.x),Ie.y=Math.min(Ie.y,Tr.y),Se.x=Math.max(Se.x,wr.x),Se.y=Math.max(Se.y,wr.y),this.groundEffect.addData(er,[Tr,wr],Fe)}const Zt=this.groundEffect.vertexArray.length-mt;for(let gt=0;gt<Zt;gt++)this.groundEffect.groundRadiusArray.emplaceBack(Ae);(it.x<0||At.x>Ut||it.y<0||At.y>Ut)&&this.featuresOnBorder.push({featureId:I.id,footprintIndex:this.footprints.length});{const gt=D_(Qn,null,2),er=new $x(no,gt,8,256);let Tr=I.id;I.properties&&I.properties.hasOwnProperty("building_id")&&(Tr=I.properties.building_id);const wr={vertices:no,indices:gt,grid:er,min:Ie,max:Se,buildingId:Tr,hiddenFlags:0,indicesOffset:kn,indicesLength:Kn,bloomIndicesOffset:Rr,bloomIndicesLength:Qr,groundEffectVertexOffset:mt,groundEffectVertexLength:Zt,hasFauxFacade:ft,segment:Jt,height:tn};I.id!==void 0&&this.featureFootprintLookup.set(I.id,this.footprints.length),this.footprints.push(wr)}this.programConfigurations.populatePaintArrays(ir.layoutVertexArray.length,I,L,{},o.availableImages,c,o.brightness),this.groundEffect.addPaintPropertiesData(I,L,{},o.availableImages,c,o.brightness),o.featureIndex.insert(I,Q,L,k,this.index,gn)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0],{})}update(t,o,c,d,m,g,b){this.programConfigurations.updatePaintArrays(t,o,m,c,d,g,b),this.groundEffect.update(t,o,m,c,d,g,b),this.evaluate(this.layers[0],t),this.colorBufferUploaded=!1}isEmpty(){return this.buildingWithoutFacade.layoutVertexArray.length===0&&this.buildingWithFacade.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){const o=c=>{c.layoutVertexBuffer=t.createVertexBuffer(c.layoutVertexArray,xz.members),c.layoutNormalBuffer=t.createVertexBuffer(c.layoutNormalArray,zZ.members),c.layoutCentroidBuffer=t.createVertexBuffer(c.layoutCentroidArray,FZ.members),c.layoutFloodLightDataBuffer=t.createVertexBuffer(c.layoutFloodLightDataArray,VZ.members),c.layoutFacadeDataArray&&c.layoutFacadeDataArray.length&&(c.layoutFacadeDataBuffer=t.createVertexBuffer(c.layoutFacadeDataArray,BZ.members)),c.layoutFacadeVerticalRangeArray&&c.layoutFacadeVerticalRangeArray.length&&(c.layoutFacadeVerticalRangeBuffer=t.createVertexBuffer(c.layoutFacadeVerticalRangeArray,jZ.members)),c.entranceBloom.layoutVertexArray.length&&(c.entranceBloom.layoutVertexBuffer=t.createVertexBuffer(c.entranceBloom.layoutVertexArray,xz.members),c.entranceBloom.layoutAttenuationBuffer=t.createVertexBuffer(c.entranceBloom.layoutAttenuationArray,NZ.members)),this.uploadUpdatedColorBuffer(t),this.uploadUpdatedIndexBuffer(t)};this.uploaded||(o(this.buildingWithoutFacade),o(this.buildingWithFacade),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){const t=o=>{o.layoutVertexBuffer&&(o.layoutVertexBuffer.destroy(),o.layoutNormalBuffer.destroy(),o.layoutColorBuffer.destroy(),o.segmentsBucket.destroy(),o.indexBuffer&&o.indexBuffer.destroy(),o.entranceBloom.layoutVertexBuffer&&(o.entranceBloom.layoutVertexBuffer.destroy(),o.entranceBloom.layoutColorBuffer.destroy(),o.entranceBloom.layoutAttenuationBuffer.destroy(),o.entranceBloom.indexBuffer.destroy(),o.entranceBloom.segmentsBucket.destroy()))};t(this.buildingWithoutFacade),t(this.buildingWithFacade),this.groundEffect.destroy(),this.programConfigurations.destroy()}updateFootprintHiddenFlags(t,o,c=!0){let d=!1;const m=c?o:0,g=0|(c?-1:~o);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const b of t){const P=this.footprints[b],I=P.hiddenFlags&g|m;P.hiddenFlags!==I&&(P.hiddenFlags=I,d=!0,this.groundEffect.updateHiddenByLandmarkRange(P.groundEffectVertexOffset,P.groundEffectVertexLength,P.hiddenFlags!==0))}return d&&(this.indexArrayForConflationUploaded=!1),d}uploadUpdatedIndexBuffer(t){if(this.groundEffect.uploadHiddenByLandmark(t),this.indexArrayForConflationUploaded)return;const o=d=>{d.indexArray.length!==0&&(d.indexArrayForConflation.resize(d.indexArray.length),d.indexArrayForConflation.uint16.set(d.indexArray.uint16),d.entranceBloom.indexArrayForConflation.resize(d.entranceBloom.indexArray.length),d.entranceBloom.indexArrayForConflation.uint16.set(d.entranceBloom.indexArray.uint16))};o(this.buildingWithoutFacade),o(this.buildingWithFacade);for(const d of this.footprints){const m=d.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade,g=d.indicesOffset+d.indicesLength;if(d.hiddenFlags!==0){for(let P=d.indicesOffset;P<g;P++)m.indexArrayForConflation.uint16[3*P+0]=0,m.indexArrayForConflation.uint16[3*P+1]=0,m.indexArrayForConflation.uint16[3*P+2]=0;const b=d.bloomIndicesOffset+d.bloomIndicesLength;for(let P=d.bloomIndicesOffset;P<b;P++)m.entranceBloom.indexArrayForConflation.uint16[3*P+0]=0,m.entranceBloom.indexArrayForConflation.uint16[3*P+1]=0,m.entranceBloom.indexArrayForConflation.uint16[3*P+2]=0}}const c=d=>{d.indexArray.length!==0&&(d.indexBuffer?d.indexBuffer.updateData(d.indexArrayForConflation):d.indexBuffer=t.createIndexBuffer(d.indexArrayForConflation,!0),d.entranceBloom.indexBuffer?d.entranceBloom.indexBuffer.updateData(d.entranceBloom.indexArrayForConflation):d.entranceBloom.indexBuffer=t.createIndexBuffer(d.entranceBloom.indexArrayForConflation,!0))};c(this.buildingWithoutFacade),c(this.buildingWithFacade),this.indexArrayForConflationUploaded=!0}uploadUpdatedColorBuffer(t){const o=c=>{c.layoutColorBuffer?c.layoutColorBuffer.updateData(c.layoutColorArray):c.layoutColorBuffer=t.createVertexBuffer(c.layoutColorArray,bz.members,!0),c.layoutFacadePaintArray&&(c.layoutFacadePaintBuffer?c.layoutFacadePaintBuffer.updateData(c.layoutFacadePaintArray):c.layoutFacadePaintBuffer=t.createVertexBuffer(c.layoutFacadePaintArray,kZ.members,!0)),c.entranceBloom.layoutColorBuffer?c.entranceBloom.layoutColorBuffer.updateData(c.entranceBloom.layoutColorArray):c.entranceBloom.layoutColorBuffer=t.createVertexBuffer(c.entranceBloom.layoutColorArray,bz.members,!0)};o(this.buildingWithoutFacade),o(this.buildingWithFacade),this.colorBufferUploaded=!0}evaluate(t,o){const c=t.paint.get("building-ambient-occlusion-intensity");for(const d of this.buildingFeatures){const m=o[d.promoteId],g=d.feature;g.properties["building-part"]="roof";const b=t.paint.get("building-color").evaluate(g,m,this.canonical).toPremultipliedRenderColor(this.lut),P=t.paint.get("building-emissive-strength").evaluate(g,m,this.canonical);g.properties["building-part"]="wall";const I=t.paint.get("building-color").evaluate(g,m,this.canonical).toPremultipliedRenderColor(this.lut),O=t.paint.get("building-emissive-strength").evaluate(g,m,this.canonical);g.properties["building-part"]="window";const L=t.paint.get("building-color").evaluate(g,m,this.canonical).toPremultipliedRenderColor(this.lut),k=t.paint.get("building-emissive-strength").evaluate(g,m,this.canonical);g.properties["building-part"]="door";const $=t.paint.get("building-color").evaluate(g,m,this.canonical).toPremultipliedRenderColor(this.lut),W=t.paint.get("building-emissive-strength").evaluate(g,m,this.canonical),Q=d.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade;for(const ne of d.parts){let ue,he=b;ne.part==="roof"?(he=b,ue=P):ne.part==="wall"?(he=I,ue=O):ne.part==="facade_glazing"?(he=L,ue=k):ne.part==="entrance"&&(he=$,ue=W),ue=le(ue,0,1);for(let me=0;me<ne.vertexLength;me++){const Ae=ne.vertexOffset+me,Pe=1+(Q.layoutAOArray.float32[Ae]-1)*c;Q.layoutColorArray.emplace(Ae,he.r*Pe*255<<8|he.g*Pe*255,he.b*Pe*255<<8|255*ue),d.hasFauxFacade&&Q.layoutFacadePaintArray.emplace(Ae,255*L.r<<8|255*L.g,255*L.b<<8|255*k)}}const te=d.buildingBloom;if(te)for(let ne=0;ne<te.vertexLength;ne++)Q.entranceBloom.layoutColorArray.emplace(te.vertexOffset+ne,255*$.r<<8|255*$.g,255*$.b<<8|51*W)}}needsEvaluation(){return!this.colorBufferUploaded}updateReplacement(t,o,c){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const d=o.getReplacementRegionsForTile(t.toUnwrapped());if(qx(this.activeReplacements,d))return;this.activeReplacements=d;for(const g of this.footprints)g.hiddenFlags&=-2;const m=[];for(const g of this.activeReplacements){if(g.order<=EL)continue;const b=Math.max(1,Math.pow(2,g.footprintTileId.canonical.z-t.canonical.z));for(const P of this.footprints)P.min.x>g.max.x||P.max.x<g.min.x||P.min.y>g.max.y||P.max.y<g.min.y||(m.length=0,$Z(P.vertices,0,P.vertices.length,g.footprintTileId.canonical,t.canonical,m),qS(g.footprint,m,P.indices,0,P.indices.length,0,-b)&&(P.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const g of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(g.groundEffectVertexOffset,g.groundEffectVertexLength,g.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getFootprint(t){if(t.id!==void 0){const o=this.featureFootprintLookup.get(t.id);return this.footprints[o]}return null}getHeightAtTileCoord(t,o){let c=Number.NEGATIVE_INFINITY,d=!0;const m=4*(t+Ut)*Ut+(o+Ut);if(this.footprintLookup.hasOwnProperty(m)){const b=this.footprintLookup[m];return b?{height:b.height,hidden:b.hiddenFlags!==0}:void 0}const g=new St(t,o);for(const b of this.footprints)t>b.max.x||b.min.x>t||o>b.max.y||b.min.y>o||b.height<=c||GS(g,b)&&(c=b.height,this.footprintLookup[m]=b,d=b.hiddenFlags!==0);if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:d};this.footprintLookup[m]=void 0}}function $Z(s,t,o,c,d,m){const g=Math.pow(2,c.z-d.z);for(let b=0;b<o;b++){let P=s[b+t].x,I=s[b+t].y;P=(P+d.x*Ut)*g-c.x*Ut,I=(I+d.y*Ut)*g-c.y*Ut,m.push(new St(P,I))}}let Ez,Pz;cr(Tz,"BuildingBucket",{omit:["layers"]}),cr(dT,"BuildingGeometry"),cr(Sz,"BuildingBloomGeometry");const WZ=pn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),qZ=pn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:GZ}=WZ,HZ=pn([{name:"a_packed",components:3,type:"Float32"}]),{members:YZ}=HZ,ZZ=pn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:XZ}=ZZ;class Iz{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.image=new wm({width:t,height:o}),this.positions={},this.uploaded=!1}getDash(t,o){const c=this.getKey(t,o);return this.positions[c]}trim(){const t=this.width,o=this.height=We(this.nextRow);this.image.resize({width:t,height:o})}getKey(t,o){return t.join(",")+o}getDashRanges(t,o,c){const d=[];let m=t.length%2==1?-t[t.length-1]*c:0,g=t[0]*c,b=!0;d.push({left:m,right:g,isDash:b,zeroLength:t[0]===0});let P=t[0];for(let I=1;I<t.length;I++){b=!b;const O=t[I];m=P*c,P+=O,g=P*c,d.push({left:m,right:g,isDash:b,zeroLength:O===0})}return d}addRoundDash(t,o,c){const d=o/2;for(let m=-c;m<=c;m++){const g=this.width*(this.nextRow+c+m);let b=0,P=t[b];for(let I=0;I<this.width;I++){I/P.right>1&&(P=t[++b]);const O=Math.abs(I-P.left),L=Math.abs(I-P.right),k=Math.min(O,L);let $;const W=m/c*(d+1);if(P.isDash){const Q=d-Math.abs(W);$=Math.sqrt(k*k+Q*Q)}else $=d-Math.sqrt(k*k+W*W);this.image.data[g+I]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(t,o){for(let P=t.length-1;P>=0;--P){const I=t[P],O=t[P+1];I.zeroLength?t.splice(P,1):O&&O.isDash===I.isDash&&(O.left=I.left,t.splice(P,1))}const c=t[0],d=t[t.length-1];c.isDash===d.isDash&&(c.left=d.left-this.width,d.right=c.right+this.width);const m=this.width*this.nextRow;let g=0,b=t[g];for(let P=0;P<this.width;P++){P/b.right>1&&(b=t[++g]);const I=Math.abs(P-b.left),O=Math.abs(P-b.right),L=Math.min(I,O);this.image.data[m+P]=Math.max(0,Math.min(255,(b.isDash?L:-L)+o+128))}}addDash(t,o){const c=this.getKey(t,o);if(this.positions[c])return this.positions[c];const d=o==="round",m=d?7:0,g=2*m+1;if(this.nextRow+g>this.height)return Cr("LineAtlas out of space"),null;t.length===0&&t.push(1);let b=0;for(let O=0;O<t.length;O++)t[O]<0&&(Cr("Negative value is found in line dasharray, replacing values with 0"),t[O]=0),b+=t[O];if(b!==0){const O=this.width/b,L=this.getDashRanges(t,this.width,O);d?this.addRoundDash(L,O,m):this.addRegularDash(L,o==="square"?.5*O:0)}const P=this.nextRow+m;this.nextRow+=g;const I={tl:[P,m],br:[b,0]};return this.positions[c]=I,I}}cr(Iz,"LineAtlas");const KZ=Mt.types,QZ=Math.cos(Math.PI/180*37.5),JZ=Math.cos(Math.PI/180*5);class hT{constructor(t){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=t.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=t.overscaling,this.pixelRatio=t.pixelRatio,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((o=>{this.gradients[o.id]={}})),this.layoutVertexArray=new fp,this.layoutVertexArray2=new il,this.patternVertexArray=new il,this.indexArray=new Li,this.programConfigurations=new wl(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new Wn,this.maxLineLength=0,this.zOffsetVertexArray=new il,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.tessellationStep=t.tessellationStep?t.tessellationStep:Ut/64,this.worldview=t.worldview,this.hasAppearances=null}updateFootprints(t,o){}updateAppearances(t,o,c,d){}populate(t,o,c,d){this.hasPattern=jS("line",this.layers,this.pixelRatio,o);const m=this.layers[0].layout.get("line-sort-key");this.tileToMeter=De(c);const g=this.layers[0].layout.get("line-elevation-reference");if(g==="hd-road-markup")this.elevationType="road";else{const k=this.layers[0].layout.get("line-z-offset"),$=k.isConstant()&&!k.constantOr(0);this.elevationType=g!=="sea"&&g!=="ground"&&$?"none":"offset",this.elevationType==="offset"&&g==="none"&&Cr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const b=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&b!==void 0;const P=[];for(const{feature:k,id:$,index:W,sourceLayerIndex:Q}of t){const te=this.layers[0]._featureFilter.needGeometry,ne=rt(k,te);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom,{worldview:this.worldview,activeFloors:o.activeFloors}),ne,c))continue;const ue=m?m.evaluate(ne,{},c):void 0,he={id:$,properties:k.properties,type:k.type,sourceLayerIndex:Q,index:W,geometry:te?ne.geometry:dt(k,c,d),patterns:{},sortKey:ue};P.push(he)}m&&P.sort(((k,$)=>k.sortKey-$.sortKey));const{lineAtlas:I,featureIndex:O}=o,L=this.addConstantDashes(I);for(const k of P){const{geometry:$,index:W,sourceLayerIndex:Q}=k;if(L&&this.addFeatureDashes(k,I),this.hasPattern){const te=NS("line",this.layers,k,this.zoom,this.pixelRatio,o);this.patternFeatures.push(te)}else this.addFeature(k,$,W,c,I.positions,o.availableImages,o.brightness,o.elevationFeatures);O.insert(t[W].feature,$,W,Q,this.index)}}addConstantDashes(t){let o=!1;for(const c of this.layers){const d=c.paint.get("line-dasharray").value,m=c.layout.get("line-cap").value;if(d.kind!=="constant"||m.kind!=="constant")o=!0;else{const g=m.value,b=d.value;if(!b)continue;t.addDash(b,g)}}return o}addFeatureDashes(t,o){const c=this.zoom;for(const d of this.layers){const m=d.paint.get("line-dasharray").value,g=d.layout.get("line-cap").value;if(m.kind==="constant"&&g.kind==="constant")continue;let b,P;if(m.kind==="constant"){if(b=m.value,!b)continue}else b=m.evaluate({zoom:c},t);P=g.kind==="constant"?g.value:g.evaluate({zoom:c},t),o.addDash(b,P),t.patterns[d.id]=[o.getKey(b,P)]}}update(t,o,c,d,m,g,b,P){this.programConfigurations.updatePaintArrays(t,o,m,c,d,g,b,P)}addFeatures(t,o,c,d,m,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,c,d,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,YZ)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=t.createVertexBuffer(this.patternVertexArray,XZ)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,qZ.members,!0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,GZ),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t,o){let c,d;if(o&&o>0?(c=`mapbox_clip_start_${o}`,d=`mapbox_clip_end_${o}`):(c="mapbox_clip_start",d="mapbox_clip_end"),t.properties&&t.properties.hasOwnProperty(c)&&t.properties.hasOwnProperty(d))return{start:+t.properties[c],end:+t.properties[d]}}addFeature(t,o,c,d,m,g,b,P){const I=this.layers[0].layout,O=I.get("line-join").evaluate(t,{}),L=I.get("line-cap").evaluate(t,{}),k=I.get("line-miter-limit"),$=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(t),this.lineFeature=t;const W=!(!t.properties||!t.properties.hasOwnProperty("mapbox_line_metrics"))&&t.properties.mapbox_line_metrics;this.zOffsetValue=I.get("line-z-offset").value;const Q=this.layers[0].paint.get("line-width").value;if(Q.kind!=="constant"&&Q.isLineProgressConstant===!1&&(this.variableWidthValue=Q),this.elevationType==="road"){const te=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(t,o,d,P,O,L,k,$)){const[ne,ue]=this.clipRuntimeLinesToTile(o,1);for(let he=0;he<ne.length;he++){const me=ne[he],Ae=ue[he],Pe={progress:{min:Ae.progress.min,max:Ae.progress.max},nextDir:this.computeSegNextDir(Ae,me),prevDir:this.computeSegPrevDir(Ae,me)};this.addLine(me,t,d,O,L,k,$,Pe,W&&Ae.parentIndex>0?Ae.parentIndex:null)}this.fillNonElevatedRoadSegment(te)}}else for(let te=0;te<o.length;te++)this.addLine(o[te],t,d,O,L,k,$,void 0,W&&te>0?te:null);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,m,g,d,b,void 0,this.worldview)}computeSegNextDir(t,o){return t.nextPoint.sub(o.at(-2)).unit()}computeSegPrevDir(t,o){return o[1].sub(t.prevPoint).unit()}clipLinesToTile(t,o){return Yx(t,-o,-o,Ut+o,Ut+o)}clipRuntimeLinesToTile(t,o){const c=[];return[Yx(t,-o,-o,Ut+o,Ut+o,c),c]}addElevatedRoadFeature(t,o,c,d,m,g,b,P){const I=[],O=qr.getElevationFeature(t,d);if(O){const L=this.clipLinesToTile(o,1),k=this.prepareElevatedLines(L,O,c);for(const $ of k)I.push({geometry:$,elevation:O,elevationTileID:c,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(I.length===0)return!1;for(const L of I){const k=this.layoutVertexArray.length;this.addLine(L.geometry,t,c,m,g,b,P);const $=new En(c,L.elevationTileID);if(L.elevation)for(let W=k;W<this.layoutVertexArray.length;W++){const Q=new St(this.layoutVertexArray.int16[6*W]>>1,this.layoutVertexArray.int16[6*W+1]>>1),te=$.pointElevation(Q,L.elevation,.05);this.updateHeightRange(te),this.zOffsetVertexArray.emplaceBack(te,0,0)}else this.fillNonElevatedRoadSegment(k)}return!0}prepareElevatedLines(t,o,c){if(o.constantHeight!=null)return t;const d=[],m=1/De(c);for(const g of t)dZ(g,new xi(o,m),0,d);return d}fillNonElevatedRoadSegment(t){for(let o=t;o<this.layoutVertexArray.length;o++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(t){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,t),this.heightRange.max=Math.max(this.heightRange.max,t)):this.heightRange={min:t,max:t}}addLine(t,o,c,d,m,g,b,P,I){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0,this.lineClips=I?this.lineFeatureClips(o,I):this.lineClips;const O=d==="none";this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const L=P&&P.progress.min>0,k=P&&P.progress.max<1;if(this.lineClips){let Ve={min:this.lineClips.start,max:this.lineClips.end},at=1;if(P){const xt=this.lineClips.end-this.lineClips.start;Ve=(function(Ct,Wt,Rt){return{min:$n(Ct.min,Wt,Rt),max:$n(Ct.max,Wt,Rt)}})(P.progress,{min:0,max:1},Ve),xt>0&&(at=(Ve.max-Ve.min)/xt)}const Ze=+o.properties.mapbox_clip_feature_len,ft=+o.properties.mapbox_clip_seg_len;if(Number.isNaN(Ze)||Number.isNaN(ft)){for(let Ct=0;Ct<t.length-1;Ct++)this.totalDistance+=t[Ct].dist(t[Ct+1]);const xt=this.totalDistance/(Ve.max-Ve.min);this.totalFeatureLength=Number.isFinite(xt)?xt:0,this.lineClips.start=Ve.min,this.lineClips.end=Ve.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Ze,this.distance=ft*at,this.lineClips.start=Ve.min,this.lineClips.end=Ve.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const $=KZ[o.type]==="Polygon";let W=t.length;for(;W>=2&&t[W-1].equals(t[W-2]);)W--;let Q=0;for(;Q<W-1&&t[Q].equals(t[Q+1]);)Q++;if(W<($?3:2))return;d==="bevel"&&(g=1.05);const te=this.segments.prepareSegment(10*W,this.layoutVertexArray,this.indexArray);let ne,ue,he,me,Ae,Pe,Fe,Be;P&&P.prevDir&&(Pe=P.prevDir.perp()),P&&P.nextDir&&(Fe=P.nextDir.perp()),this.e1=this.e2=-1,$&&(ne=t[W-2],Ae=t[Q].sub(ne)._unit()._perp());for(let Ve=Q;Ve<W;Ve++){if(he=Ve===W-1?$?t[Q+1]:void 0:t[Ve+1],he&&t[Ve].equals(he))continue;Ae&&(me=Ae),ne&&(ue=ne),ne=t[Ve],Be=this.evaluateLineProgressFeatures(ue?ue.dist(ne):0),Ae=he?he.sub(ne)._unit()._perp():me,me=me||Ae;const at=ue&&he;let Ze=at?d:$||O?"butt":m;const ft=me.x*Ae.x+me.y*Ae.y;if(O){const it=function(At){if(At.patternJoinNone){const jt=At.segmentPoints.length/2,It=At.lineSoFar-At.segmentStart;for(let dr=0;dr<jt;++dr){const _r=At.segmentPoints[2*dr+1],ir=Math.round(At.segmentPoints[2*dr])+.5+.25*_r;At.patternVertexArray.emplaceBack(ir,It,At.segmentStart),At.patternVertexArray.emplaceBack(ir,It,At.segmentStart)}At.segmentPoints.length=0}At.e1=At.e2=-1};if(at&&ft<JZ){this.updateDistance(ue,ne),this.addCurrentVertex(ne,me,1,1,te,Be),it(this),this.addCurrentVertex(ne,Ae,-1,-1,te,Be);continue}if(ue){if(!he){this.updateDistance(ue,ne),this.addCurrentVertex(ne,me,1,1,te,Be),it(this);continue}Ze="miter"}}let xt=me.add(Ae);xt.x===0&&xt.y===0||xt._unit();const Ct=xt.x*Ae.x+xt.y*Ae.y,Wt=Ct!==0?1/Ct:1/0,Rt=2*Math.sqrt(2-2*Ct),wt=Ct<QZ&&ue&&he,Dt=me.x*Ae.y-me.y*Ae.x>0,ot=this.overscaling<=16?15*Ut/(512*this.overscaling):0;if(at&&Ze==="round"){if(Wt<b)Ze="miter";else if(Wt<=2){const it=fT(ne,-10,Ut+10);Ze=this.elevationType==="offset"&&(it||this.hasCrossSlope)?"miter":"fakeround"}}if(Ze==="miter"&&Wt>g&&(Ze="bevel"),Ze==="bevel"&&(Wt>2&&(Ze="flipbevel"),Wt<g&&(Ze="miter")),ue&&!(Ze==="miter"&&wt)&&this.updateDistance(ue,ne),Ze==="miter")if(wt){const it=ne.dist(ue);if(it>2*ot){const jt=ne.sub(ne.sub(ue)._mult(ot/it)._round());this.updateDistance(ue,jt),this.addCurrentVertex(jt,me,0,0,te,Be),ue=jt}this.updateDistance(ue,ne),xt._mult(Wt),this.addCurrentVertex(ne,xt,0,0,te,Be);const At=ne.dist(he);if(At>2*ot){const jt=ne.add(he.sub(ne)._mult(ot/At)._round());this.updateDistance(ne,jt),this.addCurrentVertex(jt,Ae,0,0,te,Be),ne=jt}}else xt._mult(Wt),this.addCurrentVertex(ne,xt,0,0,te,Be);else if(Ze==="flipbevel"){if(Wt>100)xt=Ae.mult(-1);else{const it=Wt*me.add(Ae).mag()/me.sub(Ae).mag();xt._perp()._mult(it*(Dt?-1:1))}this.addCurrentVertex(ne,xt,0,0,te,Be),this.addCurrentVertex(ne,xt.mult(-1),0,0,te,Be)}else if(Ze==="bevel"||Ze==="fakeround"){Be!=null&&ue&&this.addCurrentVertex(ne,Fe||me,-1,-1,te,Be);const it=ne.dist(ue)<=2*ot&&Ze!=="bevel",At=xt.mult(Dt?1:-1);At._mult(Wt);const jt=Ae.mult(Dt?-1:1),It=me.mult(Dt?-1:1),dr=this.evaluateLineProgressFeatures(this.distance);if(Be==null&&(this.addHalfVertex(ne,At.x,At.y,!1,!Dt,0,te,dr),it||this.addHalfVertex(ne,At.x+2*It.x,At.y+2*It.y,!1,Dt,0,te,dr)),Ze==="fakeround"){const _r=Math.round(180*Rt/Math.PI/20);this.addHalfVertex(ne,It.x,It.y,!1,Dt,0,te,dr);for(let ir=0;ir<_r;ir++){let Jt=ir/_r;if(Jt!==.5){const rr=Jt-.5;Jt+=Jt*rr*(Jt-1)*((1.0904+ft*(ft*(3.55645-1.43519*ft)-3.2452))*rr*rr+(.848013+ft*(.215638*ft-1.06021)))}const Hr=jt.sub(It)._mult(Jt)._add(It)._unit();this.addHalfVertex(ne,Hr.x,Hr.y,!1,Dt,0,te,dr)}this.addHalfVertex(ne,jt.x,jt.y,!1,Dt,0,te,dr)}it||Be!=null||this.addHalfVertex(ne,At.x+2*jt.x,At.y+2*jt.y,!1,Dt,0,te,dr),Be!=null&&he&&this.addCurrentVertex(ne,Pe||Ae,1,1,te,Be)}else if(Ze==="butt")this.addCurrentVertex(ne,xt,0,0,te,Be);else if(Ze==="square"){if(!ue){const it=L?0:-1;this.addCurrentVertex(ne,xt,it,it,te,Be)}if(this.addCurrentVertex(ne,xt,0,0,te,Be),ue){const it=k?0:1;this.addCurrentVertex(ne,xt,it,it,te,Be)}}else if(Ze==="round"){if(ue){const it=!at&&Fe?Fe:me;this.addCurrentVertex(ne,it,0,0,te,Be),!at&&k||this.addCurrentVertex(ne,it,1,1,te,Be,!0)}if(he){const it=!at&&Pe?Pe:Ae;!at&&L||this.addCurrentVertex(ne,it,-1,-1,te,Be,!0),this.addCurrentVertex(ne,it,0,0,te,Be)}}}}addVerticesTo(t,o,c,d,m,g,b,P,I,O){const L=(o.w-t.w)/this.tessellationStep|0;let k=0;const $=this.scaledDistance;if(L>1){this.lineSoFar=t.w;const Q=(o.x-t.x)/L,te=(o.y-t.y)/L,ne=(o.z-t.z)/L,ue=(o.w-t.w)/L;for(let he=1;he<L;++he){t.x+=Q,t.y+=te,t.z+=ne,this.lineSoFar+=ue,k+=ue;const me=this.evaluateLineProgressFeatures(this.prevDistance+k);this.scaledDistance=(this.prevDistance+k)/this.totalDistance,this.addHalfVertex(t,c,d,O,!1,b,I,me),this.addHalfVertex(t,m,g,O,!0,-P,I,me)}}this.lineSoFar=o.w,this.scaledDistance=$;const W=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,c,d,O,!1,b,I,W),this.addHalfVertex(o,m,g,O,!0,-P,I,W)}evaluateLineProgressFeatures(t){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+t)/this.totalFeatureLength):Cr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:o}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}}addCurrentVertex(t,o,c,d,m,g,b=!1){const P=o.x+o.y*c,I=o.y-o.x*c,O=o.y*d-o.x,L=-o.y-o.x*d;if(g!=null){const k=this.elevationType==="offset",$=-10,W=Ut+10,Q=g.zOffset,te=new YL(t.x,t.y,Q,this.lineSoFar),ne=!!k&&fT(t,$,W),ue=this.lineSoFar,he=this.distance;if(this.currentVertex)if(ne){const me=this.currentVertexIsOutside,Ae=this.currentVertex,Pe=new YL(t.x,t.y,Q,this.lineSoFar);if(XL(Ae,Pe,$,W),!fT(Pe,$,W)){if(me){this.e1=this.e2=-1,this.distance-=Ae.dist(te),this.lineSoFar=Ae.w;const Fe=this.evaluateLineProgressFeatures(Ae.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ae,P,I,b,!1,c,m,Fe),this.addHalfVertex(Ae,O,L,b,!0,-d,m,Fe),this.prevDistance=this.distance}this.distance=this.prevDistance+Ae.dist(Pe),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Ae,Pe,P,I,O,L,c,d,m,b),this.distance=he,this.scaledDistance=this.distance/this.totalDistance}}else{const me=this.currentVertex;if(this.currentVertexIsOutside){XL(me,te,$,W),this.e1=this.e2=-1,this.distance-=me.dist(te),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=me.w;const Ae=this.evaluateLineProgressFeatures(me.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(me,P,I,b,!1,c,m,Ae),this.addHalfVertex(me,O,L,b,!0,-d,m,Ae),this.prevDistance=this.distance,this.distance=he,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(me,te,P,I,O,L,c,d,m,b)}else ne||(this.addHalfVertex(t,P,I,b,!1,c,m,g),this.addHalfVertex(t,O,L,b,!0,-d,m,g));this.currentVertex=te,this.currentVertexIsOutside=ne,this.lineSoFar=ue}else this.addHalfVertex(t,P,I,b,!1,c,m,g),this.addHalfVertex(t,O,L,b,!0,-d,m,g)}addHalfVertex({x:t,y:o},c,d,m,g,b,P,I){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),g||this.segmentPoints.push(this.lineSoFar-this.segmentStart,b)),this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(o<<1)+(g?1:0),Math.round(63*c)+128,Math.round(63*d)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const L=Lr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,L)}const O=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,O),P.primitiveLength++),g?this.e2=O:this.e1=O,I!=null&&this.zOffsetVertexArray.emplaceBack(I.zOffset,I.variableWidth,I.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(t,o){this.prevDistance=this.distance,this.distance+=t.dist(o),this.updateScaledDistance()}}function fT(s,t,o){return s.x<t||s.x>o||s.y<t||s.y>o}let Mz,Cz;function Az(s,t,o){return t*(Ut/(s.tileSize*Math.pow(2,o-s.tileID.overscaledZ)))}cr(hT,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Dz=(s,t,o)=>(1-o)*s+o*t;function Rz(s,t){return 1/Az(s,1,t.tileZoom)}function Oz(s,t,o,c){return s.translatePosMatrix(c||t.tileID.projMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const Lz=s=>{const t=[];zz(s)&&t.push("RENDER_LINE_DASH"),s.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const o=s.paint.get("line-trim-offset");o[0]===0&&o[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),s.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER");const c=s.layout.get("line-join").constantOr("miter")==="none",d=!!s.paint.get("line-pattern").constantOr(1);return c&&d&&t.push("LINE_JOIN_NONE"),t};function zz(s){const t=s.paint.get("line-dasharray").value;return t.kind!=="constant"||t.value}let pT;const Fz=()=>pT||(pT={layout:Mz||(Mz=new to({"line-cap":new tr(Ye.layout_line["line-cap"]),"line-join":new tr(Ye.layout_line["line-join"]),"line-miter-limit":new zt(Ye.layout_line["line-miter-limit"]),"line-round-limit":new zt(Ye.layout_line["line-round-limit"]),"line-sort-key":new tr(Ye.layout_line["line-sort-key"]),"line-z-offset":new tr(Ye.layout_line["line-z-offset"]),"line-elevation-reference":new zt(Ye.layout_line["line-elevation-reference"]),"line-cross-slope":new zt(Ye.layout_line["line-cross-slope"]),visibility:new zt(Ye.layout_line.visibility),"line-width-unit":new zt(Ye.layout_line["line-width-unit"])})),paint:Cz||(Cz=new to({"line-opacity":new tr(Ye.paint_line["line-opacity"]),"line-color":new tr(Ye.paint_line["line-color"]),"line-translate":new zt(Ye.paint_line["line-translate"]),"line-translate-anchor":new zt(Ye.paint_line["line-translate-anchor"]),"line-width":new tr(Ye.paint_line["line-width"]),"line-gap-width":new tr(Ye.paint_line["line-gap-width"]),"line-offset":new tr(Ye.paint_line["line-offset"]),"line-blur":new tr(Ye.paint_line["line-blur"]),"line-dasharray":new tr(Ye.paint_line["line-dasharray"]),"line-pattern":new tr(Ye.paint_line["line-pattern"]),"line-pattern-cross-fade":new zt(Ye.paint_line["line-pattern-cross-fade"]),"line-gradient":new th(Ye.paint_line["line-gradient"]),"line-trim-offset":new zt(Ye.paint_line["line-trim-offset"]),"line-trim-fade-range":new zt(Ye.paint_line["line-trim-fade-range"]),"line-trim-color":new zt(Ye.paint_line["line-trim-color"]),"line-emissive-strength":new zt(Ye.paint_line["line-emissive-strength"]),"line-border-width":new tr(Ye.paint_line["line-border-width"]),"line-border-color":new tr(Ye.paint_line["line-border-color"]),"line-occlusion-opacity":new zt(Ye.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},pT);class eX extends tr{possiblyEvaluate(t,o){return o=new mi(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition,worldview:o.worldview}),super.possiblyEvaluate(t,o)}evaluate(t,o,c,d){return o=Object.assign({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,c,d)}}let Pv;function kz(s,t){return t>0?t+2*s:s}const tX=pn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rX=pn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),nX=pn([{name:"a_projected_pos",components:4,type:"Float32"}],4);pn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const iX=pn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),oX=pn([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),sX=pn([{name:"a_texb",components:2,type:"Uint16"}]),aX=pn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),lX=pn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);pn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Bz=pn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cX=pn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);pn([{name:"triangle",components:3,type:"Uint16"}]),pn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),pn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),pn([{type:"Float32",name:"offsetX"}]),pn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var pa=24;function uX(s,t,o){return s.sections.forEach((c=>{c.text=(function(d,m,g){const b=m.layout.get("text-transform").evaluate(g,{});return b==="uppercase"?d=d.toLocaleUpperCase():b==="lowercase"&&(d=d.toLocaleLowerCase()),da.applyArabicShaping&&(d=da.applyArabicShaping(d)),d})(c.text,t,o)})),s}const Iv={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function dX(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}function hX(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}const mT=4294967296,jz=1/mT,Nz=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let ob=class{constructor(s=new Uint8Array(16)){this.buf=ArrayBuffer.isView(s)?s:new Uint8Array(s),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(s,t,o=this.length){for(;this.pos<o;){const c=this.readVarint(),d=c>>3,m=this.pos;this.type=7&c,s(d,t,this),this.pos===m&&this.skip(c)}return t}readMessage(s,t){return this.readFields(s,t,this.readVarint()+this.pos)}readFixed32(){const s=this.dataView.getUint32(this.pos,!0);return this.pos+=4,s}readSFixed32(){const s=this.dataView.getInt32(this.pos,!0);return this.pos+=4,s}readFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*mT;return this.pos+=8,s}readSFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*mT;return this.pos+=8,s}readFloat(){const s=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,s}readDouble(){const s=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,s}readVarint(s){const t=this.buf;let o,c;return c=t[this.pos++],o=127&c,c<128?o:(c=t[this.pos++],o|=(127&c)<<7,c<128?o:(c=t[this.pos++],o|=(127&c)<<14,c<128?o:(c=t[this.pos++],o|=(127&c)<<21,c<128?o:(c=t[this.pos],o|=(15&c)<<28,(function(d,m,g){const b=g.buf;let P,I;if(I=b[g.pos++],P=(112&I)>>4,I<128||(I=b[g.pos++],P|=(127&I)<<3,I<128)||(I=b[g.pos++],P|=(127&I)<<10,I<128)||(I=b[g.pos++],P|=(127&I)<<17,I<128)||(I=b[g.pos++],P|=(127&I)<<24,I<128)||(I=b[g.pos++],P|=(1&I)<<31,I<128))return B_(d,P,m);throw new Error("Expected varint not more than 10 bytes")})(o,s,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const s=this.readVarint();return s%2==1?(s+1)/-2:s/2}readBoolean(){return!!this.readVarint()}readString(){const s=this.readVarint()+this.pos,t=this.pos;return this.pos=s,s-t>=12&&Nz?Nz.decode(this.buf.subarray(t,s)):(function(o,c,d){let m="",g=c;for(;g<d;){const b=o[g];let P,I,O,L=null,k=b>239?4:b>223?3:b>191?2:1;if(g+k>d)break;k===1?b<128&&(L=b):k===2?(P=o[g+1],(192&P)==128&&(L=(31&b)<<6|63&P,L<=127&&(L=null))):k===3?(P=o[g+1],I=o[g+2],(192&P)==128&&(192&I)==128&&(L=(15&b)<<12|(63&P)<<6|63&I,(L<=2047||L>=55296&&L<=57343)&&(L=null))):k===4&&(P=o[g+1],I=o[g+2],O=o[g+3],(192&P)==128&&(192&I)==128&&(192&O)==128&&(L=(15&b)<<18|(63&P)<<12|(63&I)<<6|63&O,(L<=65535||L>=1114112)&&(L=null))),L===null?(L=65533,k=1):L>65535&&(L-=65536,m+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),m+=String.fromCharCode(L),g+=k}return m})(this.buf,t,s)}readBytes(){const s=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,s);return this.pos=s,t}readPackedVarint(s=[],t){const o=this.readPackedEnd();for(;this.pos<o;)s.push(this.readVarint(t));return s}readPackedSVarint(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readSVarint());return s}readPackedBoolean(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readBoolean());return s}readPackedFloat(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readFloat());return s}readPackedDouble(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readDouble());return s}readPackedFixed32(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readFixed32());return s}readPackedSFixed32(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readSFixed32());return s}readPackedFixed64(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readFixed64());return s}readPackedSFixed64(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readSFixed64());return s}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(s){const t=7&s;if(t===0)for(;this.buf[this.pos++]>127;);else if(t===2)this.pos=this.readVarint()+this.pos;else if(t===5)this.pos+=4;else{if(t!==1)throw new Error(`Unimplemented type: ${t}`);this.pos+=8}}writeTag(s,t){this.writeVarint(s<<3|t)}realloc(s){let t=this.length||16;for(;t<this.pos+s;)t*=2;if(t!==this.length){const o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.dataView=new DataView(o.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeSFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*jz),!0),this.pos+=8}writeSFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*jz),!0),this.pos+=8}writeVarint(s){(s=+s||0)>268435455||s<0?(function(t,o){let c,d;if(t>=0?(c=t%4294967296|0,d=t/4294967296|0):(c=~(-t%4294967296),d=~(-t/4294967296),4294967295^c?c=c+1|0:(c=0,d=d+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),(function(m,g,b){b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,b.buf[b.pos]=127&(m>>>=7)})(c,0,o),(function(m,g){const b=(7&m)<<4;g.buf[g.pos++]|=b|((m>>>=3)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m)))))})(d,o)})(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))}writeSVarint(s){this.writeVarint(s<0?2*-s-1:2*s)}writeBoolean(s){this.writeVarint(+s)}writeString(s){s=String(s),this.realloc(4*s.length),this.pos++;const t=this.pos;this.pos=(function(c,d,m){for(let g,b,P=0;P<d.length;P++){if(g=d.charCodeAt(P),g>55295&&g<57344){if(!b){g>56319||P+1===d.length?(c[m++]=239,c[m++]=191,c[m++]=189):b=g;continue}if(g<56320){c[m++]=239,c[m++]=191,c[m++]=189,b=g;continue}g=b-55296<<10|g-56320|65536,b=null}else b&&(c[m++]=239,c[m++]=191,c[m++]=189,b=null);g<128?c[m++]=g:(g<2048?c[m++]=g>>6|192:(g<65536?c[m++]=g>>12|224:(c[m++]=g>>18|240,c[m++]=g>>12&63|128),c[m++]=g>>6&63|128),c[m++]=63&g|128)}return m})(this.buf,s,this.pos);const o=this.pos-t;o>=128&&Vz(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o}writeFloat(s){this.realloc(4),this.dataView.setFloat32(this.pos,s,!0),this.pos+=4}writeDouble(s){this.realloc(8),this.dataView.setFloat64(this.pos,s,!0),this.pos+=8}writeBytes(s){const t=s.length;this.writeVarint(t),this.realloc(t);for(let o=0;o<t;o++)this.buf[this.pos++]=s[o]}writeRawMessage(s,t){this.pos++;const o=this.pos;s(t,this);const c=this.pos-o;c>=128&&Vz(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c}writeMessage(s,t,o){this.writeTag(s,2),this.writeRawMessage(t,o)}writePackedVarint(s,t){t.length&&this.writeMessage(s,fX,t)}writePackedSVarint(s,t){t.length&&this.writeMessage(s,pX,t)}writePackedBoolean(s,t){t.length&&this.writeMessage(s,_X,t)}writePackedFloat(s,t){t.length&&this.writeMessage(s,mX,t)}writePackedDouble(s,t){t.length&&this.writeMessage(s,gX,t)}writePackedFixed32(s,t){t.length&&this.writeMessage(s,yX,t)}writePackedSFixed32(s,t){t.length&&this.writeMessage(s,vX,t)}writePackedFixed64(s,t){t.length&&this.writeMessage(s,xX,t)}writePackedSFixed64(s,t){t.length&&this.writeMessage(s,bX,t)}writeBytesField(s,t){this.writeTag(s,2),this.writeBytes(t)}writeFixed32Field(s,t){this.writeTag(s,5),this.writeFixed32(t)}writeSFixed32Field(s,t){this.writeTag(s,5),this.writeSFixed32(t)}writeFixed64Field(s,t){this.writeTag(s,1),this.writeFixed64(t)}writeSFixed64Field(s,t){this.writeTag(s,1),this.writeSFixed64(t)}writeVarintField(s,t){this.writeTag(s,0),this.writeVarint(t)}writeSVarintField(s,t){this.writeTag(s,0),this.writeSVarint(t)}writeStringField(s,t){this.writeTag(s,2),this.writeString(t)}writeFloatField(s,t){this.writeTag(s,5),this.writeFloat(t)}writeDoubleField(s,t){this.writeTag(s,1),this.writeDouble(t)}writeBooleanField(s,t){this.writeVarintField(s,+t)}};function B_(s,t,o){return o?4294967296*t+(s>>>0):4294967296*(t>>>0)+(s>>>0)}function Vz(s,t,o){const c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(c);for(let d=o.pos-1;d>=s;d--)o.buf[d+c]=o.buf[d]}function fX(s,t){for(let o=0;o<s.length;o++)t.writeVarint(s[o])}function pX(s,t){for(let o=0;o<s.length;o++)t.writeSVarint(s[o])}function mX(s,t){for(let o=0;o<s.length;o++)t.writeFloat(s[o])}function gX(s,t){for(let o=0;o<s.length;o++)t.writeDouble(s[o])}function _X(s,t){for(let o=0;o<s.length;o++)t.writeBoolean(s[o])}function yX(s,t){for(let o=0;o<s.length;o++)t.writeFixed32(s[o])}function vX(s,t){for(let o=0;o<s.length;o++)t.writeSFixed32(s[o])}function xX(s,t){for(let o=0;o<s.length;o++)t.writeFixed64(s[o])}function bX(s,t){for(let o=0;o<s.length;o++)t.writeSFixed64(s[o])}const gT=3;function wX(s,t,o){t.glyphs=[],s===1&&o.readMessage(SX,t)}function SX(s,t,o){if(s===3){const{id:c,bitmap:d,width:m,height:g,left:b,top:P,advance:I}=o.readMessage(TX,{});t.glyphs.push({id:c,bitmap:new wm({width:m+2*gT,height:g+2*gT},d),metrics:{width:m,height:g,left:b,top:P,advance:I}})}else s===4?t.ascender=o.readSVarint():s===5&&(t.descender=o.readSVarint())}function TX(s,t,o){s===1?t.id=o.readVarint():s===2?t.bitmap=o.readBytes():s===3?t.width=o.readVarint():s===4?t.height=o.readVarint():s===5?t.left=o.readSVarint():s===6?t.top=o.readSVarint():s===7&&(t.advance=o.readVarint())}const Uz=gT,Hc={horizontal:1,vertical:2,horizontalOnly:3};class Mv{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(t,o){const c=new Mv;return c.scale=t||1,c.fontStack=o,c}static forImage(t){const o=new Mv;return o.image=t,o}}class j_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o,c){const d=new j_;for(let m=0;m<t.sections.length;m++){const g=t.sections[m];g.image?d.addImageSection(g,c):d.addTextSection(g,o)}return d}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=(function(o,c){let d="";for(let m=0;m<o.length;m++){const g=o.charCodeAt(m+1)||null,b=o.charCodeAt(m-1)||null;d+=!c&&(g&&yd(g)&&!Iv[o[m+1]]||b&&yd(b)&&!Iv[o[m-1]])||!Iv[o[m]]?o[m]:Iv[o[m]]}return d})(this.text,t)}trim(){let t=0;for(let c=0;c<this.text.length&&sb[this.text.charCodeAt(c)];c++)t++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&sb[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const c=new j_;return c.text=this.text.substring(t,o),c.sectionIndex=this.sectionIndex.slice(t,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,o)=>Math.max(t,this.sections[o].scale)),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(Mv.forText(t.scale,t.fontStack||o));const c=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(c)}addImageSection(t,o){const c=t.image?t.image.getPrimary():null;if(!c)return void Cr("Can't add FormattedSection with an empty image.");c.scaleSelf(o);const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCodePoint(d),this.sections.push(Mv.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Cr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _T(s,t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q=1){const te=j_.fromFeature(s,d,Q);L===Hc.vertical&&te.verticalizePunctuation(k);let ne=[];const ue=(function(Fe,Be,Ve,at,Ze,ft){if(!Fe)return[];const xt=[],Ct=(function(Dt,ot,it,At,jt,It){let dr=0;for(let _r=0;_r<Dt.length();_r++){const ir=Dt.getSection(_r);dr+=$z(Dt.getCodePoint(_r),ir,At,jt,ot,It)}return dr/Math.max(1,Math.ceil(dr/it))})(Fe,Be,Ve,at,Ze,ft),Wt=Fe.text.indexOf("")>=0;let Rt=0;for(let Dt=0;Dt<Fe.length();Dt++){const ot=Fe.getSection(Dt),it=Fe.getCodePoint(Dt);if(sb[it]||(Rt+=$z(it,ot,at,Ze,Be,ft)),Dt<Fe.length()-1){const At=!((wt=it)<11904||!(Mr["Bopomofo Extended"](wt)||Mr.Bopomofo(wt)||Mr["CJK Compatibility Forms"](wt)||Mr["CJK Compatibility Ideographs"](wt)||Mr["CJK Compatibility"](wt)||Mr["CJK Radicals Supplement"](wt)||Mr["CJK Strokes"](wt)||Mr["CJK Symbols and Punctuation"](wt)||Mr["CJK Unified Ideographs Extension A"](wt)||Mr["CJK Unified Ideographs"](wt)||Mr["Enclosed CJK Letters and Months"](wt)||Mr["Halfwidth and Fullwidth Forms"](wt)||Mr.Hiragana(wt)||Mr["Ideographic Description Characters"](wt)||Mr["Kangxi Radicals"](wt)||Mr["Katakana Phonetic Extensions"](wt)||Mr.Katakana(wt)||Mr["Vertical Forms"](wt)||Mr["Yi Radicals"](wt)||Mr["Yi Syllables"](wt)));(EX[it]||At||ot.image)&&xt.push(qz(Dt+1,Rt,Ct,xt,PX(it,Fe.getCodePoint(Dt+1),At&&Wt),!1))}}var wt;return Gz(qz(Fe.length(),Rt,Ct,xt,0,!0))})(te,I,m,t,c,$),{processBidirectionalText:he,processStyledBidirectionalText:me}=da;if(he&&te.sections.length===1){const Fe=he(te.toString(),ue);for(const Be of Fe){const Ve=new j_;Ve.text=Be,Ve.sections=te.sections;for(let at=0;at<Be.length;at++)Ve.sectionIndex.push(0);ne.push(Ve)}}else if(me){const Fe=me(te.text,te.sectionIndex,ue);for(const Be of Fe){const Ve=new j_;Ve.text=Be[0],Ve.sectionIndex=Be[1],Ve.sections=te.sections,ne.push(Ve)}}else ne=(function(Fe,Be){const Ve=[],at=Fe.text;let Ze=0;for(const ft of Be)Ve.push(Fe.substring(Ze,ft)),Ze=ft;return Ze<at.length&&Ve.push(Fe.substring(Ze,at.length)),Ve})(te,ue);const Ae=[],Pe={positionedLines:Ae,text:te.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:L,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if((function(Fe,Be,Ve,at,Ze,ft,xt,Ct,Wt,Rt,wt,Dt){let ot=0,it=0,At=0;const jt=Ct==="right"?1:Ct==="left"?0:.5;let It=!1;for(const rr of Ze){const Rr=rr.getSections();for(const Qr of Rr){if(Qr.image)continue;const gn=Be[Qr.fontStack];if(gn&&(It=gn.ascender!==void 0&&gn.descender!==void 0,!It))break}if(!It)break}let dr=0;for(const rr of Ze){rr.trim();const Rr=rr.getMaxScale(),Qr=(Rr-1)*pa,gn={positionedGlyphs:[],lineOffset:0};Fe.positionedLines[dr]=gn;const kn=gn.positionedGlyphs;let tn=0;if(!rr.length()){it+=ft,++dr;continue}let Kn=0,Qn=0;for(let Ie=0;Ie<rr.length();Ie++){const Se=rr.getSection(Ie),mt=rr.getSectionIndex(Ie),Zt=rr.getCodePoint(Ie);let gt=Se.scale,er=null,Tr=null,wr=null,ln=pa,Ur=0,vr=Wt;vr===Hc.vertical&&((_r=Zt)===12312||_r===12313||_r===12316||_r===12540||_r===12448)&&(vr=Hc.horizontal);const Hn=!(vr===Hc.horizontal||!wt&&!ef(Zt)||wt&&(sb[Zt]||tm(Zt)));if(Se.image){const bi=at.get(Se.image.toString());if(!bi)continue;wr=Se.image,Fe.iconsInText=Fe.iconsInText||!0,Tr=bi.paddedRect;const Gr=bi.displaySize;gt=gt*pa/Dt,er={width:Gr[0],height:Gr[1],left:0,top:-Uz,advance:Hn?Gr[1]:Gr[0],localGlyph:!1},Ur=It?-er.height*gt:Rr*pa-17-Gr[1]*gt,ln=er.advance;const On=(Hn?Gr[0]:Gr[1])*gt-pa*Rr;On>0&&On>tn&&(tn=On)}else{const bi=Ve[Se.fontStack];if(!bi)continue;bi[Zt]&&(Tr=bi[Zt]);const Gr=Be[Se.fontStack];if(!Gr)continue;const On=Gr.glyphs[Zt];if(!On)continue;if(er=On.metrics,ln=Zt!==8203?pa:0,It){const wi=Gr.ascender!==void 0?Math.abs(Gr.ascender):0,ci=Gr.descender!==void 0?Math.abs(Gr.descender):0,po=(wi+ci)*gt;Kn<po&&(Kn=po,Qn=(wi-ci)/2*gt),Ur=-wi*gt}else Ur=(Rr-gt)*pa-17}Hn?(Fe.verticalizable=!0,kn.push({glyph:Zt,image:wr,x:ot,y:it+Ur,vertical:Hn,scale:gt,localGlyph:er.localGlyph,fontStack:Se.fontStack,sectionIndex:mt,metrics:er,rect:Tr}),ot+=ln*gt+Rt):(kn.push({glyph:Zt,image:wr,x:ot,y:it+Ur,vertical:Hn,scale:gt,localGlyph:er.localGlyph,fontStack:Se.fontStack,sectionIndex:mt,metrics:er,rect:Tr}),ot+=er.advance*gt+Rt)}kn.length!==0&&(At=Math.max(ot-Rt,At),It?Hz(kn,jt,tn,Qn,ft*Rr/2):Hz(kn,jt,tn,0,ft/2)),ot=0;const no=ft*Rr+tn;gn.lineOffset=Math.max(tn,Qr),it+=no,++dr}var _r;const ir=it,{horizontalAlign:Jt,verticalAlign:Hr}=yT(xt);(function(rr,Rr,Qr,gn,kn,tn){const Kn=(Rr-Qr)*kn,Qn=-tn*gn;for(const no of rr)for(const Ie of no.positionedGlyphs)Ie.x+=Kn,Ie.y+=Qn})(Fe.positionedLines,jt,Jt,Hr,At,ir),Fe.top+=-Hr*ir,Fe.bottom=Fe.top+ir,Fe.left+=-Jt*At,Fe.right=Fe.left+At,Fe.hasBaseline=It})(Pe,t,o,c,ne,g,b,P,L,I,k,W),!(function(Fe){for(const Be of Fe)if(Be.positionedGlyphs.length!==0)return!1;return!0})(Ae))return Pe}const sb={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},EX={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function $z(s,t,o,c,d,m){if(t.image){const g=c.get(t.image.toString());return g?g.displaySize[0]*t.scale*pa/m+d:0}{const g=o[t.fontStack],b=g&&g.glyphs[s];return b?b.metrics.advance*t.scale+d:0}}function Wz(s,t,o,c){const d=Math.pow(s-t,2);return c?s<t?d/2:2*d:d+Math.abs(o)*o}function PX(s,t,o){let c=0;return s===10&&(c-=1e4),o&&(c+=150),s!==40&&s!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function qz(s,t,o,c,d,m){let g=null,b=Wz(t,o,d,m);for(const P of c){const I=Wz(t-P.x,o,d,m)+P.badness;I<=b&&(g=P,b=I)}return{index:s,x:t,priorBreak:g,badness:b}}function Gz(s){return s?Gz(s.priorBreak).concat(s.index):[]}function yT(s){let t=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function Hz(s,t,o,c,d){if(!(t||o||c||d))return;const m=s.length-1,g=s[m],b=(g.x+g.metrics.advance*g.scale)*t;for(let P=0;P<=m;P++)s[P].x-=b,s[P].y+=o+c+d}function Yz(s){return s.imagePrimary!==void 0&&s.top!==void 0&&s.bottom!==void 0&&s.left!==void 0&&s.right!==void 0}function ab(s,t,o,c){const{horizontalAlign:d,verticalAlign:m}=yT(c),g=o[0]-s.displaySize[0]*d,b=o[1]-s.displaySize[1]*m;return{imagePrimary:s,imageSecondary:t,top:b,bottom:b+s.displaySize[1],left:g,right:g+s.displaySize[0]}}function vT(s,t,o,c,d,m){const g=s.imagePrimary;let b;if(g.content){const te=g.content,ne=g.pixelRatio||1;b=[te[0]/ne,te[1]/ne,g.displaySize[0]-te[2]/ne,g.displaySize[1]-te[3]/ne]}const P=t.left*m,I=t.right*m;let O,L,k,$;o==="width"||o==="both"?($=d[0]+P-c[3],L=d[0]+I+c[1]):($=d[0]+(P+I-g.displaySize[0])/2,L=$+g.displaySize[0]);const W=t.top*m,Q=t.bottom*m;return o==="height"||o==="both"?(O=d[1]+W-c[0],k=d[1]+Q+c[2]):(O=d[1]+(W+Q-g.displaySize[1])/2,k=O+g.displaySize[1]),{imagePrimary:g,imageSecondary:void 0,top:O,right:L,bottom:k,left:$,collisionPadding:b}}function Zz(s){return!s.imagePrimary.stretchX}function Xz(s){return!s.imagePrimary.stretchY}function Kz(s){return{width:s.right-s.left,height:s.bottom-s.top}}const gh=128;function N_(s,t,o){const{expression:c}=t;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new mi(s+1,{worldview:o}))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:m}=c;let g=0;for(;g<d.length&&d[g]<=s;)g++;g=Math.max(0,g-1);let b=g;for(;b<d.length&&d[b]<s+1;)b++;b=Math.min(d.length-1,b);const P=d[g],I=d[b];return c.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:I,interpolationType:m}:{kind:"camera",minZoom:P,maxZoom:I,minSize:c.evaluate(new mi(P,{worldview:o})),maxSize:c.evaluate(new mi(I,{worldview:o})),interpolationType:m}}}function xT(s,{uSize:t,uSizeT:o},{lowerSize:c,upperSize:d}){return s.kind==="source"?c/gh:s.kind==="composite"?Lr(c/gh,d/gh,o):t}function V_(s,t,o=1){let c=0,d=0;if(s.kind==="constant")d=s.layoutSize*o;else if(s.kind!=="source"){const{interpolationType:m,minZoom:g,maxZoom:b}=s,P=m?le(yl.interpolationFactor(m,t,g,b),0,1):0;s.kind==="camera"?d=Lr(s.minSize,s.maxSize,P)*o:c=P*o}return{uSizeT:c,uSize:d}}class xp extends St{constructor(t,o,c,d,m){super(t,o),this.angle=d,this.z=c,m!==void 0&&(this.segment=m)}clone(){return new xp(this.x,this.y,this.z,this.angle,this.segment)}}function Qz(s,t,o,c,d){if(t.segment===void 0)return!0;let m=t,g=t.segment+1,b=0;for(;b>-o/2;){if(g--,g<0)return!1;b-=s[g].dist(m),m=s[g]}b+=s[g].dist(s[g+1]),g++;const P=[];let I=0;for(;b<o/2;){const O=s[g],L=s[g+1];if(!L)return!1;let k=s[g-1].angleTo(O)-O.angleTo(L);for(k=Math.abs((k+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:b,angleDelta:k}),I+=k;b-P[0].distance>c;)I-=P.shift().angleDelta;if(I>d)return!1;g++,b+=O.dist(L)}return!0}function Jz(s){let t=0;for(let o=0;o<s.length-1;o++)t+=s[o].dist(s[o+1]);return t}function eF(s,t,o){return s?.6*t*o:0}function tF(s,t){return Math.max(s?s.right-s.left:0,t?t.right-t.left:0)}function IX(s,t,o,c,d,m){const g=eF(o,d,m),b=tF(o,c)*m;let P=0;const I=Jz(s)/2;for(let O=0;O<s.length-1;O++){const L=s[O],k=s[O+1],$=L.dist(k);if(P+$>I){const W=(I-P)/$,Q=Lr(L.x,k.x,W),te=Lr(L.y,k.y,W),ne=new xp(Q,te,0,k.angleTo(L),O);return!g||Qz(s,ne,b,g,t)?ne:void 0}P+=$}}function MX(s,t,o,c,d,m,g,b,P){const I=eF(c,m,g),O=tF(c,d),L=O*g,k=s[0].x===0||s[0].x===P||s[0].y===0||s[0].y===P;return t-L<t/4&&(t=L+t/4),rF(s,k?t/2*b%t:(O/2+2*m)*g*b%t,t,I,o,L,k,!1,P)}function rF(s,t,o,c,d,m,g,b,P){const I=m/2,O=Jz(s);let L=0,k=t-o,$=[];for(let W=0;W<s.length-1;W++){const Q=s[W],te=s[W+1],ne=Q.dist(te),ue=te.angleTo(Q);for(;k+o<L+ne;){k+=o;const he=(k-L)/ne,me=Lr(Q.x,te.x,he),Ae=Lr(Q.y,te.y,he);if(me>=0&&me<P&&Ae>=0&&Ae<P&&k-I>=0&&k+I<=O){const Pe=new xp(me,Ae,0,ue,W);c&&!Qz(s,Pe,m,c,d)||$.push(Pe)}}L+=ne}return b||$.length||g||($=rF(s,L/2,o,c,d,m,g,!0,P)),$}function nF(s){let t=0,o=0;for(const g of s)t+=g.w*g.h,o=Math.max(o,g.w);s.sort(((g,b)=>b.h-g.h));const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let d=0,m=0;for(const g of s)for(let b=c.length-1;b>=0;b--){const P=c[b];if(!(g.w>P.w||g.h>P.h)){if(g.x=P.x,g.y=P.y,m=Math.max(m,g.y+g.h),d=Math.max(d,g.x+g.w),g.w===P.w&&g.h===P.h){const I=c.pop();I&&b<c.length&&(c[b]=I)}else g.h===P.h?(P.x+=g.w,P.w-=g.w):g.w===P.w?(P.y+=g.h,P.h-=g.h):(c.push({x:P.x+g.w,y:P.y,w:P.w-g.w,h:g.h}),P.y+=g.h,P.h-=g.h);break}}return{w:d,h:m,fill:t/(d*m)||0}}cr(xp,"Anchor");const Cg=1;class Cv{static getImagePositionScale(t,o,c){if(o&&t&&t.options&&t.options.transform){const d=t.options.transform;return{x:d.a,y:d.d}}return{x:c,y:c}}constructor(t,o,c,d){this.paddedRect=t;const{pixelRatio:m,version:g,stretchX:b,stretchY:P,content:I,sdf:O,usvg:L}=o;this.pixelRatio=m,this.stretchX=b,this.stretchY=P,this.content=I,this.version=g,this.padding=c,this.sdf=O,this.usvg=L,this.scale=Cv.getImagePositionScale(d,L,m)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function bT(s,t,o){const c=zl.parse(s),d=(function(m,g,b=[1,1]){return{x:0,y:0,w:(m.data?m.data.width:m.width*b[0])+2*g,h:(m.data?m.data.height:m.height*b[1])+2*g}})(t,o,[c.options.transform.a,c.options.transform.d]);return{bin:d,imagePosition:new Cv(d,t,o,c),imageVariant:c}}class iF{constructor(t,o,c){const d=new Map,m=new Map;this.haveRenderCallbacks=[];const g=[];this.addImages(t,d,Cg,g),this.addImages(o,m,2,g);const{w:b,h:P}=nF(g),I=new qa({width:b||1,height:P||1});for(const[O,L]of t.entries()){const k=d.get(O).paddedRect;qa.copy(L.data,I,{x:0,y:0},{x:k.x+Cg,y:k.y+Cg},L.data,null,L.sdf)}for(const[O,L]of o.entries()){const k=m.get(O),$=k.paddedRect;let W=k.padding;const Q=$.x+W,te=$.y+W,ne=L.data.width,ue=L.data.height;W=W>1?W-1:W,qa.copy(L.data,I,{x:0,y:0},{x:Q,y:te},L.data,c),qa.copy(L.data,I,{x:0,y:ue-W},{x:Q,y:te-W},{width:ne,height:W},c),qa.copy(L.data,I,{x:0,y:0},{x:Q,y:te+ue},{width:ne,height:W},c),qa.copy(L.data,I,{x:ne-W,y:0},{x:Q-W,y:te},{width:W,height:ue},c),qa.copy(L.data,I,{x:0,y:0},{x:Q+ne,y:te},{width:W,height:ue},c),qa.copy(L.data,I,{x:ne-W,y:ue-W},{x:Q-W,y:te-W},{width:W,height:W},c),qa.copy(L.data,I,{x:0,y:ue-W},{x:Q+ne,y:te-W},{width:W,height:W},c),qa.copy(L.data,I,{x:0,y:0},{x:Q+ne,y:te+ue},{width:W,height:W},c),qa.copy(L.data,I,{x:ne-W,y:0},{x:Q-W,y:te+ue},{width:W,height:W},c)}this.lut=c,this.image=I,this.iconPositions=d,this.patternPositions=m}addImages(t,o,c,d){for(const[m,g]of t.entries()){const{bin:b,imagePosition:P,imageVariant:I}=bT(m,g,c);o.set(m,P),d.push(b),g.hasRenderCallback&&this.haveRenderCallbacks.push(I.id)}}patchUpdatedImages(t,o,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((d=>t.hasImage(d,c))),t.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const d of t.getUpdatedImages(c)){for(const m of this.iconPositions.keys()){const g=zl.parse(m);if(pi.isEqual(g.id,d)){const b=t.getImage(d,c);this.patchUpdatedImage(this.iconPositions.get(m),b,o,null)}}for(const m of this.patternPositions.keys()){const g=zl.parse(m);if(pi.isEqual(g.id,d)){const b=t.getImage(d,c);this.patchUpdatedImage(this.patternPositions.get(m),b,o,this.lut)}}}}patchUpdatedImage(t,o,c,d=null){if(!t||!o||t.version===o.version)return;t.version=o.version;const[m,g]=t.tl,b=t.sdf;if(this.lut||b){const P={width:o.data.width,height:o.data.height},I=new qa(P);qa.copy(o.data,I,{x:0,y:0},{x:0,y:0},P,d,b),c.update(I,{position:{x:m,y:g}})}else c.update(o.data,{position:{x:m,y:g}})}}cr(Cv,"ImagePosition"),cr(iF,"ImageAtlas");const Av=1e20;function oF(s,t,o,c,d,m,g,b,P){for(let I=t;I<t+c;I++)sF(s,o*m+I,m,d,g,b,P);for(let I=o;I<o+d;I++)sF(s,I*m+t,1,c,g,b,P)}function sF(s,t,o,c,d,m,g){m[0]=0,g[0]=-Av,g[1]=Av,d[0]=s[t];for(let b=1,P=0,I=0;b<c;b++){d[b]=s[t+b*o];const O=b*b;do{const L=m[P];I=(d[b]-d[L]+O-L*L)/(b-L)/2}while(I<=g[P]&&--P>-1);P++,m[P]=b,g[P]=I,g[P+1]=Av}for(let b=0,P=0;b<c;b++){for(;g[P+1]<b;)P++;const I=m[P],O=b-I;s[t+b*o]=d[I]+O*O}}const _h=2,wT={none:0,ideographs:1,all:2};class U_{constructor(t,o,c){this.requestManager=t,this.localGlyphMode=o,this.localFontFamily=c,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,o){const c=[],d=this.url||ii.GLYPHS_URL;for(const m in t)for(const g of t[m])c.push({stack:m,id:g});Le(c,(({stack:m,id:g},b)=>{let P=this.entries[m];P||(P=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=P.glyphs[g];if(I!==void 0)return void b(null,{stack:m,id:g,glyph:I});if(I=this._tinySDF(P,m,g),I)return P.glyphs[g]=I,void b(null,{stack:m,id:g,glyph:I});const O=Math.floor(g/256);if(256*O>65535)return Cr("glyphs > 65535 not supported"),void b(null,{stack:m,id:g,glyph:I});if(P.ranges[O])return void b(null,{stack:m,id:g,glyph:I});let L=P.requests[O];L||(L=P.requests[O]=[],U_.loadGlyphRange(m,O,d,this.requestManager,((k,$)=>{if($){P.ascender=$.ascender,P.descender=$.descender;for(const W in $.glyphs)this._doesCharSupportLocalGlyph(+W)||(P.glyphs[+W]=$.glyphs[+W]);P.ranges[O]=!0}for(const W of L)W(k,$);delete P.requests[O]}))),L.push(((k,$)=>{k?b(k):$&&b(null,{stack:m,id:g,glyph:$.glyphs[g]||null})}))}),((m,g)=>{if(m)o(m);else if(g){const b={};for(const{stack:P,id:I,glyph:O}of g)b[P]===void 0&&(b[P]={}),b[P].glyphs===void 0&&(b[P].glyphs={}),b[P].glyphs[I]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics},b[P].ascender=this.entries[P].ascender,b[P].descender=this.entries[P].descender;o(null,b)}}))}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==wT.none&&(this.localGlyphMode===wT.all?!!this.localFontFamily:!!this.localFontFamily&&(Mr["CJK Unified Ideographs"](t)||Mr["Hangul Syllables"](t)||Mr.Hiragana(t)||Mr.Katakana(t)||Mr["CJK Symbols and Punctuation"](t)||Mr["CJK Unified Ideographs Extension A"](t)||Mr["CJK Unified Ideographs Extension B"](t)||Mr.Osage(t)))}_tinySDF(t,o,c){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let m=t.tinySDF;if(!m){let Q="400";/bold/i.test(o)?Q="900":/medium/i.test(o)?Q="500":/light/i.test(o)&&(Q="200"),m=t.tinySDF=new U_.TinySDF({fontFamily:d,fontWeight:Q,fontSize:24*_h,buffer:3*_h,radius:8*_h}),m.fontWeight=Q}if(this.localGlyphs[m.fontWeight][c])return this.localGlyphs[m.fontWeight][c];const g=String.fromCodePoint(c),{data:b,width:P,height:I,glyphWidth:O,glyphHeight:L,glyphLeft:k,glyphTop:$,glyphAdvance:W}=m.draw(g);return this.localGlyphs[m.fontWeight][c]={id:c,bitmap:new wm({width:P,height:I},b),metrics:{width:O/_h,height:L/_h,left:k/_h,top:$/_h-27,advance:W/_h,localGlyph:!0}}}}U_.loadGlyphRange=function(s,t,o,c,d){const m=256*t,g=m+255,b=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",s).replace("{range}",`${m}-${g}`),ms.Glyphs);hl(b,((P,I)=>{if(P)d(P);else if(I){const O={},L=(function(k){return new ob(k).readFields(wX,{})})(I);for(const k of L.glyphs)O[k.id]=k;d(null,{glyphs:O,ascender:L.ascender,descender:L.descender})}}))},U_.TinySDF=class{constructor({fontSize:s=24,buffer:t=3,radius:o=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:g="normal",lang:b=null}={}){this.buffer=t,this.cutoff=c,this.radius=o,this.lang=b;const P=this.size=s+4*t,I=this._createCanvas(P),O=this.ctx=I.getContext("2d",{willReadFrequently:!0});O.font=`${g} ${m} ${s}px ${d}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(s){const t=document.createElement("canvas");return t.width=t.height=s,t}draw(s){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(s),g=Math.ceil(o),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),P=Math.min(this.size-this.buffer,g+Math.ceil(c)),I=b+2*this.buffer,O=P+2*this.buffer,L=Math.max(I*O,0),k=new Uint8ClampedArray(L),$={data:k,width:I,height:O,glyphWidth:b,glyphHeight:P,glyphTop:g,glyphLeft:0,glyphAdvance:t};if(b===0||P===0)return $;const{ctx:W,buffer:Q,gridInner:te,gridOuter:ne}=this;this.lang&&(W.lang=this.lang),W.clearRect(Q,Q,b,P),W.fillText(s,Q,Q+g);const ue=W.getImageData(Q,Q,b,P);ne.fill(Av,0,L),te.fill(0,0,L);for(let he=0;he<P;he++)for(let me=0;me<b;me++){const Ae=ue.data[4*(he*b+me)+3]/255;if(Ae===0)continue;const Pe=(he+Q)*I+me+Q;if(Ae===1)ne[Pe]=0,te[Pe]=Av;else{const Fe=.5-Ae;ne[Pe]=Fe>0?Fe*Fe:0,te[Pe]=Fe<0?Fe*Fe:0}}oF(ne,0,0,I,O,I,this.f,this.v,this.z),oF(te,Q,Q,b,P,I,this.f,this.v,this.z);for(let he=0;he<L;he++){const me=Math.sqrt(ne[he])-Math.sqrt(te[he]);k[he]=Math.round(255-255*(me/this.radius+this.cutoff))}return $}};const yf=Cg;function aF(s,t){return s+t[1]-t[0]}function ST(s,t,o,c,d=1){const m=[],g=s.imagePrimary,b=g.pixelRatio,P=g.paddedRect.w-2*yf,I=g.paddedRect.h-2*yf,O=(s.right-s.left)*d,L=(s.bottom-s.top)*d,k=g.stretchX||[[0,P]],$=g.stretchY||[[0,I]],W=k.reduce(aF,0),Q=$.reduce(aF,0),te=P-W,ne=I-Q;let ue=0,he=W,me=0,Ae=Q,Pe=0,Fe=te,Be=0,Ve=ne;if(g.content&&c){const Ze=g.content;ue=lb(k,0,Ze[0]),me=lb($,0,Ze[1]),he=lb(k,Ze[0],Ze[2]),Ae=lb($,Ze[1],Ze[3]),Pe=Ze[0]-ue,Be=Ze[1]-me,Fe=Ze[2]-Ze[0]-he,Ve=Ze[3]-Ze[1]-Ae}const at=(Ze,ft,xt,Ct)=>{const Wt=cb(Ze.stretch-ue,he,O,s.left*d),Rt=ub(Ze.fixed-Pe,Fe,Ze.stretch,W),wt=cb(ft.stretch-me,Ae,L,s.top*d),Dt=ub(ft.fixed-Be,Ve,ft.stretch,Q),ot=cb(xt.stretch-ue,he,O,s.left*d),it=ub(xt.fixed-Pe,Fe,xt.stretch,W),At=cb(Ct.stretch-me,Ae,L,s.top*d),jt=ub(Ct.fixed-Be,Ve,Ct.stretch,Q),It=new St(Wt,wt),dr=new St(ot,wt),_r=new St(ot,At),ir=new St(Wt,At),Jt=new St(Rt/b,Dt/b),Hr=new St(it/b,jt/b),rr=t*Math.PI/180;if(rr){const Kn=Math.sin(rr),Qn=Math.cos(rr),no=[Qn,-Kn,Kn,Qn];It._matMult(no),dr._matMult(no),ir._matMult(no),_r._matMult(no)}const Rr=Ze.stretch+Ze.fixed,Qr=xt.stretch+xt.fixed,gn=ft.stretch+ft.fixed,kn=Ct.stretch+Ct.fixed,tn=s.imageSecondary;return{tl:It,tr:dr,bl:ir,br:_r,texPrimary:{x:g.paddedRect.x+yf+Rr,y:g.paddedRect.y+yf+gn,w:Qr-Rr,h:kn-gn},texSecondary:tn?{x:tn.paddedRect.x+yf+Rr,y:tn.paddedRect.y+yf+gn,w:Qr-Rr,h:kn-gn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Jt,pixelOffsetBR:Hr,minFontScaleX:Fe/b/O,minFontScaleY:Ve/b/L,isSDF:o}};if(c&&(g.stretchX||g.stretchY)){const Ze=lF(k,te,W),ft=lF($,ne,Q);for(let xt=0;xt<Ze.length-1;xt++){const Ct=Ze[xt],Wt=Ze[xt+1];for(let Rt=0;Rt<ft.length-1;Rt++)m.push(at(Ct,ft[Rt],Wt,ft[Rt+1]))}}else m.push(at({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:I+1}));return m}function CX(s,t){const o=s.stretchY||[[0,s.paddedRect.h-2*yf]];return t&&(s.stretchX||s.stretchY)?cF(s.stretchX||[[0,s.paddedRect.w-2*yf]])*cF(o):1}function lb(s,t,o){let c=0;for(const d of s)c+=Math.max(t,Math.min(o,d[1]))-Math.max(t,Math.min(o,d[0]));return c}function lF(s,t,o){const c=[{fixed:-yf,stretch:0}];for(const[d,m]of s){const g=c[c.length-1];c.push({fixed:d-g.stretch,stretch:g.stretch}),c.push({fixed:d-g.stretch,stretch:g.stretch+(m-d)})}return c.push({fixed:t+yf,stretch:o}),c}function cF(s){return 2*s.length+1}function cb(s,t,o,c){return s/t*o+c}function ub(s,t,o,c){return s-t*o/c}function AX(s,t,o,c){const d=t+s.positionedLines[c].lineOffset;return c===0?o+d/2:o+(d+(t+s.positionedLines[c-1].lineOffset))/2}function DX(s,t=1,o=!1){let c=1/0,d=1/0,m=-1/0,g=-1/0;const b=s[0];for(let $=0;$<b.length;$++){const W=b[$];(!$||W.x<c)&&(c=W.x),(!$||W.y<d)&&(d=W.y),(!$||W.x>m)&&(m=W.x),(!$||W.y>g)&&(g=W.y)}const P=Math.min(m-c,g-d);let I=P/2;const O=new Uf([],RX);if(P===0)return new St(c,d);for(let $=c;$<m;$+=P)for(let W=d;W<g;W+=P)O.push(new $_($+I,W+I,I,s));let L=(function($){let W=0,Q=0,te=0;const ne=$[0];for(let ue=0,he=ne.length,me=he-1;ue<he;me=ue++){const Ae=ne[ue],Pe=ne[me],Fe=Ae.x*Pe.y-Pe.x*Ae.y;Q+=(Ae.x+Pe.x)*Fe,te+=(Ae.y+Pe.y)*Fe,W+=3*Fe}return new $_(Q/W,te/W,0,$)})(s),k=O.length;for(;O.length;){const $=O.pop();($.d>L.d||!L.d)&&(L=$,o&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,k)),$.max-L.d<=t||(I=$.h/2,O.push(new $_($.p.x-I,$.p.y-I,I,s)),O.push(new $_($.p.x+I,$.p.y-I,I,s)),O.push(new $_($.p.x-I,$.p.y+I,I,s)),O.push(new $_($.p.x+I,$.p.y+I,I,s)),k+=4)}return o&&(console.log(`num probes: ${k}`),console.log(`best distance: ${L.d}`)),L.p}function RX(s,t){return t.max-s.max}class $_{constructor(t,o,c,d){this.p=new St(t,o),this.h=c,this.d=(function(m,g){let b=!1,P=1/0;for(let I=0;I<g.length;I++){const O=g[I];for(let L=0,k=O.length,$=k-1;L<k;$=L++){const W=O[L],Q=O[$];W.y>m.y!=Q.y>m.y&&m.x<(Q.x-W.x)*(m.y-W.y)/(Q.y-W.y)+W.x&&(b=!b),P=Math.min(P,Xl(m,W,Q))}}return(b?1:-1)*Math.sqrt(P)})(this.p,d),this.max=this.d+this.h*Math.SQRT2}}const OX=Object.keys,TT=Number.POSITIVE_INFINITY,LX=Math.sqrt(2);function db(s,t,o,c){const d=s.collisionPadding||[0,0,0,0],m={top:s.top-d[1],bottom:s.bottom+d[3],left:s.left-d[0],right:s.right+d[2],scaled:!1};return c!==void 0&&(function(g,b){g.top*=b,g.bottom*=b,g.left*=b,g.right*=b,g.scaled=!0})(m,c),o&&(function(g,b){if(!b)return;const P=vn(b),I=new St(g.left,g.top),O=new St(g.right,g.top),L=new St(g.left,g.bottom),k=new St(g.right,g.bottom);I._rotateAround(P,new St(0,0)),O._rotateAround(P,new St(0,0)),L._rotateAround(P,new St(0,0)),k._rotateAround(P,new St(0,0)),g.left=Math.min(I.x,O.x,L.x,k.x),g.right=Math.max(I.x,O.x,L.x,k.x),g.top=Math.min(I.y,O.y,L.y,k.y),g.bottom=Math.max(I.y,O.y,L.y,k.y)})(m,o),t?{top:Math.min(t.top,m.top),bottom:Math.max(t.bottom,m.bottom),left:Math.min(t.left,m.left),right:Math.max(t.right,m.right),scaled:t.scaled||m.scaled}:m}function uF(s,[t,o]){let c=0,d=0;if(o===TT){t<0&&(t=0);const m=t/LX;switch(s){case"top-right":case"top-left":d=m-7;break;case"bottom-right":case"bottom-left":d=7-m;break;case"bottom":d=7-t;break;case"top":d=t-7}switch(s){case"top-right":case"bottom-right":c=-m;break;case"top-left":case"bottom-left":c=m;break;case"left":c=t;break;case"right":c=-t}}else{switch(t=Math.abs(t),o=Math.abs(o),s){case"top-right":case"top-left":case"top":d=o-7;break;case"bottom-right":case"bottom-left":case"bottom":d=7-o}switch(s){case"top-right":case"bottom-right":case"right":c=-t;break;case"top-left":case"bottom-left":case"left":c=t}}return[c,d]}function zX(s,t,o,c,d,m,g,b,P,I,O){const L=s.layers[0],k=L.appearances;if(k.length===0)return{iconBBox:null,iconVerticalBBox:null};let $=null,W=null;const Q=c.get("icon-rotate").evaluate(d,{},m);t&&($=db(t,$,Q,g),o)&&(W=db(o,W,Q+90,g));const[te,ne]=c.get("icon-size-scale-range"),ue=le(1,te,ne);for(const he of k){const me=he.getUnevaluatedProperties(),Ae=me._values["icon-image"].value!==void 0,Pe=me._values["icon-size"].value!==void 0,Fe=me._values["icon-offset"].value!==void 0,Be=me._values["icon-rotate"].value!==void 0;if(Ae||Pe||Fe||Be){const Ve=Fe?L.getAppearanceValueAndResolveTokens(he,"icon-offset",d,m,[]):null,at=Ve&&Array.isArray(Ve)?Ve:b,Ze=Be?L.getAppearanceValueAndResolveTokens(he,"icon-rotate",d,m,[]):null,ft=typeof Ze=="number"?Ze:Q,xt=Pe?L.getAppearanceValueAndResolveTokens(he,"icon-size",d,m,[]):null,Ct=typeof xt=="number"?xt*P.iconScaleFactor:g;let Wt=null,Rt=null,wt=null;if(Ae){const Dt=L.getAppearanceValueAndResolveTokens(he,"icon-image",d,m,[]);if(Dt){const ot=s.getResolvedImageFromTokens(Dt),it=me._values["icon-size"],At=Dv(ot,N_(s.zoom,it,s.worldview),it,m,s.zoom,d,s.pixelRatio,ue,s.worldview);wt=I.get(At.iconPrimary.toString())}}else t&&(wt=t.imagePrimary);wt&&(Wt=ab(wt,null,at,O),s.allowVerticalPlacement&&(Rt=ab(wt,null,at,O))),Wt&&($=db(Wt,$,ft,Ct)),Rt&&(W=db(Rt,W,ft+90,Ct))}}return{iconBBox:$,iconVerticalBBox:W}}function hb(s,t,o,c,d,m,g,b,P){if(!t||!t.usvg)return;const I=Kz(c),O=Kz(d),L=m!=="both"&&m!=="width"||!Zz(c)?1:O.width/I.width,k=m!=="both"&&m!=="height"||!Xz(c)?1:O.height/I.height;o.scaleSelf(L,k);const $=o.toString();g.set($,o),b.set($,t);const{imagePosition:W}=bT($,t,Cg);P.set($,W)}function dF(s,t,o,c,d,m,g,b,P){if(!s)return;const I=(function(O,L,k,$,W,Q){if(O.kind==="camera")return O.maxSize;if(O.kind==="composite"){const te=L.possiblyEvaluate(new mi(O.maxZoom,{worldview:Q}),k).evaluate(W,{},k),ne=L.possiblyEvaluate(new mi(O.minZoom,{worldview:Q}),k).evaluate(W,{},k);return Math.max(te,ne)}return L.possiblyEvaluate(new mi($,{worldview:Q})).evaluate(W,{},k)})(t,o,c,d,m,P);return s.scaleSelf(I*b*g)}function Dv(s,t,o,c,d,m,g,b,P){return{iconPrimary:dF(s.getPrimary(),t,o,c,d,m,g,b,P),iconSecondary:dF(s.getSecondary(),t,o,c,d,m,g,b,P)}}function FX(s,t,o){if(!t)return;const c=o.get(s.toString()),d=o.get(t.toString());c&&d&&(c.paddedRect.w===d.paddedRect.w&&c.paddedRect.h===d.paddedRect.h||Cr(`Mismatch in icon variant sizes: ${s.toString()} and ${t.toString()}`),c.usvg!==d.usvg&&Cr(`Mismatch in icon variant image types: ${s.id} and ${t.id}`))}function hF(s,t,o,c){if(!s)return;const d=t.get(o.toString());if(s.imagePrimary=d,c){const m=t.get(c.toString());s.imageSecondary=m}}function kX(s,t){for(const o in s.horizontal)fF(s.horizontal[o],t);fF(s.vertical,t)}function fF(s,t){if(s){for(const o of s.positionedLines)for(const c of o.positionedGlyphs)if(c.image!==null){const d=c.image.toString();c.rect=t.get(d).paddedRect}}}function ET(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function BX(s,t,o,c,d,m,g,b,P){const I=PT(m.horizontal)||m.vertical,O=o.get("icon-text-fit-padding").evaluate(c,{},d);let L,k=t;return t&&P!=="none"&&(s.allowVerticalPlacement&&m.vertical&&(L=vT(t,m.vertical,P,O,b,g)),I&&(k=vT(t,I,P,O,b,g))),{defaultShapedIcon:k,verticallyShapedIcon:L}}function jX(s,t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue,he,me,Ae){let Pe=g.textMaxSize.evaluate(t,{},k);Pe===void 0?Pe=b*g.textScaleFactor:Pe*=g.textScaleFactor;const Fe=s.layers[0].layout,Be=pa,Ve=b*g.textScaleFactor/Be,at=PT(o.horizontal)||o.vertical;if(te!=="none"&&s.appearanceFeatureData&&t.index<s.appearanceFeatureData.length){const It=s.appearanceFeatureData[t.index];It&&(It.textShaping=at,It.iconTextFitPadding=Fe.get("icon-text-fit-padding").evaluate(t,{},k),It.fontScale=Ve)}const Ze=$.name==="globe",ft=s.tilePixelRatio*Pe/Be,xt=(ot=s.overscaling,s.zoom>18&&ot>2&&(ot>>=1),Math.max(Ut/(512*ot),1)*Fe.get("symbol-spacing")),Ct=Fe.get("text-padding")*s.tilePixelRatio,Wt=Fe.get("icon-padding")*s.tilePixelRatio,Rt=vn(Fe.get("text-max-angle")),wt=Fe.get("icon-rotation-alignment")==="map"&&he!=="point",Dt=xt/2;var ot;s.hasAnyIconTextFit===!1&&te!=="none"&&(s.hasAnyIconTextFit=!0);const it=t.properties?+t.properties[Qt]:null,At=it&&s.elevationFeatureIdToIndex?s.elevationFeatureIdToIndex.get(it):65535,jt=(It,dr,_r)=>{if(dr.x<0||dr.x>=Ut||dr.y<0||dr.y>=Ut)return;let ir=null;if(Ze){const{x:Jt,y:Hr,z:rr}=$.projectTilePoint(dr.x,dr.y,_r);ir={anchor:new xp(Jt,Hr,rr,0,void 0),up:$.upVector(_r,dr.x,dr.y)}}(function(Jt,Hr,rr,Rr,Qr,gn,kn,tn,Kn,Qn,no,Ie,Se,mt,Zt,gt,er,Tr,wr,ln,Ur,vr,Hn,bi,Gr,On,wi,ci,po,Wi,Ai){const gi=Jt.addToLineVertexArray(Hr,Rr);let Jn,cn,ei,Di,$r,Bn,qi,bo=0,zo=0,cs=0,Gi=0,os=-1,Sc=-1;const ss={};let Yc=Oi("");const Ga=rr?rr.anchor:Hr,Zu=ci!=="none";let Tc=0,Zc=0;if(Kn._unevaluatedLayout.getValue("text-radial-offset")===void 0){const ma=Kn.layout.get("text-offset").evaluate(Ur,{},Gr);Tc=ma[0]*pa,Zc=ma[1]*pa}else Tc=Kn.layout.get("text-radial-offset").evaluate(Ur,{},Gr)*pa,Zc=TT;if(Jt.allowVerticalPlacement&&Qr.vertical){const ma=Qr.vertical;if(Zt)Bn=IT(ma),tn&&(qi=IT(tn));else{const Tl=Kn.layout.get("text-rotate").evaluate(Ur,{},Gr)+90;ei=fb(Qn,Ga,Hr,no,Ie,Se,ma,mt,Tl,gt),tn&&(Di=fb(Qn,Ga,Hr,no,Ie,Se,tn,Tr,Tl,null,Ai))}}if(gn){const ma=Jt.iconSizeData,Tl=Kn.layout.get("icon-rotate").evaluate(Ur,{},Gr),vf=ST(gn,Tl,Hn,Zu,vr.iconScaleFactor),Im=tn?ST(tn,Tl,Hn,Zu,vr.iconScaleFactor):void 0;cn=fb(Qn,Ga,Hr,no,Ie,Se,gn,Tr,Tl,null,Wi);const X_=(function(xf,Ab,K_,QK,Rk,Ok,JK,eQ){const Lk=xf.layers[0],zk=Lk.appearances;let Q_=Ab.length;if(K_&&(Q_=Math.max(Q_,K_.length)),zk.length===0)return Q_;const[tQ,rQ]=QK.get("icon-size-scale-range"),nQ=le(1,tQ,rQ);for(const Fk of zk){const kk=Fk.getUnevaluatedProperties();if(kk._values["icon-image"].value!==void 0){const Bk=Lk.getAppearanceValueAndResolveTokens(Fk,"icon-image",Rk,Ok,[]);if(Bk){const jk=xf.getResolvedImageFromTokens(Bk);if(jk){const Nk=kk._values["icon-size"],iQ=Dv(jk,N_(xf.zoom,Nk,xf.worldview),Nk,Ok,xf.zoom,Rk,xf.pixelRatio,nQ,xf.worldview),oQ=JK.get(iQ.iconPrimary.toString());Q_=Math.max(Q_,CX(oQ,eQ))}}}}return Q_})(Jt,vf,Im,Kn.layout,Ur,Gr,Jt.iconAtlasPositions,Zu);bo=4*X_;let Mm=null;ma.kind==="source"?(Mm=[gh*Kn.layout.get("icon-size").evaluate(Ur,{},Gr)*vr.iconScaleFactor],Mm[0]>bp&&Cr(`${Jt.layerIds[0]}: Value for "icon-size" is >= ${Rv}. Reduce your "icon-size".`)):ma.kind==="composite"&&(Mm=[gh*vr.compositeIconSizes[0].evaluate(Ur,{},Gr)*vr.iconScaleFactor,gh*vr.compositeIconSizes[1].evaluate(Ur,{},Gr)*vr.iconScaleFactor],(Mm[0]>bp||Mm[1]>bp)&&Cr(`${Jt.layerIds[0]}: Value for "icon-size" is >= ${Rv}. Reduce your "icon-size".`)),Jt.addSymbols(Jt.icon,vf,Mm,ln,wr,Ur,void 0,rr,Hr,gi.lineStartIndex,gi.lineLength,-1,bi,Gr,On,wi,Jt.symbolInstances.length,X_),os=Jt.icon.placedSymbolArray.length-1,Im&&(zo=4*X_,Jt.addSymbols(Jt.icon,Im,Mm,ln,wr,Ur,Hc.vertical,rr,Hr,gi.lineStartIndex,gi.lineLength,-1,bi,Gr,On,wi,Jt.symbolInstances.length,X_),Sc=Jt.icon.placedSymbolArray.length-1)}for(const ma in Qr.horizontal){const Tl=ma,vf=Qr.horizontal[Tl];Jn||(Yc=Oi(vf.text),Zt?$r=IT(vf):Jn=fb(Qn,Ga,Hr,no,Ie,Se,vf,mt,Kn.layout.get("text-rotate").evaluate(Ur,{},Gr),gt));const Im=vf.positionedLines.length===1;if(cs+=pF(Jt,rr,Hr,vf,kn,Kn,Zt,Ur,gt,gi,Qr.vertical?Hc.horizontal:Hc.horizontalOnly,Im?OX(Qr.horizontal):[Tl],ss,os,vr,bi,Gr,Jt.symbolInstances.length,On),Im)break}Qr.vertical&&(Gi+=pF(Jt,rr,Hr,Qr.vertical,kn,Kn,Zt,Ur,gt,gi,Hc.vertical,["vertical"],ss,Sc,vr,bi,Gr,Jt.symbolInstances.length,On));let Ha=-1;const Xc=(ma,Tl)=>ma?Math.max(ma,Tl):Tl;Ha=Xc($r,Ha),Ha=Xc(Bn,Ha),Ha=Xc(qi,Ha);const Xu=Ha>-1?1:0;Jt.glyphOffsetArray.length>=65535&&Cr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ur.sortKey!==void 0&&Jt.addToSortKeyRanges(Jt.symbolInstances.length,Ur.sortKey),Jt.symbolInstances.emplaceBack(Hr.x,Hr.y,Ga.x,Ga.y,Ga.z,ss.right>=0?ss.right:-1,ss.center>=0?ss.center:-1,ss.left>=0?ss.left:-1,ss.vertical>=0?ss.vertical:-1,os,Sc,Yc,Jn!==void 0?Jn:Jt.collisionBoxArray.length,Jn!==void 0?Jn+1:Jt.collisionBoxArray.length,ei!==void 0?ei:Jt.collisionBoxArray.length,ei!==void 0?ei+1:Jt.collisionBoxArray.length,cn!==void 0?cn:Jt.collisionBoxArray.length,cn!==void 0?cn+1:Jt.collisionBoxArray.length,Di||Jt.collisionBoxArray.length,Di?Di+1:Jt.collisionBoxArray.length,no,cs,Gi,bo,zo,Xu,0,Tc,Zc,Ha,0,Zu?1:0,po)})(s,dr,ir,It,o,c,m,d,s.layers[0],s.collisionBoxArray,t.index,t.sourceLayerIndex,s.index,Ct,ue,I,0,Wt,wt,ne,t,g,O,L,k,W,Q,te,At,me,Ae)};if(he==="line")for(const It of Yx(t.geometry,0,0,Ut,Ut)){const dr=MX(It,xt,Rt,o.vertical||at,c,Be,ft,s.overscaling,Ut);for(const _r of dr)at&&NX(s,at.text,Dt,_r)||jt(It,_r,k)}else if(he==="line-center"){for(const It of t.geometry)if(It.length>1){const dr=IX(It,Rt,o.vertical||at,c,Be,ft);dr&&jt(It,dr,k)}}else if(t.type==="Polygon")for(const It of pv(t.geometry,0)){const dr=DX(It,16);jt(It[0],new xp(dr.x,dr.y,0,0,void 0),k)}else if(t.type==="LineString")for(const It of t.geometry)jt(It,new xp(It[0].x,It[0].y,0,0,void 0),k);else if(t.type==="Point")for(const It of t.geometry)for(const dr of It)jt([dr],new xp(dr.x,dr.y,0,0,void 0),k)}const Rv=255,bp=Rv*gh;function pF(s,t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue){const he=(function(Pe,Fe,Be,Ve,at,Ze,ft,xt){const Ct=[];if(Fe.positionedLines.length===0)return Ct;const Wt=Ve.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Rt=(function(At){const jt=At[0],It=At[1],dr=jt*It;return dr>0?[jt,-It]:dr<0?[-jt,It]:jt===0?[It,jt]:[It,-jt]})(Be);let wt=Math.abs(Fe.top-Fe.bottom);for(const At of Fe.positionedLines)wt-=At.lineOffset;const Dt=Fe.positionedLines.length,ot=wt/Dt;let it=Fe.top-Be[1];for(let At=0;At<Dt;++At){const jt=Fe.positionedLines[At];it=AX(Fe,ot,it,At);for(const It of jt.positionedGlyphs){if(!It.rect)continue;const dr=It.rect||{};let _r=Uz+1,ir=!0,Jt=1,Hr=0;if(It.image){const wr=ft.get(It.image.toString());if(!wr)continue;if(wr.sdf){Cr("SDF images are not supported in formatted text and will be ignored.");continue}ir=!1,Jt=wr.pixelRatio,_r=Cg/Jt}const rr=(at||xt)&&It.vertical,Rr=It.metrics.advance*It.scale/2,Qr=It.metrics,gn=It.rect;if(gn===null)continue;xt&&Fe.verticalizable&&(Hr=It.image?Rr-It.metrics.width*It.scale/2:0);const kn=at?[It.x+Rr,It.y]:[0,0];let tn=[0,0],Kn=[0,0],Qn=!1;at||(rr?(Kn=[It.x+Rr+Rt[0],It.y+Rt[1]-Hr],Qn=!0):tn=[It.x+Rr+Be[0],It.y+Be[1]-Hr]);const no=gn.w*It.scale/(Jt*(It.localGlyph?_h:1)),Ie=gn.h*It.scale/(Jt*(It.localGlyph?_h:1));let Se,mt,Zt,gt;if(rr){const wr=It.y-it,ln=new St(-Rr,Rr-wr),Ur=-Math.PI/2,vr=new St(...Kn);Se=new St(-Rr+tn[0],tn[1]),Se._rotateAround(Ur,ln)._add(vr),Se.x+=-wr+Rr,Se.y-=(Qr.left-_r)*It.scale;const Hn=It.image?Qr.advance*It.scale:pa*It.scale,bi=String.fromCodePoint(It.glyph);dX(bi)?Se.x+=(1-_r)*It.scale:hX(bi)?Se.x+=Hn-Qr.height*It.scale+(-_r-1)*It.scale:Se.x+=It.image||Qr.width+2*_r===gn.w&&Qr.height+2*_r===gn.h?(Hn-Ie)/2:(Hn-(Qr.height+2*_r)*It.scale)/2,mt=new St(Se.x,Se.y-no),Zt=new St(Se.x+Ie,Se.y),gt=new St(Se.x+Ie,Se.y-no)}else{const wr=(Qr.left-_r)*It.scale-Rr+tn[0],ln=(-Qr.top-_r)*It.scale+tn[1],Ur=wr+no,vr=ln+Ie;Se=new St(wr,ln),mt=new St(Ur,ln),Zt=new St(wr,vr),gt=new St(Ur,vr)}if(Wt){let wr;wr=at?new St(0,0):Qn?new St(Rt[0],Rt[1]):new St(Be[0],Be[1]),Se._rotateAround(Wt,wr),mt._rotateAround(Wt,wr),Zt._rotateAround(Wt,wr),gt._rotateAround(Wt,wr)}const er=new St(0,0),Tr=new St(0,0);Ct.push({tl:Se,tr:mt,bl:Zt,br:gt,texPrimary:dr,texSecondary:void 0,writingMode:Fe.writingMode,glyphOffset:kn,sectionIndex:It.sectionIndex,isSDF:ir,pixelOffsetTL:er,pixelOffsetBR:Tr,minFontScaleX:0,minFontScaleY:0})}}return Ct})(0,c,P,m,g,b,d,s.allowVerticalPlacement),me=s.textSizeData;let Ae=null;me.kind==="source"?(Ae=[gh*m.layout.get("text-size").evaluate(b,{},te)*W.textScaleFactor],Ae[0]>bp&&Cr(`${s.layerIds[0]}: Value for "text-size" is >= ${Rv}. Reduce your "text-size".`)):me.kind==="composite"&&(Ae=[gh*W.compositeTextSizes[0].evaluate(b,{},te)*W.textScaleFactor,gh*W.compositeTextSizes[1].evaluate(b,{},te)*W.textScaleFactor],(Ae[0]>bp||Ae[1]>bp)&&Cr(`${s.layerIds[0]}: Value for "text-size" is >= ${Rv}. Reduce your "text-size".`)),s.addSymbols(s.text,he,Ae,P,g,b,O,t,o,I.lineStartIndex,I.lineLength,$,Q,te,ue,!1,ne,he.length);for(const Pe of L)k[Pe]=s.text.placedSymbolArray.length-1;return 4*he.length}function PT(s){for(const t in s)return s[t];return null}function fb(s,t,o,c,d,m,g,b,P,I,O){let L,k,$,W;if(L=O?O.top:g.top,k=O?O.bottom:g.bottom,$=O?O.left:g.left,W=O?O.right:g.right,Yz(g)&&g.collisionPadding){const Q=g.collisionPadding;$-=Q[0],L-=Q[1],W+=Q[2],k+=Q[3]}if(P){const Q=new St($,L),te=new St(W,L),ne=new St($,k),ue=new St(W,k),he=vn(P);let me=new St(0,0);I&&(me=new St(I[0],I[1])),Q._rotateAround(he,me),te._rotateAround(he,me),ne._rotateAround(he,me),ue._rotateAround(he,me),$=Math.min(Q.x,te.x,ne.x,ue.x),W=Math.max(Q.x,te.x,ne.x,ue.x),L=Math.min(Q.y,te.y,ne.y,ue.y),k=Math.max(Q.y,te.y,ne.y,ue.y)}return s.emplaceBack(t.x,t.y,t.z,o.x,o.y,$,L,W,k,b,c,d,m),s.length-1}function IT(s){Yz(s)&&s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const t=s.bottom-s.top;return t>0?Math.max(10,t):null}function NX(s,t,o,c){const d=s.compareText;if(t in d){const m=d[t];for(let g=m.length-1;g>=0;g--)if(c.dist(m[g])<o)return!0}else d[t]=[];return d[t].push(c),!1}function mF(s,t){const o=s.fovAboveCenter,c=s.elevation?s.elevation.getMinElevationBelowMSL()*t:0,d=(s._camera.position[2]*s.worldSize-c)/Math.cos(s._pitch),m=Math.sin(o)*d/Math.sin(Math.max(Math.PI/2-s._pitch-o,.01));let g=Math.sin(s._pitch)*m+d;const b=d*(1/s._horizonShift);if(!s.elevation||s.elevation.exaggeration()===0){let P=Math.max(s.zoom-17,0);s.isOrthographic&&(P/=10),g*=1+P}return Math.min(1.01*g,b)}function Ov(s,t){if(!t.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:t};const o=Math.pow(2,-s.z),c=s.x*o,d=(s.x+1)*o,m=s.y*o,g=(s.y+1)*o,b=ye(c),P=ye(d),I=fe(m),O=fe(g),L=t.project(b,I),k=t.project(P,I),$=t.project(P,O),W=t.project(b,O);let Q=Math.min(L.x,k.x,$.x,W.x),te=Math.min(L.y,k.y,$.y,W.y),ne=Math.max(L.x,k.x,$.x,W.x),ue=Math.max(L.y,k.y,$.y,W.y);const he=o/16;function me(Pe,Fe,Be,Ve,at,Ze){const ft=(Be+at)/2,xt=(Ve+Ze)/2,Ct=t.project(ye(ft),fe(xt)),Wt=Math.max(0,Q-Ct.x,te-Ct.y,Ct.x-ne,Ct.y-ue);Q=Math.min(Q,Ct.x),ne=Math.max(ne,Ct.x),te=Math.min(te,Ct.y),ue=Math.max(ue,Ct.y),Wt>he&&(me(Pe,Ct,Be,Ve,ft,xt),me(Ct,Fe,ft,xt,at,Ze))}me(L,k,c,m,d,m),me(k,$,d,m,d,g),me($,W,d,g,c,g),me(W,L,c,g,c,m),Q-=he,te-=he,ne+=he,ue+=he;const Ae=1/Math.max(ne-Q,ue-te);return{scale:Ae,x:Q*Ae,y:te*Ae,x2:ne*Ae,y2:ue*Ae,projection:t}}function gF(s,{x:t,y:o},c=0){return new St(((t-c)*s.scale-s.x)*Ut,(o*s.scale-s.y)*Ut)}const VX=J(new Float32Array(16));class Em{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,o){return{x:0,y:0,z:0}}unproject(t,o){return new q(0,0)}projectTilePoint(t,o,c){return{x:t,y:o,z:0}}locationPoint(t,o,c,d=!0){return t._coordinatePoint(t.locationCoordinate(o,c),d)}pixelsPerMeter(t,o){return de(1,t)*o}pixelSpaceConversion(t,o,c){return 1}farthestPixelDistance(t){return mF(t,t.pixelsPerMeter)}pointCoordinate(t,o,c,d){const m=t.horizonLineFromTop(!1),g=new St(o,Math.max(m,c));return t.rayIntersectionCoordinate(t.pointRayIntersection(g,d))}pointCoordinate3D(t,o,c){const d=new St(o,c);if(t.elevation)return t.elevation.pointCoordinate(d);{const m=this.pointCoordinate(t,d.x,d.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(t,o){if(t.elevation&&t.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(t,o.x,o.y);const c=t.horizonLineFromTop();return o.y<c}createInversionMatrix(t,o){return VX}createTileMatrix(t,o,c){let d,m,g;const b=c.canonical,P=J(new Float64Array(16));if(this.isReprojectedInTileSpace){const I=Ov(b,this);d=1,m=I.x+c.wrap*I.scale,g=I.y,Ne(P,P,[d/I.scale,d/I.scale,t.pixelsPerMeter/o])}else d=o/t.zoomScale(b.z),m=(b.x+Math.pow(2,b.z)*c.wrap)*d,g=b.y*d;return ve(P,P,[m,g,0]),Ne(P,P,[d/Ut,d/Ut,1]),P}upVector(t,o,c){return[0,0,1]}upVectorScale(t,o,c){return{metersToTile:1}}}class UX extends Em{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[o,c]=this.parallels=t.parallels||[29.5,45.5],d=Math.sin(vn(o));this.n=(d+Math.sin(vn(c)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(t,o){const{n:c,c:d,r0:m}=this,g=vn(t-this.center[0]),b=vn(o),P=Math.sqrt(d-2*c*Math.sin(b))/c;return{x:P*Math.sin(g*c),y:P*Math.cos(g*c)-m,z:0}}unproject(t,o){const{n:c,c:d,r0:m}=this,g=m+o;let b=Math.atan2(t,Math.abs(g))*Math.sign(g);g*c<0&&(b-=Math.PI*Math.sign(t)*Math.sign(g));const P=vn(this.center[0])*c;b=Oe(b,-Math.PI-P,Math.PI-P);const I=le(So(b/c)+this.center[0],-180,180),O=Math.asin(le((d-(t*t+g*g)*c*c)/(2*c),-1,1)),L=le(So(O),-xe,xe);return new q(I,L)}}const Lv=1.340264,zv=-.081106,Fv=893e-6,kv=.003796,pb=Math.sqrt(3)/2;class $X extends Em{project(t,o){o=o/180*Math.PI,t=t/180*Math.PI;const c=Math.asin(pb*Math.sin(o)),d=c*c,m=d*d*d;return{x:.5*(t*Math.cos(c)/(pb*(Lv+3*zv*d+m*(7*Fv+9*kv*d)))/Math.PI+.5),y:1-.5*(c*(Lv+zv*d+m*(Fv+kv*d))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,d=c*c,m=d*d*d;for(let O,L,k,$=0;$<12&&(L=c*(Lv+zv*d+m*(Fv+kv*d))-o,k=Lv+3*zv*d+m*(7*Fv+9*kv*d),O=L/k,c=le(c-O,-Math.PI/3,Math.PI/3),d=c*c,m=d*d*d,!(Math.abs(O)<1e-12));++$);const g=pb*t*(Lv+3*zv*d+m*(7*Fv+9*kv*d))/Math.cos(c),b=Math.asin(Math.sin(c)/pb),P=le(180*g/Math.PI,-180,180),I=le(180*b/Math.PI,-xe,xe);return new q(P,I)}}class WX extends Em{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){return{x:.5+t/360,y:.5-o/360,z:0}}unproject(t,o){const c=360*(t-.5),d=le(360*(.5-o),-xe,xe);return new q(c,d)}}const W_=Math.PI/2;function mb(s){return Math.tan((W_+s)/2)}class qX extends Em{constructor(t){super(t),this.center=t.center||[0,30];const[o,c]=this.parallels=t.parallels||[30,30];let d=vn(o),m=vn(c);this.southernCenter=d+m<0,this.southernCenter&&(d=-d,m=-m);const g=Math.cos(d),b=mb(d);this.n=d===m?Math.sin(d):Math.log(g/Math.cos(m))/Math.log(mb(m)/b),this.f=g*Math.pow(mb(d),this.n)/this.n}project(t,o){o=vn(o),this.southernCenter&&(o=-o),t=vn(t-this.center[0]);const c=1e-6,{n:d,f:m}=this;m>0?o<-W_+c&&(o=-W_+c):o>W_-c&&(o=W_-c);const g=m/Math.pow(mb(o),d);let b=g*Math.sin(d*t),P=m-g*Math.cos(d*t);return b=.5*(b/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:b,y:this.southernCenter?P:1-P,z:0}}unproject(t,o){t=(2*t-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:c,f:d}=this,m=d-o,g=Math.sign(m),b=Math.sign(c)*Math.sqrt(t*t+m*m);let P=Math.atan2(t,Math.abs(m))*g;m*c<0&&(P-=Math.PI*Math.sign(t)*g);const I=le(So(P/c)+this.center[0],-180,180),O=le(So(2*Math.atan(Math.pow(d/b,1/c))-W_),-xe,xe);return new q(I,this.southernCenter?-O:O)}}class _F extends Em{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,o){return{x:ce(t),y:ae(o),z:0}}unproject(t,o){const c=ye(t),d=fe(o);return new q(c,d)}}const yF=vn(xe);class GX extends Em{project(t,o){const c=(o=vn(o))*o,d=c*c;return{x:.5*((t=vn(t))*(.8707-.131979*c+d*(d*(.003971*c-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+c*(.015085+d*(.028874*c-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,d=25,m=0,g=c*c;do{g=c*c;const I=g*g;m=(c*(1.007226+g*(.015085+I*(.028874*g-.044475-.005916*I)))-o)/(1.007226+g*(.045255+I*(.259866*g-.311325-.005916*11*I))),c=le(c-m,-yF,yF)}while(Math.abs(m)>1e-6&&--d>0);g=c*c;const b=le(So(t/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),P=So(c);return new q(b,P)}}const vF=vn(xe);class HX extends Em{project(t,o){o=vn(o),t=vn(t);const c=Math.cos(o),d=2/Math.PI,m=Math.acos(c*Math.cos(t/2)),g=Math.sin(m)/m,b=.5*(t*d+2*c*Math.sin(t/2)/g)||0,P=.5*(o+Math.sin(o)/g)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(t,o){let c=t=(2*t-.5)*Math.PI,d=o=(2*(1-o)-1)*Math.PI,m=25;const g=1e-6;let b=0,P=0;do{const I=Math.cos(d),O=Math.sin(d),L=2*O*I,k=O*O,$=I*I,W=Math.cos(c/2),Q=Math.sin(c/2),te=2*W*Q,ne=Q*Q,ue=1-$*W*W,he=ue?1/ue:0,me=ue?Math.acos(I*W)*Math.sqrt(1/ue):0,Ae=.5*(2*me*I*Q+2*c/Math.PI)-t,Pe=.5*(me*O+d)-o,Fe=.5*he*($*ne+me*I*W*k)+1/Math.PI,Be=he*(te*L/4-me*O*Q),Ve=.125*he*(L*Q-me*O*$*te),at=.5*he*(k*W+me*ne*I)+.5,Ze=Be*Ve-at*Fe;b=(Pe*Be-Ae*at)/Ze,P=(Ae*Ve-Pe*Fe)/Ze,c=le(c-b,-Math.PI,Math.PI),d=le(d-P,-vF,vF)}while((Math.abs(b)>g||Math.abs(P)>g)&&--m>0);return new q(So(c),So(d))}}class xF extends Em{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(vn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){const{scale:c,cosPhi:d}=this;return{x:vn(t)*d*c+.5,y:-Math.sin(vn(o))/d*c+.5,z:0}}unproject(t,o){const{scale:c,cosPhi:d}=this,m=-(o-.5)/c,g=le(So((t-.5)/c)/d,-180,180),b=Math.asin(le(m*d,-1,1)),P=le(So(b),-xe,xe);return new q(g,P)}}class YX extends _F{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,o,c){const d=mn(t,o,c);return Yr(d,d,Gn(an(c))),{x:d[0],y:d[1],z:d[2]}}locationPoint(t,o,c){const d=D(o.lat,o.lng),m=sr([],d),g=c?t._centerAltitude+c:t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(o),t._centerAltitude):t._centerAltitude;Vt(d,d,m,de(1,0)*Ut*g);const b=J(new Float64Array(16));return pe(b,t.pixelMatrix,t.globeMatrix),Yr(d,d,b),new St(d[0],d[1])}pixelsPerMeter(t,o){return de(1,0)*o}pixelSpaceConversion(t,o,c){const d=de(1,t)*o,m=Lr(de(1,45)*o,d,c);return this.pixelsPerMeter(t,o)/m}createTileMatrix(t,o,c){const d=fa(an(c.canonical));return pe(new Float64Array(16),t.globeMatrix,d)}createInversionMatrix(t,o){const{center:c}=t,d=Gn(an(o));return Re(d,d,vn(c.lng)),_e(d,d,vn(c.lat)),Ne(d,d,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(t,o,c,d){return Pr(t,o,c,!0)||new He(0,0)}pointCoordinate3D(t,o,c){const d=this.pointCoordinate(t,o,c,0);return[d.x,d.y,d.z]}isPointAboveHorizon(t,o){return!Pr(t,o.x,o.y,!1)}farthestPixelDistance(t){const o=(function(d,m){const g=d.cameraToCenterDistance,b=d._centerAltitude*m,P=d._camera,I=d._camera.forward(),O=Et([],_t([],I,-g),[0,0,b]),L=d.worldSize/(2*Math.PI),k=[0,0,-L],$=d.width/d.height,W=Math.tan(d.fovAboveCenter),Q=_t([],P.up(),W),te=_t([],P.right(),W*$),ne=sr([],Et([],Et([],I,Q),te)),ue=[];let he;if(new sn(O,ne).closestPointOnSphere(k,L,ue)){const me=Et([],ue,k),Ae=Xn([],me,O);he=Math.cos(d.fovAboveCenter)*Or(Ae)}else{const me=Xn([],O,k),Ae=Xn([],k,O);sr(Ae,Ae);const Pe=Or(me)-L;he=Math.sqrt(Pe*(Pe+2*L));const Fe=Math.acos(he/(L+Pe))-Math.acos(Br(I,Ae));he*=Math.cos(Fe)}return 1.01*he})(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),c=bm(t.zoom);if(c>0){const d=mF(t,de(1,t.center.lat)*t.worldSize),m=t.worldSize/(2*Math.PI),g=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Lr(o,d+m*(1-Math.cos(g)),Math.pow(c,10))}return o}upVector(t,o,c){return mn(o,c,t,1)}upVectorScale(t){return{metersToTile:Er(In(an(t)))}}}function bF(s){const t=s.parallels,o=!!t&&Math.abs(t[0]+t[1])<.01;switch(s.name){case"mercator":return new _F(s);case"equirectangular":return new WX(s);case"naturalEarth":return new GX(s);case"equalEarth":return new $X(s);case"winkelTripel":return new HX(s);case"albers":return o?new xF(s):new UX(s);case"lambertConformalConic":return o?new xF(s):new qX(s);case"globe":return new YX(s)}throw new Error(`Invalid projection name: ${s.name}`)}const ZX=Mt.types,XX=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Bv(s,t,o,c,d,m,g,b,P,I,O,L,k){const $=b?Math.min(bp,Math.round(b[0])):0,W=b?Math.min(bp,Math.round(b[1])):0;s.emplaceBack(t,o,Math.round(32*c),Math.round(32*d),m,g,($<<1)+(P?1:0),0+(W<<1),16*I,16*O,256*L,256*k)}function jv(s,t,o){s.emplaceBack(t,o)}function Nv(s,t,o,c,d,m,g){s.emplaceBack(t,o,c,d,m,g)}const gb=(s,t,o,c)=>{for(let d=0;d<t;d++)s.emplaceBack(o[0],o[1],o[2],c[0],c[1],c[2])};function q_(s,t,o,c,d){s.emplaceBack(t,o,c,d),s.emplaceBack(t,o,c,d),s.emplaceBack(t,o,c,d),s.emplaceBack(t,o,c,d)}function KX(s){for(const t of s.sections)if(nm(t.text))return!0;return!1}class MT{constructor(t){this.layoutVertexArray=new dm,this.indexArray=new Li,this.programConfigurations=t,this.segments=new Wn,this.dynamicLayoutVertexArray=new $u,this.opacityVertexArray=new hm,this.placedSymbolArray=new uf,this.iconTransitioningVertexArray=new Hl,this.globeExtVertexArray=new ah,this.zOffsetVertexArray=new Wc,this.orientationVertexArray=new gm,this.symbolInstanceIndices=[]}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}getIconVertexData(t,o){const c=[],d=this.layoutVertexArray.uint16;for(let m=0;m<o;++m){const g=12*(t+m);c.push(...d.slice(g,g+12))}return c}updateIconVertexData(t,o,c,d,m,g,b,P,I,O,L,k,$){const W=this.layoutVertexArray.uint16,Q=12*t;W[Q]=o,W[Q+1]=c,W[Q+2]=d,W[Q+3]=m,W[Q+4]=g,W[Q+5]=b,W[Q+6]=P,W[Q+7]=I,W[Q+8]=O,W[Q+9]=L,W[Q+10]=k,W[Q+11]=$}upload(t,o,c,d,m,g){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tX.members,!!g),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,nX.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,XX,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,sX.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,rX.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,iX.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=t.createVertexBuffer(this.orientationVertexArray,oX.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}cr(MT,"SymbolBuffers");class CT{constructor(t,o,c){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new c,this.segments=new Wn,this.collisionVertexArray=new Fs,this.collisionVertexArrayExt=new $u}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,aX.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,lX.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}cr(CT,"CollisionBuffers");class _b{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((g=>g.fqid)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=J([]),this.placementViewportMatrix=J([]);const o=this.layers[0]._unevaluatedLayout._values;this.worldview=t.worldview,this.textSizeData=N_(this.zoom,o["text-size"],this.worldview),this.iconSizeData=N_(this.zoom,o["icon-size"],this.worldview);const c=this.layers[0].layout,d=c.get("symbol-sort-key"),m=c.get("symbol-z-order");this.lut=t.lut,this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&d.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map((g=>Hc[g])),this.stateDependentLayerIds=this.layers.filter((g=>g.isStateDependent())).map((g=>g.id)),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1,this.hasAppearances=null,this.lastActiveApperance=null}hasAnyAppearanceProperty(t){const o=this.layers[0].getAppearances();return!(!o||o.length===0)&&o.some((c=>c.getProperty(t)!=null))}createArrays(){this.text=new MT(new wl(this.layers,{zoom:this.zoom,lut:this.lut},(t=>t.startsWith("text")||t.startsWith("symbol")))),this.icon=new MT(new wl(this.layers,{zoom:this.zoom,lut:this.lut},(t=>t.startsWith("icon")||t.startsWith("symbol")))),this.glyphOffsetArray=new _g,this.lineVertexArray=new yg,this.symbolInstances=new _u}calculateGlyphDependencies(t,o,c,d,m){for(const g of t){const b=g.codePointAt(0);if(b===void 0)break;if(o[b]=!0,d&&m&&b<=65535){const P=Iv[g];P&&(o[P.charCodeAt(0)]=!0)}}}calculateEffectiveAppearanceIconSize(t,o,c,d,m,g){let b=1;const P=t.getUnevaluatedProperties()._values["icon-size"],I=N_(this.zoom,P,this.worldview),O=V_(I,o);if(I.kind!=="constant"&&I.kind!=="camera"||(b=O.uSize),I.kind==="composite"){const{minZoom:L,maxZoom:k}=I,$=P.possiblyEvaluate(new mi(L,{worldview:this.worldview}),d),W=P.possiblyEvaluate(new mi(k,{worldview:this.worldview}),d),Q=$.evaluate(c,{},d,m);b=Q+(W.evaluate(c,{},d,m)-Q)*O.uSizeT}return I.kind==="source"&&(b=P.possiblyEvaluate(new mi(this.zoom,{worldview:this.worldview}),d).evaluate(c,{},d,m)),b*g}updateFootprints(t,o){}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const c=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);return!qx(this.activeReplacements,c)&&(this.activeReplacements=c,!0)}getResolvedImageFromTokens(t){return typeof t=="string"?Gs.build(t):t}populate(t,o,c,d){const m=this.layers[0],g=m.layout,b=this.projection.name==="globe",P=g.get("text-font"),I=g.get("text-field"),O=g.get("icon-image"),[L,k]=g.get("icon-size-scale-range"),$=le(o.scaleFactor||1,L,k),W=(I.value.kind!=="constant"||I.value.value instanceof No&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),Q=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,te=this.hasAnyAppearanceProperty("icon-image"),ne=g.get("symbol-sort-key");if(this.features=[],this.appearanceFeatureData=[],!W&&!Q&&!te)return;const ue=o.iconDependencies,he=o.glyphDependencies,me=o.availableImages,Ae=new mi(this.zoom,{worldview:this.worldview,activeFloors:o.activeFloors}),Pe=Fe=>{const Be=Fe.id.toString();ue.has(Be)?ue.get(Be).push(Fe):ue.set(Be,[Fe])};for(const Fe of t){const{feature:Be,id:Ve,index:at,sourceLayerIndex:Ze}=Fe,ft=m._featureFilter.needGeometry,xt=rt(Be,ft);if(!m._featureFilter.filter(Ae,xt,c))continue;if(ft||(xt.geometry=dt(Be,c,d)),b&&Be.type!==1&&c.z<=5){const At=xt.geometry,jt=.98078528056,It=(dr,_r)=>Br(mn(dr.x,dr.y,c,1),mn(_r.x,_r.y,c,1))<jt;for(let dr=0;dr<At.length;dr++)At[dr]=pt(At[dr],It)}let Ct,Wt;if(W){const At=m.getValueAndResolveTokens("text-field",xt,c,me),jt=No.factory(At);KX(jt)&&(this.hasRTLText=!0),(!this.hasRTLText||zs()==="unavailable"||this.hasRTLText&&da.isParsed())&&(Ct=uX(jt,m,xt))}if(Q){const At=m.getValueAndResolveTokens("icon-image",xt,c,me);Wt=this.getResolvedImageFromTokens(At)}const Rt=this.layers[0];let wt=!1;if(!Wt&&te){const At=Rt.getAppearances();for(const jt of At)if(jt.getProperty("icon-image")){const It=Rt.getAppearanceValueAndResolveTokens(jt,"icon-image",xt,c,me);if(It){Wt=this.getResolvedImageFromTokens(It),wt=!0;break}}}if(!Ct&&!Wt)continue;const Dt=this.sortFeaturesByKey?ne.evaluate(xt,{},c):void 0,ot={id:Ve,text:Ct,icon:Wt,index:at,sourceLayerIndex:Ze,geometry:xt.geometry,properties:Be.properties,type:ZX[Be.type],sortKey:Dt};if(this.features.push(ot),this.appearanceFeatureData.push({id:Ve,properties:Be.properties,usesAppearanceIconAsPlaceholder:wt,isUsingAppearanceVertexData:!1,layoutBasedVertexData:[],activeAppearance:null}),Wt){const At=Rt._unevaluatedLayout._values,{iconPrimary:jt,iconSecondary:It}=Dv(Wt,this.iconSizeData,At["icon-size"],c,this.zoom,ot,this.pixelRatio,$,this.worldview);Pe(jt),It&&(this.hasAnySecondaryIcon=!0,Pe(It))}const it=Rt.getAppearances();if(it.length!==0&&it.forEach((At=>{if(!At.getProperty("icon-image"))return;const jt=this.getCombinedIconPrimary(At,Rt,xt,c,me,ot,$);jt&&Pe(jt)})),Ct){const At=P.evaluate(xt,{},c).join(","),jt=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Hc.vertical)>=0;for(const It of Ct.sections)if(It.image){const dr=It.image.getPrimary().scaleSelf(this.pixelRatio),_r=dr.id.toString(),ir=ue.get(_r)||[];ir.push(dr),ue.set(_r,ir)}else{const dr=eh(Ct.toString()),_r=It.fontStack||At,ir=he[_r]=he[_r]||{};this.calculateGlyphDependencies(It.text,ir,jt,this.allowVerticalPlacement,dr)}}}if(g.get("symbol-placement")==="line"&&(this.features=(function(Fe){const Be={},Ve={},at=[];let Ze=0;function ft(Rt){at.push(Fe[Rt]),Ze++}function xt(Rt,wt,Dt){const ot=Ve[Rt];return delete Ve[Rt],Ve[wt]=ot,at[ot].geometry[0].pop(),at[ot].geometry[0]=at[ot].geometry[0].concat(Dt[0]),ot}function Ct(Rt,wt,Dt){const ot=Be[wt];return delete Be[wt],Be[Rt]=ot,at[ot].geometry[0].shift(),at[ot].geometry[0]=Dt[0].concat(at[ot].geometry[0]),ot}function Wt(Rt,wt,Dt){const ot=Dt?wt[0][wt[0].length-1]:wt[0][0];return`${Rt}:${ot.x}:${ot.y}`}for(let Rt=0;Rt<Fe.length;Rt++){const wt=Fe[Rt],Dt=wt.geometry,ot=wt.text?wt.text.toString():null;if(!ot){ft(Rt);continue}const it=Wt(ot,Dt),At=Wt(ot,Dt,!0);if(it in Ve&&At in Be&&Ve[it]!==Be[At]){const jt=Ct(it,At,Dt),It=xt(it,At,at[jt].geometry);delete Be[it],delete Ve[At],Ve[Wt(ot,at[It].geometry,!0)]=It,at[jt].geometry=null}else it in Ve?xt(it,At,Dt):At in Be?Ct(it,At,Dt):(ft(Rt),Be[it]=Ze-1,Ve[At]=Ze-1)}return at.filter((Rt=>Rt.geometry))})(this.features)),g.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",o.elevationFeatures){!this.elevationFeatures&&o.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Fe of o.elevationFeatures)this.elevationFeatureIdToIndex.set(Fe.id,this.elevationFeatures.length),this.elevationFeatures.push(Fe)}}else g.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort(((Fe,Be)=>Fe.sortKey-Be.sortKey))}getCombinedIconPrimary(t,o,c,d,m,g,b){let P,I;const O=t.getUnevaluatedProperties();if(O._values["icon-image"].value!==void 0){const L=o.getAppearanceValueAndResolveTokens(t,"icon-image",c,d,m);P=this.getResolvedImageFromTokens(L)}else{const L=o.getValueAndResolveTokens("icon-image",c,d,m);P=this.getResolvedImageFromTokens(L)}if(P){const L=O._values["icon-size"]||o._unevaluatedLayout._values["icon-size"];I=Dv(P,N_(this.zoom,L,this.worldview),L,d,this.zoom,g,this.pixelRatio,b,this.worldview).iconPrimary}return I}updateAppearanceBasedIconTextures(t,o,c,d){if(!this.appearanceFeatureData||!this.icon.layoutVertexArray||this.icon.layoutVertexArray.length===0)return!1;const m=this.layers[0];let g=!1,b=0;const P=m.layout,[I,O]=P.get("icon-size-scale-range"),L=le(1,I,O);for(let k=0;k<this.symbolInstances.length;k++){const $=this.symbolInstances.get(k),W=this.appearanceFeatureData[$.featureIndex];if(W&&$.placedIconSymbolIndex>=0){const Q=W.id,te=o&&Q!==void 0?o[String(Q)]:void 0,ne={type:"Point",id:W.id,properties:W.properties,geometry:[]},ue=this.layers[0].appearances&&this.layers[0].appearances.find((he=>he.isActive({globals:d,feature:ne,canonical:t,featureState:te})));if(W.activeAppearance===ue)continue;if(ue){W.activeAppearance=ue;const he={sortKey:void 0,text:void 0,icon:null,index:$.featureIndex,sourceLayerIndex:$.featureIndex,geometry:[],properties:W.properties,type:"Point",id:W.id};if(!ue.hasCachedIconPrimary()){const Fe=this.getCombinedIconPrimary(ue,m,ne,t,c,he,L);ue.setCachedIconPrimary(Fe)}const me=ue.getCachedIconPrimary();if(!me)continue;const Ae=me.toString(),Pe=this.iconAtlasPositions&&this.iconAtlasPositions.get(Ae);if(Pe){const Fe=m.getAppearanceValueAndResolveTokens(ue,"icon-offset",ne,t,c),Be=Fe&&Array.isArray(Fe)?Fe:[0,0];let Ve=ab(Pe,void 0,Be,m.layout.get("icon-anchor").evaluate(ne,{},t));const at=m.getAppearanceValueAndResolveTokens(ue,"icon-rotate",ne,t,c),Ze=typeof at=="number"?at:0,ft=Pe.sdf,xt=m.layout.get("icon-text-fit").constantOr("none");xt!=="none"&&W.textShaping&&W.iconTextFitPadding&&W.fontScale&&(Ve=vT(Ve,W.textShaping,xt,W.iconTextFitPadding,Be,W.fontScale));const Ct=this.calculateEffectiveAppearanceIconSize(ue,d.zoom,ne,t,c,L),Wt=0,Rt=1+(Math.min(bp,Math.round(Ct*gh))<<1),wt=ST(Ve,Ze,ft,xt!=="none",L);W.isUsingAppearanceVertexData||(W.isUsingAppearanceVertexData=!0,W.layoutBasedVertexData=this.icon.getIconVertexData(b,$.numIconVertices));for(let ot=0;ot<wt.length;++ot){const it=wt[ot],At=W.layoutBasedVertexData[0]||$.tileAnchorX,jt=W.layoutBasedVertexData[1]||$.tileAnchorY,It=16*it.pixelOffsetTL.x,dr=16*it.pixelOffsetTL.y,_r=16*it.pixelOffsetBR.x,ir=16*it.pixelOffsetBR.y,Jt=16*it.minFontScaleX,Hr=16*it.minFontScaleY;this.icon.updateIconVertexData(b,At,jt,Math.round(32*it.tl.x),Math.round(32*it.tl.y),it.texPrimary.x,it.texPrimary.y,Wt,Rt,It,dr,Jt,Hr),this.icon.updateIconVertexData(b+1,At,jt,Math.round(32*it.tr.x),Math.round(32*it.tr.y),it.texPrimary.x+it.texPrimary.w,it.texPrimary.y,Wt,Rt,_r,dr,Jt,Hr),this.icon.updateIconVertexData(b+2,At,jt,Math.round(32*it.bl.x),Math.round(32*it.bl.y),it.texPrimary.x,it.texPrimary.y+it.texPrimary.h,Wt,Rt,It,ir,Jt,Hr),this.icon.updateIconVertexData(b+3,At,jt,Math.round(32*it.br.x),Math.round(32*it.br.y),it.texPrimary.x+it.texPrimary.w,it.texPrimary.y+it.texPrimary.h,Wt,Rt,_r,ir,Jt,Hr),b+=4}const Dt=$.numIconVertices-4*wt.length;for(let ot=0;ot<Dt;++ot)this.icon.updateIconVertexData(b+ot,0,0,0,0,0,0,0,0,0,0,0,0);g=!0}else b+=$.numIconVertices}else if(W.usesAppearanceIconAsPlaceholder)this.layers[0].appearances&&this.layers[0].appearances.length>0&&(this.icon.updateIconVertexData(b,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateIconVertexData(b+1,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateIconVertexData(b+2,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateIconVertexData(b+3,0,0,0,0,0,0,0,0,0,0,0,0),g=!0),b+=$.numIconVertices,W.activeAppearance=null;else if(W.isUsingAppearanceVertexData){const me=W.layoutBasedVertexData.length/12;for(let Ae=0;Ae<me;++Ae){const Pe=Ae*12;this.icon.updateIconVertexData(b+Ae,W.layoutBasedVertexData[Pe+0],W.layoutBasedVertexData[Pe+1],W.layoutBasedVertexData[Pe+2],W.layoutBasedVertexData[Pe+3],W.layoutBasedVertexData[Pe+4],W.layoutBasedVertexData[Pe+5],W.layoutBasedVertexData[Pe+6],W.layoutBasedVertexData[Pe+7],W.layoutBasedVertexData[Pe+8],W.layoutBasedVertexData[Pe+9],W.layoutBasedVertexData[Pe+10],W.layoutBasedVertexData[Pe+11])}b+=me,W.isUsingAppearanceVertexData=!1,W.activeAppearance=null,g=!0}else b+=$.numIconVertices,W.activeAppearance=null}}return g}update(t,o,c,d,m,g,b){this.text.programConfigurations.updatePaintArrays(t,o,m,c,d,g,b,this.worldview),this.icon.programConfigurations.updatePaintArrays(t,o,m,c,d,g,b,this.worldview)}updateRoadElevation(t){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;const c=De(t),d=1/c;let m=!1,g=!1;for(let b=0;b<this.symbolInstances.length;b++){const P=this.symbolInstances.get(b),I=or(1,0,0),O=or(0,1,0),{numHorizontalGlyphVertices:L,numVerticalGlyphVertices:k,numIconVertices:$,numVerticalIconVertices:W}=P,Q=L>0||k>0,te=$>0,ne=this.elevationFeatures[P.elevationFeatureIndex];if(ne){const ue=new St(P.tileAnchorX,P.tileAnchorY),he=.075+ne.pointElevation(ue);P.zOffset!==he&&(o=!0,P.zOffset=he),he!==0&&(this.hasAnyZOffset=!0);const me=ne.computeSlopeNormal(ue,d),Ae=Al(ra(),or(0,0,1),me);Si(I,I,Ae),Si(O,O,Ae),I[2]*=c,O[2]*=c,I[0]===1&&I[1]===0&&I[2]===0&&O[0]===0&&O[1]===1&&O[2]===0||(m=m||Q,g=g||te)}if(Q&&(gb(this.text.orientationVertexArray,L,I,O),gb(this.text.orientationVertexArray,k,I,O)),te){const{placedIconSymbolIndex:ue,verticalPlacedIconSymbolIndex:he}=P;ue>=0&&gb(this.icon.orientationVertexArray,$,I,O),he>=0&&gb(this.icon.orientationVertexArray,W,I,O)}}m||(this.text.orientationVertexArray=void 0),g||(this.icon.orientationVertexArray=void 0),o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const t=(m,g,b)=>{c+=g,c>m.length&&m.resize(c);for(let P=-g;P<0;P++)m.emplace(P+c,b)},o=(m,g,b)=>{d+=g,d>m.length&&m.resize(d);for(let P=-g;P<0;P++)m.emplace(P+d,b)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,d=0;for(let m=0;m<this.symbolInstances.length;m++){const g=this.symbolInstances.get(m),{numHorizontalGlyphVertices:b,numVerticalGlyphVertices:P,numIconVertices:I}=g,O=g.zOffset,L=I>0;if((b>0||P>0)&&(t(this.text.zOffsetVertexArray,b,O),t(this.text.zOffsetVertexArray,P,O)),L){const{placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:$}=g;k>=0&&o(this.icon.zOffsetVertexArray,I,O),$>=0&&o(this.icon.zOffsetVertexArray,g.numVerticalIconVertices,O)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t,o,c,d,m){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload,!1),this.hasAppearances===null&&(this.hasAppearances=this.layers.some((g=>g.appearances&&g.appearances.length>0))),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload,this.hasAppearances),this.uploaded=!0}updateAppearances(t,o,c,d){return!!(t&&o&&c)&&!(!this.icon.layoutVertexArray||this.icon.layoutVertexArray.length===0)&&!!this.icon.layoutVertexArray.arrayBuffer&&void(this.updateAppearanceBasedIconTextures(t,o,c,d)&&this.icon.layoutVertexBuffer&&this.icon.layoutVertexArray.arrayBuffer!==null&&this.icon.layoutVertexArray.length===this.icon.layoutVertexBuffer.length&&this.icon.layoutVertexBuffer.updateData(this.icon.layoutVertexArray))}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=bF(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const c=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:d,y:m}of o)this.lineVertexArray.emplaceBack(d,m);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q,te,ne,ue){const he=t.indexArray,me=t.layoutVertexArray,Ae=t.globeExtVertexArray,Pe=t.segments.prepareSegment(4*ue,me,he,this.canOverlap?g.sortKey:void 0),Fe=this.glyphOffsetArray.length,Be=Pe.vertexLength,Ve=this.allowVerticalPlacement&&b===Hc.vertical?Math.PI/2:0,at=g.text&&g.text.sections;for(let xt=0;xt<o.length;xt++){const{tl:Ct,tr:Wt,bl:Rt,br:wt,texPrimary:Dt,texSecondary:ot,pixelOffsetTL:it,pixelOffsetBR:At,minFontScaleX:jt,minFontScaleY:It,glyphOffset:dr,isSDF:_r,sectionIndex:ir}=o[xt],Jt=Pe.vertexLength,Hr=dr[1];if(Bv(me,I.x,I.y,Ct.x,Hr+Ct.y,Dt.x,Dt.y,c,_r,it.x,it.y,jt,It),Bv(me,I.x,I.y,Wt.x,Hr+Wt.y,Dt.x+Dt.w,Dt.y,c,_r,At.x,it.y,jt,It),Bv(me,I.x,I.y,Rt.x,Hr+Rt.y,Dt.x,Dt.y+Dt.h,c,_r,it.x,At.y,jt,It),Bv(me,I.x,I.y,wt.x,Hr+wt.y,Dt.x+Dt.w,Dt.y+Dt.h,c,_r,At.x,At.y,jt,It),P){const{x:rr,y:Rr,z:Qr}=P.anchor,[gn,kn,tn]=P.up;Nv(Ae,rr,Rr,Qr,gn,kn,tn),Nv(Ae,rr,Rr,Qr,gn,kn,tn),Nv(Ae,rr,Rr,Qr,gn,kn,tn),Nv(Ae,rr,Rr,Qr,gn,kn,tn),q_(t.dynamicLayoutVertexArray,rr,Rr,Qr,Ve)}else q_(t.dynamicLayoutVertexArray,I.x,I.y,I.z,Ve);if(te){const rr=ot||Dt;jv(t.iconTransitioningVertexArray,rr.x,rr.y),jv(t.iconTransitioningVertexArray,rr.x+rr.w,rr.y),jv(t.iconTransitioningVertexArray,rr.x,rr.y+rr.h),jv(t.iconTransitioningVertexArray,rr.x+rr.w,rr.y+rr.h)}he.emplaceBack(Jt,Jt+1,Jt+2),he.emplaceBack(Jt+1,Jt+2,Jt+3),Pe.vertexLength+=4,Pe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(dr[0]),xt!==o.length-1&&ir===o[xt+1].sectionIndex||t.programConfigurations.populatePaintArrays(me.length,g,g.index,{},$,W,Q,at&&at[ir],this.worldview)}const Ze=ue-o.length;Ze!==0&&this._addNullVertices(Ze,me,c,P,Ae,t,te,Pe,he);const ft=P?P.anchor:I;t.placedSymbolArray.emplaceBack(ft.x,ft.y,ft.z,I.x,I.y,Fe,this.glyphOffsetArray.length-Fe,Be,O,L,I.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],b,0,0,0,k,0),t.symbolInstanceIndices.push(ne)}_addNullVertices(t,o,c,d,m,g,b,P,I){for(let O=0;O<t;O++){for(let k=0;k<4;k++)Bv(o,0,0,0,0,0,0,c,!1,0,0,0,0),d&&Nv(m,0,0,0,0,0,0),q_(g.dynamicLayoutVertexArray,0,0,0,0),b&&jv(g.iconTransitioningVertexArray,0,0);const L=P.vertexLength;I.emplaceBack(L,L+1,L+2),I.emplaceBack(L+1,L+2,L+3),P.vertexLength+=4,P.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(0)}}_commitLayoutVertex(t,o,c,d,m,g,b){t.emplaceBack(o,c,d,m,g,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(t,o,c,d,m,g,b){const P=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),I=P.vertexLength,O=b.tileAnchorX,L=b.tileAnchorY;for(let $=0;$<4;$++)c.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,o,t.padding,b.zOffset),this._commitLayoutVertex(c.layoutVertexArray,d,m,g,O,L,new St(t.x1,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,m,g,O,L,new St(t.x2,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,m,g,O,L,new St(t.x2,t.y2)),this._commitLayoutVertex(c.layoutVertexArray,d,m,g,O,L,new St(t.x1,t.y2)),P.vertexLength+=4;const k=c.indexArray;k.emplaceBack(I,I+1),k.emplaceBack(I+1,I+2),k.emplaceBack(I+2,I+3),k.emplaceBack(I+3,I),P.primitiveLength+=4}_addTextDebugCollisionBoxes(t,o,c,d,m,g){for(let b=d;b<m;b++){const P=c.get(b),I=this.getSymbolInstanceTextSize(t,g,o,b);this._addCollisionDebugVertices(P,I,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(t,o,c,d,m,g){for(let b=d;b<m;b++){const P=c.get(b),I=this.getSymbolInstanceIconSize(t,o,g.placedIconSymbolIndex);this._addCollisionDebugVertices(P,I,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,g)}}generateCollisionDebugBuffers(t,o,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new CT(pm,Bz.members,Hl),this.iconCollisionBox=new CT(pm,Bz.members,Hl);const d=V_(this.iconSizeData,t),m=V_(this.textSizeData,t,c);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(m,t,o,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(m,t,o,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(d,t,o,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(d,t,o,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(t,o,c,d){const m=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:d),g=xT(this.textSizeData,t,m)/pa;return this.tilePixelRatio*g}getSymbolInstanceIconSize(t,o,c){const d=this.icon.placedSymbolArray.get(c),m=xT(this.iconSizeData,t,d);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(t,o,c,d){t.emplaceBack(o,-c,-c,d),t.emplaceBack(o,c,-c,d),t.emplaceBack(o,c,c,d),t.emplaceBack(o,-c,c,d)}_updateTextDebugCollisionBoxes(t,o,c,d,m,g,b){for(let P=d;P<m;P++){const I=c.get(P),O=this.getSymbolInstanceTextSize(t,g,o,P);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,O,I.padding,g.zOffset)}}_updateIconDebugCollisionBoxes(t,o,c,d,m,g,b){for(let P=d;P<m;P++){const I=c.get(P),O=this.getSymbolInstanceIconSize(t,o,g.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,O,I.padding,g.zOffset)}}updateCollisionDebugBuffers(t,o,c,d){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=V_(this.iconSizeData,t,d),g=V_(this.textSizeData,t,c);for(let b=0;b<this.symbolInstances.length;b++){const P=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(g,t,o,P.textBoxStartIndex,P.textBoxEndIndex,P,c),this._updateTextDebugCollisionBoxes(g,t,o,P.verticalTextBoxStartIndex,P.verticalTextBoxEndIndex,P,c),this._updateIconDebugCollisionBoxes(m,t,o,P.iconBoxStartIndex,P.iconBoxEndIndex,P,d),this._updateIconDebugCollisionBoxes(m,t,o,P.verticalIconBoxStartIndex,P.verticalIconBoxEndIndex,P,d)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,o,c,d,m,g,b,P,I){const O={};if(o<c){const{x1:L,y1:k,x2:$,y2:W,padding:Q,projectedAnchorX:te,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:he,tileAnchorY:me,featureIndex:Ae}=t.get(o);O.textBox={x1:L,y1:k,x2:$,y2:W,padding:Q,projectedAnchorX:te,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:he,tileAnchorY:me},O.textFeatureIndex=Ae}if(d<m){const{x1:L,y1:k,x2:$,y2:W,padding:Q,projectedAnchorX:te,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:he,tileAnchorY:me,featureIndex:Ae}=t.get(d);O.verticalTextBox={x1:L,y1:k,x2:$,y2:W,padding:Q,projectedAnchorX:te,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:he,tileAnchorY:me},O.verticalTextFeatureIndex=Ae}if(g<b){const{x1:L,y1:k,x2:$,y2:W,padding:Q,projectedAnchorX:te,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:he,tileAnchorY:me,featureIndex:Ae}=t.get(g);O.iconBox={x1:L,y1:k,x2:$,y2:W,padding:Q,projectedAnchorX:te,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:he,tileAnchorY:me},O.iconFeatureIndex=Ae}if(P<I){const{x1:L,y1:k,x2:$,y2:W,padding:Q,projectedAnchorX:te,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:he,tileAnchorY:me,featureIndex:Ae}=t.get(P);O.verticalIconBox={x1:L,y1:k,x2:$,y2:W,padding:Q,projectedAnchorX:te,projectedAnchorY:ne,projectedAnchorZ:ue,tileAnchorX:he,tileAnchorY:me},O.verticalIconFeatureIndex=Ae}return O}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,o){const c=t.placedSymbolArray.get(o),d=c.vertexStartIndex+4*c.numGlyphs;for(let m=c.vertexStartIndex;m<d;m+=4)t.indexArray.emplaceBack(m,m+1,m+2),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),c=Math.cos(t),d=[],m=[],g=[];for(let b=0;b<this.symbolInstances.length;++b){g.push(b);const P=this.symbolInstances.get(b);d.push(0|Math.round(o*P.tileAnchorX+c*P.tileAnchorY)),m.push(P.featureIndex)}return g.sort(((b,P)=>d[b]-d[P]||m[P]-m[b])),g}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((t,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(t).zOffset))}addToSortKeyRanges(t,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:I}=c;d>=0&&this.addIndicesForPlacedSymbol(this.text,d),m>=0&&m!==d&&this.addIndicesForPlacedSymbol(this.text,m),g>=0&&g!==m&&g!==d&&this.addIndicesForPlacedSymbol(this.text,g),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}getElevationFeatureForText(t){const o=this.symbolInstances.get(this.text.symbolInstanceIndices[t]).elevationFeatureIndex;let c;return this.elevationFeatures&&o<this.elevationFeatures.length&&(c=this.elevationFeatures[o]),c}}function wF(s,t){return t.replace(/{([^{}]+)}/g,((o,c)=>c in s?String(s[c]):""))}let SF,TF,AT;cr(_b,"SymbolBucket",{omit:["layers","collisionBoxArray","compareText","features"]}),_b.addDynamicAttributes=q_;class EF{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ac,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}cr(EF,"FormatSectionOverride",{omit:["defaultValue"]});const DT=()=>AT||(AT={layout:SF||(SF=new to({"symbol-placement":new zt(Ye.layout_symbol["symbol-placement"]),"symbol-spacing":new zt(Ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zt(Ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new tr(Ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zt(Ye.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new zt(Ye.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new zt(Ye.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new zt(Ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new zt(Ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new zt(Ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zt(Ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new tr(Ye.layout_symbol["icon-size"]),"icon-size-scale-range":new zt(Ye.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new tr(Ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tr(Ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new tr(Ye.layout_symbol["icon-image"]),"icon-image-use-theme":new zt({type:"string",default:"default","property-type":"data-constant"}),"icon-rotate":new tr(Ye.layout_symbol["icon-rotate"]),"icon-padding":new zt(Ye.layout_symbol["icon-padding"]),"icon-keep-upright":new zt(Ye.layout_symbol["icon-keep-upright"]),"icon-offset":new tr(Ye.layout_symbol["icon-offset"]),"icon-anchor":new tr(Ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zt(Ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zt(Ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zt(Ye.layout_symbol["text-rotation-alignment"]),"text-field":new tr(Ye.layout_symbol["text-field"]),"text-font":new tr(Ye.layout_symbol["text-font"]),"text-size":new tr(Ye.layout_symbol["text-size"]),"text-size-scale-range":new zt(Ye.layout_symbol["text-size-scale-range"]),"text-max-width":new tr(Ye.layout_symbol["text-max-width"]),"text-line-height":new tr(Ye.layout_symbol["text-line-height"]),"text-letter-spacing":new tr(Ye.layout_symbol["text-letter-spacing"]),"text-justify":new tr(Ye.layout_symbol["text-justify"]),"text-radial-offset":new tr(Ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zt(Ye.layout_symbol["text-variable-anchor"]),"text-anchor":new tr(Ye.layout_symbol["text-anchor"]),"text-max-angle":new zt(Ye.layout_symbol["text-max-angle"]),"text-writing-mode":new zt(Ye.layout_symbol["text-writing-mode"]),"text-rotate":new tr(Ye.layout_symbol["text-rotate"]),"text-padding":new zt(Ye.layout_symbol["text-padding"]),"text-keep-upright":new zt(Ye.layout_symbol["text-keep-upright"]),"text-transform":new tr(Ye.layout_symbol["text-transform"]),"text-offset":new tr(Ye.layout_symbol["text-offset"]),"text-allow-overlap":new zt(Ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new zt(Ye.layout_symbol["text-ignore-placement"]),"text-optional":new zt(Ye.layout_symbol["text-optional"]),visibility:new zt(Ye.layout_symbol.visibility)})),paint:TF||(TF=new to({"icon-opacity":new tr(Ye.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new tr(Ye.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new tr(Ye.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new tr(Ye.paint_symbol["text-emissive-strength"]),"icon-color":new tr(Ye.paint_symbol["icon-color"]),"icon-halo-color":new tr(Ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new tr(Ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new tr(Ye.paint_symbol["icon-halo-blur"]),"icon-translate":new zt(Ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new zt(Ye.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new zt(Ye.paint_symbol["icon-image-cross-fade"]),"text-opacity":new tr(Ye.paint_symbol["text-opacity"]),"text-occlusion-opacity":new tr(Ye.paint_symbol["text-occlusion-opacity"]),"text-color":new tr(Ye.paint_symbol["text-color"],{runtimeType:aa,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new tr(Ye.paint_symbol["text-halo-color"]),"text-halo-width":new tr(Ye.paint_symbol["text-halo-width"]),"text-halo-blur":new tr(Ye.paint_symbol["text-halo-blur"]),"text-translate":new zt(Ye.paint_symbol["text-translate"]),"text-translate-anchor":new zt(Ye.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new zt(Ye.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new zt(Ye.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new zt(Ye.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new zt(Ye.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new tr(Ye.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},AT);class yb extends Ia{constructor(t,o,c,d){super(t,DT(),o,c,d,t.layout?t.layout["icon-image-use-theme"]:null),this._colorAdjustmentMatrix=J([]),this.hasOcclusionOpacityProperties=t.paint!==void 0&&("icon-occlusion-opacity"in t.paint||"text-occlusion-opacity"in t.paint)}_handleSpecialPaintPropertyUpdate(t){t!=="icon-occlusion-opacity"&&t!=="text-occlusion-opacity"||(this.hasOcclusionOpacityProperties=!0)}recalculate(t,o){super.recalculate(t,o),this.appearances&&this.appearances.forEach((d=>{d.recalculate(t,o,this.iconImageUseTheme)})),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const d=[];for(const m of c)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(t,o,c,d){return this._saturation===t&&this._contrast===o&&this._brightnessMin===c&&this._brightnessMax===d||(this._colorAdjustmentMatrix=(function(m,g,b,P){m=Ei(m),g=fi(g);const I=H(),O=m/3,L=1-2*O,k=[L,O,O,0,O,L,O,0,O,O,L,0,0,0,0,1],$=.5-.5*g,W=P-b;return pe(I,[W,0,0,0,0,W,0,0,0,0,W,0,b,b,b,1],[g,0,0,0,0,g,0,0,0,0,g,0,$,$,$,1]),pe(I,I,k),I})(t,o,c,d),this._saturation=t,this._contrast=o,this._brightnessMin=c,this._brightnessMax=d),this._colorAdjustmentMatrix}getValueAndResolveTokens(t,o,c,d){const m=this.layout.get(t).evaluate(o,{},c,d),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||Kh(g.value)||!m?m:wF(o.properties,m)}getAppearanceValueAndResolveTokens(t,o,c,d,m){const g=t.getProperty(o);if(!g)return;const b=g.evaluate(c,{},d,m),P=t.getUnevaluatedProperties()._values[o];return P.isDataDriven()||Kh(P.value)||!b||typeof b!="string"?b:wF(c.properties,b)}createBucket(t){return new _b(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of DT().paint.overridableProperties){if(!yb.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),c=new EF(o),d=new Xh(c,o.property.specification,this.scope,this.options,this.layout.get("icon-image-use-theme"));let m=null;m=o.value.kind==="constant"||o.value.kind==="source"?new Va("source",d):new xl("composite",d,o.value.zoomStops,o.value.interpolationType),this.paint._values[t]=new ns(o.property,m,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&yb.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const c=t.get("text-field"),d=DT().paint.properties[o];let m=!1;const g=b=>{for(const P of b)if(d.overrides&&d.overrides.hasOverride(P))return void(m=!0)};if(c.value.kind==="constant"&&c.value.value instanceof No)g(c.value.value.sections);else if(c.value.kind==="source"){const b=I=>{m||(I instanceof pl&&fo(I.value)===Lc?g(I.value.sections):I instanceof cc?g(I.sections):I.eachChild(b))},P=c.value;P._styleExpression&&b(P._styleExpression.expression)}return m}getProgramIds(){return["symbol"]}getDefaultProgramParams(t,o,c){return{config:new qu(this,{zoom:o,lut:c}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let PF,IF,MF,CF;var RT=pn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function vb(s,t,o,c,d,m,g,b){const P=[s,t,1,o,c,1,d,m,1],I=[g,b,1],O=V([],P),[L,k,$]=Un(I,I,O);return G(P,P,[L,0,0,0,k,0,0,0,$])}function AF(s,t,o,c,d,m,g,b){const P=(function(I,O,L,k,$,W,Q,te){const ne=vb(0,0,1,0,1,1,0,1),ue=vb(I,O,L,k,$,W,Q,te);return G(ue,ue,V([],ne))})(s,t,o,c,d,m,g,b);return[P[2]/P[8]/Ut,P[5]/P[8]/Ut]}function xb(s){return[s[0],Math.min(Math.max(s[1],-xe),xe)]}class DF extends sa{constructor(t,o,c,d){super(),this.id=t,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(d),this.options=o,this._dirty=!1}load(t,o){if(this._loaded=o||!1,this.fire(new eo("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Ge(this.map._requestManager.transformRequest(this.url,ms.Image),((c,d)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new Yo(c)):d&&(this.image=d instanceof HTMLImageElement?Ds.getImageData(d):d,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Tv(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new eo("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(t){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Tv||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=t[0][1],c=t[0][1];for(const m of t)m[1]>c&&(c=m[1]),m[1]<o&&(o=m[1]);const d=(c+o)/2;if(d>xe?this.onNorthPole=!0:d<-xe&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=t.map(He.fromLngLat);this.tileID=(function(g){let b=1/0,P=1/0,I=-1/0,O=-1/0;for(const Q of g)b=Math.min(b,Q.x),P=Math.min(P,Q.y),I=Math.max(I,Q.x),O=Math.max(O,Q.y);const L=Math.max(I-b,O-P),k=Math.max(0,Math.floor(-Math.log2(L))),$=Math.pow(2,k);let W=Math.floor((b+I)/2*$);return W>1&&(W-=1),new S(k,W,Math.floor((P+O)/2*$))})(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new eo("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof Tv||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(t){for(const ne in this.tiles){const ue=this.tiles[ne];ue.state!=="loaded"&&(ue.state="loaded",ue.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Ov(new S(0,0,0),this.map.transform.projection),c=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!(function(ne){const ue=ne[1].x-ne[0].x,he=ne[1].y-ne[0].y,me=ne[2].x-ne[1].x,Ae=ne[2].y-ne[1].y,Pe=ne[3].x-ne[2].x,Fe=ne[3].y-ne[2].y,Be=ne[0].x-ne[3].x,Ve=ne[0].y-ne[3].y,at=ue*Ae-me*he,Ze=me*Fe-Pe*Ae,ft=Pe*Ve-Be*Fe,xt=Be*he-ue*Ve;return at>0&&Ze>0&&ft>0&&xt>0||at<0&&Ze<0&&ft<0&&xt<0})(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const d=Ov(this.tileID,this.map.transform.projection),[m,g,b,P]=this.coordinates.map((ne=>{const ue=d.projection.project(ne[0],ne[1]);return gF(d,ue)._round()}));this.perspectiveTransform=AF(m.x,m.y,g.x,g.y,b.x,b.y,P.x,P.y);const I=this._boundsArray=new $a;I.emplaceBack(m.x,m.y,0,0),I.emplaceBack(g.x,g.y,Ut,0),I.emplaceBack(P.x,P.y,0,Ut),I.emplaceBack(b.x,b.y,Ut,Ut),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=t.createVertexBuffer(I,RT.members),this.boundsSegments=Wn.simpleSegment(0,0,4,2);const O=[],L=[xb((k=this.coordinates)[0]),xb(k[1]),xb(k[2]),xb(k[3])];var k;const[$,W,Q,te]=(function(ne){let ue=ne[0][0],he=ue,me=ne[0][1],Ae=me;for(let Pe=1;Pe<ne.length;Pe++)ne[Pe][0]<ue?ue=ne[Pe][0]:ne[Pe][0]>he&&(he=ne[Pe][0]),ne[Pe][1]<me?me=ne[Pe][1]:ne[Pe][1]>Ae&&(Ae=ne[Pe][1]);return[ue,me,he-ue,Ae-me]})(L);{const ne=new $a,[ue,he,me,Ae]=(function(wt){let Dt=wt[0].x,ot=Dt,it=wt[0].y,At=it;for(let jt=1;jt<wt.length;jt++)wt[jt].x<Dt?Dt=wt[jt].x:wt[jt].x>ot&&(ot=wt[jt].x),wt[jt].y<it?it=wt[jt].y:wt[jt].y>At&&(At=wt[jt].y);return[Dt,it,ot-Dt,At-it]})(c),Pe=wt=>[(wt.x-ue)/me,(wt.y-he)/Ae],[Fe,Be,Ve,at]=c.map(Pe),Ze=(function(wt,Dt,ot,it,At,jt,It,dr){const _r=vb(0,0,1,0,1,1,0,1);return G(_r,_r,V([],vb(wt,Dt,ot,it,At,jt,It,dr)))})(Fe[0],Fe[1],Be[0],Be[1],Ve[0],Ve[1],at[0],at[1]);this.elevatedGlobePerspectiveTransform=AF(Fe[0],Fe[1],Be[0],Be[1],Ve[0],Ve[1],at[0],at[1]);const ft=(wt,Dt)=>{O.push(wt.lng);const ot=Math.round((wt.lng-$)/Q*Ut),it=Math.round((wt.lat-W)/te*Ut),At=Pe(Dt),jt=Un([],[At[0],At[1],1],Ze),It=Math.round(jt[0]/jt[2]*Ut),dr=Math.round(jt[1]/jt[2]*Ut);ne.emplaceBack(ot,it,It,dr)},xt=c[3].x-c[0].x,Ct=c[3].y-c[0].y,Wt=c[2].x-c[1].x,Rt=c[2].y-c[1].y;for(let wt=0;wt<65;wt++){const Dt=wt/64,ot=[c[0].x+Dt*xt,c[0].y+Dt*Ct],it=[c[1].x+Dt*Wt,c[1].y+Dt*Rt],At=it[0]-ot[0],jt=it[1]-ot[1];for(let It=0;It<65;It++){const dr=It/64,_r={x:ot[0]+At*dr,y:ot[1]+jt*dr};ft(o.projection.unproject(_r.x,_r.y),_r)}}this.elevatedGlobeVertexBuffer=t.createVertexBuffer(ne,RT.members)}{this.maxLongitudeTriangleSize=0;let ne=[],ue=new Li;const he=(me,Ae,Pe)=>{ue.emplaceBack(me,Ae,Pe);const Fe=O[me],Be=O[Ae],Ve=O[Pe],at=Math.min(Math.min(Fe,Be),Ve),Ze=Math.max(Math.max(Fe,Be),Ve)-at;Ze>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ze),ne.push(at+Ze/2)};for(let me=0;me<64;me++)for(let Ae=0;Ae<64;Ae++){const Pe=65*me+Ae,Fe=Pe+1,Be=Pe+65,Ve=Be+1;he(Pe,Be,Fe),he(Fe,Be,Ve)}[ne,ue]=(function(me,Ae){const Pe=Array.from({length:me.length},((Ve,at)=>at));Pe.sort(((Ve,at)=>me[Ve]-me[at]));const Fe=[],Be=new Li;for(let Ve=0;Ve<Pe.length;Ve++){const at=Pe[Ve];Fe.push(me[at]);const Ze=3*at,ft=Ze+1;Be.emplaceBack(Ae.uint16[Ze],Ae.uint16[ft],Ae.uint16[ft+1])}return[Fe,Be]})(ne,ue),this.elevatedGlobeTrianglesCenterLongitudes=ne,this.elevatedGlobeIndexBuffer=t.createIndexBuffer(ue)}this.elevatedGlobeSegments=Wn.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,Q/Ut,0,te/Ut,0,0,W,$,0])}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const o=this.map.painter.context,c=o.gl;!this._dirty||this.texture instanceof Tv||(this.texture?this.texture.update(this.image):(this.texture=new iT(o,this.image,c.RGBA8),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(o)}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let d=(m=t+180)+360*Math.round((c[0]-m)/360);var m;const g=new Wn,b=(L,k)=>{g.segments.push({vertexOffset:0,primitiveOffset:L,vertexLength:o.segments[0].vertexLength,primitiveLength:k,sortKey:void 0,vaos:{}})},P=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-d)<=P){const L=rn(c,0,c.length,d+P);return L===c.length||b(L,Ln(c,L+1,c.length,d+360-P)-L),g}d<c[0]&&(d+=360);const I=Ln(c,0,c.length,d-P);if(I===c.length)return b(0,c.length),g;b(0,I-0);const O=rn(c,I+1,c.length,d+P);return O!==c.length&&b(O,c.length-O),g}}const QX=(Math.pow(256,2)-1)/16907520;class RF extends Ia{constructor(t,o,c,d){super(t,{layout:MF||(MF=new to({visibility:new zt(Ye.layout_raster.visibility)})),paint:CF||(CF=new to({"raster-opacity":new zt(Ye.paint_raster["raster-opacity"]),"raster-color":new th(Ye.paint_raster["raster-color"]),"raster-color-mix":new zt(Ye.paint_raster["raster-color-mix"]),"raster-color-range":new zt(Ye.paint_raster["raster-color-range"]),"raster-hue-rotate":new zt(Ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zt(Ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zt(Ye.paint_raster["raster-brightness-max"]),"raster-saturation":new zt(Ye.paint_raster["raster-saturation"]),"raster-contrast":new zt(Ye.paint_raster["raster-contrast"]),"raster-resampling":new zt(Ye.paint_raster["raster-resampling"]),"raster-fade-duration":new zt(Ye.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new zt(Ye.paint_raster["raster-emissive-strength"]),"raster-array-band":new zt(Ye.paint_raster["raster-array-band"]),"raster-elevation":new zt(Ye.paint_raster["raster-elevation"]),"raster-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},o,c,d),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(t){return!(t&&t._source instanceof DF&&(t._source.onNorthPole||t._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(t){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[c,d]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(d)||c===this._curRampRange[0]&&d===this._curRampRange[1]||(this.colorRamp=cv({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:d}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[c,d])}}let OF,LF,zF,FF,kF;class BF extends Ia{constructor(t,o,c,d){super(t,{layout:OF||(OF=new to({visibility:new zt(Ye["layout_raster-particle"].visibility)})),paint:LF||(LF=new to({"raster-particle-array-band":new zt(Ye["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new zt(Ye["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new th(Ye["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new zt(Ye["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new zt(Ye["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new zt(Ye["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new zt(Ye["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new zt(Ye["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},o,c,d),this._updateColorRamp(),this.lastInvalidatedAt=Ds.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(t){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){t!=="raster-particle-color"&&t!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),t==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=cv({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ds.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class JX extends Ia{constructor(t,o){super(t,{},o,null),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(t){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}function OT(s,t,o){const c=[0,0,1],d=va([]);return Bs(d,d,o?-vn(s)+Math.PI:vn(s)),xa(d,d,-vn(t)),Si(c,c,d),sr(c,c)}const jF={None:0,Model:1,Symbol:2,FillExtrusion:4};class bb{constructor(t,o,c,d){this.message=(t?`${t}: `:"")+c,d&&(this.identifier=d),o!=null&&o.__line__&&(this.line=o.__line__)}}function LT(s,t){const o=s.indexOf("://")===-1;try{return new URL(s,o&&t?"http://example.com":void 0),!0}catch{return!1}}class NF{constructor(t,o){this.feature=t,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class VF{constructor(){this.maxScale=1,this.maxXYTranslationDistance=0,this.instancedDataArray=new lf,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}colorForInstance(t){const o=16*t,c=this.instancedDataArray.float32;let d=Math.floor(c[o+2]);const m=1.05*(c[o+2]-d);return d/=100,[c[o]%1*1.05,c[o+1]%1*1.05,m,d]}tileCoordinatesForInstance(t){const o=16*t,c=this.instancedDataArray.float32;let d=c[o+0];return d=d>Ut?d-Ut:d,new St(Math.trunc(d),Math.trunc(c[o+1]))}translationForInstance(t){const o=16*t,c=this.instancedDataArray.float32;return[c[o+4],c[o+5],c[o+6]]}rotationScaleForInstance(t){const o=16*t,c=this.instancedDataArray.float32;return[c[o+7],c[o+8],c[o+9],c[o+10],c[o+11],c[o+12],c[o+13],c[o+14],c[o+15]]}transformForInstance(t){const o=16*t,c=this.instancedDataArray.float32;return[c[o+7],c[o+8],c[o+9],c[o+4],c[o+10],c[o+11],c[o+12],c[o+5],c[o+13],c[o+14],c[o+15],c[o+6],0,0,0,1]}}class zT{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaledZ=this.canonical.z+Math.log2(t.overscaling),this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.projection=t.projection,this.index=t.index,this.worldview=t.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z+1?0:this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=t.styleDefinedModelURLs,this.hasAppearances=null}updateFootprints(t,o){}updateAppearances(t,o,c,d){}populate(t,o,c,d){this.tileToMeter=De(c);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:g,id:b,index:P,sourceLayerIndex:I}of t){const O=b??(g.properties&&g.properties.hasOwnProperty("id")?g.properties.id:void 0),L=rt(g,m);if(!this.layers[0]._featureFilter.filter(new mi(this.zoom,{worldview:this.worldview,activeFloors:o.activeFloors}),L,c))continue;const k={id:O,sourceLayerIndex:I,index:P,geometry:m?L.geometry:dt(g,c,d),properties:g.properties,type:g.type,patterns:{}},$=this.addFeature(k,k.geometry,L);$&&o.featureIndex.insert(g,k.geometry,P,I,this.index,this.instancesPerModel[$].instancedDataArray.length,Ut/32)}this.lookup=null}evaluateQueryRenderedFeaturePadding(){const t=this.layers[0].modelManager,o=this.layers[0].scope;let c=0;for(const d of this.modelUris){const m=t.getModel(d,o);if(!m)continue;const g=this.instancesPerModel[d];if(g){const b=.5*bt(m.aabb.max,m.aabb.min)*g.maxScale+g.maxXYTranslationDistance,P=Math.min(Ut,Math.max(b/this.tileToMeter,Ut/32));c=Math.max(P,c)}}return c}update(t,o,c,d){for(const m in this.instancesPerModel){const g=this.instancesPerModel[m];for(const b in t)g.idToFeaturesIndex.hasOwnProperty(b)&&(this.evaluate(g.features[g.idToFeaturesIndex[b]],t[b],g,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];for(const d of c.features){const m=this.layers[0],g=d.feature,b=this.canonical,P=m.paint.get("model-rotation").evaluate(g,{},b),I=m.paint.get("model-scale").evaluate(g,{},b),O=m.paint.get("model-translation").evaluate(g,{},b);Ii(d.rotation,P)&&Ii(d.scale,I)&&Ii(d.translation,O)||(this.evaluate(d,d.featureStates,c,!0),t=!0)}}return t}updateReplacement(t,o,c,d){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const m=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);if(qx(this.activeReplacements,m))return!1;this.activeReplacements=m;let g=!1;for(const b in this.instancesPerModel){const P=this.instancesPerModel[b],I=P.instancedDataArray;for(const O of P.features){const L=O.instancedDataOffset,k=O.instancedDataCount;for(let $=0;$<k;$++){const W=16*($+L);let Q=I.float32[W+0];const te=Q>Ut;Q=te?Q-Ut:Q;const ne=Math.floor(Q),ue=Math.floor(I.float32[W+1]);let he=!1;for(const me of this.activeReplacements)if(!PL(me,c,jF.Model,d)&&!(me.min.x>ne||ne>me.max.x||me.min.y>ue||ue>me.max.y)&&(he=GS(AL(ne,ue,t.canonical,me.footprintTileId.canonical),me.footprint),he))break;I.float32[W]=he?Q+Ut:Q,g=g||he!==te}}}return g}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=t.createVertexBuffer(c.instancedDataArray,PZ.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];c.instancedDataArray.length!==0&&c.instancedDataBuffer&&c.instancedDataBuffer.destroy()}const t=this.layers[0].modelManager;if(t&&this.modelUris&&this.modelsRequested)for(const o of this.modelUris)t.removeModel(o,"",!0)}addFeature(t,o,c){const d=this.layers[0],m=d.layout.get("model-id").evaluate(c,{},this.canonical);if(!m)return Cr(`modelId is not evaluated for layer ${d.id} and it is not going to get rendered.`),m;(LT(m,!1)||this.styleDefinedModelURLs[m]!==void 0)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new VF);const g=this.instancesPerModel[m],b=g.instancedDataArray,P=new NF(c,b.length);for(const I of o)for(const O of I){if(O.x<0||O.x>=Ut||O.y<0||O.y>=Ut)continue;if(this.lookupDim!==0){const k=(this.lookupDim-1)/Ut,$=this.lookupDim*(O.y*k|0)+O.x*k|0;if(this.lookup){if(this.lookup[$]!==0)continue;this.lookup[$]=1}}this.instanceCount++;const L=b.length;b.resize(L+1),g.instancesEvaluatedElevation.push(0),b.float32[16*L]=O.x,b.float32[16*L+1]=O.y}return P.instancedDataCount=g.instancedDataArray.length-P.instancedDataOffset,P.instancedDataCount>0&&(t.id&&(g.idToFeaturesIndex[t.id]=g.features.length),g.features.push(P),this.evaluate(P,{},g,!1)),m}getModelUris(){return this.modelUris}evaluate(t,o,c,d){const m=this.layers[0],g=t.feature,b=this.canonical,P=t.rotation=m.paint.get("model-rotation").evaluate(g,o,b),I=t.scale=m.paint.get("model-scale").evaluate(g,o,b),O=t.translation=m.paint.get("model-translation").evaluate(g,o,b),L=Object.assign({},m.paint.get("model-color").evaluate(g,o,b));L.a=m.paint.get("model-color-mix-intensity").evaluate(g,o,b);const k=[];this.maxVerticalOffset<O[2]&&(this.maxVerticalOffset=O[2]);const $=O[0]*O[0]+O[1]*O[1],W=$>0?Math.sqrt($):0;c.maxScale=Math.max(Math.max(c.maxScale,I[0]),Math.max(I[1],I[2])),c.maxXYTranslationDistance=Math.max(c.maxXYTranslationDistance,W),this.maxScale=Math.max(Math.max(this.maxScale,I[0]),Math.max(I[1],I[2])),gz(k,P,I);const Q=Math.round(100*L.a)+L.b/1.05;for(let te=0;te<t.instancedDataCount;++te){const ne=t.instancedDataOffset+te,ue=16*ne,he=c.instancedDataArray.float32;let me=0;d&&(me=he[ue+6]-c.instancesEvaluatedElevation[ne]);const Ae=0|he[ue+1];he[ue]=(0|he[ue])+L.r/1.05,he[ue+1]=Ae+L.g/1.05,he[ue+2]=Q,he[ue+3]=1/(b.z>10?this.tileToMeter:De(b,Ae)),he[ue+4]=O[0],he[ue+5]=O[1],he[ue+6]=O[2]+me,he[ue+7]=k[0],he[ue+8]=k[1],he[ue+9]=k[2],he[ue+10]=k[4],he[ue+11]=k[5],he[ue+12]=k[6],he[ue+13]=k[8],he[ue+14]=k[9],he[ue+15]=k[10],c.instancesEvaluatedElevation[ne]=O[2]}}}let UF,$F;cr(zT,"ModelBucket",{omit:["layers"]}),cr(VF,"PerModelAttributes"),cr(NF,"ModelFeature");class G_{constructor(t,o,c){this._demTile=t,this._dem=this._demTile.dem,this._scale=o,this._offset=c}static create(t,o,c){const d=c||t.findDEMTileFor(o);if(!d||!d.dem)return;const m=d.dem,g=d.tileID,b=1<<o.canonical.z-g.canonical.z;return new G_(d,m.dim/Ut/b,[(o.canonical.x/b-g.canonical.x)*m.dim,(o.canonical.y/b-g.canonical.y)*m.dim])}tileCoordToPixel(t,o){const c=o*this._scale+this._offset[1];return new St(Math.floor(t*this._scale+this._offset[0]),Math.floor(c))}getElevationAt(t,o,c,d){const m=t*this._scale+this._offset[0],g=o*this._scale+this._offset[1],b=Math.floor(m),P=Math.floor(g),I=this._dem;return d=!!d,c?Lr(Lr(I.get(b,P,d),I.get(b,P+1,d),g-P),Lr(I.get(b+1,P,d),I.get(b+1,P+1,d),g-P),m-b):I.get(b,P,d)}getElevationAtPixel(t,o,c){return this._dem.get(t,o,!!c)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*de(1,t)*this._dem.stride}}const FT=new Float32Array(262144),Ag=new Uint8Array(262144);function WF(s){let t=0;if(s.meshes)for(const o of s.meshes)t=Math.max(t,o.aabb.max[2]);if(s.children)for(const o of s.children)t=Math.max(t,WF(o));return t}function qF(s,t,o){if(s.meshes)for(const c of s.meshes){if(c.aabb.min[0]===1/0)continue;const d=Jr.applyTransform(c.aabb,s.globalMatrix);o.insert(t,d.min[0],d.min[1],d.max[0],d.max[1])}if(s.children)for(const c of s.children)qF(c,t,o)}const GF=["","wall","door","roof","window","lamp","logo"];class HF{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:t.id,geometry:[],properties:{height:WF(t)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const o=new Jr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==t&&(c.transformedAabb=Jr.applyTransformFast(c.aabb,this.node.globalMatrix),o.encapsulate(c.transformedAabb)),t++;this.aabb=o}return this.aabb}}class wb{constructor(t,o,c,d,m,g,b,P){this.id=c,this.layers=t,this.layerIds=this.layers.map((I=>I.fqid)),this.stateDependentLayerIds=this.layers.filter((I=>I.isStateDependent())).map((I=>I.id)),this.modelTraits|=k_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,d&&(this.modelTraits|=k_.HasMapboxMeshFeatures),m&&(this.modelTraits|=k_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=g,this.worldview=P,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const I of o)this.nodesInfo.push(new HF(I)),qF(I,b.featureIndexArray.length,b.grid),b.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,b.bucketLayerIDs.length-1,0);this.states={},this.hasAppearances=null}updateFootprints(t,o){for(const c of this.getNodesInfo()){const d=c.node;d.footprint&&o.push({footprint:d.footprint,id:t})}}updateAppearances(t,o,c,d){}update(t){const o=Object.keys(t).length!==0;if(o&&!this.stateDependentLayers.length)return;const c=o?this.stateDependentLayers:this.layers;if(!Ns(t,this.states))for(const d of c)this.evaluate(d,t);this.states=structuredClone(t)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const c of o){const d=c.node;this.uploaded?this.updatePbrBuffer(d):aT(d,t,!0)}for(const c of o)nb(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let o=!1;if(!t.meshes)return o;for(const c of t.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),o=!0);return o}needsReEvaluation(t,o,c){const d=t.transform.projectionOptions,m=t.style.getBrightness(),g=this.brightness!==m;if(!this.uploaded||this.dirty||d.name!==this.projection.name||Vv(c.paint.get("model-color").value,g)||Vv(c.paint.get("model-color-mix-intensity").value,g)||Vv(c.paint.get("model-roughness").value,g)||Vv(c.paint.get("model-emissive-strength").value,g)||Vv(c.paint.get("model-height-based-emissive-strength-multiplier").value,g)){this.projection=d,this.brightness=m;const b=this.getNodesInfo();for(const P of b)P.state=null;return!0}return!1}evaluateTransform(t,o){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const c=this.getNodesInfo(),d=this.id.canonical;for(const m of c){const g=m.feature;m.evaluatedTranslation=o.paint.get("model-translation").evaluate(g,{},d),m.evaluatedScale=o.paint.get("model-scale").evaluate(g,{},d)}}evaluate(t,o){const c=this.getNodesInfo();for(const d of c){if(!d.node.meshes)continue;const m=d.feature,g=o&&o[m.id];if(Ns(g,d.state))continue;d.state=structuredClone(g);const b=d.node.meshes&&d.node.meshes[0].featureData,P=d.evaluatedColor[2],I=d.evaluatedRMEA[2],O=this.id.canonical;if(d.hasTranslucentParts=!1,b){for(let L=0;L<GF.length;L++){const k=GF[L];k.length&&(m.properties.part=k);const $=t.paint.get("model-color").evaluate(m,g,O).toPremultipliedRenderColor(null),W=t.paint.get("model-color-mix-intensity").evaluate(m,g,O);d.evaluatedColor[L]=[$.r,$.g,$.b,W],d.evaluatedRMEA[L][0]=t.paint.get("model-roughness").evaluate(m,g,O),d.evaluatedRMEA[L][2]=t.paint.get("model-emissive-strength").evaluate(m,g,O),d.evaluatedRMEA[L][3]=$.a,d.emissionHeightBasedParams[L]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,g,O),!d.hasTranslucentParts&&$.a<1&&(d.hasTranslucentParts=!0)}delete m.properties.part,tK(d,P!==d.evaluatedColor[2]||I!==d.evaluatedRMEA[2],this.modelTraits)}else d.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(m,g,O);d.evaluatedTranslation=t.paint.get("model-translation").evaluate(m,g,O),d.evaluatedScale=t.paint.get("model-scale").evaluate(m,g,O),this.updatePbrBuffer(d.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,o,c,d){const m=t.findDEMTileFor(c);if(m&&(m.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const g=G_.create(t,c,m);if(!g)return;this.modelTraits&k_.HasMapboxMeshFeatures&&this.updateDEM(t,g,c,d);for(const b of this.getNodesInfo()){const P=b.node;if(!P.footprint||!P.footprint.vertices||!P.footprint.vertices.length)continue;const I=P.footprint.vertices;let O=g.getElevationAt(I[0].x,I[0].y,!0,!0);for(let L=1;L<I.length;L++)O=Math.min(O,g.getElevationAt(I[L].x,I[L].y,!0,!0));P.elevation=O}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=o}}updateDEM(t,o,c,d){let m=o._dem._modifiedForSources[d];if(m===void 0&&(o._dem._modifiedForSources[d]=[],m=o._dem._modifiedForSources[d]),m.includes(c.canonical))return;const g=o._dem.dim;m.push(c.canonical);let b=!1;for(const P of this.getNodesInfo()){const I=P.node;if(!I.footprint||!I.footprint.grid)continue;const O=I.footprint.grid,L=o.tileCoordToPixel(O.min.x,O.min.y),k=o.tileCoordToPixel(O.max.x,O.max.y),$=Math.min(Math.min(g-k.y,L.x),Math.min(L.y,g-k.x));if($<0)continue;const W=le($,2,5);let Q=Math.max(0,L.x-W),te=Math.max(0,L.y-W),ne=Math.min(k.x+W,g-1),ue=Math.min(k.y+W,g-1);for(let Pe=te;Pe<=ue;++Pe)for(let Fe=Q;Fe<=ne;++Fe)Ag[Pe*g+Fe]=255;let he=0,me=0;for(let Pe=0;Pe<O.cellsY;++Pe)for(let Fe=0;Fe<O.cellsX;++Fe){if(!O.cells[Pe*O.cellsX+Fe])continue;const Be=o.tileCoordToPixel(O.min.x+Fe/O.xScale,O.min.y+Pe/O.yScale),Ve=o.tileCoordToPixel(O.min.x+(Fe+1)/O.xScale,O.min.y+(Pe+1)/O.yScale);for(let at=Be.y;at<=Math.min(Ve.y+1,g-1);++at)for(let Ze=Be.x;Ze<=Math.min(Ve.x+1,g-1);++Ze)Ag[at*g+Ze]===255&&(Ag[at*g+Ze]=0,he+=o.getElevationAtPixel(Ze,at),me++)}const Ae=he/me;Q=Math.max(1,L.x-W),te=Math.max(1,L.y-W),ne=Math.min(k.x+W,g-2),ue=Math.min(k.y+W,g-2),b=!0;for(let Pe=te;Pe<=ue;++Pe)for(let Fe=Q;Fe<=ne;++Fe)Ag[Pe*g+Fe]===0&&(FT[Pe*g+Fe]=o._dem.set(Fe,Pe,Ae));for(let Pe=1;Pe<W;++Pe){Q=Math.max(1,L.x-Pe),te=Math.max(1,L.y-Pe),ne=Math.min(k.x+Pe,g-2),ue=Math.min(k.y+Pe,g-2);for(let Fe=te;Fe<=ue;++Fe)for(let Be=Q;Be<=ne;++Be){const Ve=Fe*g+Be;if(Ag[Ve]===255){let at=0,Ze=0,ft=-1,xt=-1;for(let Ct=-1;Ct<=1;++Ct)for(let Wt=-1;Wt<=1;++Wt){const Rt=(Fe+Ct)*g+Be+Wt;if(Ag[Rt]>=Pe)continue;const wt=FT[Rt],Dt=Math.abs(wt);Dt>Ze&&(at=wt,Ze=Dt,ft=Wt,xt=Ct)}if(Ze>.1){const Ct=1-(Pe+.5*Math.abs(ft*xt))/W;let Wt=o._dem.get(Be,Fe)+at*Ct;const Rt=o._dem.get(Be+ft,Fe+xt),wt=o._dem.get(Be-ft,Fe-xt,!0);(Wt-Rt)*(Wt-wt)>0&&(Wt=(Rt+wt)/2),FT[Ve]=o._dem.set(Be,Fe,Wt),Ag[Ve]=Pe}}}}}b&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=Ds.now())}setFilter(t){this.filter=t?lp(t):null}getNodesInfo(){return this.filter?this.nodesInfo.filter((t=>this.filter.filter(new mi(this.id.overscaledZ,{worldview:this.worldview}),t.feature,this.id.canonical))):this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const o of t)nb(o.node),lT(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const c=o.getReplacementRegionsForTile(t.toUnwrapped());for(const d of this.getNodesInfo()){const m=d.node.footprint;d.hiddenByReplacement=!!m&&!c.find((g=>g.footprint===m))}}getHeightAtTileCoord(t,o){const c=[],d=[0,0,0],m=J([]);for(const g of this.getNodesInfo()){const b=g.node.meshes[0],P=b.transformedAabb;if(t<P.min[0]||o<P.min[1]||t>P.max[0]||o>P.max[1])continue;if(g.node.hidden===!0)return{height:1/0,maxHeight:g.feature.properties.height,hidden:!1,verticalScale:g.evaluatedScale[2]};se(m,g.node.globalMatrix),d[0]=t,d[1]=o,Yr(d,d,m);const I=(d[0]-b.aabb.min[0])/(b.aabb.max[0]-b.aabb.min[0])*Ig|0,O=Math.min(63,(d[1]-b.aabb.min[1])/(b.aabb.max[1]-b.aabb.min[1])*Ig|0)*Ig+Math.min(63,I),L=b.heightmap[O];if(!(L<0&&g.node.footprint))return g.hiddenByReplacement?void 0:{height:L,maxHeight:g.feature.properties.height,hidden:!1,verticalScale:g.evaluatedScale[2]};if(g.node.footprint.grid.query(new St(t,o),new St(t,o),c),c.length>0)return{height:void 0,maxHeight:g.feature.properties.height,hidden:g.hiddenByReplacement,verticalScale:g.evaluatedScale[2]}}}}function Vv(s,t){return s instanceof Va&&!s.isLightConstant&&t}function eK(s,t,o,c,d,m,g,b){let P=(61440&t|(61440&t)>>4)>>8,I=(3840&t|(3840&t)>>4)>>4,O=240&t|(240&t)>>4;o[3]>0&&(P=Lr(P,255*o[0],o[3]),I=Lr(I,255*o[1],o[3]),O=Lr(O,255*o[2],o[3]));const L=P<<8|I,k=O<<8|Math.floor(255*c[3]),$=(function(Pe){const Fe=le(Pe,0,2);return Math.min(Math.round(.5*Fe*255),255)})(c[2])<<8|15*c[0]<<4|15*c[1],W=le(d[0],0,1),Q=le(d[1],0,1),te=le(d[2],0,1),ne=le(d[3],0,1);let ue,he,me,Ae;if(W!==Q&&g!==m&&Q!==W){const Pe=g-m;he=1/(Pe*(Q-W)),me=-(m+Pe*W)/(Pe*(Q-W));const Fe=le(d[4],-1,1);Ae=Math.pow(10,Fe),ue=255*te<<8|255*ne}else ue=65535,he=0,me=1,Ae=1;if(s.emplaceBack(L,k,$,ue,he,me,Ae),b){const Pe=b.length;b.clear();for(let Fe=0;Fe<Pe;Fe++)b.emplaceBack(L,k,$,ue,he,me,Ae)}}function tK(s,t,o){const c=s.node;let d=0;const m=o&k_.HasMeshoptCompression;for(const g of c.meshes){if(c.lights&&c.lightMeshIndex===d||!g.featureData)continue;g.featureArray=new ch,g.featureArray.reserve(g.featureData.length);let b=t;for(const P of g.featureData){const I=m?65535&P:P>>16&65535,O=m?P>>16&65535:65535&P,L=(15&O)<8?15&O:0,k=s.evaluatedRMEA[L],$=s.evaluatedColor[L],W=s.emissionHeightBasedParams[L];let Q;if(b&&L===2&&c.lights&&(Q=new ch,Q.resize(10*c.lights.length)),eK(g.featureArray,I,$,k,W,g.aabb.min[2],g.aabb.max[2],Q),Q&&b){b=!1;const te=c.meshes[c.lightMeshIndex];te.featureArray=Q,te.featureArray._trim()}}g.featureArray._trim(),d++}}cr(wb,"Tiled3dModelBucket",{omit:["layers"]}),cr(HF,"Tiled3dModelFeature");const rK=["id","tile","layer","source","sourceLayer","state"];class Dg{constructor(t,o,c,d,m){this.type="Feature",this._vectorTileFeature=t,this._z=o,this._x=c,this._y=d,this.properties=t?t.properties:{},this.id=m}clone(){const t=new Dg(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(t.state=Object.assign({},this.state)),this.layer&&(t.layer=Object.assign({},this.layer)),this.source&&(t.source=this.source),this.sourceLayer&&(t.sourceLayer=this.sourceLayer),t}get geometry(){return this._geometry===void 0&&this._vectorTileFeature&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of rK)this[o]!==void 0&&(t[o]=this[o]);return t}}class Rg extends sa{constructor(t,o,c,d){super(),this.id=t,this.type="model",this.models=[],this._loaded=!1,this._options=o,this._modelsInfo=new Map}load(){const t=[];for(const o in this._options.models){const c=this._options.models[o],d=this._modelsInfo.get(o);if(d){const m=d.model;m.position=c.position!=null?new q(c.position[0],c.position[1]):new q(0,0),m.orientation=c.orientation!=null?c.orientation:[0,0,0],d.modelSpec=c,Rg.applyModelSpecification(m,c),m.computeBoundsAndApplyParent(),this.models.push(m)}else{const m=hz(this.map._requestManager.transformRequest(c.uri,ms.Model).url).then((g=>{if(!g)return;const b=uT(g),P=new _z(o,c.uri,c.position,c.orientation,b);Rg.applyModelSpecification(P,c),P.computeBoundsAndApplyParent(),this.models.push(P),this._modelsInfo.set(o,{modelSpec:c,model:P})})).catch((g=>{this.fire(new Yo(new Error(`Could not load model ${o} from ${c.uri}: ${g.message}`)))}));t.push(m)}}Promise.allSettled(t).then((()=>{this._loaded=!0,this.fire(new eo("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((o=>{this._loaded=!0,this.fire(new Yo(new Error(`Could not load models: ${o.message}`)))}))}static applyModelSpecification(t,o){o.nodeOverrides&&Rg.convertNodeOverrides(t,o.nodeOverrides),o.materialOverrides&&Rg.convertMaterialOverrides(t,o.materialOverrides),o.nodeOverrideNames&&(t.nodeOverrideNames=[...o.nodeOverrideNames]),o.materialOverrideNames&&(t.materialOverrideNames=[...o.materialOverrideNames]),o.featureProperties&&(t.featureProperties=o.featureProperties)}static convertNodeOverrides(t,o){if(Array.isArray(o)&&o.every((c=>typeof c=="string"))){t.nodeOverrideNames=[];for(const c of o)t.nodeOverrideNames.push(c)}else Object.entries(o).forEach((([c,d])=>{const m={orientation:[0,0,0]};if(d.hasOwnProperty("orientation")){const g=d.orientation;g&&(m.orientation=g)}t.nodeOverrides.set(c,m)}))}static convertMaterialOverrides(t,o){if(Array.isArray(o)&&o.every((c=>typeof c=="string"))){t.materialOverrideNames=[];for(const c of o)t.materialOverrideNames.push(c)}else Object.entries(o).forEach((([c,d])=>{const m={color:new zn(1,1,1),colorMix:0,emissionStrength:0,opacity:1},g=d["model-color"];g!==void 0&&(m.color.r=g[0],m.color.g=g[1],m.color.b=g[2]);const b=d["model-color-mix-intensity"];b!==void 0&&(m.colorMix=b);const P=d["model-emissive-strength"];P!==void 0&&(m.emissionStrength=P);const I=d["model-opacity"];I!==void 0&&(m.opacity=I),t.materialOverrides.set(c,m)}))}onAdd(t){this.map=t,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(t,o){}serialize(){return this._options}setProperty(t,o){return!1}reload(){const t=xd(this.id,this.scope);this.map.style.clearSource(t),this.models=[],this._modelsInfo.clear(),this._loaded=!1,this.load()}setModels(t){this.models=[];const o=new Map;for(const c in t){const d=t[c];if(this._modelsInfo.has(c)){const m=this._modelsInfo.get(c);m&&m.modelSpec.uri===d.uri&&o.set(c,m)}}this._modelsInfo=o,this._options.models=t,this._loaded=!1,this.load()}}function kT(s,t,o,c){const d=1<<s.z;t.lat=fe((c/Ut+s.y)/d),t.lng=ye((o/Ut+s.x)/d)}function nK(s,t,o,c){const d=s.getNodesInfo()[t];if(!d||d.hiddenByReplacement||!d.node.meshes)return;let m=Number.MAX_VALUE;const g=d.node,b=o.tile,P=c.calculatePosMatrix(b.tileID.toUnwrapped(),c.worldSize),I=d.evaluatedScale;let O=0;c.elevation&&g.elevation&&(O=g.elevation*c.elevation.exaggeration()),ve(P,P,[(g.anchor?g.anchor[0]:0)*(I[0]-1),(g.anchor?g.anchor[1]:0)*(I[1]-1),O]),Ne(P,P,I);const L=o.queryGeometry,k=L.isPointQuery()?L.screenBounds:L.screenGeometry,$=function(Q){const te=pe([],P,Q.globalMatrix);pe(te,c.expandedFarZProjMatrix,te);for(let ne=0;ne<Q.meshes.length;++ne){const ue=Q.meshes[ne];if(ne===Q.lightMeshIndex)continue;const he=sT(k,c,te,ue.aabb);he!=null&&(m=Math.min(he,m))}if(Q.children)for(const ne of Q.children)$(ne)};if($(g),m===Number.MAX_VALUE)return;const W=new q(0,0);return kT(b.tileID.canonical,W,d.node.anchor[0],d.node.anchor[1]),{intersectionZ:m,position:W,feature:d.feature}}const iK={circle:class extends Ia{constructor(s,t,o,c){super(s,{layout:Gu||(Gu=new to({"circle-sort-key":new tr(Ye.layout_circle["circle-sort-key"]),"circle-elevation-reference":new zt(Ye.layout_circle["circle-elevation-reference"]),visibility:new zt(Ye.layout_circle.visibility)})),paint:Hu||(Hu=new to({"circle-radius":new tr(Ye.paint_circle["circle-radius"]),"circle-color":new tr(Ye.paint_circle["circle-color"]),"circle-blur":new tr(Ye.paint_circle["circle-blur"]),"circle-opacity":new tr(Ye.paint_circle["circle-opacity"]),"circle-translate":new zt(Ye.paint_circle["circle-translate"]),"circle-translate-anchor":new zt(Ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zt(Ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zt(Ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new tr(Ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new tr(Ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new tr(Ye.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new zt(Ye.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c)}createBucket(s){return new zi(s)}queryRadius(s){const t=s;return bs("circle-radius",this,t)+bs("circle-stroke-width",this,t)+ji(this.paint.get("circle-translate"))}queryIntersectsFeature(s,t,o,c,d,m,g,b){const P=vu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,s.pixelToTileUnitsFactor),I=this.paint.get("circle-radius").evaluate(t,o)+this.paint.get("circle-stroke-width").evaluate(t,o);return JO(s,c,m,g,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,I)}getProgramIds(){return["circle"]}getDefaultProgramParams(s,t,o){const c=QO(this);return{config:new qu(this,{zoom:t,lut:o}),defines:c,overrideFog:!1}}is3D(s){return!s&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Ia{createBucket(s){return new tL(s)}constructor(s,t,o,c){super(s,{layout:rL||(rL=new to({visibility:new zt(Ye.layout_heatmap.visibility)})),paint:nL||(nL=new to({"heatmap-radius":new tr(Ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new tr(Ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zt(Ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new th(Ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zt(Ye.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=cv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(s){return bs("heatmap-radius",this,s)}queryIntersectsFeature(s,t,o,c,d,m,g,b){const P=this.paint.get("heatmap-radius").evaluate(t,o);return JO(s,c,m,g,b,!0,!0,new St(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(s,t,o){return s==="heatmap"?{config:new qu(this,{zoom:t,lut:o}),overrideFog:!1}:{}}},hillshade:class extends Ia{constructor(s,t,o,c){super(s,{layout:iL||(iL=new to({visibility:new zt(Ye.layout_hillshade.visibility)})),paint:oL||(oL=new to({"hillshade-illumination-direction":new zt(Ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new zt(Ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zt(Ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zt(Ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zt(Ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zt(Ye.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new zt(Ye.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(s,t,o){return{overrideFog:!1}}},fill:class extends Ia{constructor(s,t,o,c){super(s,{layout:xL||(xL=new to({"fill-sort-key":new tr(Ye.layout_fill["fill-sort-key"]),visibility:new zt(Ye.layout_fill.visibility),"fill-elevation-reference":new zt(Ye.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new tr(Ye.layout_fill["fill-construct-bridge-guard-rail"])})),paint:bL||(bL=new to({"fill-antialias":new zt(Ye.paint_fill["fill-antialias"]),"fill-opacity":new tr(Ye.paint_fill["fill-opacity"]),"fill-color":new tr(Ye.paint_fill["fill-color"]),"fill-outline-color":new tr(Ye.paint_fill["fill-outline-color"]),"fill-translate":new zt(Ye.paint_fill["fill-translate"]),"fill-translate-anchor":new zt(Ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new tr(Ye.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new zt(Ye.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new zt(Ye.paint_fill["fill-emissive-strength"]),"fill-z-offset":new tr(Ye.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new tr(Ye.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new tr(Ye.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c)}getProgramIds(){const s=this.paint.get("fill-pattern"),t=s&&s.constantOr(1),o=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(s,t,o){return{config:new qu(this,{zoom:t,lut:o}),overrideFog:!1}}recalculate(s,t){super.recalculate(s,t);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new $S(s)}queryRadius(){return ji(this.paint.get("fill-translate"))}queryIntersectsFeature(s,t,o,c,d,m){return!s.queryGeometry.isAboveHorizon&&so(Ql(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,s.pixelToTileUnitsFactor),c)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(s){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const t=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return s!=null?t&&!s:t}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Ia{constructor(s,t,o,c){super(s,{layout:GL||(GL=new to({visibility:new zt(Ye["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new zt(Ye["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:HL||(HL=new to({"fill-extrusion-opacity":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new tr(Ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new tr(Ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new tr(Ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new tr(Ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new tr(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new tr(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new tr(Ye["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new tr(Ye["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new zt(Ye["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new Hx(s)}queryRadius(){return ji(this.paint.get("fill-extrusion-translate"))}is3D(s){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(s,t,o,c,d,m,g,b,P){const I=vu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,s.pixelToTileUnitsFactor),O=this.paint.get("fill-extrusion-height").evaluate(t,o),L=this.paint.get("fill-extrusion-base").evaluate(t,o),k=[0,0],$=b&&m.elevation,W=m.elevation?m.elevation.exaggeration():1,Q=s.tile.getBucket(this);if($&&Q instanceof Hx){const me=Q.centroidVertexArray,Ae=P+1;Ae<me.length&&(k[0]=me.geta_centroid_pos0(Ae),k[1]=me.geta_centroid_pos1(Ae))}if(k[0]===0&&k[1]===1)return!1;m.projection.name==="globe"&&(c=qL([c],[new St(0,0),new St(Ut,Ut)],s.tileID.canonical).map((me=>me.polygon)).flat());const te=$?b:null,[ne,ue]=ez(m,c,L,O,I,g,te,k,W,m.center.lat,s.tileID.canonical),he=s.queryGeometry;return JL(ne,ue,he.isPointQuery()?he.screenBounds:he.screenGeometry)}},building:class extends Ia{constructor(s,t,o,c){super(s,{layout:Ez||(Ez=new to({visibility:new zt(Ye.layout_building.visibility),"building-facade":new tr(Ye.layout_building["building-facade"]),"building-facade-floors":new tr(Ye.layout_building["building-facade-floors"]),"building-facade-unit-width":new tr(Ye.layout_building["building-facade-unit-width"]),"building-facade-window":new tr(Ye.layout_building["building-facade-window"]),"building-roof-shape":new tr(Ye.layout_building["building-roof-shape"]),"building-height":new tr(Ye.layout_building["building-height"]),"building-base":new tr(Ye.layout_building["building-base"]),"building-flood-light-wall-radius":new tr(Ye.layout_building["building-flood-light-wall-radius"]),"building-flood-light-ground-radius":new tr(Ye.layout_building["building-flood-light-ground-radius"]),"building-flip-roof-orientation":new tr(Ye.layout_building["building-flip-roof-orientation"])})),paint:Pz||(Pz=new to({"building-opacity":new zt(Ye.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new zt(Ye.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new zt(Ye.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new zt(Ye.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new zt(Ye.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new zt(Ye.paint_building["building-vertical-scale"]),"building-cast-shadows":new zt(Ye.paint_building["building-cast-shadows"]),"building-color":new tr(Ye.paint_building["building-color"]),"building-emissive-strength":new tr(Ye.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new zt(Ye.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new zt(Ye.paint_building["building-cutoff-fade-range"]),"building-flood-light-color":new zt(Ye.paint_building["building-flood-light-color"]),"building-flood-light-intensity":new zt(Ye.paint_building["building-flood-light-intensity"]),"building-flood-light-ground-attenuation":new zt(Ye.paint_building["building-flood-light-ground-attenuation"]),"building-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"building-flood-light-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new Tz(s)}cutoffRange(){return this.paint.get("building-cutoff-fade-range")}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(s){return!0}queryRadius(s){return 0}queryIntersectsFeature(s,t,o,c,d,m,g,b,P){let I=this.layout.get("building-height").evaluate(t,o);const O=this.layout.get("building-base").evaluate(t,o),L=s.tile.getBucket(this).getFootprint(t);if(L){if(L.hiddenFlags!==0)return!1;I=L.height}const[k,$]=ez(m,c,O,I,new St(0,0),g,null,[0,0],1,m.center.lat,s.tileID.canonical),W=s.queryGeometry;return JL(k,$,W.isPointQuery()?W.screenBounds:W.screenGeometry)}},line:class extends Ia{constructor(s,t,o,c){const d=Fz();super(s,d,t,o,c),d.layout&&(this.layout=new $c(d.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Yf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(s,t){super.recalculate(s,t),this.paint._values["line-floorwidth"]=(()=>{if(Pv)return Pv;const o=Fz();return Pv=new eX(o.paint.properties["line-width"].specification),Pv.useIntegerZoom=!0,Pv})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new hT(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(s,t,o){const c=Lz(this);return{config:new qu(this,{zoom:t,lut:o}),defines:c,overrideFog:!1}}queryRadius(s){const t=s,o=kz(bs("line-width",this,t),bs("line-gap-width",this,t)),c=bs("line-offset",this,t);return o/2+Math.abs(c)+ji(this.paint.get("line-translate"))}queryIntersectsFeature(s,t,o,c,d,m){if(s.queryGeometry.isAboveHorizon)return!1;const g=Ql(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,s.pixelToTileUnitsFactor),b=s.pixelToTileUnitsFactor/2*kz(this.paint.get("line-width").evaluate(t,o),this.paint.get("line-gap-width").evaluate(t,o)),P=this.paint.get("line-offset").evaluate(t,o);return P&&(c=(function(I,O){const L=[],k=new St(0,0);for(let $=0;$<I.length;$++){const W=I[$],Q=[];for(let te=0;te<W.length;te++){const ne=W[te],ue=W[te+1],he=te===0?k:ne.sub(W[te-1])._unit()._perp(),me=te===W.length-1?k:ue.sub(ne)._unit()._perp(),Ae=he._add(me)._unit();Ae._mult(1/(Ae.x*me.x+Ae.y*me.y)),Q.push(Ae._mult(O)._add(ne))}L.push(Q)}return L})(c,P*s.pixelToTileUnitsFactor)),(function(I,O,L){for(let k=0;k<O.length;k++){const $=O[k];if(I.length>=3){for(let W=0;W<$.length;W++)if(is(I,$[W]))return!0}if(Wa(I,$,L))return!0}return!1})(g,c,b)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(s){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:yb,background:class extends Ia{constructor(s,t,o,c){super(s,{layout:PF||(PF=new to({visibility:new zt(Ye.layout_background.visibility)})),paint:IF||(IF=new to({"background-pitch-alignment":new zt(Ye.paint_background["background-pitch-alignment"]),"background-color":new zt(Ye.paint_background["background-color"]),"background-pattern":new zt(Ye.paint_background["background-pattern"]),"background-opacity":new zt(Ye.paint_background["background-opacity"]),"background-emissive-strength":new zt(Ye.paint_background["background-emissive-strength"]),"background-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(s,t,o){return{overrideFog:!1}}is3D(s){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:RF,"raster-particle":BF,sky:class extends Ia{constructor(s,t,o,c){super(s,{layout:zF||(zF=new to({visibility:new zt(Ye.layout_sky.visibility)})),paint:FF||(FF=new to({"sky-type":new zt(Ye.paint_sky["sky-type"]),"sky-atmosphere-sun":new zt(Ye.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new zt(Ye.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new zt(Ye.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new zt(Ye.paint_sky["sky-gradient-radius"]),"sky-gradient":new th(Ye.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new zt(Ye.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new zt(Ye.paint_sky["sky-atmosphere-color"]),"sky-opacity":new zt(Ye.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(s){s==="sky-gradient"?this._updateColorRamp():s!=="sky-atmosphere-sun"&&s!=="sky-atmosphere-halo-color"&&s!=="sky-atmosphere-color"&&s!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=cv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(s,t){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),d=!c,m=s.style.light,g=m.properties.get("position");return d&&m.properties.get("anchor")==="viewport"&&Cr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?OT(g.azimuthal,90-g.polar,t):OT(c[0],90-c[1],t)}const o=this.paint.get("sky-gradient-center");return OT(o[0],90-o[1],t)}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return s==="atmosphere"?["skyboxCapture","skybox"]:s==="gradient"?["skyboxGradient"]:null}},slot:class extends Ia{constructor(s,t,o,c){super(s,{paint:kF||(kF=new to({}))},t,null)}},model:class extends Ia{constructor(s,t,o,c){super(s,{layout:UF||(UF=new to({visibility:new zt(Ye.layout_model.visibility),"model-id":new tr(Ye.layout_model["model-id"])})),paint:$F||($F=new to({"model-opacity":new tr(Ye.paint_model["model-opacity"]),"model-rotation":new tr(Ye.paint_model["model-rotation"]),"model-scale":new tr(Ye.paint_model["model-scale"]),"model-translation":new tr(Ye.paint_model["model-translation"]),"model-color":new tr(Ye.paint_model["model-color"]),"model-color-mix-intensity":new tr(Ye.paint_model["model-color-mix-intensity"]),"model-type":new zt(Ye.paint_model["model-type"]),"model-cast-shadows":new zt(Ye.paint_model["model-cast-shadows"]),"model-receive-shadows":new zt(Ye.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new zt(Ye.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new tr(Ye.paint_model["model-emissive-strength"]),"model-roughness":new tr(Ye.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new tr(Ye.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new zt(Ye.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new zt(Ye.paint_model["model-front-cutoff"]),"model-elevation-reference":new zt(Ye.paint_model["model-elevation-reference"]),"model-color-use-theme":new tr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,c),this.layer=s,this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new zT(s)}getProgramIds(){return["model"]}is3D(s){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(s){return s instanceof wb?Ut-1:0}queryRenderedFeatures(s,t,o){const c=t.getSource();if(!(c&&c instanceof Rg))return{};const d=c,m={};m[this.id]=[];const g=m[this.id];let b=0;for(const P of d.models){const I=t.getFeatureState(this.sourceLayer,P.id),O={type:"Unknown",id:P.id,properties:P.featureProperties},L=this.paint.get("model-rotation").evaluate(O,I),k=this.paint.get("model-scale").evaluate(O,I),$=this.paint.get("model-translation").evaluate(O,I),W=this.paint.get("model-elevation-reference");let Q=[];rb(Q,P,o,P.position,L,k,$,W==="ground",W==="ground",!1),o.projection.name==="globe"&&(Q=tb(Q,o));const te=pe([],o.projMatrix,Q),ne=sT(s.isPointQuery()?s.screenBounds:s.screenGeometry,o,te,P.aabb);if(ne!=null){const ue=new Dg(void 0,0,0,0,P.id);ue.layer=this.layer,ue.properties=structuredClone(P.featureProperties),ue.properties.layer=this.id,ue.properties.uri=P.uri,ue.properties.orientation=P.orientation,ue.sourceLayer=this.sourceLayer,ue.geometry={type:"Point",coordinates:[P.position.lng,P.position.lat]},ue.state=I,ue.source=this.source,g.push({featureIndex:b,feature:ue,intersectionZ:ne})}++b}return m}queryIntersectsFeature(s,t,o,c,d,m){if(!this.modelManager)return!1;const g=this.modelManager,b=s.tile.getBucket(this);if(!(b&&b instanceof zT))return!1;for(const P in b.instancesPerModel){const I=b.instancesPerModel[P],O=t.id!==void 0?t.id:t.properties&&t.properties.hasOwnProperty("id")?t.properties.id:void 0;if(I.idToFeaturesIndex.hasOwnProperty(O)){const L=I.features[I.idToFeaturesIndex[O]],k=g.getModel(P,this.scope);if(!k)return!1;let $=[];const W=new q(0,0),Q=b.canonical;let te=Number.MAX_VALUE;for(let ne=0;ne<L.instancedDataCount;++ne){const ue=16*(L.instancedDataOffset+ne),he=I.instancedDataArray.float32,me=[he[ue+4],he[ue+5],he[ue+6]];kT(Q,W,Math.floor(he[ue]),Math.floor(he[ue+1])),rb($,k,m,W,L.rotation,L.scale,me,!1,!1,!1),m.projection.name==="globe"&&($=tb($,m));const Ae=pe([],m.projMatrix,$),Pe=s.queryGeometry,Fe=sT(Pe.isPointQuery()?Pe.screenBounds:Pe.screenGeometry,m,Ae,k.aabb);Fe!=null&&(te=Math.min(Fe,te))}return te!==Number.MAX_VALUE&&te}}return!1}_handleOverridablePaintPropertyUpdate(s,t,o){return!(!this.layout||t.isDataDriven()||o.isDataDriven()||s!=="model-color"&&s!=="model-color-mix-intensity"&&s!=="model-rotation"&&s!=="model-scale"&&s!=="model-translation"&&s!=="model-emissive-strength")}_isPropertyZoomDependent(s){const t=this._transitionablePaint._values[s];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof xl}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Ia{constructor(s,t,o,c){super(s,{layout:wL||(wL=new to({"clip-layer-types":new zt(Ye.layout_clip["clip-layer-types"]),"clip-layer-scope":new zt(Ye.layout_clip["clip-layer-scope"])})),paint:SL||(SL=new to({}))},t,o,c)}recalculate(s,t){super.recalculate(s,t)}createBucket(s){return new TL(s)}is3D(s){return!0}}},BT=new zn(0,0,0),jT={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},NT={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},Sb={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},oK={PAINT_ORDER_FILL_AND_STROKE:1},Uv={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},YF={MASK_TYPE_LUMINANCE:1};function sK(s,t,o){s===1&&t.icons.push((function(c,d){return(function(m){if(m.usvg_tree.height||(m.usvg_tree.height=m.usvg_tree.width),!m.metadata)return m;const{metadata:g}=m;if(g.content_area){const{content_area:b}=g;b.left==null&&(b.left=0),b.top==null&&(b.top=b.left),b.width==null&&(b.width=m.usvg_tree.width),b.height==null&&(b.height=b.width)}if(g.text_placeholder){const{text_placeholder:b}=g;b.top==null&&(b.top=b.left),b.height==null&&(b.height=b.width)}return g.stretch_x&&g.stretch_x.length&&ZF(g,"x"),g.stretch_y&&g.stretch_y.length&&ZF(g,"y"),m})(c.readFields(aK,{name:void 0},d))})(o,o.readVarint()+o.pos))}function ZF(s,t){const o=[],c=s[`stretch_${t}`];let d=null;for(let m=0;m<c.length;m++)d===null?d=o.length===0?c[0]:o[o.length-1][1]+c[m]:(o.push([d,d+c[m]]),d=null);s[`stretch_${t}_areas`]=o}function aK(s,t,o){s===1?t.name=o.readString():s===2?t.metadata=(function(c,d){return c.readFields(lK,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},d)})(o,o.readVarint()+o.pos):s===3&&(t.usvg_tree=(function(c,d){return c.readFields(dK,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},d)})(o,o.readVarint()+o.pos),t.data="usvg_tree")}function lK(s,t,o){s===1?t.stretch_x=o.readPackedVarint():s===2?t.stretch_y=o.readPackedVarint():s===3?t.content_area=XF(o,o.readVarint()+o.pos):s===4?t.variables.push((function(c,d){return c.readFields(uK,{name:void 0},d)})(o,o.readVarint()+o.pos)):s===5&&(t.text_placeholder=XF(o,o.readVarint()+o.pos))}function XF(s,t){return s.readFields(cK,{},t)}function cK(s,t,o){s===1?t.left=o.readVarint():s===2?t.width=o.readVarint():s===3?t.top=o.readVarint():s===4&&(t.height=o.readVarint())}function uK(s,t,o){s===1?t.name=o.readString():s===2&&(t.rgb_color=Pb(o.readVarint()),t.value="rgb_color")}function dK(s,t,o){s===1?t.width=t.height=o.readVarint():s===2?t.height=o.readVarint():s===3?t.children.push(Tb(o,o.readVarint()+o.pos)):s===4?t.linear_gradients.push((function(c,d){return c.readFields(yK,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},d)})(o,o.readVarint()+o.pos)):s===5?t.radial_gradients.push((function(c,d){return c.readFields(xK,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},d)})(o,o.readVarint()+o.pos)):s===7?t.clip_paths.push((function(c,d){return c.readFields(bK,{children:[]},d)})(o,o.readVarint()+o.pos)):s===8&&t.masks.push((function(c,d){const m=c.readFields(wK,{left:0,width:20,mask_type:YF.MASK_TYPE_LUMINANCE,children:[]},d);return m.height==null&&(m.height=m.width),m.top==null&&(m.top=m.left),m})(o,o.readVarint()+o.pos))}function Tb(s,t){return s.readFields(hK,{},t)}function hK(s,t,o){s===1?(t.group=(function(c,d){return c.readFields(fK,{opacity:255,children:[]},d)})(o,o.readVarint()+o.pos),t.node="group"):s===2&&(t.path=(function(c,d){return c.readFields(mK,{paint_order:1,commands:[],step:1,diffs:[],rule:jT.PATH_RULE_NON_ZERO},d)})(o,o.readVarint()+o.pos),t.node="path")}function fK(s,t,o){s===1?t.transform=Eb(o,o.readVarint()+o.pos):s===2?t.opacity=o.readVarint():s===5?t.clip_path_idx=o.readVarint():s===6?t.mask_idx=o.readVarint():s===7&&t.children.push(Tb(o,o.readVarint()+o.pos))}function Eb(s,t){return s.readFields(pK,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},t)}function pK(s,t,o){s===1?t.sx=o.readFloat():s===2?t.ky=o.readFloat():s===3?t.kx=o.readFloat():s===4?t.sy=o.readFloat():s===5?t.tx=o.readFloat():s===6&&(t.ty=o.readFloat())}function mK(s,t,o){s===1?t.fill=(function(c,d){return c.readFields(gK,{rgb_color:BT,paint:"rgb_color",opacity:255},d)})(o,o.readVarint()+o.pos):s===2?t.stroke=(function(c,d){return c.readFields(_K,{rgb_color:BT,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},d)})(o,o.readVarint()+o.pos):s===3?t.paint_order=o.readVarint():s===5?o.readPackedVarint(t.commands):s===6?t.step=o.readFloat():s===7?o.readPackedSVarint(t.diffs):s===8&&(t.rule=o.readVarint())}function gK(s,t,o){s===1?(t.rgb_color=Pb(o.readVarint()),t.paint="rgb_color"):s===2?(t.linear_gradient_idx=o.readVarint(),t.paint="linear_gradient_idx"):s===3?(t.radial_gradient_idx=o.readVarint(),t.paint="radial_gradient_idx"):s===5&&(t.opacity=o.readVarint())}function Pb(s){return new zn((s>>16&255)/255,(s>>8&255)/255,(255&s)/255,1)}function _K(s,t,o){s===1?(t.rgb_color=Pb(o.readVarint()),t.paint="rgb_color"):s===2?(t.linear_gradient_idx=o.readVarint(),t.paint="linear_gradient_idx"):s===3?(t.radial_gradient_idx=o.readVarint(),t.paint="radial_gradient_idx"):s===5?o.readPackedFloat(t.dasharray):s===6?t.dashoffset=o.readFloat():s===7?t.miterlimit=o.readFloat():s===8?t.opacity=o.readVarint():s===9?t.width=o.readFloat():s===10?t.linecap=o.readVarint():s===11&&(t.linejoin=o.readVarint())}function yK(s,t,o){s===1?t.transform=Eb(o,o.readVarint()+o.pos):s===2?t.spread_method=o.readVarint():s===3?t.stops.push(KF(o,o.readVarint()+o.pos)):s===4?t.x1=o.readFloat():s===5?t.y1=o.readFloat():s===6?t.x2=o.readFloat():s===7&&(t.y2=o.readFloat())}function KF(s,t){return s.readFields(vK,{offset:0,opacity:255,rgb_color:BT},t)}function vK(s,t,o){s===1?t.offset=o.readFloat():s===2?t.opacity=o.readVarint():s===3&&(t.rgb_color=Pb(o.readVarint()))}function xK(s,t,o){s===1?t.transform=Eb(o,o.readVarint()+o.pos):s===2?t.spread_method=o.readVarint():s===3?t.stops.push(KF(o,o.readVarint()+o.pos)):s===4?t.cx=o.readFloat():s===5?t.cy=o.readFloat():s===6?t.r=o.readFloat():s===7?t.fx=o.readFloat():s===8?t.fy=o.readFloat():s===9&&(t.fr=o.readFloat())}function bK(s,t,o){s===1?t.transform=Eb(o,o.readVarint()+o.pos):s===2?t.clip_path_idx=o.readVarint():s===3&&t.children.push(Tb(o,o.readVarint()+o.pos))}function wK(s,t,o){s===1?t.left=t.top=o.readFloat():s===2?t.width=t.height=o.readFloat():s===3?t.top=o.readFloat():s===4?t.height=o.readFloat():s===5?t.mask_type=o.readVarint():s===6?t.mask_idx=o.readVarint():s===7&&t.children.push(Tb(o,o.readVarint()+o.pos))}class SK{static calculate(t={},o=[]){const c=new Map,d=new Map;if(Object.keys(t).length===0)return c;o.forEach((m=>{d.set(m.name,m.rgb_color||new zn(0,0,0))}));for(const[m,g]of Object.entries(t))d.has(m)?c.set(d.get(m).toString(),g):console.warn(`Ignoring unknown image variable "${m}"`);return c}}function H_(s,t=255,o){const c=t/255,d=s.toString(),m=o.has(d)?o.get(d).clone():s.clone();return m.a*=c,m.toString()}function $v(s,t){if(!Ho()){const o=document.createElement("canvas");return o.width=s,o.height=t,o}return new OffscreenCanvas(s,t)}function TK(s,t){const o=SK.calculate(t.params,s.metadata?s.metadata.variables:[]),c=s.usvg_tree,d=c.width,m=c.height,g=t.transform?t.transform:new DOMMatrix,b=Math.max(1,Math.round(d*g.a)),P=Math.max(1,Math.round(m*g.d)),I=new DOMMatrix([b/d,0,0,P/m,0,0]),O=$v(b,P).getContext("2d");return VT(O,I,c,c,o),O.getImageData(0,0,b,P)}function VT(s,t,o,c,d){for(const m of c.children)QF(s,t,o,m,d)}function QF(s,t,o,c,d){c.group?(s.save(),(function(m,g,b,P,I){const O=P.mask_idx!=null?b.masks[P.mask_idx]:null,L=P.clip_path_idx!=null?b.clip_paths[P.clip_path_idx]:null;if(P.transform&&(g=Y_(P.transform).preMultiplySelf(g)),!(function(W,Q,te){return W.opacity!==255||Q||te})(P,L!=null,O!=null))return void VT(m,g,b,P,I);const k=$v(m.canvas.width,m.canvas.height),$=k.getContext("2d");VT($,g,b,P,I),L&&ok($,g,b,L),O&&sk($,g,b,O,I),m.globalAlpha=P.opacity/255,m.drawImage(k,0,0)})(s,t,o,c.group,d),s.restore()):c.path&&(s.save(),(function(m,g,b,P,I){m.setTransform(g),P.paint_order===oK.PAINT_ORDER_FILL_AND_STROKE?(JF(m,b,P,I),tk(m,b,P,I)):(tk(m,b,P,I),JF(m,b,P,I))})(s,t,o,c.path,d),s.restore())}function JF(s,t,o,c){const d=o.fill;if(!d)return;const m=d.opacity/255;switch(s.save(),s.beginPath(),ak(o,s),d.paint){case"rgb_color":s.fillStyle=H_(d.rgb_color,d.opacity,c);break;case"linear_gradient_idx":{const g=t.linear_gradients[d.linear_gradient_idx];g.transform&&s.setTransform(Y_(g.transform).preMultiplySelf(s.getTransform())),s.fillStyle=rk(s,g,m,c);break}case"radial_gradient_idx":{const g=t.radial_gradients[d.radial_gradient_idx];g.transform&&s.setTransform(Y_(g.transform).preMultiplySelf(s.getTransform())),s.fillStyle=nk(s,g,m,c)}}s.fill(ek(o)),s.restore()}function ek(s){return s.rule===jT.PATH_RULE_NON_ZERO?"nonzero":s.rule===jT.PATH_RULE_EVEN_ODD?"evenodd":void 0}function tk(s,t,o,c){const d=o.stroke;if(!d)return;const m=lk(o);s.lineWidth=d.width,s.miterLimit=d.miterlimit,s.setLineDash(d.dasharray),s.lineDashOffset=d.dashoffset;const g=d.opacity/255;switch(d.paint){case"rgb_color":s.strokeStyle=H_(d.rgb_color,d.opacity,c);break;case"linear_gradient_idx":s.strokeStyle=rk(s,t.linear_gradients[d.linear_gradient_idx],g,c,!0);break;case"radial_gradient_idx":s.strokeStyle=nk(s,t.radial_gradients[d.radial_gradient_idx],g,c,!0)}switch(d.linejoin){case Sb.LINE_JOIN_MITER_CLIP:case Sb.LINE_JOIN_MITER:s.lineJoin="miter";break;case Sb.LINE_JOIN_ROUND:s.lineJoin="round";break;case Sb.LINE_JOIN_BEVEL:s.lineJoin="bevel"}switch(d.linecap){case NT.LINE_CAP_BUTT:s.lineCap="butt";break;case NT.LINE_CAP_ROUND:s.lineCap="round";break;case NT.LINE_CAP_SQUARE:s.lineCap="square"}s.stroke(m)}function rk(s,t,o,c,d=!1){if(t.stops.length===1){const k=t.stops[0];return H_(k.rgb_color,k.opacity*o,c)}const{x1:m,y1:g,x2:b,y2:P}=t;let I=new DOMPoint(m,g),O=new DOMPoint(b,P);if(d){const k=Y_(t.transform);I=k.transformPoint(I),O=k.transformPoint(O)}const L=s.createLinearGradient(I.x,I.y,O.x,O.y);for(const k of t.stops)L.addColorStop(k.offset,H_(k.rgb_color,k.opacity*o,c));return L}function nk(s,t,o,c,d=!1){if(t.stops.length===1){const ne=t.stops[0];return H_(ne.rgb_color,ne.opacity*o,c)}const m=Y_(t.transform),{fx:g,fy:b,fr:P,cx:I,cy:O,r:L}=t;let k=new DOMPoint(g,b),$=new DOMPoint(I,O),W=P,Q=L;if(d){k=m.transformPoint(k),$=m.transformPoint($);const ne=(m.a+m.d)/2;W=P*ne,Q=t.r*ne}const te=s.createRadialGradient(k.x,k.y,W,$.x,$.y,Q);for(const ne of t.stops)te.addColorStop(ne.offset,H_(ne.rgb_color,ne.opacity*o,c));return te}function ik(s,t,o,c){const d=c.transform?Y_(c.transform).preMultiplySelf(t):t,m=$v(s.canvas.width,s.canvas.height),g=m.getContext("2d");for(const P of c.children)if(P.group)ik(g,d,o,P.group);else if(P.path){const I=P.path,O=new Path2D;O.addPath(lk(I),d),g.fill(O,ek(I))}const b=c.clip_path_idx!=null?o.clip_paths[c.clip_path_idx]:null;b&&ok(g,d,o,b),s.globalCompositeOperation="source-over",s.drawImage(m,0,0)}function ok(s,t,o,c){const d=$v(s.canvas.width,s.canvas.height);ik(d.getContext("2d"),t,o,c),s.globalCompositeOperation="destination-in",s.drawImage(d,0,0)}function sk(s,t,o,c,d){if(c.children.length===0)return;const m=c.mask_idx!=null?o.masks[c.mask_idx]:null;m&&sk(s,t,o,m,d);const g=s.canvas.width,b=s.canvas.height,P=$v(g,b),I=P.getContext("2d"),O=c.width,L=c.height,k=c.left,$=c.top,W=new Path2D,Q=new Path2D;Q.rect(k,$,O,L),W.addPath(Q,t),I.clip(W);for(const ue of c.children)QF(I,t,o,ue,d);const te=I.getImageData(0,0,g,b),ne=te.data;if(c.mask_type===YF.MASK_TYPE_LUMINANCE)for(let ue=0;ue<ne.length;ue+=4)ne[ue+3]=ne[ue+3]/255*(.2126*ne[ue]+.7152*ne[ue+1]+.0722*ne[ue+2]);I.putImageData(te,0,0),s.globalCompositeOperation="destination-in",s.drawImage(P,0,0)}function Y_(s){return s?new DOMMatrix([s.sx,s.ky,s.kx,s.sy,s.tx,s.ty]):new DOMMatrix}function ak(s,t){const o=s.step;let c=s.diffs[0]*o,d=s.diffs[1]*o;t.moveTo(c,d);for(let m=0,g=2;m<s.commands.length;m++)switch(s.commands[m]){case Uv.PATH_COMMAND_MOVE:c+=s.diffs[g++]*o,d+=s.diffs[g++]*o,t.moveTo(c,d);break;case Uv.PATH_COMMAND_LINE:c+=s.diffs[g++]*o,d+=s.diffs[g++]*o,t.lineTo(c,d);break;case Uv.PATH_COMMAND_QUAD:{const b=c+s.diffs[g++]*o,P=d+s.diffs[g++]*o;c=b+s.diffs[g++]*o,d=P+s.diffs[g++]*o,t.quadraticCurveTo(b,P,c,d);break}case Uv.PATH_COMMAND_CUBIC:{const b=c+s.diffs[g++]*o,P=d+s.diffs[g++]*o,I=b+s.diffs[g++]*o,O=P+s.diffs[g++]*o;c=I+s.diffs[g++]*o,d=O+s.diffs[g++]*o,t.bezierCurveTo(b,P,I,O,c,d);break}case Uv.PATH_COMMAND_CLOSE:t.closePath()}return t}function lk(s){return ak(s,new Path2D)}class Ib{constructor(t){this.capacity=t,this.cache=new Map}get(t){if(!this.cache.has(t))return;const o=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,o),o}put(t,o){this.cache.has(t)?this.cache.delete(t):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(t,o)}delete(t){this.cache.delete(t)}}cr(Ib,"LRUCache");class UT{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(t){return new qa(t,t.data)}getFromCache(t,o,c){return this.cacheMap.has(c)||this.cacheMap.set(c,new Ib(150)),this.cacheMap.get(c).get(xd(t.toString(),o))}setInCache(t,o,c,d){this.cacheDependenciesMap.has(d)||this.cacheDependenciesMap.set(d,new Map),this.cacheMap.has(d)||this.cacheMap.set(d,new Ib(150));const m=this.cacheDependenciesMap.get(d),g=xd(t.id.toString(),c);m.get(g)||m.set(g,new Set);const b=this.cacheMap.get(d),P=t.toString();m.get(g).add(P),b.put(xd(t.toString(),c),o)}removeImagesFromCacheByIds(t,o,c=0){if(!this.cacheMap.has(c)||!this.cacheDependenciesMap.has(c))return;const d=this.cacheMap.get(c),m=this.cacheDependenciesMap.get(c);for(const g of t){const b=xd(g.toString(),o);if(m.has(b)){for(const P of m.get(b))d.delete(P);m.delete(b)}}}rasterize(t,o,c,d,m=TK){const g=this.getFromCache(t,c,d);if(g)return g.clone();const b=m(o.icon,t.options),P=UT._getImage(b);return this.setInCache(t,P,c,d),P.clone()}}class ck{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,o){const c=this.toIdx(t,o);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(t,o){return this.leaves[this.toIdx(t,o)]}toIdx(t,o){return o*this.size+t}}function uk(s,t,o,c){let d=0,m=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(c[g])<1e-15){if(o[g]<s[g]||o[g]>t[g])return null}else{const b=1/c[g];let P=(s[g]-o[g])*b,I=(t[g]-o[g])*b;if(P>I){const O=P;P=I,I=O}if(P>d&&(d=P),I<m&&(m=I),d>m)return null}return d}function dk(s,t,o,c,d,m,g,b,P,I,O){const L=c-s,k=d-t,$=m-o,W=g-s,Q=b-t,te=P-o,ne=O[1]*te-O[2]*Q,ue=O[2]*W-O[0]*te,he=O[0]*Q-O[1]*W,me=L*ne+k*ue+$*he;if(Math.abs(me)<1e-15)return null;const Ae=1/me,Pe=I[0]-s,Fe=I[1]-t,Be=I[2]-o,Ve=(Pe*ne+Fe*ue+Be*he)*Ae;if(Ve<0||Ve>1)return null;const at=Fe*$-Be*k,Ze=Be*L-Pe*$,ft=Pe*k-Fe*L,xt=(O[0]*at+O[1]*Ze+O[2]*ft)*Ae;return xt<0||Ve+xt>1?null:(W*at+Q*Ze+te*ft)*Ae}function hk(s,t,o){return(s-t)/(o-t)}function fk(s,t,o,c,d,m,g,b,P){const I=1<<o,O=m-c,L=g-d,k=(s+1)/I*O+c,$=(t+0)/I*L+d,W=(t+1)/I*L+d;b[0]=(s+0)/I*O+c,b[1]=$,P[0]=k,P[1]=W}class pk{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=(function(m){const g=Math.ceil(Math.log2(m.dim/8)),b=[];let P=Math.ceil(Math.pow(2,g));const I=1/P,O=($,W,Q,te,ne)=>{const ue=te?1:0,he=($+1)*Q-ue,me=W*Q,Ae=(W+1)*Q-ue;ne[0]=$*Q,ne[1]=me,ne[2]=he,ne[3]=Ae};let L=new ck(P);const k=[];for(let $=0;$<P*P;$++){O($%P,Math.floor($/P),I,!1,k);const W=Pm(k[0],k[1],m),Q=Pm(k[2],k[1],m),te=Pm(k[2],k[3],m),ne=Pm(k[0],k[3],m);L.minimums.push(Math.min(W,Q,te,ne)),L.maximums.push(Math.max(W,Q,te,ne)),L.leaves.push(1)}for(b.push(L),P/=2;P>=1;P/=2){const $=b[b.length-1];L=new ck(P);for(let W=0;W<P*P;W++){O(W%P,Math.floor(W/P),2,!0,k);const Q=$.getElevation(k[0],k[1]),te=$.getElevation(k[2],k[1]),ne=$.getElevation(k[2],k[3]),ue=$.getElevation(k[0],k[3]),he=$.isLeaf(k[0],k[1]),me=$.isLeaf(k[2],k[1]),Ae=$.isLeaf(k[2],k[3]),Pe=$.isLeaf(k[0],k[3]),Fe=Math.min(Q.min,te.min,ne.min,ue.min),Be=Math.max(Q.max,te.max,ne.max,ue.max),Ve=he&&me&&Ae&&Pe;L.maximums.push(Be),L.minimums.push(Fe),L.leaves.push(Be-Fe<=5&&Ve?1:0)}b.push(L)}return b})(this.dem),c=o.length-1,d=o[c];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(o,0,0,c,0)}raycastRoot(t,o,c,d,m,g,b=1){return uk([t,o,-100],[c,d,this.maximums[0]*b],m,g)}raycast(t,o,c,d,m,g,b=1){if(!this.nodeCount)return null;const P=this.raycastRoot(t,o,c,d,m,g,b);if(P==null)return null;const I=[],O=[],L=[],k=[],$=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;$.length>0;){const{idx:W,t:Q,nodex:te,nodey:ne,depth:ue}=$.pop();if(this.leaves[W]){fk(te,ne,ue,t,o,c,d,L,k);const me=1<<ue,Ae=(te+0)/me,Pe=(te+1)/me,Fe=(ne+0)/me,Be=(ne+1)/me,Ve=Pm(Ae,Fe,this.dem)*b,at=Pm(Pe,Fe,this.dem)*b,Ze=Pm(Pe,Be,this.dem)*b,ft=Pm(Ae,Be,this.dem)*b,xt=dk(L[0],L[1],Ve,k[0],L[1],at,k[0],k[1],Ze,m,g),Ct=dk(k[0],k[1],Ze,L[0],k[1],ft,L[0],L[1],Ve,m,g),Wt=Math.min(xt!==null?xt:Number.MAX_VALUE,Ct!==null?Ct:Number.MAX_VALUE);if(Wt!==Number.MAX_VALUE)return Wt;{const Rt=Vt([],m,g,Q);if(mk(Ve,at,ft,Ze,hk(Rt[0],L[0],k[0]),hk(Rt[1],L[1],k[1]))>=Rt[2])return Q}continue}let he=0;for(let me=0;me<this._siblingOffset.length;me++){fk((te<<1)+this._siblingOffset[me][0],(ne<<1)+this._siblingOffset[me][1],ue+1,t,o,c,d,L,k),L[2]=-100,k[2]=this.maximums[this.childOffsets[W]+me]*b;const Ae=uk(L,k,m,g);if(Ae!=null){const Pe=Ae;I[me]=Pe;let Fe=!1;for(let Be=0;Be<he&&!Fe;Be++)Pe>=I[O[Be]]&&(O.splice(Be,0,me),Fe=!0);Fe||(O[he]=me),he++}}for(let me=0;me<he;me++){const Ae=O[me];$.push({idx:this.childOffsets[W]+Ae,t:I[Ae],nodex:(te<<1)+this._siblingOffset[Ae][0],nodey:(ne<<1)+this._siblingOffset[Ae][1],depth:ue+1})}}return null}_addNode(t,o,c){return this.minimums.push(t),this.maximums.push(o),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(t,o,c,d,m){if(t[d].isLeaf(o,c)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const g=d-1,b=t[g];let P=0,I=0;for(let O=0;O<this._siblingOffset.length;O++){const L=2*o+this._siblingOffset[O][0],k=2*c+this._siblingOffset[O][1],$=b.getElevation(L,k),W=b.isLeaf(L,k),Q=this._addNode($.min,$.max,W);W&&(P|=1<<O),I||(I=Q)}for(let O=0;O<this._siblingOffset.length;O++)P&1<<O||this._construct(t,2*o+this._siblingOffset[O][0],2*c+this._siblingOffset[O][1],g,I+O)}}function mk(s,t,o,c,d,m){return Lr(Lr(s,o,m),Lr(t,c,m),d)}function Pm(s,t,o){const c=o.dim,d=le(s*c-.5,0,c-1),m=le(t*c-.5,0,c-1),g=Math.floor(d),b=Math.floor(m),P=Math.min(g+1,c-1),I=Math.min(b+1,c-1);return mk(o.get(g,b),o.get(P,b),o.get(g,I),o.get(P,I),d-g,m-b)}const EK={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function PK(s,t,o){return(256*s*256+256*t+o)/10-1e4}function IK(s,t,o){return 256*s+t+o/256-32768}class Mb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,o,c,d=!1){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return void Cr(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const m=this.dim=o.height-2,g=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=d,this._modifiedForSources={},!d){for(let P=0;P<m;P++)g[this._idx(-1,P)]=g[this._idx(0,P)],g[this._idx(m,P)]=g[this._idx(m-1,P)],g[this._idx(P,-1)]=g[this._idx(P,0)],g[this._idx(P,m)]=g[this._idx(P,m-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(m,-1)]=g[this._idx(m-1,0)],g[this._idx(-1,m)]=g[this._idx(0,m-1)],g[this._idx(m,m)]=g[this._idx(m-1,m-1)]}const b=c==="terrarium"?IK:PK;for(let P=0;P<g.length;++P){const I=4*P;this.floatView[P]=b(this.pixels[I],this.pixels[I+1],this.pixels[I+2])}this._timestamp=Ds.now()}_buildQuadTree(){this._tree=new pk(this)}get(t,o,c=!1){c&&(t=le(t,-1,this.dim),o=le(o,-1,this.dim));const d=this._idx(t,o);return this.floatView[d]}set(t,o,c){const d=this._idx(t,o),m=this.floatView[d];return this.floatView[d]=c,c-m}static getUnpackVector(t){return EK[t]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}static pack(t,o){const c=[0,0,0,0],d=Mb.getUnpackVector(o);let m=Math.floor((t+d[3])/d[2]);return c[2]=m%256,m=Math.floor(m/256),c[1]=m%256,m=Math.floor(m/256),c[0]=m,c}getPixels(){return new lL({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,o,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=o*this.dim,m=o*this.dim+this.dim,g=c*this.dim,b=c*this.dim+this.dim;switch(o){case-1:d=m-1;break;case 1:m=d+1}switch(c){case-1:g=b-1;break;case 1:b=g+1}const P=-o*this.dim,I=-c*this.dim;for(let O=g;O<b;O++)for(let L=d;L<m;L++){const k=4*this._idx(L,O),$=4*this._idx(L+P,O+I);this.pixels[k+0]=t.pixels[$+0],this.pixels[k+1]=t.pixels[$+1],this.pixels[k+2]=t.pixels[$+2],this.pixels[k+3]=t.pixels[$+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function MK(s,t,o){s===1?t.headerLength=o.readFixed32():s===2?t.x=o.readVarint():s===3?t.y=o.readVarint():s===4?t.z=o.readVarint():s===5&&t.layers.push((function(c,d){return c.readFields(OK,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},d)})(o,o.readVarint()+o.pos))}function CK(s,t,o){s===1?(t.delta_filter=(function(c,d){return c.readFields(AK,{blockSize:0},d)})(o,o.readVarint()+o.pos),t.filter="delta_filter"):s===2?(o.readVarint(),t.filter="zigzag_filter"):s===3?(o.readVarint(),t.filter="bitshuffle_filter"):s===4&&(o.readVarint(),t.filter="byteshuffle_filter")}function AK(s,t,o){s===1&&(t.blockSize=o.readVarint())}function DK(s,t,o){s===1?(o.readVarint(),t.codec="gzip_data"):s===2?(o.readVarint(),t.codec="jpeg_image"):s===3?(o.readVarint(),t.codec="webp_image"):s===4&&(o.readVarint(),t.codec="png_image")}function RK(s,t,o){let c=0,d=0;s===1?t.firstByte=o.readFixed64():s===2?t.lastByte=o.readFixed64():s===3?t.filters.push((function(m,g){return m.readFields(CK,{},g)})(o,o.readVarint()+o.pos)):s===4?t.codec=(function(m,g){return m.readFields(DK,{},g)})(o,o.readVarint()+o.pos):s===5?d=o.readFloat():s===6?c=o.readFloat():s===7?t.bands.push(o.readString()):s===8?t.offset=o.readDouble():s===9&&(t.scale=o.readDouble()),t.offset===0&&(t.offset=d),t.scale===0&&(t.scale=c)}function OK(s,t,o){s===1?t.version=o.readVarint():s===2?t.name=o.readString():s===3?t.units=o.readString():s===4?t.tileSize=o.readVarint():s===5?t.buffer=o.readVarint():s===6?t.pixelFormat=o.readVarint():s===7&&t.dataIndex.push((function(c,d){return c.readFields(RK,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},d)})(o,o.readVarint()+o.pos))}function LK(s,t,o){if(s===2)(function(c,d,m){c.readFields(zK,m,d)})(o,o.readVarint()+o.pos,t);else if(s===3)throw new Error("Not implemented")}function zK(s,t,o){if(s===1){let c=0;const d=o.readVarint()+o.pos;for(;o.pos<d;)t[c++]=o.readVarint()}}function FK(s,t){if(t.length!==4)throw new Error(`Expected data of dimension 4 but got ${t.length}.`);let o=t[3];for(let c=2;c>=1;c--){const d=c===1?1:0,m=c===2?1:0;for(let g=0;g<t[0];g++){const b=t[1]*g;for(let P=d;P<t[1];P++){const I=t[2]*(P+b);for(let O=m;O<t[2];O++){const L=t[3]*(O+I);for(let k=0;k<t[3];k++){const $=L+k;s[$]+=s[$-o]}}}}o*=t[c]}return s}function kK(s){for(let t=0,o=s.length;t<o;t++)s[t]=s[t]>>>1^-(1&s[t]);return s}function BK(s,t){switch(t){case"uint32":return s;case"uint16":for(let o=0;o<s.length;o+=2){const c=s[o],d=s[o+1];s[o]=(240&c)>>4|(61440&c)>>8|(240&d)<<4|61440&d,s[o+1]=15&c|(3840&c)>>4|(15&d)<<8|(3840&d)<<4}return s;case"uint8":for(let o=0;o<s.length;o+=4){const c=s[o],d=s[o+1],m=s[o+2],g=s[o+3];s[o+0]=(192&c)>>6|(192&d)>>4|(192&m)>>2|192&g,s[o+1]=(48&c)>>4|(48&d)>>2|48&m|(48&g)<<2,s[o+2]=(12&c)>>2|12&d|(12&m)<<2|(12&g)<<4,s[o+3]=3&c|(3&d)<<2|(3&m)<<4|(3&g)<<6}return s;default:throw new Error(`Invalid pixel format, "${t}"`)}}cr(Mb,"DEMData"),cr(pk,"DemMinMaxQuadTree",{omit:["dem"]});var Yu=Uint8Array,Wv=Uint16Array,jK=Int32Array,gk=new Yu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_k=new Yu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),NK=new Yu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yk=function(s,t){for(var o=new Wv(31),c=0;c<31;++c)o[c]=t+=1<<s[c-1];var d=new jK(o[30]);for(c=1;c<30;++c)for(var m=o[c];m<o[c+1];++m)d[m]=m-o[c]<<5|c;return{b:o,r:d}},vk=yk(gk,2),xk=vk.b,VK=vk.r;xk[28]=258,VK[258]=28;for(var UK=yk(_k,0).b,bk=new Wv(32768),ws=0;ws<32768;++ws){var Z_=(43690&ws)>>1|(21845&ws)<<1;bk[ws]=((65280&(Z_=(61680&(Z_=(52428&Z_)>>2|(13107&Z_)<<2))>>4|(3855&Z_)<<4))>>8|(255&Z_)<<8)>>1}var qv=function(s,t,o){for(var c=s.length,d=0,m=new Wv(t);d<c;++d)s[d]&&++m[s[d]-1];var g,b=new Wv(t);for(d=1;d<t;++d)b[d]=b[d-1]+m[d-1]<<1;g=new Wv(1<<t);var P=15-t;for(d=0;d<c;++d)if(s[d])for(var I=d<<4|s[d],O=t-s[d],L=b[s[d]-1]++<<O,k=L|(1<<O)-1;L<=k;++L)g[bk[L]>>P]=I;return g},Gv=new Yu(288);for(ws=0;ws<144;++ws)Gv[ws]=8;for(ws=144;ws<256;++ws)Gv[ws]=9;for(ws=256;ws<280;++ws)Gv[ws]=7;for(ws=280;ws<288;++ws)Gv[ws]=8;var wk=new Yu(32);for(ws=0;ws<32;++ws)wk[ws]=5;var $K=qv(Gv,9),WK=qv(wk,5),$T=function(s){for(var t=s[0],o=1;o<s.length;++o)s[o]>t&&(t=s[o]);return t},yh=function(s,t,o){var c=t/8|0;return(s[c]|s[c+1]<<8)>>(7&t)&o},WT=function(s,t){var o=t/8|0;return(s[o]|s[o+1]<<8|s[o+2]<<16)>>(7&t)},qK=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],vh=function(s,t,o){var c=new Error(t||qK[s]);if(c.code=s,Error.captureStackTrace&&Error.captureStackTrace(c,vh),!o)throw c;return c},GK=new Yu(0),HK=typeof TextDecoder<"u"&&new TextDecoder;try{HK.decode(GK,{stream:!0})}catch{}const YK={gzip_data:"gzip"};class Sd extends Error{constructor(t){super(t),this.name="MRTError"}}const ZK={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Sk={uint32:1,uint16:2,uint8:4},XK={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let qT;class Cb{constructor(t=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){const o=this.layers[t];if(!o)throw new Sd(`Layer '${t}' not found`);return o}getHeaderLength(t){const o=new Uint8Array(t),c=new DataView(t);if(o[0]!==13)throw new Sd("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(t){const o=new Uint8Array(t),c=this.getHeaderLength(t);if(o.length<c)throw new Sd(`Expected header with length >= ${c} but got buffer of length ${o.length}`);const d=new qT(o.subarray(0,c)).readFields(MK,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==d.x||this.y!==d.y||this.z!==d.z))throw new Sd(`Invalid attempt to parse header ${d.z}/${d.x}/${d.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=d.x,this.y=d.y,this.z=d.z;for(const m of d.layers)this.layers[m.name]=new Tk(m,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const o=[],c=this.getLayer(t.layerName);for(let d of t.blockIndices){const m=c.dataIndex[d],g=m.firstByte-t.firstByte,b=m.lastByte-t.firstByte;if(c._blocksInProgress.has(d))continue;const P={layerName:c.name,firstByte:g,lastByte:b,pixelFormat:c.pixelFormat,blockIndex:d,blockShape:[m.bands.length].concat(c.bandShape),buffer:c.buffer,codec:m.codec.codec,filters:m.filters.map((I=>I.filter))};c._blocksInProgress.add(d),o.push(P)}return new Ek(o,(()=>{o.forEach((d=>c._blocksInProgress.delete(d.blockIndex)))}),((d,m)=>{if(o.forEach((g=>c._blocksInProgress.delete(g.blockIndex))),d)throw d;m.forEach((g=>{this.getLayer(g.layerName).processDecodedData(g)}))}))}}class Tk{constructor({version:t,name:o,units:c,tileSize:d,pixelFormat:m,buffer:g,dataIndex:b},P){if(this.version=t,this.version!==1)throw new Sd(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=o,this.units=c,this.tileSize=d,this.buffer=g,this.pixelFormat=ZK[m],this.dataIndex=b,this.bandShape=[d+2*g,d+2*g,Sk[this.pixelFormat]],this._decodedBlocks=new Ib(P?P.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return Sk[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((({bands:t})=>t)).flat()}processDecodedData(t){const o=t.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,t.data)}getBlockForBand(t){let o=0;switch(typeof t){case"string":for(const[c,d]of this.dataIndex.entries()){for(const[m,g]of d.bands.entries())if(g===t)return{bandIndex:o+m,blockIndex:c,blockBandIndex:m};o+=d.bands.length}break;case"number":for(const[c,d]of this.dataIndex.entries()){if(t>=o&&t<o+d.bands.length)return{bandIndex:t,blockIndex:c,blockBandIndex:t-o};o+=d.bands.length}break;default:throw new Sd(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(t){let o=1/0,c=-1/0;const d=[],m=new Set;for(const g of t){const{blockIndex:b}=this.getBlockForBand(g);if(b<0)throw new Sd(`Invalid band: ${JSON.stringify(g)}`);const P=this.dataIndex[b];d.includes(b)||d.push(b),m.add(b),o=Math.min(o,P.firstByte),c=Math.max(c,P.lastByte)}if(m.size>this.cacheSize)throw new Sd(`Number of blocks to decode (${m.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:c,blockIndices:d}}hasBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0}hasDataForBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(t){const{blockIndex:o,blockBandIndex:c}=this.getBlockForBand(t);if(o<0)throw new Sd(`Band not found: ${JSON.stringify(t)}`);const d=this._decodedBlocks.get(o.toString());if(!d)throw new Sd(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[o],g=this.bandShape.reduce(((I,O)=>I*O),1),b=c*g,P=d.subarray(b,b+g);return{data:P,bytes:new Uint8Array(P.buffer).subarray(P.byteOffset,P.byteOffset+P.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:m.offset,scale:m.scale}}}Cb.setPbf=function(s){qT=s};class Ek{constructor(t,o,c){this.tasks=t,this._onCancel=o,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,o){this._finalized||(this._onComplete(t,o),this._finalized=!0)}}Cb.performDecoding=function(s,t){const o=new Uint8Array(s);return Promise.all(t.tasks.map((c=>{const{layerName:d,firstByte:m,lastByte:g,pixelFormat:b,blockShape:P,blockIndex:I,filters:O,codec:L}=c,k=o.subarray(m,g+1),$=new Uint32Array(P[0]*P[1]*P[2]);let W;if(L!=="gzip_data")throw new Sd(`Unhandled codec: ${L}`);return W=(function(Q,te){if(!globalThis.DecompressionStream&&te==="gzip_data")return Promise.resolve(((me=(function(Fe){Fe[0]==31&&Fe[1]==139&&Fe[2]==8||vh(6,"invalid gzip data");var Be=Fe[3],Ve=10;4&Be&&(Ve+=2+(Fe[10]|Fe[11]<<8));for(var at=(Be>>3&1)+(Be>>4&1);at>0;at-=!Fe[Ve++]);return Ve+(2&Be)})(he=Q))+8>he.length&&vh(6,"invalid gzip data"),(function(Fe,Be,Ve,at){var Ze=Fe.length;if(!Ze||Be.f&&!Be.l)return Ve||new Yu(0);var ft=!Ve,xt=ft||Be.i!=2,Ct=Be.i;ft&&(Ve=new Yu(3*Ze));var Wt,Rt,wt=function(po){var Wi=Ve.length;if(po>Wi){var Ai=new Yu(Math.max(2*Wi,po));Ai.set(Ve),Ve=Ai}},Dt=Be.f||0,ot=Be.p||0,it=Be.b||0,At=Be.l,jt=Be.d,It=Be.m,dr=Be.n,_r=8*Ze;do{if(!At){Dt=yh(Fe,ot,1);var ir=yh(Fe,ot+1,3);if(ot+=3,!ir){var Jt=Fe[(Ie=4+((ot+7)/8|0))-4]|Fe[Ie-3]<<8,Hr=Ie+Jt;if(Hr>Ze){Ct&&vh(0);break}xt&&wt(it+Jt),Ve.set(Fe.subarray(Ie,Hr),it),Be.b=it+=Jt,Be.p=ot=8*Hr,Be.f=Dt;continue}if(ir==1)At=$K,jt=WK,It=9,dr=5;else if(ir==2){var rr=yh(Fe,ot,31)+257,Rr=yh(Fe,ot+10,15)+4,Qr=rr+yh(Fe,ot+5,31)+1;ot+=14;for(var gn=new Yu(Qr),kn=new Yu(19),tn=0;tn<Rr;++tn)kn[NK[tn]]=yh(Fe,ot+3*tn,7);ot+=3*Rr;var Kn=$T(kn),Qn=(1<<Kn)-1,no=qv(kn,Kn);for(tn=0;tn<Qr;){var Ie,Se=no[yh(Fe,ot,Qn)];if(ot+=15&Se,(Ie=Se>>4)<16)gn[tn++]=Ie;else{var mt=0,Zt=0;for(Ie==16?(Zt=3+yh(Fe,ot,3),ot+=2,mt=gn[tn-1]):Ie==17?(Zt=3+yh(Fe,ot,7),ot+=3):Ie==18&&(Zt=11+yh(Fe,ot,127),ot+=7);Zt--;)gn[tn++]=mt}}var gt=gn.subarray(0,rr),er=gn.subarray(rr);It=$T(gt),dr=$T(er),At=qv(gt,It),jt=qv(er,dr)}else vh(1);if(ot>_r){Ct&&vh(0);break}}xt&&wt(it+131072);for(var Tr=(1<<It)-1,wr=(1<<dr)-1,ln=ot;;ln=ot){var Ur=(mt=At[WT(Fe,ot)&Tr])>>4;if((ot+=15&mt)>_r){Ct&&vh(0);break}if(mt||vh(2),Ur<256)Ve[it++]=Ur;else{if(Ur==256){ln=ot,At=null;break}var vr=Ur-254;Ur>264&&(vr=yh(Fe,ot,(1<<(Gr=gk[tn=Ur-257]))-1)+xk[tn],ot+=Gr);var Hn=jt[WT(Fe,ot)&wr],bi=Hn>>4;if(Hn||vh(3),ot+=15&Hn,er=UK[bi],bi>3){var Gr=_k[bi];er+=WT(Fe,ot)&(1<<Gr)-1,ot+=Gr}if(ot>_r){Ct&&vh(0);break}xt&&wt(it+131072);var On=it+vr;if(it<er){var wi=0-er,ci=Math.min(er,On);for(wi+it<0&&vh(3);it<ci;++it)Ve[it]=(void 0)[wi+it]}for(;it<On;++it)Ve[it]=Ve[it-er]}}Be.l=At,Be.p=ln,Be.b=it,Be.f=Dt,At&&(Dt=1,Be.m=It,Be.d=jt,Be.n=dr)}while(!Dt);return it!=Ve.length&&ft?(Wt=Ve,((Rt=it)==null||Rt>Wt.length)&&(Rt=Wt.length),new Yu(Wt.subarray(0,Rt))):Ve.subarray(0,it)})(he.subarray(me,-8),{i:2},new Yu(((ne=he)[(ue=ne.length)-4]|ne[ue-3]<<8|ne[ue-2]<<16|ne[ue-1]<<24)>>>0))));var ne,ue,he,me;const Ae=YK[te];if(!Ae)throw new Error(`Unhandled codec: ${te}`);const Pe=new globalThis.DecompressionStream(Ae);return new Response(new Blob([Q]).stream().pipeThrough(Pe)).arrayBuffer().then((Fe=>new Uint8Array(Fe)))})(k,L).then((Q=>((function(te,ne){te.readFields(LK,ne)})(new qT(Q),$),new XK[b]($.buffer)))),W.then((Q=>{for(let te=O.length-1;te>=0;te--)switch(O[te]){case"delta_filter":FK(Q,P);break;case"zigzag_filter":kK(Q);break;case"bitshuffle_filter":BK(Q,b);break;default:throw new Sd(`Unhandled filter "${O[te]}"`)}return{layerName:d,blockIndex:I,data:Q}})).catch((Q=>{throw Q}))})))},cr(Ek,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),cr(Cb,"MapboxRasterTile"),cr(Tk,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class Pk{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const c=t[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class Ik{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new tl(Ut,16,0),this.featureIndexArray=new vg,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(t,o,c,d,m,g=0,b=0){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,d,m,g);const I=this.grid;for(let O=0;O<o.length;O++){const L=o[O],k=[1/0,1/0,-1/0,-1/0];for(let $=0;$<L.length;$++){const W=L[$];k[0]=Math.min(k[0],W.x),k[1]=Math.min(k[1],W.y),k[2]=Math.max(k[2],W.x),k[3]=Math.max(k[3],W.y)}b!==0&&(k[0]-=b,k[1]-=b,k[2]+=b,k[3]+=b),k[0]<Ut&&k[1]<Ut&&k[2]>=0&&k[3]>=0&&I.insert(P,k[0],k[1],k[2],k[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new mr(new ob(this.rawTileData)).layers,this.sourceLayerCoder=new Pk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,o){const{tilespaceGeometry:c,transform:d,tileTransform:m,pixelPosMatrix:g,availableImages:b,worldview:P}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const I=o.queryRadius?o.queryRadius:0,O=c.bufferedTilespaceBounds,L=this.grid.query(O.min.x,O.min.y,O.max.x,O.max.y,((Q,te,ne,ue)=>Bi(c.bufferedTilespaceGeometry,Q-I,te-I,ne+I,ue+I)));L.sort(KK);let k=null;d.elevation&&L.length>0&&(k=G_.create(d.elevation,this.tileID));const $={};let W;for(let Q=0;Q<L.length;Q++){const te=L[Q];if(te===W)continue;W=te;const ne=this.featureIndexArray.get(te);let ue=null;this.is3DTile?this.loadMatchingModelFeature($,ne,t,c,d,P):this.loadMatchingFeature($,ne,t,b,P,((he,me,Ae,Pe=0)=>(ue||(ue=dt(he,this.tileID.canonical,m)),me.queryIntersectsFeature(c,he,Ae,ue,this.z,d,g,k,Pe))))}return $}loadMatchingFeature(t,o,c,d,m,g){const{featureIndex:b,bucketIndex:P,sourceLayerIndex:I,layoutVertexArrayOffset:O}=o,L=this.bucketLayerIDs[P],k=c.layers,$=Object.keys(k);if($.length&&!jr($,L))return;const W=c.sourceCache,Q=this.sourceLayerCoder.decode(I),te=this.vtLayers[Q].feature(b),ne=this.getId(te,Q);for(let ue=0;ue<L.length;ue++){const he=L[ue];if(!k[he])continue;const{styleLayer:me,targets:Ae}=k[he];let Pe={};ne!==void 0&&(Pe=W.getFeatureState(me.sourceLayer,ne));const Fe=!g||g(te,me,Pe,O);if(!Fe)continue;const Be=new Dg(te,this.z,this.x,this.y,ne);Be.tile=this.tileID.canonical,Be.state=Pe;let Ve=this.serializedLayersCache.get(he);Ve||(Ve=me.serialize(),Ve.id=he,this.serializedLayersCache.set(he,Ve)),Be.source=Ve.source,Be.sourceLayer=Ve["source-layer"],Be.layer=Object.assign({},Ve),Be.layer.paint=Mk(Ve.paint,me.paint,te,Pe,d),Be.layer.layout=Mk(Ve.layout,me.layout,te,Pe,d);let at=!1;for(const Ze of Ae){this.updateFeatureProperties(Be,Ze);const{filter:ft}=Ze;if(ft){if(te.properties=Be.properties,ft.needGeometry){const xt=rt(te,!0);if(!ft.filter(new mi(this.tileID.overscaledZ,{worldview:m}),xt,this.tileID.canonical))continue}else if(!ft.filter(new mi(this.tileID.overscaledZ,{worldview:m}),te))continue}at=!0,Ze.targetId&&this.addFeatureVariant(Be,Ze)}at&&this.appendToResult(t,he,b,Be,Fe)}}loadMatchingModelFeature(t,o,c,d,m,g){const{featureIndex:b,bucketIndex:P}=o,I=this.bucketLayerIDs[P],O=c.layers,L=Object.keys(O);if(!L.length||jr(L,I))for(let k=0;k<I.length;k++){const $=I[k],{styleLayer:W,targets:Q}=O[$];if(W.type!=="model")continue;const te=d.tile,ne=te.getBucket(W);if(!(ne&&ne instanceof wb))continue;const ue=nK(ne,b,d,m);if(!ue)continue;const{z:he,x:me,y:Ae}=te.tileID.canonical,{feature:Pe,intersectionZ:Fe,position:Be}=ue;let Ve={};Pe.id!==void 0&&(Ve=c.sourceCache.getFeatureState(W.sourceLayer,Pe.id));const at=new Dg({},he,me,Ae,Pe.id);at.tile=this.tileID.canonical,at.state=Ve,at.properties=Pe.properties,at.geometry={type:"Point",coordinates:[Be.lng,Be.lat]};let Ze=this.serializedLayersCache.get($);Ze||(Ze=W.serialize(),Ze.id=$,this.serializedLayersCache.set($,Ze)),at.source=Ze.source,at.sourceLayer=Ze["source-layer"],at.layer=Object.assign({},Ze);let ft=!1;for(const xt of Q){this.updateFeatureProperties(at,xt);const{filter:Ct}=xt;if(Ct){if(Pe.properties=at.properties,Ct.needGeometry){if(!Ct.filter(new mi(this.tileID.overscaledZ,{worldview:g}),Pe,this.tileID.canonical))continue}else if(!Ct.filter(new mi(this.tileID.overscaledZ,{worldview:g}),Pe))continue}ft=!0,xt.targetId&&this.addFeatureVariant(at,xt)}ft&&this.appendToResult(t,$,b,at,Fe)}}updateFeatureProperties(t,o,c){if(o.properties){const d={};for(const m in o.properties){const g=o.properties[m].evaluate({zoom:this.z},t._vectorTileFeature,t.state,t.tile,c);g!=null&&(d[m]=g)}t.properties=d}}addFeatureVariant(t,o,c){const d={target:o.target,namespace:o.namespace,uniqueFeatureID:o.uniqueFeatureID};o.properties&&(d.properties=t.properties),t.variants=t.variants||{},t.variants[o.targetId]=t.variants[o.targetId]||[],t.variants[o.targetId].push(d)}appendToResult(t,o,c,d,m){let g=t[o];g===void 0&&(g=t[o]=[]),g.push({featureIndex:c,feature:d,intersectionZ:m})}lookupSymbolFeatures(t,o,c,d,m,g){const b={};this.loadVTLayers();for(const P of t)this.loadMatchingFeature(b,{bucketIndex:o,sourceLayerIndex:c,featureIndex:P,layoutVertexArrayOffset:0},d,m,g);return b}loadFeature(t){const{featureIndex:o,sourceLayerIndex:c}=t;this.loadVTLayers();const d=this.sourceLayerCoder.decode(c),m=this.vtFeatures[d];if(m[o])return m[o];const g=this.vtLayers[d].feature(o);return m[o]=g,g}hasLayer(t){for(const o of this.bucketLayerIDs)for(const c of o)if(t===c)return!0;return!1}getId(t,o){let c=t.id;if(this.promoteId){const d=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[o];if(d!=null)if(Array.isArray(d)){if(!this.promoteIdExpression){const m=el(d);if(m.result!=="success"){const g=m.value.map((b=>`${b.key}: ${b.message}`)).join(", ");return void Cr(`Failed to create expression for promoteId: ${g}`)}this.promoteIdExpression=m.value}c=this.promoteIdExpression.evaluate({zoom:0},t)}else c=t.properties[d];typeof c=="boolean"&&(c=Number(c))}return c}}function Mk(s,t,o,c,d){return Ot(s,((m,g)=>{const b=t instanceof $c?t.get(g):null;return b&&b.evaluate?b.evaluate(o,c,void 0,d):b}))}function KK(s,t){return t-s}cr(Ik,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const Ck=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class GT{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=c>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const m=Ck[15&c];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new GT(b,g,m,t)}constructor(t,o=64,c=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=Ck.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-b%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${c}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+P,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+b+P),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+P,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=o,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return HT(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:b}=this,P=[0,m.length-1,0],I=[];for(;P.length;){const O=P.pop()||0,L=P.pop()||0,k=P.pop()||0;if(L-k<=b){for(let te=k;te<=L;te++){const ne=g[2*te],ue=g[2*te+1];ne>=t&&ne<=c&&ue>=o&&ue<=d&&I.push(m[te])}continue}const $=k+L>>1,W=g[2*$],Q=g[2*$+1];W>=t&&W<=c&&Q>=o&&Q<=d&&I.push(m[$]),(O===0?t<=W:o<=Q)&&(P.push(k),P.push($-1),P.push(1-O)),(O===0?c>=W:d>=Q)&&(P.push($+1),P.push(L),P.push(1-O))}return I}within(t,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:m,nodeSize:g}=this,b=[0,d.length-1,0],P=[],I=c*c;for(;b.length;){const O=b.pop()||0,L=b.pop()||0,k=b.pop()||0;if(L-k<=g){for(let te=k;te<=L;te++)Dk(m[2*te],m[2*te+1],t,o)<=I&&P.push(d[te]);continue}const $=k+L>>1,W=m[2*$],Q=m[2*$+1];Dk(W,Q,t,o)<=I&&P.push(d[$]),(O===0?t-c<=W:o-c<=Q)&&(b.push(k),b.push($-1),b.push(1-O)),(O===0?t+c>=W:o+c>=Q)&&(b.push($+1),b.push(L),b.push(1-O))}return P}}function HT(s,t,o,c,d,m){if(d-c<=o)return;const g=c+d>>1;Ak(s,t,g,c,d,m),HT(s,t,o,c,g-1,1-m),HT(s,t,o,g+1,d,1-m)}function Ak(s,t,o,c,d,m){for(;d>c;){if(d-c>600){const I=d-c+1,O=o-c+1,L=Math.log(I),k=.5*Math.exp(2*L/3),$=.5*Math.sqrt(L*k*(I-k)/I)*(O-I/2<0?-1:1);Ak(s,t,o,Math.max(c,Math.floor(o-O*k/I+$)),Math.min(d,Math.floor(o+(I-O)*k/I+$)),m)}const g=t[2*o+m];let b=c,P=d;for(Hv(s,t,c,o),t[2*d+m]>g&&Hv(s,t,c,d);b<P;){for(Hv(s,t,b,P),b++,P--;t[2*b+m]<g;)b++;for(;t[2*P+m]>g;)P--}t[2*c+m]===g?Hv(s,t,c,P):(P++,Hv(s,t,P,d)),P<=o&&(c=P+1),o<=P&&(d=P-1)}}function Hv(s,t,o,c){YT(s,o,c),YT(t,2*o,2*c),YT(t,2*o+1,2*c+1)}function YT(s,t,o){const c=s[t];s[t]=s[o],s[o]=c}function Dk(s,t,o,c){const d=s-o,m=t-c;return d*d+m*m}i.$=Ou,i.A=zl,i.B=xd,i.C=2,i.D=O_,i.E=sa,i.F=Cv,i.G=nF,i.H=od,i.I=pi,i.J=sm,i.K=au,i.L=lu,i.M=tp,i.N=Kp,i.O=Zh,i.P=St,i.Q=Kh,i.R=ms,i.S=rh,i.T=iT,i.U=el,i.V=bb,i.W=ip,i.X=Nh,i.Y=Gd,i.Z=Hf,i._=gs,i.a=function(s){return ii.API_CDN_URL_REGEX.test(s)},i.a$=$a,i.a0=Vr,i.a1=Oc,i.a2=nh,i.a3=class extends bb{},i.a4=rp,i.a5=Jd,i.a6=Ye,i.a7=function(s){const t=s.value;return t?Vr(t)?LT(t,!0)?[]:[new bb(s.key,t,`invalid url "${t}"`)]:[new bb(s.key,t,`string expected, "${au(t)}" found`)]:[]},i.a8=im,i.a9=to,i.aA=le,i.aB=pe,i.aC=Bo,i.aD=oo,i.aE=is,i.aF=ce,i.aG=st,i.aH=function(s,t){const o={};for(let c=0;c<t.length;c++){const d=t[c];d in s&&(o[d]=s[d])}return o},i.aI=U,i.aJ=ae,i.aK=class{constructor(s){this.entries={},this.scheduler=s}request(s,t,o,c){const d=this.entries[s]=this.entries[s]||{callbacks:[]};if(d.result){const[m,g]=d.result;return this.scheduler?this.scheduler.add((()=>{c(m,g)}),t):c(m,g),()=>{}}return d.callbacks.push(c),d.cancel||(d.cancel=o(((m,g)=>{d.result=[m,g];for(const b of d.callbacks)this.scheduler?this.scheduler.add((()=>{b(m,g)}),t):b(m,g);setTimeout((()=>delete this.entries[s]),3e3)}))),()=>{d.result||(d.callbacks=d.callbacks.filter((m=>m!==c)),d.callbacks.length||(d.cancel(),delete this.entries[s]))}}},i.aL=function(s,t,o){const c=JSON.stringify(s.request);return s.data&&(this.deduped.entries[c]={result:[null,s.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},(d=>{const m=hl(s.request,((g,b,P)=>{g?d(g):b&&d(null,{vectorTile:o?void 0:new mr(new ob(b)),rawData:b,responseHeaders:new Map(P.entries())})}));return()=>{m.cancel(),d()}}),t)},i.aM=function(s){return s?{cacheControl:s.get("Cache-Control"),expires:s.get("Expires")}:{cacheControl:void 0,expires:void 0}},i.aN=function(s){Us++,Us>es&&(s.getActor().send("enforceCacheSizeLimit",oc),Us=0)},i.aO=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log2(s)))},i.aP=N,i.aQ=RF,i.aR=BF,i.aS=q,i.aT=DF,i.aU=function(s,t){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){t(null,o)};for(let c=0;c<s.length;c++){const d=document.createElement("source");bn(s[c])||(o.crossOrigin="Anonymous"),d.src=s[c],o.appendChild(d)}return{cancel:()=>{}}},i.aV=Tv,i.aW=Rg,i.aX=Je,i.aY=Ov,i.aZ=ye,i.a_=fe,i.aa=zt,i.ab=class{constructor(s){this.specification=s}possiblyEvaluate(s,t){return Cn(s.expression.evaluate(t))}interpolate(s,t,o){return{x:Lr(s.x,t.x,o),y:Lr(s.y,t.y,o),z:Lr(s.z,t.z,o),azimuthal:Lr(s.azimuthal,t.azimuthal,o),polar:Lr(s.polar,t.polar,o)}}},i.ac=mi,i.ad=xl,i.ae=He,i.af=Yr,i.ag=Or,i.ah=we,i.ai=$c,i.aj=bm,i.ak=Lr,i.al=Ut,i.am=iu,i.an=vn,i.ao=zn,i.ap=class{constructor(s){this.specification=s}possiblyEvaluate(s,t){return(function([o,c]){const d=Cn([1,o,c]);return{x:d.x,y:d.y,z:d.z}})(s.expression.evaluate(t))}interpolate(s,t,o){return{x:Lr(s.x,t.x,o),y:Lr(s.y,t.y,o),z:Lr(s.z,t.z,o)}}},i.aq=function(s,t,o=0,c=!0){const d=new St(o,o),m=s.sub(d),g=t.add(d),b=[m,new St(g.x,m.y),g,new St(m.x,g.y)];return c&&b.push(m.clone()),b},i.ar=function(s,t){const o=[];for(let c=0;c<s.length;c++){const d=Oe(c-1,-1,s.length-1),m=Oe(c+1,-1,s.length-1),g=s[c],b=s[m],P=s[d].sub(g).unit(),I=b.sub(g).unit(),O=I.angleWithSep(P.x,P.y),L=P.add(I).unit().mult(-1*t/Math.sin(O/2));o.push(g.add(L))}return o},i.as=gF,i.at=Bi,i.au=function(s,t,o=0){return or(((t.x-o)*s.scale-s.x)*Ut,(t.y*s.scale-s.y)*Ut,Me(t.z,t.y))},i.av=Xn,i.aw=sr,i.ax=sn,i.ay=Az,i.az=function(s){let t=1/0,o=1/0,c=-1/0,d=-1/0;for(const m of s)t=Math.min(t,m.x),o=Math.min(o,m.y),c=Math.max(c,m.x),d=Math.max(d,m.y);return{min:new St(t,o),max:new St(c,d)}},i.b=function(s){return ii.API_FONTS_REGEX.test(s)},i.b$=GS,i.b0=Li,i.b1=nt,i.b2=gg,i.b3=_b,i.b4=function(){da.isLoading()||da.isLoaded()||zs()!=="deferred"||tf()},i.b5=lp,i.b6=rt,i.b7=Dg,i.b8=Qi,i.b9=hT,i.bA=ke,i.bB=H,i.bC=function(s,t){const{x:o,y:c}=s.point,d=jx(o,c,s.worldSize/s._pixelsPerMercatorPixel,0,0);return pe(d,d,fa(an(t)))},i.bD=z,i.bE=di,i.bF=bt,i.bG=Vt,i.bH=hn,i.bI=Br,i.bJ=V_,i.bK=Hc,i.bL=xT,i.bM=function(s,t,o,c,d){const m=5*t+2;s.float32[m+0]=o,s.float32[m+1]=c,s.float32[m+2]=d},i.bN=q_,i.bO=js,i.bP=Is,i.bQ=wa,i.bR=Dc,i.bS=Oe,i.bT=function(s,t,o,c){var d=new R(4);return d[0]=s,d[1]=t,d[2]=o,d[3]=c,d},i.bU=class{isDataAvailableAtPoint(s){const t=this._source();if(this.isUsingMockSource()||!t||s.y<0||s.y>1)return!1;const o=t.getSource().maxzoom,c=1<<o,d=Math.floor(s.x),m=Math.floor((s.x-d)*c),g=Math.floor(s.y*c),b=this.findDEMTileFor(new N(o,d,o,m,g));return!(!b||!b.dem)}getAtPointOrZero(s,t=0){return this.getAtPoint(s,t)||0}getAtPoint(s,t,o=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const c=this._source();if(!c||s.y<0||s.y>1)return t;const d=c.getSource().maxzoom,m=1<<d,g=Math.floor(s.x),b=s.x-g,P=new N(d,g,d,Math.floor(b*m),Math.floor(s.y*m)),I=this.findDEMTileFor(P);if(!I||!I.dem)return t;const O=I.dem,L=1<<I.tileID.canonical.z,k=(b*L-I.tileID.canonical.x)*O.dim,$=(s.y*L-I.tileID.canonical.y)*O.dim,W=Math.floor(k),Q=Math.floor($);return(o?this.exaggeration():1)*Lr(Lr(O.get(W,Q),O.get(W,Q+1),$-Q),Lr(O.get(W+1,Q),O.get(W+1,Q+1),$-Q),k-W)}static getAtTileOffset(s,t,o,c){const d=1<<s.canonical.z;return c?c.pointElevation(t):o?o.getAtPointOrZero(new He(s.wrap+(s.canonical.x+t.x/Ut)/d,(s.canonical.y+t.y/Ut)/d)):0}static getAtTileOffsetFunc(s,t,o,c){return(d,m,g)=>{const b=this.getAtTileOffset(s,d,m,g),P=c.upVector(s.canonical,d.x,d.y);return _t(P,P,b*c.upVectorScale(s.canonical,t,o).metersToTile),P}}getForTilePoints(s,t,o,c){if(this.isUsingMockSource())return!1;const d=G_.create(this,s,c);return!!d&&(t.forEach((m=>{m[2]=this.exaggeration()*d.getElevationAt(m[0],m[1],o)})),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(s);if(!t||!t.dem)return null;const o=t.dem.tree,c=t.tileID,d=1<<s.canonical.z-c.canonical.z;let m=s.canonical.x/d-c.canonical.x,g=s.canonical.y/d-c.canonical.y,b=0;for(let P=0;P<s.canonical.z-c.canonical.z&&!o.leaves[b];P++){m*=2,g*=2;const I=2*Math.floor(g)+Math.floor(m);b=o.childOffsets[b]+I,m%=1,g%=1}return{min:this.exaggeration()*o.minimums[b],max:this.exaggeration()*o.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,t,o){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const s=this.visibleDemTiles;if(s.length===0)return null;let t=!1,o=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const d of s){const m=this.getMinMaxForTile(d.tileID);m&&(o=Math.min(o,m.min),c=Math.max(c,m.max),t=!0)}return t?{min:o,max:c}:null}},i.bV=Yx,i.bW=_o,i.bX=pa,i.bY=PL,i.bZ=jF,i.b_=AL,i.ba=$S,i.bb=dt,i.bc=nl,i.bd=af,i.be=Yt,i.bf=Wn,i.bg=D_,i.bh=RT,i.bi=function(s,t){const o=bm(t.zoom);if(o===0)return an(s);const c=Bt(s),d=kr(c),m=ce(c.getWest())*t.worldSize,g=ce(c.getEast())*t.worldSize,b=ae(c.getNorth())*t.worldSize,P=ae(c.getSouth())*t.worldSize,I=[m,b,0],O=[g,b,0],L=[m,P,0],k=[g,P,0],$=se([],t.globeMatrix);return Yr(I,I,$),Yr(O,O,$),Yr(L,L,$),Yr(k,k,$),d[0]=Io(d[0],L,o),d[1]=Io(d[1],k,o),d[2]=Io(d[2],O,o),d[3]=Io(d[3],I,o),Jr.fromPoints(d)},i.bj=Gn,i.bk=se,i.bl=mn,i.bm=Io,i.bn=sh,i.bo=ut,i.bp=ze,i.bq=ve,i.br=Cb,i.bs=ob,i.bt=hl,i.bu=function(s,t){const o=[];for(const c in s)c in t||o.push(c);return o},i.bv=Le,i.bw=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bx=Ns,i.by=Z,i.bz=J,i.c=To,i.c$=function(s){return s*s*s*s*s},i.c0=yT,i.c1=uF,i.c2=ET,i.c3=GT,i.c4=_t,i.c5=Lo,i.c6=va,i.c7=function(s,t,o){o*=.5;var c=t[0],d=t[1],m=t[2],g=t[3],b=Math.sin(o),P=Math.cos(o);return s[0]=c*P+d*b,s[1]=d*P-c*b,s[2]=m*P+g*b,s[3]=g*P-m*b,s},i.c8=xa,i.c9=si,i.cA=qn,i.cB=pz,i.cC=S,i.cD=vt,i.cE=function(s,t,o,c,d,m,g,b,P){if(P.name==="globe")return vt(s,t,new S(o,c,d),!1);const I=Ov({z:o,x:c,y:d},P);return new Jr([(m+I.x/I.scale)*t,t*(I.y/I.scale),g],[(m+I.x2/I.scale)*t,t*(I.y2/I.scale),b])},i.cF=function(s,t,o){return s[0]=Math.min(t[0],o[0]),s[1]=Math.min(t[1],o[1]),s[2]=Math.min(t[2],o[2]),s[3]=Math.min(t[3],o[3]),s},i.cG=function(s,t,o){return s[0]=Math.max(t[0],o[0]),s[1]=Math.max(t[1],o[1]),s[2]=Math.max(t[2],o[2]),s[3]=Math.max(t[3],o[3]),s},i.cH=function(s){const t=Math.round((s+45+360)%360/90)%4;return Sa[t]},i.cI=xe,i.cJ=Ko,i.cK=n,i.cL=function(s){const t=J(new Float64Array(16));pe(t,s.pixelMatrix,s.globeMatrix);const o=[0,w,0],c=[0,E,0];return Yr(o,o,t),Yr(c,c,t),[o[0]>0&&o[0]<=s.width&&o[1]>0&&o[1]<=s.height&&!zS(s,new q(s.center.lat,90)),c[0]>0&&c[0]<=s.width&&c[1]>0&&c[1]<=s.height&&!zS(s,new q(s.center.lat,-90))]},i.cM=function(s,t){const{scale:o}=s.tileTransform,c=o*Ut/(s.tileSize*Math.pow(2,t.zoom-s.tileID.overscaledZ+s.tileID.canonical.z));return(function(d,m,g){var b=m[1],P=m[2],I=m[3],O=g[0],L=g[1];return d[0]=m[0]*O,d[1]=b*O,d[2]=P*L,d[3]=I*L,d})(new Float32Array(4),t.inverseAdjustmentMatrix,[c,c])},i.cN=Jx,i.cO=Ir,i.cP=fz,i.cQ=function(s){const t=fz(s,!0);return z([],[t[0],t[1],t[4],t[5]])},i.cR=Ne,i.cS=ti,i.cT=_e,i.cU=function(s){const{x:t,y:o}=s.point,{lng:c,lat:d}=s._center;return jx(t,o,s.worldSize,c,d)},i.cV=Gt,i.cW=So,i.cX=K,i.cY=ao,i.cZ=h,i.c_=function(s,t,o){let c=0;for(let d=0;d<2;++d)s[d]>0&&(c+=(s[d]-0)*(s[d]-0)),t[d]<0&&(c+=(0-t[d])*(0-t[d]));return c},i.ca=function(s,t){return s[0]=-t[0],s[1]=-t[1],s[2]=-t[2],s[3]=t[3],s},i.cb=Xt,i.cc=function(s,t,o,c,d){var m=1/Math.tan(t/2);if(s[0]=m/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=m,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,d!=null&&d!==1/0){var g=1/(c-d);s[10]=(d+c)*g,s[14]=2*d*c*g}else s[10]=-1,s[14]=-2*c;return s},i.cd=function(s,t,o,c,d,m,g){var b=1/(t-o),P=1/(c-d),I=1/(m-g);return s[0]=-2*b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*P,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*I,s[11]=0,s[12]=(t+o)*b,s[13]=(d+c)*P,s[14]=(g+m)*I,s[15]=1,s},i.ce=de,i.cf=function(s,t,o){s[4*t+0]=o[0],s[4*t+1]=o[1],s[4*t+2]=o[2],s[4*t+3]=o[3]},i.cg=yp,i.ch=wd,i.ci=xo,i.cj=qc,i.ck=xc,i.cl=bF,i.cm=function(){var s=new R(4);return R!=Float32Array&&(s[1]=0,s[2]=0),s[0]=1,s[3]=1,s},i.cn=function(s,t,o){var c=t[0],d=t[1],m=t[2],g=t[3],b=Math.sin(o),P=Math.cos(o);return s[0]=c*P+m*b,s[1]=d*P+g*b,s[2]=c*-b+m*P,s[3]=d*-b+g*P,s},i.co=function(s,t){return s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]&&s[3]===t[3]},i.cp=Ii,i.cq=function(s){var t=s[0],o=s[1],c=s[2],d=s[3];return Math.sqrt(t*t+o*o+c*c+d*d)},i.cr=Cl,i.cs=Si,i.ct=A,i.cu=3,i.cv=2,i.cw=7,i.cx=6,i.cy=Vn,i.cz=nr,i.d=function(s){return ii.API_TILEJSON_REGEX.test(s)},i.d$=QO,i.d0=re,i.d1=45,i.d2=fh,i.d3=function(s,t,o){const c=Math.sqrt(s*s+t*t+o*o),d=c>0?Math.acos(o/c)*Ka:0;let m=s!==0||t!==0?Math.atan2(-t,-s)*Ka+90:0;return m<0&&(m+=360),[c,m,d]},i.d4=or,i.d5=Cn,i.d6=De,i.d7=Et,i.d8=Jr,i.d9=qt,i.dA=Xs,i.dB=class extends bl{constructor(s){super(s),this.current=A_}set(s,t,o){if(this.fetchUniformLocation(s,t)){for(let c=0;c<9;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},i.dC=cl,i.dD=function(s,t,o){const c=bm(o.zoom),d=s.style.map._antialias,m=s.terrain&&s.terrain.exaggeration()>0;return c===0&&!d&&!m},i.dE=function(s){const t=s.pixelsPerMeter,o=t/de(1,s.center.lat),c=J(new Float64Array(16));return ve(c,c,[s.point.x,s.point.y,0]),Ne(c,c,[o,o,t]),Float32Array.from(c)},i.dF=Bt,i.dG=function(s){const t=xe-5;s=le(s,-t,t)/t*90;const o=Math.pow(Math.abs(Math.sin(vn(s))),3);return Math.round(o*(v.length-1))},i.dH=function(s,t,o,c){const d=t.getNorth(),m=t.getSouth(),g=t.getWest(),b=t.getEast(),P=1<<s.z,I=b-g,O=d-m,L=I/f,k=-O/v[o],$=[0,L,0,k,0,0,d,g,0];if(s.z>0){const W=180/c;G($,$,[W/I+1,0,0,0,W/O+1,0,-.5*W/L,.5*W/k,1])}return $[2]=P,$[5]=s.x,$[8]=s.y,$},i.dI=an,i.dJ=function(s,t,o){const c=J(new Float64Array(16)),d=(t/(1<<s)-.5)*Math.PI*2;return Re(c,o.globeMatrix,d),Float32Array.from(c)},i.dK=lL,i.dL=Er,i.dM=function(s,t){return[Math.pow(s[0],2.2)*t,Math.pow(s[1],2.2)*t,Math.pow(s[2],2.2)*t]},i.dN=F,i.dO=function(s,t){var o=Math.sin(t),c=Math.cos(t);return s[0]=c,s[1]=o,s[2]=0,s[3]=-o,s[4]=c,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},i.dP=Un,i.dQ=ph,i.dR=fi,i.dS=Ei,i.dT=256,i.dU=function(s,t){const o=[0,0,0];return Yr(o,o,Gn(an(t.canonical))),Yr(o,o,s),o},i.dV=s=>({u_matrix:new xc(s),u_texsize:new qc(s),u_pixels_to_tile_units:new Yl(s),u_device_pixel_ratio:new xo(s),u_width_scale:new xo(s),u_floor_width_scale:new xo(s),u_image:new yp(s),u_units_to_pixels:new qc(s),u_tile_units_to_pixels:new xo(s),u_alpha_discard_threshold:new xo(s),u_trim_offset:new qc(s),u_trim_fade_range:new qc(s),u_trim_color:new fh(s),u_emissive_strength:new xo(s),u_zbias_factor:new xo(s),u_tile_to_meter:new xo(s),u_ground_shadow_factor:new wd(s),u_pattern_transition:new xo(s)}),i.dW=s=>({u_matrix:new xc(s),u_pixels_to_tile_units:new Yl(s),u_device_pixel_ratio:new xo(s),u_width_scale:new xo(s),u_floor_width_scale:new xo(s),u_units_to_pixels:new qc(s),u_dash_image:new yp(s),u_gradient_image:new yp(s),u_image_height:new xo(s),u_texsize:new qc(s),u_tile_units_to_pixels:new xo(s),u_alpha_discard_threshold:new xo(s),u_trim_offset:new qc(s),u_trim_fade_range:new qc(s),u_trim_color:new fh(s),u_emissive_strength:new xo(s),u_zbias_factor:new xo(s),u_tile_to_meter:new xo(s),u_ground_shadow_factor:new wd(s)}),i.dX=s=>({u_camera_to_center_distance:new xo(s),u_extrude_scale:new Yl(s),u_device_pixel_ratio:new xo(s),u_matrix:new xc(s),u_inv_rot_matrix:new xc(s),u_merc_center:new qc(s),u_tile_id:new wd(s),u_zoom_transition:new xo(s),u_up_dir:new wd(s),u_emissive_strength:new xo(s)}),i.dY=Zs,i.dZ=cX,i.d_=class{constructor(s,t,o,c){this.context=s,this.format=c,this.size=o,this.texture=s.gl.createTexture();const[d,m,g]=this.size,{gl:b}=s;b.bindTexture(b.TEXTURE_3D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),"data"in t&&t.data&&b.texImage3D(b.TEXTURE_3D,0,this.format,d,m,g,0,rT(this.format),nT(this.format),t.data)}bind(s,t){const{context:o}=this,{gl:c}=o;c.bindTexture(c.TEXTURE_3D,this.texture),s!==this.minFilter&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MAG_FILTER,s),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MIN_FILTER,s),this.minFilter=s),t!==this.wrapS&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_S,t),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_T,t),this.wrapS=t)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}},i.da=function(s){return[Math.pow(s[0],1/2.2),Math.pow(s[1],1/2.2),Math.pow(s[2],1/2.2)]},i.db=hz,i.dc=uT,i.dd=_z,i.de=LT,i.df=function(s,t){return s.readFields(sK,{icons:[]},t)},i.dg=Zx,i.dh=U_,i.di=wT,i.dj=Rc,i.dk=vd,i.dl=yi,i.dm=Oi,i.dn=gr,i.dp=function(s){const t=s.indexOf(oh);return t>=0?s.slice(0,t):s},i.dq=function(s){return s.indexOf(oh)>=0},i.dr=function(s){const t=s.lastIndexOf(oh);return t>=0?s.slice(t+1):""},i.ds=function(s){const t=[],o=s.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},i.dt=function(s,t,o,c){return s.type==="custom"?new JX(s,t):new iK[s.type](s,t,o,c)},i.du=Pt,i.dv=function(s){const t=s.indexOf(oh);return t>=0?s.slice(t+1):""},i.dw=class extends Dg{constructor(s,t){super(s._vectorTileFeature,s._z,s._x,s._y,s.id),s.state&&(this.state=Object.assign({},s.state)),this.target=t.target,this.namespace=t.namespace,t.properties&&(this.properties=t.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=s.source,this.sourceLayer=s.sourceLayer,this.layer=s.layer)}toJSON(){const s=super.toJSON();return s.target=this.target,s.namespace=this.namespace,s}},i.dx=_s,i.dy=dl,i.dz=function(s){return s({pluginStatus:Ys,pluginURL:mu}),_s.on("pluginStateChange",s),s},i.e=ii,i.e$=function([s,t,o]){const c=Math.hypot(s,t,o),d=Math.atan2(s,o),m=.5*Math.PI-Math.acos(-t/c);return new q(So(d),So(m))},i.e0=(s,t,o,c,d,m)=>{const g=s.transform,b=g.projection.name==="globe";let P;if(m.paint.get("circle-pitch-alignment")==="map")if(b){const O=ph(g.zoom,t.canonical)*g._pixelsPerMercatorPixel;P=Float32Array.from([O,0,0,O])}else P=g.calculatePixelsToTileUnitsMatrix(o);else P=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);const I={u_camera_to_center_distance:s.transform.getCameraToCenterDistance(g.projection),u_matrix:s.translatePosMatrix(t.projMatrix,o,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ds.devicePixelRatio,u_extrude_scale:P,u_inv_rot_matrix:IY,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(b){I.u_inv_rot_matrix=c,I.u_merc_center=d,I.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],I.u_zoom_transition=bm(g.zoom);const O=d[0]*Ut,L=d[1]*Ut;I.u_up_dir=g.projection.upVector(new S(0,0,0),O,L)}return I},i.e1=Lz,i.e2=Gs,i.e3=(s,t,o,c,d,m,g,b,P,I)=>{const O=s.transform,L=O.pitch<15?Dz(.07,.7,le((14-O.zoom)/5,0,1)):.07,k=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:Oz(s,t,o,c),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:O.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:d,u_width_scale:m,u_floor_width_scale:g,u_image:0,u_tile_units_to_pixels:Rz(t,O),u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:b,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(k?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:L,u_tile_to_meter:De(t.tileID.canonical,0),u_ground_shadow_factor:P,u_pattern_transition:I}},i.e4=(s,t,o,c,d,m,g,b,P,I)=>{const O=s.transform,L=O.calculatePixelsToTileUnitsMatrix(t),k=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",$=O.pitch<15?Dz(.07,.7,le((14-O.zoom)/5,0,1)):.07;return{u_matrix:Oz(s,t,o,c),u_pixels_to_tile_units:L,u_device_pixel_ratio:m,u_width_scale:g,u_floor_width_scale:b,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:d,u_texsize:zz(o)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Rz(t,s.transform),u_alpha_discard_threshold:0,u_trim_offset:P,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(k?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:$,u_tile_to_meter:De(t.tileID.canonical,0),u_ground_shadow_factor:I}},i.e5=We,i.e6=cv,i.e7=Me,i.e8=oe,i.e9=Hx,i.eA=kT,i.eB=rb,i.eC=tb,i.eD=[1,1,1],i.eE=G_,i.eF=co,i.eG=function(s,t,o,c){var d=t[0],m=t[1],g=t[2],b=t[3];return s[0]=d+c*(o[0]-d),s[1]=m+c*(o[1]-m),s[2]=g+c*(o[2]-g),s[3]=b+c*(o[3]-b),s},i.eH=k_,i.eI=Hl,i.eJ=Wu,i.eK=function(s,t,o,c,d,m,g,b,P,I,O,L,k,$,W,Q){var te=new R(16);return te[0]=s,te[1]=t,te[2]=o,te[3]=c,te[4]=d,te[5]=m,te[6]=g,te[7]=b,te[8]=P,te[9]=I,te[10]=O,te[11]=L,te[12]=k,te[13]=$,te[14]=W,te[15]=Q,te},i.eL=B,i.eM=mp,i.eN=sf,i.eO=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new St(1/0,1/0),max:new St(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(s,t=!1){const o=ML(new St(0,0),new St(Ut,Ut),s),c=[];if(t&&!WS(o,this._globalClipBounds))return c;for(const d of this._activeRegions){if(d.hiddenByOverlap||!WS(o,d))continue;const m=rZ(d.min,d.max,s);c.push({min:m.min,max:m.max,sourceId:this._sourceIds[d.priority],footprint:d.footprint,footprintTileId:d.tileId,order:d.order,clipMask:d.clipMask,clipScope:d.clipScope})}return c}setSources(s){this._setSources(s.map((t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const o=[];for(const c of t.cache.getVisibleCoordinates()){const d=t.cache.getTile(c).buckets[t.layer];d&&d.updateFootprints(c.toUnwrapped(),o)}return o},getOrder:()=>t.order,getClipMask:()=>t.clipMask,getClipScope:()=>t.clipScope}))))}_addSource(s){const t=s.getFootprints();if(t.length===0)return;const o=s.getOrder(),c=s.getClipMask(),d=s.getClipScope();for(const m of t){if(!m.footprint)continue;const g=ML(m.footprint.min,m.footprint.max,m.id);this._activeRegions.push({min:g.min,max:g.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:m.id,footprint:m.footprint,order:o,clipMask:c,clipScope:d})}this._sourceIds.push(s.getSourceId())}_computeReplacement(){this._activeRegions.sort(((t,o)=>t.priority-o.priority||Wx(t.min,o.min)||Wx(t.max,o.max)||t.order-o.order||t.clipMask-o.clipMask||(function(c,d){const m=(g,b)=>g+b;return c.length-d.length||c.reduce(m,"").localeCompare(d.reduce(m,""))})(t.clipScope,o.clipScope)));let s=this._activeRegions.length!==this._prevRegions.length;if(!s){let t=0;for(;!s&&t!==this._activeRegions.length;){const o=this._activeRegions[t],c=this._prevRegions[t];s=o.priority!==c.priority||!IL(o,c)||o.order!==c.order||o.clipMask!==c.clipMask||!Ns(o.clipScope,c.clipScope),this._activeRegions[t].hiddenByOverlap=c.hiddenByOverlap,++t}}if(s){++this._updateTime;for(const o of this._activeRegions)o.order!==mv&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const t=o=>{const c=this._activeRegions;if(o>=c.length)return o;const d=c[o].priority;for(;o<c.length&&c[o].priority===d;)++o;return o};if(this._sourceIds.length>1){let o=0,c=t(o);for(;o!==c;){let d=o;const m=o;for(;d!==c;){const g=this._activeRegions[d];g.hiddenByOverlap=!1;for(let b=0;b<m;b++){const P=this._activeRegions[b];if(!P.hiddenByOverlap&&g.order===mv&&WS(g,P)&&(g.hiddenByOverlap=CL(g.footprint,g.tileId,P.footprint,P.tileId),g.hiddenByOverlap))break}++d}o=c,c=t(o)}}}}_setSources(s){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=s.length-1;t>=0;t--)this._addSource(s[t]);this._computeReplacement()}},i.eP=mv,i.eQ=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.withSkirts.destroy(),s.withoutSkirts.destroy()}_fillGridMeshWithLods(s,t){const o=new nl,c=new Li,d=[],m=s+1+2,g=t[0]+1,b=t[0]+1+(1+t.length),P=(I,O,L)=>{let k=I===m-1?I-2:I===0?I:I-1;return k+=L?24575:0,[k,O]};for(let I=0;I<m;++I)o.emplaceBack(...P(I,0,!0));for(let I=0;I<g;++I)for(let O=0;O<m;++O)o.emplaceBack(...P(O,I,(O===0||O===m-1)&&!0));for(let I=0;I<t.length;++I){const O=t[I];for(let L=0;L<m;++L)o.emplaceBack(...P(L,O,!0))}for(let I=0;I<t.length;++I){const O=c.length,L=t[I]+1+2,k=new Li;for(let Q=0;Q<L-1;Q++){const te=Q===L-2,ne=te?m*(b-t.length+I-Q):m;for(let ue=0;ue<m-1;ue++){const he=Q*m+ue;Q===0||te||ue===0||ue===m-2?(k.emplaceBack(he+1,he,he+ne),k.emplaceBack(he+ne,he+ne+1,he+1)):(c.emplaceBack(he+1,he,he+ne),c.emplaceBack(he+ne,he+ne+1,he+1))}}const $=Wn.simpleSegment(0,O,o.length,c.length-O);for(let Q=0;Q<k.uint16.length;Q+=3)c.emplaceBack(k.uint16[Q],k.uint16[Q+1],k.uint16[Q+2]);const W=Wn.simpleSegment(0,O,o.length,c.length-O);d.push({withoutSkirts:$,withSkirts:W})}return{vertices:o,indices:c,segments:d}}_createGrid(s){const t=this._fillGridMeshWithLods(f,v);this._gridSegments=t.segments,this._gridBuffer=s.createVertexBuffer(t.vertices,Yt.members),this._gridIndexBuffer=s.createIndexBuffer(t.indices,!0)}_createPoles(s){const t=new Li;for(let g=0;g<=f;g++)t.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=s.createIndexBuffer(t,!0);const o=new bd,c=new bd,d=new bd,m=new bd;this._poleSegments=[];for(let g=0,b=0;g<h;g++){const P=360/(1<<g);o.emplaceBack(0,-oo,0,.5,0),c.emplaceBack(0,-oo,0,.5,1),d.emplaceBack(0,-oo,0,.5,.5),m.emplaceBack(0,-oo,0,.5,.5);for(let I=0;I<=f;I++){let O=I/f,L=0;const k=Lr(0,P,O),[$,W,Q]=M(EY,PY,k,oo);o.emplaceBack($,W,Q,O,L),c.emplaceBack($,W,Q,O,1-L);const te=vn(k);O=.5+.5*Math.sin(te),L=.5+.5*Math.cos(te),d.emplaceBack($,W,Q,O,L),m.emplaceBack($,W,Q,O,1-L)}this._poleSegments.push(Wn.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(o,Ke,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(c,Ke,!1),this._texturedPoleNorthVertexBuffer=s.createVertexBuffer(d,Ke,!1),this._texturedPoleSouthVertexBuffer=s.createVertexBuffer(m,Ke,!1)}getGridBuffers(s,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[s].withSkirts:this._gridSegments[s].withoutSkirts]}getPoleBuffers(s,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}},i.eR=EL,i.eS=qe,i.eT=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.eU=ie,i.eV=be,i.eW=function(s,t,o){return s[0]=t[0]/o[0],s[1]=t[1]/o[1],s[2]=t[2]/o[2],s},i.eX=Go,i.eY=D,i.eZ=hr,i.e_=lt,i.ea=WL,i.eb=Sm,i.ec=LL,i.ed=OL,i.ee=Te,i.ef=function(s,t){if(s===t){var o=t[1],c=t[2],d=t[3],m=t[6],g=t[7],b=t[11];s[1]=t[4],s[2]=t[8],s[3]=t[12],s[4]=o,s[6]=t[9],s[7]=t[13],s[8]=c,s[9]=m,s[11]=t[14],s[12]=d,s[13]=g,s[14]=b}else s[0]=t[0],s[1]=t[4],s[2]=t[8],s[3]=t[12],s[4]=t[1],s[5]=t[5],s[6]=t[9],s[7]=t[13],s[8]=t[2],s[9]=t[6],s[10]=t[10],s[11]=t[14],s[12]=t[3],s[13]=t[7],s[14]=t[11],s[15]=t[15];return s},i.eg=QX,i.eh=pn,i.ei=gp,i.ej=256,i.ek=fa,i.el=il,i.em=Re,i.en=function(s,t){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[4],s[4]=t[5],s[5]=t[6],s[6]=t[8],s[7]=t[9],s[8]=t[10],s},i.eo=bd,i.ep=pp,i.eq=vl,i.er=function(s,t,o,c,d){return le((s-t)/(o-t)*(d-c)+c,c,d)},i.es=Bs,i.et=function(s,t){var o=t[0],c=t[1],d=t[2],m=t[3],g=t[4],b=t[5],P=t[6],I=t[7],O=t[8],L=O*g-b*I,k=-O*m+b*P,$=I*m-g*P,W=o*L+c*k+d*$;return W?(s[0]=L*(W=1/W),s[1]=(-O*c+d*I)*W,s[2]=(b*c-d*g)*W,s[3]=k*W,s[4]=(O*o-d*P)*W,s[5]=(-b*o+d*m)*W,s[6]=$*W,s[7]=(-I*o+c*P)*W,s[8]=(g*o-c*m)*W,s):null},i.eu=2,i.ev=xr,i.ew=ra,i.ex=ht,i.ey=function(s,t){var o=new R(3);ht(o,t);var c=1/o[0],d=1/o[1],m=1/o[2],g=t[0]*c,b=t[1]*d,P=t[2]*m,I=t[4]*c,O=t[5]*d,L=t[6]*m,k=t[8]*c,$=t[9]*d,W=t[10]*m,Q=g+O+W,te=0;return Q>0?(te=2*Math.sqrt(Q+1),s[3]=.25*te,s[0]=(L-$)/te,s[1]=(k-P)/te,s[2]=(b-I)/te):g>O&&g>W?(te=2*Math.sqrt(1+g-O-W),s[3]=(L-$)/te,s[0]=.25*te,s[1]=(b+I)/te,s[2]=(k+P)/te):O>W?(te=2*Math.sqrt(1+O-g-W),s[3]=(k-P)/te,s[0]=(b+I)/te,s[1]=.25*te,s[2]=(L+$)/te):(te=2*Math.sqrt(1+W-g-O),s[3]=(b-I)/te,s[0]=(k+P)/te,s[1]=(L+$)/te,s[2]=.25*te),s},i.ez=function(s,t){var o=2*Math.acos(t[3]),c=Math.sin(o/2);return c>C?(s[0]=t[0]/c,s[1]=t[1]/c,s[2]=t[2]/c):(s[0]=1,s[1]=0,s[2]=0),o},i.f=function(s){return btoa(encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,((t,o)=>String.fromCharCode(+("0x"+o)))))},i.f0=ds,i.f1=oT,i.f2=function(s){const t=s.navigator?s.navigator.userAgent:null;return!!(function(o){if(Ti==null){const c=o.navigator?o.navigator.userAgent:null;Ti=!!o.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return Ti})(s)&&!(!t||!(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},i.f3=function(s,t){oc=s,es=t},i.f4=zS,i.f5=XO,i.f6=function(s){const t=[0,0,0],o=J(new Float64Array(16));return pe(o,s.pixelMatrix,s.globeMatrix),Yr(t,t,o),new St(t[0],t[1])},i.f7=function(){const s=bv;s&&(s.isPreloaded()&&s.numActive()===1?(s.release(KS),bv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.f8=function(){Zx().acquire(KS)},i.f9=zs,i.fA=Mt,i.fB=function(s){let t=0;if(new Uint32Array(s,0,1)[0]!==az){const o=new Uint32Array(s,0,7),[,,c,d,m,g]=o;t=o.byteLength+d+m+g+m,(c!==s.byteLength||t>=s.byteLength)&&Cr("Invalid b3dm header information.")}return dz(s,t)},i.fC=function(s,t){const o=uT(s);for(const c of o){for(const d of c.meshes)OZ(d);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(LZ(c.lights,t)))}return o},i.fD=wb,i.fE=Mi,i.fF=rz,i.fG=da,i.fH=Ua,i.fI=function(s){Vs(),ts?.then((t=>{t.keys().then((o=>{for(let c=0;c<o.length-s;c++)t.delete(o[c]).catch((d=>Cr(d.message)))})).catch((o=>Cr(o.message)))})).catch((t=>Cr(t.message)))},i.fa=function(s,t,o=!1){if(Ys===Ua.deferred||Ys===Ua.loading||Ys===Ua.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");mu=Ds.resolveURL(s),Ys=Ua.deferred,sp=t,$o(),o||tf()},i.fb=function(s){L_=Ds.resolveURL(s),z_||(z_=new O_(Zx(),new sa)),z_.broadcast("setMeshoptUrl",L_)},i.fc=oz,i.fd=function(s){JS=Ds.resolveURL(s),z_||(z_=new O_(Zx(),new sa)),z_.broadcast("setDracoUrl",JS)},i.fe=iz,i.ff=xv,i.fg=function(s){const t=Ta();if(!t)return;const o=t.delete(ic);s&&o.then((()=>s())).catch(s)},i.fh=Pg,i.fi=cr,i.fj=wm,i.fk=_h,i.fl=Pk,i.fm=Ik,i.fn=Iz,i.fo=Qt,i.fp="hd_road_elevation",i.fq=qr,i.fr=Ot,i.fs=vp,i.ft=bT,i.fu=Cg,i.fv=function(s,t,o,c,d,m,g,b=1,P,I,O){s.createArrays(),s.tilePixelRatio=Ut/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const L=s.layers[0].layout,k=s.layers[0]._unevaluatedLayout._values,$={};$.scaleFactor=b,$.textSizeScaleRange=L.get("text-size-scale-range"),$.iconSizeScaleRange=L.get("icon-size-scale-range");const[W,Q]=$.textSizeScaleRange,[te,ne]=$.iconSizeScaleRange;$.textScaleFactor=le($.scaleFactor,W,Q),$.iconScaleFactor=le($.scaleFactor,te,ne);const ue=k["text-size"],he=k["icon-size"];if(s.textSizeData.kind==="composite"){const{minZoom:Ve,maxZoom:at}=s.textSizeData;$.compositeTextSizes=[ue.possiblyEvaluate(new mi(Ve,{worldview:O}),m),ue.possiblyEvaluate(new mi(at,{worldview:O}),m)]}if(s.iconSizeData.kind==="composite"){const{minZoom:Ve,maxZoom:at}=s.iconSizeData;$.compositeIconSizes=[he.possiblyEvaluate(new mi(Ve,{worldview:O}),m),he.possiblyEvaluate(new mi(at,{worldview:O}),m)]}$.layoutTextSize=ue.possiblyEvaluate(new mi(g+1,{worldview:O}),m),$.layoutIconSize=he.possiblyEvaluate(new mi(g+1,{worldview:O}),m),$.textMaxSize=ue.possiblyEvaluate(new mi(18,{worldview:O}),m);const me=L.get("symbol-placement"),Ae=L.get("text-rotation-alignment")==="map"&&me!=="point",Pe=L.get("text-size");let Fe=!1;const Be=[];for(const Ve of s.features){const at=L.get("text-font").evaluate(Ve,{},m).join(","),Ze=Pe.evaluate(Ve,{},m)*$.textScaleFactor,ft=$.layoutTextSize.evaluate(Ve,{},m)*$.textScaleFactor,xt=$.layoutIconSize.evaluate(Ve,{},m)*$.iconScaleFactor,Ct={horizontal:{},vertical:void 0},Wt=Ve.text;let Rt,wt=[0,0];if(Wt){const gn=Wt.toString(),kn=L.get("text-letter-spacing").evaluate(Ve,{},m)*pa,tn=L.get("text-line-height").evaluate(Ve,{},m)*pa,Kn=Jh(gn)?kn:0,Qn=L.get("text-anchor").evaluate(Ve,{},m),no=L.get("text-variable-anchor");if(!no){const gt=L.get("text-radial-offset").evaluate(Ve,{},m);if(gt)wt=uF(Qn,[gt*pa,TT]);else{const er=L.get("text-offset").evaluate(Ve,{},m);wt=[er[0]*pa,er[1]*pa]}}let Ie=Ae?"center":L.get("text-justify").evaluate(Ve,{},m);const Se=me==="point",mt=Se?L.get("text-max-width").evaluate(Ve,{},m)*pa:1/0,Zt=gt=>{s.allowVerticalPlacement&&eh(gn)&&(Ct.vertical=_T(Wt,t,o,d,at,mt,tn,Qn,gt,Kn,wt,Hc.vertical,!0,ft,Ze,P))};if(!Ae&&no){const gt=Ie==="auto"?no.map((Tr=>ET(Tr))):[Ie];let er=!1;for(let Tr=0;Tr<gt.length;Tr++){const wr=gt[Tr];if(!Ct.horizontal[wr])if(er)Ct.horizontal[wr]=Ct.horizontal[0];else{const ln=_T(Wt,t,o,d,at,mt,tn,"center",wr,Kn,wt,Hc.horizontal,!1,ft,Ze,P);ln&&(Ct.horizontal[wr]=ln,er=ln.positionedLines.length===1)}}Zt("left")}else{if(Ie==="auto"&&(Ie=ET(Qn)),Se||L.get("text-writing-mode").indexOf("horizontal")>=0||!eh(gn)){const gt=_T(Wt,t,o,d,at,mt,tn,Qn,Ie,Kn,wt,Hc.horizontal,!1,ft,Ze,P);gt&&(Ct.horizontal[Ie]=gt)}Zt(Se?"left":Ie)}}let Dt,ot,it,At,jt,It,dr=!1;const _r=L.get("icon-text-fit").evaluate(Ve,{},m);if(Ve.icon&&Ve.icon.hasPrimary()){const gn=Dv(Ve.icon,s.iconSizeData,k["icon-size"],m,s.zoom,Ve,P,$.iconScaleFactor,O);Dt=gn.iconPrimary,it=gn.iconSecondary;const kn=Dt.toString();if(ot=c.get(kn),ot&&(jt=L.get("icon-offset").evaluate(Ve,{},m),It=L.get("icon-anchor").evaluate(Ve,{},m),Rt=ab(d.get(kn),it?d.get(it.toString()):void 0,jt,It),dr=ot.sdf,s.sdfIcons===void 0?s.sdfIcons=ot.sdf:s.sdfIcons!==ot.sdf&&Cr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ot.pixelRatio!==s.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(s.iconsNeedLinear=!0)),it){const tn=it.toString();At=c.get(tn)}}Fe=Fe||!(!Ve.icon||!Ve.icon.hasSecondary());const ir=PT(Ct.horizontal)||Ct.vertical;s.iconsInText||(s.iconsInText=!!ir&&ir.iconsInText);const Jt=ft*$.textScaleFactor/pa,{defaultShapedIcon:Hr,verticallyShapedIcon:rr}=BX(s,Rt,L,Ve,m,Ct,Jt,jt,_r);_r!=="none"&&Rt&&(Zz(Rt)||Xz(Rt))&&(hb(0,ot,Dt,Rt,Hr,_r,I,c,d),hb(0,At,it,Rt,Hr,_r,I,c,d),rr&&(hb(0,ot,Dt,Rt,rr,_r,I,c,d),hb(0,At,it,Rt,rr,_r,I,c,d))),Rt=Hr;const{iconBBox:Rr,iconVerticalBBox:Qr}=zX(s,Rt,rr,L,Ve,m,xt,jt,$,d,It);Be.push({feature:Ve,shapedTextOrientations:Ct,shapedText:ir,shapedIcon:Rt,iconPrimary:Dt,iconSecondary:it,iconOffset:jt,iconAnchor:It,verticallyShapedIcon:rr,layoutTextSize:ft,layoutIconSize:xt,textOffset:wt,isSDFIcon:dr,iconTextFit:_r,iconCollisionBounds:Rr,iconVerticalCollisionBounds:Qr})}return{featureData:Be,sizes:$,hasAnySecondaryIcon:Fe,textAlongLine:Ae,symbolPlacement:me}},i.fw=iF,i.fx=function(s,t,o,c,d,m,g,b,P,I){s.iconAtlasPositions=I.iconPositions;const{featureData:O,hasAnySecondaryIcon:L,sizes:k,textAlongLine:$,symbolPlacement:W}=t;for(const Q of O){const{shapedIcon:te,verticallyShapedIcon:ne,feature:ue,shapedTextOrientations:he,shapedText:me,layoutTextSize:Ae,textOffset:Pe,isSDFIcon:Fe,iconPrimary:Be,iconSecondary:Ve,iconTextFit:at,iconOffset:Ze,iconCollisionBounds:ft,iconVerticalCollisionBounds:xt}=Q;hF(te,I.iconPositions,Be,Ve),hF(ne,I.iconPositions,Be,Ve),kX(he,I.iconPositions),FX(Be,Ve,I.iconPositions),(me||te)&&jX(s,ue,he,te,ne,P,k,Ae,0,Pe,Fe,c,d,g,b,L,at,Ze,$,W,ft,xt)}o&&s.generateCollisionDebugBuffers(m,s.collisionBoxArray,k.textScaleFactor)},i.fy=mr,i.fz=Mb,i.g=function(s,t){return dl(Object.assign(s,{method:"GET"}),t)},i.h=function(s){return s.indexOf("mapbox:")===0},i.i=function(s){return ii.API_STYLE_REGEX.test(s)&&!To(s)},i.j=Ji,i.k=$s,i.l=function(s){return decodeURIComponent(atob(s).split("").map((t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2))).join(""))},i.m=function(s,t){return dl(Object.assign(s,{type:"json"}),t)},i.n=Ge,i.o=Ds,i.p=function(s,t){return dl(Object.assign(s,{method:"POST"}),t)},i.q=qa,i.r=Ho,i.s=function(s){try{const t=self[s];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=function(){return QS||(QS=new Pg),QS},i.u=function(){return(function s(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)})()},i.v=function(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)},i.w=Cr,i.x=UT,i.y=Yo,i.z=eo})),y(["./shared"],(function(i){function C(qe){const ie=qe?qe.url.toString():void 0;return ie?performance.getEntriesByName(ie):[]}function R(qe){if(typeof qe=="number"||typeof qe=="boolean"||typeof qe=="string"||qe==null)return JSON.stringify(qe);if(Array.isArray(qe)){let le="[";for(const we of qe)le+=`${R(we)},`;return`${le}]`}let ie="{";for(const le of Object.keys(qe).sort())ie+=`${le}:${R(qe[le])},`;return`${ie}}`}function z(qe){let ie="";for(const le of i.bw)ie+=`/${R(qe[le])}`;return ie}class F{constructor(ie){this.keyCache={},this._layers={},this._layerConfigs={},ie&&this.replace(ie)}replace(ie,le){this._layerConfigs={},this._layers={},this.update(ie,[],le)}update(ie,le,we){this._options=we;for(const Le of ie)this._layerConfigs[Le.id]=Le,(this._layers[Le.id]=i.dt(Le,this.scope,null,this._options)).compileFilter(we),this.keyCache[Le.id]&&delete this.keyCache[Le.id];for(const Le of le)delete this.keyCache[Le],delete this._layerConfigs[Le],delete this._layers[Le];this.familiesBySource={};const Oe=(function(Le,Ue){const nt={};for(let Je=0;Je<Le.length;Je++){const Ot=Le[Je];let Pt=Ue&&Ue[Ot.id];Pt||(Ot.type==="symbol"?Pt=Ot.id:(Pt=z(Ot),Ot.type==="line"&&Ot.paint&&(function jr(yr){return typeof yr=="string"&&yr==="line-progress"||(Array.isArray(yr)?yr.some(jr):!(!yr||typeof yr!="object")&&Object.values(yr).some(jr))})(Ot.paint["line-width"])&&(Pt+=`/${R(Ot.paint["line-width"])}`))),Ue&&(Ue[Ot.id]=Pt);let gr=nt[Pt];gr||(gr=nt[Pt]=[]),gr.push(Ot)}const We=[];for(const Je in nt)We.push(nt[Je]);return We})(Object.values(this._layerConfigs),this.keyCache);for(const Le of Oe){const Ue=Le.map((gr=>this._layers[gr.id])),nt=Ue[0];if(nt.visibility==="none")continue;const We=nt.source||"";let Je=this.familiesBySource[We];Je||(Je=this.familiesBySource[We]={});const Ot=nt.sourceLayer||"_geojsonTileLayer";let Pt=Je[Ot];Pt||(Pt=Je[Ot]=[]),Pt.push(Ue)}}}const V=1*i.fk;class G{constructor(ie){const le={},we=[];for(const nt in ie){const We=ie[nt],Je=le[nt]={};for(const Ot in We.glyphs){const Pt=We.glyphs[+Ot];if(!Pt||Pt.bitmap.width===0||Pt.bitmap.height===0)continue;const gr=Pt.metrics.localGlyph?V:1,jr={x:0,y:0,w:Pt.bitmap.width+2*gr,h:Pt.bitmap.height+2*gr};we.push(jr),Je[Ot]=jr}}const{w:Oe,h:Le}=i.G(we),Ue=new i.fj({width:Oe||1,height:Le||1});for(const nt in ie){const We=ie[nt];for(const Je in We.glyphs){const Ot=We.glyphs[+Je];if(!Ot||Ot.bitmap.width===0||Ot.bitmap.height===0)continue;const Pt=le[nt][Je],gr=Ot.metrics.localGlyph?V:1;i.fj.copy(Ot.bitmap,Ue,{x:0,y:0},{x:Pt.x+gr,y:Pt.y+gr},Ot.bitmap)}}this.image=Ue,this.positions=le}}function H(qe,ie,le){qe[ie]?le&&(qe[ie].center=le):qe[ie]={floorIds:new Set,center:le||[0,0],floors:{}}}function Z(qe,ie,le,we){for(const Oe of ie)H(qe,Oe),qe[Oe].floors[le]=we,qe[Oe].floorIds.add(le)}function J(qe){return{id:qe.properties.id.toString(),center:qe.properties.center.toString().split(";").map(Number)}}function se(qe){return{id:qe.properties.id.toString(),isDefault:!!qe.properties.is_default&&qe.properties.is_default,connections:qe.properties.connected_floor_ids?new Set(qe.properties.connected_floor_ids.toString().split(";")):new Set,conflicts:qe.properties.conflicted_floor_ids?new Set(qe.properties.conflicted_floor_ids.toString().split(";")):new Set,buildings:qe.properties.building_ids?new Set(qe.properties.building_ids.toString().split(";")):new Set,name:qe.properties.name.toString(),zIndex:qe.properties.z_index}}function pe(qe,ie){return ie.every((le=>qe.properties&&qe.properties[le]!=null))}function ve(qe){return pe(qe,["type","id","name"])&&qe.properties.type==="building"}function Ne(qe){return pe(qe,["type","id","name","z_index"])&&qe.properties.type==="floor"}i.fi(G,"GlyphAtlas");class _e{constructor(ie){this.tileID=new i.aP(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.lut=ie.lut,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.scope=ie.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ie.showCollisionBoxes,this.collectResourceTiming=!!ie.request&&ie.request.collectResourceTiming,this.promoteId=ie.promoteId,this.isSymbolTile=ie.isSymbolTile,this.tileTransform=i.aY(ie.tileID.canonical,ie.projection),this.projection=ie.projection,this.worldview=ie.worldview,this.localizableLayerIds=ie.localizableLayerIds,this.brightness=ie.brightness,this.extraShadowCaster=!!ie.extraShadowCaster,this.tessellationStep=ie.tessellationStep,this.scaleFactor=ie.scaleFactor,this.worldview=ie.worldview,this.indoor=ie.indoor}parse(ie,le,we,Oe,Le,Ue){this.status="parsing",this.data=ie,this.collisionBoxArray=new i.b2;const nt=new i.fl(Object.keys(ie.layers).sort()),We=new i.fm(this.tileID,this.promoteId);We.bucketLayerIDs=[];const Je={},Ot=new i.fn(256,256),Pt={featureIndex:We,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Ot,availableImages:we,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0,activeFloors:void 0};if(this.indoor){const Cr=this.indoor.indoorState.activeFloorsVisible,Zr=(function(on,Cn,Mi){const Qi=(function(Ln,rn){if(!Ln)return i.w("No source layers defined in indoor specification"),rn;if(Ln.size===0)return rn;const fi=Ln.difference(rn);for(const Ei of fi)i.w(`Missing source layer required in indoor specification: ${Ei}`);return rn.intersection(rn)})(Cn.sourceLayers,new Set(Object.keys(on.layers))),Ti=Cn.indoorState,si=(function(Ln,rn,fi,Ei){const $n=new Set,ii=new Set,Ji=new Set,To=new Map,ps={},Oa=uo=>{const Cs=To.get(uo)||new Set;for(const Jo of $n)if((To.get(Jo)||new Set).has(uo)||Cs.has(Jo))return!0;return!1};for(const uo of rn){const Cs=Ln.layers[uo];if(Cs)for(let Jo=0;Jo<Cs.length;Jo++){const As=Cs.feature(Jo);if(ve(As)){const{id:Ho,center:Ds}=J(As);H(ps,Ho,Ds),$n.add(Ho)}else if(Ne(As)){const{id:Ho,isDefault:Ds,connections:nc,conflicts:yi,buildings:ic,name:oc,zIndex:es}=se(As);Z(ps,ic,Ho,{name:oc,zIndex:es}),To.set(Ho,yi),(Ho===Ei||nc.has(Ei))&&$n.add(Ho),ii.add(Ho),Ds&&Ji.add(Ho)}}else i.w(`indoor source layer not found: ${uo}`)}if(fi)for(const uo of fi)ii.has(uo)&&(Oa(uo)||$n.add(uo));for(const uo of Ji)$n.has(uo)||Oa(uo)||$n.add(uo);return{buildings:ps,activeFloors:$n}})(on,Qi,Ti.lastActiveFloors,Ti.selectedFloorId);return Mi.send("setIndoorData",si),si})(ie,this.indoor,Le);Pt.activeFloors=Cr?Zr.activeFloors:void 0}const gr=[],jr=le.familiesBySource[this.source];for(const Cr in jr){const Zr=ie.layers[Cr];if(!Zr)continue;let on=!1,Cn=!1,Mi=!1;for(const Ln of jr[Cr])Ln[0].type==="symbol"?on=!0:Cn=!0,Ln[0].is3D()&&Ln[0].type!=="model"&&(Mi=!0);if(this.extraShadowCaster&&!Mi||this.isSymbolTile===!0&&!on||this.isSymbolTile===!1&&!Cn)continue;Zr.version===1&&i.w(`Vector tile source "${this.source}" layer "${Cr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Qi=nt.encode(Cr),Ti=[];let si=!1;for(let Ln=0,rn=0;Ln<Zr.length;Ln++){const fi=Zr.feature(Ln),Ei=We.getId(fi,Cr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Cr)){const $n=fi.properties?fi.properties.worldview:null;if(this.worldview&&typeof $n=="string")if($n==="all")fi.properties.$localized=!0;else{if(!$n.split(",").includes(this.worldview))continue;fi.properties.$localized=!0,fi.properties.worldview=this.worldview}}!si&&fi.properties&&fi.properties.hasOwnProperty(i.fo)&&(si=!0),Ti.push({feature:fi,id:Ei,index:rn,sourceLayerIndex:Qi}),rn++}si&&!Pt.elevationFeatures&&ie.layers.hasOwnProperty(i.fp)&&(Pt.elevationFeatures=i.fq.parseFrom(ie.layers[i.fp],this.canonical));for(const Ln of jr[Cr]){const rn=Ln[0];if(this.extraShadowCaster&&(!rn.is3D()||rn.type==="model")||this.isSymbolTile!==void 0&&rn.type==="symbol"!==this.isSymbolTile||rn.minzoom&&this.zoom<Math.floor(rn.minzoom)||rn.maxzoom&&this.zoom>=rn.maxzoom||rn.visibility==="none")continue;Re(Ln,this.zoom,Pt.brightness,we,this.worldview);const fi=Je[rn.id]=rn.createBucket({index:We.bucketLayerIDs.length,layers:Ln,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qi,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Oe,worldview:this.worldview});We.bucketLayerIDs.push(Ln.map(($n=>i.B($n.id,$n.scope))));let Ei=fi.prepare?fi.prepare():null;Ei!=null?(Ei=Ei.then((()=>fi.populate(Ti,Pt,this.tileID.canonical,this.tileTransform))),gr.push(Ei)):fi.populate(Ti,Pt,this.tileID.canonical,this.tileTransform)}}const yr=()=>{let Cr,Zr,on,Cn,Mi,Qi;Ot.trim();const Ti={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},si=()=>{if(Cr)return this.status="done",Ue(Cr);if(this.extraShadowCaster)this.status="done",Ue(null,{buckets:Object.values(Je).filter((rn=>!rn.isEmpty())),featureIndex:We,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Pt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Zr&&on&&Cn){const rn=new G(Zr),fi=new Map;for(const[ii,Ji]of on.entries()){const{imagePosition:To}=i.ft(ii,Ji,i.fu);fi.set(ii,To)}const Ei={};for(const ii in Je){const Ji=Je[ii];Ji instanceof i.b3&&(Re(Ji.layers,this.zoom,Pt.brightness,we,this.worldview),Ei[ii]=i.fv(Ji,Zr,rn.positions,on,fi,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,Mi,this.worldview))}const $n={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Le,on,Mi,(()=>{$n.iconsPending=!1,Ln(Ei,rn,$n)})),this.rasterizeIfNeeded(Le,Cn,Qi,(()=>{$n.patternsPending=!1,Ln(Ei,rn,$n)}))}},Ln=(rn,fi,Ei,$n)=>{if(Ei.iconsPending||Ei.patternsPending)return;const ii=new i.fw(on,Cn,this.lut);for(const Ji in Je){const To=Je[Ji];if(Ji in rn)i.fx(To,rn[Ji],this.showCollisionBoxes,we,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,on,ii);else if(To.hasPattern&&(To instanceof i.b9||To instanceof i.ba||To instanceof i.e9)){Re(To.layers,this.zoom,Pt.brightness,we,this.worldview);const ps=Object.fromEntries(ii.patternPositions);To.addFeatures(Pt,this.tileID.canonical,ps,we,this.tileTransform,this.brightness)}}this.status="done",Ue(null,{buckets:Object.values(Je).filter((Ji=>!Ji.isEmpty())),featureIndex:We,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fi.image,lineAtlas:Ot,imageAtlas:ii,brightness:Pt.brightness})};if(!this.extraShadowCaster){const rn=i.fr(Pt.glyphDependencies,($n=>Object.keys($n).map(Number)));Object.keys(rn).length?Le.send("getGlyphs",{uid:this.uid,stacks:rn},(($n,ii)=>{Cr||(Cr=$n,Zr=ii,si())}),void 0,!1,Ti):Zr={};const fi=Array.from(Pt.iconDependencies.keys()).map(($n=>i.I.parse($n)));fi.length?Le.send("getImages",{images:fi,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(($n,ii)=>{Cr||(Cr=$n,on=new Map,Mi=this.updateImageMapAndGetImageTaskQueue(on,ii,Pt.iconDependencies),si())}),void 0,!1,Ti):(on=new Map,Mi=new Map);const Ei=Array.from(Pt.patternDependencies.keys()).map(($n=>i.I.parse($n)));Ei.length?Le.send("getImages",{images:Ei,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(($n,ii)=>{Cr||(Cr=$n,Cn=new Map,Qi=this.updateImageMapAndGetImageTaskQueue(Cn,ii,Pt.patternDependencies),si())}),void 0,!1,Ti):(Cn=new Map,Qi=new Map)}if(Pt.elevationFeatures&&Pt.elevationFeatures.length>0){const rn=[];for(const Ei of Object.values(Je))if(Ei instanceof i.ba){const $n=Ei.getUnevaluatedPortalGraph();$n&&rn.push($n)}const fi=i.fs.evaluate(rn);for(const Ei of Object.values(Je))if(Ei instanceof i.ba){const $n=ie.layers[nt.decode(Ei.sourceLayerIndex)];Ei.setEvaluatedPortalGraph(fi,$n,this.tileID.canonical,Pt.availableImages,Pt.brightness)}}si()};gr.length>0?Promise.allSettled(gr).then(yr).catch(Ue):yr()}updateParameters(ie){this.scaleFactor=ie.scaleFactor,this.showCollisionBoxes=ie.showCollisionBoxes,this.projection=ie.projection,this.brightness=ie.brightness,this.tileTransform=i.aY(ie.tileID.canonical,ie.projection),this.extraShadowCaster=ie.extraShadowCaster,this.lut=ie.lut,this.worldview=ie.worldview,this.indoor=ie.indoor}rasterizeIfNeeded(ie,le,we,Oe){Array.from(le.values()).some((Le=>Le.usvg))?this.rasterize(ie,le,we,Oe):Oe()}updateImageMapAndGetImageTaskQueue(ie,le,we){const Oe=new Map;for(const Le of le.keys()){const Ue=we.get(Le)||[];for(const nt of Ue){const We=nt.toString(),Je=le.get(nt.id.toString());Je.usvg?Oe.has(We)||(Oe.set(We,nt),ie.set(We,Object.assign({},Je))):ie.set(We,Je)}}return Oe}rasterize(ie,le,we,Oe){this.rasterizeTask=ie.send("rasterizeImages",{scope:this.scope,tasks:we},((Le,Ue)=>{if(!Le)for(const[nt,We]of Ue.entries()){const Je=Object.assign(le.get(nt),{data:We});le.set(nt,Je)}Oe()}))}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function Re(qe,ie,le,we,Oe){const Le=new i.ac(ie,{brightness:le,worldview:Oe});for(const Ue of qe)Ue.recalculate(Le,we)}class ke extends i.E{constructor(ie,le,we,Oe,Le,Ue,nt){super(),this.actor=ie,this.layerIndex=le,this.availableImages=we,this.availableModels=Oe,this.loadVectorData=Ue||i.aL,this.loading={},this.loaded={},this.deduped=new i.aK(ie.scheduler),this.isSpriteLoaded=Le,this.scheduler=ie.scheduler,this.brightness=nt}loadTile(ie,le){const we=ie.uid,Oe=ie&&ie.request,Le=Oe&&Oe.collectResourceTiming,Ue=this.loading[we]=new _e(ie);Ue.abort=this.loadVectorData(ie,((nt,We)=>{const Je=!this.loading[we];if(delete this.loading[we],Ue.cancelRasterize(),Je||nt||!We)return Ue.status="done",Je||(this.loaded[we]=Ue),le(nt);const Ot=We.rawData,Pt={},gr=i.aM(We.responseHeaders);gr&&gr.expires&&(Pt.expires=gr.expires),gr&&gr.cacheControl&&(Pt.cacheControl=gr.cacheControl),Ue.vectorTile=We.vectorTile||new i.fy(new i.bs(Ot));const jr=()=>{Ue.parse(Ue.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,((yr,Cr)=>{if(yr||!Cr)return le(yr);const Zr={};if(Le){const on=C(Oe);on.length>0&&(Zr.resourceTiming=JSON.parse(JSON.stringify(on)))}le(null,Object.assign({rawTileData:Ot.slice(0),responseHeaders:We.responseHeaders},Cr,Pt,Zr))}))};this.isSpriteLoaded?jr():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(jr,{type:"parseTile",isSymbolTile:ie.isSymbolTile,zoom:ie.tileZoom}):jr()})),this.loaded=this.loaded||{},this.loaded[we]=Ue}))}reloadTile(ie,le){const we=this.loaded,Oe=ie.uid;if(we&&we[Oe]){const Le=we[Oe];Le.updateParameters(ie);const Ue=(nt,We)=>{const Je=Le.reloadCallback;Je&&(delete Le.reloadCallback,Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Je)),le(nt,We)};Le.status==="parsing"?Le.reloadCallback=Ue:Le.status==="done"&&(Le.vectorTile?Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Ue):Ue())}else le(null,void 0)}abortTile(ie,le){const we=ie.uid,Oe=this.loading[we];Oe&&(Oe.abort&&Oe.abort(),delete this.loading[we]),le()}removeTile(ie,le){const we=this.loaded,Oe=ie.uid;we&&we[Oe]&&delete we[Oe],le()}}class ze{loadTile(ie,le){const{uid:we,encoding:Oe,rawImageData:Le,padding:Ue}=ie,nt=ImageBitmap&&Le instanceof ImageBitmap?this.getImageData(Le,Ue):Le;le(null,new i.fz(we,nt,Oe,Ue<1))}reloadTile(ie,le){le(null,null)}abortTile(ie,le){le()}removeTile(ie,le){le()}getImageData(ie,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);const we=this.offscreenCanvasContext.getImageData(-le,-le,ie.width+2*le,ie.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),we}}i.br.setPbf(i.bs);class et{constructor(ie){this._mrt=new i.br(ie.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=ie.uid,this.tileID=ie.tileID,this.source=ie.source}parse(ie,le){const we=this._mrt;this.status="parsing",this._entireBuffer=ie;try{we.parseHeader(ie),this._isHeaderLoaded=!0;const Oe=[];for(const Le in we.layers){const Ue=we.getLayer(Le),nt=Ue.getDataRange(Ue.getBandList()),We=we.createDecodingTask(nt),Je=ie.slice(nt.firstByte,nt.lastByte+1),Ot=i.br.performDecoding(Je,We).then((Pt=>We.complete(null,Pt))).catch((Pt=>We.complete(Pt,null)));Oe.push(Ot)}Promise.allSettled(Oe).then((()=>le(null,we))).catch((Le=>le(Le)))}catch(Oe){le(Oe)}}}class ht{constructor(ie){this.actor=ie,this.loading={},this.loaded={}}loadTile(ie,le){const we=ie.uid,Oe=ie.request,Le=this.loading[we]=new et(ie),{cancel:Ue}=i.bt(Oe,((nt,We,Je)=>{const Ot=!this.loading[we];if(delete this.loading[we],Ot||nt||!We)return Le.status="done",Ot||(this.loaded[we]=Le),le(nt);Le.parse(We,((Pt,gr)=>{if(Pt||!gr)return le(Pt);le(null,gr,Je)})),this.loaded[we]=Le}));Le.abort=Ue}reloadTile(ie,le){le(null,void 0)}abortTile(ie,le){const we=ie.uid,Oe=this.loading[we];Oe&&(Oe.abort&&Oe.abort(),delete this.loading[we]),le()}removeTile(ie,le){const we=ie.uid;this.loaded[we]&&delete this.loaded[we],le()}decodeRasterArray(ie,le){i.br.performDecoding(ie.buffer,ie.task).then((we=>le(null,we))).catch((we=>le(we)))}}const Xt=i.fA.prototype.toGeoJSON;class Ir{constructor(ie){this._feature=ie,this.extent=i.al,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))}loadGeometry(){if(this._feature.type===1){const ie=[];for(const le of this._feature.geometry)ie.push([new i.P(le[0],le[1])]);return ie}{const ie=[];for(const le of this._feature.geometry){const we=[];for(const Oe of le)we.push(new i.P(Oe[0],Oe[1]));ie.push(we)}return ie}}toGeoJSON(ie,le,we){return Xt.call(this,ie,le,we)}}class nr{constructor(ie,le){this.name=ie,this.extent=i.al,this.length=le.length,this._jsonFeatures=le}feature(ie){return new Ir(this._jsonFeatures[ie])}}class Fr{constructor(ie){this.layers={},this.extent=i.al;for(const le of Object.keys(ie))this.layers[le]=new nr(le,ie[le])}}const Or=64/4096,or=128;class lt{constructor(){this.features=new Map}clear(){this.features.clear()}load(ie=[],le){for(const we of ie){const Oe=we.id;if(Oe==null)continue;let Le=this.features.get(Oe);Le&&this.updateCache(Le,le),we.geometry?(Le=qt(we),this.updateCache(Le,le),this.features.set(Oe,Le)):this.features.delete(Oe),this.updateCache(Le,le)}}updateCache(ie,le){for(const{canonical:we,uid:Oe}of Object.values(le)){const{z:Le,x:Ue,y:nt}=we;Et(ie,Math.pow(2,Le),Ue,nt)&&delete le[Oe]}}getTile(ie,le,we){const Oe=Math.pow(2,ie),Le=[];for(const Ue of this.features.values())Et(Ue,Oe,le,we)&&Le.push(_t(Ue,Oe,le,we));return{features:Le}}getFeatures(){return[...this.features.values()]}}function Et({minX:qe,minY:ie,maxX:le,maxY:we},Oe,Le,Ue){return qe<(Le+1+Or)/Oe&&ie<(Ue+1+Or)/Oe&&le>(Le-Or)/Oe&&we>(Ue-Or)/Oe}function qt(qe){const{id:ie,geometry:le,properties:we}=qe;if(!le)return;if(le.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Oe,coordinates:Le}=le,Ue={id:ie,type:1,geometry:[],tags:we,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},nt=Ue.geometry;if(Oe==="Point")Gt(Le,nt,Ue);else if(Oe==="MultiPoint")for(const We of Le)Gt(We,nt,Ue);else if(Oe==="LineString")Ue.type=2,tt(Le,nt,Ue);else if(Oe==="MultiLineString")Ue.type=2,ct(Le,nt,Ue);else if(Oe==="Polygon")Ue.type=3,ct(Le,nt,Ue,!0);else{if(Oe!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Ue.type=3;for(const We of Le)ct(We,nt,Ue,!0)}return Ue}function Gt([qe,ie],le,we){const Oe=i.aF(qe);let Le=i.aJ(ie);Le=Le<0?0:Le>1?1:Le,le.push(Oe,Le),we.minX=Math.min(we.minX,Oe),we.minY=Math.min(we.minY,Le),we.maxX=Math.max(we.maxX,Oe),we.maxY=Math.max(we.maxY,Le)}function tt(qe,ie,le,we=!1,Oe=!1){const Le=[];for(const Ue of qe)Gt(Ue,Le,le);ie.push(Le),we&&(function(Ue,nt){let We=0;for(let Je=0,Ot=Ue.length,Pt=Ot-2;Je<Ot;Pt=Je,Je+=2)We+=(Ue[Je]-Ue[Pt])*(Ue[Je+1]+Ue[Pt+1]);if(We>0===nt)for(let Je=0,Ot=Ue.length;Je<Ot/2;Je+=2){const Pt=Ue[Je],gr=Ue[Je+1];Ue[Je]=Ue[Ot-2-Je],Ue[Je+1]=Ue[Ot-1-Je],Ue[Ot-2-Je]=Pt,Ue[Ot-1-Je]=gr}})(Le,Oe)}function ct(qe,ie,le,we=!1){for(let Oe=0;Oe<qe.length;Oe++)tt(qe[Oe],ie,le,we,Oe===0)}function _t(qe,ie,le,we){const{id:Oe,type:Le,geometry:Ue,tags:nt}=qe,We=[];if(Le===1)(function(Je,Ot,Pt,gr,jr){for(let yr=0;yr<Je.length;yr+=2){const Cr=Math.round(i.al*(Je[yr+0]*Ot-Pt)),Zr=Math.round(i.al*(Je[yr+1]*Ot-gr));jr.push([Cr,Zr])}})(Ue,ie,le,we,We);else for(const Je of Ue)Vt(Je,ie,le,we,We);return{id:Oe,type:Le,geometry:We,tags:nt}}function Vt(qe,ie,le,we,Oe){const Le=-or,Ue=i.al+or;let nt;for(let We=0;We<qe.length-2;We+=2){let Je=Math.round(i.al*(qe[We+0]*ie-le)),Ot=Math.round(i.al*(qe[We+1]*ie-we)),Pt=Math.round(i.al*(qe[We+2]*ie-le)),gr=Math.round(i.al*(qe[We+3]*ie-we));const jr=Pt-Je,yr=gr-Ot;Je<Le&&Pt<Le||(Je<Le?(Ot+=Math.round(yr*((Le-Je)/jr)),Je=Le):Pt<Le&&(gr=Ot+Math.round(yr*((Le-Je)/jr)),Pt=Le),Ot<Le&&gr<Le||(Ot<Le?(Je+=Math.round(jr*((Le-Ot)/yr)),Ot=Le):gr<Le&&(Pt=Je+Math.round(jr*((Le-Ot)/yr)),gr=Le),Je>=Ue&&Pt>=Ue||(Je>=Ue?(Ot+=Math.round(yr*((Ue-Je)/jr)),Je=Ue):Pt>=Ue&&(gr=Ot+Math.round(yr*((Ue-Je)/jr)),Pt=Ue),Ot>=Ue&&gr>=Ue||(Ot>=Ue?(Je+=Math.round(jr*((Ue-Ot)/yr)),Ot=Ue):gr>=Ue&&(Pt=Je+Math.round(jr*((Ue-Ot)/yr)),gr=Ue),nt&&Je===nt[nt.length-1][0]&&Ot===nt[nt.length-1][1]||(nt=[[Je,Ot]],Oe.push(nt)),nt.push([Pt,gr])))))}}function bt({name:qe,features:ie},le){le.writeStringField(1,qe),le.writeVarintField(5,i.al);const we=new Map,Oe=new Map,Le={keys:we,values:Oe,feature:null};for(const Ue of ie)Le.feature=Ue,le.writeMessage(2,ar,Le);for(const Ue of we.keys())le.writeStringField(3,Ue);for(const Ue of Oe.keys())le.writeMessage(4,hn,Ue)}function ar(qe,ie){const le=qe.feature;le.id!==void 0&&Number.isSafeInteger(+le.id)&&ie.writeVarintField(1,+le.id),le.tags&&ie.writeMessage(2,hr,qe),ie.writeVarintField(3,le.type),ie.writeMessage(4,Br,le)}function hr({keys:qe,values:ie,feature:le},we){for(const Oe of Object.keys(le.tags)){let Le=le.tags[Oe];if(Le===null)continue;let Ue=qe.get(Oe);Ue===void 0&&(Ue=qe.size,qe.set(Oe,Ue)),we.writeVarint(Ue);const nt=typeof Le;nt!=="string"&&nt!=="boolean"&&nt!=="number"&&(Le=JSON.stringify(Le));let We=ie.get(Le);We===void 0&&(We=ie.size,ie.set(Le,We)),we.writeVarint(We)}}function xr(qe,ie){return(ie<<3)+(7&qe)}function sr(qe){return qe<<1^qe>>31}function Br(qe,ie){const{geometry:le,type:we}=qe;let Oe=0,Le=0;if(we===1){ie.writeVarint(xr(1,le.length));for(const Ue of le){const nt=Ue[0]-Oe,We=Ue[1]-Le;ie.writeVarint(sr(nt)),ie.writeVarint(sr(We)),Oe+=nt,Le+=We}}else for(const Ue of le){ie.writeVarint(xr(1,1));const nt=Ue.length-(we===3?1:0);for(let We=0;We<nt;We++){We===1&&ie.writeVarint(xr(2,nt-1));const Je=Ue[We][0]-Oe,Ot=Ue[We][1]-Le;ie.writeVarint(sr(Je)),ie.writeVarint(sr(Ot)),Oe+=Je,Le+=Ot}we===3&&ie.writeVarint(xr(7,1))}}function hn(qe,ie){const le=typeof qe;le==="string"?ie.writeStringField(1,qe):le==="boolean"?ie.writeBooleanField(7,qe):le==="number"&&(qe%1!=0?ie.writeDoubleField(3,qe):qe<0?ie.writeSVarintField(6,qe):ie.writeVarintField(5,qe))}const Vn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:qe=>qe},Yr=Math.fround||(Un=new Float32Array(1),qe=>(Un[0]=+qe,Un[0]));var Un;const Si=3,di=5,Ii=6;class Xn{constructor(ie){this.options=Object.assign(Object.create(Vn),ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ie){const{log:le,minZoom:we,maxZoom:Oe}=this.options;le&&console.time("total time");const Le=`prepare ${ie.length} points`;le&&console.time(Le),this.points=ie;const Ue=[];for(let We=0;We<ie.length;We++){const Je=ie[We];if(!Je.geometry)continue;const[Ot,Pt]=Je.geometry.coordinates,gr=Yr(co(Ot)),jr=Yr(Ko(Pt));Ue.push(gr,jr,1/0,We,-1,1),this.options.reduce&&Ue.push(0)}let nt=this.trees[Oe+1]=this._createTree(Ue);le&&console.timeEnd(Le);for(let We=Oe;We>=we;We--){const Je=+Date.now();nt=this.trees[We]=this._createTree(this._cluster(nt,We)),le&&console.log("z%d: %d clusters in %dms",We,nt.numItems,+Date.now()-Je)}return le&&console.timeEnd("total time"),this}getClusters(ie,le){let we=((ie[0]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,ie[1]));let Le=ie[2]===180?180:((ie[2]+180)%360+360)%360-180;const Ue=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)we=-180,Le=180;else if(we>Le){const Pt=this.getClusters([we,Oe,180,Ue],le),gr=this.getClusters([-180,Oe,Le,Ue],le);return Pt.concat(gr)}const nt=this.trees[this._limitZoom(le)],We=nt.range(co(we),Ko(Ue),co(Le),Ko(Oe)),Je=nt.data,Ot=[];for(const Pt of We){const gr=this.stride*Pt;Ot.push(Je[gr+di]>1?Go(Je,gr,this.clusterProps):this.points[Je[gr+Si]])}return Ot}getChildren(ie){const le=this._getOriginId(ie),we=this._getOriginZoom(ie),Oe="No cluster with the specified id.",Le=this.trees[we];if(!Le)throw new Error(Oe);const Ue=Le.data;if(le*this.stride>=Ue.length)throw new Error(Oe);const nt=this.options.radius/(this.options.extent*Math.pow(2,we-1)),We=Le.within(Ue[le*this.stride],Ue[le*this.stride+1],nt),Je=[];for(const Ot of We){const Pt=Ot*this.stride;Ue[Pt+4]===ie&&Je.push(Ue[Pt+di]>1?Go(Ue,Pt,this.clusterProps):this.points[Ue[Pt+Si]])}if(Je.length===0)throw new Error(Oe);return Je}getLeaves(ie,le,we){const Oe=[];return this._appendLeaves(Oe,ie,le=le||10,we=we||0,0),Oe}getTile(ie,le,we){const Oe=this.trees[this._limitZoom(ie)],Le=Math.pow(2,ie),{extent:Ue,radius:nt}=this.options,We=nt/Ue,Je=(we-We)/Le,Ot=(we+1+We)/Le,Pt={features:[]};return this._addTileFeatures(Oe.range((le-We)/Le,Je,(le+1+We)/Le,Ot),Oe.data,le,we,Le,Pt),le===0&&this._addTileFeatures(Oe.range(1-We/Le,Je,1,Ot),Oe.data,Le,we,Le,Pt),le===Le-1&&this._addTileFeatures(Oe.range(0,Je,We/Le,Ot),Oe.data,-1,we,Le,Pt),Pt.features.length?Pt:null}getClusterExpansionZoom(ie){let le=this._getOriginZoom(ie)-1;for(;le<=this.options.maxZoom;){const we=this.getChildren(ie);if(le++,we.length!==1)break;ie=we[0].properties.cluster_id}return le}_appendLeaves(ie,le,we,Oe,Le){const Ue=this.getChildren(le);for(const nt of Ue){const We=nt.properties;if(We&&We.cluster?Le+We.point_count<=Oe?Le+=We.point_count:Le=this._appendLeaves(ie,We.cluster_id,we,Oe,Le):Le<Oe?Le++:ie.push(nt),ie.length===we)break}return Le}_createTree(ie){const le=new i.c3(ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let we=0;we<ie.length;we+=this.stride)le.add(ie[we],ie[we+1]);return le.finish(),le.data=ie,le}_addTileFeatures(ie,le,we,Oe,Le,Ue){for(const nt of ie){const We=nt*this.stride,Je=le[We+di]>1;let Ot,Pt,gr;if(Je)Ot=Lo(le,We,this.clusterProps),Pt=le[We],gr=le[We+1];else{const Cr=this.points[le[We+Si]];Ot=Cr.properties;const[Zr,on]=Cr.geometry.coordinates;Pt=co(Zr),gr=Ko(on)}const jr={type:1,geometry:[[Math.round(this.options.extent*(Pt*Le-we)),Math.round(this.options.extent*(gr*Le-Oe))]],tags:Ot};let yr;yr=Je||this.options.generateId?le[We+Si]:this.points[le[We+Si]].id,yr!==void 0&&(jr.id=yr),Ue.features.push(jr)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,le){const{radius:we,extent:Oe,reduce:Le,minPoints:Ue}=this.options,nt=we/(Oe*Math.pow(2,le)),We=ie.data,Je=[],Ot=this.stride;for(let Pt=0;Pt<We.length;Pt+=Ot){if(We[Pt+2]<=le)continue;We[Pt+2]=le;const gr=We[Pt],jr=We[Pt+1],yr=ie.within(We[Pt],We[Pt+1],nt),Cr=We[Pt+di];let Zr=Cr;for(const on of yr){const Cn=on*Ot;We[Cn+2]>le&&(Zr+=We[Cn+di])}if(Zr>Cr&&Zr>=Ue){let on,Cn=gr*Cr,Mi=jr*Cr,Qi=-1;const Ti=(Pt/Ot<<5)+(le+1)+this.points.length;for(const si of yr){const Ln=si*Ot;if(We[Ln+2]<=le)continue;We[Ln+2]=le;const rn=We[Ln+di];Cn+=We[Ln]*rn,Mi+=We[Ln+1]*rn,We[Ln+4]=Ti,Le&&(on||(on=this._map(We,Pt,!0),Qi=this.clusterProps.length,this.clusterProps.push(on)),Le(on,this._map(We,Ln)))}We[Pt+4]=Ti,Je.push(Cn/Zr,Mi/Zr,1/0,Ti,-1,Zr),Le&&Je.push(Qi)}else{for(let on=0;on<Ot;on++)Je.push(We[Pt+on]);if(Zr>1)for(const on of yr){const Cn=on*Ot;if(!(We[Cn+2]<=le)){We[Cn+2]=le;for(let Mi=0;Mi<Ot;Mi++)Je.push(We[Cn+Mi])}}}}return Je}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,le,we){if(ie[le+di]>1){const Ue=this.clusterProps[ie[le+Ii]];return we?Object.assign({},Ue):Ue}const Oe=this.points[ie[le+Si]].properties,Le=this.options.map(Oe);return we&&Le===Oe?Object.assign({},Le):Le}}function Go(qe,ie,le){return{type:"Feature",id:qe[ie+Si],properties:Lo(qe,ie,le),geometry:{type:"Point",coordinates:[(we=qe[ie],360*(we-.5)),ds(qe[ie+1])]}};var we}function Lo(qe,ie,le){const we=qe[ie+di],Oe=we>=1e4?`${Math.round(we/1e3)}k`:we>=1e3?Math.round(we/100)/10+"k":we,Le=qe[ie+Ii],Ue=Le===-1?{}:Object.assign({},le[Le]);return Object.assign(Ue,{cluster:!0,cluster_id:qe[ie+Si],point_count:we,point_count_abbreviated:Oe})}function co(qe){return qe/360+.5}function Ko(qe){const ie=Math.sin(qe*Math.PI/180),le=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return le<0?0:le>1?1:le}function ds(qe){const ie=(180-360*qe)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function Bo(qe,ie,le,we){let Oe=we;const Le=ie+(le-ie>>1);let Ue,nt=le-ie;const We=qe[ie],Je=qe[ie+1],Ot=qe[le],Pt=qe[le+1];for(let gr=ie+3;gr<le;gr+=3){const jr=ra(qe[gr],qe[gr+1],We,Je,Ot,Pt);if(jr>Oe)Ue=gr,Oe=jr;else if(jr===Oe){const yr=Math.abs(gr-Le);yr<nt&&(Ue=gr,nt=yr)}}Oe>we&&(Ue-ie>3&&Bo(qe,ie,Ue,we),qe[Ue+2]=Oe,le-Ue>3&&Bo(qe,Ue,le,we))}function ra(qe,ie,le,we,Oe,Le){let Ue=Oe-le,nt=Le-we;if(Ue!==0||nt!==0){const We=((qe-le)*Ue+(ie-we)*nt)/(Ue*Ue+nt*nt);We>1?(le=Oe,we=Le):We>0&&(le+=Ue*We,we+=nt*We)}return Ue=qe-le,nt=ie-we,Ue*Ue+nt*nt}function va(qe,ie,le,we){const Oe={id:qe??null,type:ie,geometry:le,tags:we,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ie==="Point"||ie==="MultiPoint"||ie==="LineString")xa(Oe,le);else if(ie==="Polygon")xa(Oe,le[0]);else if(ie==="MultiLineString")for(const Le of le)xa(Oe,Le);else if(ie==="MultiPolygon")for(const Le of le)xa(Oe,Le[0]);return Oe}function xa(qe,ie){for(let le=0;le<ie.length;le+=3)qe.minX=Math.min(qe.minX,ie[le]),qe.minY=Math.min(qe.minY,ie[le+1]),qe.maxX=Math.max(qe.maxX,ie[le]),qe.maxY=Math.max(qe.maxY,ie[le+1])}function Bs(qe,ie,le,we){if(!ie.geometry)return;const Oe=ie.geometry.coordinates;if(Oe&&Oe.length===0)return;const Le=ie.geometry.type,Ue=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2);let nt=[],We=ie.id;if(le.promoteId?We=ie.properties[le.promoteId]:le.generateId&&(We=we||0),Le==="Point")Qo(Oe,nt);else if(Le==="MultiPoint")for(const Je of Oe)Qo(Je,nt);else if(Le==="LineString")na(Oe,nt,Ue,!1);else if(Le==="MultiLineString"){if(le.lineMetrics){for(const Je of Oe)nt=[],na(Je,nt,Ue,!1),qe.push(va(We,"LineString",nt,ie.properties));return}hs(Oe,nt,Ue,!1)}else if(Le==="Polygon")hs(Oe,nt,Ue,!0);else{if(Le!=="MultiPolygon"){if(Le==="GeometryCollection"){for(const Je of ie.geometry.geometries)Bs(qe,{id:We,geometry:Je,properties:ie.properties},le,we);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Je of Oe){const Ot=[];hs(Je,Ot,Ue,!0),nt.push(Ot)}}qe.push(va(We,Le,nt,ie.properties))}function Qo(qe,ie){ie.push(Cl(qe[0]),Al(qe[1]),0)}function na(qe,ie,le,we){let Oe,Le,Ue=0;for(let We=0;We<qe.length;We++){const Je=Cl(qe[We][0]),Ot=Al(qe[We][1]);ie.push(Je,Ot,0),We>0&&(Ue+=we?(Oe*Ot-Je*Le)/2:Math.sqrt(Math.pow(Je-Oe,2)+Math.pow(Ot-Le,2))),Oe=Je,Le=Ot}const nt=ie.length-3;ie[2]=1,Bo(ie,0,nt,le),ie[nt+2]=1,ie.size=Math.abs(Ue),ie.start=0,ie.end=ie.size}function hs(qe,ie,le,we){for(let Oe=0;Oe<qe.length;Oe++){const Le=[];na(qe[Oe],Le,le,we),ie.push(Le)}}function Cl(qe){return qe/360+.5}function Al(qe){const ie=Math.sin(qe*Math.PI/180),le=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return le<0?0:le>1?1:le}function io(qe,ie,le,we,Oe,Le,Ue,nt){if(we/=ie,Le>=(le/=ie)&&Ue<we)return qe;if(Ue<le||Le>=we)return null;const We=[];for(const Je of qe){const Ot=Je.geometry;let Pt=Je.type;const gr=Oe===0?Je.minX:Je.minY,jr=Oe===0?Je.maxX:Je.maxY;if(gr>=le&&jr<we){We.push(Je);continue}if(jr<le||gr>=we)continue;let yr=[];if(Pt==="Point"||Pt==="MultiPoint")js(Ot,yr,le,we,Oe);else if(Pt==="LineString")ba(Ot,yr,le,we,Oe,!1,nt.lineMetrics);else if(Pt==="MultiLineString")Ps(Ot,yr,le,we,Oe,!1);else if(Pt==="Polygon")Ps(Ot,yr,le,we,Oe,!0);else if(Pt==="MultiPolygon")for(const Cr of Ot){const Zr=[];Ps(Cr,Zr,le,we,Oe,!0),Zr.length&&yr.push(Zr)}if(yr.length){if(nt.lineMetrics&&Pt==="LineString"){for(const Cr of yr)We.push(va(Je.id,Pt,Cr,Je.tags));continue}Pt!=="LineString"&&Pt!=="MultiLineString"||(yr.length===1?(Pt="LineString",yr=yr[0]):Pt="MultiLineString"),Pt!=="Point"&&Pt!=="MultiPoint"||(Pt=yr.length===3?"Point":"MultiPoint"),We.push(va(Je.id,Pt,yr,Je.tags))}}return We.length?We:null}function js(qe,ie,le,we,Oe){for(let Le=0;Le<qe.length;Le+=3){const Ue=qe[Le+Oe];Ue>=le&&Ue<=we&&Is(ie,qe[Le],qe[Le+1],qe[Le+2])}}function ba(qe,ie,le,we,Oe,Le,Ue){let nt=wa(qe);const We=Oe===0?_i:Zi;let Je,Ot,Pt=qe.start;for(let Zr=0;Zr<qe.length-3;Zr+=3){const on=qe[Zr],Cn=qe[Zr+1],Mi=qe[Zr+2],Qi=qe[Zr+3],Ti=qe[Zr+4],si=Oe===0?on:Cn,Ln=Oe===0?Qi:Ti;let rn=!1;Ue&&(Je=Math.sqrt(Math.pow(on-Qi,2)+Math.pow(Cn-Ti,2))),si<le?Ln>le&&(Ot=We(nt,on,Cn,Qi,Ti,le),Ue&&(nt.start=Pt+Je*Ot)):si>we?Ln<we&&(Ot=We(nt,on,Cn,Qi,Ti,we),Ue&&(nt.start=Pt+Je*Ot)):Is(nt,on,Cn,Mi),Ln<le&&si>=le&&(Ot=We(nt,on,Cn,Qi,Ti,le),rn=!0),Ln>we&&si<=we&&(Ot=We(nt,on,Cn,Qi,Ti,we),rn=!0),!Le&&rn&&(Ue&&(nt.end=Pt+Je*Ot),ie.push(nt),nt=wa(qe)),Ue&&(Pt+=Je)}let gr=qe.length-3;const jr=qe[gr],yr=qe[gr+1],Cr=Oe===0?jr:yr;Cr>=le&&Cr<=we&&Is(nt,jr,yr,qe[gr+2]),gr=nt.length-3,Le&&gr>=3&&(nt[gr]!==nt[0]||nt[gr+1]!==nt[1])&&Is(nt,nt[0],nt[1],nt[2]),nt.length&&ie.push(nt)}function wa(qe){const ie=[];return ie.size=qe.size,ie.start=qe.start,ie.end=qe.end,ie}function Ps(qe,ie,le,we,Oe,Le){for(const Ue of qe)ba(Ue,ie,le,we,Oe,Le,!1)}function Is(qe,ie,le,we){qe.push(ie,le,we)}function _i(qe,ie,le,we,Oe,Le){const Ue=(Le-ie)/(we-ie);return Is(qe,Le,le+(Oe-le)*Ue,1),Ue}function Zi(qe,ie,le,we,Oe,Le){const Ue=(Le-le)/(Oe-le);return Is(qe,ie+(we-ie)*Ue,Le,1),Ue}function ia(qe,ie){const le=[];for(let we=0;we<qe.length;we++){const Oe=qe[we],Le=Oe.type;let Ue;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")Ue=fs(Oe.geometry,ie);else if(Le==="MultiLineString"||Le==="Polygon"){Ue=[];for(const nt of Oe.geometry)Ue.push(fs(nt,ie))}else if(Le==="MultiPolygon"){Ue=[];for(const nt of Oe.geometry){const We=[];for(const Je of nt)We.push(fs(Je,ie));Ue.push(We)}}le.push(va(Oe.id,Le,Ue,Oe.tags))}return le}function fs(qe,ie){const le=[];le.size=qe.size,qe.start!==void 0&&(le.start=qe.start,le.end=qe.end);for(let we=0;we<qe.length;we+=3)le.push(qe[we]+ie,qe[we+1],qe[we+2]);return le}function Ms(qe,ie){if(qe.transformed)return qe;const le=1<<qe.z,we=qe.x,Oe=qe.y;for(const Le of qe.features){const Ue=Le.geometry,nt=Le.type;if(Le.geometry=[],nt===1)for(let We=0;We<Ue.length;We+=2)Le.geometry.push(Dc(Ue[We],Ue[We+1],ie,le,we,Oe));else for(let We=0;We<Ue.length;We++){const Je=[];for(let Ot=0;Ot<Ue[We].length;Ot+=2)Je.push(Dc(Ue[We][Ot],Ue[We][Ot+1],ie,le,we,Oe));Le.geometry.push(Je)}}return qe.transformed=!0,qe}function Dc(qe,ie,le,we,Oe,Le){return[Math.round(le*(qe*we-Oe)),Math.round(le*(ie*we-Le))]}function rc(qe,ie,le,we,Oe){const Le=ie===Oe.maxZoom?0:Oe.tolerance/((1<<ie)*Oe.extent),Ue={features:[],numPoints:0,numSimplified:0,numFeatures:qe.length,source:null,x:le,y:we,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const nt of qe)ru(Ue,nt,Le,Oe);return Ue}function ru(qe,ie,le,we){const Oe=ie.geometry,Le=ie.type,Ue=[];if(qe.minX=Math.min(qe.minX,ie.minX),qe.minY=Math.min(qe.minY,ie.minY),qe.maxX=Math.max(qe.maxX,ie.maxX),qe.maxY=Math.max(qe.maxY,ie.maxY),Le==="Point"||Le==="MultiPoint")for(let nt=0;nt<Oe.length;nt+=3)Ue.push(Oe[nt],Oe[nt+1]),qe.numPoints++,qe.numSimplified++;else if(Le==="LineString")ll(Ue,Oe,qe,le,!1,!1);else if(Le==="MultiLineString"||Le==="Polygon")for(let nt=0;nt<Oe.length;nt++)ll(Ue,Oe[nt],qe,le,Le==="Polygon",nt===0);else if(Le==="MultiPolygon")for(let nt=0;nt<Oe.length;nt++){const We=Oe[nt];for(let Je=0;Je<We.length;Je++)ll(Ue,We[Je],qe,le,!0,Je===0)}if(Ue.length){let nt=ie.tags||null;if(Le==="LineString"&&we.lineMetrics){nt={};for(const Je in ie.tags)nt[Je]=ie.tags[Je];nt.mapbox_clip_start=Oe.start/Oe.size,nt.mapbox_clip_end=Oe.end/Oe.size}const We={geometry:Ue,type:Le==="Polygon"||Le==="MultiPolygon"?3:Le==="LineString"||Le==="MultiLineString"?2:1,tags:nt};ie.id!==null&&(We.id=ie.id),qe.features.push(We)}}function ll(qe,ie,le,we,Oe,Le){const Ue=we*we;if(we>0&&ie.size<(Oe?Ue:we))return void(le.numPoints+=ie.length/3);const nt=[];for(let We=0;We<ie.length;We+=3)(we===0||ie[We+2]>Ue)&&(le.numSimplified++,nt.push(ie[We],ie[We+1])),le.numPoints++;Oe&&(function(We,Je){let Ot=0;for(let Pt=0,gr=We.length,jr=gr-2;Pt<gr;jr=Pt,Pt+=2)Ot+=(We[Pt]-We[jr])*(We[Pt+1]+We[jr+1]);if(Ot>0===Je)for(let Pt=0,gr=We.length;Pt<gr/2;Pt+=2){const jr=We[Pt],yr=We[Pt+1];We[Pt]=We[gr-2-Pt],We[Pt+1]=We[gr-1-Pt],We[gr-2-Pt]=jr,We[gr-1-Pt]=yr}})(nt,Le),qe.push(nt)}const St={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ns{constructor(ie,le){const we=(le=this.options=(function(Le,Ue){for(const nt in Ue)Le[nt]=Ue[nt];return Le})(Object.create(St),le)).debug;if(we&&console.time("preprocess data"),le.maxZoom<0||le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(le.promoteId&&le.generateId)throw new Error("promoteId and generateId cannot be used together.");let Oe=(function(Le,Ue){const nt=[];if(Le.type==="FeatureCollection")for(let We=0;We<Le.features.length;We++)Bs(nt,Le.features[We],Ue,We);else Bs(nt,Le.type==="Feature"?Le:{geometry:Le},Ue);return nt})(ie,le);this.tiles={},this.tileCoords=[],we&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",le.indexMaxZoom,le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Oe=(function(Le,Ue){const nt=Ue.buffer/Ue.extent;let We=Le;const Je=io(Le,1,-1-nt,nt,0,-1,2,Ue),Ot=io(Le,1,1-nt,2+nt,0,-1,2,Ue);return(Je||Ot)&&(We=io(Le,1,-nt,1+nt,0,-1,2,Ue)||[],Je&&(We=ia(Je,1).concat(We)),Ot&&(We=We.concat(ia(Ot,-1)))),We})(Oe,le),Oe.length&&this.splitTile(Oe,0,0,0),we&&(Oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ie,le,we,Oe,Le,Ue,nt){const We=[ie,le,we,Oe],Je=this.options,Ot=Je.debug;for(;We.length;){Oe=We.pop(),we=We.pop(),le=We.pop(),ie=We.pop();const Pt=1<<le,gr=Dl(le,we,Oe);let jr=this.tiles[gr];if(!jr&&(Ot>1&&console.time("creation"),jr=this.tiles[gr]=rc(ie,le,we,Oe,Je),this.tileCoords.push({z:le,x:we,y:Oe}),Ot)){Ot>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",le,we,Oe,jr.numFeatures,jr.numPoints,jr.numSimplified),console.timeEnd("creation"));const rn=`z${le}`;this.stats[rn]=(this.stats[rn]||0)+1,this.total++}if(jr.source=ie,Le==null){if(le===Je.indexMaxZoom||jr.numPoints<=Je.indexMaxPoints)continue}else{if(le===Je.maxZoom||le===Le)continue;if(Le!=null){const rn=Le-le;if(we!==Ue>>rn||Oe!==nt>>rn)continue}}if(jr.source=null,ie.length===0)continue;Ot>1&&console.time("clipping");const yr=.5*Je.buffer/Je.extent,Cr=.5-yr,Zr=.5+yr,on=1+yr;let Cn=null,Mi=null,Qi=null,Ti=null,si=io(ie,Pt,we-yr,we+Zr,0,jr.minX,jr.maxX,Je),Ln=io(ie,Pt,we+Cr,we+on,0,jr.minX,jr.maxX,Je);ie=null,si&&(Cn=io(si,Pt,Oe-yr,Oe+Zr,1,jr.minY,jr.maxY,Je),Mi=io(si,Pt,Oe+Cr,Oe+on,1,jr.minY,jr.maxY,Je),si=null),Ln&&(Qi=io(Ln,Pt,Oe-yr,Oe+Zr,1,jr.minY,jr.maxY,Je),Ti=io(Ln,Pt,Oe+Cr,Oe+on,1,jr.minY,jr.maxY,Je),Ln=null),Ot>1&&console.timeEnd("clipping"),We.push(Cn||[],le+1,2*we,2*Oe),We.push(Mi||[],le+1,2*we,2*Oe+1),We.push(Qi||[],le+1,2*we+1,2*Oe),We.push(Ti||[],le+1,2*we+1,2*Oe+1)}}getTile(ie,le,we){ie=+ie,le=+le,we=+we;const Oe=this.options,{extent:Le,debug:Ue}=Oe;if(ie<0||ie>24)return null;const nt=1<<ie,We=Dl(ie,le=le+nt&nt-1,we);if(this.tiles[We])return Ms(this.tiles[We],Le);Ue>1&&console.log("drilling down to z%d-%d-%d",ie,le,we);let Je,Ot=ie,Pt=le,gr=we;for(;!Je&&Ot>0;)Ot--,Pt>>=1,gr>>=1,Je=this.tiles[Dl(Ot,Pt,gr)];return Je&&Je.source?(Ue>1&&(console.log("found parent tile z%d-%d-%d",Ot,Pt,gr),console.time("drilling down")),this.splitTile(Je.source,Ot,Pt,gr,ie,le,we),Ue>1&&console.timeEnd("drilling down"),this.tiles[We]?Ms(this.tiles[We],Le):null):null}}function Dl(qe,ie,le){return 32*((1<<qe)*le+ie)+qe}function Ka(qe,ie){const le=qe.tileID.canonical;if(!this._geoJSONIndex)return void ie(null,null);const we=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!we)return void ie(null,null);const Oe=Je=>Je.tags&&"3d_elevation_id"in Je.tags&&"source"in Je.tags&&Je.tags.source==="elevation",Le=we.features.filter((Je=>Oe(Je)));let Ue={_geojsonTileLayer:we.features};Le.length>0&&(Ue={_geojsonTileLayer:we.features.filter((Je=>!Oe(Je))),hd_road_elevation:Le});const nt=new Fr(Ue),We=(function(Je){const Ot=new i.bs;for(const Pt of Object.keys(Je))Ot.writeMessage(3,bt,{name:Pt,features:Je[Pt]});return Ot.finish()})(Ue).buffer;ie(null,{vectorTile:nt,rawData:We})}class vn extends ke{constructor(ie,le,we,Oe,Le,Ue,nt){super(ie,le,we,Oe,Le,Ka,nt),Ue&&(this.loadGeoJSON=Ue),this._dynamicIndex=new lt}loadData(ie,le){const we=ie&&ie.request,Oe=we&&we.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(ie,((Le,Ue)=>{if(Le||!Ue)return le(Le);if(typeof Ue!="object")return le(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{try{if(ie.filter){const We=i.U(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(We.result==="error")throw new Error(We.value.map((Je=>`${Je.key}: ${Je.message}`)).join(", "));Ue.features=Ue.features.filter((Je=>We.value.evaluate({zoom:0},Je)))}ie.dynamic?(Ue.type==="Feature"&&(Ue={type:"FeatureCollection",features:[Ue]}),ie.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Ue.features,this.loaded),ie.cluster&&(Ue.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ie.cluster?new Xn((function({superclusterOptions:We,clusterProperties:Je}){if(!Je||!We)return We;const Ot={},Pt={},gr={accumulated:null,zoom:0},jr={properties:null},yr=Object.keys(Je);for(const Cr of yr){const[Zr,on]=Je[Cr],Cn=i.U(on),Mi=i.U(typeof Zr=="string"?[Zr,["accumulated"],["get",Cr]]:Zr);Ot[Cr]=Cn.value,Pt[Cr]=Mi.value}return We.map=Cr=>{jr.properties=Cr;const Zr={};for(const on of yr)Zr[on]=Ot[on].evaluate(gr,jr);return Zr},We.reduce=(Cr,Zr)=>{jr.properties=Zr;for(const on of yr)gr.accumulated=Cr[on],Cr[on]=Pt[on].evaluate(gr,jr)},We})(ie)).load(Ue.features):ie.dynamic?this._dynamicIndex:(function(We,Je){return new Ns(We,Je)})(Ue,ie.geojsonVtOptions)}catch(We){return le(We)}const nt={};if(Oe){const We=C(we);We&&(nt.resourceTiming={},nt.resourceTiming[ie.source]=JSON.parse(JSON.stringify(We)))}le(null,nt)}}))}reloadTile(ie,le){const we=this.loaded;return we&&we[ie.uid]?ie.partial?le(null,void 0):super.reloadTile(ie,le):this.loadTile(ie,le)}loadGeoJSON(ie,le){if(ie.request)i.m(ie.request,le);else{if(typeof ie.data!="string")return le(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));setTimeout((()=>{try{return le(null,JSON.parse(ie.data))}catch{return le(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}}),0)}}getClusterExpansionZoom(ie,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(we){le(we)}}getClusterChildren(ie,le){try{le(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(we){le(we)}}getClusterLeaves(ie,le){try{le(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(we){le(we)}}}class So{constructor(ie,le,we){this.tileID=new i.aP(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ie.projection,this.brightness=le,this.worldview=we}parse(ie,le,we,Oe){this.status="parsing";const Le=new i.aP(we.tileID.overscaledZ,we.tileID.wrap,we.tileID.canonical.z,we.tileID.canonical.x,we.tileID.canonical.y),Ue=[],nt=le.familiesBySource[we.source],We=new i.fm(Le,we.promoteId);We.bucketLayerIDs=[],We.is3DTile=!0,i.fB(ie).then((Je=>{if(!Je)return Oe(new Error("Could not parse tile"));const Ot=Je.json.extensionsUsed&&Je.json.extensionsUsed.includes("MAPBOX_mesh_features")||Je.json.asset.extras&&Je.json.asset.extras.MAPBOX_mesh_features,Pt=Je.json.extensionsUsed&&Je.json.extensionsUsed.includes("EXT_meshopt_compression"),gr=new i.ac(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const jr in nt)for(const yr of nt[jr]){const Cr=yr[0];We.bucketLayerIDs.push(yr.map((Cn=>i.B(Cn.id,Cn.scope)))),Cr.recalculate(gr,[]);const Zr=i.fC(Je,1/i.d6(we.tileID.canonical)),on=new i.fD(yr,Zr,Le,Ot,Pt,this.brightness,We,this.worldview);Ot||(on.needsUpload=!0),Ue.push(on),on.evaluate(Cr)}this.status="done",Oe(null,{buckets:Ue,featureIndex:We,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})})).catch((Je=>Oe(new Error(Je.message))))}}class Sa{constructor(ie,le,we,Oe,Le,Ue,nt,We){this.actor=ie,this.layerIndex=le,this.availableImages=we,this.availableModels=Oe,this.brightness=nt,this.loading={},this.loaded={},this.worldview=We}loadTile(ie,le){const we=ie.uid,Oe=this.loading[we]=new So(ie,this.brightness,this.worldview);i.bt(ie.request,((Le,Ue)=>{const nt=!this.loading[we];return delete this.loading[we],nt||Le?(Oe.status="done",nt||(this.loaded[we]=Oe),le(Le)):Ue&&Ue.byteLength!==0?void Oe.parse(Ue,this.layerIndex,ie,((We,Je)=>{Oe.status="done",this.loaded=this.loaded||{},this.loaded[we]=Oe,We||!Je?le(We):le(null,Je)})):(Oe.status="done",this.loaded[we]=Oe,le())}))}reloadTile(ie,le){const we=this.loaded,Oe=ie.uid;if(we&&we[Oe]){const Le=we[Oe];Le.projection=ie.projection,Le.brightness=ie.brightness;const Ue=(nt,We)=>{Le.reloadCallback&&(delete Le.reloadCallback,this.loadTile(ie,le)),le(nt,We)};Le.status==="parsing"?Le.reloadCallback=Ue:Le.status==="done"&&this.loadTile(ie,le)}}abortTile(ie,le){const we=ie.uid;this.loading[we]&&delete this.loading[we],le()}removeTile(ie,le){const we=this.loaded,Oe=ie.uid;we&&we[Oe]&&delete we[Oe],le()}}class cl{constructor(ie){this.self=ie,this.actor=new i.fF(ie,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new i.x,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=i.cl({name:"mercator"}),this.workerSourceTypes={vector:ke,geojson:vn,"raster-dem":ze,"raster-array":ht,"batched-model":Sa},this.workerSources={},this.self.registerWorkerSource=(le,we)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=we},this.self.registerRTLTextPlugin=le=>{if(i.fG.isParsed())throw new Error("RTL text plugin already registered.");i.fG.setState({pluginStatus:i.fH.parsed,pluginURL:i.fG.getPluginURL()}),i.fG.applyArabicShaping=le.applyArabicShaping,i.fG.processBidirectionalText=le.processBidirectionalText,i.fG.processStyledBidirectionalText=le.processStyledBidirectionalText;for(const we of this.rtlPluginParsingListeners)we(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(ie,le,we){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.availableModels[ie],delete this.workerSources[ie],we()}checkIfReady(ie,le,we){we()}setReferrer(ie,le){this.referrer=le}spriteLoaded(ie,le){this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={});const{scope:we,isLoaded:Oe}=le;if(this.isSpriteLoaded[ie][we]=Oe,this.workerSources[ie]&&this.workerSources[ie][we])for(const Le in this.workerSources[ie][we]){const Ue=this.workerSources[ie][we][Le];for(const nt in Ue){const We=Ue[nt];We instanceof ke&&(We.isSpriteLoaded=Oe,We.fire(new i.z("isSpriteLoaded")))}}}setImages(ie,le,we){this.availableImages[ie]||(this.availableImages[ie]={});const{scope:Oe,images:Le}=le;if(this.availableImages[ie][Oe]=Le,this.workerSources[ie]&&this.workerSources[ie][Oe]){for(const Ue in this.workerSources[ie][Oe]){const nt=this.workerSources[ie][Oe][Ue];for(const We in nt)nt[We].availableImages=Le}we()}else we()}setModels(ie,{scope:le,models:we},Oe){if(this.availableModels[ie]||(this.availableModels[ie]={}),this.availableModels[ie][le]=we,this.workerSources[ie]&&this.workerSources[ie][le]){for(const Le in this.workerSources[ie][le]){const Ue=this.workerSources[ie][le][Le];for(const nt in Ue)Ue[nt].availableModels=we}Oe()}else Oe()}setProjection(ie,le){this.projections[ie]=i.cl(le)}setBrightness(ie,le,we){this.brightness=le,we()}setWorldview(ie,le,we){this.worldview=le,we()}setLayers(ie,le,we){this.getLayerIndex(ie,le.scope).replace(le.layers,le.options),we()}updateLayers(ie,le,we){this.getLayerIndex(ie,le.scope).update(le.layers,le.removedIds,le.options),we()}loadTile(ie,le,we){le.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,le.type,le.source,le.scope).loadTile(le,we)}decodeRasterArray(ie,le,we){this.getWorkerSource(ie,le.type,le.source,le.scope).decodeRasterArray(le,we)}reloadTile(ie,le,we){le.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,le.type,le.source,le.scope).reloadTile(le,we)}abortTile(ie,le,we){this.getWorkerSource(ie,le.type,le.source,le.scope).abortTile(le,we)}removeTile(ie,le,we){this.getWorkerSource(ie,le.type,le.source,le.scope).removeTile(le,we)}removeSource(ie,le,we){if(!(this.workerSources[ie]&&this.workerSources[ie][le.scope]&&this.workerSources[ie][le.scope][le.type]&&this.workerSources[ie][le.scope][le.type][le.source]))return;const Oe=this.workerSources[ie][le.scope][le.type][le.source];delete this.workerSources[ie][le.scope][le.type][le.source],Oe.removeSource!==void 0?Oe.removeSource(le,we):we()}loadWorkerSource(ie,le,we){try{this.self.importScripts(le.url),we()}catch(Oe){we(Oe.toString())}}syncRTLPluginState(ie,le,we){if(i.fG.isParsed())we(null,!0);else if(i.fG.isParsing())this.rtlPluginParsingListeners.push(we);else try{i.fG.setState(le);const Oe=i.fG.getPluginURL();!i.fG.isLoaded()||i.fG.isParsed()||i.fG.isParsing()||Oe==null||(i.fG.setState({pluginStatus:i.fH.parsing,pluginURL:i.fG.getPluginURL()}),this.self.importScripts(Oe),i.fG.isParsed()?we(null,!0):this.rtlPluginParsingListeners.push(we))}catch(Oe){we(Oe.toString())}}setDracoUrl(ie,le){this.dracoUrl=le}getAvailableImages(ie,le){this.availableImages[ie]||(this.availableImages[ie]={});let we=this.availableImages[ie][le];return we||(we=[]),we}getAvailableModels(ie,le){this.availableModels[ie]||(this.availableModels[ie]={});let we=this.availableModels[ie][le];return we||(we={}),we}getLayerIndex(ie,le){this.layerIndexes[ie]||(this.layerIndexes[ie]={});let we=this.layerIndexes[ie][le];return we||(we=this.layerIndexes[ie][le]=new F,we.scope=le),we}getWorkerSource(ie,le,we,Oe){const Le=this.workerSources;return Le[ie]||(Le[ie]={}),Le[ie][Oe]||(Le[ie][Oe]={}),Le[ie][Oe][le]||(Le[ie][Oe][le]={}),this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={}),Le[ie][Oe][le][we]||(Le[ie][Oe][le][we]=new this.workerSourceTypes[le]({send:(Ue,nt,We,Je,Ot,Pt)=>this.actor.send(Ue,nt,We,ie,Ot,Pt),scheduler:this.actor.scheduler},this.getLayerIndex(ie,Oe),this.getAvailableImages(ie,Oe),this.getAvailableModels(ie,Oe),this.isSpriteLoaded[ie][Oe],void 0,this.brightness,this.worldview)),Le[ie][Oe][le][we]}rasterizeImagesWorker(ie,le,we){const Oe=new Map;for(const[Le,{image:Ue,imageVariant:nt}]of le.tasks.entries()){const We=this.imageRasterizer.rasterize(nt,Ue,le.scope,ie);Oe.set(Le,We)}we(void 0,Oe)}removeRasterizedImages(ie,le,we){this.imageRasterizer.removeImagesFromCacheByIds(le.imageIds,le.scope,ie),we()}enforceCacheSizeLimit(ie,le){i.fI(le)}getWorkerPerformanceMetrics(ie,le,we){we(void 0,void 0)}}return i.fE(self)&&(self.worker=new cl(self)),cl})),y(["./shared"],(function(i){var C="3.16.0";const R={create:"create",load:"load",fullLoad:"fullLoad"},z={mark(h){performance.mark(h)},measure(h,n,l){performance.measure(h,n,l)}};function F(h){const n=h.name.split("?")[0];return i.a(n)&&n.includes("mapbox-gl.js")?"javascript":i.a(n)&&n.includes("mapbox-gl.css")?"css":i.b(n)?"fontRange":i.c(n)?"sprite":i.i(n)?"style":i.d(n)?"tilejson":"other"}var V,G={},H=(function(){if(V)return G;function h(f){return!n(f)}function n(f){return typeof window>"u"||typeof document>"u"?"not a browser":(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,E,M=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(M);try{E=new Worker(D),w=!0}catch{w=!1}return E&&E.terminate(),URL.revokeObjectURL(D),w})()?(function(){var w=document.createElement("canvas");w.width=w.height=1;var E=w.getContext("2d");if(!E)return!1;var M=E.getImageData(0,0,1,1);return M&&M.width===w.width})()?(l[v=f&&f.failIfMajorPerformanceCaveat]===void 0&&(l[v]=(function(w){var E,M=(function(D){var B=document.createElement("canvas"),j=Object.create(h.webGLContextAttributes);return j.failIfMajorPerformanceCaveat=D,B.getContext("webgl2",j)})(w);if(!M)return!1;try{E=M.createShader(M.VERTEX_SHADER)}catch{return!1}return!(!E||M.isContextLost())&&(M.shaderSource(E,"void main() {}"),M.compileShader(E),M.getShaderParameter(E,M.COMPILE_STATUS)===!0)})(v)),l[v]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var v}V=1,G.supported=h,G.notSupportedReason=n;var l={};return h.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},G})();function Z(h,n,l){const f=document.createElement(h);return n!=null&&(f.className=n),l&&l.appendChild(f),f}function J(h,n,l){const f=document.createElementNS("http://www.w3.org/2000/svg",h);for(const v of Object.keys(n))f.setAttributeNS(null,v,String(n[v]));return l&&l.appendChild(f),f}const se=typeof document<"u"?document.documentElement&&document.documentElement.style:null,pe=se&&se.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ve;function Ne(){se&&pe&&(ve=se[pe],se[pe]="none")}function _e(){se&&pe&&(se[pe]=ve)}function Re(h){h.preventDefault(),h.stopPropagation(),window.removeEventListener("click",Re,!0)}function ke(){window.addEventListener("click",Re,!0),window.setTimeout((()=>{window.removeEventListener("click",Re,!0)}),0)}function ze(h,n){const l=h.getBoundingClientRect();return Xt(h,l,n)}function et(h,n){const l=h.getBoundingClientRect(),f=[];for(let v=0;v<n.length;v++)f.push(Xt(h,l,n[v]));return f}function ht(h){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&h.button===2&&h.ctrlKey?0:h.button}function Xt(h,n,l){const f=h.offsetWidth===n.width?1:h.offsetWidth/n.width;return new i.P((l.clientX-n.left)*f,(l.clientY-n.top)*f)}const Ir="01",nr="NO_ACCESS_TOKEN";class Fr{constructor(n,l,f){this._transformRequestFn=n,this._customAccessToken=l,this._silenceAuthErrors=!!f,this._createSkuToken()}_createSkuToken(){const n=(function(){let l="";for(let f=0;f<10;f++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ir,l].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,l){return this._transformRequestFn&&this._transformRequestFn(n,l)||{url:n}}normalizeStyleURL(n,l){if(!i.h(n))return n;const f=or(n);return f.params.push(`sdk=js-${C}`),f.path=`/styles/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||l)}normalizeGlyphsURL(n,l){if(!i.h(n))return n;const f=or(n);return f.path=`/fonts/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||l)}normalizeModelURL(n,l){if(!i.h(n))return n;const f=or(n);return f.path=`/models/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||l)}normalizeSourceURL(n,l,f,v){if(!i.h(n))return n;const w=or(n);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),f&&w.params.push(`language=${f}`),v&&w.params.push(`worldview=${v}`),this._makeAPIURL(w,this._customAccessToken||l)}normalizeIconsetURL(n,l){const f=or(n);return i.h(n)?(f.path=`/styles/v1${f.path}/iconset.pbf`,this._makeAPIURL(f,this._customAccessToken||l)):lt(f)}normalizeSpriteURL(n,l,f,v){const w=or(n);return i.h(n)?(w.path=`/styles/v1${w.path}/sprite${l}${f}`,this._makeAPIURL(w,this._customAccessToken||v)):(w.path+=`${l}${f}`,lt(w))}normalizeTileURL(n,l,f){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!i.h(n))return n;const v=or(n);v.path=v.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||f&&v.authority!=="raster"&&f===512?"@2x":""}${i.k.supported?".webp":"$1"}`),v.authority==="raster"?v.path=`/${i.e.RASTER_URL_PREFIX}${v.path}`:v.authority==="rasterarrays"?v.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${v.path}`:v.authority==="3dtiles"?v.path=`/${i.e.TILES3D_URL_PREFIX}${v.path}`:(v.path=v.path.replace(/^.+\/v4\//,"/"),v.path=`/${i.e.TILE_URL_VERSION}${v.path}`);const w=this._customAccessToken||(function(E){for(const M of E){const D=M.match(/^access_token=(.*)$/);if(D)return D[1]}return null})(v.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&v.params.push(`sku=${this._skuToken}`),this._makeAPIURL(v,w)}canonicalizeTileURL(n,l){const f=or(n);if(!f.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!f.path.match(/\.[\w]+$/))return n;let v="mapbox://";f.path.match(/^\/raster\/v1\//)?v+=`raster/${f.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:f.path.match(/^\/rasterarrays\/v1\//)?v+=`rasterarrays/${f.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:v+=`tiles/${f.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let w=f.params;return l&&(w=w.filter((E=>!E.match(/^access_token=/)))),w.length&&(v+=`?${w.join("&")}`),v}canonicalizeTileset(n,l){const f=!!l&&i.h(l),v=[];for(const w of n.tiles||[])i.j(w)?v.push(this.canonicalizeTileURL(w,f)):v.push(w);return v}_makeAPIURL(n,l){const f="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",v=or(i.e.API_URL);if(n.protocol=v.protocol,n.authority=v.authority,n.protocol==="http"){const w=n.params.indexOf("secure");w>=0&&n.params.splice(w,1)}if(v.path!=="/"&&(n.path=`${v.path}${n.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return lt(n);if(l=l||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${f}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${f}`)}return n.params=n.params.filter((w=>w.indexOf("access_token")===-1)),n.params.push(`access_token=${l||""}`),lt(n)}}const Or=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function or(h){const n=h.match(Or);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function lt(h){const n=h.params.length?`?${h.params.join("&")}`:"";return`${h.protocol}://${h.authority}${h.path}${n}`}const Et="mapbox.eventData";function qt(h){if(!h)return null;const n=h.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(i.l(n[1]))}catch{return null}}class Gt{constructor(n){this.type=n,this.anonId=null,this.anonIdTimestamp=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const l=qt(i.e.ACCESS_TOKEN);let f="";return f=l&&l.u?i.f(l.u):i.e.ACCESS_TOKEN||"",n?`${Et}.${n}:${f}`:`${Et}:${f}`}fetchEventData(){const n=i.s("localStorage"),l=this.getStorageKey(),f=this.getStorageKey("uuid"),v=this.getStorageKey("uuidTimestamp");if(n)try{const w=localStorage.getItem(l);w&&(this.eventData=JSON.parse(w));const E=localStorage.getItem(f);E&&(this.anonId=E);const M=localStorage.getItem(v);M&&(this.anonIdTimestamp=Number(M));const D=Date.now()-864e5;(!this.anonIdTimestamp||this.anonIdTimestamp<D)&&this.refreshUUID()}catch{i.w("Unable to read from LocalStorage")}}refreshUUID(){this.anonId=i.u(),this.anonIdTimestamp=Date.now()}saveEventData(){const n=i.s("localStorage"),l=this.getStorageKey(),f=this.getStorageKey("uuid"),v=this.getStorageKey("uuidTimestamp"),w=this.anonId,E=this.anonIdTimestamp;if(n&&w)try{localStorage.setItem(f,w),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData)),E&&localStorage.setItem(v,E.toString())}catch{i.w("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,l,f,v){if(!i.e.EVENTS_URL)return;const w=or(i.e.EVENTS_URL);w.params.push(`access_token=${v||i.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(n).toISOString()},M=l?Object.assign(E,l):E,D={url:lt(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([M])};this.pendingRequest=i.p(D,(B=>{this.pendingRequest=null,f(B),this.saveEventData(),this.processRequests(v)}))}queueRequest(n,l){this.queue.push(n),this.processRequests(l)}}const tt=new class extends Gt{constructor(h){super("appUserTurnstile"),this._customAccessToken=h}postTurnstileEvent(h,n){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(h)&&h.some((l=>i.h(l)||i.j(l)))&&this.queueRequest(Date.now(),n)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.anonIdTimestamp&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=qt(i.e.ACCESS_TOKEN),l=n?n.u:i.e.ACCESS_TOKEN;let f=l!==this.eventData.tokenU;i.v(this.anonId)||(this.refreshUUID(),f=!0);const v=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),E=new Date(v),M=(v-this.eventData.lastSuccess)/864e5;f=f||M>=1||M<-1||w.getDate()!==E.getDate()}else f=!0;f?this.postEvent(v,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:Ir,"enabled.telemetry":!1,userId:this.anonId},(w=>{w||(this.eventData.lastSuccess=v,this.eventData.tokenU=l)}),h):this.processRequests()}},ct=tt.postTurnstileEvent.bind(tt),_t=new class extends Gt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(h,n,l,f){this.skuToken=n,this.errorCb=f,i.e.EVENTS_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},l):this.errorCb(new Error(nr)))}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:l}=this.queue.shift();n&&this.success[n]||(this.anonId&&this.anonIdTimestamp||this.fetchEventData(),i.v(this.anonId)||this.refreshUUID(),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:Ir,skuToken:this.skuToken,userId:this.anonId},(f=>{f?this.errorCb(f):n&&(this.success[n]=!0)}),h))}remove(){this.errorCb=null}},Vt=_t.postMapLoadEvent.bind(_t),bt=new class extends Gt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(h){let n=this.mapInstanceIdMap.get(h);return n||(n=i.u(),this.mapInstanceIdMap.set(h,n)),n}getEventId(h){const n=this.eventIdPerMapInstanceMap.get(h)||0;return this.eventIdPerMapInstanceMap.set(h,n+1),n}postStyleLoadEvent(h,n){const{map:l,style:f,importedStyles:v}=n;if(!i.e.EVENTS_URL||!h&&!i.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(l),E={mapInstanceId:w,eventId:this.getEventId(w),style:f};v.length&&(E.importedStyles=v),this.queueRequest({timestamp:Date.now(),payload:E},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:l}=this.queue.shift();this.postEvent(n,l,(()=>{}),h)}},ar=bt.postStyleLoadEvent.bind(bt),hr=new class extends Gt{constructor(h){super("metrics"),h&&(this.data=h)}postMetricsEvent(h){if(!i.e.EVENTS_URL||!h&&!i.e.ACCESS_TOKEN)return;this.anonId||this.fetchEventData(),i.v(this.anonId)||this.refreshUUID();const n=Object.assign({},this.data,{sessionId:this.anonId});this.queueRequest({timestamp:Date.now(),payload:n},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:l}=this.queue.shift();this.postEvent(n,l,(()=>{}),h)}}({attributes:[{name:"maps/js/layer-animations/style-with-appearances"}]}),xr=hr.postMetricsEvent.bind(hr),sr=new class extends Gt{constructor(){super("gljs.performance")}postPerformanceEvent(h,n){i.e.EVENTS_URL&&(h||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:l}=this.queue.shift(),f=(function(v){const w=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),M=(function(Y){const ee={};if(Y){for(const re in Y)if(re!=="other")for(const ce of Y[re]){const ae=`${re}ResolveRangeMin`,de=`${re}ResolveRangeMax`,ye=`${re}RequestCount`,fe=`${re}RequestCachedCount`;ee[ae]=Math.min(ee[ae]||1/0,ce.startTime),ee[de]=Math.max(ee[de]||-1/0,ce.responseEnd);const Me=xe=>{ee[xe]===void 0&&(ee[xe]=0),++ee[xe]};ce.transferSize!==void 0&&ce.transferSize===0&&Me(fe),Me(ye)}}return ee})((function(Y,ee){const re={};if(Y)for(const ce of Y){const ae=ee(ce);re[ae]===void 0&&(re[ae]=[]),re[ae].push(ce)}return re})(w,F)),D=window.devicePixelRatio,B=navigator.connection||navigator.mozConnection||navigator.webkitConnection,j=B?B.effectiveType:void 0,q={counters:[],metadata:[],attributes:[]},U=(Y,ee,re)=>{re!=null&&Y.push({name:ee,value:re.toString()})};for(const Y in M)U(q.counters,Y,M[Y]);if(v.interactionRange[0]!==1/0&&v.interactionRange[1]!==-1/0&&(U(q.counters,"interactionRangeMin",v.interactionRange[0]),U(q.counters,"interactionRangeMax",v.interactionRange[1])),E)for(const Y of Object.values(R)){const ee=E.find((re=>re.name===Y));ee&&U(q.counters,Y,ee.startTime)}return U(q.counters,"visibilityHidden",v.visibilityHidden),U(q.attributes,"style",(function(Y){if(Y)for(const ee of Y){const re=ee.name.split("?")[0];if(i.i(re)){const ce=re.split("/").slice(-2);if(ce.length===2)return`mapbox://styles/${ce[0]}/${ce[1]}`}}})(w)),U(q.attributes,"terrainEnabled",v.terrainEnabled?"true":"false"),U(q.attributes,"fogEnabled",v.fogEnabled?"true":"false"),U(q.attributes,"projection",v.projection),U(q.attributes,"zoom",v.zoom),U(q.metadata,"devicePixelRatio",D),U(q.metadata,"connectionEffectiveType",j),U(q.metadata,"navigatorUserAgent",navigator.userAgent),U(q.metadata,"screenWidth",window.screen.width),U(q.metadata,"screenHeight",window.screen.height),U(q.metadata,"windowWidth",window.innerWidth),U(q.metadata,"windowHeight",window.innerHeight),U(q.metadata,"mapWidth",v.width/D),U(q.metadata,"mapHeight",v.height/D),U(q.metadata,"webglRenderer",v.renderer),U(q.metadata,"webglVendor",v.vendor),U(q.metadata,"sdkVersion",C),U(q.metadata,"sdkIdentifier","mapbox-gl-js"),q})(l);for(const v of f.metadata);for(const v of f.counters);for(const v of f.attributes);this.postEvent(n,f,(()=>{}),h)}},Br=sr.postPerformanceEvent.bind(sr),hn=new class extends Gt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(h,n,l,f){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const v=or(i.e.API_URL+i.e.SESSION_PATH);v.params.push(`sku=${n||""}`),v.params.push(`access_token=${f||i.e.ACCESS_TOKEN||""}`);const w={url:lt(v),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(w,(E=>{this.pendingRequest=null,l(E),this.saveEventData(),this.processRequests(f)}))}getSessionAPI(h,n,l,f){this.skuToken=n,this.errorCb=f,i.e.SESSION_PATH&&i.e.API_URL&&(l||i.e.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},l):this.errorCb(new Error(nr)))}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:l}=this.queue.shift();n&&this.success[n]||this.getSession(l,this.skuToken,(f=>{f?this.errorCb(f):n&&(this.success[n]=!0)}),h)}remove(){this.errorCb=null}},Vn=hn.getSessionAPI.bind(hn),Yr=new Set;function Un(h,n){n?Yr.add(h):Yr.delete(h)}class Si{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(n,l){this._updatedSourceCaches[n]=l,this.setDirty()}discardSourceCacheUpdate(n){delete this._updatedSourceCaches[n]}updateLayer(n){const l=n.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(n.id),this.setDirty()}removeLayer(n){const l=n.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][n.id]=n,this._updatedLayers[l].delete(n.id),this._updatedPaintProps.delete(n.fqid),this.setDirty()}getRemovedLayer(n){return this._removedLayers[n.scope]?this._removedLayers[n.scope][n.id]:null}discardLayerRemoval(n){this._removedLayers[n.scope]&&delete this._removedLayers[n.scope][n.id]}getLayerUpdatesByScope(){const n={};for(const l in this._updatedLayers)n[l]=n[l]||{},n[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)n[l]=n[l]||{},n[l].removedIds=Object.keys(this._removedLayers[l]);return n}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(n){this._updatedPaintProps.add(n.fqid),this.setDirty()}getUpdatedImages(n){return this._updatedImages[n]?Array.from(this._updatedImages[n].values()):[]}updateImage(n,l){this._updatedImages[l]=this._updatedImages[l]||new Set,this._updatedImages[l].add(i.I.toString(n)),this.setDirty()}resetUpdatedImages(n){this._updatedImages[n]&&this._updatedImages[n].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function di(h){const{userImage:n}=h;return!!(n&&n.render&&n.render())&&(h.data.replace(new Uint8Array(n.data.buffer)),!0)}class Ii extends i.E{constructor(n){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=n,n!=="raster"&&i.r()&&(this.imageRasterizerDispatcher=new i.D(i.t(),this,"Image Rasterizer Worker",1))}addScope(n){this.loaded.set(n,!1),this.imageProviders.set(n,new Map),this.images.set(n,new Map),this.updatedImages.set(n,new Set),this.callbackDispatchedThisFrame.set(n,new Set),this.patterns.set(n,new Map),this.atlasImage.set(n,new i.q({width:1,height:1}))}removeScope(n){this.loaded.delete(n),this.imageProviders.delete(n),this.images.delete(n),this.updatedImages.delete(n),this.callbackDispatchedThisFrame.delete(n),this.patterns.delete(n),this.atlasImage.delete(n);const l=this.atlasTexture.get(n);l&&(l.destroy(),this.atlasTexture.delete(n))}addImageProvider(n,l){this.imageProviders.has(l)||this.imageProviders.set(l,new Map),this.imageProviders.get(l).set(n.id,n)}removeImageProvider(n,l){this.imageProviders.has(l)&&this.imageProviders.get(l).delete(n)}getPendingImageProviders(){const n=[];for(const l of this.imageProviders.values())for(const f of l.values())f.hasPendingRequests()&&n.push(f);return n}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.x),this._imageRasterizer}isLoaded(){for(const n of this.loaded.keys())if(!this.loaded.get(n))return!1;return!0}setLoaded(n,l){if(this.loaded.get(l)!==n&&(this.loaded.set(l,n),n)){for(const{ids:f,callback:v}of this.requestors)this._notify(f,l,v);this.requestors=[]}}hasImage(n,l){return!!this.getImage(n,l)}getImage(n,l){return this.images.get(l).get(n.toString())}addImage(n,l,f){this._validate(n,f)&&this.images.get(l).set(n.toString(),f)}_validate(n,l){let f=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new i.y(new Error(`Image "${n.name}" has invalid "stretchX" value`))),f=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new i.y(new Error(`Image "${n.name}" has invalid "stretchY" value`))),f=!1),this._validateContent(l.content,l)||(this.fire(new i.y(new Error(`Image "${n.name}" has invalid "content" value`))),f=!1),f}_validateStretch(n,l){if(!n)return!0;let f=0;for(const v of n){if(v[0]<f||v[1]<v[0]||l<v[1])return!1;f=v[1]}return!0}_validateContent(n,l){return n?n.length!==4||!l.usvg&&(n[0]<0||l.data.width<n[0]||n[1]<0||l.data.height<n[1]||n[2]<0||l.data.width<n[2]||n[3]<0||l.data.height<n[3])?!1:!(n[2]<n[0]||n[3]<n[1]):!0}updateImage(n,l,f){const v=this.images.get(l).get(n.toString());f.version=v.version+1,this.images.get(l).set(n.toString(),f),this.updatedImages.get(l).add(n),this.removeFromImageRasterizerCache(n,l)}clearUpdatedImages(n){this.updatedImages.get(n).clear()}removeFromImageRasterizerCache(n,l){this.spriteFormat!=="raster"&&(i.r()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[n],scope:l}):this.imageRasterizer.removeImagesFromCacheByIds([n],l))}removeImage(n,l){const f=this.images.get(l),v=f.get(n.toString());f.delete(n.toString()),this.patterns.get(l).delete(n.toString()),this.removeFromImageRasterizerCache(n,l),v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()}listImages(n){return Array.from(this.images.get(n).keys()).map((l=>i.I.from(l)))}getImages(n,l,f){const v=[],w=[],E=this.imageProviders.get(l);for(const j of n){if(!j.iconsetId){v.push(j);continue}const q=E.get(j.iconsetId);q&&(this.getImage(j,l)?w.push(j):q.addPendingRequest(j))}if(v.length===0)return void this._notify(w,l,f);let M=!0;const D=!!this.loaded.get(l),B=this.images.get(l);if(!D)for(const j of v)B.has(j.toString())||(M=!1);D||M?this._notify(v,l,f):this.requestors.push({ids:v,scope:l,callback:f})}rasterizeImages(n,l){const f=new Map,{tasks:v,scope:w}=n;for(const[E,M]of v.entries()){const D=this.getImage(M.id,w);D&&f.set(E,{image:D,imageVariant:M})}this._rasterizeImages(w,f,l)}_rasterizeImages(n,l,f){if(i.r())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:l,scope:n},f);else{const v=new Map;for(const[w,{image:E,imageVariant:M}]of l.entries())v.set(w,this.imageRasterizer.rasterize(M,E,n,0));f(void 0,v)}}getUpdatedImages(n){return this.updatedImages.get(n)||new Set}_notify(n,l,f){const v=this.images.get(l),w=new Map;for(const E of n){if(!v.get(E.toString())){if(E.iconsetId)continue;this.fire(new i.z("styleimagemissing",{id:E.name}))}const M=v.get(E.toString());if(!M){i.w(`Image "${E.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const D={data:M.usvg?null:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,usvg:M.usvg,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:!!(M.userImage&&M.userImage.render)};M.usvg&&Object.assign(D,{width:M.icon.usvg_tree.width,height:M.icon.usvg_tree.height}),w.set(i.I.toString(E),D)}f(null,w)}getPixelSize(n){const{width:l,height:f}=this.atlasImage.get(n);return{width:l,height:f}}getPattern(n,l,f){const v=n.toString(),w=this.patterns.get(l),E=w.get(v),M=this.getImage(n,l);if(!M)return null;if(E){if(E.position.version===M.version)return E.position;E.position.version=M.version}else{if(M.usvg&&!M.data){const D=this.getPatternInFlightId(v,l);if(this.patternsInFlight.has(D))return null;this.patternsInFlight.add(D);const B=new i.A(n).scaleSelf(i.o.devicePixelRatio),j=new Map([[B.toString(),{image:M,imageVariant:B}]]);return this._rasterizeImages(l,j,((q,U)=>this.storePatternImage(B,l,M,f,U))),null}this.storePattern(n,l,M)}return this._updatePatternAtlas(l,f),w.get(v).position}getPatternInFlightId(n,l){return i.B(n,l)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(n,l,f,v,w){const E=n.toString(),M=w?w.get(E):void 0;M&&(f.data=M,this.storePattern(n.id,l,f),this._updatePatternAtlas(l,v),this.patternsInFlight.delete(this.getPatternInFlightId(n.id.toString(),l)))}storePattern(n,l,f){const v={w:f.data.width+2*i.C,h:f.data.height+2*i.C,x:0,y:0},w=new i.F(v,f,i.C);this.patterns.get(l).set(n.toString(),{bin:v,position:w})}destroyAtlasTextures(){for(const n of this.atlasTexture.values())n&&n.destroy();this.atlasTexture.clear()}bind(n,l){const f=n.gl;let v=this.atlasTexture.get(l);v?this.dirty&&(v.update(this.atlasImage.get(l)),this.dirty=!1):(v=new i.T(n,this.atlasImage.get(l),f.RGBA8),this.atlasTexture.set(l,v)),v.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(n,l){const f=this.patterns.get(n),v=Array.from(f.values()).map((({bin:B})=>B)),{w,h:E}=i.G(v),M=this.atlasImage.get(n);M.resize({width:w||1,height:E||1});const D=this.images.get(n);for(const[B,{bin:j,position:q}]of f.entries()){let U=q.padding;const Y=j.x+U,ee=j.y+U,re=D.get(B).data,ce=re.width,ae=re.height;U=U>1?U-1:U,i.q.copy(re,M,{x:0,y:0},{x:Y,y:ee},{width:ce,height:ae},l),i.q.copy(re,M,{x:0,y:ae-U},{x:Y,y:ee-U},{width:ce,height:U},l),i.q.copy(re,M,{x:0,y:0},{x:Y,y:ee+ae},{width:ce,height:U},l),i.q.copy(re,M,{x:ce-U,y:0},{x:Y-U,y:ee},{width:U,height:ae},l),i.q.copy(re,M,{x:0,y:0},{x:Y+ce,y:ee},{width:U,height:ae},l),i.q.copy(re,M,{x:ce-U,y:ae-U},{x:Y-U,y:ee-U},{width:U,height:U},l),i.q.copy(re,M,{x:0,y:ae-U},{x:Y+ce,y:ee-U},{width:U,height:U},l),i.q.copy(re,M,{x:0,y:0},{x:Y+ce,y:ee+ae},{width:U,height:U},l),i.q.copy(re,M,{x:ce-U,y:0},{x:Y-U,y:ee+ae},{width:U,height:U},l)}this.dirty=!0}beginFrame(){for(const n of this.images.keys())this.callbackDispatchedThisFrame.set(n,new Set)}dispatchRenderCallbacks(n,l){const f=this.images.get(l);for(const v of n){if(this.callbackDispatchedThisFrame.get(l).has(v.toString()))continue;this.callbackDispatchedThisFrame.get(l).add(v.toString());const w=f.get(v.toString());di(w)&&this.updateImage(v,l,w)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function Xn(h){const n=h.value,l=h.valueSpec,f=h.style,v=h.styleSpec,w=h.key,E=h.arrayElementValidator||_i;if(!Array.isArray(n))return[new i.V(w,n,`array expected, ${i.K(n)} found`)];if(l.length&&n.length!==l.length)return[new i.V(w,n,`array length ${l.length} expected, length ${n.length} found`)];if(l["min-length"]&&n.length<l["min-length"])return[new i.V(w,n,`array length at least ${l["min-length"]} expected, length ${n.length} found`)];let M={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};v.$version<7&&(M.function=l.function),i.H(l.value)&&(M=l.value);let D=[];for(let B=0;B<n.length;B++)D=D.concat(E({array:n,arrayIndex:B,value:n[B],valueSpec:M,style:f,styleSpec:v,key:`${w}[${B}]`},!0));return D}function Go(h){const n=h.key,l=h.value,f=h.valueSpec;if(!i.L(l))return[new i.V(n,l,`number expected, ${i.K(l)} found`)];if(l!=l)return[new i.V(n,l,"number expected, NaN found")];if("minimum"in f){let v=f.minimum;if(Array.isArray(f.minimum)&&(v=f.minimum[h.arrayIndex]),l<v)return[new i.V(n,l,`${l} is less than the minimum value ${v}`)]}if("maximum"in f){let v=f.maximum;if(Array.isArray(f.maximum)&&(v=f.maximum[h.arrayIndex]),l>v)return[new i.V(n,l,`${l} is greater than the maximum value ${v}`)]}return[]}function Lo(h){const n=h.key,l=h.value;if(!i.H(l))return[new i.V(n,l,`object expected, ${i.K(l)} found`)];const f=h.valueSpec,v=i.J(l.type);let w,E,M,D={};const B=v!=="categorical"&&l.property===void 0,j=!B,q=(function(re){const ce=re.stops;return Array.isArray(ce)&&Array.isArray(ce[0])&&i.H(ce[0][0])})(l),U=Zi({key:h.key,value:h.value,valueSpec:h.styleSpec.function,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(re){if(v==="identity")return[new i.V(re.key,re.value,'identity function may not have a "stops" property')];let ce=[];const ae=re.value;return ce=ce.concat(Xn({key:re.key,value:ae,valueSpec:re.valueSpec,style:re.style,styleSpec:re.styleSpec,arrayElementValidator:Y})),Array.isArray(ae)&&ae.length===0&&ce.push(new i.V(re.key,ae,"array must have at least one stop")),ce},default:function(re){return _i({key:re.key,value:re.value,valueSpec:f,style:re.style,styleSpec:re.styleSpec})}}});return v==="identity"&&B&&U.push(new i.V(h.key,h.value,'missing required property "property"')),v==="identity"||l.stops||U.push(new i.V(h.key,h.value,'missing required property "stops"')),v==="exponential"&&f.expression&&!i.M(f)&&U.push(new i.V(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(j&&!i.N(f)?U.push(new i.V(h.key,h.value,"property functions not supported")):B&&!i.O(f)&&U.push(new i.V(h.key,h.value,"zoom functions not supported"))),v!=="categorical"&&!q||l.property!==void 0||U.push(new i.V(h.key,h.value,'"property" property is required')),U;function Y(re){let ce=[];const ae=re.value,de=re.key;if(!Array.isArray(ae))return[new i.V(de,ae,`array expected, ${i.K(ae)} found`)];if(ae.length!==2)return[new i.V(de,ae,`array length 2 expected, length ${ae.length} found`)];if(q){if(!i.H(ae[0]))return[new i.V(de,ae,`object expected, ${i.K(ae[0])} found`)];const ye=ae[0];if(ye.zoom===void 0)return[new i.V(de,ae,"object stop key must have zoom")];if(ye.value===void 0)return[new i.V(de,ae,"object stop key must have value")];const fe=i.J(ye.zoom);if(typeof fe!="number")return[new i.V(de,ye.zoom,"stop zoom values must be numbers")];if(M&&M>fe)return[new i.V(de,ye.zoom,"stop zoom values must appear in ascending order")];fe!==M&&(M=fe,E=void 0,D={}),ce=ce.concat(Zi({key:`${de}[0]`,value:ae[0],valueSpec:{zoom:{}},style:re.style,styleSpec:re.styleSpec,objectElementValidators:{zoom:Go,value:ee}}))}else ce=ce.concat(ee({key:`${de}[0]`,value:ae[0],style:re.style,styleSpec:re.styleSpec},ae));return i.Q(i.S(ae[1]))?ce.concat([new i.V(`${de}[1]`,ae[1],"expressions are not allowed in function stops.")]):ce.concat(_i({key:`${de}[1]`,value:ae[1],valueSpec:f,style:re.style,styleSpec:re.styleSpec}))}function ee(re,ce){const ae=i.K(re.value),de=i.J(re.value),ye=re.value!==null?re.value:ce;if(w){if(ae!==w)return[new i.V(re.key,ye,`${ae} stop domain type must match previous stop domain type ${w}`)]}else w=ae;if(ae!=="number"&&ae!=="string"&&ae!=="boolean"&&typeof de!="number"&&typeof de!="string"&&typeof de!="boolean")return[new i.V(re.key,ye,"stop domain value must be a number, string, or boolean")];if(ae!=="number"&&v!=="categorical"){let fe=`number expected, ${ae} found`;return i.N(f)&&v===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(re.key,ye,fe)]}return v!=="categorical"||ae!=="number"||typeof de=="number"&&isFinite(de)&&Math.floor(de)===de?v!=="categorical"&&ae==="number"&&typeof de=="number"&&typeof E=="number"&&E!==void 0&&de<E?[new i.V(re.key,ye,"stop domain values must appear in ascending order")]:(E=de,v==="categorical"&&de in D?[new i.V(re.key,ye,"stop domain values must be unique")]:(D[de]=!0,[])):[new i.V(re.key,ye,`integer expected, found ${String(de)}`)]}}function co(h){const n=(h.expressionContext==="property"?i.W:i.U)(i.S(h.value),h.valueSpec);if(n.result==="error")return n.value.map((f=>new i.V(`${h.key}${f.key}`,h.value,f.message)));const l=n.value.expression||n.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!l.outputDefined())return[new i.V(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!i.Z(l))return[new i.V(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter")return Ko(l,h);if(h.expressionContext==="appearance")return ds(l,h);if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!i.X(l,["zoom","feature-state"]))return[new i.V(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!i.Y(l))return[new i.V(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ko(h,n){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const v of n.valueSpec.expression.parameters)l.delete(v);if(l.size===0)return[];const f=[];return h instanceof i._&&l.has(h.name)?[new i.V(n.key,n.value,`["${h.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(h.eachChild((v=>{f.push(...Ko(v,n))})),f)}function ds(h,n){const l=new Set;if(n.valueSpec&&n.valueSpec.expression)for(const v of n.valueSpec.expression.parameters)l.add(v);if(l.size===0)return[];const f=[];return h instanceof i._&&!l.has(h.name)?[new i.V(n.key,n.value,`["${h.name}"] is not an allowed parameter`)]:(h.eachChild((v=>{f.push(...ds(v,n))})),f)}function Bo(h){const n=h.key,l=h.value,f=h.valueSpec,v=[];return Array.isArray(f.values)?f.values.indexOf(i.J(l))===-1&&v.push(new i.V(n,l,`expected one of [${f.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(f.values).indexOf(i.J(l))===-1&&v.push(new i.V(n,l,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(l)} found`)),v}function ra(h){return i.a2(i.S(h.value))?co(Object.assign({},h,{expressionContext:"filter",valueSpec:h.styleSpec[`filter_${h.layerType||"fill"}`]})):va(h)}function va(h){const n=h.value,l=h.key;if(!Array.isArray(n))return[new i.V(l,n,`array expected, ${i.K(n)} found`)];if(n.length<1)return[new i.V(l,n,"filter array must have at least 1 element")];const f=h.styleSpec;let v=Bo({key:`${l}[0]`,value:n[0],valueSpec:f.filter_operator});switch(i.J(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&i.J(n[1])==="$type"&&v.push(new i.V(l,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new i.V(l,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(i.a0(n[1])||v.push(new i.V(`${l}[1]`,n[1],`string expected, ${i.K(n[1])} found`)));for(let w=2;w<n.length;w++)i.J(n[1])==="$type"?v=v.concat(Bo({key:`${l}[${w}]`,value:n[w],valueSpec:f.geometry_type})):i.a0(n[w])||i.L(n[w])||i.$(n[w])||v.push(new i.V(`${l}[${w}]`,n[w],`string, number, or boolean expected, ${i.K(n[w])} found.`));break;case"any":case"all":case"none":for(let w=1;w<n.length;w++)v=v.concat(va({key:`${l}[${w}]`,value:n[w],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":n.length!==2?v.push(new i.V(l,n,`filter array for "${n[0]}" operator must have 2 elements`)):i.a0(n[1])||v.push(new i.V(`${l}[1]`,n[1],`string expected, ${i.K(n[1])} found`))}return v}function xa(h,n){const l=h.key,f=h.style,v=h.layer,w=h.styleSpec,E=h.value,M=h.objectKey,D=w[`${n}_${h.layerType}`];if(!D)return[];const B=M.match(/^(.*)-use-theme$/);if(B&&D[B[1]])return i.Q(i.S(E))?[].concat(_i({key:l,value:E,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:f,styleSpec:w,expressionContext:"property",propertyType:n,propertyKey:M})):_i({key:l,value:E,valueSpec:{type:"string"},style:f,styleSpec:w});const j=M.match(/^(.*)-transition$/);if(n==="paint"&&j&&D[j[1]]&&D[j[1]].transition)return _i({key:l,value:E,valueSpec:w.transition,style:f,styleSpec:w});const q=h.valueSpec||D[M];if(!q)return[new i.a3(l,E,`unknown property "${M}"`)];let U;if(i.a0(E)&&i.N(q)&&!q.tokens&&(U=/^{([^}]+)}$/.exec(E))){const ee=`\`{ "type": "identity", "property": ${U?JSON.stringify(U[1]):'"_"'} }\``;return[new i.V(l,E,`"${M}" does not support interpolation syntax
Use an identity property function instead: ${ee}.`)]}const Y=[];if(h.layerType==="symbol")M!=="text-field"||!f||f.glyphs||f.imports||Y.push(new i.V(l,E,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&i.a4(i.S(E))&&i.J(E.type)==="identity"&&Y.push(new i.V(l,E,'"text-font" does not support identity functions'));else if(h.layerType==="model"&&n==="paint"&&v&&v.layout&&v.layout.hasOwnProperty("model-id")&&i.N(q)&&(i.a5(q)||i.O(q))){const ee=i.W(i.S(E),q).value,re="expression"in ee&&ee.expression||"_styleExpression"in ee&&ee._styleExpression&&ee._styleExpression.expression;re&&!i.X(re,["measure-light"])&&(M==="model-emissive-strength"&&i.Y(re)&&i.Z(re)||Y.push(new i.V(l,E,`${M} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Y.concat(_i({key:h.key,value:E,valueSpec:q,style:f,styleSpec:w,expressionContext:"property",propertyType:n,propertyKey:M}))}function Bs(h){return xa(h,"paint")}function Qo(h){return xa(h,"layout")}function na(h){let n=[];const l=h.value,f=h.key,v=h.style,w=h.styleSpec;if(!i.H(l))return[new i.V(f,l,"object expected")];l.type||l.ref||n.push(new i.V(f,l,'either "type" or "ref" is required'));let E=i.J(l.type);const M=i.J(l.ref);if(l.id){const D=i.J(l.id);for(let B=0;B<h.arrayIndex;B++){const j=v.layers[B];i.J(j.id)===D&&n.push(new i.V(f,l.id,`duplicate layer id "${D}", previously used at line ${j.id.__line__}`))}}if("ref"in l){let D;["type","source","source-layer","filter","layout"].forEach((B=>{B in l&&n.push(new i.V(f,l[B],`"${B}" is prohibited for ref layers`))})),v.layers.forEach((B=>{i.J(B.id)===M&&(D=B)})),D?D.ref?n.push(new i.V(f,l.ref,"ref cannot reference another ref layer")):E=i.J(D.type):typeof M=="string"&&n.push(new i.V(f,l.ref,`ref layer "${M}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(l.source)if(i.a0(l.source)){const D=v.sources&&v.sources[l.source],B=D&&i.J(D.type);D?B==="vector"&&E==="raster"?n.push(new i.V(f,l.source,`layer "${l.id}" requires a raster source`)):B==="raster"&&E!=="raster"?n.push(new i.V(f,l.source,`layer "${l.id}" requires a vector source`)):B!=="vector"||l["source-layer"]?B==="raster-dem"&&E!=="hillshade"?n.push(new i.V(f,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):B!=="raster-array"||["raster","raster-particle"].includes(E)?E==="line"&&l.paint&&(l.paint["line-gradient"]||l.paint["line-trim-offset"])&&B==="geojson"&&!D.lineMetrics?n.push(new i.V(f,l,`layer "${l.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):E==="raster-particle"&&B!=="raster-array"&&n.push(new i.V(f,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):n.push(new i.V(f,l.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new i.V(f,l,`layer "${l.id}" must specify a "source-layer"`)):n.push(new i.V(f,l.source,`source "${l.source}" not found`))}else n.push(new i.V(`${f}.source`,l.source,'"source" must be a string'));else n.push(new i.V(f,l,'missing required property "source"'));return n=n.concat(Zi({key:f,value:l,valueSpec:w.layer,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{"*":()=>[],type:()=>_i({key:`${f}.type`,value:l.type,valueSpec:w.layer.type,style:h.style,styleSpec:h.styleSpec,object:l,objectKey:"type"}),filter:D=>ra(Object.assign({layerType:E},D)),layout:D=>Zi({layer:l,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":B=>Qo(Object.assign({layerType:E},B))}}),paint:D=>Zi({layer:l,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":B=>Bs(Object.assign({layerType:E,layer:l},B))}}),appearances(D){const B=Xn({key:D.key,value:D.value,valueSpec:D.valueSpec,style:D.style,styleSpec:D.styleSpec,arrayElementValidator:U=>(function(Y){const{key:ee,layer:re,layerType:ce}=Y,ae=i.J(Y.value),de=i.J(ae.name),ye=i.J(ae.condition),fe=Zi({key:ee,value:ae,valueSpec:Y.styleSpec.appearance,style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{condition:Me=>(function(xe){const Ce=[];return Ce.push(...co({key:xe.key,value:xe.object.condition,valueSpec:i.a6.appearance.condition,expressionContext:"appearance"})),Ce})(Object.assign({layer:re,layerType:ce},Me)),properties:Me=>(function(xe){const Ce=[],{styleSpec:Te,layer:be,layerType:De}=xe,He=Te[`paint_${De}`],$e=Te[`layout_${De}`],st=xe.object[xe.objectKey];for(const Qe in st){const pt=Qe in He?"paint":Qe in $e?"layout":void 0;if(!pt){Ce.push(new i.V(xe.key,Qe,`unknown property "${Qe}" for layer type "${De}"`));continue}const Ft=Object.assign({},xe,{key:`${xe.key}.${Qe}`,object:st,objectKey:Qe,layer:be,layerType:De,value:st[Qe],valueSpec:pt==="paint"?He[Qe]:$e[Qe]});Ce.push(...xa(Ft,pt))}return Ce})(Object.assign({layer:re,layerType:ce},Me))}});return de!=="hidden"&&ye===void 0&&fe.push(new i.V(Y.key,"name",'Appearance with name different than "hidden" must have a condition')),fe})(Object.assign({layerType:E,layer:l},U))}),j=Array.isArray(D.value)?D.value:[],q=new Set;return j.forEach(((U,Y)=>{const ee=i.J(U.name);if(ee)if(q.has(ee)){const re=i.J(l.id);B.push(new i.V(D.key,ee,`Duplicated appearance name "${ee}" for layer "${re}"`))}else q.add(ee)})),B}}})),n}function hs({key:h,value:n}){return i.a0(n)?[]:[new i.V(h,n,`string expected, ${i.K(n)} found`)]}const Cl={promoteId:function h({key:n,value:l}){if(i.a0(l))return hs({key:n,value:l});if(Array.isArray(l)){const v=[],w=i.S(l),E=i.U(w);return E.result==="error"&&E.value.forEach((M=>{v.push(new i.V(`${n}${M.key}`,null,`${M.message}`))})),i.X(E.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||v.push(new i.V(`${n}`,null,"promoteId expression should be only feature dependent")),v}if(!i.H(l))return[new i.V(n,l,`string, expression or object expected, "${i.K(l)}" found`)];const f=[];for(const v in l)f.push(...h({key:`${n}.${v}`,value:l[v]}));return f}};function Al(h){const n=h.value,l=h.key,f=h.styleSpec,v=h.style;if(!i.H(n))return[new i.V(l,n,`object expected, ${i.K(n)} found`)];if(!("type"in n))return[new i.V(l,n,'"type" is required')];const w=i.J(n.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&("url"in n||"tiles"in n||E.push(new i.a3(l,n,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(Zi({key:l,value:n,valueSpec:f[`source_${w.replace("-","_")}`],style:h.style,styleSpec:f,objectElementValidators:Cl})),E;case"geojson":if(E=Zi({key:l,value:n,valueSpec:f.source_geojson,style:v,styleSpec:f,objectElementValidators:Cl}),"cluster"in n&&"clusterProperties"in n){if(!i.H(n.clusterProperties))return[new i.V(`${l}.clusterProperties`,n,`object expected, ${i.K(n)} found`)];for(const M in n.clusterProperties){const D=n.clusterProperties[M];if(!Array.isArray(D))return[new i.V(`${l}.clusterProperties.${M}`,D,"array expected")];const[B,j]=D,q=typeof B=="string"?[B,["accumulated"],["get",M]]:B;E.push(...co({key:`${l}.${M}.map`,value:j,expressionContext:"cluster-map"})),E.push(...co({key:`${l}.${M}.reduce`,value:q,expressionContext:"cluster-reduce"}))}}return E;case"video":return Zi({key:l,value:n,valueSpec:f.source_video,style:v,styleSpec:f});case"image":return Zi({key:l,value:n,valueSpec:f.source_image,style:v,styleSpec:f});case"canvas":return[new i.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bo({key:`${l}.type`,value:n.type,valueSpec:{values:io(f)}})}}function io(h){return h.source.reduce(((n,l)=>{const f=h[l];return f.type.type==="enum"&&(n=n.concat(Object.keys(f.type.values||{}))),n}),[])}function js(h){const n=h.value,l=h.styleSpec,f=l.light,v=h.style;if(n===void 0)return[];if(!i.H(n))return[new i.V("light",n,`object expected, ${i.K(n)} found`)];let w=[];for(const E in n){const M=E.match(/^(.*)-transition$/),D=E.match(/^(.*)-use-theme$/);w=w.concat(D&&f[D[1]]?_i({key:E,value:n[E],valueSpec:{type:"string"},style:v,styleSpec:l}):M&&f[M[1]]&&f[M[1]].transition?_i({key:E,value:n[E],valueSpec:l.transition,style:v,styleSpec:l}):f[E]?_i({key:E,value:n[E],valueSpec:f[E],style:v,styleSpec:l}):[new i.V(E,n[E],`unknown property "${E}"`)])}return w}function ba(h){const n=h.value;if(!n)return[];const l=h.key;if(!i.H(n))return[new i.V(l,n,`object expected, ${i.K(n)} found`)];let f=[];const v=h.styleSpec,w=v["light-3d"],E=h.style,M=h.style.lights;for(const j of["type","id"])if(!(j in n))return f=f.concat([new i.V(l,n,`missing property "${j}"`)]),f;if(!i.a0(n.type))return f=f.concat([new i.V(`${l}.type`,n.type,"string expected")]),f;if(M)for(let j=0;j<h.arrayIndex;j++){const q=i.J(n.type),U=M[j];i.J(U.type)===q&&f.push(new i.V(l,n.id,`duplicate light type "${n.type}", previously defined at line ${U.id.__line__}`))}const D=`properties_light_${n.type}`;if(!(D in v))return f=f.concat([new i.V(`${l}.type`,n,`Invalid light type ${n.type}`)]),f;const B=v[D];for(const j in n)if(j==="properties"){const q=n[j];if(!i.H(q))return f=f.concat([new i.V("properties",q,`object expected, ${i.K(q)} found`)]),f;for(const U in q){const Y=U.match(/^(.*)-transition$/),ee=U.match(/^(.*)-use-theme$/);f=f.concat(ee&&B[ee[1]]?_i({key:j,value:q[U],valueSpec:{type:"string"},style:E,styleSpec:v}):Y&&B[Y[1]]&&B[Y[1]].transition?_i({key:j,value:n[j],valueSpec:v.transition,style:E,styleSpec:v}):B[U]?_i({key:U,value:q[U],valueSpec:B[U],style:E,styleSpec:v}):[new i.a3(h.key,q[U],`unknown property "${U}"`)])}}else f=f.concat(w[j]?_i({key:j,value:n[j],valueSpec:w[j],style:E,styleSpec:v}):[new i.a3(j,n[j],`unknown property "${j}"`)]);return f}function wa(h){const n=h.value,l=h.key,f=h.style,v=h.styleSpec,w=v.terrain;if(n==null)return[];if(!i.H(n))return[new i.V("terrain",n,`object expected, ${i.K(n)} found`)];let E=[];for(const M in n){const D=M.match(/^(.*)-transition$/),B=M.match(/^(.*)-use-theme$/);E=E.concat(B&&w[B[1]]?_i({key:M,value:n[M],valueSpec:{type:"string"},style:f,styleSpec:v}):D&&w[D[1]]&&w[D[1]].transition?_i({key:M,value:n[M],valueSpec:v.transition,style:f,styleSpec:v}):w[M]?_i({key:M,value:n[M],valueSpec:w[M],style:f,styleSpec:v}):[new i.a3(M,n[M],`unknown property "${M}"`)])}if(n.source)if(i.a0(n.source)){const M=f.sources&&f.sources[n.source],D=M&&i.J(M.type);M?D!=="raster-dem"&&E.push(new i.V(`${l}.source`,n.source,`terrain cannot be used with a source of type ${D}, it only be used with a "raster-dem" source type`)):E.push(new i.V(`${l}.source`,n.source,`source "${n.source}" not found`))}else E.push(new i.V(`${l}.source`,n.source,"source must be a string"));else E.push(new i.V(l,n,'terrain is missing required property "source"'));return E}function Ps(h){const n=h.value,l=h.style,f=h.styleSpec,v=f.fog;if(n===void 0)return[];if(!i.H(n))return[new i.V("fog",n,`object expected, ${i.K(n)} found`)];let w=[];for(const E in n){const M=E.match(/^(.*)-transition$/),D=E.match(/^(.*)-use-theme$/);w=w.concat(D&&v[D[1]]?_i({key:E,value:n[E],valueSpec:{type:"string"},style:l,styleSpec:f}):M&&v[M[1]]&&v[M[1]].transition?_i({key:E,value:n[E],valueSpec:f.transition,style:l,styleSpec:f}):v[E]?_i({key:E,value:n[E],valueSpec:v[E],style:l,styleSpec:f}):[new i.a3(E,n[E],`unknown property "${E}"`)])}return w}const Is={"*":()=>[],array:Xn,boolean:function(h){const n=h.value,l=h.key;return i.$(n)?[]:[new i.V(l,n,`boolean expected, ${i.K(n)} found`)]},number:Go,color:function({key:h,value:n}){return i.a0(n)?i.a1.parseCSSColor(n)===null?[new i.V(h,n,`color expected, "${n}" found`)]:[]:[new i.V(h,n,`color expected, ${i.K(n)} found`)]},enum:Bo,filter:ra,function:Lo,layer:na,object:Zi,source:Al,model:i.a7,light:js,"light-3d":ba,terrain:wa,fog:Ps,string:hs,formatted:function(h){return hs(h).length===0?[]:co(h)},resolvedImage:function(h){return hs(h).length===0?[]:co(h)},projection:function(h){const n=h.value,l=h.styleSpec,f=l.projection,v=h.style;if(i.H(n)){let w=[];for(const E in n)w=w.concat(_i({key:E,value:n[E],valueSpec:f[E],style:v,styleSpec:l}));return w}return i.a0(n)?[]:[new i.V("projection",n,`object or string expected, ${i.K(n)} found`)]},import:function(h){const n=h.key,{value:l,styleSpec:f}=h;if(!i.H(l))return[new i.V(n,l,"import must be an object")];const{data:v,...w}=l;Object.defineProperty(w,"__line__",{value:l.__line__,enumerable:!1});let E=Zi(Object.assign({},h,{value:w,valueSpec:f.import}));return i.J(w.id)===""&&E.push(new i.V(`${h.key}.id`,w,"import id can't be an empty string")),v&&(E=E.concat(fs(v,f,{key:`${h.key}.data`}))),E},iconset:function(h){const n=h.value,l=h.key,f=h.styleSpec,v=h.style;if(!i.H(n))return[new i.V(l,n,"object expected")];if(!n.type)return[new i.V(l,n,'"type" is required')];const w=i.J(n.type);let E=[];if(E=E.concat(Zi({key:l,value:n,valueSpec:f[`iconset_${w}`],style:v,styleSpec:f})),(function(M,D){return!(M!=="source"||!D.source)})(w,n)){const M=v.sources&&v.sources[n.source],D=M&&i.J(M.type);M?D!=="raster-array"&&E.push(new i.V(l,n.source,`iconset cannot be used with a source of type ${String(D)}, it only be used with a "raster-array" source type`)):E.push(new i.V(l,n.source,`source "${n.source}" not found`))}return E}};function _i(h,n=!1){const l=h.value,f=h.valueSpec,v=h.styleSpec;if(f.expression){if(i.a4(i.J(l)))return Lo(h);if(i.Q(i.S(l)))return co(h)}if(f.type&&Is[f.type]){const w=Is[f.type](h);return n===!0&&w.length>0&&Array.isArray(h.value)?co(h):w}return Zi(Object.assign({},h,{valueSpec:f.type?v[f.type]:f}))}function Zi(h){const n=h.key,l=h.value,f=h.valueSpec||{},v=h.objectElementValidators||{},w=h.style,E=h.styleSpec;if(!i.H(l))return[new i.V(n,l,`object expected, ${i.K(l)} found`)];let M=[];for(const D in l){const B=D.split(".")[0];let j;v[B]?j=v[B]:f[B]?j=_i:v["*"]?j=v["*"]:f["*"]&&(j=_i),j?M=M.concat(j({key:(n&&`${n}.`)+D,value:l[D],valueSpec:f[B]||f["*"],style:w,styleSpec:E,object:l,objectKey:D},l)):M.push(new i.a3(n,l[D],`unknown property "${D}"`))}for(const D in f){if(v[D])continue;const B=f[D];B.required&&B.default===void 0&&l[D]===void 0&&M.push(new i.V(n,l,`missing required property "${D}"`))}return M}function ia({key:h,value:n}){const l=hs({key:h,value:n});if(l.length)return l;const f=n;return f.indexOf("{fontstack}")===-1&&l.push(new i.V(h,n,'"glyphs" url must include a "{fontstack}" token')),f.indexOf("{range}")===-1&&l.push(new i.V(h,n,'"glyphs" url must include a "{range}" token')),l}function fs(h,n=i.a6,l={}){return Zi({key:l.key||"",value:h,valueSpec:Object.assign(n.$root,{"*":{type:"*"}}),styleSpec:n,style:h,objectElementValidators:{glyphs:ia}})}function Ms(h,n=i.a6){return qe(fs(h,n))}const Dc=h=>qe(Al(h)),rc=h=>qe(js(h)),ru=h=>qe(ba(h)),ll=h=>qe(wa(h)),St=h=>qe(Ps(h)),Ns=h=>qe((function(n){const l=n.value,f=n.style,v=n.styleSpec,w=v.snow;if(l===void 0)return[];if(!i.H(l))return[new i.V("snow",l,`object expected, ${i.K(l)} found`)];let E=[];for(const M in l){const D=M.match(/^(.*)-transition$/);E=E.concat(D&&w[D[1]]&&w[D[1]].transition?_i({key:M,value:l[M],valueSpec:v.transition,style:f,styleSpec:v}):w[M]?_i({key:M,value:l[M],valueSpec:w[M],style:f,styleSpec:v}):[new i.a3(M,l[M],`unknown property "${M}"`)])}return E})(h)),Dl=h=>qe((function(n){const l=n.value,f=n.style,v=n.styleSpec,w=v.rain;if(l===void 0)return[];if(!i.H(l))return[new i.V("rain",l,`object expected, ${i.K(l)} found`)];let E=[];for(const M in l){const D=M.match(/^(.*)-transition$/);E=E.concat(D&&w[D[1]]&&w[D[1]].transition?_i({key:M,value:l[M],valueSpec:v.transition,style:f,styleSpec:v}):w[M]?_i({key:M,value:l[M],valueSpec:w[M],style:f,styleSpec:v}):[new i.a3(M,l[M],`unknown property "${M}"`)])}return E})(h)),Ka=h=>qe(na(h)),vn=h=>qe(ra(h)),So=h=>qe(Bs(h)),Sa=h=>qe(Qo(h)),cl=h=>qe(i.a7(h));function qe(h){return h.slice().sort(((n,l)=>n.line&&l.line?n.line-l.line:0))}function ie(h,n){let l=!1;if(n&&n.length)for(const f of n)f instanceof i.a3?i.w(f.message):(h.fire(new i.y(new Error(f.message))),l=!0);return l}const le=i.a6.light;let we;class Oe extends i.E{constructor(n,l="flat"){super(),this._transitionable=new i.a8(we||(we=new i.a9({anchor:new i.aa(le.anchor),position:new i.ab(le.position),color:new i.aa(le.color),intensity:new i.aa(le.intensity)}))),this.setLight(n,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,l,f={}){this._validate(rc,n,f)||(this._transitionable.setTransitionOrValue(n),this.id=l)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,f){return(!f||f.validate!==!1)&&ie(this,n.call(Ms,Object.assign({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}}const Le=i.a6.terrain;let Ue=class extends i.E{constructor(h,n,l,f,v){super(),this.scope=l,this._transitionable=new i.a8(new i.a9({source:new i.aa(Le.source),exaggeration:new i.aa(Le.exaggeration)}),l,f),this._transitionable.setTransitionOrValue(h,f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n,this.worldview=v}get(){return this._transitionable.serialize()}set(h,n){this._transitionable.setTransitionOrValue(h,n)}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}getExaggeration(h){return this._transitioning.possiblyEvaluate(new i.ac(h,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const h=this._transitionable._values.exaggeration;if(!h)return null;const n=h.value.expression;if(!n)return null;let l=-1,f=-1,v=1;for(const w of n.zoomStops)v=n.evaluate(new i.ac(w,{worldview:this.worldview})),v>.01?(l=w,f=-1):f=w;return v<.01&&l>0&&f>l?[l,f]:null}isZoomDependent(){const h=this._transitionable._values.exaggeration;return h!=null&&h.value!=null&&h.value.expression!=null&&h.value.expression instanceof i.ad}};const nt=45,We=65,Je=.05;function Ot(h,n,l,f){const v=i.ah(nt,We,l),[w,E]=Pt(h,f);let M=1-Math.min(1,Math.exp((n-w)/(E-w)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*v*h.alpha}function Pt(h,n){const l=.5/Math.tan(.5*n);return[h.range[0]+l,h.range[1]+l]}function gr(h,n,l,f,v){const w=i.af([],[n,l,f],v.mercatorFogMatrix);return Ot(h,i.ag(w),v.pitch,v._fov)}function jr(h,n,l,f,v,w,E){const M=[[l,f,0],[v,f,0],[v,w,0],[l,w,0]];let D=Number.MAX_VALUE,B=-Number.MAX_VALUE;for(const j of M){const q=i.af([],j,n),U=i.ag(q);D=Math.min(D,U),B=Math.max(B,U)}return[Ot(h,D,E.pitch,E._fov),Ot(h,B,E.pitch,E._fov)]}const yr=i.a6.fog;class Cr extends i.E{constructor(n,l,f,v){super();const w=new i.a9({range:new i.aa(yr.range),color:new i.aa(yr.color),"color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.aa(yr["high-color"]),"high-color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.aa(yr["space-color"]),"space-color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.aa(yr["horizon-blend"]),"star-intensity":new i.aa(yr["star-intensity"]),"vertical-range":new i.aa(yr["vertical-range"])});this._transitionable=new i.a8(w,f,new Map(v)),this.set(n,v),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new i.ai(w),this.scope=f}get state(){const n=this._transform,l=n.projection.name==="globe",f=i.aj(n.zoom),v=this.properties.get("range"),w=[.5,3];return{range:l?[i.ak(w[0],v[0],f),i.ak(w[1],v[1],f)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,l,f={}){if(this._validate(St,n,f))return;const v=Object.assign({},n);for(const w of Object.keys(yr))v[w]===void 0&&(v[w]=yr[w].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ah(nt,We,n))*l.a}getOpacityAtLatLng(n,l){return this._transform.projection.supportsFog?(function(f,v,w){const E=i.ae.fromLngLat(v),M=w.elevation?w.elevation.getAtPointOrZero(E):0;return gr(f,E.x,E.y,M,w)})(this.state,n,l):0}getOpacityForTile(n){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(n.toUnwrapped());return jr(this.state,l,0,0,i.al,i.al,this._transform)}getOpacityForBounds(n,l,f,v,w){return this._transform.projection.supportsFog?jr(this.state,n,l,f,v,w,this._transform):[1,1]}getFovAdjustedRange(n){return this._transform.projection.supportsFog?Pt(this.state,n):[0,1]}isVisibleOnFrustum(n){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const f of l){const v=n.points[f];let w;if(v[2]>=0)w=v;else{const E=n.points[f-4];w=i.am(E,v,E[2]/(E[2]-v[2]))}if(gr(this.state,w[0],w[1],0,this._transform)>=Je)return!0}return!1}updateConfig(n){this._transitionable.setTransitionOrValue(this._options,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,l,f){return(!f||f.validate!==!1)&&ie(this,n.call(Ms,Object.assign({value:l,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}}let Zr,on,Cn,Mi,Qi=class extends i.E{constructor(h,n,l,f){super();const v=Zr||(Zr=new i.a9({density:new i.aa(i.a6.snow.density),intensity:new i.aa(i.a6.snow.intensity),color:new i.aa(i.a6.snow.color),opacity:new i.aa(i.a6.snow.opacity),vignette:new i.aa(i.a6.snow.vignette),"vignette-color":new i.aa(i.a6.snow["vignette-color"]),"center-thinning":new i.aa(i.a6.snow["center-thinning"]),direction:new i.aa(i.a6.snow.direction),"flake-size":new i.aa(i.a6.snow["flake-size"])}));this._transitionable=new i.a8(v,l,new Map(f)),this.set(h,f),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ai(v),this.scope=l}get state(){const h=this.properties.get("opacity"),n=this.properties.get("color"),l=this.properties.get("direction"),f=i.an(l[0]),v=-Math.max(i.an(l[1]),.01),w=[Math.cos(f)*Math.cos(v),Math.sin(f)*Math.cos(v),Math.sin(v)],E=this.properties.get("vignette"),M=this.properties.get("vignette-color");return M.a=E,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ao(n.r,n.g,n.b,n.a*h),direction:w,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:M}}get(){return this._transitionable.serialize()}set(h,n,l={}){if(this._validate(Ns,h,l))return;const f=Object.assign({},h),v=i.a6.snow;for(const w of Object.keys(v))f[w]===void 0&&(f[w]=v[w].default);this._options=f,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(h){this._transitionable.setTransitionOrValue(this._options,new Map(h))}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,n,l){return(!l||l.validate!==!1)&&ie(this,h.call(Ms,Object.assign({value:n,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}},Ti=class extends i.E{constructor(h,n,l,f){super();const v=on||(on=new i.a9({density:new i.aa(i.a6.rain.density),intensity:new i.aa(i.a6.rain.intensity),color:new i.aa(i.a6.rain.color),opacity:new i.aa(i.a6.rain.opacity),vignette:new i.aa(i.a6.rain.vignette),"vignette-color":new i.aa(i.a6.rain["vignette-color"]),"center-thinning":new i.aa(i.a6.rain["center-thinning"]),direction:new i.aa(i.a6.rain.direction),"droplet-size":new i.aa(i.a6.rain["droplet-size"]),"distortion-strength":new i.aa(i.a6.rain["distortion-strength"])}));this._transitionable=new i.a8(v,l,new Map(f)),this.set(h,f),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ai(v),this.scope=l}get state(){const h=this.properties.get("opacity"),n=this.properties.get("color"),l=this.properties.get("direction"),f=i.an(l[0]),v=-Math.max(i.an(l[1]),.01),w=[Math.cos(f)*Math.cos(v),Math.sin(f)*Math.cos(v),Math.sin(v)],E=this.properties.get("vignette-color");return E.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ao(n.r,n.g,n.b,n.a*h),direction:w,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(h,n,l={}){if(this._validate(Dl,h,l))return;const f=Object.assign({},h),v=i.a6.rain;for(const w of Object.keys(v))f[w]===void 0&&(f[w]=v[w].default);this._options=f,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(h){this._transitionable.setTransitionOrValue(this._options,new Map(h))}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,n,l){return(!l||l.validate!==!1)&&ie(this,h.call(Ms,Object.assign({value:n,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}};class si extends i.E{constructor(n,l,f,v){super(),this.scope=f,this._options=n,this.properties=new i.ai(l),this._transitionable=new i.a8(l,f,new Map(v)),this._transitionable.setTransitionOrValue(n.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(n){this._transitionable.setTransitionOrValue(this._options.properties,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(n,l){this._options=n,this._transitionable.setTransitionOrValue(n.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Ln{constructor(n,l,f){this.screenBounds=n,this.cameraPoint=f.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=l,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,f)}static createFromScreenPoints(n,l){let f,v;if(n instanceof i.P||typeof n[0]=="number"){const w=i.P.convert(n);f=[w],v=l.isPointAboveHorizon(w)}else{const w=i.P.convert(n[0]),E=i.P.convert(n[1]),M=w.add(E)._div(2);f=[w,E],v=i.aq(w,E).every((D=>l.isPointAboveHorizon(D)))&&l.isPointAboveHorizon(M)}return new Ln(f,v,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return i.aq(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const l=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],v=i.aq(l,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<f.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?v[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(v[3]=this.cameraPoint)),i.ar(v,n)}bufferedCameraGeometryGlobe(n){const l=this.screenBounds[0],f=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],v=i.aq(l,f,n),w=this.cameraPoint.clone();switch(3*((w.y>l.y)+(w.y>f.y))+((w.x>l.x)+(w.x>f.x))){case 0:v[0]=w,v[4]=w.clone();break;case 1:v.splice(1,0,w);break;case 2:v[1]=w;break;case 3:v.splice(4,0,w);break;case 5:v.splice(2,0,w);break;case 6:v[3]=w;break;case 7:v.splice(3,0,w);break;case 8:v[2]=w}return v}containsTile(n,l,f,v=0){const w=Math.max(n.queryPadding,n.evaluateQueryRenderedFeaturePadding())/l._pixelsPerMercatorPixel+1,E=f?this._bufferedCameraMercator(w,l):this._bufferedScreenMercator(w,l);let M=n.tileID.wrap+(E.unwrapped?v:0);const D=E.polygon.map((ce=>i.as(n.tileTransform,ce,M)));if(!i.at(D,0,0,i.al,i.al))return;M=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const B=this.screenGeometryMercator.polygon.map((ce=>i.au(n.tileTransform,ce,M))),j=B.map((ce=>new i.P(ce[0],ce[1]))),q=l.getFreeCameraOptions().position||new i.ae(0,0,0),U=i.au(n.tileTransform,q,M),Y=B.map((ce=>{const ae=i.av(ce,ce,U);return i.aw(ae,ae),new i.ax(U,ae)})),ee=i.ay(n,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:j,tilespaceRays:Y,bufferedTilespaceGeometry:D,bufferedTilespaceBounds:(re=i.az(D),re.min.x=i.aA(re.min.x,0,i.al),re.min.y=i.aA(re.min.y,0,i.al),re.max.x=i.aA(re.max.x,0,i.al),re.max.y=i.aA(re.max.y,0,i.al),re),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:ee};var re}_bufferedScreenMercator(n,l){const f=Ei(n);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{let v;return v=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),l):{polygon:this.bufferedScreenGeometry(n).map((w=>l.pointCoordinate3D(w))),unwrapped:!0},this._screenRaycastCache[f]=v,v}}_bufferedCameraMercator(n,l){const f=Ei(n);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{let v;return v=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),l):{polygon:this.bufferedCameraGeometry(n).map((w=>l.pointCoordinate3D(w))),unwrapped:!0},this._cameraRaycastCache[f]=v,v}}_projectAndResample(n,l){const f=(function(w,E){const M=i.aB([],E.pixelMatrix,E.globeMatrix),D=[0,-i.aD,0,1],B=[0,i.aD,0,1],j=[0,0,0,1];i.aC(D,D,M),i.aC(B,B,M),i.aC(j,j,M);const q=new i.P(D[0]/D[3],D[1]/D[3]),U=new i.P(B[0]/B[3],B[1]/B[3]),Y=i.aE(w,q)&&D[3]<j[3],ee=i.aE(w,U)&&B[3]<j[3];if(!Y&&!ee)return null;const re=(function(Ce,Te,be){for(let De=1;De<Ce.length;De++){const He=fi(Te.pointCoordinate3D(Ce[De-1]).x),$e=fi(Te.pointCoordinate3D(Ce[De]).x);if(be<0){if(He<$e)return{idx:De,t:-He/($e-1-He)}}else if($e<He)return{idx:De,t:(1-He)/($e+1-He)}}return null})(w,E,Y?-1:1);if(!re)return null;const{idx:ce,t:ae}=re;let de=ce>1?rn(w.slice(0,ce),E):[],ye=ce<w.length?rn(w.slice(ce),E):[];de=de.map((Ce=>new i.P(fi(Ce.x),Ce.y))),ye=ye.map((Ce=>new i.P(fi(Ce.x),Ce.y)));const fe=[...de];fe.length===0&&fe.push(ye[ye.length-1]);const Me=i.ak(fe[fe.length-1].y,(ye.length===0?de[0]:ye[0]).y,ae);let xe;return xe=Y?[new i.P(0,Me),new i.P(0,0),new i.P(1,0),new i.P(1,Me)]:[new i.P(1,Me),new i.P(1,1),new i.P(0,1),new i.P(0,Me)],fe.push(...xe),ye.length===0?fe.push(de[0]):fe.push(...ye),{polygon:fe.map((Ce=>new i.ae(Ce.x,Ce.y))),unwrapped:!1}})(n,l);if(f)return f;const v=(function(w,E){let M=!1,D=-1/0,B=0;for(let q=0;q<w.length-1;q++)w[q].x>D&&(D=w[q].x,B=q);for(let q=0;q<w.length-1;q++){const U=(B+q)%(w.length-1),Y=w[U],ee=w[U+1];Math.abs(Y.x-ee.x)>.5&&(Y.x<ee.x?(Y.x+=1,U===0&&(w[w.length-1].x+=1)):(ee.x+=1,U+1===w.length-1&&(w[0].x+=1)),M=!0)}const j=i.aF(E.center.lng);return M&&j<Math.abs(j-1)&&w.forEach((q=>{q.x-=1})),{polygon:w,unwrapped:M}})(rn(n,l).map((w=>new i.P(fi(w.x),w.y))),l);return{polygon:v.polygon.map((w=>new i.ae(w.x,w.y))),unwrapped:v.unwrapped}}}function rn(h,n){return i.aG(h,(l=>{const f=n.pointCoordinate3D(l);l.x=f.x,l.y=f.y}),1/256)}function fi(h){return h<0?1+h%1:h%1}function Ei(h){return 100*h|0}function $n(h,n,l,f,v){const w=function(M,D){if(M)return v(M);if(D){if(h.url&&D.tiles&&h.tiles&&delete h.tiles,D.variants){if(!Array.isArray(D.variants))return v(new Error("variants must be an array"));for(const j of D.variants){if(j==null||typeof j!="object"||j.constructor!==Object)return v(new Error("variant must be an object"));if(!Array.isArray(j.capabilities))return v(new Error("capabilities must be an array"));if(j.capabilities.length===1&&j.capabilities[0]==="meshopt"){D=Object.assign(D,j);break}}}const B=i.aH(Object.assign({},D,h),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);B.tiles=n.canonicalizeTileset(B,h.url),v(null,B)}},E=(function(M,D,B){if(!M)return null;if(!D&&!B)return M;B=B||M.worldview_default;const j=Object.values(M.language||{});if(j.length===0)return null;const q=Object.values(M.worldview||{});if(q.length===0)return null;const U=j.every((ee=>ee===D)),Y=q.every((ee=>ee===B));return U&&Y?M:D in(M.language_options||{})||B in(M.worldview_options||{})?null:M.language_options&&M.worldview_options?M:null})(h.data,l,f);return E?i.o.frame((()=>w(null,E))):h.url?i.m(n.transformRequest(n.normalizeSourceURL(h.url,null,l,f),i.R.Source),w):i.o.frame((()=>{const{data:M,...D}=h;w(null,D)}))}function ii(h,n){const l=Math.pow(2,n.z),f=Math.floor(i.aF(h.getWest())*l),v=Math.floor(i.aJ(h.getNorth())*l),w=Math.ceil(i.aF(h.getEast())*l),E=Math.ceil(i.aJ(h.getSouth())*l);return n.x>=f&&n.x<w&&n.y>=v&&n.y<E}class Ji{constructor(n,l,f){this.bounds=n?i.aI.convert(this.validateBounds(n)):null,this.minzoom=l||0,this.maxzoom=f||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}addExtraBounds(n){if(n){this.extraBounds||(this.extraBounds=[]);for(const l of n)this.extraBounds.push(i.aI.convert(this.validateBounds(l)))}}contains(n){if(n.z>this.maxzoom||n.z<this.minzoom||this.bounds&&!ii(this.bounds,n))return!1;if(!this.extraBounds)return!0;for(const l of this.extraBounds)if(ii(l,n))return!0;return!1}static fromTileJSON(n){if(!n.bounds&&!n.extra_bounds)return null;const l=new Ji(n.bounds,n.minzoom,n.maxzoom);return l.addExtraBounds(n.extra_bounds),l}}class To extends i.E{constructor(n,l,f,v){if(super(),this.id=n,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Object.assign(this,i.aH(l,["url","scheme","tileSize","promoteId"])),this._options=Object.assign({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new i.aK}load(n){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map.getWorldview();this._tileJSONRequest=$n(this._options,this.map._requestManager,l,f,((v,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,v)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),f&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new i.y(v));else if(w){if(Object.assign(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const E of w.vector_layers)this.vectorLayerIds.push(E.id),w.worldview&&w.worldview[E.source]&&this.localizableLayerIds.add(E.id)}this.tileBounds=Ji.fromTileJSON(w),ct(w.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}n&&n(v)}))}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=i.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(n)))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}loadTile(n,l){const f=n.tileID.canonical.url(this.tiles,this.scheme),v=this.map._requestManager.normalizeTileURL(f),w=this.map._requestManager.transformRequest(v,i.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,M=E?{image:E.image.clone()}:null,D={request:w,data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,lut:M,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:n.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault,indoor:this.map.indoor?this.map.indoor.getIndoorTileOptions(this.id,this.scope):null};if(this.hasWorldviews&&i.h(f)&&(D.localizableLayerIds=this.localizableLayerIds),D.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=l:n.request=n.actor.send("reloadTile",D,B.bind(this));else if(n.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",D,B.bind(this),void 0,!0);else{const j=i.aL.call({deduped:this._deduped},D,((q,U)=>{if(q||!U)B.call(this,q);else{const Y=i.aM(U.responseHeaders);D.data={cacheControl:Y.cacheControl,expires:Y.expires,rawData:U.rawData.slice(0)},n.actor&&n.actor.send("loadTile",D,B.bind(this),void 0,!0)}}),!0);n.request={cancel:j}}function B(j,q){return delete n.request,n.aborted?l(null):j&&j.status!==404?l(j):(q&&q.resourceTiming&&(n.resourceTiming=q.resourceTiming),this.map._refreshExpiredTiles&&q&&n.setExpiryData(q),n.loadVectorData(q,this.map.painter),i.aN(this.dispatcher),l(null,q),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,l){n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ps extends i.E{constructor(n,l,f,v){super(),this.id=n,this.dispatcher=f,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Object.assign({type:"raster"},l),Object.assign(this,i.aH(l,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const l=this.map.getWorldview();this._tileJSONRequest=$n(this._options,this.map._requestManager,null,l,((f,v)=>{this._tileJSONRequest=null,this._loaded=!0,f?this.fire(new i.y(f)):v&&(Object.assign(this,v),v.raster_layers&&(this.rasterLayers=v.raster_layers,this.rasterLayerIds=this.rasterLayers.map((w=>w.id))),this.tileBounds=Ji.fromTileJSON(v),ct(v.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),n&&n(f)}))}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=i.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(n)))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,l){const f=i.o.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);n.request=i.n(this.map._requestManager.transformRequest(v,i.R.Tile),((w,E,M)=>{if(delete n.request,n.aborted)return n.state="unloaded",l(null);if(w)return n.state="errored",l(w);if(!E)return l(null);const D=i.aM(M);this.map._refreshExpiredTiles&&n.setExpiryData(D),n.setTexture(E,this.map.painter),n.state="loaded",i.aN(this.dispatcher),l(null)}))}abortTile(n,l){n.request&&(n.request.cancel(),delete n.request),l&&l()}unloadTile(n,l){n.texture&&n.texture instanceof i.T?(n.destroy(!0),n.texture&&n.texture instanceof i.T&&this.map.painter.saveTileTexture(n.texture)):n.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Oa([h,n],l,f,{scaled:v=!0}={}){const{tileSize:w,buffer:E}=f,{x:M,y:D,z:B}=l;if(!isFinite(M)||!isFinite(D)||!isFinite(B))throw new Error("Invalid MRT header");const j=2**B,q=j*i.aF(h),U=j*i.aJ(n);return(function([Y,ee],re,{scaled:ce=!0}={}){if(!re)throw new Error("bandView is undefined");const{data:ae,tileSize:de,buffer:ye,offset:fe,scale:Me,dimension:xe}=re;if(Y<-ye||Y>de+ye||ee<-ye||ee>de+ye)throw new Error(`Point (${Y}, ${ee}) out of bounds for tileSize=${de}, buffer=${ye}`);const Ce=(ee+ye)*(de+2*ye)+(Y+ye);if(new Uint32Array(ae.buffer)[Ce]===4294967295)return null;let Te=[];Te=ce?[]:new re.data.constructor(xe);for(let be=0;be<xe;be++)Te[be]=Math.round(1e12*(ae[xe*Ce+be]*Me+fe))/1e12;return Te})([Math.min(Math.max(-E,Math.floor((q-M)*w)),w-1+E),Math.min(Math.max(-E,Math.floor((U-D)*w)),w-1+E)],f,{scaled:v})}class uo extends ps{constructor(n,l,f,v){super(n,l,f,v),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._loadTilePending={},this._loadTileLoaded={},this._options=Object.assign({type:"raster-array"},l)}triggerRepaint(n){const l=this.map.painter._terrain,f=this.map.style.getSourceCache(this.id);l&&l.enabled&&f&&l._clearRenderCacheForTile(f.id,n.tileID),this.map.triggerRepaint()}loadTile(n,l){const f=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),v=this.map._requestManager.transformRequest(f,i.R.Tile),w={request:v,uid:n.uid,tileID:n.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};n.source=this.id,n.scope=this.scope,n.requestParams=v,n.actor||(n.actor=this.dispatcher.getActor());const E=(M,D,B)=>{if(delete n.request,n.aborted)return n.state="unloaded",l(null);if(M)return M.name==="AbortError"?void 0:(n.state="errored",l(M));if(this.map._refreshExpiredTiles&&D){const j=i.aM(B);n.setExpiryData(j)}if(this.partial&&n.state!=="expired")n.state="empty";else if(!this.partial){if(!D)return l(null);n.state="loaded",n._isHeaderLoaded=!0,n._mrt=D}l(null)};n.request=this.partial?n.fetchHeader(void 0,E.bind(this)):n.actor.send("loadTile",w,E.bind(this),void 0,!0)}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,l){const f=n.texturePerLayer;if(n.flushAllQueues(),f.size){n.destroy(!0);for(const v of f.values())this.map.painter.saveTileTexture(v)}else n.destroy()}prepareTile(n,l,f,v){n._isHeaderLoaded&&(n.state!=="empty"&&(n.state="reloading"),n.fetchBandForRender(l,f,v,((w,E)=>{if(w)return n.state="errored",this.fire(new i.y(w)),void this.triggerRepaint(n);E&&(n._isHeaderLoaded=!0,n.setTexturePerLayer(f,E,this.map.painter),n.state="loaded",this.triggerRepaint(n))})))}getInitialBand(n){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find((({id:w})=>w===n)),f=l&&l.fields,v=f&&f.bands&&f.bands;return v?v[0]:0}getTextureDescriptor(n,l,f){if(!n)return;const v=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!v)return;let w=null;l instanceof i.aQ?w=l.paint.get("raster-array-band"):l instanceof i.aR&&(w=l.paint.get("raster-particle-array-band"));const E=w||this.getInitialBand(v);if(E==null)return;if(!n.textureDescriptorPerLayer.get(l.id))return void this.prepareTile(n,v,l.id,E);if(n.updateNeeded(l.id,E)&&!f)return;const M=n.textureDescriptorPerLayer.get(l.id);return Object.assign({},M,{texture:n.texturePerLayer.get(l.id)})}getImages(n,l){const f=new Map;for(const v of n)for(const w of l){const[E,M]=w.split("/"),D=v.getLayer(E);if(!D||!D.hasBand(M)||!D.hasDataForBand(M))continue;const{bytes:B,tileSize:j,buffer:q}=D.getBandView(M),U=j+2*q,Y={data:new i.q({width:U,height:U},B),pixelRatio:2,sdf:!1,usvg:!1,version:0};f.set(w,Y)}return f}queryRasterArrayValueByBandId(n,l,f){const v=l._mrt;return new Promise((w=>{const E={},M=new Set;for(const[D,B]of Object.entries(v.layers)){if(f.layerName&&D!==f.layerName)continue;const j={};E[D]=j;for(const{bands:q}of B.dataIndex)for(const U of q)f.bands&&!f.bands.includes(U)||(M.add(i.B(D,U)),l.fetchBand(D,null,U,(Y=>{i.o.frame((()=>{j[U]=Y?null:Oa([n.lng,n.lat],v,B.getBandView(U)),M.delete(i.B(D,U)),M.size===0&&w(E)}))}),!1))}M.size===0&&w(E)}))}_loadTileForQuery(n,l){if(this._loadTileLoaded[n.uid])return void l(null,n._mrt);if(this._loadTilePending[n.uid])return void this._loadTilePending[n.uid].push(l);this._loadTilePending[n.uid]=[l];const f=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),v=this.map._requestManager.transformRequest(f,i.R.Tile);n.actor.send("loadTile",{request:v,uid:n.uid,tileID:n.tileID,type:this.type,source:this.id,scope:this.scope,partial:!1},((w,E,M)=>{if(w)return this._loadTilePending[n.uid].forEach((D=>D(w,null))),void delete this._loadTilePending[n.uid];if(!E)return this._loadTilePending[n.uid].forEach((D=>D(null,null))),void delete this._loadTilePending[n.uid];if(this.map._refreshExpiredTiles&&E){const D=i.aM(M);n.setExpiryData(D)}n._mrt=E,n._isHeaderLoaded=!0,n.state="loaded",this._loadTilePending[n.uid].forEach((D=>D(null,E))),this._loadTileLoaded[n.uid]=!0,delete this._loadTilePending[n.uid]}),void 0,!0)}queryRasterArrayValueByAllBands(n,l,f){return new Promise(((v,w)=>{this._loadTileForQuery(l,((E,M)=>{E?w(E):v(M?this.queryRasterArrayValueByBandId(n,l,f):null)}))}))}queryRasterArrayValue(n,l){const f=i.aS.convert(n),v=this.findLoadedParent(f);return v&&v._mrt?l.bands||!this.partial?this.queryRasterArrayValueByBandId(f,v,l):this.queryRasterArrayValueByAllBands(f,v,l):Promise.resolve(null)}findLoadedParent(n){const l=i.ae.fromLngLat(n,this.map.transform.tileSize),f=this.maxzoom+1,v=1<<f,w=Math.floor(l.x),E=Math.floor((l.x-w)*v),M=Math.floor(l.y*v),D=this.map.style.getSourceCache(this.id),B=new i.aP(f,w,f,E,M);return D.findLoadedParent(B,this.minzoom)}}const Cs={vector:To,raster:ps,"raster-dem":class extends ps{constructor(h,n,l,f){super(h,n,l,f),this.type="raster-dem",this.maxzoom=22,this._options=Object.assign({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(h,n){const l=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(v,w){v&&(h.state="errored",n(v)),w&&(h.dem=w,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",n(null))}h.request=i.n(this.map._requestManager.transformRequest(l,i.R.Tile),(function(v,w,E){if(delete h.request,h.aborted)h.state="unloaded",n(null);else if(v)h.state="errored",n(v);else if(w){const M=i.aM(E);this.map._refreshExpiredTiles&&h.setExpiryData(M);const D=ImageBitmap&&w instanceof ImageBitmap&&i.r(),B=1-(w.width-i.aO(w.width))/2;B<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const j=D?w:i.o.getImageData(w,B),q={uid:h.uid,tileID:h.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:j,encoding:this.encoding,padding:B};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadTile",q,f.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(h){const n=h.canonical,l=Math.pow(2,n.z),f=(n.x-1+l)%l,v=n.x===0?h.wrap-1:h.wrap,w=(n.x+1+l)%l,E=n.x+1===l?h.wrap+1:h.wrap,M={};return M[new i.aP(h.overscaledZ,v,n.z,f,n.y).key]={backfilled:!1},M[new i.aP(h.overscaledZ,E,n.z,w,n.y).key]={backfilled:!1},n.y>0&&(M[new i.aP(h.overscaledZ,v,n.z,f,n.y-1).key]={backfilled:!1},M[new i.aP(h.overscaledZ,h.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},M[new i.aP(h.overscaledZ,E,n.z,w,n.y-1).key]={backfilled:!1}),n.y+1<l&&(M[new i.aP(h.overscaledZ,v,n.z,f,n.y+1).key]={backfilled:!1},M[new i.aP(h.overscaledZ,h.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},M[new i.aP(h.overscaledZ,E,n.z,w,n.y+1).key]={backfilled:!1}),M}},"raster-array":uo,geojson:class extends i.E{constructor(h,n,l,f){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(f),this._data=n.data,this._options=Object.assign({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.minzoom!==void 0&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const v=i.al/this.tileSize;this.workerOptions=Object.assign({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*v,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*v,extent:i.al,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:i.al,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*v,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}updateData(h){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof h!="string"&&(h.type==="Feature"&&(h={type:"FeatureCollection",features:[h]}),h.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof h!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const n=new Map;for(const l of this._data.features)n.set(l.id,l);for(const l of h.features)n.set(l.id,l);this._data.features=[...n.values()]}else this._data=h;return this._updateWorkerData(!0),this}getClusterExpansionZoom(h,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id,scope:this.scope},n),this}getClusterChildren(h,n){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id,scope:this.scope},n),this}getClusterLeaves(h,n,l,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:h,limit:n,offset:l},f),this}_updateWorkerData(h=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const n=Object.assign({append:h},this.workerOptions);n.scope=this.scope;const l=this._data;typeof l=="string"?(n.request=this.map._requestManager.transformRequest(i.o.resolveURL(l),i.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,((f,v)=>{if(this._loaded=!0,this._pendingLoad=null,f)this.fire(new i.y(f));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(w.resourceTiming=v.resourceTiming[this.id]),h&&(this._partialReload=!0),this.fire(new i.z("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(h),this._coalesce=!1)}))}loaded(){return this._loaded}reload(){const h=i.B(this.id,this.scope);this.map.style.clearSource(h),this._updateWorkerData()}loadTile(h,n){const l=h.actor?"reloadTile":"loadTile";h.actor=this.actor;const f=this.map.style?this.map.style.getLut(this.scope):null,v=f?{image:f.image.clone()}:null,w=this._partialReload,E={type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:v,scope:this.scope,pixelRatio:i.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:h.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:w,worldview:this.map.getWorldview(),indoor:this.map.indoor?this.map.indoor.getIndoorTileOptions(this.id,this.scope):null};h.request=this.actor.send(l,E,((M,D)=>w&&!D?(h.state="loaded",n(null)):(delete h.request,h.destroy(),h.aborted?n(null):M?n(M):(h.loadVectorData(D,this.map.painter,l==="reloadTile"),n(null)))),void 0,l==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h,n){this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id,scope:this.scope}),h.destroy()}onRemove(h){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Object.assign({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aT{constructor(h,n,l,f){super(h,n,l,f),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const n of h.urls)this.urls.push(this.map._requestManager.transformRequest(n,i.R.Source).url);i.aU(this.urls,((n,l)=>{this._loaded=!0,n?this.fire(new i.y(n)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const n=this.video.seekable;h<n.start(0)||h>n.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,n=h.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(h,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aT,model:i.aW,"batched-model":class extends i.E{constructor(h,n,l,f){super(),this.type="batched-model",this.id=h,this.tileSize=512,this._options=n,this.tiles=this._options.tiles,this.maxzoom=n.maxzoom||19,this.minzoom=n.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(f)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest();const h=i.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(h)))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(h){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=$n(this._options,this.map._requestManager,n,l,((f,v)=>{this._tileJSONRequest=null,this._loaded=!0,f?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new i.y(f))):v&&(Object.assign(this,v),v.bounds&&(this.tileBounds=new Ji(v.bounds,this.minzoom,this.maxzoom)),ct(v.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),h&&h(f)}))}hasTransition(){return!1}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loaded(){return this._loaded}loadTile(h,n){const l=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(l,i.R.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:h.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.o.devicePixelRatio,promoteId:this.promoteId};if(h.actor&&h.state!=="expired")if(h.state==="loading")h.reloadCallback=n;else{if(h.buckets){const w=Object.values(h.buckets);for(const E of w)E.dirty=!0;return void(h.state="loaded")}h.request=h.actor.send("reloadTile",f,v.bind(this))}else h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",f,v.bind(this),void 0,!0);function v(w,E){return h.aborted?n(null):w&&w.status!==404?n(w):(this.map._refreshExpiredTiles&&E&&h.setExpiryData(E),h.loadModelData(E,this.map.painter),h.state="loaded",void n(null))}}serialize(){return Object.assign({},this._options)}},canvas:class extends i.aT{constructor(h,n,l,f){super(h,n,l,f),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some((v=>!Array.isArray(v)||v.length!==2||v.some((w=>typeof w!="number"))))||this.fire(new i.y(new i.V(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${h}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${h}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(h){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?!h&&!this._playing||this.texture instanceof i.aV||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends i.E{constructor(h,n,l,f){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=n,this.setEventedParent(f),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ji(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),Object.assign(this,i.aH(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aH(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this.map=h,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:n,y:l,z:f}=h.canonical;return this._implementation.hasTile({x:n,y:l,z:f})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,n){const{x:l,y:f,z:v}=h.tileID.canonical,w=new AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:l,y:f,z:v},{signal:w.signal})).then((function(E){return delete h.request,h.aborted?(h.state="unloaded",n(null)):E===void 0?(h.state="errored",n(null)):E===null?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",n(null)):(function(M){return M instanceof ImageData||M instanceof HTMLCanvasElement||M instanceof ImageBitmap||M instanceof HTMLImageElement})(E)?(this.loadTileData(h,E),h.state="loaded",void n(null)):(h.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((E=>{E.name!=="AbortError"&&(h.state="errored",n(E))})),h.request.cancel=()=>w.abort()}loadTileData(h,n){h.setTexture(n,this.map.painter)}unloadTile(h,n){if(h.texture&&h.texture instanceof i.T?(h.destroy(!0),h.texture&&h.texture instanceof i.T&&this.map.painter.saveTileTexture(h.texture)):h.destroy(),this._implementation.unloadTile){const{x:l,y:f,z:v}=h.tileID.canonical;this._implementation.unloadTile({x:l,y:f,z:v})}n&&n()}abortTile(h,n){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),n&&n()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z})))}_clearTiles(){const h=i.B(this.id,this.scope);this.map.style.clearSource(h)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},Jo=function(h,n,l,f){const v=new Cs[n.type](h,n,l,f);if(v.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${v.id}`);return i.aX(["load","abort","unload","serialize","prepare"],v),v};function As(h,n,l=""){return`${l}:${n.id||""}:${n.layer.id}:${(function(f){if("layerId"in f)return`layer:${f.layerId}`;{const{featuresetId:v,importId:w}=f;return`featureset:${v}${w?`:import:${w}`:""}`}})(h.target)}`}function Ho(h,n,l,f=""){if(h.uniqueFeatureID){const v=As(h,n,f);if(l.has(v))return!0;l.add(v)}return!1}function Ds(h,n,l,f,v=!1){const w=n.sourceCache.transform,E=n.sourceCache.tilesIn(h,n.has3DLayers,v);E.sort(ic);const M=[];for(const D of E){const B=D.tile.queryRenderedFeatures(n,D,l,f,w,v);Object.keys(B).length&&M.push({wrappedTileID:D.tile.tileID.wrapped().key,queryResults:B})}for(const D in n.layers){const B=n.layers[D];if(B.styleLayer){const j=B.styleLayer.queryRenderedFeatures(h,n.sourceCache,f);Object.keys(j).length&&M.push({wrappedTileID:0,queryResults:j})}}return M.length===0?{}:(function(D){const B={},j={};for(const q of D){const U=q.queryResults,Y=q.wrappedTileID,ee=j[Y]=j[Y]||{};for(const re in U){const ce=U[re],ae=ee[re]=ee[re]||{},de=B[re]=B[re]||[];for(const ye of ce)ae[ye.featureIndex]||(ae[ye.featureIndex]=!0,de.push(ye))}}return B})(M)}function nc(h,n,l,f,v,w){const E={},M=f.queryRenderedSymbols(h),D=[];for(const B of Object.keys(M).map(Number))D.push(v[B]);D.sort(ic);for(const B of D){const j=B.featureIndex.lookupSymbolFeatures(M[B.bucketInstanceId],B.bucketIndex,B.sourceLayerIndex,n,l,w);for(const q in j){const U=E[q]=E[q]||[],Y=j[q];Y.sort(((ee,re)=>{const ce=B.featureSortOrder;if(ce){const ae=ce.indexOf(ee.featureIndex);return ce.indexOf(re.featureIndex)-ae}return re.featureIndex-ee.featureIndex}));for(const ee of Y)U.push(ee)}}return E}function yi(h,n){const l=h.getRenderableIds().map((w=>h.getTileByID(w))),f=[],v={};for(let w=0;w<l.length;w++){const E=l[w],M=E.tileID.canonical.key;v[M]||(v[M]=!0,E.querySourceFeatures(f,n))}return f}function ic(h,n){const l=h.tileID,f=n.tileID;return l.overscaledZ-f.overscaledZ||l.canonical.y-f.canonical.y||l.wrap-f.wrap||l.canonical.x-f.canonical.x}function oc(h,n){const l={};if(!n)return l;for(const f of h){const v=f.layerIds.map((w=>n.getLayer(w))).filter(Boolean);if(v.length!==0){f.layers=v,f.stateDependentLayerIds&&(f.stateDependentLayers=f.stateDependentLayerIds.map((w=>v.filter((E=>E.id===w))[0])));for(const w of v)l[w.fqid]=f}}return l}const es=32,Rs=33,ts=new Uint16Array(8184);for(let h=0;h<2046;h++){let n=h+2,l=0,f=0,v=0,w=0,E=0,M=0;for(1&n?v=w=E=es:l=f=M=es;(n>>=1)>1;){const B=l+v>>1,j=f+w>>1;1&n?(v=l,w=f,l=E,f=M):(l=v,f=w,v=E,w=M),E=B,M=j}const D=4*h;ts[D+0]=l,ts[D+1]=f,ts[D+2]=v,ts[D+3]=w}const Os=new Uint16Array(2178),Ta=new Uint8Array(1089),Vs=new Uint16Array(1089);function Us(h){return h===0?-.03125:h===32?.03125:0}const $s={type:2,extent:i.al,loadGeometry:()=>[[new i.P(0,0),new i.P(i.al+1,0),new i.P(i.al+1,i.al+1),new i.P(0,i.al+1),new i.P(0,0)]]};class jo{constructor(n,l,f,v,w,E){this.tileID=n,this.uid=i.b1(),this.uses=0,this.tileSize=l,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,v&&v.style&&(this._lastUpdatedBrightness=v.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",v&&v.transform&&(this.projection=v.transform.projection),this.worldview=E,this._hasAppearances=null}registerFadeDuration(n){const l=n+this.timeAdded;l<i.o.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aY(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,l,f){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=oc(n.buckets,l.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const w=this.buckets[v];if(w instanceof i.b3){if(this.hasSymbolBuckets=!0,!f)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const w=this.buckets[v];if(w instanceof i.b3&&w.hasRTLText){this.hasRTLText=!0,i.b4();break}}this.queryPadding=0;for(const v in this.buckets){const w=this.buckets[v],E=l.style.getOwnLayer(v);if(!E)continue;const M=E.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,M)}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas),this._lastUpdatedBrightness=n.brightness}else this.collisionBoxArray=new i.b2}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(n,l,f){n&&(n.resourceTiming&&(this.resourceTiming=n.resourceTiming),this.buckets=Object.assign({},this.buckets,oc(n.buckets,l.style)),n.featureIndex&&(this.latestFeatureIndex=n.featureIndex))}getBucket(n){return this.buckets[n.fqid]}upload(n,l){for(const w in this.buckets){const E=this.buckets[w];if(E.uploadPending()){let M={},D=[],B={zoom:0,pitch:0,brightness:0,worldview:""};if(l){if(l.style){D=l.style.listImages();const j=E.layers[0],q=j.sourceLayer||"_geojsonTileLayer",U=l.style.getLayerSourceCache(j);U&&(M=U._state.getState(q,void 0))}B={zoom:l.transform.zoom||0,pitch:l.transform.pitch||0,brightness:l.style.getBrightness()||0,worldview:l.worldview||""}}E.upload(n,this.tileID.canonical,M,D,B)}}const f=n.gl,v=this.imageAtlas;v&&!v.uploaded&&(this.imageAtlasTexture=new i.T(n,v.image,f.RGBA8,{useMipmap:!!v.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(n,this.glyphAtlasImage,f.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(n,this.lineAtlas.image,f.R8),this.lineAtlas.uploaded=!0)}prepare(n,l,f){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture,f),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const v=l.style.getBrightness();this._hasAppearances===null&&(this._hasAppearances=this.hasAppearances(l)),(this._lastUpdatedBrightness||v||this._hasAppearances)&&(!this._hasAppearances&&this._lastUpdatedBrightness&&v&&Math.abs(this._lastUpdatedBrightness-v)<.001||(this.updateBuckets(l,this._lastUpdatedBrightness!==v),this._lastUpdatedBrightness=v))}evaluateQueryRenderedFeaturePadding(){let n=0;for(const l in this.buckets){const f=this.buckets[l];f.evaluateQueryRenderedFeaturePadding&&(n=Math.max(n,f.evaluateQueryRenderedFeaturePadding()))}return n}queryRenderedFeatures(n,l,f,v,w,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const M=this.evaluateQueryRenderedFeaturePadding(),D=(function(B,j){const q=i.bp([],[.5*B.width,.5*-B.height,1]);return i.bq(q,q,[1,-1,0]),i.aB(q,q,B.calculateProjMatrix(j.toUnwrapped())),Float32Array.from(q)})(w,this.tileID);return this.latestFeatureIndex.query(n,{tilespaceGeometry:l,pixelPosMatrix:D,transform:v,availableImages:f,tileTransform:this.tileTransform,worldview:this.worldview,queryRadius:M})}querySourceFeatures(n,l){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const v=f.loadVTLayers(),w=l?l.sourceLayer:"",E=v._geojsonTileLayer||v[w];if(!E)return;const M=i.b5(l&&l.filter),{z:D,x:B,y:j}=this.tileID.canonical,q={z:D,x:B,y:j};for(let U=0;U<E.length;U++){const Y=E.feature(U);if(M.needGeometry){const ce=i.b6(Y,!0);if(!M.filter(new i.ac(this.tileID.overscaledZ,{worldview:this.worldview}),ce,this.tileID.canonical))continue}else if(!M.filter(new i.ac(this.tileID.overscaledZ,{worldview:this.worldview}),Y))continue;const ee=f.getId(Y,w),re=new i.b7(Y,D,B,j,ee);re.tile=q,n.push(re)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(n){const l=this.expirationTime;if(n.cacheControl){const f=i.b8(n.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const f=Date.now();let v=!1;if(this.expirationTime>f)v=!1;else if(l)if(this.expirationTime<l)v=!0;else{const w=this.expirationTime-l;w?this.expirationTime=f+Math.max(w,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(n){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&n&&this.updateBuckets(n)}hasAppearances(n){for(const l in this.buckets)if(n.style.hasLayer(l)&&this.buckets[l].layers.some((f=>f.appearances&&f.appearances.length>0)))return!0;return!1}updateBuckets(n,l){if(!this.latestFeatureIndex||!n.style)return;const f=this.latestFeatureIndex.loadVTLayers(),v=n.style.listImages(),w=n.style.getBrightness();for(const E in this.buckets){if(!n.style.hasLayer(E))continue;const M=this.buckets[E],D=M.layers[0],B=D.sourceLayer||"_geojsonTileLayer",j=f[B],q=n.style.getLayerSourceCache(D);let U={};q&&(U=q._state.getState(B,void 0));const Y=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},ee=Object.keys(U).length>0&&!l;if(M.hasAppearances=M.layers.some((ce=>ce.appearances&&ce.appearances.length>0)),(ee&&M.stateDependentLayers.length!==0||l)&&M.update(U,j,v,Y,ee?M.stateDependentLayers:M.layers,l,w),ee&&M.stateDependentLayers.length!==0||l||M.hasAppearances){const ce={zoom:n.transform.zoom,pitch:n.transform.pitch,brightness:n.style.getBrightness()||0,worldview:n.worldview};M.updateAppearances(this.tileID.canonical,U,v,ce)}(M instanceof i.b9||M instanceof i.ba)&&n._terrain&&n._terrain.enabled&&q&&M.uploadPending()&&n._terrain._clearRenderCacheForTile(q.id,this.tileID);const re=n&&n.style&&n.style.getOwnLayer(E);re&&(this.queryPadding=Math.max(this.queryPadding,re.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=i.o.now()+n}setTexture(n,l){const f=l.context,v=f.gl;this.texture=this.texture||l.getTileTexture(n.width),this.texture&&this.texture instanceof i.T?this.texture.update(n):(this.texture=new i.T(f,n,v.RGBA8,{useMipmap:!0}),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE))}setDependencies(n,l){const f={};for(const v of l)f[v]=!0;this.dependencies[n]=f}hasDependency(n,l){for(const f of n){const v=this.dependencies[f];if(v){for(const w of l)if(v[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const f=i.bb($s,this.tileID.canonical,this.tileTransform)[0],v=new i.bc,w=new i.bd;for(let E=0;E<f.length;E++){const{x:M,y:D}=f[E];v.emplaceBack(M,D),w.emplaceBack(E)}w.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(w),this._tileDebugBuffer=n.createVertexBuffer(v,i.be.members),this._tileDebugSegments=i.bf.simpleSegment(0,0,v.length,w.length)}_makeTileBoundsBuffers(n,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const f=i.bb($s,this.tileID.canonical,this.tileTransform)[0];let v,w;if(this.isRaster){const E=(function(M,D){const B=i.aY(M,D),j=Math.pow(2,M.z);for(let ce=0;ce<Rs;ce++)for(let ae=0;ae<Rs;ae++){const de=i.aZ((M.x+(ae+Us(ae))/es)/j),ye=i.a_((M.y+(ce+Us(ce))/es)/j),fe=D.project(de,ye),Me=ce*Rs+ae;Os[2*Me+0]=Math.round((fe.x*B.scale-B.x)*i.al),Os[2*Me+1]=Math.round((fe.y*B.scale-B.y)*i.al)}Ta.fill(0),Vs.fill(0);for(let ce=2045;ce>=0;ce--){const ae=4*ce,de=ts[ae+0],ye=ts[ae+1],fe=ts[ae+2],Me=ts[ae+3],xe=de+fe>>1,Ce=ye+Me>>1,Te=xe+Ce-ye,be=Ce+de-xe,De=ye*Rs+de,He=Me*Rs+fe,$e=Ce*Rs+xe,st=Math.hypot((Os[2*De+0]+Os[2*He+0])/2-Os[2*$e+0],(Os[2*De+1]+Os[2*He+1])/2-Os[2*$e+1])>=16;Ta[$e]=Ta[$e]||(st?1:0),ce<1022&&(Ta[$e]=Ta[$e]||Ta[(ye+be>>1)*Rs+(de+Te>>1)]||Ta[(Me+be>>1)*Rs+(fe+Te>>1)])}const q=new i.a$,U=new i.b0;let Y=0;function ee(ce,ae){const de=ae*Rs+ce;return Vs[de]===0&&(q.emplaceBack(Os[2*de+0],Os[2*de+1],ce*i.al/es,ae*i.al/es),Vs[de]=++Y),Vs[de]-1}function re(ce,ae,de,ye,fe,Me){const xe=ce+de>>1,Ce=ae+ye>>1;if(Math.abs(ce-fe)+Math.abs(ae-Me)>1&&Ta[Ce*Rs+xe])re(fe,Me,ce,ae,xe,Ce),re(de,ye,fe,Me,xe,Ce);else{const Te=ee(ce,ae),be=ee(de,ye),De=ee(fe,Me);U.emplaceBack(Te,be,De)}}return re(0,0,es,es,es,0),re(es,es,0,0,0,es),{vertices:q,indices:U}})(this.tileID.canonical,l);v=E.vertices,w=E.indices}else{v=new i.a$,w=new i.b0;for(const{x:M,y:D}of f)v.emplaceBack(M,D,0,0);const E=i.bg(v.int16.subarray(0,4*v.length),void 0,4);for(let M=0;M<E.length;M+=3)w.emplaceBack(E[M],E[M+1],E[M+2])}this._tileBoundsBuffer=n.createVertexBuffer(v,i.bh.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(w),this._tileBoundsSegments=i.bf.simpleSegment(0,0,v.length,w.length)}_makeGlobeTileDebugBuffers(n,l){const f=l.projection;if(!f||f.name!=="globe"||l.freezeTileCoverage)return;const v=this.tileID.canonical,w=i.bi(v,l),E=i.bj(w),M=i.aj(l.zoom);let D;M>0&&(D=i.bk(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,v,l,E,D,M),this._makeGlobeTileDebugTextBuffer(n,v,l,E,D,M)}_globePoint(n,l,f,v,w,E,M){let D=i.bl(n,l,f);if(E){const B=1<<f.z,j=i.aF(v.center.lng),q=i.aJ(v.center.lat),U=(f.x+.5)/B-j;let Y=0;U>.5?Y=-1:U<-.5&&(Y=1);let ee=(n/i.al+f.x)/B+Y,re=(l/i.al+f.y)/B;ee=(ee-j)*v._pixelsPerMercatorPixel+j,re=(re-q)*v._pixelsPerMercatorPixel+q;const ce=[ee*v.worldSize,re*v.worldSize,0];i.af(ce,ce,E),D=i.bm(D,ce,M)}return i.af(D,D,w)}_makeGlobeTileDebugBorderBuffer(n,l,f,v,w,E){const M=new i.bc,D=new i.bd,B=new i.bn,j=(U,Y,ee,re,ce)=>{const ae=(ee-U)/(ce-1),de=(re-Y)/(ce-1),ye=M.length;for(let fe=0;fe<ce;fe++){const Me=U+fe*ae,xe=Y+fe*de;M.emplaceBack(Me,xe);const Ce=this._globePoint(Me,xe,l,f,v,w,E);B.emplaceBack(Ce[0],Ce[1],Ce[2]),D.emplaceBack(ye+fe)}},q=i.al;j(0,0,q,0,16),j(q,0,q,q,16),j(q,q,0,q,16),j(0,q,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(D),this._tileDebugBuffer=n.createVertexBuffer(M,i.be.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(B,i.bo.members),this._tileDebugSegments=i.bf.simpleSegment(0,0,M.length,D.length)}_makeGlobeTileDebugTextBuffer(n,l,f,v,w,E){const M=i.al/4,D=new i.bc,B=new i.b0,j=new i.bn,q=25;B.reserve(32),D.reserve(q),j.reserve(q);const U=(Y,ee)=>q*Y+ee;for(let Y=0;Y<q;Y++){const ee=Y*M;for(let re=0;re<q;re++){const ce=re*M;D.emplaceBack(ce,ee);const ae=this._globePoint(ce,ee,l,f,v,w,E);j.emplaceBack(ae[0],ae[1],ae[2])}}for(let Y=0;Y<4;Y++)for(let ee=0;ee<4;ee++){const re=U(Y,ee),ce=U(Y,ee+1),ae=U(Y+1,ee),de=U(Y+1,ee+1);B.emplaceBack(re,ce,ae),B.emplaceBack(ae,ce,de)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(B),this._tileDebugTextBuffer=n.createVertexBuffer(D,i.be.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(j,i.bo.members),this._tileDebugTextSegments=i.bf.simpleSegment(0,0,q,32)}destroy(n=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!n&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.br.setPbf(i.bs);class oa extends jo{constructor(n,l,f,v,w){super(n,l,f,v,w),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._taskQueue=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(n){return this._mrt&&this._mrt.getLayer(n)}setTexturePerLayer(n,l,f){const v=f.context,w=v.gl;let E=this.texturePerLayer.get(n)||f.getTileTexture(l.width);E&&E instanceof i.T?E.update(l,{premultiply:!1}):E=new i.T(v,l,w.RGBA8,{premultiply:!1}),this.texturePerLayer.has(n)||this.texturePerLayer.set(n,E)}flushQueues(n){const l=this._workQueuePerLayer.get(n)||[],f=this._fetchQueuePerLayer.get(n)||[];for(;l.length;)l.pop()();for(;f.length;)f.pop()()}flushAllQueues(){for(const n of this._workQueuePerLayer.keys()){const l=this._workQueuePerLayer.get(n)||[];for(;l.length;)l.pop()()}for(const n of this._fetchQueuePerLayer.keys()){const l=this._fetchQueuePerLayer.get(n)||[];for(;l.length;)l.pop()()}}fetchHeader(n=16384,l){const f=this._mrt=new i.br(30),v=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(n-1)}});return this.entireBuffer=null,this.request=i.bt(v,((w,E,M)=>{if(w)l(w);else try{const D=f.getHeaderLength(E);if(D>n)return void(this.request=this.fetchHeader(D,l));f.parseHeader(E),this._isHeaderLoaded=!0;let B=0;for(const j of Object.values(f.layers))B=Math.max(B,j.dataIndex[j.dataIndex.length-1].lastByte);E.byteLength>=B&&(this.entireBuffer=E),l(null,this.entireBuffer||E,M)}catch(D){l(D)}})),this.request}fetchBandForRender(n,l,f,v){this.fetchBand(n,l,f,(w=>{if(w)return void v(w);this.updateTextureDescriptor(n,l,f);const E=this.textureDescriptorPerLayer.get(l);v(null,E?E.img:null)}))}fetchBand(n,l,f,v,w=!0){const E=this._mrt;if(!this._isHeaderLoaded||!E)return void v(new Error("Tile header is not ready"));const M=this.actor;if(!M)return void v(new Error("Can't fetch tile band without an actor"));let D;const B=i.B(String(f),i.B(this.tileID.key,n));let j=this._taskQueue.get(B);j?j.add(v):(j=new Set,j.add(v),this._taskQueue.set(B,j));const q=(re,ce)=>{D.complete(re,ce),re?v(re):(j.values().forEach((ae=>ae(null,ce))),this._taskQueue.delete(B))},U=(re,ce)=>{if(re)return v(re);const ae=M.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:ce,task:D},q,void 0,!0);if(l!==null){const de=this._workQueuePerLayer.get(l)||[];de.push((()=>{ae&&ae.cancel(),D.cancel()})),this._workQueuePerLayer.has(l)||this._workQueuePerLayer.set(l,de)}};let Y;try{Y=E.getLayer(n)}catch(re){if(this.state==="reloading")return;throw re}if(!Y)return void v(new Error(`Unknown sourceLayer "${n}"`));if(Y.hasDataForBand(f))return j.values().forEach((re=>re(null,null))),void this._taskQueue.delete(B);const ee=Y.getDataRange([f]);if(D=E.createDecodingTask(ee),!D||D.tasks.length)if(l!==null&&this.flushQueues(l),this.entireBuffer)U(null,this.entireBuffer.slice(ee.firstByte,ee.lastByte+1));else{const re=Object.assign({},this.requestParams,{headers:{Range:`bytes=${ee.firstByte}-${ee.lastByte}`}}),ce=i.bt(re,U);if(l!==null){const ae=this._fetchQueuePerLayer.get(l)||[];ae.push((()=>{ce.cancel(),D.cancel()})),this._fetchQueuePerLayer.has(l)||this._fetchQueuePerLayer.set(l,ae)}}}updateNeeded(n,l){return(!this.textureDescriptorPerLayer.get(n)||this.textureDescriptorPerLayer.get(n).band!==l||this.refreshedUponExpiration)&&this.state!=="errored"}updateTextureDescriptor(n,l,f){if(!this._mrt)return;const v=this._mrt.getLayer(n);if(!v||!v.hasBand(f)||!v.hasDataForBand(f))return;const{bytes:w,tileSize:E,buffer:M,offset:D,scale:B}=v.getBandView(f),j=E+2*M,q=new i.q({width:j,height:j},w),U=this.texturePerLayer.get(l);U&&U instanceof i.T&&U.update(q,{premultiply:!1}),this.textureDescriptorPerLayer.set(l,{layer:n,band:f,img:q,buffer:M,offset:D,tileSize:E,format:v.pixelFormat,mix:[B,256*B,65536*B,16777216*B]})}destroy(n=!1){if(super.destroy(n),delete this._mrt,!n)for(const l of this.texturePerLayer.values())l&&l instanceof i.T&&l.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class ul{constructor(n,l){this.max=n,this.onRemove=l,this.reset()}reset(){for(const n in this.data)for(const l of this.data[n])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(n,l,f){const v=n.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const w={value:l,timeout:void 0};if(f!==void 0&&(w.timeout=setTimeout((()=>{this.remove(n,w)}),f)),this.data[v].push(w),this.order.push(v),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const l=this.data[n].shift();return l.timeout&&clearTimeout(l.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),l.value}getByKey(n){const l=this.data[n];return l?l[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,l){if(!this.has(n))return this;const f=n.wrapped().key,v=l===void 0?0:this.data[f].indexOf(l),w=this.data[f][v];return this.data[f].splice(v,1),w.timeout&&clearTimeout(w.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(w.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(n){const l=[];for(const f in this.data)for(const v of this.data[f])n(v.value)||l.push(v);for(const f of l)this.remove(f.value.tileID,f)}}class Ea{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,l,f){const v=String(l);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][v]=this.stateChanges[n][v]||{},Object.assign(this.stateChanges[n][v],f),this.deletedStates[n]===null){this.deletedStates[n]={};for(const w in this.state[n])w!==v&&(this.deletedStates[n][w]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][v]===null){this.deletedStates[n][v]={};for(const w in this.state[n][v])f[w]||(this.deletedStates[n][v][w]=null)}else for(const w in f)this.deletedStates[n]&&this.deletedStates[n][v]&&this.deletedStates[n][v][w]===null&&delete this.deletedStates[n][v][w]}removeFeatureState(n,l,f){if(this.deletedStates[n]===null)return;const v=String(l);if(this.deletedStates[n]=this.deletedStates[n]||{},f&&l!==void 0)this.deletedStates[n][v]!==null&&(this.deletedStates[n][v]=this.deletedStates[n][v]||{},this.deletedStates[n][v][f]=null);else if(l!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][v])for(f in this.deletedStates[n][v]={},this.stateChanges[n][v])this.deletedStates[n][v][f]=null;else this.deletedStates[n][v]=null;else this.deletedStates[n]=null}getState(n,l){const f=this.state[n]||{},v=this.stateChanges[n]||{},w=this.deletedStates[n];if(w===null)return{};if(l!==void 0){const M=String(l),D=Object.assign({},f[M],v[M]);if(w){const B=w[l];if(B===null)return{};for(const j in B)delete D[j]}return D}const E=Object.assign({},f,v);if(w)for(const M in w)delete E[M];return E}initializeTileState(n,l){n.refreshFeatureState(l)}coalesceChanges(n,l){const f={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const w={};for(const E in this.stateChanges[v])this.state[v][E]||(this.state[v][E]={}),Object.assign(this.state[v][E],this.stateChanges[v][E]),w[E]=this.state[v][E];f[v]=w}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const w={};if(this.deletedStates[v]===null)for(const E in this.state[v])w[E]={},this.state[v][E]={};else for(const E in this.deletedStates[v]){if(this.deletedStates[v][E]===null)this.state[v][E]={};else if(this.state[v][E])for(const M of Object.keys(this.deletedStates[v][E]))delete this.state[v][E][M];w[E]=this.state[v][E]}f[v]=f[v]||{},Object.assign(f[v],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const v in n)n[v].refreshFeatureState(l)}}class Ws extends i.E{constructor(n,l,f){super(),this.id=n,this._onlySymbols=f,l.on("data",(v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),l.on("error",(()=>{this._sourceErrored=!0})),this._source=l,this._tiles={},this._cache=new ul(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Ea,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles)if(!this._tiles[n].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,l){return n.isSymbolTile=this._onlySymbols,n.isExtraShadowCaster=this._shadowCasterTiles[n.tileID.key],this._source.loadTile(n,l)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n)}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n)}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const f=this._tiles[l];f.upload(n,this.map?this.map.painter:void 0),f.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map((n=>n.tileID)).sort(La).map((n=>n.key))}getRenderableIds(n,l){const f=[];for(const v in this._tiles)this._isIdRenderable(+v,n,l)&&f.push(this._tiles[v]);return n?f.sort(((v,w)=>{const E=v.tileID,M=w.tileID,D=new i.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),B=new i.P(M.canonical.x,M.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-M.overscaledZ||B.y-D.y||B.x-D.x})).map((v=>v.tileID.key)):f.map((v=>v.tileID)).sort(La).map((v=>v.key))}hasRenderableParent(n){const l=this.findLoadedParent(n,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(n,l,f){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(l||!this._tiles[n].holdingForFade())&&(f||!this._shadowCasterTiles[n])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,l){const f=this._tiles[n];f&&(f.state!=="loading"&&(f.state=l),this._loadTile(f,this._tileLoaded.bind(this,f,n,l)))}_tileLoaded(n,l,f,v,w){if(v){if(n.state="errored",v.status!==404)this._source.fire(new i.y(v,{tile:n}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:n})),!(n.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const M=this.map.painter.terrain;this.update(this.transform,M.getScaledDemTileSize(),!0),M.resetTileLookupCache(this.id)}else this.update(this.transform)}return}n.timeAdded=i.o.now(),f==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(l,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null);let E=new Map;w&&w.responseHeaders&&(E=w.responseHeaders),this._source.fire(new i.z("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id,responseHeaders:E}))}_backfillDEM(n){const l=this.getRenderableIds();for(let v=0;v<l.length;v++){const w=l[v];if(n.neighboringTiles&&n.neighboringTiles[w]){const E=this.getTileByID(w);f(n,E),f(E,n)}}function f(v,w){if(!v.dem||v.dem.borderReady)return;v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0;let E=w.tileID.canonical.x-v.tileID.canonical.x;const M=w.tileID.canonical.y-v.tileID.canonical.y,D=Math.pow(2,v.tileID.canonical.z),B=w.tileID.key;E===0&&M===0||Math.abs(M)>1||(Math.abs(E)>1&&(Math.abs(E+D)===1?E+=D:Math.abs(E-D)===1&&(E-=D)),w.dem&&v.dem&&(v.dem.backfillBorder(w.dem,E,M),v.neighboringTiles&&v.neighboringTiles[B]&&(v.neighboringTiles[B].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,l,f,v){for(const w in this._tiles){let E=this._tiles[w];if(v[w]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>f)continue;let M=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const B=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[B.key],E&&E.hasData()&&(M=B)}let D=M;for(;D.overscaledZ>l;)if(D=D.scaledTo(D.overscaledZ-1),n[D.key]){v[M.key]=M;break}}}findLoadedParent(n,l){if(n.key in this._loadedParentTiles){const f=this._loadedParentTiles[n.key];return f&&f.tileID.overscaledZ>=l?f:null}for(let f=n.overscaledZ-1;f>=l;f--){const v=n.scaledTo(f),w=this._getLoadedTile(v);if(w)return w}}_getLoadedTile(n){const l=this._tiles[n.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,l){l=l||this._source.tileSize;const f=Math.ceil(n.width/l)+1,v=Math.ceil(n.height/l)+1,w=Math.floor(f*v*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(M)}handleWrapJump(n){const l=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,l){const f={};for(const v in this._tiles){const w=this._tiles[v];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),f[w.tileID.key]=w}this._tiles=f;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(+v,this._tiles[v])}}update(n,l,f,v,w){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;this.updateCacheSize(n,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const E=this._source.type==="batched-model";let M,D=this._source.maxzoom;const B=this.map&&this.map.painter?this.map.painter._terrain:null;if(B&&B.sourceCache===this&&B.attenuationRange()){const U=B.attenuationRange()[0],Y=Math.floor(U)-Math.log2(B.getDemUpscale());D>Y&&(D=Y)}if(this.used||this.usedForTerrain){if(this._source.tileID)M=n.getVisibleUnwrappedCoordinates(this._source.tileID).map((U=>new i.aP(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)));else if(this.tileCoverLift!==0){const U=n.clone();U.tileCoverLift=this.tileCoverLift,M=U.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:E}),this._source.minzoom<=1&&n.projection.name==="globe"&&(M.push(new i.aP(1,0,1,0,0)),M.push(new i.aP(1,0,1,1,0)),M.push(new i.aP(1,0,1,0,1)),M.push(new i.aP(1,0,1,1,1)))}else if(M=n.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:E}),this._source.hasTile){const U=this._source.hasTile.bind(this._source);M=M.filter((Y=>U(Y)))}}else M=[];if(M.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!ms(this._source.type)){const U=n.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!f}),Y=Math.min(U,this._source.maxzoom);if(E){const ee=n.extendTileCover(M,Y);for(const re of ee)M.push(re)}else if(w){const ee=n.extendTileCoverToNearPlane(M,this.transform.getFrustum(Y),Y);for(const re of ee)M.push(re)}else if(this.castsShadows&&v){const ee=n.extendTileCover(M,Y,v);for(const re of ee)this._shadowCasterTiles[re.key]=!0,M.push(re)}}const j=this._updateRetainedTiles(M);if(ms(this._source.type)&&M.length!==0){const U={},Y={},ee=Object.keys(j);for(const ce of ee){const ae=j[ce],de=this._tiles[ce];if(!de||de.fadeEndTime&&de.fadeEndTime<=i.o.now())continue;const ye=this.findLoadedParent(ae,Math.max(ae.overscaledZ-Ws.maxOverzooming,this._source.minzoom));ye&&(this._addTile(ye.tileID),U[ye.tileID.key]=ye.tileID),Y[ce]=ae}const re=M[M.length-1].overscaledZ;for(const ce in this._tiles){const ae=this._tiles[ce];if(j[ce]||!ae.hasData())continue;let de=ae.tileID;for(;de.overscaledZ>re;){de=de.scaledTo(de.overscaledZ-1);const ye=this._tiles[de.key];if(ye&&ye.hasData()&&Y[de.key]){j[ce]=ae.tileID;break}}}for(const ce in U)j[ce]||(this._coveredTiles[ce]=!0,j[ce]=U[ce])}for(const U in j)this._tiles[U].clearFadeHold();const q=i.bu(this._tiles,j);for(const U of q){const Y=this._tiles[U];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(+U)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const l={};if(n.length===0)return l;const f={},v=n.reduce(((B,j)=>Math.min(B,j.overscaledZ)),1/0),w=n[0].overscaledZ,E=Math.max(w-Ws.maxOverzooming,this._source.minzoom),M=Math.max(w+Ws.maxUnderzooming,this._source.minzoom),D={};for(const B of n){const j=this._addTile(B);l[B.key]=B,j.hasData()||v<this._source.maxzoom&&(D[B.key]=B)}this._retainLoadedChildren(D,v,M,l);for(const B of n){let j=this._tiles[B.key];if(j.hasData())continue;if(B.canonical.z>=this._source.maxzoom){const U=B.children(this._source.maxzoom)[0],Y=this.getTile(U);if(Y&&Y.hasData()){l[U.key]=U;continue}}else{const U=B.children(this._source.maxzoom);if(l[U[0].key]&&l[U[1].key]&&l[U[2].key]&&l[U[3].key])continue}let q=j.wasRequested();for(let U=B.overscaledZ-1;U>=E;--U){const Y=B.scaledTo(U);if(f[Y.key]||(f[Y.key]=!0,j=this.getTile(Y),!j&&q&&(j=this._addTile(Y)),j&&(l[Y.key]=Y,q=j.wasRequested(),j.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const l=[];let f,v=this._tiles[n].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){f=this._loadedParentTiles[v.key];break}l.push(v.key);const w=v.scaledTo(v.overscaledZ-1);if(f=this._getLoadedTile(w),f)break;v=w}for(const w of l)this._loadedParentTiles[w]=f}}_addTile(n){let l=this._tiles[n.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[n.key]||this._reloadTile(n.key,"reloading"),l;l=this._cache.getAndRemove(n),l&&(this._setTileReloadTimer(n.key,l),l.tileID=n,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,l)));const f=!!l;if(!f){const v=this.map?this.map.painter:null,w=this._source.tileSize*n.overscaleFactor();l=this._source.type==="raster-array"?new oa(n,w,this.transform.tileZoom,v,this._isRaster):new jo(n,w,this.transform.tileZoom,v,this._isRaster,this._source.worldview),this._loadTile(l,this._tileLoaded.bind(this,l,n.key,l.state))}return l.uses++,this._tiles[n.key]=l,f||this._source.fire(new i.z("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l}_setTileReloadTimer(n,l){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const f=l.getExpiryTimeout();f&&(this._timers[n]=setTimeout((()=>{this._reloadTile(n,"expired"),delete this._timers[n]}),f))}_removeTile(n){const l=this._tiles[n];l&&(l.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,l,f){const v=[],w=this.transform;if(!w)return v;const E=w.projection.name==="globe",M=i.aF(w.center.lng);for(const D in this._tiles){const B=this._tiles[D];if(f&&B.clearQueryDebugViz(),B.holdingForFade())continue;let j;if(E){const q=B.tileID.canonical;if(q.z===0){const U=[Math.abs(i.aA(M,...Rl(q,-1))-M),Math.abs(i.aA(M,...Rl(q,1))-M)];j=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(i.aA(M,...Rl(q,-1))-M),Math.abs(i.aA(M,...Rl(q,0))-M),Math.abs(i.aA(M,...Rl(q,1))-M)];j=[U.indexOf(Math.min(...U))-1]}}else j=[0];for(const q of j){const U=n.containsTile(B,w,l,q);U&&v.push(U)}}return v}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(n){return this._getRenderableCoordinates(n)}_getRenderableCoordinates(n,l){const f=this.getRenderableIds(n,l).map((w=>this._tiles[w].tileID)),v=this.transform.projection.name==="globe";for(const w of f)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=v?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return f}sortCoordinatesByDistance(n){const l=n.slice(),f=this.transform._camera.position,v=this.transform._camera.forward(),w={};for(const E of l){const M=1/(1<<E.canonical.z);w[E.key]=((E.canonical.x+.5)*M+E.wrap-f[0])*v[0]+((E.canonical.y+.5)*M-f[1])*v[1]-f[2]*v[2]}return l.sort(((E,M)=>w[E.key]-w[M.key])),l}hasTransition(){if(this._source.hasTransition())return!0;if(ms(this._source.type))for(const n in this._tiles){const l=this._tiles[n];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=i.o.now())return!0}return!1}setFeatureState(n,l,f){this._state.updateState(n=n||"_geojsonTileLayer",l,f)}removeFeatureState(n,l,f){this._state.removeFeatureState(n=n||"_geojsonTileLayer",l,f)}getFeatureState(n,l){return this._state.getState(n=n||"_geojsonTileLayer",l)}setDependencies(n,l,f){const v=this._tiles[n];v&&v.setDependencies(l,f)}reloadTilesForDependencies(n,l){for(const f in this._tiles)this._tiles[f].hasDependency(n,l)&&this._reloadTile(+f,"reloading");this._cache.filter((f=>!f.hasDependency(n,l)))}_preloadTiles(n,l){if(!this._sourceLoaded){const D=()=>{this._sourceLoaded&&(this._source.off("data",D),this._preloadTiles(n,l))};return void this._source.on("data",D)}const f=new Map,v=Array.isArray(n)?n:[n],w=this.map.painter.terrain,E=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const D of v){const B=D.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const j of B)f.set(j.key,j);this.usedForTerrain&&D.updateElevation(!1)}const M=Array.from(f.values());i.bv(M,((D,B)=>{const j=new jo(D,this._source.tileSize*D.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(j,(q=>{this._source.type==="raster-dem"&&j.dem&&this._backfillDEM(j),B(q,j)}))}),l)}}function La(h,n){const l=Math.abs(2*h.wrap)-+(h.wrap<0),f=Math.abs(2*n.wrap)-+(n.wrap<0);return h.overscaledZ-n.overscaledZ||f-l||n.canonical.y-h.canonical.y||n.canonical.x-h.canonical.x}function ms(h){return h==="raster"||h==="image"||h==="video"||h==="custom"}function Rl(h,n){const l=1<<h.z;return[h.x/l+n,(h.x+1)/l+n]}Ws.maxOverzooming=10,Ws.maxUnderzooming=3;class Rc{constructor(n){this.style=n,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const n=!1,l=!1;for(const f in this.style._mergedLayers){const v=this.style._mergedLayers[f];if(v.type==="fill-extrusion"||v.type==="building")this.layers.push({layer:v,visible:n,visibilityChanged:l});else if(v.type==="model"){const w=this.style.getLayerSource(v);w&&w.type==="batched-model"&&this.layers.push({layer:v,visible:n,visibilityChanged:l})}}}onNewFrame(n){this.layersGotHidden=!1;for(const l of this.layers){const f=l.layer;let v=!1;f.type==="fill-extrusion"?v=!f.isHidden(n)&&f.paint.get("fill-extrusion-opacity")>0:f.type==="building"?v=!f.isHidden(n)&&f.paint.get("building-opacity")>0:f.type==="model"&&(v=!f.isHidden(n)&&f.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!v&&l.visible,l.visible=v}}updateZOffset(n,l){this.currentBuildingBuckets=[];for(const v of this.layers){const w=v.layer,E=this.style.getLayerSourceCache(w);let M=1;w.type==="fill-extrusion"?M=v.visible?w.paint.get("fill-extrusion-vertical-scale"):0:w.type==="building"&&(M=v.visible?w.paint.get("building-vertical-scale"):0);let D=E?E.getTile(l):null;if(!D&&E)for(const B in E._tiles){const j=E._tiles[B];if(l.canonical.isChildOf(j.tileID.canonical)){D=j;break}}this.currentBuildingBuckets.push({bucket:D?D.getBucket(w):null,tileID:D?D.tileID:l,verticalScale:M})}n.hasAnyZOffset=!1;let f=!1;for(let v=0;v<n.symbolInstances.length;v++){const w=n.symbolInstances.get(v),E=w.zOffset,M=this._getHeightAtTileOffset(l,w.tileAnchorX,w.tileAnchorY);w.zOffset=M!==Number.NEGATIVE_INFINITY?M:E,f||E===w.zOffset||(f=!0),n.hasAnyZOffset||w.zOffset===0||(n.hasAnyZOffset=!0)}f&&(n.zOffsetBuffersNeedUpload=!0,n.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(n,l,f,v){let w=l,E=f;if(n.canonical.z!==v.canonical.z){const M=v.canonical,D=1/(1<<n.canonical.z-M.z);w=(l+n.canonical.x*i.al)*D-M.x*i.al|0,E=(f+n.canonical.y*i.al)*D-M.y*i.al|0}return{tileX:w,tileY:E}}_getHeightAtTileOffset(n,l,f){let v,w;for(let E=0;E<this.layers.length;++E){const M=this.layers[E].layer;if(M.type!=="fill-extrusion"&&M.type!=="building")continue;const{bucket:D,tileID:B,verticalScale:j}=this.currentBuildingBuckets[E];if(!D)continue;const{tileX:q,tileY:U}=this._mapCoordToOverlappingTile(n,l,f,B),Y=D.getHeightAtTileCoord(q,U);Y&&Y.height!==void 0&&(Y.hidden?v=Y.height:w=Math.max(Y.height*j,w||0))}if(w!==void 0)return w;for(let E=0;E<this.layers.length;++E){const M=this.layers[E];if(M.layer.type!=="model"||!M.visible)continue;const{bucket:D,tileID:B}=this.currentBuildingBuckets[E];if(!D)continue;const{tileX:j,tileY:q}=this._mapCoordToOverlappingTile(n,l,f,B),U=D.getHeightAtTileCoord(j,q);if(U&&!U.hidden)return U.height===void 0&&v!==void 0?Math.min(U.maxHeight,v)*U.verticalScale:U.height?U.height*U.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function dl(h,n){const l={};for(const f in h)f!=="ref"&&(l[f]=h[f]);return i.bw.forEach((f=>{f in n&&(l[f]=n[f])})),l}function hl(h){h=h.slice();const n=Object.create(null);for(let l=0;l<h.length;l++)n[h[l].id]=h[l];for(let l=0;l<h.length;l++)"ref"in h[l]&&(h[l]=dl(h[l],n[h[l].ref]));return h}const bn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Ol(h,n,l){l.push({command:bn.addSource,args:[h,n[h]]})}function za(h,n,l){n.push({command:bn.removeSource,args:[h]}),l[h]=!0}function Fa(h,n,l,f){za(h,l,f),Ol(h,n,l)}function Ge(h,n,l){let f;for(f in h[l])if(h[l].hasOwnProperty(f)&&f!=="data"&&!i.bx(h[l][f],n[l][f]))return!1;for(f in n[l])if(n[l].hasOwnProperty(f)&&f!=="data"&&!i.bx(h[l][f],n[l][f]))return!1;return!0}function yt(h,n,l,f,v,w){let E;for(E in n=n||{},h=h||{})h.hasOwnProperty(E)&&(i.bx(h[E],n[E])||l.push({command:w,args:[f,E,n[E],v]}));for(E in n)n.hasOwnProperty(E)&&!h.hasOwnProperty(E)&&(i.bx(h[E],n[E])||l.push({command:w,args:[f,E,n[E],v]}))}function Ht(h){return h.id}function Xr(h,n){return h[n.id]=n,h}function jn(h,n,l){const f=n.createTileMatrix(h,h.worldSize,l.toUnwrapped());return i.aB(new Float32Array(16),h.projMatrix,f)}function Ri(h,n,l){if(n.projection.name===l.projection.name)return h.projMatrix;const f=l.clone();return f.setProjection(n.projection),jn(f,n.getProjection(),h)}function Ui(h,n,l){return n.name===l.projection.name?h.projMatrix:jn(l,n,h)}class ai{constructor(n,l){this.reset(n,l)}reset(n,l){this.points=n||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=i.aA(n,0,1);let l=1,f=this._distances[l];const v=n*this.paddedLength+this.padding;for(;f<v&&l<this._distances.length;)f=this._distances[++l];const w=l-1,E=this._distances[w],M=f-E,D=M>0?(v-E)/M:0;return this.points[w].mult(1-D).add(this.points[l].mult(D))}}class Oi{constructor(n,l,f){const v=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(n/f),this.yCellCount=Math.ceil(l/f);for(let E=0;E<this.xCellCount*this.yCellCount;E++)v.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=l,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,l,f,v,w){this._forEachCell(l,f,v,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(w)}insertCircle(n,l,f,v){this._forEachCell(l-v,f-v,l+v,f+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(l),this.circles.push(f),this.circles.push(v)}_insertBoxCell(n,l,f,v,w,E){this.boxCells[w].push(E)}_insertCircleCell(n,l,f,v,w,E){this.circleCells[w].push(E)}_query(n,l,f,v,w,E){if(f<0||n>this.width||v<0||l>this.height)return!w&&[];const M=[];if(n<=0&&l<=0&&this.width<=f&&this.height<=v){if(w)return!0;for(let D=0;D<this.boxKeys.length;D++)M.push({key:this.boxKeys[D],x1:this.bboxes[4*D],y1:this.bboxes[4*D+1],x2:this.bboxes[4*D+2],y2:this.bboxes[4*D+3]});for(let D=0;D<this.circleKeys.length;D++){const B=this.circles[3*D],j=this.circles[3*D+1],q=this.circles[3*D+2];M.push({key:this.circleKeys[D],x1:B-q,y1:j-q,x2:B+q,y2:j+q})}return E?M.filter(E):M}return this._forEachCell(n,l,f,v,this._queryCell,M,{hitTest:w,seenUids:{box:{},circle:{}}},E),w?M.length>0:M}_queryCircle(n,l,f,v,w){const E=n-f,M=n+f,D=l-f,B=l+f;if(M<0||E>this.width||B<0||D>this.height)return!v&&[];const j=[];return this._forEachCell(E,D,M,B,this._queryCellCircle,j,{hitTest:v,circle:{x:n,y:l,radius:f},seenUids:{box:{},circle:{}}},w),v?j.length>0:j}query(n,l,f,v,w){return this._query(n,l,f,v,!1,w)}hitTest(n,l,f,v,w){return this._query(n,l,f,v,!0,w)}hitTestCircle(n,l,f,v){return this._queryCircle(n,l,f,!0,v)}_queryCell(n,l,f,v,w,E,M,D){const B=M.seenUids,j=this.boxCells[w];if(j!==null){const U=this.bboxes;for(const Y of j)if(!B.box[Y]){B.box[Y]=!0;const ee=4*Y;if(n<=U[ee+2]&&l<=U[ee+3]&&f>=U[ee+0]&&v>=U[ee+1]&&(!D||D(this.boxKeys[Y]))){if(M.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[Y],x1:U[ee],y1:U[ee+1],x2:U[ee+2],y2:U[ee+3]})}}}const q=this.circleCells[w];if(q!==null){const U=this.circles;for(const Y of q)if(!B.circle[Y]){B.circle[Y]=!0;const ee=3*Y;if(this._circleAndRectCollide(U[ee],U[ee+1],U[ee+2],n,l,f,v)&&(!D||D(this.circleKeys[Y]))){if(M.hitTest)return E.push(!0),!0;{const re=U[ee],ce=U[ee+1],ae=U[ee+2];E.push({key:this.circleKeys[Y],x1:re-ae,y1:ce-ae,x2:re+ae,y2:ce+ae})}}}}}_queryCellCircle(n,l,f,v,w,E,M,D){const B=M.circle,j=M.seenUids,q=this.boxCells[w];if(q!==null){const Y=this.bboxes;for(const ee of q)if(!j.box[ee]){j.box[ee]=!0;const re=4*ee;if(this._circleAndRectCollide(B.x,B.y,B.radius,Y[re+0],Y[re+1],Y[re+2],Y[re+3])&&(!D||D(this.boxKeys[ee])))return E.push(!0),!0}}const U=this.circleCells[w];if(U!==null){const Y=this.circles;for(const ee of U)if(!j.circle[ee]){j.circle[ee]=!0;const re=3*ee;if(this._circlesCollide(Y[re],Y[re+1],Y[re+2],B.x,B.y,B.radius)&&(!D||D(this.circleKeys[ee])))return E.push(!0),!0}}}_forEachCell(n,l,f,v,w,E,M,D){const B=this._convertToXCellCoord(n),j=this._convertToYCellCoord(l),q=this._convertToXCellCoord(f),U=this._convertToYCellCoord(v);for(let Y=B;Y<=q;Y++)for(let ee=j;ee<=U;ee++)if(w.call(this,n,l,f,v,this.xCellCount*ee+Y,E,M,D))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,l,f,v,w,E){const M=v-n,D=w-l,B=f+E;return B*B>M*M+D*D}_circleAndRectCollide(n,l,f,v,w,E,M){const D=(E-v)/2,B=Math.abs(n-(v+D));if(B>D+f)return!1;const j=(M-w)/2,q=Math.abs(l-(w+j));if(q>j+f)return!1;if(B<=D||q<=j)return!0;const U=B-D,Y=q-j;return U*U+Y*Y<=f*f}}const eo={unknown:0,flipRequired:1,flipNotRequired:2},Yo=Math.tan(85*Math.PI/180);function qs(h,n,l,f,v,w,E){const M=i.bB();if(l)if(w.name==="globe"){const D=i.bC(v,n);i.aB(M,M,D)}else{const D=i.bD([],E);M[0]=D[0],M[1]=D[1],M[4]=D[2],M[5]=D[3],f||i.bA(M,M,v.angle)}else i.aB(M,v.labelPlaneMatrix,h);return M}function ka(h,n,l,f,v,w,E){const M=qs(h,n,l,f,v,w,E);return w.name==="globe"&&l||(M[2]=M[6]=M[10]=M[14]=0),M}function sa(h,n,l,f,v,w,E){if(l){if(w.name==="globe"){const M=qs(h,n,l,f,v,w,E);return i.bk(M,M),i.aB(M,h,M),M}{const M=i.by(h),D=i.bz([]);return D[0]=E[0],D[1]=E[1],D[4]=E[2],D[5]=E[3],i.aB(M,M,D),f||i.bA(M,M,-v.angle),M}}return v.glCoordMatrix}function pi(h,n,l,f){const v=[h,n,l,1];l?i.aC(v,v,f):Ba(v,v,f);const w=v[3];return v[0]/=w,v[1]/=w,v[2]/=w,v}function sc(h,n){return Math.min(.5+h/n*.5,1.5)}function Iu(h,n){const l=h[0]/h[3],f=h[1]/h[3];return l>=-n[0]&&l<=n[0]&&f>=-n[1]&&f<=n[1]}function Oc(h,n,l,f,v,w,E,M,D,B,j=1){const q=l.transform,U=f?h.textSizeData:h.iconSizeData,Y=i.bJ(U,l.transform.zoom,j),ee=q.projection.name==="globe",re=[256/l.width*2+1,256/l.height*2+1],ce=f?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;ce.clear();let ae=null;ee&&(ae=f?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const de=h.lineVertexArray,ye=f?h.text.placedSymbolArray:h.icon.placedSymbolArray,fe=l.transform.width/l.transform.height;let Me,xe=!1;for(let Ce=0;Ce<ye.length;Ce++){const Te=ye.get(Ce),{numGlyphs:be,writingMode:De}=Te;if(De!==i.bK.vertical||xe||Me===i.bK.horizontal||(xe=!0),Me=De,(Te.hidden||De===i.bK.vertical)&&!xe){Ll(be,ce);continue}xe=!1;const He=new i.P(Te.tileAnchorX,Te.tileAnchorY),$e=h.elevationType==="road",st=!!q.elevation||$e;let{x:Qe,y:pt,z:Ft}=q.projection.projectTilePoint(He.x,He.y,B.canonical),Xe=null;if(st){const ur=$e?h.getElevationFeatureForText(Ce):null;Xe={getElevation:D,elevation:q.elevation,elevationFeature:ur};const[Dr,_n,Kr]=D(He,q.elevation,ur);Qe+=Dr,pt+=_n,Ft+=Kr}const je=[Qe,pt,Ft,1];if(i.aC(je,je,n),!Iu(je,re)){Ll(be,ce);continue}const dt=je[3],rt=sc(l.transform.getCameraToCenterDistance(q.projection),dt),Mt=i.bL(U,Y,Te),$t=E?Mt/rt:Mt*rt,fr=pi(Qe,pt,Ft,v);if(fr[3]<=0){Ll(be,ce);continue}let kt={};const Nt=i.an(h.layers[0].layout.get("text-max-angle")),mr=Math.cos(Nt),lr=E?null:Xe,Qt=rd(Te,$t,!1,M,n,v,w,h.glyphOffsetArray,de,ce,ae,fr,He,kt,fe,lr,q.projection,B,E,mr);xe=Qt.useVertical,lr&&Qt.needsFlipping&&(kt={}),(Qt.notEnoughRoom||xe||Qt.needsFlipping&&rd(Te,$t,!0,M,n,v,w,h.glyphOffsetArray,de,ce,ae,fr,He,kt,fe,lr,q.projection,B,E,mr).notEnoughRoom)&&Ll(be,ce)}f?(h.text.dynamicLayoutVertexBuffer.updateData(ce),ae&&h.text.globeExtVertexBuffer&&h.text.globeExtVertexBuffer.updateData(ae)):(h.icon.dynamicLayoutVertexBuffer.updateData(ce),ae&&h.icon.globeExtVertexBuffer&&h.icon.globeExtVertexBuffer.updateData(ae))}function zn(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce){const{lineStartIndex:ae,glyphStartIndex:de,segment:ye}=M,fe=de+M.numGlyphs,Me=ae+M.lineLength,xe=n.getoffsetX(de),Ce=n.getoffsetX(fe-1),Te=iu(h*xe,l,f,v,w,E,ye,ae,Me,D,B,j,q,U,!0,Y,ee,re,ce);if(!Te)return null;const be=iu(h*Ce,l,f,v,w,E,ye,ae,Me,D,B,j,q,U,!0,Y,ee,re,ce);return be?{first:Te,last:be}:null}function Mu(h,n,l,f){return h===i.bK.horizontal&&Math.abs(f)>Math.abs(l)?{useVertical:!0}:h===i.bK.vertical?f>0?{needsFlipping:!0}:null:n!==eo.unknown&&(function(v,w){return v===0||Math.abs(w/v)>Yo})(l,f)?n===eo.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function rd(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce,ae,de,ye){const fe=n/24,Me=h.lineOffsetX*fe,xe=h.lineOffsetY*fe,{lineStartIndex:Ce,glyphStartIndex:Te,numGlyphs:be,segment:De,writingMode:He,flipState:$e}=h,st=Ce+h.lineLength,Qe=pt=>{if(j){const[dt,rt,Mt]=pt.up,$t=B.length;i.bM(j,$t+0,dt,rt,Mt),i.bM(j,$t+1,dt,rt,Mt),i.bM(j,$t+2,dt,rt,Mt),i.bM(j,$t+3,dt,rt,Mt)}const[Ft,Xe,je]=pt.point;i.bN(B,Ft,Xe,je,pt.angle)};if(be>1){const pt=zn(fe,M,Me,xe,l,q,U,h,D,w,Y,re,!1,ce,ae,de,ye);if(!pt)return{notEnoughRoom:!0};if(f&&!l){let[Ft,Xe,je]=pt.first.point,[dt,rt,Mt]=pt.last.point;[Ft,Xe]=pi(Ft,Xe,je,E),[dt,rt]=pi(dt,rt,Mt,E);const $t=Mu(He,$e,(dt-Ft)*ee,rt-Xe);if(h.flipState=$t&&$t.needsFlipping?eo.flipRequired:eo.flipNotRequired,$t)return $t}Qe(pt.first);for(let Ft=Te+1;Ft<Te+be-1;Ft++){const Xe=iu(fe*M.getoffsetX(Ft),Me,xe,l,q,U,De,Ce,st,D,w,Y,re,!1,!1,ce,ae,de,ye);if(!Xe)return B.length-=4*(Ft-Te),{notEnoughRoom:!0};Qe(Xe)}Qe(pt.last)}else{if(f&&!l){const Ft=pi(U.x,U.y,0,v),Xe=Ce+De+1,je=new i.P(D.getx(Xe),D.gety(Xe)),dt=pi(je.x,je.y,0,v),rt=dt[3]>0?dt:Lr(U,je,Ft,1,v,void 0,ce,ae.canonical),Mt=Mu(He,$e,(rt[0]-Ft[0])*ee,rt[1]-Ft[1]);if(h.flipState=Mt&&Mt.needsFlipping?eo.flipRequired:eo.flipNotRequired,Mt)return Mt}const pt=iu(fe*M.getoffsetX(Te),Me,xe,l,q,U,De,Ce,st,D,w,Y,re,!1,!1,ce,ae,de,ye);if(!pt)return{notEnoughRoom:!0};Qe(pt)}return{}}function nu(h,n,l,f,v){const{x:w,y:E,z:M}=f.projectTilePoint(h.x,h.y,n);if(!v)return pi(w,E,M,l);const[D,B,j]=v.getElevation(h,v.elevation,v.elevationFeature);return pi(w+D,E+B,M+j,l)}function Lr(h,n,l,f,v,w,E,M){const D=nu(h.sub(n)._unit()._add(h),M,v,E,w);return i.av(D,l,D),i.aw(D,D),i.bG(D,l,D,f)}function iu(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce,ae,de){const ye=f?h-n:h+n;let fe=ye>0?1:-1,Me=0;f&&(fe*=-1,Me=Math.PI),fe<0&&(Me+=Math.PI);let xe=M+E+(fe>0?0:1)|0,Ce=v,Te=v,be=0,De=0;const He=Math.abs(ye),$e=[],st=[];let Qe=w,pt=Qe,Ft=i.bE([]);const Xe=()=>Lr(pt,Qe,Te,He-be+1,j,U,re,ce.canonical);for(;be+De<=He;){if(xe+=fe,xe<M||xe>=D)return null;if(Te=Ce,pt=Qe,$e.push(Te),Y&&st.push(pt),Qe=new i.P(B.getx(xe),B.gety(xe)),Ce=q[xe],!Ce){const lr=nu(Qe,ce.canonical,j,re,U);Ce=lr[3]>0?q[xe]=lr:Xe()}be+=De;const Nt=i.av([],Ce,Te),mr=i.bF(Te,Ce);if(l&&mr>0&&De>0&&i.bI(Ft,Nt)/(De*mr)<de)return null;De=mr,Ft=Nt}ee&&U&&(q[xe]&&(Ce=Xe(),De=i.bF(Te,Ce),Ft=i.av([],Ce,Te)),q[xe]=Ce);const je=(He-be)/De,dt=Qe.sub(pt)._mult(je)._add(pt),rt=i.bG([],Te,Ft,je);let Mt=[0,0,1],$t=Ft[0],fr=Ft[1];if(ae&&(Mt=re.upVector(ce.canonical,dt.x,dt.y),Mt[0]!==0||Mt[1]!==0||Mt[2]!==1)){const Nt=[Mt[2],0,-Mt[0]],mr=i.bH([],Mt,Nt);i.aw(Nt,Nt),i.aw(mr,mr),$t=i.bI(Ft,Nt),fr=i.bI(Ft,mr)}if(l){const Nt=i.bH([],Mt,Ft);i.aw(Nt,Nt),i.bG(rt,rt,Nt,l*fe)}const kt=Me+Math.atan2(fr,$t);return $e.push(rt),Y&&st.push(dt),{point:rt,angle:kt,path:$e,tilePath:st,up:Mt}}function Ll(h,n){const l=n.length,f=l+4*h;n.resize(f),n.float32.fill(-1/0,4*l,4*f)}function Ba(h,n,l){const f=n[0],v=n[1];return h[0]=l[0]*f+l[4]*v+l[12],h[1]=l[1]*f+l[5]*v+l[13],h[3]=l[3]*f+l[7]*v+l[15],h}const ja=100;class ac{constructor(n,l,f=new Oi(n.width+200,n.height+200,25),v=new Oi(n.width+200,n.height+200,25)){this.transform=n,this.grid=f,this.ignoredGrid=v,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+ja,this.screenBottomBoundary=n.height+ja,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=l}placeCollisionBox(n,l,f,v,w,E,M,D,B,j,q){let U=f.projectedAnchorX,Y=f.projectedAnchorY,ee=f.projectedAnchorZ;const re=f.tileAnchorX,ce=f.tileAnchorY,ae=f.elevation,de=f.tileID,ye=n.getProjection();if(ae&&de){const[st,Qe,pt]=ye.upVector(de.canonical,f.tileAnchorX,f.tileAnchorY),Ft=ye.upVectorScale(de.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;U+=st*ae*Ft,Y+=Qe*ae*Ft,ee+=pt*ae*Ft}const fe=n.projection.name==="globe",Me=n.projection.name==="globe"?i.aj(this.transform.zoom):0;if(de&&fe&&Me<1&&!E){const st=1<<de.canonical.z,Qe=i.bO(re,ce);i.bP(Qe,Qe,1/i.al),i.bQ(Qe,Qe,i.bO(de.canonical.x,de.canonical.y)),i.bP(Qe,Qe,1/st),i.bR(Qe,Qe,i.bO(v[0],v[1])),Qe[0]=i.bS(Qe[0],-.5,.5),i.bP(Qe,Qe,i.al);const pt=i.bT(Qe[0],Qe[1],i.al/(2*Math.PI),1);i.aC(pt,pt,w),U=i.ak(U,pt[0],Me),Y=i.ak(Y,pt[1],Me),ee=i.ak(ee,pt[2],Me)}const xe=this.projectAndGetPerspectiveRatio(j,U,Y,ee,f.tileID,ye.name==="globe"||!!ae||this.transform.pitch>0,ye),Ce=B*xe.perspectiveRatio,Te=(f.x1*l+M.x-f.padding)*Ce+xe.point.x,be=(f.y1*l+M.y-f.padding)*Ce+xe.point.y,De=(f.x2*l+M.x+f.padding)*Ce+xe.point.x,He=(f.y2*l+M.y+f.padding)*Ce+xe.point.y,$e=xe.perspectiveRatio<=.55||xe.occluded;return!this.isInsideGrid(Te,be,De,He)||!D&&this.grid.hitTest(Te,be,De,He,q)||$e?{box:[],offscreen:!1,occluded:xe.occluded}:{box:[Te,be,De,He],offscreen:this.isOffscreen(Te,be,De,He),occluded:!1}}placeCollisionCircles(n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce){const ae=[],de=this.transform.elevation,ye=n.getProjection(),fe=n.elevationType==="road",Me=!!de||fe,xe=i.bU.getAtTileOffsetFunc(ce,this.transform.center.lat,this.transform.worldSize,ye),Ce=new i.P(f.tileAnchorX,f.tileAnchorY),Te=new i.P(f.tileAnchorX,f.tileAnchorY);let{x:be,y:De,z:He}=ye.projectTilePoint(Te.x,Te.y,ce.canonical),$e=null;if(Me){const mr=fe?n.getElevationFeatureForText(v):null;$e={getElevation:xe,elevation:de,elevationFeature:mr};const[lr,Qt,ur]=xe(Ce,de,mr);be+=lr,De+=Qt,He+=ur}const st=ye.name==="globe",Qe=this.projectAndGetPerspectiveRatio(D,be,De,He,ce,st||!!de||this.transform.pitch>0,ye),{perspectiveRatio:pt}=Qe,Ft=(U?M/pt:M*pt)/i.bX,Xe=pi(be,De,He,B),je=f.lineOffsetX*Ft,dt=f.lineOffsetY*Ft,rt=i.an(n.layers[0].layout.get("text-max-angle")),Mt=Math.cos(rt),$t=Qe.signedDistanceFromCamera>0?zn(Ft,E,je,dt,fe&&f.flipState===1,Xe,Te,f,w,B,{},Me&&!U?$e:null,U&&Me,ye,ce,U,Mt):null;let fr=!1,kt=!1,Nt=!0;if($t&&!Qe.occluded){const mr=.5*ee*pt+re,lr=new i.P(-100,-100),Qt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),ur=new ai,{first:Dr,last:_n}=$t,Kr=Dr.path.length;let hi=[];for(let sn=Kr-1;sn>=1;sn--)hi.push(Dr.path[sn]);for(let sn=1;sn<_n.path.length;sn++)hi.push(_n.path[sn]);const Wr=2.5*mr;j&&(hi=hi.map((([sn,ti,Tn],vi)=>(Me&&!st&&(Tn=xe(vi<Kr-1?Dr.tilePath[Kr-1-vi]:_n.tilePath[vi-Kr+2],de,$e.elevationFeature)[2]),pi(sn,ti,Tn,j)))),hi.some((sn=>sn[3]<=0))&&(hi=[]));let Sn=[];if(hi.length>0){let sn=1/0,ti=-1/0,Tn=1/0,vi=-1/0;for(const yn of hi)sn=Math.min(sn,yn[0]),Tn=Math.min(Tn,yn[1]),ti=Math.max(ti,yn[0]),vi=Math.max(vi,yn[1]);ti>=lr.x&&sn<=Qt.x&&vi>=lr.y&&Tn<=Qt.y&&(Sn=[hi.map((yn=>new i.P(yn[0],yn[1])))],(sn<lr.x||ti>Qt.x||Tn<lr.y||vi>Qt.y)&&(Sn=i.bV(Sn,lr.x,lr.y,Qt.x,Qt.y)))}for(const sn of Sn){ur.reset(sn,.25*mr);let ti=0;ti=ur.length<=.5*mr?1:Math.ceil(ur.paddedLength/Wr)+1;for(let Tn=0;Tn<ti;Tn++){const vi=Tn/Math.max(ti-1,1),yn=ur.lerp(vi),nn=yn.x+ja,qn=yn.y+ja;ae.push(nn,qn,mr,0);const Jr=nn-mr,xi=qn-mr,Pn=nn+mr,qr=qn+mr;if(Nt=Nt&&this.isOffscreen(Jr,xi,Pn,qr),kt=kt||this.isInsideGrid(Jr,xi,Pn,qr),!l&&this.grid.hitTestCircle(nn,qn,mr,Y)&&(fr=!0,!q))return{circles:[],offscreen:!1,collisionDetected:fr,occluded:!1}}}}return{circles:!q&&fr||!kt?[]:ae,offscreen:Nt,collisionDetected:fr,occluded:Qe.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let f=1/0,v=1/0,w=-1/0,E=-1/0;for(const j of n){const q=new i.P(j.x+ja,j.y+ja);f=Math.min(f,q.x),v=Math.min(v,q.y),w=Math.max(w,q.x),E=Math.max(E,q.y),l.push(q)}const M=this.grid.query(f,v,w,E).concat(this.ignoredGrid.query(f,v,w,E)),D={},B={};for(const j of M){const q=j.key;if(D[q.bucketInstanceId]===void 0&&(D[q.bucketInstanceId]={}),D[q.bucketInstanceId][q.featureIndex])continue;const U=[new i.P(j.x1,j.y1),new i.P(j.x2,j.y1),new i.P(j.x2,j.y2),new i.P(j.x1,j.y2)];i.bW(l,U)&&(D[q.bucketInstanceId][q.featureIndex]=!0,B[q.bucketInstanceId]===void 0&&(B[q.bucketInstanceId]=[]),B[q.bucketInstanceId].push(q.featureIndex))}return B}insertCollisionBox(n,l,f,v,w){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:v,collisionGroupID:w},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,l,f,v,w){const E=l?this.ignoredGrid:this.grid,M={bucketInstanceId:f,featureIndex:v,collisionGroupID:w};for(let D=0;D<n.length;D+=4)E.insertCircle(M,n[D],n[D+1],n[D+2])}projectAndGetPerspectiveRatio(n,l,f,v,w,E,M){const D=[l,f,v,1];let B=!1;v||this.transform.pitch>0?(i.aC(D,D,n),this.fogState&&w&&M.name!=="globe"&&(B=(function(U,Y,ee,re,ce,ae){const de=ae.calculateFogTileMatrix(ce),ye=[Y,ee,re];return i.af(ye,ye,de),Ot(U,i.ag(ye),ae.pitch,ae._fov)})(this.fogState,l,f,v,w.toUnwrapped(),this.transform)>.9)):Ba(D,D,n);const j=D[3];return{point:new i.P((D[0]/j+1)/2*this.transform.width+ja,(-D[1]/j+1)/2*this.transform.height+ja),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/j*.5,1.5),signedDistanceFromCamera:j,occluded:E&&D[2]>j||B}}isOffscreen(n,l,f,v){return f<ja||n>=this.screenRightBoundary||v<ja||l>this.screenBottomBoundary}isInsideGrid(n,l,f,v){return f>=0&&n<this.gridRightBoundary&&v>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const n=i.bz([]);return i.bq(n,n,[-100,-100,0]),n}}class br{constructor(n,l,f,v){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?l:-l))):v&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class wn{constructor(n,l,f,v,w,E=!1){this.text=new br(n?n.text:null,l,f,w),this.icon=new br(n?n.icon:null,l,v,w),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Dn{constructor(n,l,f,v=!1){this.text=n,this.icon=l,this.skipFade=f,this.clipped=v}}class aa{constructor(){this.invProjMatrix=i.bB(),this.viewportMatrix=i.bB(),this.circles=[]}}class ou{constructor(n,l,f,v,w){this.bucketInstanceId=n,this.featureIndex=l,this.sourceLayerIndex=f,this.bucketIndex=v,this.tileID=w}}class Fn{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const l=++this.maxGroupID;this.collisionGroups[n]={ID:l,predicate:f=>f.collisionGroupID===l}}return this.collisionGroups[n]}}function Cu(h,n,l,f,v){const{horizontalAlign:w,verticalAlign:E}=i.c0(h),M=-(w-.5)*n,D=-(E-.5)*l,B=i.c1(h,f);return new i.P(M+B[0]*v,D+B[1]*v)}function Lc(h,n,l,f,v){const w=new i.P(h,n);return l&&w._rotate(f?v:-v),w}class Au{constructor(n,l,f,v,w,E){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new ac(this.transform,w),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Fn(f),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,l,f,v,w=1){const E=f.getBucket(l),M=f.latestFeatureIndex;if(!E||!M||l.fqid!==E.layerIds[0])return;const D=E.layers[0].layout,B=E.layers[0].paint,j=f.collisionBoxArray,q=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),U=f.tileSize/i.al,Y=f.tileID.toUnwrapped();this.transform.setProjection(E.projection);const ee=(re=f.tileID,ce=E.getProjection(),ae=this.transform,ce.name===this.projection?ae.calculateProjMatrix(re.toUnwrapped()):jn(ae,ce,re));var re,ce,ae;const de=D.get("text-pitch-alignment")==="map",ye=D.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const fe=l.dynamicFilter(),Me=l.dynamicFilterNeedsFeature(),xe=this.transform.calculatePixelsToTileUnitsMatrix(f),Ce=ka(ee,f.tileID.canonical,de,ye,this.transform,E.getProjection(),xe);let Te=null;const be=E.getProjection().createInversionMatrix(this.transform,f.tileID.canonical);if(de){const je=sa(ee,f.tileID.canonical,de,ye,this.transform,E.getProjection(),xe);Te=i.aB([],this.transform.labelPlaneMatrix,je)}let De=null;fe&&f.latestFeatureIndex&&(De={unwrappedTileID:Y,dynamicFilter:fe,dynamicFilterNeedsFeature:Me}),this.retainedQueryData[E.bucketInstanceId]=new ou(E.bucketInstanceId,M,E.sourceLayerIndex,E.index,f.tileID);const[He,$e]=E.layers[0].layout.get("text-size-scale-range"),st=i.aA(w,He,$e),[Qe,pt]=D.get("icon-size-scale-range"),Ft=i.aA(w,Qe,pt),Xe={bucket:E,layout:D,paint:B,posMatrix:ee,invMatrix:be,mercatorCenter:[i.aF(this.transform.center.lng),i.aJ(this.transform.center.lat)],textLabelPlaneMatrix:Ce,labelToScreenMatrix:Te,clippingData:De,scale:q,textPixelRatio:U,holdingForFade:f.holdingForFade(),collisionBoxArray:j,partiallyEvaluatedTextSize:i.bJ(E.textSizeData,this.transform.zoom,st),partiallyEvaluatedIconSize:i.bJ(E.iconSizeData,this.transform.zoom,Ft),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:f.latestFeatureIndex};if(v)for(const je of E.sortKeyRanges){const{sortKey:dt,symbolInstanceStart:rt,symbolInstanceEnd:Mt}=je;n.push({sortKey:dt,symbolInstanceStart:rt,symbolInstanceEnd:Mt,parameters:Xe})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Xe})}attemptAnchorPlacement(n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce,ae,de,ye,fe,Me){const{textOffset0:xe,textOffset1:Ce,crossTileID:Te}=re,be=[xe,Ce],De=Cu(n,E,M,be,D),He=this.collisionIndex.placeCollisionBox(ae,D,l,f,v,w,Lc(De.x,De.y,B,j,this.transform.angle),ee,q,U,Y.predicate);if(ye){const $e=ae.getSymbolInstanceIconSize(Me,this.transform.zoom,re.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ae,$e,ye,f,v,w,Lc(De.x,De.y,B,j,this.transform.angle),ee,q,U,Y.predicate).box.length===0)return}if(He.box.length>0){let $e;return this.prevPlacement&&this.prevPlacement.variableOffsets[Te]&&this.prevPlacement.placements[Te]&&this.prevPlacement.placements[Te].text&&($e=this.prevPlacement.variableOffsets[Te].anchor),this.variableOffsets[Te]={textOffset:be,width:E,height:M,anchor:n,textScale:D,prevAnchor:$e},this.markUsedJustification(ae,n,re,de),ae.allowVerticalPlacement&&(this.markUsedOrientation(ae,de,re),this.placedOrientations[Te]=de),{shift:De,placedGlyphBoxes:He}}}placeLayerBucketPart(n,l,f,v,w=1){const{bucket:E,layout:M,paint:D,posMatrix:B,textLabelPlaneMatrix:j,labelToScreenMatrix:q,clippingData:U,textPixelRatio:Y,mercatorCenter:ee,invMatrix:re,holdingForFade:ce,collisionBoxArray:ae,partiallyEvaluatedTextSize:de,partiallyEvaluatedIconSize:ye,collisionGroup:fe,latestFeatureIndex:Me}=n.parameters,xe=M.get("text-optional"),Ce=M.get("icon-optional"),Te=M.get("text-allow-overlap"),be=M.get("icon-allow-overlap"),De=M.get("text-rotation-alignment")==="map",He=M.get("icon-rotation-alignment")==="map",$e=M.get("text-pitch-alignment")==="map",st=D.get("symbol-z-offset"),Qe=M.get("symbol-elevation-reference")==="sea",pt=M.get("symbol-placement"),[Ft,Xe]=M.get("text-size-scale-range"),[je,dt]=M.get("icon-size-scale-range"),rt=i.aA(w,Ft,Xe),Mt=i.aA(w,je,dt),$t=M.get("text-variable-anchor"),fr=De&&pt!=="point",kt=He&&pt!=="point",Nt=$t&&E.hasTextData(),mr=E.hasIconTextFit()&&Nt&&E.hasIconData();this.transform.setProjection(E.projection);const lr=Nt||fr,Qt=kt||mr;let ur=Te&&(be||!E.hasIconData()||Ce),Dr=be&&(Te||!E.hasTextData()||xe);const _n=!st.isConstant();!E.collisionArrays&&ae&&E.deserializeCollisionBoxes(ae),f&&v&&E.updateCollisionDebugBuffers(this.transform.zoom,ae,rt,Mt);const Kr=(Wr,Sn,sn)=>{const{crossTileID:ti,numVerticalGlyphVertices:Tn}=Wr;let vi=null;if(U&&U.dynamicFilterNeedsFeature||_n){const Bi=this.retainedQueryData[E.bucketInstanceId];vi=Me.loadFeature({featureIndex:Wr.featureIndex,bucketIndex:Bi.bucketIndex,sourceLayerIndex:Bi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(U&&!(0,U.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch,worldview:E.worldview},vi,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new i.P(Wr.tileAnchorX,Wr.tileAnchorY),this.transform.calculateDistanceTileData(U.unwrappedTileID)))return this.placements[ti]=new Dn(!1,!1,!1,!0),void l.add(ti);const yn=st.evaluate(vi,{});if(l.has(ti))return;if(ce)return void(this.placements[ti]=new Dn(!1,!1,!1));let nn=!1,qn=!1,Jr=!0,xi=!1,Pn=!1,qr=null,En={box:null,offscreen:null,occluded:null},zi={box:null},_o=null,ki=null,so=null,Wa=0,Ca=0,ls=0;sn.textFeatureIndex?Wa=sn.textFeatureIndex:Wr.useRuntimeCollisionCircles&&(Wa=Wr.featureIndex),sn.verticalTextFeatureIndex&&(Ca=sn.verticalTextFeatureIndex);const vs=E.elevationFeatures?E.elevationFeatures[Wr.elevationFeatureIndex]:void 0,Sl=Bi=>{Bi.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const ao=this.transform.elevation;Bi.elevation=Qe?yn:yn+i.bU.getAtTileOffset(Bi.tileID,new i.P(Bi.tileAnchorX,Bi.tileAnchorY),ao,vs),Bi.elevation+=Wr.zOffset},xs=sn.textBox;if(xs){Sl(xs);const Bi=li=>{let yo=i.bK.horizontal;if(E.allowVerticalPlacement&&!li&&this.prevPlacement){const bs=this.prevPlacement.placedOrientations[ti];bs&&(this.placedOrientations[ti]=bs,yo=bs,this.markUsedOrientation(E,yo,Wr))}return yo},ao=(li,yo)=>{if(E.allowVerticalPlacement&&Tn>0&&sn.verticalTextBox){for(const bs of E.writingModes)if(bs===i.bK.vertical?(En=yo(),zi=En):En=li(),En&&En.box&&En.box.length)break}else En=li()};if($t){let li=$t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ti]){const ji=this.prevPlacement.variableOffsets[ti];li.indexOf(ji.anchor)>0&&(li=li.filter((Ql=>Ql!==ji.anchor)),li.unshift(ji.anchor))}const yo=(ji,Ql,vu)=>{const Gu=E.getSymbolInstanceTextSize(de,Wr,this.transform.zoom,Sn),Hu=(ji.x2-ji.x1)*Gu+2*ji.padding,_=(ji.y2-ji.y1)*Gu+2*ji.padding,S=Wr.hasIconTextFit&&!be?Ql:null;S&&Sl(S);let A={box:[],offscreen:!1,occluded:!1};const N=Te?2*li.length:li.length;for(let K=0;K<N;++K){const oe=this.attemptAnchorPlacement(li[K%li.length],ji,ee,re,lr,Hu,_,Gu,De,$e,Y,B,fe,K>=li.length,Wr,Sn,E,vu,S,de,ye);if(oe&&(A=oe.placedGlyphBoxes,A&&A.box&&A.box.length)){nn=!0,qr=oe.shift;break}}return A};ao((()=>yo(xs,sn.iconBox,i.bK.horizontal)),(()=>{const ji=sn.verticalTextBox;return ji&&Sl(ji),E.allowVerticalPlacement&&!(En&&En.box&&En.box.length)&&Tn>0&&ji?yo(ji,sn.verticalIconBox,i.bK.vertical):{box:null,offscreen:null,occluded:null}})),En&&(nn=En.box,Jr=En.offscreen,xi=En.occluded);const bs=Bi(!(!En||!En.box));if(!nn&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[ti];ji&&(this.variableOffsets[ti]=ji,this.markUsedJustification(E,ji.anchor,Wr,bs))}}else{const li=(yo,bs)=>{const ji=E.getSymbolInstanceTextSize(de,Wr,this.transform.zoom,Sn),Ql=this.collisionIndex.placeCollisionBox(E,ji,yo,ee,re,lr,new i.P(0,0),Te,Y,B,fe.predicate);return Ql&&Ql.box&&Ql.box.length&&(this.markUsedOrientation(E,bs,Wr),this.placedOrientations[ti]=bs),Ql};ao((()=>li(xs,i.bK.horizontal)),(()=>{const yo=sn.verticalTextBox;return E.allowVerticalPlacement&&Tn>0&&yo?(Sl(yo),li(yo,i.bK.vertical)):{box:null,offscreen:null,occluded:null}})),Bi(!!(En&&En.box&&En.box.length))}}if(_o=En,nn=_o&&_o.box&&_o.box.length>0,Jr=_o&&_o.offscreen,xi=_o&&_o.occluded,Wr.useRuntimeCollisionCircles){const Bi=Wr.centerJustifiedTextSymbolIndex>=0?Wr.centerJustifiedTextSymbolIndex:Wr.verticalPlacedTextSymbolIndex,ao=E.text.placedSymbolArray.get(Bi),li=i.bL(E.textSizeData,de,ao),yo=M.get("text-padding");ki=this.collisionIndex.placeCollisionCircles(E,Te,ao,Bi,E.lineVertexArray,E.glyphOffsetArray,li,B,j,q,f,$e,fe.predicate,Wr.collisionCircleDiameter*li/i.bX,yo,this.retainedQueryData[E.bucketInstanceId].tileID),nn=Te||ki.circles.length>0&&!ki.collisionDetected,Jr=Jr&&ki.offscreen,xi=ki.occluded}if(sn.iconFeatureIndex&&(ls=sn.iconFeatureIndex),sn.iconBox){const Bi=ao=>{Sl(ao);const li=Wr.hasIconTextFit&&qr?Lc(qr.x,qr.y,De,$e,this.transform.angle):new i.P(0,0),yo=E.getSymbolInstanceIconSize(ye,this.transform.zoom,Wr.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,yo,ao,ee,re,Qt,li,be,Y,B,fe.predicate)};zi&&zi.box&&zi.box.length&&sn.verticalIconBox?(so=Bi(sn.verticalIconBox),qn=so.box.length>0):(so=Bi(sn.iconBox),qn=so.box.length>0),Jr=Jr&&so.offscreen,Pn=so.occluded}const Xl=xe||Wr.numHorizontalGlyphVertices===0&&Tn===0,Kl=Ce||Wr.numIconVertices===0;if(Xl||Kl?Kl?Xl||(qn=qn&&nn):nn=qn&&nn:qn=nn=qn&&nn,nn&&_o&&_o.box&&this.collisionIndex.insertCollisionBox(_o.box,M.get("text-ignore-placement"),E.bucketInstanceId,zi&&zi.box&&Ca?Ca:Wa,fe.ID),qn&&so&&this.collisionIndex.insertCollisionBox(so.box,M.get("icon-ignore-placement"),E.bucketInstanceId,ls,fe.ID),ki&&(nn&&this.collisionIndex.insertCollisionCircles(ki.circles,M.get("text-ignore-placement"),E.bucketInstanceId,Wa,fe.ID),f)){const Bi=E.bucketInstanceId;let ao=this.collisionCircleArrays[Bi];ao===void 0&&(ao=this.collisionCircleArrays[Bi]=new aa);for(let li=0;li<ki.circles.length;li+=4)ao.circles.push(ki.circles[li+0]),ao.circles.push(ki.circles[li+1]),ao.circles.push(ki.circles[li+2]),ao.circles.push(ki.collisionDetected?1:0)}const is=E.projection.name!=="globe";ur=ur&&(is||!xi),Dr=Dr&&(is||!Pn),this.placements[ti]=new Dn(nn||ur,qn||Dr,Jr||E.justReloaded),l.add(ti)},hi=this.retainedQueryData[E.bucketInstanceId].tileID;if(E.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(E,hi),E.elevationType==="road"&&E.updateRoadElevation(hi.canonical),E.updateZOffset(),E.sortFeaturesByY){const Wr=E.getSortedSymbolIndexes(this.transform.angle);for(let Sn=Wr.length-1;Sn>=0;--Sn){const sn=Wr[Sn];Kr(E.symbolInstances.get(sn),sn,E.collisionArrays[sn])}E.hasAnyZOffset&&i.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const Wr=E.getSortedIndexesByZOffset();for(let Sn=0;Sn<Wr.length;++Sn){const sn=Wr[Sn];Kr(E.symbolInstances.get(sn),sn,E.collisionArrays[sn])}}else for(let Wr=n.symbolInstanceStart;Wr<n.symbolInstanceEnd;Wr++)Kr(E.symbolInstances.get(Wr),Wr,E.collisionArrays[Wr]);if(f&&E.bucketInstanceId in this.collisionCircleArrays){const Wr=this.collisionCircleArrays[E.bucketInstanceId];i.bk(Wr.invProjMatrix,B),Wr.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(n,l,f,v){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:D,crossTileID:B}=f,j=i.c2(l),q=v===i.bK.vertical?D:j==="left"?w:j==="center"?E:j==="right"?M:-1;w>=0&&(n.text.placedSymbolArray.get(w).crossTileID=q>=0&&w!==q?0:B),E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=q>=0&&E!==q?0:B),M>=0&&(n.text.placedSymbolArray.get(M).crossTileID=q>=0&&M!==q?0:B),D>=0&&(n.text.placedSymbolArray.get(D).crossTileID=q>=0&&D!==q?0:B)}markUsedOrientation(n,l,f){const v=l===i.bK.horizontal||l===i.bK.horizontalOnly?l:0,w=l===i.bK.vertical?l:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:B}=f,j=n.text.placedSymbolArray;E>=0&&(j.get(E).placedOrientation=v),M>=0&&(j.get(M).placedOrientation=v),D>=0&&(j.get(D).placedOrientation=v),B>=0&&(j.get(B).placedOrientation=w)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let f=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const v=l?l.symbolFadeChange(n):1,w=l?l.opacities:{},E=l?l.variableOffsets:{},M=l?l.placedOrientations:{};for(const D in this.placements){const B=this.placements[D],j=w[D];j?(this.opacities[D]=new wn(j,v,B.text,B.icon,null,B.clipped),f=f||B.text!==j.text.placed||B.icon!==j.icon.placed):(this.opacities[D]=new wn(null,v,B.text,B.icon,B.skipFade,B.clipped),f=f||B.text||B.icon)}for(const D in w){const B=w[D];if(!this.opacities[D]){const j=new wn(B,v,!1,!1);j.isHidden()||(this.opacities[D]=j,f=f||B.text.placed||B.icon.placed)}}for(const D in E)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=E[D]);for(const D in M)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=M[D]);f?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:n)}updateLayerOpacities(n,l,f,v){const w=new Set;for(const E of l){const M=E.getBucket(n);M&&E.latestFeatureIndex&&n.fqid===M.layerIds[0]&&(this.updateBucketOpacities(M,w,E,E.collisionBoxArray,f,v,E.tileID,n.scope),M.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(M,E.tileID),M.elevationType==="road"&&M.updateRoadElevation(E.tileID.canonical),M.updateZOffset())}}updateBucketOpacities(n,l,f,v,w,E,M,D){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const B=n.layers[0].layout,j=n.layers[0].paint,q=!!n.layers[0].dynamicFilter(),U=new wn(null,0,!1,!1,!0),Y=B.get("text-allow-overlap"),ee=B.get("icon-allow-overlap"),re=B.get("text-variable-anchor"),ce=B.get("text-rotation-alignment")==="map",ae=B.get("text-pitch-alignment")==="map",de=j.get("symbol-z-offset"),ye=B.get("symbol-elevation-reference")==="sea",fe=!de.isConstant(),Me=new wn(null,0,Y&&(ee||!n.hasIconData()||B.get("icon-optional")),ee&&(Y||!n.hasTextData()||B.get("text-optional")),!0);!n.collisionArrays&&v&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(v);const xe=(Te,be,De)=>{for(let He=0;He<be/4;He++)Te.opacityVertexArray.emplaceBack(De)};let Ce=0;E&&n.updateReplacement(M,E);for(let Te=0;Te<n.symbolInstances.length;Te++){const be=n.symbolInstances.get(Te),{numHorizontalGlyphVertices:De,numVerticalGlyphVertices:He,crossTileID:$e,numIconVertices:st,tileAnchorX:Qe,tileAnchorY:pt}=be;let Ft=null;const Xe=this.retainedQueryData[n.bucketInstanceId];fe&&be&&Xe&&(Ft=f.latestFeatureIndex.loadFeature({featureIndex:be.featureIndex,bucketIndex:Xe.bucketIndex,sourceLayerIndex:Xe.sourceLayerIndex,layoutVertexArrayOffset:0}));const je=de.evaluate(Ft,{}),dt=l.has($e);let rt=this.opacities[$e];dt?rt=U:rt||(rt=Me,this.opacities[$e]=rt),l.add($e);const Mt=De>0||He>0,$t=st>0,fr=this.placedOrientations[$e],kt=fr===i.bK.vertical,Nt=fr===i.bK.horizontal||fr===i.bK.horizontalOnly;!Mt&&!$t||rt.isHidden()||Ce++;let mr=!1;if((Mt||$t)&&E)for(const lr of n.activeReplacements){if(i.bY(lr,w,i.bZ.Symbol,D)||lr.min.x>Qe||Qe>lr.max.x||lr.min.y>pt||pt>lr.max.y)continue;const Qt=i.b_(Qe,pt,M.canonical,lr.footprintTileId.canonical);if(mr=i.b$(Qt,lr.footprint),mr)break}if(Mt){const lr=mr?No:Ru(rt.text);xe(n.text,De,kt?No:lr),xe(n.text,He,Nt?No:lr);const Qt=rt.text.isHidden(),{leftJustifiedTextSymbolIndex:ur,centerJustifiedTextSymbolIndex:Dr,rightJustifiedTextSymbolIndex:_n,verticalPlacedTextSymbolIndex:Kr}=be,hi=n.text.placedSymbolArray,Wr=Qt||kt?1:0;ur>=0&&(hi.get(ur).hidden=Wr),Dr>=0&&(hi.get(Dr).hidden=Wr),_n>=0&&(hi.get(_n).hidden=Wr),Kr>=0&&(hi.get(Kr).hidden=Qt||Nt?1:0);const Sn=this.variableOffsets[$e];Sn&&this.markUsedJustification(n,Sn.anchor,be,fr);const sn=this.placedOrientations[$e];sn&&(this.markUsedJustification(n,"left",be,sn),this.markUsedOrientation(n,sn,be))}if($t){const lr=mr?No:Ru(rt.icon),{placedIconSymbolIndex:Qt,verticalPlacedIconSymbolIndex:ur}=be,Dr=n.icon.placedSymbolArray,_n=rt.icon.isHidden()?1:0;Qt>=0&&(xe(n.icon,st,kt?No:lr),Dr.get(Qt).hidden=_n),ur>=0&&(xe(n.icon,be.numVerticalIconVertices,Nt?No:lr),Dr.get(ur).hidden=_n)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const lr=n.collisionArrays[Te];if(lr){let Qt=new i.P(0,0),ur=!0;if(lr.textBox||lr.verticalTextBox){if(re){const _n=this.variableOffsets[$e];_n?(Qt=Cu(_n.anchor,_n.width,_n.height,_n.textOffset,_n.textScale),ce&&Qt._rotate(ae?this.transform.angle:-this.transform.angle)):ur=!1}q&&(ur=!rt.clipped),lr.textBox&&Zo(n.textCollisionBox.collisionVertexArray,rt.text.placed,!ur||kt,je,ye,Qt.x,Qt.y),lr.verticalTextBox&&Zo(n.textCollisionBox.collisionVertexArray,rt.text.placed,!ur||Nt,je,ye,Qt.x,Qt.y)}const Dr=ur&&!!(!Nt&&lr.verticalIconBox);lr.iconBox&&Zo(n.iconCollisionBox.collisionVertexArray,rt.icon.placed,Dr,je,ye,be.hasIconTextFit?Qt.x:0,be.hasIconTextFit?Qt.y:0),lr.verticalIconBox&&Zo(n.iconCollisionBox.collisionVertexArray,rt.icon.placed,!Dr,je,ye,be.hasIconTextFit?Qt.x:0,be.hasIconTextFit?Qt.y:0)}}}if(n.fullyClipped=Ce===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const Te=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Te.invProjMatrix,n.placementViewportMatrix=Te.viewportMatrix,n.collisionCircleArray=Te.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,l){const f=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*f>n}setStale(){this.stale=!0}}function Zo(h,n,l,f,v,w,E){h.emplaceBack(n?1:0,l?1:0,w||0,E||0,f,v?1:0),h.emplaceBack(n?1:0,l?1:0,w||0,E||0,f,v?1:0),h.emplaceBack(n?1:0,l?1:0,w||0,E||0,f,v?1:0),h.emplaceBack(n?1:0,l?1:0,w||0,E||0,f,v?1:0)}const ho=Math.pow(2,25),Bf=Math.pow(2,24),Du=Math.pow(2,17),zd=Math.pow(2,16),su=Math.pow(2,9),nd=Math.pow(2,8),Fd=Math.pow(2,1);function Ru(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const n=h.placed?1:0,l=Math.floor(127*h.opacity);return l*ho+n*Bf+l*Du+n*zd+l*su+n*nd+l*Fd+n}const No=0;class zl{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,l,f,v,w,E){const M=this._bucketParts;for(;this._currentTileIndex<n.length;)if(l.getBucketParts(M,v,n[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort(((D,B)=>D.sortKey-B.sortKey)));this._currentPartIndex<M.length;){const D=M[this._currentPartIndex];if(l.placeLayerBucketPart(D,this._seenCrossTileIDs,f,D.symbolInstanceStart===0,E),this._currentPartIndex++,w())return!0}return!1}}class Gs{constructor(n,l,f,v,w,E,M,D,B){this.placement=new Au(n,w,E,M,D,B),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(n,l,f,v,w){const E=i.o.now(),M=()=>{const D=i.o.now()-E;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=l[n[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=B)&&(!D.maxzoom||D.maxzoom>B)){const j=D,q=j.layout.get("symbol-z-elevate"),U=j.layout.get("symbol-sort-key").constantOr(1)!==void 0,Y=j.layout.get("symbol-z-order"),ee=Y==="viewport-y"||Y==="auto"&&!(Y!=="viewport-y"&&U),re=j.layout.get("text-allow-overlap")||j.layout.get("icon-allow-overlap")||j.layout.get("text-ignore-placement")||j.layout.get("icon-ignore-placement"),ce=ee&&re,ae=this._inProgressLayer=this._inProgressLayer||new zl(j),de=i.B(D.source,D.scope);if(ae.continuePlacement(q||ce?v[de]:f[de],this.placement,this._showCollisionBoxes,D,M,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const id=512/i.al/2;class lc{constructor(n,l,f){this.tileID=n,this.bucketInstanceId=f,this.index=new i.c3(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const v=n.canonical.x*i.al,w=n.canonical.y*i.al;for(let E=0;E<l.length;E++){const{key:M,crossTileID:D,tileAnchorX:B,tileAnchorY:j}=l.get(E),q=Math.floor((v+B)*id),U=Math.floor((w+j)*id);this.index.add(q,U),this.keys.push(M),this.crossTileIDs.push(D)}this.index.finish()}findMatches(n,l,f){const v=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),w=id/Math.pow(2,l.canonical.z-this.tileID.canonical.z),E=l.canonical.x*i.al,M=l.canonical.y*i.al;for(let D=0;D<n.length;D++){const B=n.get(D);if(B.crossTileID)continue;const{key:j,tileAnchorX:q,tileAnchorY:U}=B,Y=Math.floor((E+q)*w),ee=Math.floor((M+U)*w),re=this.index.range(Y-v,ee-v,Y+v,ee+v).sort(((ce,ae)=>ce-ae));for(const ce of re){const ae=this.crossTileIDs[ce];if(this.keys[ce]===j&&!f.has(ae)){f.add(ae),B.crossTileID=ae;break}}}}}class fo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class fl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const l=Math.round((n-this.lng)/360);if(l!==0)for(const f in this.indexes){const v=this.indexes[f],w={};for(const E in v){const M=v[E];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+l),w[M.tileID.key]=M}this.indexes[f]=w}this.lng=n}addBucket(n,l,f){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let w=0;w<l.symbolInstances.length;w++)l.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const v=this.usedCrossTileIDs[n.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>n.overscaledZ)for(const M in E){const D=E[M];D.tileID.isChildOf(n)&&D.findMatches(l.symbolInstances,n,v)}else{const M=E[n.scaledTo(Number(w)).key];M&&M.findMatches(l.symbolInstances,n,v)}}for(let w=0;w<l.symbolInstances.length;w++){const E=l.symbolInstances.get(w);E.crossTileID||(E.crossTileID=f.generate(),v.add(E.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new lc(n,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(n,l){for(const f of l.crossTileIDs)this.usedCrossTileIDs[n].delete(f)}removeStaleBuckets(n){let l=!1;for(const f in this.indexes){const v=this.indexes[f];for(const w in v)n[v[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,v[w]),delete v[w],l=!0)}return l}}class pl{constructor(){this.layerIndexes={},this.crossTileIDs=new fo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,l,f,v){let w=this.layerIndexes[n.fqid];w===void 0&&(w=this.layerIndexes[n.fqid]=new fl);let E=!1;const M={};v.name!=="globe"&&w.handleWrapJump(f);for(const D of l){const B=D.getBucket(n);B&&n.fqid===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(D.tileID,B,this.crossTileIDs)&&(E=!0),M[B.bucketInstanceId]=!0)}return w.removeStaleBuckets(M)&&(E=!0),E}pruneUnusedLayers(n){const l={};n.forEach((f=>{l[f]=!0}));for(const f in this.layerIndexes)l[f]||delete this.layerIndexes[f]}}const Xi=771;class en{constructor(n,l,f,v){this.blendFunction=n,this.blendColor=l.toNonPremultipliedRenderColor(null),this.mask=f,this.blendEquation=v}}en.Replace=[1,0,1,0],en.disabled=new en(en.Replace,i.ao.transparent,[!1,!1,!1,!1]),en.unblended=new en(en.Replace,i.ao.transparent,[!0,!0,!0,!0]),en.alphaBlended=new en([1,Xi,1,Xi],i.ao.transparent,[!0,!0,!0,!0]),en.alphaBlendedNonPremultiplied=new en([770,Xi,770,Xi],i.ao.transparent,[!0,!0,!0,!0]),en.multiply=new en([774,0,774,0],i.ao.transparent,[!0,!0,!0,!0]),en.additive=new en([1,1,1,1],i.ao.transparent,[!0,!0,!0,!0]);class pr{constructor(n,l,f){this.func=n,this.mask=l,this.range=f}}pr.ReadOnly=!1,pr.ReadWrite=!0,pr.disabled=new pr(519,pr.ReadOnly,[0,1]);const cc=7680;class Nr{constructor(n,l,f,v,w,E){this.test=n,this.ref=l,this.mask=f,this.fail=v,this.depthFail=w,this.pass=E}}Nr.disabled=new Nr({func:519,mask:0},0,0,cc,cc,cc);const au=1029,od=2305;class Vr{constructor(n,l,f){this.enable=n,this.mode=l,this.frontFace=f}}function lu(h,n){const l=i.c9(h,3);i.cb(h,n),i.cf(h,3,l)}function Ou(h,n){const l=i.c6([]);return i.c7(l,l,-n),i.c8(l,l,-h),l}function cu(h,n){const l=[h[0],h[1],0],f=[n[0],n[1],0];if(i.ag(l)>=1e-15){const E=i.aw([],l);i.c4(f,E,i.bI(f,E)),n[0]=f[0],n[1]=f[1]}const v=i.bH([],n,h);if(i.c5(v)<1e-15)return null;const w=Math.atan2(-v[1],v[0]);return Ou(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),w)}Vr.disabled=new Vr(!1,au,od),Vr.backCCW=new Vr(!0,au,od),Vr.backCW=new Vr(!0,au,2304),Vr.frontCW=new Vr(!0,1028,2304),Vr.frontCCW=new Vr(!0,1028,od);class la{constructor(n,l){this.position=n,this.orientation=l}get position(){return this._position}set position(n){if(n){const l=n instanceof i.ae?n:new i.ae(n[0],n[1],n[2]);this._renderWorldCopies&&(l.x=i.bS(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(n,l,f){if(this.orientation=null,!this.position)return;const v=this.position,w=f||(this._elevation?this._elevation.getAtPointOrZero(i.ae.fromLngLat(n)):0),E=i.ae.fromLngLat(n,w),M=[E.x-v.x,E.y-v.y,E.z-v.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=cu(M,l)}setPitchBearing(n,l){this.orientation=Ou(i.an(n),i.an(-l))}}class sd{constructor(n,l){this._transform=i.bz([]),this.orientation=l,this.position=n}get mercatorPosition(){const n=this.position;return new i.ae(n[0],n[1],n[2])}get position(){const n=i.c9(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var l;n&&i.cf(this._transform,3,[(l=n)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||i.c6([]),n&&lu(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,l){this._orientation=Ou(n,l),lu(this._transform,this._orientation)}forward(){const n=i.c9(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=i.c9(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=i.c9(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,l){const f=new Float64Array(16);return i.bk(f,this.getWorldToCamera(n,l)),f}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(n,l,f){const v=this.position;i.c4(v,v,-n);const w=new Float64Array(16);return i.bp(w,[f,f,f]),i.bq(w,w,v),w[10]*=l,w}getWorldToCamera(n,l){const f=new Float64Array(16),v=new Float64Array(4),w=this.position;return i.ca(v,this._orientation),i.c4(w,w,-n),i.cb(f,v),i.bq(f,f,w),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=l,f[9]*=l,f[10]*=l,f[11]*=l,f}getCameraToClipPerspective(n,l,f,v){const w=new Float64Array(16);return i.cc(w,n,l,f,v),w}getCameraToClipOrthographic(n,l,f,v,w,E){const M=new Float64Array(16);return i.cd(M,n,l,f,v,w,E),M}getDistanceToElevation(n,l=!1){const f=n===0?0:i.ce(n,l?i.a_(this.position[1]):this.position[1]),v=this.forward();return(f-this.position[2])/v[2]}clone(){return new sd([...this.position],[...this.orientation])}}const Eo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class gs{constructor(n=0,l=0,f=0,v=0){if(isNaN(n)||n<0||isNaN(l)||l<0||isNaN(f)||f<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=l,this.left=f,this.right=v}interpolate(n,l,f){return l.top!=null&&n.top!=null&&(this.top=i.ak(n.top,l.top,f)),l.bottom!=null&&n.bottom!=null&&(this.bottom=i.ak(n.bottom,l.bottom,f)),l.left!=null&&n.left!=null&&(this.left=i.ak(n.left,l.left,f)),l.right!=null&&n.right!=null&&(this.right=i.ak(n.right,l.right,f)),this}getCenter(n,l){const f=i.aA((this.left+n-this.right)/2,0,n),v=i.aA((this.top+l-this.bottom)/2,0,l);return new i.P(f,v)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new gs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const uc=15;class dc{constructor(n,l,f,v,w,E,M){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=n||0,this._maxZoom=l||22,this._minPitch=f??0,this._maxPitch=v??60,this.setProjection(E),this.setMaxBounds(M),this.width=0,this.height=0,this._center=new i.aS(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new gs,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new sd,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const n=new dc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n._allowWorldUnderZoom=this._allowWorldUnderZoom,n}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<uc}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(n,l=!1){const f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||f)&&this._updateCameraOnTerrain(),(n||f)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return i.aH(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=i.cl(this.projectionOptions);const f=this.getProjection(),v=!i.bx(l,f);return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setOrthographicProjectionAtLowPitch(n){return this._orthographicProjectionAtLowPitch!==n&&(this._orthographicProjectionAtLowPitch=n,this._calcMatrices(),!0)}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.cl({name:"mercator"});const l=n!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.ce(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bS(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const l=-n*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=i.cm(),i.cn(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const l=i.aA(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=i.an(n),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const l=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(n){this._tileCoverLift!==n&&(this._tileCoverLift=n)}_updateCameraOnTerrain(){const n=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&n===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||n===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const f=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&f.exaggeration()&&this._centerAltitudeValidForExaggeration!==f.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*f.exaggeration(),this._centerAltitudeValidForExaggeration=f.exaggeration()):(this._centerAltitude=n||0,this._centerAltitudeValidForExaggeration=f.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const n=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(n)}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop();let v=0,w=0;for(let E=0;E<l.length;E++){const M=new i.P(l[E][0]*this.width,f+l[E][1]*(this.height-f)),D=n.pointCoordinate(M);if(!D)continue;const B=1/Math.hypot(D[0]-this._camera.position[0],D[1]-this._camera.position[1]);v+=D[3]*B,w+=B}return w===0?NaN:v/w}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=this.pixelsPerMeter/this.worldSize*l,v=this._mercatorZfromZoom(n),w=this._mercatorZfromZoom(this._maxZoom),E=Math.max(v-f,w);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let f;f=n.z<this._camera.position[2]?[l.x,l.y,l.z]:[n.x,n.y,n.z];const v=i.ag(i.av([],this._camera.position,f));return i.aA(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let l=!1;if(n.orientation&&!i.co(n.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(n.orientation)),n.position){const f=[n.position.x,n.position.y,n.position.z];i.cp(f,this._camera.position)||(this._setCameraPosition(f),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,l=new la;return l.position=new i.ae(n[0],n[1],n[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(n){if(!i.cq(n))return!1;i.cr(n,n);const l=i.cs([],[0,0,-1],n),f=i.cs([],[0,-1,0],n);if(f[2]<0)return!1;const v=cu(l,f);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(n){const l=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;n[2]=i.aA(n[2],v/f,v/l),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,l,f){this._unmodified=!1,this._edgeInsets.interpolate(n,l,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const l=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(n){const l=[new i.ct(0,n)];if(this.renderWorldCopies){const f=this.pointCoordinate(new i.P(0,0)),v=this.pointCoordinate(new i.P(this.width,0)),w=this.pointCoordinate(new i.P(this.width,this.height)),E=this.pointCoordinate(new i.P(0,this.height)),M=Math.floor(Math.min(f.x,v.x,w.x,E.x)),D=Math.floor(Math.max(f.x,v.x,w.x,E.x)),B=1;for(let j=M-B;j<=D+B;j++)j!==0&&l.push(new i.ct(j,n))}return l}isLODDisabled(n){return(!n||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(n,l,f){let v=[];const w=f!=null,E=!w;if(E&&this.zoom<l||w&&f[0]===0&&f[1]===0)return v;const M=new Set,D=(j,q,U,Y,ee)=>{const re=i.cX(q,j,U,Y,ee);M.has(re)||(v.push(new i.aP(j,q,U,Y,ee)),M.add(re))};for(let j=0;j<n.length;j++){const q=n[j];if(E&&q.canonical.z!==l)continue;const U=q.canonical,Y=q.overscaledZ,ee=q.wrap,re=1<<U.z,ce=U.x+1<re,ae=U.x>0,de=U.y+1<re,ye=U.y>0,fe=q.wrap-(ae?0:1),Me=q.wrap+(ce?0:1),xe=ae?U.x-1:re-1,Ce=ce?U.x+1:0;if(w)f[0]<0?(D(Y,Me,U.z,Ce,U.y),f[1]<0&&de&&(D(Y,ee,U.z,U.x,U.y+1),D(Y,Me,U.z,Ce,U.y+1)),f[1]>0&&ye&&(D(Y,ee,U.z,U.x,U.y-1),D(Y,Me,U.z,Ce,U.y-1))):f[0]>0?(D(Y,fe,U.z,xe,U.y),f[1]<0&&de&&(D(Y,ee,U.z,U.x,U.y+1),D(Y,fe,U.z,xe,U.y+1)),f[1]>0&&ye&&(D(Y,ee,U.z,U.x,U.y-1),D(Y,fe,U.z,xe,U.y-1))):f[1]<0&&de?D(Y,ee,U.z,U.x,U.y+1):ye&&D(Y,ee,U.z,U.x,U.y-1);else{const Te=q.visibleQuadrants;1&Te&&(D(Y,fe,U.z,xe,U.y),ye&&(D(Y,ee,U.z,U.x,U.y-1),D(Y,fe,U.z,xe,U.y-1))),2&Te&&(D(Y,Me,U.z,Ce,U.y),ye&&(D(Y,ee,U.z,U.x,U.y-1),D(Y,Me,U.z,Ce,U.y-1))),4&Te&&(D(Y,fe,U.z,xe,U.y),de&&(D(Y,ee,U.z,U.x,U.y+1),D(Y,fe,U.z,xe,U.y+1))),8&Te&&(D(Y,Me,U.z,Ce,U.y),de&&(D(Y,ee,U.z,U.x,U.y+1),D(Y,Me,U.z,Ce,U.y+1)))}}const B=[];for(const j of v)v.some((q=>j.isChildOf(q)))||B.push(j);if(v=B.filter((j=>!n.some((q=>!!(j.overscaledZ<l&&q.isChildOf(j))||j.equals(q)||j.isChildOf(q))))),E){const j=1<<l,q=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),U=[j*q.x,j*q.y],Y=4,ee=Y*Y;v=v.filter((re=>{const ce=re.canonical.x+.5-U[0],ae=re.canonical.y+.5-U[1];return ce*ce+ae*ae<ee}))}return v}extendTileCoverToNearPlane(n,l,f){const v=[],w=new Set;for(const de of n)w.add(de.key);const E=(de,ye,fe,Me,xe)=>{const Ce=i.cX(ye,de,fe,Me,xe);w.has(Ce)||(v.push(new i.aP(de,ye,fe,Me,xe)),w.add(Ce))},M=n.reduce(((de,ye)=>Math.max(de,ye.overscaledZ)),f),D=1<<f,B=[new i.P(0,0),new i.P(i.al,0),new i.P(i.al,i.al),new i.P(0,i.al)],j=new i.P(0,0),q=new i.P(0,0),U=(de,ye)=>{const fe=Math.floor(de[0]),Me=Math.floor(de[1]),xe=(de[0]-fe)*i.al,Ce=(de[1]-Me)*i.al,Te=Math.floor(ye[0]),be=Math.floor(ye[1]),De=(ye[0]-Te)*i.al,He=(ye[1]-be)*i.al;for(let $e=-1;$e<=1;$e++){const st=fe+$e;if(!(st<0||st>=D)){j.x=xe-$e*i.al,q.x=De-(st-Te)*i.al;for(let Qe=-1;Qe<=1;Qe++){const pt=Me+Qe;j.y=Ce-Qe*i.al,q.y=He-(pt-be)*i.al,i.cY(j,q,B)&&E(M,0,f,st,pt)}}}},Y=l.points,ee=Y[i.cu],re=Y[i.cv],ce=this._projectToGround(ee,Y[i.cw]),ae=this._projectToGround(re,Y[i.cx]);return U(ee,ce),U(re,ae),v}_projectToGround(n,l){return i.cy(i.cz(),n,l,n[2]/(n[2]-l[2]))}coveringTiles(n){let l=this.coveringZoomLevel(n);const f=l,v=this.elevation&&this.elevation.exaggeration(),w=v&&!n.isTerrainDEM,E=this.projection.name==="mercator";if(n.minzoom!==void 0&&l<n.minzoom)return[];n.maxzoom!==void 0&&l>n.maxzoom&&(l=n.maxzoom);const M=this.locationCoordinate(this.center),D=this.center.lat,B=1<<l,j=[B*M.x,B*M.y,0],q=this.projection.name==="globe",U=!q,Y=i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,U),ee=q?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),re=B*i.ce(1,this.center.lat),ce=this._camera.position[2]/i.ce(1,this.center.lat),ae=[B*ee.x,B*ee.y,ce*(U?1:re)],de=q||v,ye=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),fe=this.isLODDisabled(!0)?l:0;let Me;if(this._elevation&&n.isTerrainDEM)Me=1e4*this._elevation.exaggeration();else if(this._elevation){const je=this._elevation.getMinMaxForVisibleTiles();Me=je?je.max:this._centerAltitude}else Me=this._centerAltitude;const xe=n.isTerrainDEM?-Me:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ce=this.projection.isReprojectedInTileSpace?i.cB(this):1,Te=je=>{const rt=new i.ae(je.x+25e-6,je.y,je.z),Mt=new i.ae(je.x,je.y+25e-6,je.z),$t=je.toLngLat(),fr=rt.toLngLat(),kt=Mt.toLngLat(),Nt=this.locationCoordinate($t),mr=this.locationCoordinate(fr),lr=this.locationCoordinate(kt),Qt=Math.hypot(mr.x-Nt.x,mr.y-Nt.y),ur=Math.hypot(lr.x-Nt.x,lr.y-Nt.y);return Math.sqrt(Qt*ur)*Ce/25e-6},be=je=>{const dt=Me,rt=xe;return{aabb:i.cE(this,B,0,0,0,je,rt,dt,this.projection),zoom:0,x:0,y:0,minZ:rt,maxZ:dt,wrap:je,fullyVisible:!1}},De=[];let He=[];const $e=l,st=n.reparseOverscaled?f:l,Qe=(ce-this._centerAltitude)*re,pt=je=>{if(!this._elevation||!je.tileID||!E)return;const dt=this._elevation.getMinMaxForTile(je.tileID),rt=je.aabb;dt?(rt.min[2]=dt.min,rt.max[2]=dt.max,rt.center[2]=(rt.min[2]+rt.max[2])/2):(je.shouldSplit=Xe(je),je.shouldSplit||(rt.min[2]=rt.max[2]=rt.center[2]=this._centerAltitude))},Ft=(je,dt)=>{if(.707*dt<je)return 1;const rt=dt/je;return rt/(1.4144271570014144+(Math.pow(1.1,rt-1.4144271570014144+1)-1)/(1.1-1)-1)},Xe=je=>{if(je.zoom<fe)return!0;if(je.zoom===$e)return!1;if(je.shouldSplit!=null)return je.shouldSplit;const dt=je.aabb.distanceX(ae),rt=je.aabb.distanceY(ae);let Mt=Qe,$t=1;if(q){Mt=je.aabb.distanceZ(ae);const ur=Math.pow(2,je.zoom),Dr=i.a_((je.y+1)/ur),_n=i.a_(je.y/ur),Kr=Math.min(Math.max(D,Dr),_n),hi=i.d0(Kr)/i.d0(D);if($t=Kr===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,hi/this._mercatorScaleRatio),this.zoom<=i.cZ&&je.zoom===$e-1&&hi>=.9)return!0}else if(w&&(Mt=je.aabb.distanceZ(ae)*re),this.projection.isReprojectedInTileSpace&&f<=5){const ur=Math.pow(2,je.zoom),Dr=Te(new i.ae((je.x+.5)/ur,(je.y+.5)/ur));$t=Dr>.85?1:Dr}if(!E&&!q){const ur=Math.sqrt(dt*dt+rt*rt+Mt*Mt);let Dr=(1<<$e-je.zoom)*ye*$t;return Dr*=Ft(Math.max(Mt,Qe),ur),ur<Dr}let fr=Number.MAX_VALUE,kt=0;const Nt=je.aabb.getCorners(),mr=[];for(const ur of Nt){i.av(mr,ur,ae),q||(w?mr[2]*=re:mr[2]=Qe);const Dr=i.bI(mr,this._camera.forward());Dr<fr&&(fr=Dr,kt=Math.abs(mr[2]))}let lr=(1<<$e-je.zoom)*ye*$t;if(lr*=Ft(Math.max(kt,Qe),fr),fr<lr)return!0;const Qt=je.aabb.closestPoint(j);return Qt[0]===j[0]&&Qt[1]===j[1]};if(this.renderWorldCopies)for(let je=1;je<=3;je++)De.push(be(-je)),De.push(be(je));for(De.push(be(0));De.length>0;){const je=De.pop(),dt=je.x,rt=je.y;let Mt=je.fullyVisible;const $t=()=>this.projection.name==="globe"&&(je.y===0||je.y===(1<<je.zoom)-1);if(!Mt){let fr=de?je.aabb.intersects(Y):je.aabb.intersectsFlat(Y);if(fr===0&&$t()){const kt=new i.cC(je.zoom,dt,rt);fr=i.cD(this,B,kt,!0).intersects(Y)}if(fr===0)continue;Mt=fr===2}if(je.zoom!==$e&&Xe(je))for(let fr=0;fr<4;fr++){const kt=(dt<<1)+fr%2,Nt=(rt<<1)+(fr>>1),mr={aabb:E?je.aabb.quadrant(fr):i.cE(this,B,je.zoom+1,kt,Nt,je.wrap,je.minZ,je.maxZ,this.projection),zoom:je.zoom+1,x:kt,y:Nt,wrap:je.wrap,fullyVisible:Mt,tileID:void 0,shouldSplit:void 0,minZ:je.minZ,maxZ:je.maxZ};w&&!q&&(mr.tileID=new i.aP(je.zoom+1===$e?st:je.zoom+1,je.wrap,je.zoom+1,kt,Nt),pt(mr)),De.push(mr)}else{const fr=je.zoom===$e?st:je.zoom;if(n.minzoom&&n.minzoom>fr)continue;let kt=0;if(!Mt){let Qt=de?je.aabb.intersectsPrecise(Y):je.aabb.intersectsPreciseFlat(Y);if(Qt===0&&$t()){const ur=new i.cC(je.zoom,dt,rt);Qt=i.cD(this,B,ur,!0).intersectsPrecise(Y)}if(Qt===0)continue;if(n.calculateQuadrantVisibility)if(Y.containsPoint(je.aabb.center))kt=15;else for(let ur=0;ur<4;ur++)je.aabb.quadrant(ur).intersects(Y)!==0&&(kt|=1<<ur)}const Nt=j[0]-(.5+dt+(je.wrap<<je.zoom))*(1<<l-je.zoom),mr=j[1]-.5-rt,lr=je.tileID?je.tileID:new i.aP(fr,je.wrap,je.zoom,dt,rt);n.calculateQuadrantVisibility&&(lr.visibleQuadrants=kt),He.push({tileID:lr,distanceSq:Nt*Nt+mr*mr})}}if(this.fogCullDistSq){const je=this.fogCullDistSq,dt=this.horizonLineFromTop();He=He.filter((rt=>{const Mt=[0,0,0,1],$t=[i.al,i.al,0,1],fr=this.calculateFogTileMatrix(rt.tileID.toUnwrapped());i.aC(Mt,Mt,fr),i.aC($t,$t,fr);const kt=i.cF([],Mt,$t),Nt=i.cG([],Mt,$t),mr=i.c_(kt,Nt);if(mr===0)return!0;let lr=!1;const Qt=this._elevation;if(Qt&&mr>je&&dt!==0){const ur=this.calculateProjMatrix(rt.tileID.toUnwrapped());let Dr;n.isTerrainDEM||(Dr=Qt.getMinMaxForTile(rt.tileID)),Dr||(Dr={min:xe,max:Me});const _n=i.cH(this.rotation),Kr=[_n[0]*i.al,_n[1]*i.al,Dr.max];i.af(Kr,Kr,ur),lr=(1-Kr[1])*this.height*.5<dt}return mr<je||lr}))}return He.sort(((je,dt)=>je.distanceSq-dt.distanceSq)).map((je=>je.tileID))}resize(n,l){this.width=n,this.height=l,this.pixelsToGLUnits=[2/n,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log2(n)}project(n){const l=i.aA(n.lat,-i.cI,i.cI),f=this.projection.project(n.lng,l);return new i.P(f.x*this.worldSize,f.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.ce(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,l){let f,v;const w=this.centerPoint;if(this.projection.name==="globe"){const M=this.worldSize;f=(l.x-w.x)/M,v=(l.y-w.y)/M}else{const M=this.pointCoordinate(l),D=this.pointCoordinate(w);f=M.x-D.x,v=M.y-D.y}const E=this.locationCoordinate(n);this.setLocation(new i.ae(E.x-f,E.y-v))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n,l){return this.projection.locationPoint(this,n,l)}locationPoint3D(n,l){return this.projection.locationPoint(this,n,l,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n,l){return this.coordinateLocation(this.pointCoordinate3D(n,l))}locationCoordinate(n,l){const f=l?i.ce(l,n.lat):void 0,v=this.projection.project(n.lng,n.lat);return new i.ae(v.x,v.y,f)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,l){const f=l??this._centerAltitude,v=[n.x,n.y,0,1],w=[n.x,n.y,1,1];i.aC(v,v,this.pixelMatrixInverse),i.aC(w,w,this.pixelMatrixInverse);const E=w[3];i.cJ(v,v,1/v[3]),i.cJ(w,w,1/E);const M=v[2],D=w[2];return{p0:v,p1:w,t:M===D?0:(f-M)/(D-M)}}screenPointToMercatorRay(n){const l=[n.x,n.y,0,1],f=[n.x,n.y,1,1];return i.aC(l,l,this.pixelMatrixInverse),i.aC(f,f,this.pixelMatrixInverse),i.cJ(l,l,1/l[3]),i.cJ(f,f,1/f[3]),l[2]=i.ce(l[2],this._center.lat)*this.worldSize,f[2]=i.ce(f[2],this._center.lat)*this.worldSize,i.cJ(l,l,1/this.worldSize),i.cJ(f,f,1/this.worldSize),new i.ax([l[0],l[1],l[2]],i.aw([],i.av([],f,l)))}rayIntersectionCoordinate(n){const{p0:l,p1:f,t:v}=n,w=i.ce(l[2],this._center.lat),E=i.ce(f[2],this._center.lat);return new i.ae(i.ak(l[0],f[0],v)/this.worldSize,i.ak(l[1],f[1],v)/this.worldSize,i.ak(w,E,v))}pointCoordinate(n,l=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,l)}pointCoordinate3D(n,l){if(!this.elevation)return this.pointCoordinate(n,l);let f=this.projection.pointCoordinate3D(this,n.x,n.y);if(f)return new i.ae(f[0],f[1],f[2]);let v=0,w=this.horizonLineFromTop();if(n.y>w)return this.pointCoordinate(n,l);const E=.02*w,M=n.clone();for(let D=0;D<10&&w-v>E;D++){M.y=i.ak(v,w,.66);const B=this.projection.pointCoordinate3D(this,M.x,M.y);B?(w=M.y,f=B):v=M.y}return f?new i.ae(f[0],f[1],f[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=i.cK)return!this.isPointAboveHorizon(n);const l=this.pointCoordinate(n);return l.y>=0&&l.y<=1}_coordinatePoint(n,l){const f=l&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,v=[n.x*this.worldSize,n.y*this.worldSize,f+n.toAltitude(),1];return i.aC(v,v,this.pixelMatrix),v[3]>0?new i.P(v[0]/v[3],v[1]/v[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:l}=this._edgeInsets,f=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,w=this.pointLocation3D(new i.P(l,n)),E=this.pointLocation3D(new i.P(v,n)),M=this.pointLocation3D(new i.P(v,f)),D=this.pointLocation3D(new i.P(l,f));let B=Math.min(w.lng,E.lng,M.lng,D.lng),j=Math.max(w.lng,E.lng,M.lng,D.lng),q=Math.min(w.lat,E.lat,M.lat,D.lat),U=Math.max(w.lat,E.lat,M.lat,D.lat);const Y=Math.pow(2,-this.zoom)/16*270,ee=this.projection.name==="globe"?1:4,re=(ce,ae,de,ye,fe)=>{const Me=(ce+de)/2,xe=(ae+ye)/2,Ce=new i.P(Me,xe),{lng:Te,lat:be}=this.pointLocation3D(Ce),De=Math.max(0,B-Te,q-be,Te-j,be-U);B=Math.min(B,Te),j=Math.max(j,Te),q=Math.min(q,be),U=Math.max(U,be),(fe<ee||De>Y)&&(re(ce,ae,Me,xe,fe+1),re(Me,xe,de,ye,fe+1))};if(re(l,n,v,n,1),re(v,n,v,f,1),re(v,f,l,f,1),re(l,f,l,n,1),this.projection.name==="globe"){const[ce,ae]=i.cL(this);ce?(U=90,j=180,B=-180):ae&&(q=-90,j=180,B=-180)}return new i.aI(new i.aS(B,q),new i.aS(j,U))}_getBoundsRectangular(n,l){const{top:f,left:v}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,M=new i.P(v,f),D=new i.P(E,f),B=new i.P(E,w),j=new i.P(v,w);let q=this.pointCoordinate(M,n),U=this.pointCoordinate(D,n);const Y=this.pointCoordinate(B,l),ee=this.pointCoordinate(j,l),re=(ce,ae)=>(ae.y-ce.y)/(ae.x-ce.x);return q.y>1&&U.y>=0?q=new i.ae((1-ee.y)/re(ee,q)+ee.x,1):q.y<0&&U.y<=1&&(q=new i.ae(-ee.y/re(ee,q)+ee.x,0)),U.y>1&&q.y>=0?U=new i.ae((1-Y.y)/re(Y,U)+Y.x,1):U.y<0&&q.y<=1&&(U=new i.ae(-Y.y/re(Y,U)+Y.x,0)),new i.aI().extend(this.coordinateLocation(q)).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(Y))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=n.visibleDemTiles.reduce(((f,v)=>{if(v.dem){const w=v.dem.tree;f.min=Math.min(f.min,w.minimums[0]),f.max=Math.max(f.max,w.maximums[0])}return f}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*n.exaggeration(),l.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,f=this.height/2-l*(1-this._horizonShift);return n?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-i.cI,this.maxLat=i.cI,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.aF(this.minLng)*this.tileSize,this.worldMaxX=i.aF(this.maxLng)*this.tileSize,this.worldMinY=i.aJ(this.maxLat)*this.tileSize,this.worldMaxY=i.aJ(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,l){return this.projection.createTileMatrix(this,l,n)}calculateDistanceTileData(n){const l=n.key,f=this._distanceTileDataCache;if(f[l])return f[l];const v=n.canonical,w=1/this.height,E=this.cameraWorldSize,M=E/this.zoomScale(v.z),D=(v.x+Math.pow(2,v.z)*n.wrap)*M,B=v.y*M,j=this.point;j.x*=E/this.worldSize,j.y*=E/this.worldSize;const q=this.angle,U=Math.sin(-q),Y=-Math.cos(-q);return f[l]={bearing:[U,Y],center:[(j.x-D)*w,(j.y-B)*w],scale:M/i.al*w},f[l]}calculateFogTileMatrix(n){const l=n.key,f=this._fogTileMatrixCache;if(f[l])return f[l];const v=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return i.aB(v,this.worldToFogMatrix,v),f[l]=new Float32Array(v),f[l]}calculateProjMatrix(n,l=!1,f=!1){const v=n.key;let w;if(w=f?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,w[v])return w[v];const E=this.calculatePosMatrix(n,this.worldSize);let M;return M=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:f?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,i.aB(E,M,E),w[v]=new Float32Array(E),w[v]}calculatePixelsToTileUnitsMatrix(n){const l=n.tileID.key,f=this._pixelsToTileUnitsCache;if(f[l])return f[l];const v=i.cM(n,this);return f[l]=v,f[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,l=i.bp([],[n,n,n]);return i.aB(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const l=i.ce(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(l),v=this._camera.forward(),w=i.ce(1,this._center.lat);f[2]/=w,v[2]/=w,i.aw(v,v);const E=n.raycast(f,v,n.exaggeration());if(E){const M=i.bG([],f,v,E),D=new i.ae(M[0],M[1],i.ce(M[2],i.a_(M[1]))),B=(D.z+i.ag([D.x-f[0],D.y-f[1],D.z-f[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=D.toAltitude(),this._center=this.coordinateLocation(D),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const l=this._elevation,f=i.ce(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(f),w=l.getAtPointOrZero(new i.ae(...v)),E=this.pixelsPerMeter/this.worldSize*w,M=this._minimumHeightOverTerrain(),D=v[2]-E;if(D<=M)if(D<0||n){const B=this.locationCoordinate(this._center,this._centerAltitude),j=[v[0],v[1],B.z-v[2]],q=i.ag(j);j[2]-=(M-D)/this._pixelsPerMercatorPixel;const U=i.ag(j);if(U===0)return;i.c4(j,j,q/U*this._pixelsPerMercatorPixel),this._camera.position=[v[0],v[1],B.z*this._pixelsPerMercatorPixel-j[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const U=this.center;return U.lat=i.aA(U.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(U.lng=i.aA(U.lng,this.minLng,this.maxLng)),this.center=U,void(this._constraining=!1)}const l=this._unmodified,{x:f,y:v}=this.point;let w=0,E=f,M=v;const D=this.width/2,B=this.height/2,j=this.worldMinY*this.scale,q=this.worldMaxY*this.scale;if(v-B<j&&(M=j+B),v+B>q&&(M=q-B),q-j<this.height&&(w=Math.max(w,this.height/(q-j)),M=(q+j)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const U=this.worldMinX*this.scale,Y=this.worldMaxX*this.scale,ee=this.worldSize/2-(U+Y)/2;E=(f+ee+this.worldSize)%this.worldSize-ee,E-D<U&&(E=U+D),E+D>Y&&(E=Y-D),Y-U<this.width&&(w=Math.max(w,this.width/(Y-U)),E=(Y+U)/2)}E===f&&M===v||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(E,M))),w&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,l=this.projection.name==="globe",f=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.ce(1,this.center.lat)/i.ce(1,i.d1));const v=i.cN(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?f:1,E=this._camera.getWorldToCamera(this.worldSize,w);let M;const D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(D[8]=2*-n.x/this.width,D[9]=2*n.y/this.height,this.isOrthographic){let be=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),De=be*this.aspect,He=-De,$e=-be;De-=n.x,He-=n.x,be+=n.y,$e+=n.y,M=this._camera.getCameraToClipOrthographic(He,De,$e,be,this._nearZ,this._farZ),((st,Qe,pt,Ft)=>{for(let Xe=0;Xe<16;Xe++)st[Xe]=i.ak(Qe[Xe],pt[Xe],Ft)})(M,M,D,i.c$(this.pitch>=uc?1:this.pitch/uc))}else M=D;const B=i.cO([],D,E);let j=i.cO([],M,E);if(this.projection.isReprojectedInTileSpace){const be=this.locationCoordinate(this.center),De=i.bz([]);i.bq(De,De,[be.x*this.worldSize,be.y*this.worldSize,0]),i.aB(De,De,i.cP(this)),i.bq(De,De,[-be.x*this.worldSize,-be.y*this.worldSize,0]),i.aB(j,j,De),i.aB(B,B,De),this.inverseAdjustmentMatrix=i.cQ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.cR([],j,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=j,this.invProjMatrix=i.bk(new Float64Array(16),this.projMatrix),l){const be=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);be[8]=2*-n.x/this.width,be[9]=2*n.y/this.height,this.expandedFarZProjMatrix=i.cO([],be,E)}else this.expandedFarZProjMatrix=this.projMatrix;const q=i.bk([],M);this.frustumCorners=i.cS.fromInvProjectionMatrix(q,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const U=new Float32Array(16);i.bz(U),i.cR(U,U,[1,-1,1]),i.cT(U,U,this._pitch),i.bA(U,U,this.angle);const Y=i.cc(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.by(Y);const ee=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Y[8]=2*-n.x/this.width,Y[9]=2*(n.y+ee)/this.height,this.skyboxMatrix=i.aB(U,Y,U);const re=this.point,ce=re.x,ae=re.y,de=this.width%2/2,ye=this.height%2/2,fe=Math.cos(this.angle),Me=Math.sin(this.angle),xe=ce-Math.round(ce)+fe*de+Me*ye,Ce=ae-Math.round(ae)+fe*ye+Me*de,Te=new Float64Array(j);if(i.bq(Te,Te,[xe>.5?xe-1:xe,Ce>.5?Ce-1:Ce,0]),this.alignedProjMatrix=Te,j=i.bB(),i.cR(j,j,[this.width/2,-this.height/2,1]),i.bq(j,j,[1,-1,0]),this.labelPlaneMatrix=j,j=i.bB(),i.cR(j,j,[1,-1,1]),i.bq(j,j,[-1,-1,0]),i.cR(j,j,[2/this.width,2/this.height,1]),this.glCoordMatrix=j,this.pixelMatrix=i.aB(new Float64Array(16),this.labelPlaneMatrix,B),this._calcFogMatrices(),this._distanceTileDataCache={},j=i.bk(new Float64Array(16),this.pixelMatrix),!j)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=j,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.cU(this);const be=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.af(be,be,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=j;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,f=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,w=[n,n,l];i.c4(w,w,v),i.c4(f,f,-1),i.cV(f,f,w);const E=i.bB();i.bq(E,E,f),i.cR(E,E,w),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,l,v)}_computeCameraPosition(n){const l=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,f=this._camera.forward(),v=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-n/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-f[0]*w,v.y/this.worldSize-f[1]*w,n/this.worldSize*this._centerAltitude-f[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=this._camera.position[2],v=n[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(w=Math.min((l-f)/v,1)),this._camera.position=i.bG([],this._camera.position,n,w),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,l=this._camera.forward(),{pitch:f,bearing:v}=this._camera.getPitchBearing(),w=i.ce(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.an(this._maxPitch)),M=Math.max((n[2]-w)/Math.cos(f),E),D=this._zoomFromMercatorZ(M);i.bG(n,n,l,M),this._pitch=i.aA(f,i.an(this.minPitch),i.an(this.maxPitch)),this.angle=i.bS(v,-Math.PI,Math.PI),this._setZoom(i.aA(D,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ae(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,n)*this.tileSize))}zoomFromMercatorZAdjusted(n){let l=0,f=i.cK,v=0,w=1/0;for(;f-l>1e-6&&f>l;){const E=l+.5*(f-l),M=this.tileSize*Math.pow(2,E),D=this.getCameraToCenterDistance(this.projection,E,M),B=this.scaleZoom(D/(Math.max(0,n)*this.tileSize)),j=Math.abs(E-B);j<w&&(w=j,v=E),E<B?l=E:f=E}return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,l){const f=Math.min(n.x,l.x),v=Math.max(n.x,l.x),w=Math.min(n.y,l.y),E=Math.max(n.y,l.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const M=[new i.P(f,w),new i.P(v,E),new i.P(f,E),new i.P(v,w)],D=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const j of M){const q=this.pointRayIntersection(j);if(q.t<0)return!0;const U=this.rayIntersectionCoordinate(q);if(U.x<D||U.y<0||U.x>B||U.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.cW(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(n,l){const f=i.ag(i.av([],this._camera.position,n)),v=this._zoomFromMercatorZ(f)+l;return f-this._mercatorZfromZoom(v)}getCameraPoint(){if(this.projection.name==="globe"){const n=(function([l,f,v],w){const E=[l,f,v,1];i.aC(E,E,w);const M=E[3]=Math.max(E[3],1e-6);return E[0]/=M,E[1]/=M,E[2]/=M,E})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,n))}}getCameraToCenterDistance(n,l=this.zoom,f=this.worldSize){const v=i.cN(n,l,this.width,this.height,1024),w=n.pixelSpaceConversion(this.center.lat,f,v);let E=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(E=i.ak(1,E,i.c$(this.pitch>=uc?1:this.pitch/uc))),E}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.aB(n,n,this.globeMatrix),n}getFrustum(n){return i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,this.projection.zAxisUnit==="meters")}}const Qa=(h,n)=>{if(n>0&&h.terrain&&i.w("Cutoff is currently disabled on terrain"),n<=0||h.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=h.transform,f=Math.max(Math.abs(l._zoom-(h.minCutoffZoom-1)),1),v=l.isLODDisabled(!1)?i.ah(60,45,l.pitch):i.ah(30,15,l.pitch),w=l._farZ-l._nearZ,E=n*l.height,M=((1-(D=v))*l.cameraToCenterDistance+D*(l._farZ+E))*f;var D;return{shouldRenderCutoff:v<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(M-l._nearZ)/w,(M-E-l._nearZ)/w]}}},Vo={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Rh{constructor(n,l){this.aabb=n,this.lastCascade=l}}class Oh{add(n,l){const f=this.receivers[n.key];f!==void 0?(f.aabb.min[0]=Math.min(f.aabb.min[0],l.min[0]),f.aabb.min[1]=Math.min(f.aabb.min[1],l.min[1]),f.aabb.min[2]=Math.min(f.aabb.min[2],l.min[2]),f.aabb.max[0]=Math.max(f.aabb.max[0],l.max[0]),f.aabb.max[1]=Math.max(f.aabb.max[1],l.max[1]),f.aabb.max[2]=Math.max(f.aabb.max[2],l.max[2])):this.receivers[n.key]=new Rh(l,null)}clear(){this.receivers={}}get(n){return this.receivers[n.key]}computeRequiredCascades(n,l,f){const v=i.d8.fromPoints(n.points);let w=0;for(const E in this.receivers){const M=this.receivers[E];if(!M||!v.intersectsAabb(M.aabb))continue;M.aabb.min=v.closestPoint(M.aabb.min),M.aabb.max=v.closestPoint(M.aabb.max);const D=M.aabb.getCorners();for(let B=0;B<f.length;B++){let j=!0;for(const q of D){const U=[q[0]*l,q[1]*l,q[2]];if(i.af(U,U,f[B].matrix),U[0]<-1||U[0]>1||U[1]<-1||U[1]>1){j=!1;break}}if(M.lastCascade=B,w=Math.max(w,B),j)break}}return w+1}}class Lu{constructor(n){this.painter=n,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Oh,this._depthMode=new pr(n.context.gl.LEQUAL,pr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,n.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),n.tp.registerParameter(Vo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),n.tp.registerParameter(Vo,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),n.tp.registerParameter(Vo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),n.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const n of this._cascades)n.texture.destroy(),n.framebuffer.destroy();this._cascades=[]}updateShadowParameters(n,l){const f=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const v=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||v<=0||(this._shadowLayerCount=f.style.order.reduce(((ee,re)=>{const ce=f.style._mergedLayers[re];return ee+(ce.hasShadowPass()&&!ce.isHidden(n.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=f.context,E=Vo.shadowMapResolution,M=Vo.shadowMapResolution;if(this._cascades.length===0||Vo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ee=0;ee<Vo.cascadeCount;++ee){const re=f._shadowMapDebug,ce=w.gl,ae=w.createFramebuffer(E,M,re,"texture"),de=new i.T(w,{width:E,height:M,data:null},ce.DEPTH_COMPONENT16);if(ae.depthAttachment.set(de.texture),re){const ye=new i.T(w,{width:E,height:M,data:null},ce.RGBA8);ae.colorAttachment.set(ye.texture)}this._cascades.push({framebuffer:ae,texture:de,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.cA,scale:0})}}this.shadowDirection=Lh(l);let D=0;if(n.elevation){const ee=n.elevation,re=[1e4,-1e4];ee.visibleDemTiles.filter((ce=>ce.dem)).forEach((ce=>{const ae=ce.dem.tree;re[0]=Math.min(re[0],ae.minimums[0]),re[1]=Math.max(re[1],ae.maximums[0])})),re[0]!==1e4&&(D=(re[1]-re[0])*ee.exaggeration())}const B=1.5*n.cameraToCenterDistance,j=3*B,q=new Float64Array(16);for(let ee=0;ee<this._cascades.length;++ee){const re=this._cascades[ee];let ce=n.height/50,ae=1;Vo.cascadeCount===1?ae=j:ee===0?ae=B:(ce=B,ae=j);const[de,ye]=zh(n,this.shadowDirection,ce,ae,Vo.shadowMapResolution,D);re.scale=n.scale,re.matrix=de,re.boundingSphereRadius=ye,i.bk(q,re.matrix),re.frustum=i.cA.fromInvProjectionMatrix(q,1,0,!0),re.far=ae}const U=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[U].far,this._cascades[U].far],this._uniformValues.u_shadow_intensity=v,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Vo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Vo.shadowMapResolution,this._uniformValues.u_shadowmap_0=Eo.ShadowMap0,this._uniformValues.u_shadowmap_1=Eo.ShadowMap0+1,this._groundShadowTiles=f.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Y=f.transform.elevation;for(const ee of this._groundShadowTiles){let re={min:0,max:0};if(Y){const ce=Y.getMinMaxForTile(ee);ce&&(re=ce)}this.addShadowReceiver(ee.toUnwrapped(),re.min,re.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(n){this._enabled=n}drawShadowPass(n,l){if(!this.enabled)return;const f=this.painter,v=f.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(f.transform.getFrustum(0),f.transform.worldSize,this._cascades),v.viewport.set([0,0,Vo.shadowMapResolution,Vo.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){f.currentShadowCascade=w,v.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),v.clear({color:i.ao.white,depth:1});for(const E of n.order){const M=n._mergedLayers[E];if(!M.hasShadowPass()||M.isHidden(f.transform.zoom))continue;const D=n.getLayerSourceCache(M),B=D?l[D.id]:void 0;(M.type==="model"||B&&B.length)&&f.renderLayer(f,D,M,B)}}f.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const n=this.painter,l=n.style,f=n.context,v=f.gl,w=l.directionalLight,E=l.ambientLight;if(!w||!E)return;const M=[],D=Qa(n,n.longestCutoffRange);D.shouldRenderCutoff&&M.push("RENDER_CUTOFF"),M.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&M.push("NORMAL_OFFSET");const B=Na(l,w,E),j=new pr(v.LEQUAL,pr.ReadOnly,n.depthRangeFor3D),q=new Nr({func:v.EQUAL,mask:255},0,255,v.KEEP,v.KEEP,v.KEEP);for(const U of this._groundShadowTiles){const Y=U.toUnwrapped(),ee=n.isTileAffectedByFog(U),re=n.getOrCreateProgram("groundShadow",{defines:M,overrideFog:ee});this.setupShadows(Y,re),n.uploadCommonUniforms(f,re,Y,null,D);const ce={u_matrix:n.transform.calculateProjMatrix(Y),u_ground_shadow_factor:B};re.draw(n,v.TRIANGLES,j,q,en.multiply,Vr.disabled,ce,"ground_shadow",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments,null,n.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?en.unblended:en.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(n){const l=this.painter.transform,f=l.calculatePosMatrix(n,l.worldSize);return i.aB(f,this._cascades[this.painter.currentShadowCascade].matrix,f),Float32Array.from(f)}calculateShadowPassMatrixFromMatrix(n){const l=i.by(n);return i.aB(l,this._cascades[this.painter.currentShadowCascade].matrix,n),l}setupShadows(n,l,f){if(!this.enabled)return;const v=this.painter.transform,w=this.painter.context,E=w.gl,M=this._uniformValues,D=new Float64Array(16),B=v.calculatePosMatrix(n,v.worldSize);for(let j=0;j<this._cascades.length;j++)i.aB(D,this._cascades[j].matrix,B),M[j===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),w.activeTexture.set(E.TEXTURE0+Eo.ShadowMap0+j),this._cascades[j].texture.bindExtraParam(E.LINEAR,E.LINEAR,E.CLAMP_TO_EDGE,E.CLAMP_TO_EDGE,E.GREATER);if(this.useNormalOffset=!!f,this.useNormalOffset){const j=i.d6(n.canonical),q=2/v.tileSize*i.al/Vo.shadowMapResolution,U=q*this._cascades[0].boundingSphereRadius,Y=q*this._cascades[this._cascades.length-1].boundingSphereRadius,ee=(f==="vector-tile"?1:3)*(function(re,ce,ae,de,ye){const fe=i.aA((re-22)/-22,0,1);return .125*(1-fe)+4*fe})(v.zoom);M.u_shadow_normal_offset=[j,U*ee,Y*ee],M.u_shadow_bias=[1e-4,.0012,.012]}else M.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(w,M)}setupShadowsFromMatrix(n,l,f=!1){if(!this.enabled)return;const v=this.painter.context,w=v.gl,E=this._uniformValues,M=new Float64Array(16);for(let D=0;D<Vo.cascadeCount;D++)i.aB(M,this._cascades[D].matrix,n),E[D===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(M),v.activeTexture.set(w.TEXTURE0+Eo.ShadowMap0+D),this._cascades[D].texture.bindExtraParam(w.LINEAR,w.LINEAR,w.CLAMP_TO_EDGE,w.CLAMP_TO_EDGE,w.GREATER);if(this.useNormalOffset=f,f){const D=Vo.normalOffset;E.u_shadow_normal_offset=[1,D,D],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(v,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(n,l,f,v){if(v[2]>=0)return{};const w=(function(D,B,j){const q=j/(1<<D.canonical.z);return new i.d8([D.canonical.x*q+D.wrap*j,D.canonical.y*q+D.wrap*j,0],[(D.canonical.x+1)*q+D.wrap*j,(D.canonical.y+1)*q+D.wrap*j,B])})(n,l,f).getCorners(),E=l/-v[2];v[0]<0?(i.d7(w[0],w[0],[v[0]*E,0,0]),i.d7(w[3],w[3],[v[0]*E,0,0])):v[0]>0&&(i.d7(w[1],w[1],[v[0]*E,0,0]),i.d7(w[2],w[2],[v[0]*E,0,0])),v[1]<0?(i.d7(w[0],w[0],[0,v[1]*E,0]),i.d7(w[1],w[1],[0,v[1]*E,0])):v[1]>0&&(i.d7(w[2],w[2],[0,v[1]*E,0]),i.d7(w[3],w[3],[0,v[1]*E,0]));const M={};return M.vertices=w,M.planes=[hc(w[1],w[0],w[4]),hc(w[2],w[1],w[5]),hc(w[3],w[2],w[6]),hc(w[0],w[3],w[7])],M}addShadowReceiver(n,l,f){this._receivers.add(n,i.d8.fromTileIdAndHeight(n,l,f))}getMaxCascadeForTile(n){const l=this._receivers.get(n);return l&&l.lastCascade?l.lastCascade:0}}function hc(h,n,l){const f=i.av([],l,n),v=i.av([],h,n),w=i.bH([],f,v),E=i.ag(w);return E===0?[0,0,1,0]:(i.c4(w,w,1/E),[w[0],w[1],w[2],-i.bI(w,n)])}function Lh(h){const n=h.properties.get("direction"),l=i.d3(n.x,n.y,n.z);l[2]=i.aA(l[2],0,75);const f=i.d5([l[0],l[1],l[2]]);return i.d4(f.x,f.y,f.z)}function Na(h,n,l){const f=n.properties.get("color-use-theme")==="none",v=n.properties.get("color"),w=n.properties.get("intensity"),E=n.properties.get("direction"),M=[E.x,E.y,E.z],D=l.properties.get("color-use-theme")==="none",B=l.properties.get("color"),j=l.properties.get("intensity"),q=Math.max(i.bI([0,0,1],M),0),U=[0,0,0];i.c4(U,B.toPremultipliedRenderColor(D?null:h.getLut(n.scope)).toArray01Linear().slice(0,3),j);const Y=[0,0,0];return i.c4(Y,v.toPremultipliedRenderColor(f?null:h.getLut(l.scope)).toArray01Linear().slice(0,3),q*w),i.da([U[0]>0?U[0]/(U[0]+Y[0]):0,U[1]>0?U[1]/(U[1]+Y[1]):0,U[2]>0?U[2]/(U[2]+Y[2]):0])}function zh(h,n,l,f,v,w){const E=h.zoom,M=h.scale,D=h.worldSize,B=1/D,j=h.aspect,q=Math.sqrt(1+j*j)*Math.tan(.5*h.fovX),U=q*q,Y=f-l,ee=f+l;let re,ce;U>Y/ee?(re=f,ce=f*q):(re=.5*ee*(1+U),ce=.5*Math.sqrt(Y*Y+2*(f*f+l*l)*U+ee*ee*U*U));const ae=h.projection.pixelsPerMeter(h.center.lat,D),de=h._camera.getCameraToWorldMercator(),ye=[0,0,-re*B];i.af(ye,ye,de);let fe=ce*B;const Me=h._edgeInsets;if(!(Me.left===0&&Me.top===0&&Me.right===0&&Me.bottom===0||Me.left===Me.right&&Me.top===Me.bottom)){const Mt=h._camera.getWorldToCamera(h.worldSize,h.projection.zAxisUnit==="meters"?ae:1),$t=h._camera.getCameraToClipPerspective(h._fov,h.width/h.height,l,f);$t[8]=2*-h.centerOffset.x/h.width,$t[9]=2*h.centerOffset.y/h.height;const fr=new Float64Array(16);i.cO(fr,$t,Mt);const kt=new Float64Array(16);i.bk(kt,fr);const Nt=i.cA.fromInvProjectionMatrix(kt,D,E,!0);for(const mr of Nt.points){const lr=((xe=mr)[0]/=M,xe[1]/=M,xe[2]=i.ce(xe[2],h._center.lat),xe);fe=Math.max(fe,i.c5(i.d9([],ye,lr)))}}var xe;fe*=v/(v-1);const Ce=Math.acos(n[2]),Te=Math.atan2(-n[0],-n[1]),be=new sd;be.position=ye,be.setPitchBearing(Ce,Te);const De=be.getWorldToCamera(D,ae),He=fe*D,$e=Math.min(h._mercatorZfromZoom(17)*D*-2,-2*He),st=be.getCameraToClipOrthographic(-He,He,-He,He,$e,(He+w*ae)/n[2]),Qe=new Float64Array(16);i.aB(Qe,st,De);const pt=i.d4(Math.floor(1e6*ye[0])/1e6*D,Math.floor(1e6*ye[1])/1e6*D,0),Ft=.5*v,Xe=[0,0,0];i.af(Xe,pt,Qe),i.c4(Xe,Xe,Ft);const je=[Math.floor(Xe[0]),Math.floor(Xe[1]),Math.floor(Xe[2])],dt=[0,0,0];i.av(dt,Xe,je),i.c4(dt,dt,-1/Ft);const rt=new Float64Array(16);return i.bz(rt),i.bq(rt,rt,dt),i.aB(Qe,rt,Qe),[Qe,He]}class ca extends i.E{constructor(n){super(),this.requestManager=n,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(n,l){return i.db(this.requestManager.transformRequest(l,i.R.Model).url).then((f=>{if(!f)return;const v=i.dc(f),w=new i.dd(n,l,void 0,void 0,v);return w.computeBoundsAndApplyParent(),w})).catch((f=>{if(f&&f.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${n} from ${l}: ${f.message}`)))}))}load(n,l,f={forceReload:!1}){this.models[l]||(this.models[l]={});const v=Object.keys(n),w=[],E=[];for(const M of v){const D=n[M];this.hasURLBeenRequested(D)&&!f.forceReload||(this.modelByURL[D]={modelId:M,scope:l},w.push(this.loadModel(M,D)),E.push(M)),this.models[l][M]||(this.models[l][M]={model:null,numReferences:1})}this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+E.length,Promise.allSettled(w).then((M=>{for(let D=0;D<M.length;D++){const{status:B}=M[D];if(B==="rejected")continue;const{value:j}=M[D];this.models[l][E[D]]||(this.models[l][E[D]]={model:null,numReferences:1}),this.models[l][E[D]].model=j}this.numModelsLoading[l]-=E.length,this.fire(new i.z("data",{dataType:"style"}))})).catch((M=>{this.fire(new i.y(new Error(`Could not load models: ${M.message}`)))}))}isLoaded(){for(const n in this.numModelsLoading)if(this.numModelsLoading[n]>0)return!1;return!0}hasModel(n,l,f={exactIdMatch:!1}){return!!(f.exactIdMatch?this.getModel(n,l):this.getModelByURL(this.modelUris[l][n]))}getModel(n,l){return this.models[l]||(this.models[l]={}),this.models[l][n]?this.models[l][n].model:void 0}getModelByURL(n){if(!n)return null;const l=this.modelByURL[n];return l?this.models[l.scope][l.modelId].model:null}hasModelBeenAdded(n,l){return this.models[l]&&this.models[l][n]!==void 0}getModelURIs(n){return this.modelUris[n]||{}}addModel(n,l,f){this.models[f]||(this.models[f]={}),this.modelUris[f]||(this.modelUris[f]={});const v=this.requestManager.normalizeModelURL(l);if((this.hasModel(n,f,{exactIdMatch:!0})||this.hasModelBeenAdded(n,f))&&this.modelUris[f][n]===v)this.models[f][n].numReferences++;else if(this.hasURLBeenRequested(v)){const{scope:w,modelId:E}=this.modelByURL[v];this.models[w][E].numReferences++}else this.modelUris[f][n]=v,this.load({[n]:this.modelUris[f][n]},f)}addModelURLs(n,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const f=this.modelUris[l];for(const v in n)f[v]=this.requestManager.normalizeModelURL(n[v])}reloadModels(n){this.load(this.modelUris[n],n,{forceReload:!0})}addModelsFromBucket(n,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const f={};for(const v of n)this.hasModel(v,l,{exactIdMatch:!0})||this.hasURLBeenRequested(v)?this.models[l][v].numReferences++:this.modelUris[l][v]&&!this.hasURLBeenRequested(v)?f[v]=this.modelUris[l][v]:!this.hasURLBeenRequested(v)&&i.de(v,!1)&&(this.modelUris[l][v]=this.requestManager.normalizeModelURL(v),f[v]=this.modelUris[l][v]);this.load(f,l)}hasURLBeenRequested(n){return this.modelByURL[n]!==void 0}removeModel(n,l,f=!1,v=!1){if(this.models[l]&&this.models[l][n]&&(this.models[l][n].numReferences--,this.models[l][n].numReferences===0||v)){const w=this.modelUris[l][n];f||delete this.modelUris[l][n],delete this.modelByURL[w];const E=this.models[l][n].model;if(!E)return;delete this.models[l][n],E.destroy()}}destroy(){for(const n of Object.keys(this.models))for(const l of Object.keys(this.models[n])){const f=this.models[n][l].model;delete this.models[n][l],f&&f.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(n){return this.models[n]||(this.models[n]={}),Object.keys(this.models[n])}upload(n,l){this.models[l]||(this.models[l]={});for(const f in this.models[l])this.models[l][f].model&&this.models[l][f].model.upload(n.context)}}const Fl=i.a6.colorTheme,kl=new i.a9({data:new i.aa(Fl.data)});function Fh(h){if(!h.metadata||!h.metadata.content_area)return;const n=i.o.devicePixelRatio,{left:l,top:f,width:v,height:w}=h.metadata.content_area,E=l*n,M=f*n;return[E,M,E+v*n,M+w*n]}function kd(h){if(h)return h.map((([n,l])=>[n*i.o.devicePixelRatio,l*i.o.devicePixelRatio]))}class kh{constructor(n,l,f){this.id=n,this.scope=l,this.sourceCache=f,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(n){this.missingRequests.has(n.name)||this.pendingRequests.has(n.name)||this.pendingRequests.add(n.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const n=new Map;if(!this.sourceCache.loaded())return n;const l=this.sourceCache.getVisibleCoordinates();if(l.length===0)return n;const f=this.sourceCache.getSource();if(!(f instanceof uo))return n;const v=l.map((E=>this.sourceCache.getTile(E))),w=f.getImages(v,Array.from(this.pendingRequests));for(const[E,M]of w)n.set(i.I.from({name:E,iconsetId:this.id}),M),this.pendingRequests.delete(E);for(const E of this.pendingRequests)this.missingRequests.add(E);return this.pendingRequests.clear(),n}}const ml=(h,n)=>ie(h,n&&n.filter((l=>l.identifier!=="source.canvas"))),T=i.aH(bn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setLayerProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),tg=i.aH(bn,["setCenter","setZoom","setBearing","setPitch"]),zu=new Set(["background","sky","slot","custom"]),jf={version:8,layers:[],sources:{}},Bd={duration:300,delay:0};class gl extends i.E{constructor(n,l={}){super(),this.map=n,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=Object.assign({},Bd),this._buildingIndex=new Rc(this),this.crossTileSymbolIndex=new pl,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedIndoor={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._hasAppearances=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._importedAsBasemap=!1,this._changes=l.styleChanges||new Si,this.dispatcher=l.dispatcher?l.dispatcher:new i.D(i.dg(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Ii(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new i.dh(n._requestManager,l.localFontFamily?i.di.all:l.localIdeographFontFamily?i.di.ideographs:i.di.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new ca(n._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._indoorDependentLayers=l.indoorDependentLayers?l.indoorDependentLayers:new Set,this._config=l.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:l.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",i.dj());const f=this;this._rtlTextPluginCallback=gl.registerForPluginStateChange((v=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},((w,E)=>{if(i.dk(w),E&&E.every((M=>M)))for(const M in f._sourceCaches){const D=f._sourceCaches[M],B=D.getSource().type;B!=="vector"&&B!=="geojson"||D.reload()}}))})),this.on("data",(v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const w=this.getOwnSource(v.sourceId);if(w&&w.vectorLayerIds)for(const E in this._layers){const M=this._layers[E];M.source===w.id&&this._validateLayer(M)}}))}load(n){return n?(typeof n=="string"?this.loadURL(n):this.loadJSON(n),this):this}_getGlobalId(n){if(!n)return null;if(typeof n=="string"){if(i.h(n))return n;const l=i.dl(n);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${i.dm(JSON.stringify(n))}`}_diffStyle(n,l,f){this.globalId=this._getGlobalId(n);const v=(w,E)=>{try{E(null,this.setState(w,f))}catch(M){E(M,!1)}};if(typeof n=="string"){const w=this.map._requestManager.normalizeStyleURL(n),E=this.map._requestManager.transformRequest(w,i.R.Style);i.m(E,((M,D)=>{M?this.fire(new i.y(M)):D&&v(D,l)}))}else typeof n=="object"&&v(n,l)}loadURL(n,l={}){this.fire(new i.z("dataloading",{dataType:"style"}));const f=typeof l.validate=="boolean"?l.validate:!i.h(n);this.globalId=this._getGlobalId(n),n=this.map._requestManager.normalizeStyleURL(n,l.accessToken),this.resolvedImports.add(n);const v=this.importsCache.get(n);if(v)return this._load(v,f);const w=this.map._requestManager.transformRequest(n,i.R.Style);this._request=i.m(w,((E,M)=>{if(this._request=null,E)this.fire(new i.y(E));else if(M)return this.importsCache.set(n,M),this._load(M,f)}))}loadJSON(n,l={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(n),this._request=i.o.frame((()=>{this._request=null,this._load(n,l.validate!==!1)}))}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(jf,!1)}_loadImports(n,l,f){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const v=[];for(const w of n){const E=this._createFragmentStyle(w),M=new Promise((j=>{E.once("style.import.load",j),E.once("error",j)})).then((()=>this.mergeAll()));if(v.push(M),this.resolvedImports.has(w.url)){E.loadEmpty();continue}const D=w.data||this.importsCache.get(w.url);D?(E.loadJSON(D,{validate:l}),this._isInternalStyle(D)&&(E.globalId=null)):w.url?E.loadURL(w.url,{validate:l}):E.loadEmpty();const B={style:E,id:w.id,config:w.config};if(f){const j=this.fragments.findIndex((({id:q})=>q===f));this.fragments=this.fragments.slice(0,j).concat(B).concat(this.fragments.slice(j))}else this.fragments.push(B)}return Promise.allSettled(v)}getImportGlobalIds(n=this,l=new Set){for(const f of n.fragments)f.style.globalId&&l.add(f.style.globalId),this.getImportGlobalIds(f.style,l);return[...l.values()]}_createFragmentStyle(n){const l=this.scope?i.B(n.id,this.scope):n.id;let f;const v=this._initialConfig&&this._initialConfig[l];(n.config||v)&&(f=Object.assign({},n.config,v));const w=new gl(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:f,configOptions:this.options,colorThemeOverride:n["color-theme"],configDependentLayers:this._configDependentLayers,indoorDependentLayers:this._indoorDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this._updateLayers(this._indoorDependentLayers),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(n){return this.isRootStyle()&&(n.fragment||!!n.schema&&n.fragment!==!1)}_load(n,l){if(this._isInternalStyle(n)){const w=Object.assign({},jf,{imports:[{id:"basemap",data:n,url:""}]},n.center?{center:n.center}:{},n.bearing?{bearing:n.bearing}:{},n.pitch?{pitch:n.pitch}:{},n.zoom?{zoom:n.zoom}:{},n.light?{light:n.light}:{});return this._importedAsBasemap=!0,void this._load(w,l)}if(this.updateConfig(this._config,n.schema),l&&ml(this,Ms(n)))return;this._loaded=!0,this.stylesheet=i.dn(n);const f=()=>{for(const D in n.sources)this.addSource(D,n.sources[D],{validate:!1,isInitialLoad:!0});if(n.iconsets)for(const D in n.iconsets)this.addIconset(D,n.iconsets[D]);n.sprite?this._loadIconset(n.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&n.glyphs&&this.glyphManager.setURL(n.glyphs);const w=hl(this.stylesheet.layers);if(this._order=w.map((D=>D.id)),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const D=this.stylesheet.lights[0];this.light=new Oe(D.properties,D.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Oe(this.stylesheet.light)),this._layers={};for(const D of w){const B=i.dt(D,this.scope,this._styleColorTheme.lut,this.options);B.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(B.fqid),B.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(B.fqid),this._hasAppearances=this._hasAppearances||B.getAppearances().length!==0,B.setEventedParent(this,{layer:{id:B.id}}),this._layers[B.id]=B;const j=this.getOwnLayerSourceCache(B),q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();j&&B.canCastShadows()&&q&&(j.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const E=this.stylesheet.terrain;E&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(E,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const M=this.isRootStyle();n.imports?this._loadImports(n.imports,l).then((()=>{this._reloadImports(),this.fire(new i.z(M?"style.load":"style.import.load"))})).catch((D=>{this.fire(new i.y(new Error("Failed to load imports",D))),this.fire(new i.z(M?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new i.z(M?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const v=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(v){const w=this._evaluateColorThemeData(v);this._loadColorTheme(w).then((()=>{f()})).catch((E=>{i.w(`Couldn't load color theme from the stylesheet: ${E}`),f()}))}else this._styleColorTheme.lut=null,f()}isRootStyle(){return this.importDepth===0}hasAppearances(){return this._hasAppearances}mergeAll(){let n,l,f,v,w,E,M,D,B,j;const q={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((U=>{if(U.stylesheet){if(U.light!=null&&(n=U.light),U.stylesheet.lights)for(const Y of U.stylesheet.lights)Y.type==="ambient"&&U.ambientLight!=null&&(l=U.ambientLight),Y.type==="directional"&&U.directionalLight!=null&&(f=U.directionalLight);v=this._prioritizeTerrain(v,U.terrain,U.stylesheet.terrain),U.stylesheet.fog&&U.fog!=null&&(w=U.fog),U.stylesheet.snow&&U.snow!=null&&(E=U.snow),U.stylesheet.rain&&U.rain!=null&&(M=U.rain),U.stylesheet.camera!=null&&(j=U.stylesheet.camera),U.stylesheet.projection!=null&&(D=U.stylesheet.projection),U.stylesheet.transition!=null&&(B=U.stylesheet.transition),q[U.scope]=U._styleColorTheme}})),this.light=n,this.ambientLight=l,this.directionalLight=f,this.fog=w,this.snow=E,this.rain=M,this._styleColorThemeForScope=q,v===null?delete this.terrain:this.terrain=v,this.camera=j||{"camera-projection":"perspective"},this.projection=D||{name:"mercator"},this.transition=Object.assign({},Bd,B),this.mergeSources(),this.mergeLayers(),this.mergeIndoor()}forEachFragmentStyle(n){const l=f=>{for(const v of f.fragments)l(v.style);n(f)};l(this)}_prioritizeTerrain(n,l,f){const v=n&&n.drapeRenderMode===0;return f===null?l&&l.drapeRenderMode===0?l:v?n:null:l!=null&&(!n||v||l&&l.drapeRenderMode===1)?l:n}mergeTerrain(){let n;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((l=>{n=this._prioritizeTerrain(n,l.terrain,l.stylesheet.terrain)})),n===null?delete this.terrain:this.terrain=n}mergeProjection(){let n;this.forEachFragmentStyle((l=>{l.stylesheet.projection!=null&&(n=l.stylesheet.projection)})),this.projection=n||{name:"mercator"}}mergeSources(){const n={},l={},f={};this.forEachFragmentStyle((v=>{for(const w in v._sourceCaches){const E=i.B(w,v.scope);n[E]=v._sourceCaches[w]}for(const w in v._otherSourceCaches){const E=i.B(w,v.scope);l[E]=v._otherSourceCaches[w]}for(const w in v._symbolSourceCaches){const E=i.B(w,v.scope);f[E]=v._symbolSourceCaches[w]}})),this._mergedSourceCaches=n,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=f}mergeIndoor(){this.forEachFragmentStyle((n=>{if(n.stylesheet&&n.stylesheet.indoor)for(const l of Object.values(n.stylesheet.indoor)){const f=l,v=i.B(f.sourceId,n.scope);this._mergedIndoor[v]=new Set(f.sourceLayers||[])}}))}mergeLayers(){const n={},l=[],f={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((E=>{for(const M of E._order){const D=E._layers[M];if(D.type==="slot"){const B=i.dp(M);if(n[B])continue;n[B]=[]}D.slot&&n[D.slot]?n[D.slot].push(D):l.push(D)}})),this._mergedOrder=[];let v=-1;const w=(E=[])=>{for(const M of E)if(M.type==="slot"){const D=i.dp(M.id);n[D]&&w(n[D]),this._mergedSlots.push(D)}else{const D=i.B(M.id,M.scope);this._mergedOrder.push(D),f[D]=M,M.is3D(!!this.terrain)&&(this._has3DLayers=!0,v=this._mergedOrder.length-1),M.type==="circle"&&(this._hasCircleLayers=!0),M.type==="symbol"&&(this._hasSymbolLayers=!0),M.type==="clip"&&(this._clipLayerPresent=!0)}};if(w(l),this._has3DLayers){const E={};for(let M=0;M<this._mergedOrder.length;++M){const D=this._mergedOrder[M];E[D]=M===v?1:M<v?f[D].hasOcclusionOpacityProperties?2:0:4}this._mergedOrder.sort(((M,D)=>E[M]-E[D]))}this._mergedLayers=f,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(n){return this.stylesheet.camera=Object.assign({},this.stylesheet.camera,n),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(n){return n.data?(function(l,f,v,w){const E=Object.assign({},f);for(const D of Object.keys(Fl))E[D]===void 0&&(E[D]=Fl[D].default);const M=new i.a8(kl,l,new Map(v));return M.setTransitionOrValue(E,v),M.untransitioned().possiblyEvaluate(new i.ac(0,{worldview:void 0}))})(this.scope,n,this.options).get("data"):null}_loadColorTheme(n){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((f,v)=>{const w="data:image/png;base64,";if(!n||n.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void f();let E=n;E.startsWith(w)||(E=w+E);const M=i.I.from("mapbox-reserved-lut"),D=new Image;D.src=E,D.onerror=()=>{this._styleColorTheme.lutLoading=!1,v(new Error("Failed to load image data"))},D.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void f();this._styleColorTheme.lutLoading=!1;const{width:B,height:j,data:q}=i.o.getImageData(D);if(j>32)return void v(new Error("The height of the image must be less than or equal to 32 pixels."));if(B!==j*j)return void v(new Error("The width of the image must be equal to the height squared."));this.getImage(M)&&this.removeImage(M),this.addImage(M,{data:new i.q({width:B,height:j},q),pixelRatio:1,sdf:!1,usvg:!1,version:0});const U=this.imageManager.getImage(M,this.scope);U?(this._styleColorTheme.lut={image:U.data,data:n},f()):v(new Error("Missing LUT image."))}}))}getLut(n){const l=this._styleColorThemeForScope[n];return l?l.lut:null}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(n){this._spriteRequest=(function(l,f,v){let w,E,M;const D=i.o.devicePixelRatio>1?"@2x":"";let B=i.m(f.transformRequest(f.normalizeSpriteURL(l,D,".json"),i.R.SpriteJSON),((U,Y)=>{B=null,M||(M=U,w=Y,q())})),j=i.n(f.transformRequest(f.normalizeSpriteURL(l,D,".png"),i.R.SpriteImage),((U,Y)=>{j=null,M||(M=U,E=Y,q())}));function q(){if(M)v(M);else if(w&&E){const U=i.o.getImageData(E),Y={};for(const ee in w){const{width:re,height:ce,x:ae,y:de,sdf:ye,pixelRatio:fe,stretchX:Me,stretchY:xe,content:Ce}=w[ee],Te=new i.q({width:re,height:ce});i.q.copy(U,Te,{x:ae,y:de},{x:0,y:0},{width:re,height:ce},null),Y[ee]={data:Te,pixelRatio:fe!==void 0?fe:1,sdf:ye!==void 0&&ye,stretchX:Me,stretchY:xe,content:Ce,usvg:!1,version:0}}v(null,Y)}}return{cancel(){B&&(B.cancel(),B=null),j&&(j.cancel(),j=null)}}})(n,this.map._requestManager,((l,f)=>{if(this._spriteRequest=null,l)this.fire(new i.y(l));else if(f){const v=new Map;for(const w in f)v.set(i.I.from(w),f[w]);this.addImages(v)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))}))}addIconset(n,l){if(l.type==="sprite")return void this._loadSprite(l.url);const f=this.getOwnSourceCache(l.source);if(!f)return void this.fire(new i.y(new Error(`Source "${l.source}" as specified by iconset "${n}" does not exist and cannot be used as an iconset source`)));const v=f.getSource();if(v.type!=="raster-array")return void this.fire(new i.y(new Error(`Source "${l.source}" as specified by iconset "${n}" is not a "raster-array" source and cannot be used as an iconset source`)));v.partial=!1;const w=new kh(n,this.scope,f);this.imageManager.addImageProvider(w,this.scope)}removeIconset(n){this.imageManager.removeImageProvider(n,this.scope)}_loadIconset(n){if(!i.h(n)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(n);const l=this.map._spriteFormat==="auto";var f,v;this._spriteRequest=(v=(w,E)=>{if(this._spriteRequest=null,w)l?this._loadSprite(n):this.fire(new i.y(w));else if(E){const M=new Map;for(const D in E)M.set(i.I.from(D),E[D]);this.addImages(M)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bt((f=this.map._requestManager).transformRequest(f.normalizeIconsetURL(n),i.R.Iconset),((w,E)=>{if(w)return void v(w);const M={},D=i.df(new i.bs(E));for(const B of D.icons){const j={version:1,pixelRatio:i.o.devicePixelRatio,content:Fh(B),stretchX:B.metadata?kd(B.metadata.stretch_x_areas):void 0,stretchY:B.metadata?kd(B.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:B};M[B.name]=j}v(null,M)})))}_validateLayer(n){const l=this.getOwnSource(n.source);if(!l)return;const f=n.sourceLayer;f&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(f)===-1)&&this.fire(new i.y(new Error(`Source layer "${f}" does not exist on source "${l.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:n}of this.fragments)if(!n.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((n,l)=>{const f=this.fragments[l];return f&&f.style&&(n.data=f.style.serialize()),n}))}_serializeSources(){const n={};for(const l in this._sourceCaches){const f=this._sourceCaches[l].getSource();n[f.id]||(n[f.id]=f.serialize())}return n}_serializeLayers(n){const l=[];for(const f of n){const v=this._layers[f];v&&v.type!=="custom"&&l.push(v.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(n){return n?this.order:this._mergedOrder}isLayerDraped(n){return!!this.terrain&&n.isDraped(this.getLayerSourceCache(n))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(n){const l=this.getOwnLayer(n);if(l)return l;this.fire(new i.y(new Error(`The layer '${n}' does not exist in the map's style.`)))}_checkSource(n){const l=this.getOwnSource(n);if(l)return l;this.fire(new i.y(new Error(`The source '${n}' does not exist in the map's style.`)))}precompilePrograms(n,l){const f=this.map.painter;if(f)for(let v=n.minzoom||0;v<(n.maxzoom||25.5);v++){const w=n.getProgramIds();if(w)for(const E of w){const M=n.getDefaultProgramParams(E,l.zoom,this._styleColorTheme.lut);M&&(f.style=this,this.fog&&(f._fogVisible=!0,M.overrideFog=!0,f.getOrCreateProgram(E,M)),f._fogVisible=!1,M.overrideFog=!1,f.getOrCreateProgram(E,M),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(M.overrideRtt=!0,f.getOrCreateProgram(E,M)))}}}update(n){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n);const l=this.calculateLightsBrightness();n.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l)),n.worldview!==this._worldview&&(this._worldview=n.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const f=this._changes.isDirty();let v=!1;if(this._changes.isDirty()){const M=this._changes.getLayerUpdatesByScope();for(const D in M){const{updatedIds:B,removedIds:j}=M[D];(B||j)&&(this._updateWorkerLayers(D,B,j),v=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(n),this.light&&this.light.updateTransitions(n),this.ambientLight&&this.ambientLight.updateTransitions(n),this.directionalLight&&this.directionalLight.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this.snow&&this.snow.updateTransitions(n),this.rain&&this.rain.updateTransitions(n),this._changes.reset()}const w={};for(const M in this._mergedSourceCaches){const D=this._mergedSourceCaches[M];w[M]=D.used,D.used=!1,D.tileCoverLift=0}for(const M of this._mergedOrder){const D=this._mergedLayers[M];if(D.recalculate(n,this._availableImages),!D.isHidden(n.zoom)){const B=this.getLayerSourceCache(D);B&&(B.used=!0,B.tileCoverLift=Math.max(B.tileCoverLift,D.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(D,n)})):this.precompilePrograms(D,n))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&v&&this.mergeLayers();const E=this.imageManager.getPendingImageProviders();for(const M of E)M.sourceCache.used=!0;for(const M in w){const D=this._mergedSourceCaches[M];w[M]!==D.used&&D.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.snow&&this.snow.recalculate(n),this.rain&&this.rain.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),f&&this.fire(new i.z("data",{dataType:"style"}))}updateImageProviders(){const n=this.imageManager.getPendingImageProviders();for(const l of n){const f=l.resolvePendingRequests(),v=this.getFragmentStyle(l.scope);v&&v.addImages(f)}}_updateTilesForChangedImages(){const n={};for(const l in this._mergedSourceCaches){const f=this._mergedSourceCaches[l].getSource().scope;n[f]=n[f]||this._changes.getUpdatedImages(f),n[f].length!==0&&this._mergedSourceCaches[l].reloadTilesForDependencies(["icons","patterns"],n[f])}for(const l in n)this._changes.resetUpdatedImages(l)}_updateWorkerLayers(n,l,f){const v=this.getFragmentStyle(n);v&&this.dispatcher.broadcast("updateLayers",{layers:l?v._serializeLayers(l):[],scope:n,removedIds:f||[],options:v.options})}setState(n,l){if(this._checkLoaded(),ml(this,Ms(n)))return!1;(n=i.dn(n)).layers=hl(n.layers);const f=(function(E,M){if(!E)return[{command:bn.setStyle,args:[M]}];let D=[];try{if(!i.bx(E.version,M.version))return[{command:bn.setStyle,args:[M]}];if(i.bx(E.center,M.center)||D.push({command:bn.setCenter,args:[M.center]}),i.bx(E.zoom,M.zoom)||D.push({command:bn.setZoom,args:[M.zoom]}),i.bx(E.bearing,M.bearing)||D.push({command:bn.setBearing,args:[M.bearing]}),i.bx(E.pitch,M.pitch)||D.push({command:bn.setPitch,args:[M.pitch]}),i.bx(E.sprite,M.sprite)||D.push({command:bn.setSprite,args:[M.sprite]}),i.bx(E.glyphs,M.glyphs)||D.push({command:bn.setGlyphs,args:[M.glyphs]}),i.bx(E.imports,M.imports)||(function(Y=[],ee=[],re){ee=ee||[];const ce=(Y=Y||[]).map(Ht),ae=ee.map(Ht),de=Y.reduce(Xr,{}),ye=ee.reduce(Xr,{}),fe=ce.slice();let Me,xe,Ce,Te;for(Me=0,xe=0;Me<ce.length;Me++)Ce=ce[Me],ye.hasOwnProperty(Ce)?xe++:(re.push({command:bn.removeImport,args:[Ce]}),fe.splice(fe.indexOf(Ce,xe),1));for(Me=0,xe=0;Me<ae.length;Me++)Ce=ae[ae.length-1-Me],fe[fe.length-1-Me]!==Ce&&(de.hasOwnProperty(Ce)?(re.push({command:bn.removeImport,args:[Ce]}),fe.splice(fe.lastIndexOf(Ce,fe.length-xe),1)):xe++,Te=fe[fe.length-Me],re.push({command:bn.addImport,args:[ye[Ce],Te]}),fe.splice(fe.length-Me,0,Ce));for(const be of ee){const De=de[be.id];De&&(delete De.data,i.bx(De,be)||re.push({command:bn.updateImport,args:[be.id,be]}))}})(E.imports,M.imports,D),i.bx(E.transition,M.transition)||D.push({command:bn.setTransition,args:[M.transition]}),i.bx(E.light,M.light)||D.push({command:bn.setLight,args:[M.light]}),i.bx(E.fog,M.fog)||D.push({command:bn.setFog,args:[M.fog]}),i.bx(E.snow,M.snow)||D.push({command:bn.setSnow,args:[M.snow]}),i.bx(E.rain,M.rain)||D.push({command:bn.setRain,args:[M.rain]}),i.bx(E.projection,M.projection)||D.push({command:bn.setProjection,args:[M.projection]}),i.bx(E.lights,M.lights)||D.push({command:bn.setLights,args:[M.lights]}),i.bx(E.camera,M.camera)||D.push({command:bn.setCamera,args:[M.camera]}),i.bx(E.iconsets,M.iconsets)||(function(Y,ee,re){let ce;for(ce in ee=ee||{},Y=Y||{})Y.hasOwnProperty(ce)&&(ee.hasOwnProperty(ce)||re.push({command:bn.removeIconset,args:[ce]}));for(ce in ee){if(!ee.hasOwnProperty(ce))continue;const ae=ee[ce];Y.hasOwnProperty(ce)?i.bx(Y[ce],ae)||(re.push({command:bn.removeIconset,args:[ce]}),re.push({command:bn.addIconset,args:[ce,ae]})):re.push({command:bn.addIconset,args:[ce,ae]})}})(E.iconsets,M.iconsets,D),!i.bx(E["color-theme"],M["color-theme"]))return[{command:bn.setStyle,args:[M]}];const B={},j=[];(function(Y,ee,re,ce){let ae;for(ae in ee=ee||{},Y=Y||{})Y.hasOwnProperty(ae)&&(ee.hasOwnProperty(ae)||za(ae,re,ce));for(ae in ee){if(!ee.hasOwnProperty(ae))continue;const de=ee[ae];Y.hasOwnProperty(ae)?i.bx(Y[ae],de)||(Y[ae].type==="geojson"&&de.type==="geojson"&&Ge(Y,ee,ae)?re.push({command:bn.setGeoJSONSourceData,args:[ae,de.data]}):Fa(ae,ee,re,ce)):Ol(ae,ee,re)}})(E.sources,M.sources,j,B);const q=[];E.layers&&E.layers.forEach((Y=>{Y.source&&B[Y.source]?D.push({command:bn.removeLayer,args:[Y.id]}):q.push(Y)}));let U=E.terrain;U&&B[U.source]&&(D.push({command:bn.setTerrain,args:[void 0]}),U=void 0),D=D.concat(j),i.bx(U,M.terrain)||D.push({command:bn.setTerrain,args:[M.terrain]}),(function(Y,ee,re){ee=ee||[];const ce=(Y=Y||[]).map(Ht),ae=ee.map(Ht),de=Y.reduce(Xr,{}),ye=ee.reduce(Xr,{}),fe=ce.slice(),Me=Object.create(null);let xe,Ce,Te,be,De,He,$e;for(xe=0,Ce=0;xe<ce.length;xe++)Te=ce[xe],ye.hasOwnProperty(Te)?Ce++:(re.push({command:bn.removeLayer,args:[Te]}),fe.splice(fe.indexOf(Te,Ce),1));for(xe=0,Ce=0;xe<ae.length;xe++)Te=ae[ae.length-1-xe],fe[fe.length-1-xe]!==Te&&(de.hasOwnProperty(Te)?(re.push({command:bn.removeLayer,args:[Te]}),fe.splice(fe.lastIndexOf(Te,fe.length-Ce),1)):Ce++,He=fe[fe.length-xe],re.push({command:bn.addLayer,args:[ye[Te],He]}),fe.splice(fe.length-xe,0,Te),Me[Te]=!0);for(xe=0;xe<ae.length;xe++)if(Te=ae[xe],be=de[Te],De=ye[Te],!Me[Te]&&!i.bx(be,De))if(i.bx(be.source,De.source)&&i.bx(be["source-layer"],De["source-layer"])&&i.bx(be.type,De.type)){for($e in yt(be.layout,De.layout,re,Te,null,bn.setLayoutProperty),yt(be.paint,De.paint,re,Te,null,bn.setPaintProperty),i.bx(be.slot,De.slot)||re.push({command:bn.setSlot,args:[Te,De.slot]}),i.bx(be.filter,De.filter)||re.push({command:bn.setFilter,args:[Te,De.filter]}),i.bx(be.minzoom,De.minzoom)&&i.bx(be.maxzoom,De.maxzoom)||re.push({command:bn.setLayerZoomRange,args:[Te,De.minzoom,De.maxzoom]}),be)be.hasOwnProperty($e)&&$e!=="layout"&&$e!=="paint"&&$e!=="filter"&&$e!=="metadata"&&$e!=="minzoom"&&$e!=="maxzoom"&&$e!=="slot"&&($e.indexOf("paint.")===0?yt(be[$e],De[$e],re,Te,$e.slice(6),bn.setPaintProperty):i.bx(be[$e],De[$e])||re.push({command:bn.setLayerProperty,args:[Te,$e,De[$e]]}));for($e in De)De.hasOwnProperty($e)&&!be.hasOwnProperty($e)&&$e!=="layout"&&$e!=="paint"&&$e!=="filter"&&$e!=="metadata"&&$e!=="minzoom"&&$e!=="maxzoom"&&$e!=="slot"&&($e.indexOf("paint.")===0?yt(be[$e],De[$e],re,Te,$e.slice(6),bn.setPaintProperty):i.bx(be[$e],De[$e])||re.push({command:bn.setLayerProperty,args:[Te,$e,De[$e]]}))}else re.push({command:bn.removeLayer,args:[Te]}),He=fe[fe.lastIndexOf(Te)+1],re.push({command:bn.addLayer,args:[De,He]})})(q,M.layers,D)}catch(B){console.warn("Unable to compute style diff:",B),D=[{command:bn.setStyle,args:[M]}]}return D})(this.serialize(),n).filter((E=>!(E.command in tg)));if(f.length===0)return!1;const v=f.filter((E=>!(E.command in T)));if(v.length>0)throw new Error(`Unimplemented: ${v.map((E=>E.command)).join(", ")}.`);const w=[];return f.forEach((E=>{w.push(this[E.command](...E.args))})),l&&Promise.all(w).then(l).catch(l),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(n){if(n.size===0)return this;for(const[l,f]of n.entries()){if(this.getImage(l))return this.fire(new i.y(new Error(`An image with the name "${l.name}" already exists.`)));this.imageManager.addImage(l,this.scope,f),this._changes.updateImage(l,this.scope)}return this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this}addImage(n,l){return this.getImage(n)?this.fire(new i.y(new Error(`An image with the name "${n.name}" already exists.`))):(this.imageManager.addImage(n,this.scope,l),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this)}updateImage(n,l,f=!1){this.imageManager.updateImage(n,this.scope,l),f&&(this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})))}getImage(n){return this.imageManager.getImage(n,this.scope)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n,this.scope),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this):this.fire(new i.y(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(n){return this.modelManager.addModelURLs(n,this.scope),this._updateWorkerModels(),this.fire(new i.z("data",{dataType:"style"})),this}addModel(n,l,f={}){return this._checkLoaded(),this._validate(cl,`models.${n}`,l,null,f)||(this.modelManager.addModel(n,l,this.scope),this.fire(new i.z("data",{dataType:"style"}))),this}hasModel(n){return this.modelManager.hasModel(n,this.scope)}removeModel(n){return this.hasModel(n)?(this.modelManager.removeModel(n,this.scope,!1,!0),this.fire(new i.z("data",{dataType:"style"})),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(n,l,f={}){if(this._checkLoaded(),this.getOwnSource(n)!==void 0)throw new Error(`There is already a source with ID "${n}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Dc,`sources.${n}`,l,null,f))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const v=Jo(n,l,this.dispatcher,this);v.scope=this.scope,v.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(v.id),source:v.serialize(),sourceId:v.id})));const w=E=>{const M=(E?"symbol:":"other:")+v.id,D=i.B(M,this.scope),B=this._sourceCaches[M]=new Ws(D,v,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[v.id]=B,B.onAdd(this.map)};w(!1),l.type!=="vector"&&l.type!=="geojson"||w(!0),v.onAdd&&v.onAdd(this.map),f.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(n){this._checkLoaded();const l=this.getOwnSource(n);if(!l)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===n)return this.fire(new i.y(new Error(`Source "${n}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===n)return this.fire(new i.y(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const v=Object.entries(this.stylesheet.iconsets).find((([w,E])=>E.type==="source"&&E.source===n));if(v)return this.fire(new i.y(new Error(`Source "${n}" cannot be removed while iconset "${v[0]}" is using it.`)))}const f=this.getOwnSourceCaches(n);for(const v of f){const w=i.dp(v.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(v.id),v.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles()}return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(n,l){this._checkLoaded(),this.getOwnSource(n).setData(l),this._changes.setDirty()}getOwnSource(n){const l=this.getOwnSourceCache(n);return l&&l.getSource()}getOwnSources(){const n=[];for(const l in this._otherSourceCaches){const f=this.getOwnSourceCache(l);f&&n.push(f.getSource())}return n}areTilesLoaded(){const n=this._mergedSourceCaches;for(const l in n){const f=n[l]._tiles;for(const v in f){const w=f[v];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(n){if(this._checkLoaded(),!n)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const w of n){if(this._validate(ru,"lights",w))return;switch(w.type){case"ambient":if(this.ambientLight){const E=this.ambientLight;E.set(w),E.updateTransitions(l)}else this.ambientLight=new si(w,Cn||(Cn=new i.a9({color:new i.aa(i.a6.properties_light_ambient.color),"color-use-theme":new i.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.aa(i.a6.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const E=this.directionalLight;E.set(w),E.updateTransitions(l)}else this.directionalLight=new si(w,Mi||(Mi=new i.a9({direction:new i.ap(i.a6.properties_light_directional.direction),color:new i.aa(i.a6.properties_light_directional.color),"color-use-theme":new i.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.aa(i.a6.properties_light_directional.intensity),"cast-shadows":new i.aa(i.a6.properties_light_directional["cast-shadows"]),"shadow-quality":new i.aa(i.a6.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.aa(i.a6.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const f=Object.assign(l,{worldview:this.map.getWorldview()}),v=new i.ac(this.z||0,f);this.ambientLight&&this.ambientLight.recalculate(v),this.directionalLight&&this.directionalLight.recalculate(v),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const n=this.directionalLight,l=this.ambientLight;if(!n||!l)return;const f=U=>.2126*(U[0]<=.03928?U[0]/12.92:Math.pow((U[0]+.055)/1.055,2.4))+.7152*(U[1]<=.03928?U[1]/12.92:Math.pow((U[1]+.055)/1.055,2.4))+.0722*(U[2]<=.03928?U[2]/12.92:Math.pow((U[2]+.055)/1.055,2.4)),v=n.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),w=n.properties.get("intensity"),E=n.properties.get("direction"),M=1-i.d3(E.x,E.y,E.z)[2]/90,D=f(v)*w*M,B=l.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),j=l.properties.get("intensity"),q=f(B)*j;return Number(((D+q)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const n=[];return this.directionalLight&&n.push(this.directionalLight.get()),this.ambientLight&&n.push(this.ambientLight.get()),n}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(n){if(n==null||n===""&&this.isRootStyle())return this;if(i.dq(n)){const l=i.dr(n),f=this.fragments.find((({id:w})=>w===l));if(!f)return;const v=i.dp(n);return f.style.getFragmentStyle(v)}{const l=this.fragments.find((({id:f})=>f===n));return l?l.style:void 0}}setFeaturesetSelectors(n){if(!n)return;const l={},f=(v,w="")=>`${v}::${w}`;this._featuresetSelectors={};for(const v in n){const w=this._featuresetSelectors[v]=[];for(const E of n[v].selectors){if(E.featureNamespace){const D=this.getOwnLayer(E.layer);if(!D){i.w(`Layer is undefined for selector: ${E.layer}`);continue}const B=f(D.source,D.sourceLayer);if(B in l&&l[B]!==E.featureNamespace){i.w(`"featureNamespace ${E.featureNamespace} of featureset ${v}'s selector is not associated to the same source, skip this selector`);continue}l[B]=E.featureNamespace}let M;if(E.properties)for(const D in E.properties){const B=i.U(E.properties[D]);B.result==="success"&&(M=M||{},M[D]=B.value)}w.push({layerId:E.layer,namespace:E.featureNamespace,properties:M,uniqueFeatureID:E._uniqueFeatureID})}}}getFeaturesetDescriptors(n){const l=this.getFragmentStyle(n);if(!l||!l.stylesheet.featuresets)return[];const f=[];for(const v in l.stylesheet.featuresets)f.push({featuresetId:v,importId:l.scope?l.scope:void 0});return f}getFeaturesetLayers(n,l){const f=this.getFragmentStyle(l),v=f.stylesheet.featuresets;if(!v||!v[n])return this.fire(new i.y(new Error(`The featureset '${n}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const E of v[n].selectors){const M=f.getOwnLayer(E.layer);M&&w.push(M)}return w}getConfigProperty(n,l){const f=this.getFragmentStyle(n);if(!f)return null;const v=i.B(l,f.scope),w=f.options.get(v),E=w?w.value||w.default:null;return E?E.serialize():null}isIndoorEnabled(){return Object.keys(this._mergedIndoor).length>0}getIndoorSourceLayers(n,l){const f=i.B(n,l);return this._mergedIndoor[f]}setIndoorData(n,l){this.map.indoor.setIndoorData(l)}updateIndoorDependentLayers(){this._updateLayers(this._indoorDependentLayers),this.map._styleDirty=!0,this.map.triggerRepaint()}setConfigProperty(n,l,f){const v=this.getFragmentStyle(n);if(!v)return;const w=v.stylesheet.schema;if(!w||!w[l])return;const E=i.U(f);if(E.result!=="success")return void ml(this,E.value);const M=E.value.expression,D=i.B(l,v.scope),B=v.options.get(D);if(!B)return;let j;const{minValue:q,maxValue:U,stepValue:Y,type:ee,values:re}=w[l],ce=i.U(w[l].default);ce.result==="success"&&(j=ce.value.expression),j?(this.options.set(D,Object.assign({},B,{value:M,default:j,minValue:q,maxValue:U,stepValue:Y,type:ee,values:re})),this.updateConfigDependencies(l)):this.fire(new i.y(new Error(`No schema defined for the config option "${l}" in the "${n}" fragment.`)))}getConfig(n){const l=this.getFragmentStyle(n);if(!l)return null;const f=l.stylesheet.schema;if(!f)return null;const v={};for(const w in f){const E=i.B(w,l.scope),M=l.options.get(E),D=M?M.value||M.default:null;v[w]=D?D.serialize():null}return v}setConfig(n,l){const f=this.getFragmentStyle(n);f&&(f.updateConfig(l,f.stylesheet.schema),this.updateConfigDependencies())}getSchema(n){const l=this.getFragmentStyle(n);return l?l.stylesheet.schema:null}setSchema(n,l){const f=this.getFragmentStyle(n);f&&(f.stylesheet.schema=l,f.updateConfig(f._config,l),this.updateConfigDependencies())}updateConfig(n,l){if(this._config=n,n||l)if(l)for(const f in l){let v,w;const E=i.U(l[f].default);if(E.result==="success"&&(v=E.value.expression),n&&n[f]!==void 0){const U=i.U(n[f]);U.result==="success"&&(w=U.value.expression)}const{minValue:M,maxValue:D,stepValue:B,type:j,values:q}=l[f];if(v){const U=i.B(f,this.scope);this.options.set(U,{default:v,value:w,minValue:M,maxValue:D,stepValue:B,type:j,values:q})}else this.fire(new i.y(new Error(`No schema defined for config option "${f}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}_updateLayers(n,l=(()=>!0)){for(const f of n){const v=this.getLayer(f);v&&l(v)&&(v.possiblyEvaluateVisibility(),this._updateLayer(v),this._changes.setDirty())}}updateConfigDependencies(n){this._updateLayers(this._configDependentLayers,(l=>!n||l.expressionDependencies.configDependencies.has(n))),this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle((l=>{const f=l._styleColorTheme.colorThemeOverride?l._styleColorTheme.colorThemeOverride:l._styleColorTheme.colorTheme;if(f){const v=l._evaluateColorThemeData(f);(!l._styleColorTheme.lut&&v!==""||l._styleColorTheme.lut&&v!==l._styleColorTheme.lut.data)&&l.setColorTheme(f)}})),this._changes.setDirty()}addLayer(n,l,f={}){this._checkLoaded();const v=n.id;if(this._layers[v])return void this.fire(new i.y(new Error(`Layer with id "${v}" already exists on this map`)));let w;if(n.type==="custom"){if(ml(this,i.ds(n)))return;w=i.dt(n,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof n.source=="object"&&(this.addSource(v,n.source),n=i.dn(n),n=Object.assign(n,{source:v})),this._validate(Ka,`layers.${v}`,n,{arrayIndex:-1},f))return;w=i.dt(n,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:v}})}const E=i.B(w.source,w.scope);w.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(E),w.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(E);let M=this._order.length;if(l){const q=this._order.indexOf(l);if(q===-1)return void this.fire(new i.y(new Error(`Layer with id "${l}" does not exist on this map.`)));w.slot===this._layers[l].slot?M=q:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(M,0,v),this._layerOrderChanged=!0,this._layers[v]=w;const D=this.getOwnLayerSourceCache(w),B=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&w.canCastShadows()&&B&&(D.castsShadows=!0);const j=this._changes.getRemovedLayer(w);if(j&&w.source&&D&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const q=i.B(w.source,w.scope);j.type!==w.type?this._changes.updateSourceCache(q,"clear"):(this._changes.updateSourceCache(q,"reload"),D.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(n,l){this._checkLoaded();const f=this._checkLayer(n);if(!f||n===l)return;const v=this._order.indexOf(n);this._order.splice(v,1);let w=this._order.length;if(l){const E=this._order.indexOf(l);if(E===-1)return void this.fire(new i.y(new Error(`Layer with id "${l}" does not exist on this map.`)));f.slot===this._layers[l].slot?w=E:i.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,n),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(n){this._checkLoaded();const l=this._checkLayer(n);if(!l)return;l.setEventedParent(null);const f=this._order.indexOf(n);this._order.splice(f,1),delete this._layers[n],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._indoorDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const v=this.getOwnLayerSourceCache(l);if(v&&v.castsShadows){let w=!1;for(const E in this._layers)if(this._layers[E].source===l.source&&this._layers[E].canCastShadows()){w=!0;break}v.castsShadows=w}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(n){return this._layers[n]}hasLayer(n){return n in this._mergedLayers}hasLayerType(n){for(const l in this._layers)if(this._layers[l].type===n)return!0;return!1}setLayerZoomRange(n,l,f){this._checkLoaded();const v=this._checkLayer(n);v&&(v.minzoom===l&&v.maxzoom===f||(l!=null&&(v.minzoom=l),f!=null&&(v.maxzoom=f),this._updateLayer(v)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(n,l){this._checkLoaded();const f=this._checkLayer(n);f&&f.slot!==l&&(f.slot=l,this._updateLayer(f))}setFilter(n,l,f={}){this._checkLoaded();const v=this._checkLayer(n);if(v&&!i.bx(v.filter,l))return l==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(vn,`layers.${v.id}.filter`,l,{layerType:v.type},f)||(v.filter=i.dn(l),this._updateLayer(v)))}getFilter(n){const l=this._checkLayer(n);if(l)return i.dn(l.filter)}setLayoutProperty(n,l,f,v={}){this._checkLoaded();const w=this._checkLayer(n);if(w&&!i.bx(w.getLayoutProperty(l),f)){if(f!=null&&(!v||v.validate!==!1)&&ml(w,Sa.call(Ms,{key:`layers.${n}.layout.${l}`,layerType:w.type,objectKey:l,value:f,styleSpec:i.a6,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(l,f),w.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),w.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(w.fqid),this._updateLayer(w)}}setLayerProperty(n,l,f,v={}){this._checkLoaded();const w=this._checkLayer(n);w&&(l==="appearances"?(w.setAppearances(f),this._changes.setDirty()):w.isPaintProperty(l)?this.setPaintProperty(n,l,f,v):this.setLayoutProperty(n,l,f,v))}getLayoutProperty(n,l){const f=this._checkLayer(n);if(f)return f.getLayoutProperty(l)}setPaintProperty(n,l,f,v={}){this._checkLoaded();const w=this._checkLayer(n);if(!w||i.bx(w.getPaintProperty(l),f)||f!=null&&(!v||v.validate!==!1)&&ml(w,So.call(Ms,{key:`layers.${n}.paint.${l}`,layerType:w.type,objectKey:l,value:f,styleSpec:i.a6})))return;const E=w.setPaintProperty(l,f);w.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),w.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(w.fqid),E&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(n,l){const f=this._checkLayer(n);if(f)return f.getPaintProperty(l)}setFeatureState(n,l){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:D,importId:B}=n.target,j=this.getFragmentStyle(B),q=j.getFeaturesetLayers(D);for(const{source:U,sourceLayer:Y}of q)j.setFeatureState({id:n.id,source:U,sourceLayer:Y},l)}else if("layerId"in n.target){const{layerId:D}=n.target,B=this.getLayer(D);this.setFeatureState({id:n.id,source:B.source,sourceLayer:B.sourceLayer},l)}return}const f=n.source,v=n.sourceLayer,w=this._checkSource(f);if(!w)return;const E=w.type;if(E==="geojson"&&v)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!v)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const M=this.getOwnSourceCaches(f);for(const D of M)D.setFeatureState(v,n.id,l)}removeFeatureState(n,l){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:D,importId:B}=n.target,j=this.getFragmentStyle(B),q=j.getFeaturesetLayers(D);for(const{source:U,sourceLayer:Y}of q)j.removeFeatureState({id:n.id,source:U,sourceLayer:Y},l)}else if("layerId"in n.target){const{layerId:D}=n.target,B=this.getLayer(D);this.removeFeatureState({id:n.id,source:B.source,sourceLayer:B.sourceLayer},l)}return}const f=n.source,v=this._checkSource(f);if(!v)return;const w=v.type,E=w==="vector"?n.sourceLayer:void 0;if(w==="vector"&&!E)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const M=this.getOwnSourceCaches(f);for(const D of M)D.removeFeatureState(E,n.id,l)}getFeatureState(n){if(this._checkLoaded(),"target"in n){let w;if("featuresetId"in n.target){const{featuresetId:E,importId:M}=n.target,D=this.getFragmentStyle(M),B=D.getFeaturesetLayers(E);for(const{source:j,sourceLayer:q}of B){const U=D.getFeatureState({id:n.id,source:j,sourceLayer:q});if(U&&!w)w=U;else if(!i.bx(w,U))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in n.target){const{layerId:E}=n.target,M=this.getLayer(E);w=this.getFeatureState({id:n.id,source:M.source,sourceLayer:M.sourceLayer})}return w}const l=n.source,f=n.sourceLayer,v=this._checkSource(l);if(v){if(v.type!=="vector"||f)return n.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(f,n.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(n){return this.stylesheet.transition=Object.assign({},this.stylesheet.transition,n),this.transition=this.stylesheet.transition,this}getTransition(){return Object.assign({},this.stylesheet.transition)}serialize(){this._checkLoaded();const n=this.getTerrain(),l=n&&this.terrain&&this.terrain.scope===this.scope?n:this.stylesheet.terrain;return i.du({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(f=>f!==void 0))}_updateFilteredLayers(n){for(const l of Object.values(this._mergedLayers))n(l)&&this._updateLayer(l)}_updateLayer(n){this._changes.updateLayer(n);const l=this.getLayerSourceCache(n),f=i.B(n.source,n.scope),v=this._changes.getUpdatedSourceCaches();n.source&&!v[f]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(f,"reload"),l.pause()),n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const l=M=>this._mergedLayers[M].is3D(!!this.terrain),f=this.order,v={},w=[];for(let M=f.length-1;M>=0;M--){const D=f[M];if(l(D)){v[D]=M;for(const B of n){const j=B[D];if(j)for(const q of j)w.push(q)}}}w.sort(((M,D)=>D.intersectionZ-M.intersectionZ));const E=[];for(let M=f.length-1;M>=0;M--){const D=f[M];if(l(D))for(let B=w.length-1;B>=0;B--){const j=w[B].feature;if(j.layer&&v[j.layer.id]<M)break;E.push(j),w.pop()}else for(const B of n){const j=B[D];if(j)for(const q of j)E.push(q.feature)}}return E}queryRasterValue(n,l,f){const v=this.getOwnSource(n);return v?v.type!=="raster-array"?(this.fire(new i.y(new Error('queryRasterValue support only "raster-array" sources.'))),Promise.resolve(null)):v.queryRasterArrayValue(l,f):(this.fire(new i.y(new Error(`Source with id "${n}" does not exist in the style.`))),Promise.resolve(null))}queryRenderedFeatures(n,l,f){let v;l&&!Array.isArray(l)&&l.filter&&(this._validate(vn,"queryRenderedFeatures.filter",l.filter,null,l),v=i.b5(l.filter));const w={},E=j=>{if(zu.has(j.type))return;const q=this.getOwnLayerSourceCache(j),U=w[q.id]=w[q.id]||{sourceCache:q,layers:{},has3DLayers:!1};j.is3D(!!this.terrain)&&(U.has3DLayers=!0),U.layers[j.fqid]=U.layers[j.fqid]||{styleLayer:j,targets:[]},U.layers[j.fqid].targets.push({filter:v})};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const j of l.layers){const q=this._layers[j];if(!q)return this.fire(new i.y(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];E(q)}}else for(const j in this._layers)E(this._layers[j]);const M=this._queryRenderedFeatures(n,w,f),D=this._flattenAndSortRenderedFeatures(M),B=[];for(const j of D)i.dv(j.layer.id)===this.scope&&B.push(j);return B}queryRenderedFeatureset(n,l,f){let v;l&&!Array.isArray(l)&&l.filter&&(this._validate(vn,"queryRenderedFeatures.filter",l.filter,null,l),v=i.b5(l.filter));const w="mock",E=[];if(l&&l.target)E.push(Object.assign({},l,{targetId:w,filter:v}));else{const j=this.getFeaturesetDescriptors();for(const q of j)E.push({targetId:w,filter:v,target:q});for(const{style:q}of this.fragments){const U=q.getFeaturesetDescriptors();for(const Y of U)E.push({targetId:w,filter:v,target:Y})}}const M=this.queryRenderedTargets(n,E,f),D=[],B=new Set;for(const j of M)for(const q of j.variants[w])Ho(q,j,B)||D.push(new i.dw(j,q));return D}queryRenderedTargets(n,l,f){const v={},w=(M,D,B,j)=>{const q=v[D.id]=v[D.id]||{sourceCache:D,layers:{},has3DLayers:!1};if(q.layers[M.fqid]=q.layers[M.fqid]||{styleLayer:M,targets:[]},M.is3D(!!this.terrain)&&(q.has3DLayers=!0),!j)return B.uniqueFeatureID=!1,void q.layers[M.fqid].targets.push(B);q.layers[M.fqid].targets.push(Object.assign({},B,{namespace:j.namespace,properties:j.properties,uniqueFeatureID:j.uniqueFeatureID}))};for(const M of l)if("featuresetId"in M.target){const{featuresetId:D,importId:B}=M.target,j=this.getFragmentStyle(B);if(!j||!j._featuresetSelectors)continue;const q=j._featuresetSelectors[D];if(!q){this.fire(new i.y(new Error(`The featureset '${D}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const U of q){const Y=j.getOwnLayer(U.layerId);Y&&!zu.has(Y.type)&&w(Y,j.getOwnLayerSourceCache(Y),M,U)}}else if("layerId"in M.target){const{layerId:D}=M.target,B=this.getLayer(D);if(!B||zu.has(B.type))continue;w(B,this.getLayerSourceCache(B),M)}const E=this._queryRenderedFeatures(n,v,f);return this._flattenAndSortRenderedFeatures(E)}_queryRenderedFeatures(n,l,f){const v=[],w=!!this.map._showQueryGeometry,E=Ln.createFromScreenPoints(n,f);for(const M in l){const D=Ds(E,l[M],this._availableImages,f,w);Object.keys(D).length&&v.push(D)}if(this.placement)for(const M in l){if(!l[M].sourceCache._onlySymbols)continue;const D=nc(E.screenGeometry,l[M],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(D).length&&v.push(D)}return v}querySourceFeatures(n,l){const f=l&&l.filter;f&&this._validate(vn,"querySourceFeatures.filter",f,null,l);let v=[];const w=this.getOwnSourceCaches(n);for(const E of w)v=v.concat(yi(E,l));return v}addSourceType(n,l,f){return gl.getSourceType(n)?f(new Error(`A source type called "${n}" already exists.`)):(gl.setSourceType(n,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:l.workerSourceURL},f):f(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(n,l,f={}){this._checkLoaded();const v=this.light.getLight();let w=!1;for(const M in n)if(!i.bx(n[M],v[M])){w=!0;break}if(!w)return;const E=this._getTransitionParameters();this.light.setLight(n,l,f),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.o.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,l=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,n===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let f=n;const v=n.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof f.source=="object"){const M="terrain-dem-src";this.addSource(M,f.source),f=i.dn(f),f=Object.assign(f,{source:M})}const w=Object.assign({},f),E={};if(this.terrain&&v){w.source=this.terrain.get().source;const M=this.terrain?this.getFragmentStyle(this.terrain.scope):null;M&&(E.style=M.serialize())}if(this._validate(ll,"terrain",w,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!v||this.terrain&&l!==this.terrain.drapeRenderMode){if(!f)return;this._createTerrain(f,l),this.fire(new i.z("data",{dataType:"style"}))}else{const w=this.terrain,E=w.get();for(const M of Object.keys(i.a6.terrain))!f.hasOwnProperty(M)&&i.a6.terrain[M].default&&(f[M]=i.a6.terrain[M].default);for(const M in n)if(!i.bx(n[M],E[M])){w.set(n,this.options),this.stylesheet.terrain=n;const D=this._getTransitionParameters({duration:0});w.updateTransitions(D),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const l=this.fog=new Cr(n,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const f=this._getTransitionParameters({duration:0});l.updateTransitions(f)}_createSnow(n){const l=this.snow=new Qi(n,this.map.transform,this.scope,this.options);this.stylesheet.snow=l.get();const f=this._getTransitionParameters({duration:0});l.updateTransitions(f)}_createRain(n){const l=this.rain=new Ti(n,this.map.transform,this.scope,this.options);this.stylesheet.rain=l.get();const f=this._getTransitionParameters({duration:0});l.updateTransitions(f)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const n of this.map._markers)n._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!i.bx(l.get(),n)){l.set(n,this.options),this.stylesheet.fog=l.get();const f=this._getTransitionParameters({duration:0});l.updateTransitions(f)}}else this._createFog(n);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(n){if(this._checkLoaded(),!n)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const l=this.snow;if(!i.bx(l.get(),n)){l.set(n,this.options),this.stylesheet.snow=l.get();const f=this._getTransitionParameters({duration:0});l.updateTransitions(f)}}else this._createSnow(n);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(n){if(this._checkLoaded(),!n)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const l=this.rain;if(!i.bx(l.get(),n)){l.set(n,this.options),this.stylesheet.rain=l.get();const f=this._getTransitionParameters({duration:0});l.updateTransitions(f)}}else this._createRain(n);this._markersNeedUpdate=!0}_reloadColorTheme(){const n=()=>{for(const v in this._layers)this._layers[v].lut=this._styleColorTheme.lut;for(const v in this._sourceCaches)this._sourceCaches[v].clearTiles()},l=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!l)return this._styleColorTheme.lut=null,void n();const f=this._evaluateColorThemeData(l);this._loadColorTheme(f).then((()=>{this.fire(new i.z("colorthemeset")),n()})).catch((v=>{i.w(`Couldn't set color theme: ${v}`)}))}setColorTheme(n){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=n,this._reloadColorTheme()}setImportColorTheme(n,l){const f=this.getFragmentStyle(n);f&&(f._styleColorTheme.colorThemeOverride=l,f._reloadColorTheme())}_getTransitionParameters(n){return{now:i.o.now(),transition:Object.assign(this.transition,n)}}updateDrapeFirstLayers(){if(!this.terrain)return;const n=[],l=[];for(const f of this._mergedOrder)this.isLayerDraped(this._mergedLayers[f])?n.push(f):l.push(f);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...l)}_createTerrain(n,l){const f=this.terrain=new Ue(n,l,this.scope,this.options,this.map.getWorldview());l===1&&(this.stylesheet.terrain=n),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const v=this._getTransitionParameters({duration:0});f.updateTransitions(v)}_force3DLayerUpdate(){for(const n in this._layers){const l=this._layers[n];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const l=this._layers[n];l.type==="symbol"&&this._updateLayer(l)}}_validate(n,l,f,v,w={}){if(w&&w.validate===!1)return!1;const E=Object.assign({},this.serialize());return ml(this,n.call(Ms,Object.assign({key:l,style:E,value:f,styleSpec:i.a6},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.dx.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._mergedLayers)this._mergedLayers[n].setEventedParent(null);for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles(),this._mergedSourceCaches[n].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(n){const l=this.getSourceCaches(n);for(const f of l)f.clearTiles()}clearSources(){for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles()}clearLayers(){for(const n in this._mergedLayers){const l=this._mergedLayers[n];l._clear&&l._clear()}}reloadSource(n){const l=this.getSourceCaches(n);for(const f of l)f.resume(),f.reload()}reloadSources(){for(const n of this.getSources())n.reload&&n.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle((n=>{n.modelManager.reloadModels(n.scope)}))}updateSources(n){let l;this.directionalLight&&(l=Lh(this.directionalLight));const f=new Set;for(const v in this._mergedLayers){const w=this._mergedLayers[v];w.hasElevation()&&!f.has(w.source)&&f.add(w.source)}for(const v in this._mergedSourceCaches){const w=this._mergedSourceCaches[v],E=f.has(w._source.id);w.update(n,void 0,void 0,l,E)}}_generateCollisionBoxes(){for(const n in this._sourceCaches){const l=this._sourceCaches[n];l.resume(),l.reload()}}_updatePlacement(n,l,f,v,w,E,M=!1){let D=!1,B=!1;const j={},q={};for(const U of this._mergedOrder){const Y=this._mergedLayers[U];if(Y.type!=="symbol")continue;const ee=i.B(Y.source,Y.scope);let re=j[ee];if(!re){const ae=this.getLayerSourceCache(Y);if(!ae)continue;const de=ae.getRenderableIds(!0).map((ye=>ae.getTileByID(ye)));q[ee]=de.slice(),re=j[ee]=de.sort(((ye,fe)=>fe.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(fe.tileID)?-1:1)))}const ce=this.crossTileSymbolIndex.addLayer(Y,re,l.center.lng,l.projection);D=D||ce}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),M=M||this._layerOrderChanged||v===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(M||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.o.now(),l.zoom))&&(this.pauseablePlacement=new Gs(l,this._mergedOrder,M,f,v,w,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,j,q,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.o.now()),B=!0),D&&this.pauseablePlacement.placement.setStale()),B||D){this._buildingIndex.onNewFrame(l.zoom);for(let U=0;U<this._mergedOrder.length;U++){const Y=this._mergedLayers[this._mergedOrder[U]];if(Y.type!=="symbol")continue;const ee=this.isLayerClipped(Y);this.placement.updateLayerOpacities(Y,j[i.B(Y.source,Y.scope)],U,ee?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.o.now())}}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}addImport(n,l){this._checkLoaded();const f=this.stylesheet.imports=this.stylesheet.imports||[];if(f.findIndex((({id:w})=>w===n.id))!==-1)return void this.fire(new i.y(new Error(`Import with id '${n.id}' already exists in the map's style.`)));if(!l)return f.push(n),this._loadImports([n],!0);const v=f.findIndex((({id:w})=>w===l));return v===-1&&this.fire(new i.y(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=f.slice(0,v).concat(n).concat(f.slice(v)),this._loadImports([n],!0,l)}updateImport(n,l){this._checkLoaded();const f=this.stylesheet.imports||[],v=this.getImportIndex(n);return v===-1?this:typeof l=="string"?(this.setImportUrl(n,l),this):(l.url&&l.url!==f[v].url&&this.setImportUrl(n,l.url),i.bx(l.config,f[v].config)||this.setImportConfig(n,l.config,l.data.schema),i.bx(l.data,f[v].data)||this.setImportData(n,l.data),this)}moveImport(n,l){this._checkLoaded();let f=this.stylesheet.imports||[];const v=this.getImportIndex(n);if(v===-1)return this;const w=this.getImportIndex(l);if(w===-1)return this;const E=f[v],M=this.fragments[v];return f=f.filter((({id:D})=>D!==n)),this.fragments=this.fragments.filter((({id:D})=>D!==n)),this.stylesheet.imports=f.slice(0,w).concat(E).concat(f.slice(w)),this.fragments=this.fragments.slice(0,w).concat(M).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(n,l){this._checkLoaded();const f=this.stylesheet.imports||[],v=this.getImportIndex(n);if(v===-1)return this;f[v].url=l;const w=this.fragments[v];return w.style=this._createFragmentStyle(f[v]),w.style.on("style.import.load",(()=>this.mergeAll())),w.style.loadURL(l),this}setImportData(n,l){this._checkLoaded();const f=this.getImportIndex(n),v=this.stylesheet.imports||[];return f===-1?this:l?(this.fragments[f].style.setState(l),this._reloadImports(),this):(delete v[f].data,this.setImportUrl(n,v[f].url))}setImportConfig(n,l,f){this._checkLoaded();const v=this.getImportIndex(n),w=this.stylesheet.imports||[];if(v===-1)return this;l?w[v].config=l:delete w[v].config;const E=this.fragments[v];f&&E.style.stylesheet&&(E.style.stylesheet.schema=f);const M=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=l,E.style.updateConfig(l,M),this.updateConfigDependencies(),this}removeImport(n){this._checkLoaded();const l=this.stylesheet.imports||[],f=this.getImportIndex(n);f!==-1&&(l.splice(f,1),this.fragments[f].style._remove(),this.fragments.splice(f,1),this._reloadImports())}getImportIndex(n){const l=(this.stylesheet.imports||[]).findIndex((f=>f.id===n));return l===-1&&this.fire(new i.y(new Error(`Import '${n}' does not exist in the map's style and cannot be updated.`))),l}getLayer(n){return this._mergedLayers[n]}getSources(){const n=[];for(const l in this._mergedOtherSourceCaches){const f=this._mergedOtherSourceCaches[l];f&&n.push(f.getSource())}return n}getSource(n,l){const f=this.getSourceCache(n,l);return f&&f.getSource()}getLayerSource(n){const l=this.getLayerSourceCache(n);return l&&l.getSource()}getSourceCache(n,l){const f=i.B(n,l);return this._mergedOtherSourceCaches[f]}getLayerSourceCache(n){const l=i.B(n.source,n.scope);return n.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(n){if(n==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[n]&&l.push(this._mergedOtherSourceCaches[n]),this._mergedSymbolSourceCaches[n]&&l.push(this._mergedSymbolSourceCaches[n]),l}updateSourceCaches(){const n=this._changes.getUpdatedSourceCaches();for(const l in n){const f=n[l];f==="reload"?this.reloadSource(l):f==="clear"&&this.clearSource(l)}}updateLayers(n){const l=this._changes.getUpdatedPaintProperties();for(const f of l){const v=this.getLayer(f);v&&v.updateTransitions(n)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(n){this.stylesheet.glyphs=n,this.glyphManager.setURL(n)}getImages(n,l,f){this.imageManager.getImages(l.images,l.scope,f),this._updateTilesForChangedImages();const v=E=>{if(E){const M=l.images.map((D=>i.I.toString(D)));E.setDependencies(l.tileID.key,l.type,M)}},w=i.B(l.source,l.scope);v(this._mergedOtherSourceCaches[w]),v(this._mergedSymbolSourceCaches[w]),l.images.some((E=>E.iconsetId))&&this.fire(new i.z("data",{dataType:"style"}))}rasterizeImages(n,l,f){this.imageManager.rasterizeImages(l,f)}getGlyphs(n,l,f){this.glyphManager.getGlyphs(l.stacks,f)}getResource(n,l,f){return i.dy(l,f)}getOwnSourceCache(n){return this._otherSourceCaches[n]}getOwnLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}getOwnSourceCaches(n){const l=[];return this._otherSourceCaches[n]&&l.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&l.push(this._symbolSourceCaches[n]),l}_isSourceCacheLoaded(n){const l=this.getOwnSourceCaches(n);return l.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${n}'`))),!1):l.every((f=>f.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(n,l){if(!this._clipLayerPresent&&n.type!=="fill-extrusion"&&n.type!=="building")return!1;const f=n.type==="fill-extrusion"&&(n.sourceLayer==="building"||n.sourceLayer==="procedural_buildings"),v=n.type==="building";if(n.is3D(!!this.terrain)){if(f||v||l&&l.type==="batched-model"||n.type==="model")return!0}else if(n.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((n=>{n.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}gl.getSourceType=function(h){return Cs[h]},gl.setSourceType=function(h,n){Cs[h]=n},gl.registerForPluginStateChange=i.dz;class ad extends i.E{constructor(n){super(),this._style=n,this._buildings={},this._activeFloors=new Set,this._activeFloorsVisible=!0,this._indoorState={selectedFloorId:null,lastActiveFloors:null,activeFloorsVisible:!0},i.aX(["_updateUI"],this)}destroy(){this._buildings={},this._activeFloors=new Set,this._indoorState=null}selectFloor(n){n===this._selectedFloorId&&this._activeFloorsVisible||(this._selectedFloorId=n,this._activeFloorsVisible=!0,this._updateActiveFloors())}setActiveFloorsVisibility(n){this._activeFloorsVisible=n,this._updateActiveFloors(),this._updateIndoorSelector()}setIndoorData(n){for(const[l,f]of Object.entries(n.buildings))if(this._buildings[l])for(const v of f.floorIds)this._buildings[l].floors[v]||(this._buildings[l].floors[v]=f.floors[v]);else this._buildings[l]=f;for(const l of n.activeFloors)this._activeFloors.add(l);this._updateIndoorSelector()}getIndoorTileOptions(n,l){const f=this._style.getIndoorSourceLayers(n,l);return f&&this._indoorState?{sourceLayers:f,indoorState:this._indoorState}:null}_updateUI(n,l,f){const v=(function(w,E,M,D){let B=null,j=Number.MAX_SAFE_INTEGER;if(D<16)return null;for(const[q,U]of Object.entries(w)){const Y=U.center;if(Y){const ee=E.distanceTo(i.aS.convert(Y));ee<j&&M.contains(Y)&&(j=ee,B=q)}}return B})(this._buildings,l,f,n);v!==this._closestBuildingId&&(this._closestBuildingId=v,this._updateIndoorSelector())}_updateIndoorSelector(){const n=this._buildings,l=this._closestBuildingId,f=l&&n?n[l]:void 0;if(!f)return void this.fire(new i.z("selector-update",{selectedFloorId:null,activeFloorsVisible:this._activeFloorsVisible,floors:[]}));let v=null;for(const E of f.floorIds)if(this._activeFloors&&this._activeFloors.has(E)){v=E;break}const w=Array.from(f.floorIds).map((E=>({id:E,name:f.floors[E].name,zIndex:f.floors[E].zIndex}))).sort(((E,M)=>M.zIndex-E.zIndex));this.fire(new i.z("selector-update",{selectedFloorId:v,activeFloorsVisible:this._activeFloorsVisible,floors:w}))}_updateActiveFloors(){const n=this._activeFloors;this._activeFloors=new Set,this._indoorState={selectedFloorId:this._selectedFloorId,lastActiveFloors:n,activeFloorsVisible:this._activeFloorsVisible},this._style.updateIndoorDependentLayers()}}var ld=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,cd=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb*col.a,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Nf=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifndef HAS_SHADER_STORAGE_BLOCK_material_buffer
#define GET_ATTRIBUTE_float(attrib,matInfo,attrib_id) attrib
#define GET_ATTRIBUTE_vec4(attrib,matInfo,attrib_id) attrib
#define GET_ATTRIBUTE_vec2(attrib,matInfo,attrib_id) attrib
#define DECLARE_MATERIAL_TABLE_INFO
#endif`,jd="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Fu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,$p=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Vf=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,_l=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Uf=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Ut=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Wp=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Bl=[];fc(ld,Bl),fc(Nf,Bl),fc(cd,Bl);const ud={"_prelude_fog.vertex.glsl":$p,"_prelude_terrain.vertex.glsl":Fu,"_prelude_shadow.vertex.glsl":Ut,"_prelude_material_table.vertex.glsl":`#ifdef HAS_SHADER_STORAGE_BLOCK_material_buffer
#define MATERIAL_TABLE_DEBUG 0
uniform int u_material_offset;uniform int u_vertex_offset;layout(std140,binding=0)readonly buffer material_buffer{uvec4 material_data[];};struct MaterialInfo{uint dataOffset;
#if MATERIAL_TABLE_DEBUG
vec4 colorDebug;
#endif
};uint read_buf_no_offset(uint iDword) {return material_data[iDword/4u][iDword % 4u];}uint read_buf(uint iDword) {iDword+=uint(u_material_offset/4);return read_buf_no_offset(iDword);}float read_buf_float(uint iDword){return uintBitsToFloat(read_buf(iDword));}uint read_buf_uint8(uint iDword,uint iUint8){uint dwordOffset=iDword+(iUint8/4u);uint byteOffset=iUint8 & 3u;uint bitOffset=8u*byteOffset;uint mask=0xffu << bitOffset;uint dwordVal=read_buf(dwordOffset);return (dwordVal & mask) >> bitOffset;}uint read_buf_uint16(uint iDword,uint iUint16){uint dwordOffset=iDword+(iUint16 >> 1u);uint bitOffset=(iUint16 & 1u)*16u;uint mask=0xffffu << bitOffset;uint dwordVal=read_buf(dwordOffset);return (dwordVal & mask) >> bitOffset;}uint nrDwordsForVertexIdEntries(uint nrMaterialLookupEntries) {return nrMaterialLookupEntries;}uint nrDwordsForMaterialIdEntries(uint nrMaterialLookupEntries) {return (nrMaterialLookupEntries*2u+3u)/4u;}uint findRangeBinarySearch(uint vertexId,uint numRanges,uint dwordOffset) {uint left=0u;uint right=numRanges-1u;for (uint i=0u; i < 16u; i++) { 
if (left > right) {break;}uint mid=(left+right)/2u;uint start=read_buf(dwordOffset+mid);uint nextStart=(mid+1u < numRanges) ? read_buf(dwordOffset+mid+1u) : 0xffffffffu;if (vertexId >=start && vertexId < nextStart) {return mid;} else if (vertexId < start) {if (mid==0u) {break;}right=mid-1u;} else {left=mid+1u;}}return 0u; 
}uint readVertexId(uint dwordOffset,uint iMaterialLookupEntry) {return read_buf(dwordOffset+iMaterialLookupEntry);}uint findRange(uint vertexId,uint numRanges,uint dwordOffset) {uint iRange;if(numRanges <=64u){uint vertexBegin;for(iRange=0u; iRange < numRanges;++iRange) {vertexBegin=readVertexId(dwordOffset,iRange);if(vertexBegin > vertexId) {break;}}iRange=iRange==0u? 0u : iRange-1u;} else { 
iRange=findRangeBinarySearch(vertexId,numRanges,dwordOffset);}return iRange;}MaterialInfo read_material_info(uint vertex_id) {MaterialInfo info;
#if MATERIAL_TABLE_DEBUG
const vec4 red=vec4(1.0,0.0,0.0,1.0);const vec4 orange=vec4(1.0,0.5,0.0,1.0);const vec4 yellow=vec4(1.0,1.0,0.0,1.0);const vec4 green=vec4(0.0,1.0,0.0,1.0);const vec4 indigo=vec4(0.294,0.0,0.510,1.0);const vec4 blue=vec4(0.0,0.0,1.0,1.0);const vec4 purple=vec4(0.5,0.0,0.5,1.0);const vec4 pink=vec4(1.0,0.0,1.0,1.0);info.colorDebug=green;
#endif
uint offset=0u;
#if MATERIAL_TABLE_DEBUG
bool keepFinding=true;uint magic=read_buf(offset);if(magic !=0xCAFEBABEu) {info.colorDebug=red;keepFinding=false;return info;}
#endif
offset++;
#if MATERIAL_TABLE_DEBUG
uint nrMaterials=read_buf(offset);uint nrVertices=read_buf(offset+1u);if(keepFinding && vertex_id >=nrVertices) {info.colorDebug=red;keepFinding=false;}
#endif
offset+=2u;uint nrMaterialLookupEntries=read_buf(offset++);uint perMaterialEntrySizeDwords=read_buf(offset++);
#if MATERIAL_TABLE_DEBUG
if(keepFinding && perMaterialEntrySizeDwords !=1u) {info.colorDebug=red;keepFinding=false;}
#endif
uint iMaterialLookup=findRange(vertex_id,nrMaterialLookupEntries,offset);
#if MATERIAL_TABLE_DEBUG
if(keepFinding)
{uint vertexBeginCheck=readVertexId(offset,iMaterialLookup);if(vertexBeginCheck > vertex_id) {info.colorDebug=red;keepFinding=false;}if(iMaterialLookup < nrMaterialLookupEntries-1u) {uint vertexEndCheck=readVertexId(offset,iMaterialLookup+1u);if(vertexEndCheck <=vertex_id) {info.colorDebug=red;keepFinding=false;}}}
#endif
offset+=nrDwordsForVertexIdEntries(nrMaterialLookupEntries);uint materialId=iMaterialLookup;
#if MATERIAL_TABLE_DEBUG
if(keepFinding) {if(materialId >=nrMaterialLookupEntries) {info.colorDebug=red;}}
#endif
info.dataOffset=offset+materialId*perMaterialEntrySizeDwords;return info;}uint get_data_location(const MaterialInfo matInfo,uint attribOffsetBytes)
{uint attribFieldOffsetDwords=attribOffsetBytes/4u;return matInfo.dataOffset+attribFieldOffsetDwords;}vec4 read_material_vec4(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return vec4(read_buf_float(loc),read_buf_float(loc+1u),read_buf_float(loc+2u),read_buf_float(loc+3u));}vec2 read_material_vec2(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return vec2(read_buf_float(loc),read_buf_float(loc+1u));}float read_material_float(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return read_buf_float(loc);}
#define GET_ATTRIBUTE_float(attrib,matInfo,attrib_offset) read_material_float(matInfo,attrib_offset)
#define GET_ATTRIBUTE_vec4(attrib,matInfo,attrib_offset) read_material_vec4(matInfo,attrib_offset)
#define GET_ATTRIBUTE_vec2(attrib,matInfo,attrib_offset) read_material_vec2(matInfo,attrib_offset)
#define DECLARE_MATERIAL_TABLE_INFO MaterialInfo materialInfo=read_material_info(uint(gl_VertexID));
#define DECLARE_MATERIAL_TABLE_INFO_DEBUG(dbgColor) MaterialInfo materialInfo=read_material_info(uint(gl_VertexID)); dbgColor=materialInfo.colorDebug;
#endif`,"_prelude_fog.fragment.glsl":Vf,"_prelude_shadow.fragment.glsl":Wp,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":_l,"_prelude_raster_particle.glsl":Uf},Nd={};xn("",Fu),xn(Vf,$p),xn(Wp,Ut),xn(_l,""),xn(Uf,"");const $f=xn(cd,Nf),uu=ld;var dd={background:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef FLOOD_LIGHT
in highp float v_flood_radius;in float v_has_flood_light;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;uniform vec3 u_flood_light_color;uniform float u_flood_light_intensity;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=linearTosRGB(color.rgb);
#ifdef FLOOD_LIGHT
float flood_radiance=(1.0-min(v_pos.z/v_flood_radius,1.0))*u_flood_light_intensity*v_has_flood_light;color.rgb=mix(color.rgb,u_flood_light_color,flood_radiance);
#endif
color.rgb=mix(color.rgb,linearTosRGB(base_color.rgb),emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in float a_flood_light_wall_radius_1i16;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
#ifdef FLOOD_LIGHT
out highp float v_flood_radius;out float v_has_flood_light;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;const float FLOOD_LIGHT_MAX_RADIUS_METER=2048.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
#ifdef FLOOD_LIGHT
v_flood_radius=(a_flood_light_wall_radius_1i16/MAX_INT_16*FLOOD_LIGHT_MAX_RADIUS_METER);v_has_flood_light=step(0.0,v_flood_radius);
#endif
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:xn(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:xn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:xn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:xn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:xn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:xn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:xn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:xn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:xn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:xn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#else
#ifdef FEATURE_CUTOUT
apply_feature_cutout(vec4(0.0,0.0,0.0,1.0),gl_FragCoord);
#endif
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:xn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:xn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:xn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:xn(`precision highp float;uniform highp sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),1.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:xn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:xn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:xn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:xn(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#define APPEARANCE_ICON 1.0
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float a_size_max= floor(a_size[1]*0.5);float a_apperance_icon=a_size[1]-2.0*a_size_max;vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (a_apperance_icon==APPEARANCE_ICON) {size=a_size_max/128.0;} else if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size_max,u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
#ifdef Z_TEST_OCCLUSION
out_fade_opacity*=occlusion_opacity;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:xn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:xn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,jd),skyboxGradient:xn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,jd),skyboxCapture:xn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:xn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_atmosphere_fog_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_atmosphere_fog_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_atmosphere_fog_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:xn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef FLIP_Y
coord.y=1.0-coord.y;
#endif
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#ifdef CLIP_ZERO_TO_ONE
v_depth=-1.0+2.0*v_depth; 
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:xn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:xn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:xn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:xn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:xn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:xn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function fc(h,n){const l=h.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let f of l)if(f=f.trim(),f[0]==="#"&&f.includes("if")&&!f.includes("endif")){f=f.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=f.split(" ");for(const w of v)n.includes(w)||n.push(w)}}function xn(h,n){const l=/#include\s+"([^"]+)"/g,f=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,v={},w=[],E=[];if(h=h.replace(l,((D,B)=>(E.push(B),""))),(n=n.replace(l,((D,B)=>(w.push(B),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let M=[...Bl];fc(h,M),fc(n,M);for(const D of[...w,...E])ud[D]||console.error(`Undefined include: ${D}`),Nd[D]||(Nd[D]=[],fc(ud[D],Nd[D])),M=[...M,...Nd[D]];return{fragmentSource:h=h.replace(f,((D,B,j,q,U)=>(v[U]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${U}
in ${j} ${q} ${U};
#else
uniform ${j} ${q} u_${U};
#endif
`:B==="initialize"?`
#ifdef HAS_UNIFORM_u_${U}
    ${j} ${q} ${U} = u_${U};
#endif
`:B==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${U}
    in ${j} ${q} ${U};
#endif
`:B==="initialize-attribute"?"":void 0))),vertexSource:n=n.replace(f,((D,B,j,q,U)=>{const Y=`MATERIAL_ATTRIBUTE_OFFSET_${U}`,ee=q==="float"?"vec2":q,re=`GET_ATTRIBUTE_${ee}(a_${U}, materialInfo, ${Y})`,ce=U.match(/color/)?"color":ee;return B==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${U}
in ${j} ${q} a_${U};
#endif
`:v[U]?B==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
    #if !defined(${Y})
        in ${j} ${ee} a_${U};
    #endif
out ${j} ${q} ${U};
#else
uniform ${j} ${q} u_${U};
#endif
`:B==="initialize"?ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${j} ${q} ${U} = u_${U};
#endif
`:`
#if !defined(HAS_UNIFORM_u_${U}) 
    #ifdef ${Y}
        ${U} = unpack_mix_${ce}(${re}, u_${U}_t);
    #else
        ${U} = unpack_mix_${ce}(a_${U}, u_${U}_t);
    #endif
#else
    ${j} ${q} ${U} = u_${U};
#endif
`:B==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${U}
    in ${j} ${q} a_${U};
    out ${j} ${q} ${U};
#endif
`:B==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${U}
    ${U} = a_${U};
#endif
`:void 0:B==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
    #if !defined(${Y})
        in ${j} ${ee} a_${U};
    #endif  
#else
uniform ${j} ${q} u_${U};
#endif
`:B==="define-instanced"?ce==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${U}0;
in vec4 a_${U}1;
in vec4 a_${U}2;
in vec4 a_${U}3;
#else
uniform ${j} ${q} u_${U};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${j} ${ee} a_${U};
#else
uniform ${j} ${q} u_${U};
#endif
`:B==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${U}
    ${j} ${q} ${U} = a_${U};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    #ifdef ${Y}
        ${j} ${q} ${U} = ${re};
    #else
        ${j} ${q} ${U} = a_${U};
    #endif
#else
    ${j} ${q} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    #ifdef ${Y}
        ${j} ${q} ${U} = unpack_mix_${ce}(${re}, u_${U}_t);
    #else
        ${j} ${q} ${U} = unpack_mix_${ce}(a_${U}, u_${U}_t);
    #endif
#else
    ${j} ${q} ${U} = u_${U};
#endif
`})),usedDefines:M,vertexIncludes:w,fragmentIncludes:E}}class Vd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,l,f,v,w,E,M,D){this.context=n;let B=this.boundPaintVertexBuffers.length!==v.length;for(let q=0;!B&&q<v.length;q++)this.boundPaintVertexBuffers[q]!==v[q]&&(B=!0);let j=this.boundDynamicVertexBuffers.length!==M.length;for(let q=0;!j&&q<M.length;q++)this.boundDynamicVertexBuffers[q]!==M[q]&&(j=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==f||B||j||this.boundIndexBuffer!==w||this.boundVertexOffset!==E)this.freshBind(l,f,v,w,E,M,D);else{n.bindVertexArrayOES.set(this.vao);for(const q of M)q&&(q.bind(),D&&q.instanceCount&&q.setVertexAttribDivisor(n.gl,l,D));w&&w.dynamicDraw&&w.bind()}}freshBind(n,l,f,v,w,E,M){const D=this.context,B=D.gl;this.vao&&this.destroy(),this.vao=D.gl.createVertexArray(),D.bindVertexArrayOES.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=v,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=E,l.enableAttributes(B,n),l.bind(),l.setVertexAttribPointers(B,n,w);for(const j of f)j.enableAttributes(B,n),j.bind(),j.setVertexAttribPointers(B,n,w);for(const j of E)j&&(j.enableAttributes(B,n),j.bind(),j.setVertexAttribPointers(B,n,w),M&&j.instanceCount&&j.setVertexAttribDivisor(B,n,M));v&&v.bind()}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Uo(h,n){const l=Math.pow(2,n.canonical.z),f=n.canonical.y;return[new i.ae(0,f/l).toLngLat().lat,new i.ae(0,(f+1)/l).toLngLat().lat]}function rg(h,n,l,f,v,w,E){const M=h.context,D=M.gl,B=l.hillshadeFBO;if(!B)return;h.prepareDrawTile();const j=h.isTileAffectedByFog(n),q=h.getOrCreateProgram("hillshade",{overrideFog:j});M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,B.colorAttachment.get());const U=((ce,ae,de,ye)=>{const fe=de.paint.get("hillshade-shadow-color"),Me=de.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",xe=de.paint.get("hillshade-highlight-color"),Ce=de.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Te=de.paint.get("hillshade-accent-color"),be=de.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",De=de.paint.get("hillshade-emissive-strength");let He=i.an(de.paint.get("hillshade-illumination-direction"));if(de.paint.get("hillshade-illumination-anchor")==="viewport")He-=ce.transform.angle;else if(ce.style&&ce.style.enable3dLights()&&ce.style.directionalLight){const st=ce.style.directionalLight.properties.get("direction"),Qe=i.d3(st.x,st.y,st.z);He=i.an(Qe[1])}const $e=!ce.options.moving;return{u_matrix:ye||ce.transform.calculateProjMatrix(ae.tileID.toUnwrapped(),$e),u_image:0,u_latrange:Uo(0,ae.tileID),u_light:[de.paint.get("hillshade-exaggeration"),He],u_shadow:fe.toPremultipliedRenderColor(Me?null:de.lut),u_highlight:xe.toPremultipliedRenderColor(Ce?null:de.lut),u_emissive_strength:De,u_accent:Te.toPremultipliedRenderColor(be?null:de.lut)}})(h,l,f,h.terrain?n.projMatrix:null);h.uploadCommonUniforms(M,q,n.toUnwrapped());const{tileBoundsBuffer:Y,tileBoundsIndexBuffer:ee,tileBoundsSegments:re}=h.getTileBoundsBuffers(l);q.draw(h,D.TRIANGLES,v,w,E,Vr.disabled,U,f.id,Y,ee,re)}function Ud(h,n,l){if(!n.needsDEMTextureUpload)return;const f=h.context,v=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||h.getTileTexture(l.stride);const w=l.getPixels();n.demTexture?n.demTexture.update(w,{premultiply:!1}):n.demTexture=new i.T(f,w,v.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Wf(h,n,l){const f=h.context,v=f.gl;if(!n.dem)return;const w=n.dem;if(f.activeTexture.set(v.TEXTURE1),Ud(h,n,w),!n.demTexture)return;n.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE);const E=w.dim;f.activeTexture.set(v.TEXTURE0);let M=n.hillshadeFBO;if(!M){const U=new i.T(f,{width:E,height:E,data:null},v.RGBA8);U.bind(v.LINEAR,v.CLAMP_TO_EDGE),M=n.hillshadeFBO=f.createFramebuffer(E,E,!0,"renderbuffer"),M.colorAttachment.set(U.texture)}f.bindFramebuffer.set(M.framebuffer),f.viewport.set([0,0,E,E]);const{tileBoundsBuffer:D,tileBoundsIndexBuffer:B,tileBoundsSegments:j}=h.getMercatorTileBoundsBuffers(),q=[];h.linearFloatFilteringSupported()&&q.push("TERRAIN_DEM_FLOAT_FORMAT"),h.getOrCreateProgram("hillshadePrepare",{defines:q}).draw(h,v.TRIANGLES,pr.disabled,Nr.disabled,en.unblended,Vr.disabled,((U,Y)=>{const ee=Y.stride,re=i.bB();return i.cd(re,0,i.al,-i.al,0,0,1),i.bq(re,re,[0,-i.al,0]),{u_matrix:re,u_image:1,u_dimension:[ee,ee],u_zoom:U.overscaledZ}})(n.tileID,w),l.id,D,B,j),n.needsHillshadePrepare=!1}class $i{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qp extends $i{getDefault(){return i.ao.transparent.toNonPremultipliedRenderColor(null)}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class $d extends $i{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Gp extends $i{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Bh extends $i{getDefault(){return[!0,!0,!0,!0]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class w_ extends $i{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class ov extends $i{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class S_ extends $i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const l=this.current;(n.func!==l.func||n.ref!==l.ref||n.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class T_ extends $i{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Wd extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=n,this.dirty=!1}}class Hp extends $i{getDefault(){return[0,1]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Yp extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=n,this.dirty=!1}}class qf extends $i{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class jh extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.BLEND):l.disable(l.BLEND),this.current=n,this.dirty=!1}}class Gf extends $i{getDefault(){const n=this.gl;return[n.ONE,n.ZERO,n.ONE,n.ZERO]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class qd extends $i{getDefault(){return i.ao.transparent.toNonPremultipliedRenderColor(null)}set(n){const l=this.current;(n.r!==l.r||n.g!==l.g||n.b!==l.b||n.a!==l.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Gd extends $i{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(n,n),this.current=n,this.dirty=!1)}}class Hf extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;n?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=n,this.dirty=!1}}class Nh extends $i{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Zp extends $i{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let du=class extends $i{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}};class ng extends $i{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class zc extends $i{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const l=this.current;(n[0]!==l[0]||n[1]!==l[1]||n[2]!==l[2]||n[3]!==l[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class jl extends $i{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class hd extends $i{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Fc extends $i{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Vh extends $i{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Yf extends $i{getDefault(){return null}set(n){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class E_ extends $i{getDefault(){return null}set(n){this.gl&&(n!==this.current||this.dirty)&&(this.gl.bindVertexArray(n),this.current=n,this.dirty=!1)}}class fd extends $i{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Uh extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class kc extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Hd extends $i{constructor(n,l){super(n),this.context=n,this.parent=l}getDefault(){return null}}class ig extends Hd{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Yd extends Hd{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class pd extends Hd{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Po extends Yd{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const vo=(h,n,l)=>({u_matrix:h,u_image0:0,u_skirt_height:n,u_ground_shadow_factor:l}),Bc=(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(f),u_merc_matrix:l,u_zoom_transition:v,u_merc_center:w,u_image0:0,u_frustum_tl:E,u_frustum_tr:M,u_frustum_br:D,u_frustum_bl:B,u_globe_pos:j,u_globe_radius:q,u_viewport:U,u_grid_matrix:re?Float32Array.from(re):new Float32Array(9),u_skirt_height:Y,u_far_z_cutoff:ee});function Hs(h,n){return h!=null&&n!=null&&!(!h.hasData()||!n.hasData())&&h.demTexture!=null&&n.demTexture!=null&&h.tileID.key!==n.tileID.key}const Ls=new class{constructor(){this.operations={}}newMorphing(h,n,l,f,v){if(h in this.operations){const w=this.operations[h];w.to.tileID.key!==l.tileID.key&&(w.queued=l)}else this.operations[h]={startTime:f,phase:0,duration:v,from:n,to:l,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const n=this.operations[h];return{from:n.from,to:n.to,phase:n.phase}}update(h){for(const n in this.operations){const l=this.operations[n];for(l.phase=(h-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,h)){delete this.operations[n];break}}}_nextOp(h,n){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=n,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},ku={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Zd(h,n,l){if(n===0)return 0;const f=n<1&&l===514?.25/n:1;return 6*Math.pow(1.5,22-h)*Math.max(n,1)*f}function ua(h,n){const l=1<<h.z;return!n&&(h.x===0||h.x===l-1)||h.y===0||h.y===l-1}const hu=h=>({u_matrix:h});function Zf(h,n,l,f,v){if(v>0){const w=i.o.now(),E=(w-h.timeAdded)/v,M=n?(w-n.timeAdded)/v:-1,D=l.getSource(),B=f.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),j=!n||Math.abs(n.tileID.overscaledZ-B)>Math.abs(h.tileID.overscaledZ-B),q=j&&h.refreshedUponExpiration?1:i.aA(j?E:1-M,0,1);return n?{opacity:1,mix:1-q,isFading:E<1}:{opacity:q,mix:0,isFading:E<1}}return{opacity:1,mix:0,isFading:!1}}class yl extends Ws{constructor(n){const l=Jo("mock-dem",{type:"raster-dem",maxzoom:n.transform.maxZoom},n.style.dispatcher,n.style);super("mock-dem",l,!1),l.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,l){n.state="loaded",l(null)}}class $h extends Ws{constructor(n){const l=Jo("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},n.style.dispatcher,n.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,l,f){if(n.freezeTileCoverage)return;this.transform=n;const v=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((w,E)=>{if(w[E.key]="",!this._tiles[E.key]){const M=new jo(E,this._source.tileSize*E.overscaleFactor(),n.tileZoom,void 0,void 0,this._source.worldview);M.state="loaded",this._tiles[E.key]=M}return w}),{});for(const w in this._tiles)w in v||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(n){const l=this.proxyCachedFBO[n];if(l!==void 0){const f=Object.values(l);this.renderCachePool.push(...f),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach((n=>n.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Wh extends i.aP{constructor(n,l,f){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=l,this.projMatrix=f}}class Nl extends i.bU{constructor(n,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},n.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),n.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),n.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[f,v,w]=(function(D){const B=new i.bc,j=new i.b0,q=131;B.reserve(17161),j.reserve(33800);const U=i.al/128,Y=i.al+U/2,ee=Y+U;for(let ce=-U;ce<ee;ce+=U)for(let ae=-U;ae<ee;ae+=U){const de=ae<0||ae>Y||ce<0||ce>Y?24575:0,ye=i.aA(Math.round(ae),0,i.al),fe=i.aA(Math.round(ce),0,i.al);B.emplaceBack(ye+de,fe)}const re=(ce,ae)=>{const de=ae*q+ce;j.emplaceBack(de+1,de,de+q),j.emplaceBack(de+q,de+q+1,de+1)};for(let ce=1;ce<129;ce++)for(let ae=1;ae<129;ae++)re(ae,ce);return[0,129].forEach((ce=>{for(let ae=0;ae<130;ae++)re(ae,ce),re(ce,ae)})),[B,j,32768]})(),E=n.context;this.gridBuffer=E.createVertexBuffer(f,i.be.members),this.gridIndexBuffer=E.createIndexBuffer(v),this.gridSegments=i.bf.simpleSegment(0,0,f.length,v.length),this.gridNoSkirtSegments=i.bf.simpleSegment(0,0,f.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new $h(l.map),this.orthoMatrix=i.bB(),i.cd(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.al,0,i.al,0,1);const M=E.gl;this._overlapStencilMode=new Nr({func:M.GEQUAL,mask:255},0,255,M.KEEP,M.KEEP,M.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new yl(l.map),this._pendingGroundEffectLayers=[]}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),this._style=n,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(n,l,f){if(n&&n.terrain){this._style!==n&&(this.style=n,this._evaluationZoom=void 0);const v=n.terrain.properties,w=n.terrain.drapeRenderMode===0,E=n.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.o.now();const M=n.terrain&&n.terrain.scope,D=v.get("source"),B=w?this._mockSourceCache:n.getSourceCache(D,M);if(!B)return void i.w(`Couldn't find terrain source "${D}".`);if(this.sourceCache=B,this._attenuationRange=n.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(l):v.get("exaggeration"),!l.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const j=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const q=this.getScaledDemTileSize();this.sourceCache.update(l,q,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,j(),this._initializing=!0),j(),l.updateElevation(!0,f),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(n){if(this._attenuationRange&&n.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(n.zoom);const l=this._previousCameraAltitude,f=n.getFreeCameraOptions().position.z/n.pixelsPerMeter*n.worldSize;this._previousCameraAltitude=f;const v=l!=null?f-l:Number.MAX_VALUE;if(Math.abs(v)<2)return this._exaggeration;const w=n.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(w);let M=w-this._previousZoom;const D=this._previousUpdateTimestamp;let B=w;this._evaluationZoom!=null&&(B=this._evaluationZoom,Math.abs(w-B)>.5&&(M=.5*(w-B+M)),M*v<0&&(B+=M)),this._evaluationZoom=B;const j=E.getExaggeration(B),q=j===E.getExaggeration(Math.max(0,B-.1));if(q&&Math.abs(j-this._exaggeration)<.01)return j;let U=Math.min(.1,.00375*(this._updateTimestamp-D));return(q||j<.1||Math.abs(M)<1e-4)&&(U=Math.min(.2,4*U)),i.ak(this._exaggeration,j,U)}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(n){n.dataType==="source"&&n.coord?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._mergedSourceCaches)this._style._mergedSourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((n=>n.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=f._centerAltitude===0&&this.getAtPointOrZero(i.ae.fromLngLat(f.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=l.getIds().map((D=>{const B=l.getTileByID(D).tileID;return B.projMatrix=f.calculateProjMatrix(B.toUnwrapped()),B}));(function(D,B){const j=B.transform.pointCoordinate(B.transform.getCameraPoint()),q=new i.P(j.x,j.y);D.sort(((U,Y)=>{if(Y.overscaledZ-U.overscaledZ)return Y.overscaledZ-U.overscaledZ;const ee=new i.P(U.canonical.x+(1<<U.canonical.z)*U.wrap,U.canonical.y),re=new i.P(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),ce=q.mult(1<<U.canonical.z);return ce.x-=.5,ce.y-=.5,ce.distSqr(ee)-ce.distSqr(re)}))})(v,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},v.forEach((D=>{this.proxyToSource[D.key]={}})),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const D in E){const B=E[D];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,n[D],w),B.usedForTerrain))continue;const j=n[D];B.getSource().reparseOverscaled&&this._assignTerrainTiles(j)}this.proxiedCoords[l.id]=v.map((D=>new Wh(D,D.key,this.orthoMatrix))),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const M={};this._visibleDemTiles=[];for(const D of this.proxyCoords){const B=this.terrainTileForTile[D.key];if(!B)continue;const j=B.tileID.key;j in M||(this._visibleDemTiles.push(B),M[j]=j)}}_assignTerrainTiles(n){this._initializing||n.forEach((l=>{if(this.terrainTileForTile[l.key])return;const f=this._findTileCoveringTileID(l,this.sourceCache);f&&(this.terrainTileForTile[l.key]=f)}))}_prepareDEMTextures(){const n=this.painter.context,l=n.gl;for(const f in this.terrainTileForTile){const v=this.terrainTileForTile[f],w=v.dem;!w||v.demTexture&&!v.needsDEMTextureUpload||(n.activeTexture.set(l.TEXTURE1),Ud(this.painter,v,w))}}_prepareDemTileUniforms(n,l,f,v){if(!l||l.demTexture==null)return!1;const w=n.tileID.canonical,E=Math.pow(2,l.tileID.canonical.z-w.z),M=v||"";return f[`u_dem_tl${M}`]=[w.x*E%1,w.y*E%1],f[`u_dem_scale${M}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let n=0;const l=this._visibleDemTiles.reduce(((f,v)=>{if(!v.dem)return f;const w=v.dem.tree.minimums[0];return w>0&&n++,f+w}),0);return n?l/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,l=n.gl;n.activeTexture.set(l.TEXTURE2);const f=this._getLoadedAreaMinimum(),v=new i.dK({width:1,height:1},new Float32Array([f]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(v,{premultiply:!1}):w=this._emptyDEMTexture=new i.T(n,v,l.R32F,{premultiply:!1}),w}setupElevationDraw(n,l,f){const v=this.painter.context,w=v.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let M=null,D=null,B=1;if(f&&f.morphing&&this._useVertexMorphing){const Y=f.morphing.srcDemTile,ee=f.morphing.dstDemTile;B=f.morphing.phase,Y&&ee&&(this._prepareDemTileUniforms(n,Y,E,"_prev")&&(D=Y),this._prepareDemTileUniforms(n,ee,E)&&(M=ee))}const j=Y=>Y&&Y.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let q=null;var U;if(this.enabled?D&&M?(q=M.demTexture,v.activeTexture.set(w.TEXTURE4),D.demTexture.bind(j(D),w.CLAMP_TO_EDGE),E.u_dem_lerp=B):(M=this.terrainTileForTile[n.tileID.key],q=this._prepareDemTileUniforms(n,M,E)?M.demTexture:this.emptyDEMTexture):q=this.emptyDEMTexture,v.activeTexture.set(w.TEXTURE2),q&&(E.u_dem_size=(U=q).size[0]===1?1:U.size[0]-2,q.bind(j(M),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(f&&f.useDepthForOcclusion,l,E),f&&f.useMeterToDem&&M){const Y=(1<<M.tileID.canonical.z)*i.ce(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=Y}if(f&&f.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),l.setTerrainUniformValues(v,E),this.painter.transform.projection.name==="globe"){const Y=this.globeUniformValues(this.painter.transform,n.tileID.canonical,f&&f.useDenormalizedUpVectorScale);l.setGlobeUniformValues(v,Y)}}globeUniformValues(n,l,f){const v=n.projection;return{u_tile_tl_up:v.upVector(l,0,0),u_tile_tr_up:v.upVector(l,i.al,0),u_tile_br_up:v.upVector(l,i.al,i.al),u_tile_bl_up:v.upVector(l,0,i.al),u_tile_up_scale:f?i.dL(1):v.upVectorScale(l,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const l=this.painter,f=this.painter.context;n.length!==0&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(v,w,E,M,D){if(v.transform.projection.name==="globe")(function(B,j,q,U,Y){const ee=B.context,re=ee.gl;let ce,ae;const de=B.transform,ye=i.dD(B,ee,de),fe=(st,Qe)=>{if(ae===Qe)return;const pt=[ku[Qe],"PROJECTION_GLOBE_VIEW"];ye&&pt.push("CUSTOM_ANTIALIASING");const Ft=B.isTileAffectedByFog(st);ce=B.getOrCreateProgram("globeRaster",{defines:pt,overrideFog:Ft}),ae=Qe},Me=B.colorModeForRenderPass(),xe=new pr(re.LEQUAL,pr.ReadWrite,B.depthRangeFor3D);Ls.update(Y);const Ce=i.dE(de),Te=[i.aF(de.center.lng),i.aJ(de.center.lat)],be=B.globeSharedBuffers,De=[de.width*i.o.devicePixelRatio,de.height*i.o.devicePixelRatio],He=Float32Array.from(de.globeMatrix),$e={useDenormalizedUpVectorScale:!0};{const st=B.transform,Qe=Zd(st.zoom,j.exaggeration(),j.sourceCache._source.tileSize);ae=-1;const pt=re.TRIANGLES;for(const Ft of U){const Xe=q.getTile(Ft),je=Nr.disabled,dt=j.prevTerrainTileForTile[Ft.key],rt=j.terrainTileForTile[Ft.key];Hs(dt,rt)&&Ls.newMorphing(Ft.key,dt,rt,Y,250),ee.activeTexture.set(re.TEXTURE0),Xe.texture&&Xe.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE);const Mt=Ls.getMorphValuesForProxy(Ft.key),$t=Mt?1:0;Mt&&Object.assign($e,{morphing:{srcDemTile:Mt.from,dstDemTile:Mt.to,phase:i.dC(Mt.phase)}});const fr=i.dF(Ft.canonical),kt=i.dG(fr.getCenter().lat),Nt=i.dH(Ft.canonical,fr,kt,st.worldSize/st._pixelsPerMercatorPixel),mr=i.bj(i.dI(Ft.canonical)),lr=Bc(st.expandedFarZProjMatrix,He,Ce,mr,i.aj(st.zoom),Te,st.frustumCorners.TL,st.frustumCorners.TR,st.frustumCorners.BR,st.frustumCorners.BL,st.globeCenterInViewSpace,st.globeRadius,De,Qe,st._farZ,Nt);if(fe(Ft,$t),ce&&(j.setupElevationDraw(Xe,ce,$e),B.uploadCommonUniforms(ee,ce,Ft.toUnwrapped()),be)){const[Qt,ur,Dr]=be.getGridBuffers(kt,Qe!==0);ce.draw(B,pt,xe,je,Me,Vr.backCCW,lr,"globe_raster",Qt,ur,Dr)}}}if(be&&(B.renderDefaultNorthPole||B.renderDefaultSouthPole)){const st=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ye&&st.push("CUSTOM_ANTIALIASING"),ce=B.getOrCreateProgram("globeRaster",{defines:st});for(const Qe of U){const{x:pt,y:Ft,z:Xe}=Qe.canonical,je=Ft===0,dt=Ft===(1<<Xe)-1,[rt,Mt,$t,fr]=be.getPoleBuffers(Xe,!1);if(fr&&(je||dt)){const kt=q.getTile(Qe);ee.activeTexture.set(re.TEXTURE0),kt.texture&&kt.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE);let Nt=i.dJ(Xe,pt,de);const mr=i.bj(i.dI(Qe.canonical)),lr=(Qt,ur)=>Qt.draw(B,re.TRIANGLES,xe,Nr.disabled,Me,Vr.disabled,Bc(de.expandedFarZProjMatrix,Nt,Nt,mr,0,Te,de.frustumCorners.TL,de.frustumCorners.TR,de.frustumCorners.BR,de.frustumCorners.BL,de.globeCenterInViewSpace,de.globeRadius,De,0,de._farZ),"globe_pole_raster",ur,$t,fr);j.setupElevationDraw(kt,ce,$e),B.uploadCommonUniforms(ee,ce,Qe.toUnwrapped()),je&&B.renderDefaultNorthPole&&lr(ce,rt),dt&&B.renderDefaultSouthPole&&(Nt=i.cR(i.bB(),Nt,[1,-1,1]),lr(ce,Mt))}}}})(v,w,E,M,D);else{const B=v.context,j=B.gl;let q,U;const Y=v.shadowRenderer,ee=Qa(v,v.longestCutoffRange),re=Me=>{if(U===Me)return;const xe=[];xe.push(ku[Me]),ee.shouldRenderCutoff&&xe.push("RENDER_CUTOFF"),Y&&(xe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Y.useNormalOffset&&xe.push("NORMAL_OFFSET")),q=v.getOrCreateProgram("terrainRaster",{defines:xe}),U=Me},ce=v.colorModeForRenderPass(),ae=new pr(j.LEQUAL,pr.ReadWrite,v.depthRangeFor3D);Ls.update(D);const de=v.transform,ye=Zd(de.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let fe=[0,0,0];if(Y){const Me=v.style.directionalLight,xe=v.style.ambientLight;Me&&xe&&(fe=Na(v.style,Me,xe))}{U=-1;const Me=j.TRIANGLES,[xe,Ce]=[w.gridIndexBuffer,w.gridSegments];for(const Te of M){const be=E.getTile(Te),De=Nr.disabled,He=w.prevTerrainTileForTile[Te.key],$e=w.terrainTileForTile[Te.key];Hs(He,$e)&&Ls.newMorphing(Te.key,He,$e,D,250),B.activeTexture.set(j.TEXTURE0),be.texture&&be.texture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const st=Ls.getMorphValuesForProxy(Te.key),Qe=st?1:0;let pt;st&&(pt={morphing:{srcDemTile:st.from,dstDemTile:st.to,phase:i.dC(st.phase)}});const Ft=vo(Te.projMatrix,ua(Te.canonical,de.renderWorldCopies)?ye/10:ye,fe);if(re(Qe),!q)continue;w.setupElevationDraw(be,q,pt);const Xe=Te.toUnwrapped();Y&&Y.setupShadows(Xe,q),v.uploadCommonUniforms(B,q,Xe,null,ee),q.draw(v,Me,ae,De,ce,Vr.backCCW,Ft,"terrain_raster",w.gridBuffer,xe,Ce)}}}})(l,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const l=this.painter,f=this.painter.context,v=this.proxySourceCache,w=this.proxiedCoords[v.id],E=this._drapedRenderBatches.shift(),M=l.style.order,D=[];let B=0;for(const j of w){const q=v.getTileByID(j.proxyTileKey),U=v.proxyCachedFBO[j.key]?v.proxyCachedFBO[j.key][n]:void 0,Y=U!==void 0?v.renderCache[U]:this.pool[B++],ee=U!==void 0;if(q.texture=Y.tex,ee&&!Y.dirty){D.push(q.tileID);continue}let re;f.bindFramebuffer.set(Y.fb.framebuffer),this.renderedToTile=!1,Y.dirty&&(f.clear({color:i.ao.transparent,stencil:0}),Y.dirty=!1);for(let ce=E.start;ce<=E.end;++ce){const ae=l.style._mergedLayers[M[ce]];if(ae.isHidden(l.transform.zoom))continue;const de=l.style.getLayerSourceCache(ae),ye=de?this.proxyToSource[j.key][de.id]:[j];if(!ye)continue;const fe=ye;f.viewport.set([0,0,Y.fb.width,Y.fb.height]),re!==(de?de.id:null)&&(this._setupStencil(Y,ye,ae,de),re=de?de.id:null),l.renderLayer(l,de,ae,fe)}if(this._drapedRenderBatches.length===0)for(const ce of this._pendingGroundEffectLayers){const ae=l.style._mergedLayers[M[ce]];if(ae.isHidden(l.transform.zoom))continue;const de=l.style.getLayerSourceCache(ae),ye=de?this.proxyToSource[j.key][de.id]:[j];if(!ye)continue;const fe=ye;f.viewport.set([0,0,Y.fb.width,Y.fb.height]),re!==(de?de.id:null)&&(this._setupStencil(Y,ye,ae,de),re=de?de.id:null),l.renderLayer(l,de,ae,fe)}this.renderedToTile?(Y.dirty=!0,D.push(q.tileID)):ee||--B,B===5&&(B=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,l.width,l.height]),E.end+1}postRender(){}isLayerOrderingCorrect(n){const l=n.order.length;let f=-1,v=l;for(let w=0;w<l;++w)this._style.isLayerDraped(n._mergedLayers[n.order[w]])?f=Math.max(f,w):v=Math.min(v,w);return v>f}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter((l=>l.dem)).forEach((l=>{n=Math.min(n,l.dem.tree.minimums[0])})),n===0?n:(n-30)*this._exaggeration}raycast(n,l,f){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter((w=>w.dem)).map((w=>{const E=w.tileID,M=1<<E.overscaledZ,{x:D,y:B}=E.canonical,j=D/M,q=(D+1)/M,U=B/M,Y=(B+1)/M;return{minx:j,miny:U,maxx:q,maxy:Y,t:w.dem.tree.raycastRoot(j,U,q,Y,n,l,f),tile:w}}));v.sort(((w,E)=>(w.t!==null?w.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE)));for(const w of v){if(w.t==null)return null;const E=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,n,l,f);if(E!=null)return E}return null}_createFBO(){const n=this.painter.context,l=n.gl,f=this.drapeBufferSize;n.activeTexture.set(l.TEXTURE0);const v=new i.T(n,{width:f[0],height:f[1],data:null},l.RGBA8);v.bind(l.LINEAR,l.CLAMP_TO_EDGE);const w=n.createFramebuffer(f[0],f[1],!0,null);return w.colorAttachment.set(v.texture),w.depthAttachment=new Po(n,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:w,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n].hasTransition())return!0;return this._style.order.some((n=>{const l=this._style._mergedLayers[n],f=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!f&&l.shouldRedrape():!f&&l.hasTransition()}))}_clearLineLayersFromRenderCache(){let n=!1;for(const f of this._style.getSources())if(f instanceof To){n=!0;break}if(!n)return;const l={};for(let f=0;f<this._style.order.length;++f){const v=this._style._mergedLayers[this._style.order[f]],w=this._style.getLayerSourceCache(v);if(w&&!l[w.id]&&!v.isHidden(this.painter.transform.zoom)&&v.type==="line"&&v.widthExpression()instanceof i.ad){l[w.id]=!0;for(const E of this.proxyCoords){const M=this.proxyToSource[E.key][w.id];if(M)for(const D of M)this._clearRenderCacheForTile(w.id,D)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const f in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[f]._source instanceof ps){n=!0;break}if(!n)return;const l={};for(let f=0;f<this._style.order.length;++f){const v=this._style._mergedLayers[this._style.order[f]],w=this._style.getLayerSourceCache(v);if(!w||l[w.id]||v.isHidden(this.painter.transform.zoom)||v.type!=="raster")continue;const E=v.paint.get("raster-fade-duration");for(const M of this.proxyCoords){const D=this.proxyToSource[M.key][w.id];if(D)for(const B of D){const j=Zf(w.getTile(B),w.findLoadedParent(B,0),w,this.painter.transform,E);(j.opacity!==1||j.mix!==0)&&this._clearRenderCacheForTile(w.id,B)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const n=this._style.order,l=n.length;if(l===0)return;const f=[];this._pendingGroundEffectLayers=[];let v,w=0,E=this._style._mergedLayers[n[w]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++w<l;)E=this._style._mergedLayers[n[w]];for(;w<l;++w){const M=this._style._mergedLayers[n[w]];M.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(M)?v===void 0&&(v=w):(M.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),v!==void 0&&(f.push({start:v,end:w-1}),v=void 0)))}if(v!==void 0&&f.push({start:v,end:w-1}),f.length!==0){const M=f[f.length-1];this._pendingGroundEffectLayers.every((D=>D>M.end))||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=f}_setupRenderCache(n){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const E=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let M=0;M<E.length;++M){const D=Object.values(E[M]);l.renderCachePool.push(...D)}}return}this._clearRasterLayersFromRenderCache();const f=this.proxyCoords,v=this._tilesDirty;for(let E=f.length-1;E>=0;E--){const M=f[E];if(l.getTileByID(M.key),l.proxyCachedFBO[M.key]!==void 0){const D=n[M.key],B=this.proxyToSource[M.key];let j=0;for(const q in B){const U=B[q],Y=D[q];if(!Y||Y.length!==U.length||U.some(((ee,re)=>ee!==Y[re]||v[q]&&v[q].hasOwnProperty(ee.key)))){j=-1;break}++j}for(const q in l.proxyCachedFBO[M.key])l.renderCache[l.proxyCachedFBO[M.key][q]].dirty=j<0||j!==Object.values(D).length}}const w=[...this._drapedRenderBatches];w.sort(((E,M)=>M.end-M.start-(E.end-E.start)));for(const E of w)for(const M of f){if(l.proxyCachedFBO[M.key])continue;let D=l.renderCachePool.pop();D===void 0&&l.renderCache.length<50&&(D=l.renderCache.length,l.renderCache.push(this._createFBO())),D!==void 0&&(l.proxyCachedFBO[M.key]={},l.proxyCachedFBO[M.key][E.start]=D,l.renderCache[D].dirty=!0)}this._tilesDirty={}}_setupStencil(n,l,f,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,E=w.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let M;if(f.isTileClipped())M=l.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);M=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+M>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=M,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):Nr.disabled}_renderTileClippingMasks(n,l){const f=this.painter,v=this.painter.context,w=v.gl;f._tileClippingMaskIDs={},v.setColorMode(en.disabled),v.setDepthMode(pr.disabled);const E=f.getOrCreateProgram("clippingMask");for(const M of n){const D=f._tileClippingMaskIDs[M.key]=--l;E.draw(f,w.TRIANGLES,pr.disabled,new Nr({func:w.ALWAYS,mask:0},D,255,w.KEEP,w.KEEP,w.REPLACE),en.disabled,Vr.disabled,hu(M.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(n){const l=this.painter.transform;if(n.x<0||n.x>l.width||n.y<0||n.y>l.height)return null;const f=[n.x,n.y,1,1];i.aC(f,f,l.pixelMatrixInverse),i.cJ(f,f,1/f[3]),f[0]/=l.worldSize,f[1]/=l.worldSize;const v=l._camera.position,w=i.ce(1,l.center.lat),E=[v[0],v[1],v[2]/w,0],M=i.d9([],f.slice(0,3),E);i.aw(M,M);const D=this.raycast(E,M,this._exaggeration);return D!==null&&D?(i.bG(E,E,M,D),E[3]=E[2],E[2]*=w,E):null}_setupProxiedCoordsForOrtho(n,l,f){if(n.getSource()instanceof i.aT)return this._setupProxiedCoordsForImageSource(n,l,f);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const v=this.proxiedCoords[n.id]=[],w=this.proxyCoords;for(let D=0;D<w.length;D++){const B=w[D],j=this._findTileCoveringTileID(B,n);if(j){const q=this._createProxiedId(B,j,f[B.key]&&f[B.key][n.id]);v.push(q),this.proxyToSource[B.key][n.id]=[q]}}let E=!1;const M=new Set;for(let D=0;D<l.length;D++){const B=n.getTile(l[D]);if(!B||!B.hasData())continue;const j=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(j&&j.tileID.canonical.z!==B.tileID.canonical.z){const q=this.proxyToSource[j.tileID.key][n.id],U=this._createProxiedId(j.tileID,B,f[j.tileID.key]&&f[j.tileID.key][n.id]);q?q.splice(q.length-1,0,U):this.proxyToSource[j.tileID.key][n.id]=[U];const Y=this.proxyToSource[j.tileID.key][n.id];M.has(Y)||M.add(Y),v.push(U),E=!0}}if(this._sourceTilesOverlap[n.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const D of M)D.sort(((B,j)=>j.overscaledZ-B.overscaledZ))}_setupProxiedCoordsForImageSource(n,l,f){if(!n.getSource().loaded())return;const v=this.proxiedCoords[n.id]=[],w=this.proxyCoords,E=n.getSource(),M=E.tileID;if(!M)return;const D=new i.P(M.x,M.y)._div(1<<M.z),B=E.coordinates.map(i.ae.fromLngLat).reduce(((q,U)=>(q.min.x=Math.min(q.min.x,U.x-D.x),q.min.y=Math.min(q.min.y,U.y-D.y),q.max.x=Math.max(q.max.x,U.x-D.x),q.max.y=Math.max(q.max.y,U.y-D.y),q)),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),j=(q,U)=>{const Y=q.wrap+q.canonical.x/(1<<q.canonical.z),ee=q.canonical.y/(1<<q.canonical.z),re=i.al/(1<<q.canonical.z),ce=U.wrap+U.canonical.x/(1<<U.canonical.z),ae=U.canonical.y/(1<<U.canonical.z);return Y+re<ce+B.min.x||Y>ce+B.max.x||ee+re<ae+B.min.y||ee>ae+B.max.y};for(let q=0;q<w.length;q++){const U=w[q];for(let Y=0;Y<l.length;Y++){const ee=n.getTile(l[Y]);if(!ee||!ee.hasData()||j(U,ee.tileID))continue;const re=this._createProxiedId(U,ee,f[U.key]&&f[U.key][n.id]),ce=this.proxyToSource[U.key][n.id];ce?ce.push(re):this.proxyToSource[U.key][n.id]=[re],v.push(re)}}}_createProxiedId(n,l,f){let v=this.orthoMatrix;if(f){const w=f.find((E=>E.key===l.tileID.key));if(w)return w}if(l.tileID.key!==n.key){const w=n.canonical.z-l.tileID.canonical.z;let E,M,D;v=i.bB();const B=l.tileID.wrap-n.wrap<<n.overscaledZ;w>0?(E=i.al>>w,M=E*((l.tileID.canonical.x<<w)-n.canonical.x+B),D=E*((l.tileID.canonical.y<<w)-n.canonical.y)):(E=i.al<<-w,M=i.al*(l.tileID.canonical.x-(n.canonical.x+B<<-w)),D=i.al*(l.tileID.canonical.y-(n.canonical.y<<-w))),i.cd(v,0,E,0,E,0,1),i.bq(v,v,[M,D,0])}return new Wh(l.tileID,n.key,v)}_findTileCoveringTileID(n,l){let f=l.getTile(n);if(f&&f.hasData())return f;const v=this._findCoveringTileCache[l.id],w=v[n.key];if(f=w?l.getTileByID(w):null,f&&f.hasData()||w===null)return f;let E=f?f.tileID:n,M=E.overscaledZ;const D=l.getSource().minzoom,B=[];if(!w){const q=l.getSource().maxzoom;if(n.canonical.z>=q){const U=n.canonical.z-q;l.getSource().reparseOverscaled?(M=Math.max(n.canonical.z+2,l.transform.tileZoom),E=new i.aP(M,n.wrap,q,n.canonical.x>>U,n.canonical.y>>U)):U!==0&&(M=q,E=new i.aP(M,n.wrap,q,n.canonical.x>>U,n.canonical.y>>U))}E.key!==n.key&&(B.push(E.key),f=l.getTile(E))}const j=q=>{B.forEach((U=>{v[U]=q})),B.length=0};for(M-=1;M>=D&&(!f||!f.hasData());M--){f&&j(f.tileID.key);const q=E.calculateScaledKey(M);if(f=l.getTileByID(q),f&&f.hasData())break;const U=v[q];if(U===null)break;U===void 0?B.push(q):f=l.getTileByID(U)}return j(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,l){let f=this._tilesDirty[n];f||(f=this._tilesDirty[n]={}),f[l.key]=!0}}function qh(h,n,l){const f=(function(M,D,B){const j=i.bI(D,M),q=i.bI(B,[.2126,.7152,.0722]),U=(ee,re,ce)=>(1-ce)*ee+ce*re,Y=U(1-.3*Math.min(q,1),1,Math.min(j+1,1));return U(.92,1,Math.asin(i.aA(D[2],-1,1))/Math.PI+.5)*Y})(h,[0,0,1],n),v=[0,0,0];i.c4(v,l.slice(0,3),f);const w=[0,0,0];i.c4(w,n.slice(0,3),h[2]);const E=[0,0,0];return i.d7(E,v,w),i.da(E)}const Xf=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Xp=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class Kf{static cacheKey(n,l,f,v){let w=`${l}${v?v.cacheKey:""}`;for(const E of f)n.usedDefines.includes(E)&&(w+=`/${E}`);return w}constructor(n,l,f,v,w,E){const M=n.gl;this.program=M.createProgram(),this.configuration=v,this.name=l,this.fixedDefines=[...E];let D=v?v.defines():[];D=D.concat(E.map((ee=>`#define ${ee}`)));const B=`#version 300 es
`;let j=B+D.concat("precision mediump float;",uu,$f.fragmentSource).join(`
`);for(const ee of f.fragmentIncludes)j+=`
${ud[ee]}`;j+=`
${f.fragmentSource}`;let q=B+D.concat("precision highp float;",uu,$f.vertexSource).join(`
`);for(const ee of f.vertexIncludes)q+=`
${ud[ee]}`;this.forceManualRenderingForInstanceIDShaders=n.forceManualRenderingForInstanceIDShaders&&f.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(q+=`
uniform int u_instanceID;
`),q+=`
${f.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(q=q.replaceAll("gl_InstanceID","u_instanceID"));const U=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(U,j),M.compileShader(U),M.attachShader(this.program,U);const Y=M.createShader(M.VERTEX_SHADER);M.isContextLost()?this.failedToCreate=!0:(M.shaderSource(Y,q),M.compileShader(Y),M.attachShader(this.program,Y),this.attributes={},M.linkProgram(this.program),M.deleteShader(Y),M.deleteShader(U),this.fixedUniforms=w(n),this.binderUniforms=v?v.getUniforms(n):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(ee=>({u_instanceID:new i.cg(ee)}))(n)),(E.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(ee=>({u_dem:new i.cg(ee),u_dem_prev:new i.cg(ee),u_dem_tl:new i.cj(ee),u_dem_scale:new i.ci(ee),u_dem_tl_prev:new i.cj(ee),u_dem_scale_prev:new i.ci(ee),u_dem_size:new i.ci(ee),u_dem_lerp:new i.ci(ee),u_exaggeration:new i.ci(ee),u_depth:new i.cg(ee),u_depth_size_inv:new i.cj(ee),u_depth_range_unpack:new i.cj(ee),u_occluder_half_size:new i.ci(ee),u_occlusion_depth_offset:new i.ci(ee),u_meter_to_dem:new i.ci(ee),u_label_plane_matrix_inv:new i.ck(ee)}))(n)),E.includes("GLOBE")&&(this.globeUniforms=(ee=>({u_tile_tl_up:new i.ch(ee),u_tile_tr_up:new i.ch(ee),u_tile_br_up:new i.ch(ee),u_tile_bl_up:new i.ch(ee),u_tile_up_scale:new i.ci(ee)}))(n)),E.includes("FOG")&&(this.fogUniforms=(ee=>({u_fog_matrix:new i.ck(ee),u_fog_range:new i.cj(ee),u_fog_color:new i.d2(ee),u_fog_horizon_blend:new i.ci(ee),u_fog_vertical_limit:new i.cj(ee),u_fog_temporal_offset:new i.ci(ee),u_frustum_tl:new i.ch(ee),u_frustum_tr:new i.ch(ee),u_frustum_br:new i.ch(ee),u_frustum_bl:new i.ch(ee),u_globe_pos:new i.ch(ee),u_globe_radius:new i.ci(ee),u_globe_transition:new i.ci(ee),u_is_globe:new i.cg(ee),u_viewport:new i.cj(ee)}))(n)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ee=>({u_cutoff_params:new i.d2(ee)}))(n)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ee=>({u_lighting_ambient_color:new i.ch(ee),u_lighting_directional_dir:new i.ch(ee),u_lighting_directional_color:new i.ch(ee),u_ground_radiance:new i.ch(ee)}))(n)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ee=>({u_light_matrix_0:new i.ck(ee),u_light_matrix_1:new i.ck(ee),u_fade_range:new i.cj(ee),u_shadow_normal_offset:new i.ch(ee),u_shadow_intensity:new i.ci(ee),u_shadow_texel_size:new i.ci(ee),u_shadow_map_resolution:new i.ci(ee),u_shadow_direction:new i.ch(ee),u_shadow_bias:new i.ch(ee),u_shadowmap_0:new i.cg(ee),u_shadowmap_1:new i.cg(ee)}))(n)))}getAttributeLocation(n,l){let f=this.attributes[l];return f===void 0&&(f=this.attributes[l]=n.getAttribLocation(this.program,l)),f}setTerrainUniformValues(n,l){if(!this.terrainUniforms)return;const f=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const v in l)f[v]&&f[v].set(this.program,v,l[v])}}setGlobeUniformValues(n,l){if(!this.globeUniforms)return;const f=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const v in l)f[v]&&f[v].set(this.program,v,l[v])}}setFogUniformValues(n,l){if(!this.fogUniforms)return;const f=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const v in l)f[v].set(this.program,v,l[v])}}setCutoffUniformValues(n,l){if(!this.cutoffUniforms)return;const f=this.cutoffUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const v in l)f[v].set(this.program,v,l[v])}}setLightsUniformValues(n,l){if(!this.lightsUniforms)return;const f=this.lightsUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const v in l)f[v].set(this.program,v,l[v])}}setShadowUniformValues(n,l){if(this.failedToCreate||!this.shadowUniforms)return;const f=this.shadowUniforms;n.program.set(this.program);for(const v in l)f[v].set(this.program,v,l[v])}_drawDebugWireframe(n,l,f,v,w,E,M,D,B,j){const q=n.options.wireframe;if(q.terrain===!1&&q.layers2D===!1&&q.layers3D===!1)return;const U=n.context;if(!(!(!q.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!q.layers2D||n._terrain&&n._terrain.renderingToTexture||!Xf.includes(this.name))||!(!q.layers3D||!Xp.includes(this.name))))return;const Y=U.gl,ee=n.wireframeDebugCache.getLinesFromTrianglesBuffer(n.frameCounter,w,U);if(!ee)return;const re=[...this.fixedDefines];re.push("DEBUG_WIREFRAME");const ce=n.getOrCreateProgram(this.name,{config:this.configuration,defines:re});U.program.set(ce.program);const ae=(fe,Me,xe)=>{if(Me[fe]&&xe[fe])for(const Ce in Me[fe])xe[fe][Ce]&&xe[fe][Ce].set(xe.program,Ce,Me[fe][Ce].current)};B&&B.setUniforms(ce.program,U,ce.binderUniforms,M,{zoom:D}),ae("fixedUniforms",this,ce),ae("terrainUniforms",this,ce),ae("globeUniforms",this,ce),ae("fogUniforms",this,ce),ae("lightsUniforms",this,ce),ae("shadowUniforms",this,ce),ee.bind(),U.setColorMode(new en([Y.ONE,Y.ONE_MINUS_SRC_ALPHA,Y.ZERO,Y.ONE],i.ao.transparent,[!0,!0,!0,!1])),U.setDepthMode(new pr(l.func===Y.LESS?Y.LEQUAL:l.func,pr.ReadOnly,l.range)),U.setStencilMode(Nr.disabled);const de=3*E.primitiveLength*2,ye=3*E.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const fe=j||1;for(let Me=0;Me<fe;++Me)ce.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Me),Y.drawElements(Y.LINES,de,Y.UNSIGNED_SHORT,ye)}else j&&j>1?Y.drawElementsInstanced(Y.LINES,de,Y.UNSIGNED_SHORT,ye,j):Y.drawElements(Y.LINES,de,Y.UNSIGNED_SHORT,ye);w.bind(),U.program.set(this.program),U.setDepthMode(l),U.setStencilMode(f),U.setColorMode(v)}checkUniforms(n,l,f){if(this.fixedDefines.includes(l)){for(const v of Object.keys(f))if(!f[v].initialized)throw new Error(`Program '${this.name}', from draw '${n}': uniform ${v} not set but required by ${l} being defined`)}}draw(n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce){const ae=n.context,de=ae.gl;if(this.failedToCreate)return;ae.program.set(this.program),ae.setDepthMode(f),ae.setStencilMode(v),ae.setColorMode(w),ae.setCullFace(E);for(const Me of Object.keys(this.fixedUniforms))this.fixedUniforms[Me].set(this.program,Me,M[Me]);ee&&ee.setUniforms(this.program,ae,this.binderUniforms,U,{zoom:Y});const ye={[de.POINTS]:1,[de.LINES]:2,[de.TRIANGLES]:3,[de.LINE_STRIP]:1}[l];this.checkUniforms(D,"RENDER_SHADOWS",this.shadowUniforms);const fe=ce&&ce>0?1:void 0;for(const Me of q.get()){const xe=Me.vaos||(Me.vaos={});if((xe[D]||(xe[D]=new Vd)).bind(ae,this,B,ee?ee.getPaintVertexBuffers():[],j,Me.vertexOffset,re||[],fe),this.forceManualRenderingForInstanceIDShaders){const Ce=ce||1;for(let Te=0;Te<Ce;++Te)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Te),j?de.drawElements(l,Me.primitiveLength*ye,de.UNSIGNED_SHORT,Me.primitiveOffset*ye*2):de.drawArrays(l,Me.vertexOffset,Me.vertexLength)}else ce&&ce>1?de.drawElementsInstanced(l,Me.primitiveLength*ye,de.UNSIGNED_SHORT,Me.primitiveOffset*ye*2,ce):j?de.drawElements(l,Me.primitiveLength*ye,de.UNSIGNED_SHORT,Me.primitiveOffset*ye*2):de.drawArrays(l,Me.vertexOffset,Me.vertexLength);l===de.TRIANGLES&&j&&this._drawDebugWireframe(n,f,v,w,j,Me,U,Y,ee,ce)}}}function jc(h,n,l=0){const f=Math.pow(2,n.tileID.overscaledZ),v=n.tileSize*Math.pow(2,h.transform.tileZoom)/f,w=v*(n.tileID.canonical.x+n.tileID.wrap*f),E=v*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ay(n,1,h.transform.tileZoom),u_pixel_coord_upper:[w>>16,E>>16],u_pixel_coord_lower:[65535&w,65535&E],u_pattern_transition:l}}const Nc={terrain:0,flat:1},Bu=i.bB(),Xd=(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce,ae)=>{const de=n.style.light,ye=de.properties.get("position"),fe=[ye.x,ye.y,ye.z],Me=i.dN();de.properties.get("anchor")==="viewport"&&(i.dO(Me,-n.transform.angle),i.dP(fe,fe,Me));const xe=de.properties.get("color").toPremultipliedRenderColor(null),Ce=n.transform,Te={u_matrix:h,u_lightpos:fe,u_lightintensity:de.properties.get("intensity"),u_lightcolor:[xe.r,xe.g,xe.b],u_vertical_gradient:+l,u_opacity:f,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Bu,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Nc[B],u_base_type:Nc[j],u_ao:v,u_edge_radius:w,u_width_scale:E,u_flood_light_color:ee,u_vertical_scale:re,u_flood_light_intensity:ce,u_ground_shadow_factor:ae};return Ce.projection.name==="globe"&&(Te.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],Te.u_zoom_transition=q,Te.u_inv_rot_matrix=Y,Te.u_merc_center=U,Te.u_up_dir=Ce.projection.upVector(new i.cC(0,0,0),U[0]*i.al,U[1]*i.al),Te.u_height_lift=D),Te},Qf=(h,n,l,f,v,w)=>({u_matrix:h,u_edge_radius:n,u_width_scale:l,u_vertical_scale:f,u_height_type:Nc[v],u_base_type:Nc[w]}),Vl=(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce,ae)=>{const de=Xd(h,n,l,f,v,w,E,M,B,j,q,U,Y,ee,re,ce,1,[0,0,0]),ye={u_height_factor:-Math.pow(2,M.overscaledZ)/D.tileSize/8};return Object.assign(de,jc(n,D,ae),ye)},Pa=(h,n,l,f,v,w,E,M,D,B,j)=>({u_matrix:n,u_opacity:l,u_ao_pass:f?1:0,u_meter_to_tile:v,u_ao:w,u_flood_light_intensity:E,u_flood_light_color:M,u_attenuation:D,u_edge_radius:B,u_fb:0,u_fb_size:j,u_dynamic_offset:1}),md=(h,n,l)=>({u_matrix:h,u_emissive_strength:n,u_ground_shadow_factor:l}),fu=(h,n,l,f,v,w=0)=>Object.assign(md(h,n,v),jc(l,f,w)),ju=(h,n,l,f)=>({u_matrix:h,u_world:l,u_emissive_strength:n,u_ground_shadow_factor:f}),Kd=(h,n,l,f,v,w,E=0)=>Object.assign(fu(h,n,l,f,w,E),{u_world:v}),P_=(h,n)=>({u_matrix:h,u_ground_shadow_factor:n}),Gh=(h,n,l,f,v)=>({u_matrix:h,u_camera_pos:[n[0],n[1],n[2]],u_depth_bias:l,u_height_scale:f,u_reset_depth:v}),Jf=(h,n,l,f,v,w,E,M,D)=>({u_matrix:h,u_normal_matrix:n,u_opacity:l,u_faux_facade_ao_intensity:f,u_camera_pos:v,u_tile_to_meter:w,u_facade_emissive_chance:E,u_flood_light_color:M,u_flood_light_intensity:D}),Ja=h=>({u_matrix:h}),vl=h=>({u_matrix:h}),go=(h,n,l,f,v,w,E,M)=>{const D=i.al/w.tileSize;return{u_matrix:h,u_inv_rot_matrix:n,u_camera_to_center_distance:l.getCameraToCenterDistance(M),u_extrude_scale:[l.pixelsToGLUnits[0]/D,l.pixelsToGLUnits[1]/D],u_zoom_transition:f,u_tile_id:E,u_merc_center:v}},Ul=(h,n,l=1)=>({u_matrix:h,u_color:n,u_overlay:0,u_overlay_scale:l}),og=i.bB(),sg=(h,n,l,f,v,w,E)=>{const M=h.transform,D=M.projection.name==="globe",B=D?i.dQ(M.zoom,n.canonical)*M._pixelsPerMercatorPixel:i.ay(l,1,w),j={u_matrix:n.projMatrix,u_extrude_scale:B,u_intensity:E,u_inv_rot_matrix:og,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){j.u_inv_rot_matrix=f,j.u_merc_center=v,j.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],j.u_zoom_transition=i.aj(M.zoom);const q=v[0]*i.al,U=v[1]*i.al;j.u_up_dir=M.projection.upVector(new i.cC(0,0,0),q,U)}return j};function Hh(h,[n,l,f,v],[w,E]){if(w===E)return[0,0,0,0];const M=255*(h-1)/(h*(E-w));return[n*M,l*M,f*M,v*M]}function Vc(h,n,[l,f]){return l===f?0:.5/h+(n-l)*(h-1)/(h*(f-l))}const Yh=(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce,ae,de,ye,fe)=>({u_matrix:h,u_normalize_matrix:n,u_globe_matrix:l,u_merc_matrix:f,u_grid_matrix:v,u_tl_parent:w,u_scale_parent:B,u_fade_t:j.mix,u_opacity:j.opacity*q.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:q.paint.get("raster-brightness-min"),u_brightness_high:q.paint.get("raster-brightness-max"),u_saturation_factor:i.dS(q.paint.get("raster-saturation")),u_contrast_factor:i.dR(q.paint.get("raster-contrast")),u_spin_weights:Qd(q.paint.get("raster-hue-rotate")),u_perspective_transform:U,u_raster_elevation:Y,u_zoom_transition:E,u_merc_center:M,u_cutoff_params:D,u_colorization_mix:Hh(i.dT,re,ae),u_colorization_offset:Vc(i.dT,ce,ae),u_color_ramp:ee,u_texture_offset:[ye/(de+2*ye),de/(de+2*ye)],u_texture_res:[de+2*ye,de+2*ye],u_emissive_strength:fe});function Qd(h){h*=Math.PI/180;const n=Math.sin(h),l=Math.cos(h);return[(2*l+1)/3,(-Math.sqrt(3)*n-l+1)/3,(Math.sqrt(3)*n-l+1)/3]}const gd=.05,$l=(h,n,l,f,v,w,E,M,D,B,j,q)=>({u_matrix:h,u_normalize_matrix:n,u_globe_matrix:l,u_merc_matrix:f,u_grid_matrix:v,u_tl_parent:w,u_scale_parent:B,u_fade_t:j.mix,u_opacity:j.opacity,u_image0:0,u_image1:1,u_raster_elevation:q,u_zoom_transition:E,u_merc_center:M,u_cutoff_params:D}),ep=(h,n,l,f,v,w,E,M,D,B)=>({u_particle_texture:h,u_particle_texture_side_len:n,u_tile_offset:l,u_velocity:f,u_color_ramp:w,u_velocity_res:v,u_max_speed:E,u_uv_offset:M,u_data_scale:[255*D[0],255*D[1]],u_data_offset:B,u_particle_pos_scale:1.1,u_particle_pos_offset:[gd,gd]}),Kp=(h,n,l,f,v,w,E,M,D,B)=>({u_particle_texture:h,u_particle_texture_side_len:n,u_velocity:l,u_velocity_res:f,u_max_speed:v,u_speed_factor:w,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:M,u_data_scale:[255*D[0],255*D[1]],u_data_offset:B,u_particle_pos_scale:1.1,u_particle_pos_offset:[gd,gd]}),Jd=i.bB(),Zh=(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce,ae,de,ye,fe,Me,xe,Ce)=>{const Te=v.transform,be={u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Te.getCameraToCenterDistance(de),u_rotate_symbol:+l,u_aspect_ratio:Te.width/Te.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:E,u_coord_matrix:M,u_is_text:+B,u_elevation_from_sea:D?1:0,u_pitch_with_map:+f,u_texsize:j,u_texsize_icon:q,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Jd,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Jd,u_up_vector:[0,-1,0],u_color_adj_mat:Me,u_icon_transition:xe||0,u_gamma_scale:f?v.transform.getCameraToCenterDistance(de)*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:i.o.devicePixelRatio,u_is_halo:1,u_scale_factor:Ce||1,u_ground_shadow_factor:ye,u_inv_matrix:i.bk(i.bB(),E),u_normal_scale:fe,u_lutTexture:Eo.LUT};return de.name==="globe"&&(be.u_tile_id=[Y.canonical.x,Y.canonical.y,1<<Y.canonical.z],be.u_zoom_transition=ee,be.u_inv_rot_matrix=ce,be.u_merc_center=re,be.u_camera_forward=Te._camera.forward(),be.u_ecef_origin=i.dU(Te.globeMatrix,Y.toUnwrapped()),be.u_tile_matrix=Float32Array.from(Te.globeMatrix),be.u_up_vector=ae),be},tp=(h,n,l,f)=>({u_matrix:h,u_emissive_strength:n,u_opacity:l,u_color:f}),rp=(h,n,l,f,v,w,E,M,D)=>Object.assign((function(B,j,q,U,Y,ee){const{width:re,height:ce}=U.imageManager.getPixelSize(j),ae=Math.pow(2,ee.tileID.overscaledZ),de=ee.tileSize*Math.pow(2,U.transform.tileZoom)/ae,ye=de*(ee.tileID.canonical.x+ee.tileID.wrap*ae),fe=de*ee.tileID.canonical.y;return{u_image:0,u_pattern_tl:q.tl,u_pattern_br:q.br,u_texsize:[re,ce],u_pattern_size:q.displaySize,u_pattern_units_to_pixels:Y?[U.transform.width,-1*U.transform.height]:[1/i.ay(ee,1,U.transform.tileZoom),1/i.ay(ee,1,U.transform.tileZoom)],u_pixel_coord_upper:[ye>>16,fe>>16],u_pixel_coord_lower:[65535&ye,65535&fe]}})(0,w,E,f,M,D),{u_matrix:h,u_emissive_strength:n,u_opacity:l}),_d=new Float32Array(i.bz([])),np=(h,n,l,f,v,w,E,M,D,B,j,q,U,Y=[0,0,0],ee,re,ce)=>{const ae=v.style.light,de=ae.properties.get("position"),ye=[-de.x,-de.y,de.z],fe=i.dN();ae.properties.get("anchor")==="viewport"&&(i.dO(fe,-v.transform.angle),i.dP(ye,ye,fe));const Me=j.alphaMode==="MASK",xe=ae.properties.get("color").toNonPremultipliedRenderColor(null),Ce=U.paint.get("model-ambient-occlusion-intensity"),Te=U.paint.get("model-color").constantOr(i.ao.white).toNonPremultipliedRenderColor(null);return Te.a=U.paint.get("model-color-mix-intensity").constantOr(0),ce&&(Te.r=ce[0],Te.g=ce[1],Te.b=ce[2],Te.a=ce[3]),re&&(Te.r=re.color.r,Te.g=re.color.g,Te.b=re.color.b,Te.a=re.colorMix,q=re.emissionStrength,w=re.opacity),{u_matrix:h,u_lighting_matrix:n,u_normal_matrix:l,u_node_matrix:f||_d,u_lightpos:ye,u_lightintensity:ae.properties.get("intensity"),u_lightcolor:[xe.r,xe.g,xe.b],u_camera_pos:Y,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+Me,u_alphaCutoff:j.alphaCutoff,u_baseColorFactor:E.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:M.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:D,u_roughnessFactor:B,u_baseColorTexture:Eo.BaseColor,u_metallicRoughnessTexture:Eo.MetallicRoughness,u_normalTexture:Eo.Normal,u_occlusionTexture:Eo.Occlusion,u_emissionTexture:Eo.Emission,u_lutTexture:Eo.LUT,u_color_mix:Te.toArray01(),u_aoIntensity:Ce,u_emissive_strength:q,u_occlusionTextureTransform:ee||[0,0,0,0]}},Nu=(h,n=_d,l=_d)=>({u_matrix:h,u_instance:n,u_node_matrix:l}),Qp={fillExtrusion:h=>({u_matrix:new i.ck(h),u_lightpos:new i.ch(h),u_lightintensity:new i.ci(h),u_lightcolor:new i.ch(h),u_vertical_gradient:new i.ci(h),u_opacity:new i.ci(h),u_edge_radius:new i.ci(h),u_width_scale:new i.ci(h),u_ao:new i.cj(h),u_height_type:new i.cg(h),u_base_type:new i.cg(h),u_tile_id:new i.ch(h),u_zoom_transition:new i.ci(h),u_inv_rot_matrix:new i.ck(h),u_merc_center:new i.cj(h),u_up_dir:new i.ch(h),u_height_lift:new i.ci(h),u_flood_light_color:new i.ch(h),u_vertical_scale:new i.ci(h),u_flood_light_intensity:new i.ci(h),u_ground_shadow_factor:new i.ch(h)}),fillExtrusionDepth:h=>({u_matrix:new i.ck(h),u_edge_radius:new i.ci(h),u_width_scale:new i.ci(h),u_vertical_scale:new i.ci(h),u_height_type:new i.cg(h),u_base_type:new i.cg(h)}),fillExtrusionPattern:h=>({u_matrix:new i.ck(h),u_lightpos:new i.ch(h),u_lightintensity:new i.ci(h),u_lightcolor:new i.ch(h),u_vertical_gradient:new i.ci(h),u_height_factor:new i.ci(h),u_edge_radius:new i.ci(h),u_width_scale:new i.ci(h),u_ao:new i.cj(h),u_height_type:new i.cg(h),u_base_type:new i.cg(h),u_tile_id:new i.ch(h),u_zoom_transition:new i.ci(h),u_inv_rot_matrix:new i.ck(h),u_merc_center:new i.cj(h),u_up_dir:new i.ch(h),u_height_lift:new i.ci(h),u_image:new i.cg(h),u_texsize:new i.cj(h),u_pixel_coord_upper:new i.cj(h),u_pixel_coord_lower:new i.cj(h),u_tile_units_to_pixels:new i.ci(h),u_opacity:new i.ci(h),u_pattern_transition:new i.ci(h)}),fillExtrusionGroundEffect:h=>({u_matrix:new i.ck(h),u_opacity:new i.ci(h),u_ao_pass:new i.ci(h),u_meter_to_tile:new i.ci(h),u_ao:new i.cj(h),u_flood_light_intensity:new i.ci(h),u_flood_light_color:new i.ch(h),u_attenuation:new i.ci(h),u_edge_radius:new i.ci(h),u_fb:new i.cg(h),u_fb_size:new i.ci(h),u_dynamic_offset:new i.ci(h)}),fill:h=>({u_matrix:new i.ck(h),u_emissive_strength:new i.ci(h),u_ground_shadow_factor:new i.ch(h)}),fillPattern:h=>({u_matrix:new i.ck(h),u_emissive_strength:new i.ci(h),u_image:new i.cg(h),u_texsize:new i.cj(h),u_pixel_coord_upper:new i.cj(h),u_pixel_coord_lower:new i.cj(h),u_tile_units_to_pixels:new i.ci(h),u_ground_shadow_factor:new i.ch(h),u_pattern_transition:new i.ci(h)}),fillOutline:h=>({u_matrix:new i.ck(h),u_emissive_strength:new i.ci(h),u_world:new i.cj(h),u_ground_shadow_factor:new i.ch(h)}),fillOutlinePattern:h=>({u_matrix:new i.ck(h),u_emissive_strength:new i.ci(h),u_world:new i.cj(h),u_image:new i.cg(h),u_texsize:new i.cj(h),u_pixel_coord_upper:new i.cj(h),u_pixel_coord_lower:new i.cj(h),u_tile_units_to_pixels:new i.ci(h),u_ground_shadow_factor:new i.ch(h),u_pattern_transition:new i.ci(h)}),building:h=>({u_matrix:new i.ck(h),u_normal_matrix:new i.ck(h),u_opacity:new i.ci(h),u_faux_facade_ao_intensity:new i.ci(h),u_camera_pos:new i.ch(h),u_tile_to_meter:new i.ci(h),u_facade_emissive_chance:new i.ci(h),u_flood_light_color:new i.ch(h),u_flood_light_intensity:new i.ci(h)}),buildingBloom:h=>({u_matrix:new i.ck(h)}),buildingDepth:h=>({u_matrix:new i.ck(h)}),elevatedStructuresDepth:h=>({u_matrix:new i.ck(h),u_depth_bias:new i.ci(h)}),elevatedStructures:h=>({u_matrix:new i.ck(h),u_ground_shadow_factor:new i.ch(h)}),elevatedStructuresDepthReconstruct:h=>({u_matrix:new i.ck(h),u_camera_pos:new i.ch(h),u_depth_bias:new i.ci(h),u_height_scale:new i.ci(h),u_reset_depth:new i.ci(h)}),circle:i.dX,collisionBox:h=>({u_matrix:new i.ck(h),u_inv_rot_matrix:new i.ck(h),u_camera_to_center_distance:new i.ci(h),u_extrude_scale:new i.cj(h),u_zoom_transition:new i.ci(h),u_merc_center:new i.cj(h),u_tile_id:new i.ch(h)}),collisionCircle:h=>({u_matrix:new i.ck(h),u_inv_matrix:new i.ck(h),u_camera_to_center_distance:new i.ci(h),u_viewport_size:new i.cj(h)}),debug:h=>({u_color:new i.dA(h),u_matrix:new i.ck(h),u_overlay:new i.cg(h),u_overlay_scale:new i.ci(h)}),clippingMask:h=>({u_matrix:new i.ck(h)}),heatmap:h=>({u_extrude_scale:new i.ci(h),u_intensity:new i.ci(h),u_matrix:new i.ck(h),u_inv_rot_matrix:new i.ck(h),u_merc_center:new i.cj(h),u_tile_id:new i.ch(h),u_zoom_transition:new i.ci(h),u_up_dir:new i.ch(h)}),heatmapTexture:h=>({u_image:new i.cg(h),u_color_ramp:new i.cg(h),u_opacity:new i.ci(h)}),hillshade:h=>({u_matrix:new i.ck(h),u_image:new i.cg(h),u_latrange:new i.cj(h),u_light:new i.cj(h),u_shadow:new i.dA(h),u_highlight:new i.dA(h),u_emissive_strength:new i.ci(h),u_accent:new i.dA(h)}),hillshadePrepare:h=>({u_matrix:new i.ck(h),u_image:new i.cg(h),u_dimension:new i.cj(h),u_zoom:new i.ci(h)}),line:i.dW,linePattern:i.dV,raster:h=>({u_matrix:new i.ck(h),u_normalize_matrix:new i.ck(h),u_globe_matrix:new i.ck(h),u_merc_matrix:new i.ck(h),u_grid_matrix:new i.dB(h),u_tl_parent:new i.cj(h),u_scale_parent:new i.ci(h),u_fade_t:new i.ci(h),u_opacity:new i.ci(h),u_image0:new i.cg(h),u_image1:new i.cg(h),u_brightness_low:new i.ci(h),u_brightness_high:new i.ci(h),u_saturation_factor:new i.ci(h),u_contrast_factor:new i.ci(h),u_spin_weights:new i.ch(h),u_perspective_transform:new i.cj(h),u_raster_elevation:new i.ci(h),u_zoom_transition:new i.ci(h),u_merc_center:new i.cj(h),u_cutoff_params:new i.d2(h),u_colorization_mix:new i.d2(h),u_colorization_offset:new i.ci(h),u_color_ramp:new i.cg(h),u_texture_offset:new i.cj(h),u_texture_res:new i.cj(h),u_emissive_strength:new i.ci(h)}),rasterParticle:h=>({u_matrix:new i.ck(h),u_normalize_matrix:new i.ck(h),u_globe_matrix:new i.ck(h),u_merc_matrix:new i.ck(h),u_grid_matrix:new i.dB(h),u_tl_parent:new i.cj(h),u_scale_parent:new i.ci(h),u_fade_t:new i.ci(h),u_opacity:new i.ci(h),u_image0:new i.cg(h),u_image1:new i.cg(h),u_raster_elevation:new i.ci(h),u_zoom_transition:new i.ci(h),u_merc_center:new i.cj(h),u_cutoff_params:new i.d2(h)}),rasterParticleTexture:h=>({u_texture:new i.cg(h),u_opacity:new i.ci(h)}),rasterParticleDraw:h=>({u_particle_texture:new i.cg(h),u_particle_texture_side_len:new i.ci(h),u_tile_offset:new i.cj(h),u_velocity:new i.cg(h),u_color_ramp:new i.cg(h),u_velocity_res:new i.cj(h),u_max_speed:new i.ci(h),u_uv_offset:new i.cj(h),u_data_scale:new i.cj(h),u_data_offset:new i.ci(h),u_particle_pos_scale:new i.ci(h),u_particle_pos_offset:new i.cj(h)}),rasterParticleUpdate:h=>({u_particle_texture:new i.cg(h),u_particle_texture_side_len:new i.ci(h),u_velocity:new i.cg(h),u_velocity_res:new i.cj(h),u_max_speed:new i.ci(h),u_speed_factor:new i.ci(h),u_reset_rate:new i.ci(h),u_rand_seed:new i.ci(h),u_uv_offset:new i.cj(h),u_data_scale:new i.cj(h),u_data_offset:new i.ci(h),u_particle_pos_scale:new i.ci(h),u_particle_pos_offset:new i.cj(h)}),symbol:h=>({u_is_size_zoom_constant:new i.cg(h),u_is_size_feature_constant:new i.cg(h),u_size_t:new i.ci(h),u_size:new i.ci(h),u_camera_to_center_distance:new i.ci(h),u_rotate_symbol:new i.cg(h),u_aspect_ratio:new i.ci(h),u_fade_change:new i.ci(h),u_matrix:new i.ck(h),u_label_plane_matrix:new i.ck(h),u_coord_matrix:new i.ck(h),u_is_text:new i.cg(h),u_elevation_from_sea:new i.cg(h),u_pitch_with_map:new i.cg(h),u_texsize:new i.cj(h),u_texsize_icon:new i.cj(h),u_texture:new i.cg(h),u_texture_icon:new i.cg(h),u_gamma_scale:new i.ci(h),u_device_pixel_ratio:new i.ci(h),u_tile_id:new i.ch(h),u_zoom_transition:new i.ci(h),u_inv_rot_matrix:new i.ck(h),u_merc_center:new i.cj(h),u_camera_forward:new i.ch(h),u_tile_matrix:new i.ck(h),u_up_vector:new i.ch(h),u_ecef_origin:new i.ch(h),u_is_halo:new i.cg(h),u_icon_transition:new i.ci(h),u_color_adj_mat:new i.ck(h),u_scale_factor:new i.ci(h),u_ground_shadow_factor:new i.ch(h),u_inv_matrix:new i.ck(h),u_normal_scale:new i.ci(h),u_lutTexture:new i.cg(h)}),background:h=>({u_matrix:new i.ck(h),u_emissive_strength:new i.ci(h),u_opacity:new i.ci(h),u_color:new i.dA(h)}),backgroundPattern:h=>({u_matrix:new i.ck(h),u_emissive_strength:new i.ci(h),u_opacity:new i.ci(h),u_image:new i.cg(h),u_pattern_tl:new i.cj(h),u_pattern_br:new i.cj(h),u_texsize:new i.cj(h),u_pattern_size:new i.cj(h),u_pixel_coord_upper:new i.cj(h),u_pixel_coord_lower:new i.cj(h),u_pattern_units_to_pixels:new i.cj(h)}),terrainRaster:h=>({u_matrix:new i.ck(h),u_image0:new i.cg(h),u_skirt_height:new i.ci(h),u_ground_shadow_factor:new i.ch(h)}),skybox:h=>({u_matrix:new i.ck(h),u_sun_direction:new i.ch(h),u_cubemap:new i.cg(h),u_opacity:new i.ci(h),u_temporal_offset:new i.ci(h)}),skyboxGradient:h=>({u_matrix:new i.ck(h),u_color_ramp:new i.cg(h),u_center_direction:new i.ch(h),u_radius:new i.ci(h),u_opacity:new i.ci(h),u_temporal_offset:new i.ci(h)}),skyboxCapture:h=>({u_matrix_3f:new i.dB(h),u_sun_direction:new i.ch(h),u_sun_intensity:new i.ci(h),u_color_tint_r:new i.d2(h),u_color_tint_m:new i.d2(h),u_luminance:new i.ci(h)}),globeRaster:h=>({u_proj_matrix:new i.ck(h),u_globe_matrix:new i.ck(h),u_normalize_matrix:new i.ck(h),u_merc_matrix:new i.ck(h),u_zoom_transition:new i.ci(h),u_merc_center:new i.cj(h),u_image0:new i.cg(h),u_grid_matrix:new i.dB(h),u_skirt_height:new i.ci(h),u_far_z_cutoff:new i.ci(h),u_frustum_tl:new i.ch(h),u_frustum_tr:new i.ch(h),u_frustum_br:new i.ch(h),u_frustum_bl:new i.ch(h),u_globe_pos:new i.ch(h),u_globe_radius:new i.ci(h),u_viewport:new i.cj(h)}),globeAtmosphere:h=>({u_frustum_tl:new i.ch(h),u_frustum_tr:new i.ch(h),u_frustum_br:new i.ch(h),u_frustum_bl:new i.ch(h),u_horizon:new i.ci(h),u_transition:new i.ci(h),u_fadeout_range:new i.ci(h),u_atmosphere_fog_color:new i.d2(h),u_high_color:new i.d2(h),u_space_color:new i.d2(h),u_temporal_offset:new i.ci(h),u_horizon_angle:new i.ci(h)}),model:h=>({u_matrix:new i.ck(h),u_lighting_matrix:new i.ck(h),u_normal_matrix:new i.ck(h),u_node_matrix:new i.ck(h),u_lightpos:new i.ch(h),u_lightintensity:new i.ci(h),u_lightcolor:new i.ch(h),u_camera_pos:new i.ch(h),u_opacity:new i.ci(h),u_baseColorFactor:new i.d2(h),u_emissiveFactor:new i.d2(h),u_metallicFactor:new i.ci(h),u_roughnessFactor:new i.ci(h),u_baseTextureIsAlpha:new i.cg(h),u_alphaMask:new i.cg(h),u_alphaCutoff:new i.ci(h),u_baseColorTexture:new i.cg(h),u_metallicRoughnessTexture:new i.cg(h),u_normalTexture:new i.cg(h),u_occlusionTexture:new i.cg(h),u_emissionTexture:new i.cg(h),u_lutTexture:new i.cg(h),u_color_mix:new i.d2(h),u_aoIntensity:new i.ci(h),u_emissive_strength:new i.ci(h),u_occlusionTextureTransform:new i.d2(h)}),modelDepth:h=>({u_matrix:new i.ck(h),u_instance:new i.ck(h),u_node_matrix:new i.ck(h)}),groundShadow:h=>({u_matrix:new i.ck(h),u_ground_shadow_factor:new i.ch(h)}),stars:h=>({u_matrix:new i.ck(h),u_up:new i.ch(h),u_right:new i.ch(h),u_intensity_multiplier:new i.ci(h)}),snowParticle:h=>({u_modelview:new i.ck(h),u_projection:new i.ck(h),u_time:new i.ci(h),u_cam_pos:new i.ch(h),u_velocityConeAperture:new i.ci(h),u_velocity:new i.ci(h),u_horizontalOscillationRadius:new i.ci(h),u_horizontalOscillationRate:new i.ci(h),u_boxSize:new i.ci(h),u_billboardSize:new i.ci(h),u_simpleShapeParameters:new i.cj(h),u_screenSize:new i.cj(h),u_thinningCenterPos:new i.cj(h),u_thinningShape:new i.ch(h),u_thinningAffectedRatio:new i.ci(h),u_thinningParticleOffset:new i.ci(h),u_particleColor:new i.d2(h),u_direction:new i.ch(h)}),rainParticle:h=>({u_modelview:new i.ck(h),u_projection:new i.ck(h),u_time:new i.ci(h),u_cam_pos:new i.ch(h),u_texScreen:new i.cg(h),u_velocityConeAperture:new i.ci(h),u_velocity:new i.ci(h),u_boxSize:new i.ci(h),u_rainDropletSize:new i.cj(h),u_distortionStrength:new i.ci(h),u_rainDirection:new i.ch(h),u_color:new i.d2(h),u_screenSize:new i.cj(h),u_thinningCenterPos:new i.cj(h),u_thinningShape:new i.ch(h),u_thinningAffectedRatio:new i.ci(h),u_thinningParticleOffset:new i.ci(h),u_shapeDirectionalPower:new i.ci(h),u_shapeNormalPower:new i.ci(h),u_mode:new i.ci(h)}),vignette:h=>({u_vignetteShape:new i.ch(h),u_vignetteColor:new i.d2(h)}),occlusion:h=>({u_matrix:new i.ck(h),u_anchorPos:new i.ch(h),u_screenSizePx:new i.cj(h),u_occluderSizePx:new i.cj(h),u_color:new i.d2(h)})};class Wl{constructor(n,l,f,v){this.id=Wl.uniqueIdxCounter,Wl.uniqueIdxCounter++,this.context=n;const w=n.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||v||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=Wl.uniqueIdxCounter,Wl.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Wl.uniqueIdxCounter=0;const Jp={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ag{constructor(n,l,f,v,w,E){this.length=l.length,this.attributes=f,this.itemSize=l.bytesPerElement,this.dynamicDraw=v,this.instanceCount=E,this.context=n;const M=n.gl;this.buffer=M.createBuffer(),n.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||w||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,l){for(let f=0;f<this.attributes.length;f++){const v=l.getAttributeLocation(n,this.attributes[f].name);v!==-1&&n.enableVertexAttribArray(v)}}setVertexAttribPointers(n,l,f){for(let v=0;v<this.attributes.length;v++){const w=this.attributes[v],E=l.getAttributeLocation(n,w.name);E!==-1&&n.vertexAttribPointer(E,w.components,n[Jp[w.type]],!1,this.itemSize,w.offset+this.itemSize*(f||0))}}setVertexAttribDivisor(n,l,f){for(let v=0;v<this.attributes.length;v++){const w=l.getAttributeLocation(n,this.attributes[v].name);w!==-1&&this.instanceCount&&this.instanceCount>0&&n.vertexAttribDivisor(w,f)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xh{constructor(n,l,f,v,w){this.context=n,this.width=l,this.height=f;const E=this.framebuffer=n.gl.createFramebuffer();v&&(this.colorAttachment=new ig(n,E)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new Yd(n,E):new pd(n,E))}destroy(){const n=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&n.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&n.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&n.deleteTexture(l)}n.deleteFramebuffer(this.framebuffer)}}class Kh{constructor(n,l){this.gl=n,this.clearColor=new qp(this),this.clearDepth=new $d(this),this.clearStencil=new Gp(this),this.colorMask=new Bh(this),this.depthMask=new w_(this),this.stencilMask=new ov(this),this.stencilFunc=new S_(this),this.stencilOp=new T_(this),this.stencilTest=new Wd(this),this.depthRange=new Hp(this),this.depthTest=new Yp(this),this.depthFunc=new qf(this),this.blend=new jh(this),this.blendFunc=new Gf(this),this.blendColor=new qd(this),this.blendEquation=new Gd(this),this.cullFace=new Hf(this),this.cullFaceSide=new Nh(this),this.frontFace=new Zp(this),this.program=new du(this),this.activeTexture=new ng(this),this.viewport=new zc(this),this.bindFramebuffer=new jl(this),this.bindRenderbuffer=new hd(this),this.bindTexture=new Fc(this),this.bindVertexBuffer=new Vh(this),this.bindElementBuffer=new Yf(this),this.bindVertexArrayOES=new E_(this),this.pixelStoreUnpack=new fd(this),this.pixelStoreUnpackPremultiplyAlpha=new Uh(this),this.pixelStoreUnpackFlipY=new kc(this),this.options=l?Object.assign({},l):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=l&&!!l.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=n.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.maxPointSize=n.getParameter(n.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,l,f){return new Wl(this,n,l,f)}createVertexBuffer(n,l,f,v,w){return new ag(this,n,l,f,v,w)}createRenderbuffer(n,l,f){const v=this.gl,w=v.createRenderbuffer();return this.bindRenderbuffer.set(w),v.renderbufferStorage(v.RENDERBUFFER,n,l,f),this.bindRenderbuffer.set(null),w}createFramebuffer(n,l,f,v){return new Xh(this,n,l,f,v)}clear({color:n,depth:l,stencil:f,colorMask:v}){const w=this.gl;let E=0;n&&(E|=w.COLOR_BUFFER_BIT,this.clearColor.set(n.toNonPremultipliedRenderColor(null)),this.colorMask.set(v||[!0,!0,!0,!0])),l!==void 0&&(E|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),f!==void 0&&(E|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),w.clear(E)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){i.bx(n.blendFunction,en.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let el;function Va(h,n,l,f,v,w,E){const M=h.context,D=M.gl,B=h.transform,j=[i.aF(B.center.lng),i.aJ(B.center.lat)],q=l.layout.get("symbol-placement"),U=l.layout.get("text-variable-anchor"),Y=l.layout.get("icon-rotation-alignment")==="map",ee=l.layout.get("text-rotation-alignment")==="map",re=q!=="point",ce=[];let ae=0,de=0;for(let be=0;be<f.length;be++){const De=f[be],He=n.getTile(De),$e=He.getBucket(l);if(!$e)continue;const st=$e.getProjection().createInversionMatrix(B,De.canonical),Qe=[],pt=Ri(De,$e,B),Ft=!E&&Y&&re,Xe=E&&ee&&re,je=U&&$e.hasTextData(),dt=$e.hasIconTextFit()&&je&&$e.hasIconData(),rt=Ft||Xe||E&&je||dt,Mt=$e.projection.name==="globe",$t=Mt?i.aj(B.zoom):0;Mt&&(Qe.push("PROJECTION_GLOBE_VIEW"),rt&&Qe.push("PROJECTED_POS_ON_VIEWPORT"));const fr=h.getOrCreateProgram("collisionBox",{defines:Qe});let kt=pt;v[0]===0&&v[1]===0||(kt=h.translatePosMatrix(pt,He,v,w));const Nt=E?$e.textCollisionBox:$e.iconCollisionBox,mr=$e.collisionCircleArray;if(mr.length>0){const Qt=i.bB(),ur=kt;i.cO(Qt,$e.placementInvProjMatrix,B.glCoordMatrix),i.cO(Qt,Qt,$e.placementViewportMatrix),ce.push({circleArray:mr,circleOffset:de,transform:ur,invTransform:Qt,projection:$e.getProjection()}),ae+=mr.length/4,de=ae}if(!Nt)continue;h.terrain&&h.terrain.setupElevationDraw(He,fr);const lr=Mt?[De.canonical.x,De.canonical.y,1<<De.canonical.z]:[0,0,0];fr.draw(h,D.LINES,pr.disabled,Nr.disabled,h.colorModeForRenderPass(),Vr.disabled,go(kt,st,B,$t,j,He,lr,$e.getProjection()),l.id,Nt.layoutVertexBuffer,Nt.indexBuffer,Nt.segments,null,B.zoom,null,[Nt.collisionVertexBuffer,Nt.collisionVertexBufferExt])}if(!E||!ce.length)return;const ye=h.getOrCreateProgram("collisionCircle"),fe=new i.dY;fe.resize(4*ae),fe._trim();let Me=0;for(const be of ce)for(let De=0;De<be.circleArray.length/4;De++){const He=4*De,$e=be.circleArray[He+0],st=be.circleArray[He+1],Qe=be.circleArray[He+2],pt=be.circleArray[He+3];fe.emplace(Me++,$e,st,Qe,pt,0),fe.emplace(Me++,$e,st,Qe,pt,1),fe.emplace(Me++,$e,st,Qe,pt,2),fe.emplace(Me++,$e,st,Qe,pt,3)}(!el||el.length<2*ae)&&(el=(function(be){const De=2*be,He=new i.b0;He.resize(De),He._trim();for(let $e=0;$e<De;$e++){const st=6*$e;He.uint16[st+0]=4*$e+0,He.uint16[st+1]=4*$e+1,He.uint16[st+2]=4*$e+2,He.uint16[st+3]=4*$e+2,He.uint16[st+4]=4*$e+3,He.uint16[st+5]=4*$e+0}return He})(ae));const xe=M.createIndexBuffer(el,!0),Ce=M.createVertexBuffer(fe,i.dZ.members,!0);for(const be of ce){const De={u_matrix:be.transform,u_inv_matrix:be.invTransform,u_camera_to_center_distance:(Te=B).getCameraToCenterDistance(be.projection),u_viewport_size:[Te.width,Te.height]};ye.draw(h,D.TRIANGLES,pr.disabled,Nr.disabled,h.colorModeForRenderPass(),Vr.disabled,De,l.id,Ce,xe,i.bf.simpleSegment(0,2*be.circleOffset,be.circleArray.length,be.circleArray.length/2),null,B.zoom)}var Te;Ce.destroy(),xe.destroy()}const xl=i.bB();function ip(h){const n=h._camera.getWorldToCamera(h.worldSize,1),l=i.aB([],n,h.globeMatrix);i.bk(l,l);const f=[0,0,0],v=[0,1,0,0];return i.aC(v,v,l),f[0]=v[0],f[1]=v[1],f[2]=v[2],i.aw(f,f),f}function op({width:h,height:n,anchor:l,textOffset:f,textScale:v},w){const{horizontalAlign:E,verticalAlign:M}=i.c0(l),D=-(E-.5)*h,B=-(M-.5)*n,j=i.c1(l,f);return new i.P((D/v+j[0])*w,(B/v+j[1])*w)}function pc(h,n,l,f,v,w,E,M,D,B){const j=h.text.placedSymbolArray,q=h.text.dynamicLayoutVertexArray,U=h.icon.dynamicLayoutVertexArray,Y={},ee=h.getProjection(),re=Ui(E,ee,v),ce=v.elevation,ae=ee.upVectorScale(E.canonical,v.center.lat,v.worldSize).metersToTile;q.clear();for(let de=0;de<j.length;de++){const ye=j.get(de),{tileAnchorX:fe,tileAnchorY:Me,numGlyphs:xe}=ye,Ce=ye.hidden||!ye.crossTileID||h.allowVerticalPlacement&&!ye.placedOrientation?null:f[ye.crossTileID];if(Ce){let Te=0,be=0,De=0;const He=h.elevationType==="road";if(ce||He){const rt=He?h.getElevationFeatureForText(de):null,Mt=i.bU.getAtTileOffset(E,new i.P(fe,Me),ce,rt),[$t,fr,kt]=ee.upVector(E.canonical,fe,Me);Te=Mt*$t*ae,be=Mt*fr*ae,De=Mt*kt*ae}let[$e,st,Qe,pt]=pi(ye.projectedAnchorX+Te,ye.projectedAnchorY+be,ye.projectedAnchorZ+De,l?re:w);const Ft=sc(v.getCameraToCenterDistance(ee),pt);let Xe=i.bL(h.textSizeData,D,ye)*Ft/i.bX;l&&(Xe*=h.tilePixelRatio/M);const je=op(Ce,Xe);l?({x:$e,y:st,z:Qe}=ee.projectTilePoint(fe+je.x,Me+je.y,E.canonical),[$e,st,Qe]=pi($e+Te,st+be,Qe+De,w)):(n&&je._rotate(-v.angle),$e+=je.x,st+=je.y,Qe=0);const dt=h.allowVerticalPlacement&&ye.placedOrientation===i.bK.vertical?Math.PI/2:0;for(let rt=0;rt<xe;rt++)i.bN(q,$e,st,Qe,dt);B&&ye.associatedIconIndex>=0&&(Y[ye.associatedIconIndex]={x:$e,y:st,z:Qe,angle:dt})}else Ll(xe,q)}if(B){U.clear();const de=h.icon.placedSymbolArray;for(let ye=0;ye<de.length;ye++){const fe=de.get(ye),{numGlyphs:Me}=fe,xe=Y[ye];if(fe.hidden||!xe)Ll(Me,U);else{const{x:Ce,y:Te,z:be,angle:De}=xe;for(let He=0;He<Me;He++)i.bN(U,Ce,Te,be,De)}}h.icon.dynamicLayoutVertexBuffer.updateData(U)}h.text.dynamicLayoutVertexBuffer.updateData(q)}function mc(h,n,l,f,v,w,E={}){const M=l.paint.get("icon-translate"),D=l.paint.get("text-translate"),B=l.paint.get("icon-translate-anchor"),j=l.paint.get("text-translate-anchor"),q=l.layout.get("icon-rotation-alignment"),U=l.layout.get("text-rotation-alignment"),Y=l.layout.get("icon-pitch-alignment"),ee=l.layout.get("text-pitch-alignment"),re=l.layout.get("icon-keep-upright"),ce=l.layout.get("text-keep-upright"),ae=l.paint.get("icon-color-saturation"),de=l.paint.get("icon-color-contrast"),ye=l.paint.get("icon-color-brightness-min"),fe=l.paint.get("icon-color-brightness-max"),Me=l.layout.get("symbol-elevation-reference")==="sea",xe=l.layout.get("icon-image-use-theme")==="none",Ce=h.context,Te=Ce.gl,be=h.transform,De=q==="map",He=U==="map",$e=Y==="map",st=ee==="map",Qe=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let pt=!1;const Ft=h.depthModeForSublayer(0,pr.ReadOnly),Xe=new pr(h.context.gl.LEQUAL,pr.ReadOnly,h.depthRangeFor3D),je=[i.aF(be.center.lng),i.aJ(be.center.lat)],dt=l.layout.get("text-variable-anchor"),rt=be.projection.name==="globe",Mt=[],$t=[0,-1,0];for(const fr of f){const kt=n.getTile(fr),Nt=kt.getBucket(l);if(!Nt||Nt.projection.name==="mercator"&&rt||Nt.fullyClipped)continue;const mr=Nt.projection.name==="globe",lr=mr?i.aj(be.zoom):0,Qt=Ui(fr,Nt.getProjection(),be),ur=be.calculatePixelsToTileUnitsMatrix(kt),Dr=dt&&Nt.hasTextData(),_n=Nt.hasIconTextFit()&&Dr&&Nt.hasIconData(),Kr=Nt.getProjection().createInversionMatrix(be,fr.canonical),hi=(1<<kt.tileID.canonical.z)*i.al/h.transform.worldSize,Wr=Pn=>{let qr=[0,0,0];if(Pn){const En=h.style.directionalLight,zi=h.style.ambientLight;En&&zi&&(qr=Na(h.style,En,zi))}return qr},Sn=Pn=>{be.depthOcclusionForSymbolsAndCircles&&(l.hasOcclusionOpacityProperties||h.terrain)&&(Pn.push("DEPTH_D24"),Pn.push("DEPTH_OCCLUSION"))},sn=Pn=>{l.lut&&!xe&&(l.lut.texture||(l.lut.texture=new i.d_(h.context,l.lut.image,[l.lut.image.height,l.lut.image.height,l.lut.image.height],Ce.gl.RGBA8)),Ce.activeTexture.set(Ce.gl.TEXTURE0+Eo.LUT),l.lut.texture&&l.lut.texture.bind(Ce.gl.LINEAR,Ce.gl.CLAMP_TO_EDGE),Pn.push("APPLY_LUT_ON_GPU"))},ti=()=>{const Pn=De&&l.layout.get("symbol-placement")!=="point",qr=[];Sn(qr),sn(qr);const En=Pn||_n,zi=Nt.elevationType==="road",_o=h.shadowRenderer,ki=zi&&$e&&!!_o&&_o.enabled,so=Wr(ki),Wa=zi&&$e&&!h.terrain?Xe:Ft,Ca=l.paint.get("icon-image-cross-fade");h.terrainRenderModeElevated()&&$e&&qr.push("PITCH_WITH_MAP_TERRAIN"),mr&&(qr.push("PROJECTION_GLOBE_VIEW"),En&&qr.push("PROJECTED_POS_ON_VIEWPORT")),Ca>0&&Nt.hasAnySecondaryIcon&&qr.push("ICON_TRANSITION"),!Nt.icon.zOffsetVertexBuffer||zi&&h.terrain||qr.push("Z_OFFSET"),ae===0&&de===0&&ye===0&&fe===1||qr.push("COLOR_ADJUSTMENT"),Nt.sdfIcons&&qr.push("RENDER_SDF"),ki&&qr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),zi&&$e&&!h.terrain&&Nt.icon.orientationVertexBuffer&&qr.push("ELEVATED_ROADS");const ls=Nt.icon.programConfigurations.get(l.id),vs=h.getOrCreateProgram("symbol",{config:ls,defines:qr}),Sl=kt.imageAtlasTexture?kt.imageAtlasTexture.size:[0,0],xs=Nt.iconSizeData,Xl=i.bJ(xs,be.zoom),Kl=$e||!be.isOrthographic,is=qs(Qt,kt.tileID.canonical,$e,De,be,Nt.getProjection(),ur),Bi=sa(Qt,kt.tileID.canonical,$e,De,be,Nt.getProjection(),ur),ao=h.translatePosMatrix(Bi,kt,M,B,!0),li=h.translatePosMatrix(Qt,kt,M,B),yo=En?xl:is,bs=De&&!$e&&!Pn;let ji=$t;!rt&&!be.mercatorFromTransition||De||(ji=ip(be));const Ql=mr?ji:$t,vu=l.getColorAdjustmentMatrix(ae,de,ye,fe),Gu=Zh(xs.kind,Xl,bs,$e,h,li,yo,ao,Me,!1,Sl,[0,0],0,fr,lr,je,Kr,Ql,Nt.getProjection(),so,hi,vu,Ca,null),Hu=kt.imageAtlasTexture?kt.imageAtlasTexture:null,_=l.layout.get("icon-size").constantOr(0)!==1||Nt.iconsNeedLinear,S=Nt.sdfIcons||h.options.rotating||h.options.zooming||_||Kl?Te.LINEAR:Te.NEAREST,A=Nt.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,N=h.terrain&&$e&&Pn?i.bk(i.bB(),is):xl;if(Pn&&Nt.icon){const K=i.bU.getAtTileOffsetFunc(fr,be.center.lat,be.worldSize,Nt.getProjection()),oe=ka(Qt,kt.tileID.canonical,$e,De,be,Nt.getProjection(),ur),Ee=l.layout.get("icon-size-scale-range"),Ke=i.aA(h.scaleFactor,Ee[0],Ee[1]);Oc(Nt,Qt,h,!1,oe,Bi,$e,re,K,fr,Ke)}return{program:vs,buffers:Nt.icon,uniformValues:Gu,atlasTexture:Hu,atlasTextureIcon:null,atlasInterpolation:S,atlasInterpolationIcon:null,isSDF:Nt.sdfIcons,hasHalo:A,depthMode:Wa,tile:kt,renderWithShadows:ki,labelPlaneMatrixInv:N}},Tn=()=>{const Pn=He&&l.layout.get("symbol-placement")!=="point",qr=[],En=Pn||dt||_n,zi=Nt.elevationType==="road",_o=h.shadowRenderer,ki=zi&&st&&!!_o&&_o.enabled,so=Wr(ki),Wa=zi&&st&&!h.terrain?Xe:Ft;h.terrainRenderModeElevated()&&st&&qr.push("PITCH_WITH_MAP_TERRAIN"),mr&&(qr.push("PROJECTION_GLOBE_VIEW"),En&&qr.push("PROJECTED_POS_ON_VIEWPORT")),!Nt.text.zOffsetVertexBuffer||zi&&h.terrain||qr.push("Z_OFFSET"),Nt.iconsInText&&qr.push("RENDER_TEXT_AND_SYMBOL"),qr.push("RENDER_SDF"),ki&&qr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),zi&&st&&!h.terrain&&Nt.text.orientationVertexBuffer&&qr.push("ELEVATED_ROADS"),Sn(qr);const Ca=Nt.text.programConfigurations.get(l.id),ls=h.getOrCreateProgram("symbol",{config:Ca,defines:qr});let vs,Sl=[0,0],xs=null;const Xl=Nt.textSizeData;Nt.iconsInText&&(Sl=kt.imageAtlasTexture?kt.imageAtlasTexture.size:[0,0],xs=kt.imageAtlasTexture?kt.imageAtlasTexture:null,vs=st||!be.isOrthographic||h.options.rotating||h.options.zooming||Xl.kind==="composite"||Xl.kind==="camera"?Te.LINEAR:Te.NEAREST);const Kl=kt.glyphAtlasTexture?kt.glyphAtlasTexture.size:[0,0],is=l.layout.get("text-size-scale-range"),Bi=i.aA(h.scaleFactor,is[0],is[1]),ao=i.bJ(Xl,be.zoom,Bi),li=qs(Qt,kt.tileID.canonical,st,He,be,Nt.getProjection(),ur),yo=sa(Qt,kt.tileID.canonical,st,He,be,Nt.getProjection(),ur),bs=h.translatePosMatrix(yo,kt,D,j,!0),ji=h.translatePosMatrix(Qt,kt,D,j),Ql=En?xl:li,vu=He&&!st&&!Pn;let Gu=$t;!rt&&!be.mercatorFromTransition||He||(Gu=ip(be));const Hu=Zh(Xl.kind,ao,vu,st,h,ji,Ql,bs,Me,!0,Kl,Sl,0,fr,lr,je,Kr,mr?Gu:$t,Nt.getProjection(),so,hi,null,null,Bi),_=kt.glyphAtlasTexture?kt.glyphAtlasTexture:null,S=Te.LINEAR,A=l.paint.get("text-halo-width").constantOr(1)!==0,N=h.terrain&&st&&Pn?i.bk(i.bB(),li):xl;if(Pn&&Nt.text){const K=i.bU.getAtTileOffsetFunc(fr,be.center.lat,be.worldSize,Nt.getProjection()),oe=ka(Qt,kt.tileID.canonical,st,He,be,Nt.getProjection(),ur);Oc(Nt,Qt,h,!0,oe,yo,st,ce,K,fr,Bi)}return{program:ls,buffers:Nt.text,uniformValues:Hu,atlasTexture:_,atlasTextureIcon:xs,atlasInterpolation:S,atlasInterpolationIcon:vs,isSDF:!0,hasHalo:A,depthMode:Wa,tile:kt,renderWithShadows:ki,labelPlaneMatrixInv:N}},vi=Nt.icon.segments.get().length,yn=Nt.text.segments.get().length,nn=vi&&!E.onlyText?ti():null,qn=yn&&!E.onlyIcons?Tn():null,Jr=l.paint.get("icon-opacity").constantOr(1),xi=l.paint.get("text-opacity").constantOr(1);if(Qe&&Nt.canOverlap){pt=!0;const Pn=Jr&&!E.onlyText?Nt.icon.segments.get():[],qr=xi&&!E.onlyIcons?Nt.text.segments.get():[];for(const En of Pn)Mt.push({segments:new i.bf([En]),sortKey:En.sortKey,state:nn});for(const En of qr)Mt.push({segments:new i.bf([En]),sortKey:En.sortKey,state:qn})}else E.onlyText||Mt.push({segments:Jr?Nt.icon.segments:new i.bf([]),sortKey:0,state:nn}),E.onlyIcons||Mt.push({segments:xi?Nt.text.segments:new i.bf([]),sortKey:0,state:qn})}pt&&Mt.sort(((fr,kt)=>fr.sortKey-kt.sortKey));for(const fr of Mt){const kt=fr.state;if(kt)if(h.terrain?h.terrain.setupElevationDraw(kt.tile,kt.program,{useDepthForOcclusion:be.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:kt.labelPlaneMatrixInv}):h.setupDepthForOcclusion(be.depthOcclusionForSymbolsAndCircles,kt.program),Ce.activeTexture.set(Te.TEXTURE0),kt.atlasTexture&&kt.atlasTexture.bind(kt.atlasInterpolation,Te.CLAMP_TO_EDGE,!0),kt.atlasTextureIcon&&(Ce.activeTexture.set(Te.TEXTURE1),kt.atlasTextureIcon&&kt.atlasTextureIcon.bind(kt.atlasInterpolationIcon,Te.CLAMP_TO_EDGE,!0)),kt.renderWithShadows&&h.shadowRenderer.setupShadows(kt.tile.tileID.toUnwrapped(),kt.program,"vector-tile"),h.uploadCommonLightUniforms(h.context,kt.program),kt.hasHalo){const Nt=kt.uniformValues;Nt.u_is_halo=1,Qh(kt.buffers,fr.segments,l,h,kt.program,kt.depthMode,v,w,Nt,2),Nt.u_is_halo=0}else{if(kt.isSDF){const Nt=kt.uniformValues;kt.hasHalo&&(Nt.u_is_halo=1,Qh(kt.buffers,fr.segments,l,h,kt.program,kt.depthMode,v,w,Nt,1)),Nt.u_is_halo=0}Qh(kt.buffers,fr.segments,l,h,kt.program,kt.depthMode,v,w,kt.uniformValues,1)}}}function Qh(h,n,l,f,v,w,E,M,D,B){const j=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.iconTransitioningVertexBuffer,h.globeExtVertexBuffer,h.zOffsetVertexBuffer,h.orientationVertexBuffer];v.draw(f,f.context.gl.TRIANGLES,w,E,M,Vr.disabled,D,l.id,h.layoutVertexBuffer,h.indexBuffer,n,l.paint,f.transform.zoom,h.programConfigurations.get(l.id),j,B)}function lg(h,n){const l=1<<h.canonical.z,f=(n.x*l-h.canonical.x-h.wrap*l)*i.al,v=(n.y*l-h.canonical.y)*i.al,w=i.e7(n.z,n.y);return i.d4(f,v,w)}function tl(h,n,l,f,v){if(!l.layout||l.layout.get("fill-elevation-reference")==="none"||l.paint.get("fill-opacity").constantOr(1)===0)return;const w=h.context.gl,E=new pr(h.context.gl.LEQUAL,pr.ReadWrite,h.depthRangeFor3D),M=new pr(h.context.gl.GREATER,pr.ReadWrite,h.depthRangeFor3D),D=(function(Y){let ee=.01;return Y.isOrthographic&&(ee=i.ak(1e-4,ee,i.c$(Y.pitch>=uc?1:Y.pitch/uc))),2*ee})(h.transform),B=h.transform.getFreeCameraOptions().position,j="elevatedStructuresDepthReconstruct",q=h.getOrCreateProgram(j,{defines:["DEPTH_RECONSTRUCTION"]}),U=h.getOrCreateProgram(j);for(const Y of f){const ee=n.getTile(Y),re=ee.getBucket(l);if(!re)continue;const ce=re.elevatedStructures;if(!ce)continue;const ae=re.elevationBufferData.heightRange,de=lg(Y.toUnwrapped(),B),ye=h.translatePosMatrix(Y.projMatrix,ee,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));let fe,Me,xe,Ce;if(v==="initialize"){if(!ae||ae.min>=1||ce.depthSegments.segments[0].primitiveLength===0)continue;fe=Gh(ye,de,D,1,0),Me=E,xe=ce.depthSegments,Ce=q}else if(v==="reset"){if(!ae||ae.min>=0||ce.maskSegments.segments[0].primitiveLength===0)continue;fe=Gh(ye,de,0,0,1),Me=M,xe=ce.maskSegments,Ce=q}else if(v==="geometry"){if(ce.depthSegments.segments[0].primitiveLength===0)continue;fe=Gh(ye,de,D,1,0),Me=E,xe=ce.depthSegments,Ce=U}Ce.draw(h,w.TRIANGLES,Me,Nr.disabled,en.disabled,Vr.disabled,fe,l.id,ce.vertexBuffer,ce.indexBuffer,xe,l.paint,h.transform.zoom)}}function ql(h,n,l){const{painter:f,sourceCache:v,layer:w,coords:E,colorMode:M,elevationType:D,terrainEnabled:B,pass:j}=h,q=f.context.gl,U=w.paint.get("fill-pattern"),Y=w.paint.get("fill-pattern-cross-fade"),ee=U.constantOr(null);let re=D;D!=="road"||n&&!B||(re="none");const ce=re==="road",ae=h.painter.shadowRenderer,de=ce&&!!ae&&ae.enabled,ye=new pr(f.context.gl.LEQUAL,pr.ReadOnly,f.depthRangeFor3D);let fe=[0,0,0];if(de){const Ce=f.style.directionalLight,Te=f.style.ambientLight;Ce&&Te&&(fe=Na(f.style,Ce,Te))}const Me=U&&U.constantOr(1),xe=(Ce,Te)=>{let be,De,He,$e,st;Te?(be=Me&&!w.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",He=q.LINES):(be=Me?"fillPattern":"fill",He=q.TRIANGLES);for(const Qe of E){const pt=v.getTile(Qe);if(Me&&!pt.patternsLoaded())continue;const Ft=pt.getBucket(w);if(!Ft)continue;const Xe=n?Ft.elevationBufferData:Ft.bufferData;if(Xe.isEmpty())continue;f.prepareDrawTile();const je=Xe.programConfigurations.get(w.id),dt=f.isTileAffectedByFog(Qe),rt=[],Mt=[];ce&&(rt.push("ELEVATED_ROADS"),Mt.push(Xe.elevatedLayoutVertexBuffer)),de&&rt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Me&&(f.context.activeTexture.set(q.TEXTURE0),pt.imageAtlasTexture&&pt.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),je.updatePaintBuffers());let $t=!1;if(ee&&pt.imageAtlas){const lr=pt.imageAtlas,Qt=i.e2.from(ee),ur=Qt.getPrimary().scaleSelf(i.o.devicePixelRatio).toString(),Dr=Qt.getSecondary(),_n=lr.patternPositions.get(ur),Kr=Dr?lr.patternPositions.get(Dr.scaleSelf(i.o.devicePixelRatio).toString()):null;$t=!!_n&&!!Kr,_n&&je.setConstantPatternPositions(_n,Kr)}Y>0&&($t||je.getPatternTransitionVertexBuffer("fill-pattern"))&&rt.push("FILL_PATTERN_TRANSITION");const fr=f.getOrCreateProgram(be,{config:je,overrideFog:dt,defines:rt}),kt=f.translatePosMatrix(Qe.projMatrix,pt,w.paint.get("fill-translate"),w.paint.get("fill-translate-anchor"));de&&ae.setupShadows(pt.tileID.toUnwrapped(),fr,"vector-tile");const Nt=w.paint.get("fill-emissive-strength");if(Te){$e=Xe.lineIndexBuffer,st=Xe.lineSegments;const lr=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[q.drawingBufferWidth,q.drawingBufferHeight];De=be==="fillOutlinePattern"&&Me?Kd(kt,Nt,f,pt,lr,fe,Y):ju(kt,Nt,lr,fe)}else $e=Xe.indexBuffer,st=Xe.triangleSegments,De=Me?fu(kt,Nt,f,pt,fe,Y):md(kt,Nt,fe);f.uploadCommonUniforms(f.context,fr,Qe.toUnwrapped());let mr=Ce;(D==="road"&&!B||D==="offset")&&(mr=ye),fr.draw(f,He,mr,l||f.stencilModeForClipping(Qe),M,Vr.disabled,De,w.id,Xe.layoutVertexBuffer,$e,st,w.paint,f.transform.zoom,je,Mt)}};f.renderPass===j&&xe(f.depthModeForSublayer(1,f.renderPass==="opaque"?pr.ReadWrite:pr.ReadOnly),!1),re==="none"&&f.renderPass==="translucent"&&w.paint.get("fill-antialias")&&xe(f.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,pr.ReadOnly),!0)}function cr(h,n,l,f,v,w,E,M){l.resetLayerRenderingStats(h);const D=h.context,B=D.gl,j=h.transform,q=l.paint.get("fill-extrusion-pattern"),U=l.paint.get("fill-extrusion-pattern-cross-fade"),Y=q.constantOr(null),ee=q.constantOr(1),re=l.paint.get("fill-extrusion-opacity"),ce=h.style.enable3dLights(),ae=l.paint.get(ce&&!ee?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),de=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),ae],ye=l.layout.get("fill-extrusion-edge-radius"),fe=ye>0&&!l.paint.get("fill-extrusion-rounded-roof"),Me=fe?0:ye,xe=j.projection.name==="globe"?i.ea():0,Ce=j.projection.name==="globe",Te=Ce?i.aj(j.zoom):0,be=[i.aF(j.center.lng),i.aJ(j.center.lat)],De=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",He=l.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(De?null:l.lut).toArray01().slice(0,3),$e=l.paint.get("fill-extrusion-flood-light-intensity"),st=l.paint.get("fill-extrusion-vertical-scale"),Qe=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,pt=l.paint.get("fill-extrusion-height-alignment"),Ft=l.paint.get("fill-extrusion-base-alignment"),Xe=Qa(h,l.paint.get("fill-extrusion-cutoff-fade-range")),je=[];let dt;Ce&&je.push("PROJECTION_GLOBE_VIEW"),de[0]>0&&je.push("FAUX_AO"),fe&&je.push("ZERO_ROOF_RADIUS"),M&&je.push("HAS_CENTROID"),$e>0&&je.push("FLOOD_LIGHT"),Xe.shouldRenderCutoff&&je.push("RENDER_CUTOFF"),Qe&&je.push("RENDER_WALL_MODE");const rt=h.renderPass==="shadow",Mt=h.shadowRenderer,$t=rt&&!!Mt,fr=rt?Vr.disabled:Vr.backCCW;h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!0);let kt=[0,0,0];if(Mt){const lr=h.style.directionalLight,Qt=h.style.ambientLight;lr&&Qt&&(kt=Na(h.style,lr,Qt)),rt||(je.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Mt.useNormalOffset&&je.push("NORMAL_OFFSET")),dt=je.concat(["SHADOWS_SINGLE_CASCADE"])}const Nt=$t?"fillExtrusionDepth":ee?"fillExtrusionPattern":"fillExtrusion",mr=l.getLayerRenderingStats();for(const lr of f){const Qt=n.getTile(lr),ur=Qt.getBucket(l);if(!ur||ur.projection.name!==j.projection.name)continue;let Dr=!1;Mt&&(Dr=Mt.getMaxCascadeForTile(lr.toUnwrapped())===0);const _n=h.isTileAffectedByFog(lr),Kr=ur.programConfigurations.get(l.id);let hi=!1;if(Y&&Qt.imageAtlas){const yn=Qt.imageAtlas,nn=i.e2.from(Y),qn=nn.getPrimary().scaleSelf(i.o.devicePixelRatio).toString(),Jr=nn.getSecondary(),xi=yn.patternPositions.get(qn),Pn=Jr?yn.patternPositions.get(Jr.scaleSelf(i.o.devicePixelRatio).toString()):null;hi=!!xi&&!!Pn,xi&&Kr.setConstantPatternPositions(xi,Pn)}U>0&&(hi||Kr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&je.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Wr=h.getOrCreateProgram(Nt,{config:Kr,defines:Dr?dt:je,overrideFog:_n});if(h.terrain&&h.terrain.setupElevationDraw(Qt,Wr,{useMeterToDem:!0}),!ur.centroidVertexBuffer){const yn=Wr.getAttributeLocation(B,"a_centroid_pos");yn!==-1&&B.vertexAttrib2f(yn,0,0)}!rt&&Mt&&Mt.setupShadows(Qt.tileID.toUnwrapped(),Wr,"vector-tile"),ee&&(h.context.activeTexture.set(B.TEXTURE0),Qt.imageAtlasTexture&&Qt.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Kr.updatePaintBuffers());const Sn=l.paint.get("fill-extrusion-vertical-gradient"),sn=1/ur.tileToMeter;let ti;if(rt&&Mt){if(Jh(Qt.tileID,ur.maxHeight,h))continue;const yn=Mt.calculateShadowPassMatrixFromTile(Qt.tileID.toUnwrapped());ti=Qf(yn,Me,sn,st,pt,Ft)}else{const yn=h.translatePosMatrix(lr.expandedProjMatrix,Qt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),nn=j.projection.createInversionMatrix(j,lr.canonical);ti=ee?Vl(yn,h,Sn,re,de,Me,sn,lr,Qt,xe,pt,Ft,Te,be,nn,He,st,U):Xd(yn,h,Sn,re,de,Me,sn,lr,xe,pt,Ft,Te,be,nn,He,st,$e,kt)}h.uploadCommonUniforms(D,Wr,lr.toUnwrapped(),null,Xe);let Tn=ur.segments;if(j.projection.name==="mercator"&&!rt&&(Tn=ur.getVisibleSegments(Qt.tileID,h.terrain,h.transform.getFrustum(0)),!Tn.get().length))continue;if(mr)if(rt)for(const yn of Tn.get())mr.numRenderedVerticesInShadowPass+=yn.primitiveLength;else for(const yn of Tn.get())mr.numRenderedVerticesInTransparentPass+=yn.primitiveLength;const vi=[];(h.terrain||M)&&vi.push(ur.centroidVertexBuffer),Ce&&vi.push(ur.layoutVertexExtBuffer),Qe&&vi.push(ur.wallVertexBuffer),Wr.draw(h,D.gl.TRIANGLES,v,w,E,fr,ti,l.id,ur.layoutVertexBuffer,ur.indexBuffer,Tn,l.paint,h.transform.zoom,Kr,vi)}h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!1)}class em{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function gc(h,n,l,f,v,w,E,M,D,B,j,q,U,Y,ee,re,ce,ae,de,ye){const fe=n.context,Me=fe.gl,xe=n.transform,Ce=n.transform.zoom,Te=[],be=h.translate,De=h.translateAnchor,He=h.edgeRadius,$e=Qa(n,h.cutoffFadeRange);j==="clear"?(Te.push("CLEAR_SUBPASS"),ye&&(Te.push("CLEAR_FROM_TEXTURE"),fe.activeTexture.set(Me.TEXTURE0),ye.bind(Me.LINEAR,Me.CLAMP_TO_EDGE))):j==="sdf"&&Te.push("SDF_SUBPASS"),ae&&Te.push("HAS_CENTROID"),$e.shouldRenderCutoff&&Te.push("RENDER_CUTOFF");const st=(Qe,pt,Ft,Xe,je)=>{let dt=Te;pt.groundRadiusBuffer!=null&&(dt=Te.concat("HAS_ATTRIBUTE_a_flood_light_ground_radius"));const rt=pt.programConfigurations.get(f.id),Mt=n.isTileAffectedByFog(Qe),$t=n.getOrCreateProgram("fillExtrusionGroundEffect",{config:rt,defines:dt,overrideFog:Mt}),fr=Pa(n,Xe,q,B,je,[U,Y*je],ee,re,ce,Ce>=17?0:He*je,ye?ye.size[0]:0),kt=[];ae&&kt.push(pt.hiddenByLandmarkVertexBuffer),pt.groundRadiusBuffer!=null&&kt.push(pt.groundRadiusBuffer),n.uploadCommonUniforms(fe,$t,Qe.toUnwrapped(),null,$e),$t.draw(n,fe.gl.TRIANGLES,w,E,M,D,fr,f.id,pt.vertexBuffer,pt.indexBuffer,Ft,f.paint,Ce,rt,kt)};for(const Qe of v){const pt=l.getTile(Qe),Ft=pt.getBucket(f);if(!Ft||Ft.projection.name!==xe.projection.name||!Ft.groundEffect||Ft.groundEffect&&!Ft.groundEffect.hasData())continue;const Xe=Ft.groundEffect,je=1/Ft.tileToMeter;{const dt=n.translatePosMatrix(Qe.projMatrix,pt,be,De),rt=Xe.getDefaultSegment();st(Qe,Xe,rt,dt,je)}if(de)for(let dt=0;dt<4;dt++){const rt=i.e8[dt](Qe),Mt=l.getTile(rt);if(!Mt)continue;const $t=Mt.getBucket(f);if(!$t||$t.projection.name!==xe.projection.name||!$t.groundEffect||$t.groundEffect&&!$t.groundEffect.hasData())continue;const fr=$t.groundEffect;let kt,Nt;dt===0?(kt=[-i.al,0,0],Nt=1):dt===1?(kt=[i.al,0,0],Nt=0):dt===2?(kt=[0,-i.al,0],Nt=3):(kt=[0,i.al,0],Nt=2);const mr=fr.regionSegments[Nt];if(!mr)continue;const lr=new Float32Array(16);i.bq(lr,Qe.projMatrix,kt),st(Qe,fr,mr,n.translatePosMatrix(lr,pt,be,De),je)}}}function Vu(h,n,l,f,v,w,E){f.centroidVertexArray.length===0&&f.createCentroidsBuffer();const M=w?w.findDEMTileFor(l):null;if(!(M&&M.dem||E))return;w&&M&&M.dem&&f.selfDEMTileTimestamp!==M.dem._timestamp&&(f.borderDoneWithNeighborZ=[-1,-1,-1,-1],f.selfDEMTileTimestamp=M.dem._timestamp);const D=ae=>new i.P(Math.ceil((ae+i.ec)*i.ed),0),B=ae=>{const de=n.getSource().minzoom,ye=Me=>{const xe=n.getTileByID(Me);if(xe&&xe.hasData())return xe.getBucket(v)},fe=[0,-1,1];for(const Me of fe){if(ae.overscaledZ+Me<de)continue;const xe=ye(ae.calculateScaledKey(ae.overscaledZ+Me));if(xe)return xe}},j=[0,0,0],q=(ae,de)=>(j[0]=Math.min(ae.min.y,de.min.y),j[1]=Math.max(ae.max.y,de.max.y),j[2]=i.al-de.min.x>ae.max.x?de.min.x-i.al:ae.max.x,j),U=(ae,de)=>(j[0]=Math.min(ae.min.x,de.min.x),j[1]=Math.max(ae.max.x,de.max.x),j[2]=i.al-de.min.y>ae.max.y?de.min.y-i.al:ae.max.y,j),Y=[(ae,de)=>q(ae,de),(ae,de)=>q(de,ae),(ae,de)=>U(ae,de),(ae,de)=>U(de,ae)],ee=(ae,de,ye,fe,Me,xe,Ce)=>{if(!w)return 0;const Te=[[xe?ye:ae,xe?ae:ye,0],[xe?ye:de,xe?de:ye,0]],be=Ce<0?i.al+Ce:Ce,De=[xe?be:(ae+de)/2,xe?(ae+de)/2:be,0];return ye===0&&Ce<0||ye!==0&&Ce>0?w.getForTilePoints(Me,[De],!0,fe):Te.push(De),w.getForTilePoints(l,Te,!0,M),Math.max(Te[0][2],Te[1][2],De[2])/w.exaggeration()};for(let ae=0;ae<4;ae++){const de=f.borderFeatureIndices[ae];if(de.length===0)continue;const ye=i.e8[ae](l),fe=B(ye);if(!(fe&&fe instanceof i.e9))continue;const Me=w?w.findDEMTileFor(ye):null;if(!(Me&&Me.dem||E)||(w&&Me&&Me.dem&&f.borderDEMTileTimestamp[ae]!==Me.dem._timestamp&&(f.borderDoneWithNeighborZ[ae]=-1,f.borderDEMTileTimestamp[ae]=Me.dem._timestamp),f.borderDoneWithNeighborZ[ae]===fe.canonical.z))continue;fe.centroidVertexArray.length===0&&fe.createCentroidsBuffer();const xe=(ae<2?1:5)-ae,Ce=fe.borderDoneWithNeighborZ[xe]!==f.canonical.z,Te=fe.borderFeatureIndices[xe];let be=0;if(f.canonical.z!==fe.canonical.z){for(const De of de)f.showCentroid(f.featuresOnBorder[De]);if(Ce)for(const De of Te)fe.showCentroid(fe.featuresOnBorder[De]);f.borderDoneWithNeighborZ[ae]=fe.canonical.z,fe.borderDoneWithNeighborZ[xe]=f.canonical.z}for(const De of de){const He=f.featuresOnBorder[De],$e=f.centroidData[He.centroidDataIndex],st=He.borders[ae];let Qe;for(;be<Te.length;){Qe=fe.featuresOnBorder[Te[be]];const pt=Qe.borders[xe];if(pt[1]>st[0]+3||pt[0]>st[0]-3)break;fe.showCentroid(Qe),be++}if(Qe&&be<Te.length){const pt=be;let Ft=0;for(;!(Qe.borders[xe][0]>st[1]-3)&&(Ft++,++be!==Te.length);)Qe=fe.featuresOnBorder[Te[be]];Qe=fe.featuresOnBorder[Te[pt]];let Xe=!1;if(Ft>=1){const rt=Qe.borders[xe];Math.abs(st[0]-rt[0])<3&&Math.abs(st[1]-rt[1])<3&&(Ft=1,Xe=!0,be=pt+1)}else if(Ft===0){f.showCentroid(He);continue}const je=fe.centroidData[Qe.centroidDataIndex];E&&Xe&&(((re=$e).flags|(ce=je).flags)&i.eb?(re.flags|=i.eb,ce.flags|=i.eb):(re.flags&=~i.eb,ce.flags&=~i.eb));const dt=He.intersectsCount()>1||Qe.intersectsCount()>1;if(Ft>1)be=pt,$e.centroidXY=je.centroidXY=new i.P(0,0);else if(Me&&Me.dem&&!dt){const rt=Y[ae]($e,je),Mt=ae%2?i.al-1:0,$t=ee(rt[0],Math.min(i.al-1,rt[1]),Mt,Me,ye,ae<2,rt[2]);$e.centroidXY=je.centroidXY=D($t)}else dt?$e.centroidXY=je.centroidXY=new i.P(0,0):($e.centroidXY=f.encodeBorderCentroid(He),je.centroidXY=fe.encodeBorderCentroid(Qe));f.writeCentroidToBuffer($e),fe.writeCentroidToBuffer(je)}else f.showCentroid(He)}f.borderDoneWithNeighborZ[ae]=fe.canonical.z,fe.borderDoneWithNeighborZ[xe]=f.canonical.z}var re,ce;(f.needsCentroidUpdate||!f.centroidVertexBuffer&&f.centroidVertexArray.length!==0)&&f.uploadCentroid(h)}const _c=[1,0,0],Mr=[0,1,0],eh=[0,0,1];function Jh(h,n,l){const f=l.transform,v=l.shadowRenderer;if(!v)return!0;const w=h.toUnwrapped(),E=f.tileSize*v._cascades[l.currentShadowCascade].scale;let M=n;if(f.elevation){const re=f.elevation.getMinMaxForTile(h);re&&(M+=re.max)}const D=[...v.shadowDirection];D[2]=-D[2];const B=v.computeSimplifiedTileShadowVolume(w,M,E,D);if(!B)return!1;const j=[_c,Mr,eh,D,[D[0],0,D[2]],[0,D[1],D[2]]],q=f.projection.name==="globe",U=f.scaleZoom(E),Y=i.cA.fromInvProjectionMatrix(f.invProjMatrix,f.worldSize,U,!q),ee=v.getCurrentCascadeFrustum();return Y.intersectsPrecise(B.vertices,B.planes,j)===0||ee.intersectsPrecise(B.vertices,B.planes,j)===0}function pu(h){const{painter:n,source:l,layer:f,coords:v}=h;let w=h.defines;const E=n.context,M=n.renderPass==="shadow",D=n.renderPass==="light-beam",B=n.shadowRenderer,j=i.ee(n.transform.center.lat,n.transform.zoom),q=Qa(n,f.paint.get("building-cutoff-fade-range"));q.shouldRenderCutoff&&(w=w.concat("RENDER_CUTOFF")),h.floodLightIntensity>0&&(w=w.concat("FLOOD_LIGHT"));for(const U of v){const Y=l.getTile(U),ee=Y.getBucket(f);if(!ee)continue;B&&B.getMaxCascadeForTile(U.toUnwrapped())===0&&(w=w.concat("SHADOWS_SINGLE_CASCADE"));const re=ee.programConfigurations.get(f.id);let ce,ae,de,ye=n.translatePosMatrix(U.expandedProjMatrix,Y,[0,0],"map");if(ye=i.cR(i.bB(),ye,[1,1,h.verticalScale]),M&&B){if(Jh(Y.tileID,ee.maxHeight*j,n))continue;let Me=B.calculateShadowPassMatrixFromTile(Y.tileID.toUnwrapped());Me=i.cR(i.bB(),Me,[1,1,h.verticalScale]),de=vl(Me),ce=ae=n.getOrCreateProgram("buildingDepth",{config:re,defines:w,overrideFog:!1})}else if(D)ce=ae=n.getOrCreateProgram("buildingBloom",{config:re,defines:w,overrideFog:!1}),de=Ja(ye);else{const Me=n.transform.calculatePosMatrix(U.toUnwrapped(),n.transform.worldSize);i.cR(Me,Me,[1,1,h.verticalScale]);const xe=i.bB();i.cR(xe,Me,[1,-1,1/j]),i.bk(xe,xe),i.ef(xe,xe);const Ce=n.transform.getFreeCameraOptions().position,Te=1<<U.canonical.z;if(de=Jf(ye,xe,h.opacity,h.facadeAOIntensity,[((Ce.x-U.wrap)*Te-U.canonical.x)*i.al,(Ce.y*Te-U.canonical.y)*i.al,Ce.z*Te*i.al],ee.tileToMeter,h.facadeEmissiveChance,h.floodLightColor,h.floodLightIntensity),ae=n.getOrCreateProgram("building",{config:re,defines:w,overrideFog:!1}),h.depthOnly===!0)ce=ae;else{const be=w.concat(["BUILDING_FAUX_FACADE","HAS_ATTRIBUTE_a_faux_facade_color_emissive"]);ce=n.getOrCreateProgram("building",{config:re,defines:be,overrideFog:!1})}B&&(B.setupShadowsFromMatrix(Me,ae,!0),ce!==ae&&B.setupShadowsFromMatrix(Me,ce,!0))}const fe=(Me,xe)=>{if(D){const Ce=Me.entranceBloom;xe.draw(n,E.gl.TRIANGLES,h.depthMode,Nr.disabled,h.blendMode,Vr.disabled,de,f.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segmentsBucket,f.paint,n.transform.zoom,re,[Ce.layoutAttenuationBuffer,Ce.layoutColorBuffer])}else{const Ce=Me.segmentsBucket;let Te=[Me.layoutNormalBuffer,Me.layoutCentroidBuffer,Me.layoutColorBuffer,Me.layoutFloodLightDataBuffer];Me.layoutFacadePaintBuffer&&(Te=Te.concat([Me.layoutFacadeDataBuffer,Me.layoutFacadeVerticalRangeBuffer,Me.layoutFacadePaintBuffer])),xe.draw(n,E.gl.TRIANGLES,h.depthMode,Nr.disabled,h.blendMode,M?Vr.disabled:Vr.backCW,de,f.id,Me.layoutVertexBuffer,Me.indexBuffer,Ce,f.paint,n.transform.zoom,re,Te)}};n.uploadCommonUniforms(E,ae,U.toUnwrapped(),null,q),ee.buildingWithoutFacade&&fe(ee.buildingWithoutFacade,ae),ee.buildingWithFacade&&(ce!==ae&&n.uploadCommonUniforms(E,ce,U.toUnwrapped(),null,q),fe(ee.buildingWithFacade,ce))}}function ef(h,n,l,f,v,w,E,M,D,B,j,q,U){const Y=h.context.gl,ee=h.depthModeForSublayer(1,pr.ReadOnly,Y.LEQUAL,!0),re=.1*(1-(ce=j))+3*ce;var ce;const ae=h._showOverdrawInspector,de=q,ye=new em;ae||gc(ye,h,n,l,f,ee,new Nr({func:Y.ALWAYS,mask:255},255,255,Y.KEEP,Y.KEEP,Y.REPLACE),new en([Y.ONE,Y.ONE,Y.ONE,Y.ONE],i.ao.transparent,[!1,!1,!1,!0],Y.MIN),Vr.disabled,v,"sdf",w,E,M,D,B,re,de,!1);{const fe=ae?Nr.disabled:new Nr({func:Y.EQUAL,mask:255},255,255,Y.KEEP,Y.DECR,Y.DECR),Me=ae?h.colorModeForRenderPass():new en([Y.ONE_MINUS_DST_ALPHA,Y.DST_ALPHA,Y.ONE,Y.ONE],i.ao.transparent,[!0,!0,!0,!0]);gc(ye,h,n,l,f,ee,fe,Me,Vr.disabled,v,"color",w,E,M,D,B,re,de,!1)}}function yd(h){return[h[0]*i.eg,h[1]*i.eg,h[2]*i.eg,0]}function tm(h,n,l,f,v,w,E,M,D){const B=f.getSource(),j=l.globeSharedBuffers;if(!j)return;let q,U,Y;if(n&&(q=f.getTile(n)),B instanceof i.aT?(U=B.texture,Y=i.dJ(0,0,l.transform)):q&&n&&(U=q.texture,Y=i.dJ(n.canonical.z,n.canonical.x,l.transform)),!U||!Y)return;h||(Y=i.cR(i.bB(),Y,[1,-1,1]));const ee=l.context,re=ee.gl,ce=v.paint.get("raster-resampling")==="nearest"?re.NEAREST:re.LINEAR,ae=l.colorModeForDrapableLayerRenderPass(w),de=E.defines;de.push("GLOBE_POLES");const ye=new pr(re.LEQUAL,pr.ReadWrite,l.depthRangeFor3D),fe=Float32Array.from(l.transform.expandedFarZProjMatrix),Me=Float32Array.from(i.bj(i.dI(new i.cC(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),ee.activeTexture.set(re.TEXTURE0),U.bind(ce,re.CLAMP_TO_EDGE),ee.activeTexture.set(re.TEXTURE1),U.bind(ce,re.CLAMP_TO_EDGE),"useMipmap"in U&&ee.extTextureFilterAnisotropic&&l.transform.pitch>20&&re.texParameterf(re.TEXTURE_2D,ee.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ee.extTextureFilterAnisotropicMax);const[xe,Ce,Te,be]=n?j.getPoleBuffers(n.canonical.z,!1):j.getPoleBuffers(0,!0),De=v.paint.get("raster-elevation");let He;h?(He=xe,l.renderDefaultNorthPole=De!==0):(He=Ce,l.renderDefaultSouthPole=De!==0);const $e=yd(E.mix),st=((pt,Ft,Xe,je,dt,rt,Mt,$t,fr,kt,Nt,mr,lr)=>Yh(pt,Ft,Xe,new Float32Array(16),new Float32Array(9),[0,0],je,[0,0],[0,0,0,0],1,{opacity:1,mix:0},rt,[0,0],$t,2,kt,Nt,mr,1,0,lr))(fe,Me,Y,i.aj(l.transform.zoom),0,v,0,De,0,$e,E.offset,E.range,w),Qe=l.getOrCreateProgram("raster",{defines:de});l.uploadCommonUniforms(ee,Qe,null),Qe.draw(l,re.TRIANGLES,ye,D,ae,M,st,v.id,He,Te,be)}function rm(h){const n=h._nearZ,l=h.projection.farthestPixelDistance(h),f=l-n,v=.2*h.height,w=n+v;return[n,l,(w-v-n)/f,(w-n)/f]}function rs(h,n,l,f){if(h)return n instanceof uo&&h instanceof oa?n.getTextureDescriptor(h,l,!0):{texture:h.texture,mix:yd(f.mix),offset:f.offset,buffer:0,tileSize:1}}var nm=i.eh([{name:"a_index",type:"Int16",components:1}]);class Ua{constructor(n,l,f,v){const w={width:f[0],height:f[1],data:null},E=n.gl;this.targetColorTexture=new i.T(n,w,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(n,w,E.RGBA8,{useMipmap:!1}),this.context=n,this.updateParticleTexture(l,v),this.lastInvalidatedAt=0}updateParticleTexture(n,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const f=this.context.gl,v=l.width*l.height;this.particleTexture0=new i.T(this.context,l,f.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,l,f.RGBA8,{premultiply:!1,useMipmap:!1});const w=new i.ei;w.reserve(v);for(let E=0;E<v;E++)w.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(w,nm.members,!0),this.particleSegment=i.bf.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(n){return!(this.lastInvalidatedAt<n&&(this.lastInvalidatedAt=i.o.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function sp(h,n,l){if(!h)return null;const f=n.getTextureDescriptor(h,l,!0);if(!f)return null;let{texture:v,mix:w,offset:E,tileSize:M,buffer:D,format:B}=f;if(!v||!B)return null;let j=!1;return B==="uint32"&&(j=!0,w[3]=0,w=Hh(i.ej,w,[0,l.paint.get("raster-particle-max-speed")]),E=Vc(i.ej,E,[0,l.paint.get("raster-particle-max-speed")])),{texture:v,textureOffset:[D/(M+2*D),M/(M+2*D)],tileSize:M,scalarData:j,scale:w,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[B]]}}function Ys(h){const n=h._nearZ,l=h.projection.farthestPixelDistance(h),f=l-n,v=.2*h.height,w=n+v;return[n,l,(w-v-n)/f,(w-n)/f]}const mu=new i.ao(1,0,0,1),vd=new i.ao(0,1,0,1),$o=new i.ao(0,0,1,1),_s=new i.ao(1,0,1,1),zs=new i.ao(0,1,1,1);function tf(h,n,l,f,v,w){for(let E=0;E<l.length;E++)if(v){const B=new i.ao(f.r*.8,f.g*.8,f.b*.8,1);da(h,n,l[E],f,-1,-1,w),da(h,n,l[E],f,-1,1,w),da(h,n,l[E],f,1,1,w),da(h,n,l[E],f,1,-1,w),da(h,n,l[E],B,0,0,w)}else da(h,n,l[E],f,0,0,w)}function da(h,n,l,f,v,w,E){const M=h.context,D=h.transform,B=M.gl,j=D.projection.name==="globe",q=j?["PROJECTION_GLOBE_VIEW"]:[];let U=i.by(l.projMatrix);if(j&&i.aj(D.zoom)>0){const $e=i.bi(l.canonical,D),st=i.ek($e);U=i.aB(new Float32Array(16),D.globeMatrix,st),i.aB(U,D.projMatrix,U)}const Y=i.bB();Y[12]+=2*v/(i.o.devicePixelRatio*D.width),Y[13]+=2*w/(i.o.devicePixelRatio*D.height),i.aB(U,Y,U);const ee=h.getOrCreateProgram("debug",{defines:q}),re=n.getTileByID(l.key);h.terrain&&h.terrain.setupElevationDraw(re,ee);const ce=pr.disabled,ae=Nr.disabled,de=h.colorModeForRenderPass(),ye="$debug";M.activeTexture.set(B.TEXTURE0),h.emptyTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),j?re._makeGlobeTileDebugBuffers(h.context,D):re._makeDebugTileBoundsBuffers(h.context,D.projection);const fe=re._tileDebugBuffer||h.debugBuffer,Me=re._tileDebugIndexBuffer||h.debugIndexBuffer,xe=re._tileDebugSegments||h.debugSegments;if(ee.draw(h,B.LINE_STRIP,ce,ae,de,Vr.disabled,Ul(U,f.toPremultipliedRenderColor(null)),ye,fe,Me,xe,null,null,null,[re._globeTileDebugBorderBuffer]),E){const $e=re.latestRawTileData,st=Math.floor(($e&&$e.byteLength||0)/1024);let Qe=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Qe+=` => ${l.overscaledZ}`),Qe+=` ${re.state}`,Qe+=` ${st}kb`,(function(pt,Ft){pt.initDebugOverlayCanvas();const Xe=pt.debugOverlayCanvas,je=pt.context.gl,dt=pt.debugOverlayCanvas.getContext("2d");dt.clearRect(0,0,Xe.width,Xe.height),dt.shadowColor="white",dt.shadowBlur=2,dt.lineWidth=1.5,dt.strokeStyle="white",dt.textBaseline="top",dt.font="bold 36px Open Sans, sans-serif",dt.fillText(Ft,5,5),dt.strokeText(Ft,5,5),pt.debugOverlayTexture.update(Xe),pt.debugOverlayTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE)})(h,Qe)}const Ce=n.getTile(l).tileSize,Te=512/Math.min(Ce,512)*(l.overscaledZ/D.zoom)*.5,be=re._tileDebugTextBuffer||h.debugBuffer,De=re._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,He=re._tileDebugTextSegments||h.debugSegments;ee.draw(h,B.TRIANGLES,ce,ae,en.alphaBlended,Vr.disabled,Ul(U,i.ao.transparent.toPremultipliedRenderColor(null),Te),ye,be,De,He,null,null,null,[re._globeTileDebugTextBuffer])}function mi(h,n,l,f){ys(h,0,n+l/2,h.transform.width,l,f)}function ap(h,n,l,f){ys(h,n-l/2,0,l,h.transform.height,f)}function ys(h,n,l,f,v,w){const E=h.context,M=E.gl;M.enable(M.SCISSOR_TEST),M.scissor(n*i.o.devicePixelRatio,l*i.o.devicePixelRatio,f*i.o.devicePixelRatio,v*i.o.devicePixelRatio),E.clear({color:w}),M.disable(M.SCISSOR_TEST)}const im=i.eh([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:om}=im;function Uc(h,n,l,f){h.emplaceBack(n,l,f)}class yc{constructor(n){this.vertexArray=new i.el,this.indices=new i.b0,Uc(this.vertexArray,-1,-1,1),Uc(this.vertexArray,1,-1,1),Uc(this.vertexArray,-1,1,1),Uc(this.vertexArray,1,1,1),Uc(this.vertexArray,-1,-1,-1),Uc(this.vertexArray,1,-1,-1),Uc(this.vertexArray,-1,1,-1),Uc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,om),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=i.bf.simpleSegment(0,0,36,12)}}function ns(h,n,l,f,v,w){const E=h.context.gl,M=n.paint.get("sky-atmosphere-color"),D=n.paint.get("sky-atmosphere-halo-color"),B=n.paint.get("sky-atmosphere-sun-intensity"),j=((q,U,Y,ee,re)=>({u_matrix_3f:q,u_sun_direction:U,u_sun_intensity:Y,u_color_tint_r:[ee.r,ee.g,ee.b,ee.a],u_color_tint_m:[re.r,re.g,re.b,re.a],u_luminance:5e-5}))(i.en(i.dN(),f),v,B,M.toPremultipliedRenderColor(null),D.toPremultipliedRenderColor(null));E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+w,n.skyboxTexture,0),l.draw(h,E.TRIANGLES,pr.disabled,Nr.disabled,en.unblended,Vr.frontCW,j,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const $c=i.eh([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class zt{constructor(n){const l=new i.eo;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const f=new i.b0;f.emplaceBack(0,1,2),f.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(l,$c.members),this.indexBuffer=n.createIndexBuffer(f),this.segments=i.bf.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const tr=i.eh([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class th{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class to{constructor(n){this.colorModeAlphaBlendedWriteRGB=new en([1,Xi,1,Xi],i.ao.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new en([1,0,1,0],i.ao.transparent,[!1,!1,!1,!0]),this.params=new th,this.updateNeeded=!0,n.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),n.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),n.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),n.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(n){const l=n.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new zt(l);const f=this.params.sizeRange,v=this.params.intensityRange,w=(function(j){const q=i.eq(30),U=[];for(let Y=0;Y<j;++Y){const ee=2*Math.PI*q(),re=Math.acos(1-2*q())-.5*Math.PI;U.push(i.d4(Math.cos(re)*Math.cos(ee),Math.cos(re)*Math.sin(ee),Math.sin(re)))}return U})(this.params.starsCount),E=i.eq(300),M=new i.ep,D=new i.b0;let B=0;for(let j=0;j<w.length;++j){const q=i.c4([],w[j],200),U=Math.max(0,1+.01*f*(1*E()-.5)),Y=Math.max(0,1+.01*v*(1*E()-.5));M.emplaceBack(q[0],q[1],q[2],-1,-1,U,Y),M.emplaceBack(q[0],q[1],q[2],1,-1,U,Y),M.emplaceBack(q[0],q[1],q[2],1,1,U,Y),M.emplaceBack(q[0],q[1],q[2],-1,1,U,Y),D.emplaceBack(B+0,B+1,B+2),D.emplaceBack(B+0,B+2,B+3),B+=4}this.starsVx=l.createVertexBuffer(M,tr.members),this.starsIdx=l.createIndexBuffer(D),this.starsSegments=i.bf.simpleSegment(0,0,M.length,D.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(n,l){const f=n.context,v=f.gl,w=n.transform,E=new pr(v.LEQUAL,pr.ReadOnly,[0,1]),M=i.aj(w.zoom),D=n.style.getLut(l.scope),B=l.properties.get("color-use-theme")==="none",j=l.properties.get("color").toNonPremultipliedRenderColor(B?null:D),q=l.properties.get("high-color-use-theme")==="none",U=l.properties.get("high-color").toNonPremultipliedRenderColor(q?null:D),Y=l.properties.get("space-color-use-theme")==="none",ee=l.properties.get("space-color").toNonPremultipliedRenderColor(Y?null:D),re=5e-4,ce=i.er(l.properties.get("horizon-blend"),0,1,re,.25),ae=i.dD(n,f,w)&&ce===re?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,de=n.frameCounter/1e3%1,ye=i.ag(w.globeCenterInViewSpace),fe=Math.sqrt(Math.pow(ye,2)-Math.pow(ae,2)),Me=Math.acos(fe/ye),xe=Ce=>{const Te=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ce&&Te.push("ALPHA_PASS");const be=n.getOrCreateProgram("globeAtmosphere",{defines:Te}),De=(($e,st,Qe,pt,Ft,Xe,je,dt,rt,Mt,$t,fr)=>({u_frustum_tl:$e,u_frustum_tr:st,u_frustum_br:Qe,u_frustum_bl:pt,u_horizon:Ft,u_transition:Xe,u_fadeout_range:je,u_atmosphere_fog_color:dt.toArray01(),u_high_color:rt.toArray01(),u_space_color:Mt.toArray01(),u_temporal_offset:$t,u_horizon_angle:fr}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,M,ce,j,U,ee,de,Me);n.uploadCommonUniforms(f,be);const He=this.atmosphereBuffer;He&&be.draw(n,v.TRIANGLES,E,Nr.disabled,Ce?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Vr.backCW,De,Ce?"atmosphere_glow_alpha":"atmosphere_glow",He.vertexBuffer,He.indexBuffer,He.segments)};xe(!1),xe(!0)}drawStars(n,l){const f=i.aA(l.properties.get("star-intensity"),0,1);if(f===0)return;const v=n.context,w=v.gl,E=n.transform,M=n.getOrCreateProgram("stars"),D=i.c6([]);i.c8(D,D,-E._pitch),i.c7(D,D,-E.angle),i.c8(D,D,i.an(E._center.lat)),i.es(D,D,-i.an(E._center.lng));const B=i.cb(new Float32Array(16),D),j=i.aB([],E.starsProjMatrix,B),q=i.en([],B),U=i.et([],q),Y=[0,1,0];i.dP(Y,Y,U),i.c4(Y,Y,this.params.sizeMultiplier);const ee=[1,0,0];i.dP(ee,ee,U),i.c4(ee,ee,this.params.sizeMultiplier);const re=(ce=Y,ae=ee,de=f,{u_matrix:Float32Array.from(j),u_up:ce,u_right:ae,u_intensity_multiplier:de});var ce,ae,de;n.uploadCommonUniforms(v,M),this.starsVx&&this.starsIdx&&M.draw(n,w.TRIANGLES,pr.disabled,Nr.disabled,this.colorModeAlphaBlendedWriteRGB,Vr.disabled,re,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class Ye{constructor(){this.visibleTiles=[]}updateBorders(n,l){const f=[],v=[],w=n._getRenderableCoordinates(!1,!0);for(const D of w){const B=n.getTile(D);if(!B.hasData())continue;const j=B.getBucket(l);j&&(j.isEmpty()||(f.push(D.key),v.push({bucket:j,tileID:D.canonical})))}let E=f.length!==this.visibleTiles.length;if(!E){f.sort();for(let D=0;D<f.length;D++)if(f[D]!==this.visibleTiles[D]){E=!0;break}}if(!E)return;const M=new Set;this.visibleTiles=f,v.sort(((D,B)=>D.tileID.z-B.tileID.z||D.tileID.x-B.tileID.x||D.tileID.y-B.tileID.y));for(const D of v){const B=new Array,j=new Array,q=D.bucket;for(const U of q.featuresOnBorder)M.has(U.featureId)?j.push(U.footprintIndex):(M.add(U.featureId),B.push(U.footprintIndex));q.updateFootprintHiddenFlags(B,i.eu,!1),q.updateFootprintHiddenFlags(j,i.eu,!0)}}}function sm(h,n){const l=[...h],f=n.cameraWorldSizeForFog/n.worldSize,v=i.bz([]);return i.cR(v,v,[f,f,1]),i.aB(l,v,l),i.aB(l,n.worldToFogMatrix,l),l}function rh(h,n,l,f,v){const w=l.material,E=f.context,{baseColorTexture:M,metallicRoughnessTexture:D}=w.pbrMetallicRoughness,{normalTexture:B,occlusionTexture:j,emissionTexture:q}=w;function U(ee,re,ce){if(ee&&(h.push(re),E.activeTexture.set(E.gl.TEXTURE0+ce),ee.gfxTexture)){const{minFilter:ae,magFilter:de,wrapS:ye,wrapT:fe}=ee.sampler;ee.gfxTexture.bindExtraParam(ae,de,ye,fe)}}U(M,"HAS_TEXTURE_u_baseColorTexture",Eo.BaseColor),U(D,"HAS_TEXTURE_u_metallicRoughnessTexture",Eo.MetallicRoughness),U(B,"HAS_TEXTURE_u_normalTexture",Eo.Normal),U(j,"HAS_TEXTURE_u_occlusionTexture",Eo.Occlusion),U(q,"HAS_TEXTURE_u_emissionTexture",Eo.Emission),v&&(v.texture||(v.texture=new i.d_(f.context,v.image,[v.image.height,v.image.height,v.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+Eo.LUT),v.texture&&v.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),h.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(h.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(l.texcoordBuffer)),l.colorBuffer&&(h.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(l.colorBuffer)),l.normalBuffer&&(h.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(l.normalBuffer)),l.pbrBuffer&&(h.push("HAS_ATTRIBUTE_a_pbr"),h.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(l.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||h.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||h.push("DIFFUSE_SHADED");const Y=f.shadowRenderer;Y&&(h.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Y.useNormalOffset&&h.push("NORMAL_OFFSET"))}function nh(h,n,l,f,v,w){const E=l.paint.get("model-opacity").constantOr(1),M=n.context,D=new pr(n.context.gl.LEQUAL,h.isLightMesh?pr.ReadOnly:pr.ReadWrite,n.depthRangeFor3D),B=n.transform,j=h.mesh,q=j.material,U=q.pbrMetallicRoughness,Y=n.style.fog;let ee;ee=n.transform.projection.zAxisUnit==="pixels"?[...h.nodeModelMatrix]:i.aB([],f.zScaleMatrix,h.nodeModelMatrix),i.aB(ee,f.negCameraPosMatrix,ee);const re=i.bk([],ee);i.ef(re,re);const ce=l.paint.get("model-color-use-theme").constantOr("default")==="none",ae=l.paint.get("model-emissive-strength").constantOr(0),de=np(new Float32Array(h.worldViewProjection),new Float32Array(ee),new Float32Array(re),null,n,E,U.baseColorFactor,q.emissiveFactor,U.metallicFactor,U.roughnessFactor,q,ae,l,void 0,void 0,h.materialOverride,h.modelColor),ye={defines:[]},fe=[],Me=n.shadowRenderer;Me&&(Me.useNormalOffset=!1),rh(ye.defines,fe,j,n,ce?null:l.lut);let xe=null;if(Y){const be=sm(h.nodeModelMatrix,n.transform);if(xe=new Float32Array(be),B.projection.name!=="globe"){const De=j.aabb.min,He=j.aabb.max,[$e,st]=Y.getOpacityForBounds(be,De[0],De[1],He[0],He[1]);ye.overrideFog=$e>=Je||st>=Je}}const Ce=Qa(n,l.paint.get("model-cutoff-fade-range"));Ce.shouldRenderCutoff&&ye.defines.push("RENDER_CUTOFF");const Te=n.getOrCreateProgram("model",ye);n.uploadCommonUniforms(M,Te,null,xe,Ce),n.renderPass!=="shadow"&&Me&&Me.setupShadowsFromMatrix(h.nodeModelMatrix,Te),Te.draw(n,M.gl.TRIANGLES,D,v,w,j.material.doubleSided?Vr.disabled:Vr.backCCW,de,l.id,j.vertexBuffer,j.indexBuffer,j.segments,l.paint,n.transform.zoom,void 0,fe)}function lp(h,n,l){return h.type==="vector"?n.scope:l?"basemap":""}function cp(h,n,l,f,v,w,E,M,D){const B=h.transform,j=!!n.isGeometryBloom&&n.isGeometryBloom;if(j&&h.renderPass==="shadow")return;const q=B.projection.name==="globe"?i.eC(l,B):[...l];i.aB(q,q,n.globalMatrix);const U=i.aB([],f,q);if(n.meshes)for(const Y of n.meshes){const ee=M.get(Y.material.name);if(ee&&ee.opacity<=0)continue;if(Y.material.alphaMode!=="BLEND"){E.push({mesh:Y,depth:0,modelIndex:v,worldViewProjection:U,nodeModelMatrix:q,isLightMesh:j,materialOverride:ee,modelColor:D});continue}const re=i.af([],Y.centroid,U);!B.isOrthographic&&re[2]<=0||w.push({mesh:Y,depth:re[2],modelIndex:v,worldViewProjection:U,nodeModelMatrix:q,isLightMesh:j,materialOverride:ee,modelColor:D})}if(n.children)for(const Y of n.children)cp(h,Y,l,f,v,w,E,M,D)}function gu(h,n,l,f){const v=l.shadowRenderer;if(!v)return;const w=v.getShadowPassDepthMode(),E=v.getShadowPassColorMode(),M=v.calculateShadowPassMatrixFromMatrix(n),D=Nu(M);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,w,Nr.disabled,E,Vr.disabled,D,f.id,h.vertexBuffer,h.indexBuffer,h.segments,f.paint,l.transform.zoom,void 0,void 0)}function ih(h,n,l,f,v,w){for(const E of v){const M=Object.assign({},f);M.part=E;const D={type:"Unknown",id:n,properties:M},B={orientation:h.paint.get("model-rotation").evaluate(D,l)};w.set(E,B)}}function am(h,n,l,f,v,w){for(const E of v){const M=Object.assign({},f);M.part=E;const D={type:"Unknown",id:n,properties:M},B={color:h.paint.get("model-color").evaluate(D,l),colorMix:h.paint.get("model-color-mix-intensity").evaluate(D,l),opacity:h.paint.get("model-opacity").evaluate(D,l),emissionStrength:h.paint.get("model-emissive-strength").evaluate(D,l)};w.set(E,B)}}function up(h,n,l,f,v,w){if(l===1)for(const M of v)nh(M,h,n,w[M.modelIndex],Nr.disabled,h.colorModeForRenderPass());else{for(const M of v)nh(M,h,n,w[M.modelIndex],Nr.disabled,en.disabled);for(const M of v)nh(M,h,n,w[M.modelIndex],h.stencilModeFor3D(),h.colorModeForRenderPass());h.resetStencilClippingMasks()}const E=en.additive;for(const M of f)nh(M,h,n,w[M.modelIndex],Nr.disabled,M.isLightMesh?E:h.colorModeForRenderPass())}function cg(h,n,l){const f=n.updateZoomBasedPaintProperties(),v=(function(w,E,M){let D,B,j,q=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&q>0){const U=w.terrain,Y=U.findDEMTileFor(M);Y&&Y.dem?D=i.eE.create(U,M,Y):q=0}if(q===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),q===E.validForExaggeration&&(q===0||D&&D._demTile&&D._demTile.tileID===E.validForDEMTile.id&&D._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const U in E.instancesPerModel){const Y=E.instancesPerModel[U];for(let ee=0;ee<Y.instancedDataArray.length;++ee){const re=(D?q*D.getElevationAt(0|Y.instancedDataArray.float32[16*ee],0|Y.instancedDataArray.float32[16*ee+1],!0,!0):0)+Y.instancesEvaluatedElevation[ee];Y.instancedDataArray.float32[16*ee+6]=re,B=B?Math.min(E.terrainElevationMin,re):re,j=j?Math.max(E.terrainElevationMax,re):re}}return E.terrainElevationMin=B||0,E.terrainElevationMax=j||0,E.validForExaggeration=q,E.validForDEMTile=D&&D._demTile?{id:D._demTile.tileID,timestamp:D._dem._timestamp}:{id:void 0,timestamp:0},!0})(h,n,l);(f||v)&&(n.uploaded=!1,n.upload(h.context))}const rl={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.d8([0,0,0],[i.al,i.al,0])};function lm(h,n){const l=1<<h.canonical.z,f=n.getFreeCameraOptions().position,v=n.elevation,w=h.canonical.x/l,E=(h.canonical.x+1)/l,M=h.canonical.y/l,D=(h.canonical.y+1)/l;let B=n._centerAltitude;if(v){const Y=v.getMinMaxForTile(h);Y&&Y.max>B&&(B=Y.max)}const j=i.aA(f.x,w,E)-f.x,q=i.aA(f.y,M,D)-f.y,U=i.ce(B,n.center.lat)-f.z;return n._zoomFromMercatorZ(Math.sqrt(j*j+q*q+U*U))}function cm(h,n,l,f,v,w,E){const M=h.context,D=h.renderPass==="shadow",B=h.shadowRenderer,j=D&&B?B.getShadowPassDepthMode():new pr(M.gl.LEQUAL,pr.ReadWrite,h.depthRangeFor3D),q=h.isTileAffectedByFog(w),U=h.transform.projection.name==="globe";if(l.meshes)for(const Y of l.meshes){const ee=U?[]:["MODEL_POSITION_ON_GPU"],re=[];let ce,ae,de;const ye=!U&&f.instancedDataArray.length>20;ye&&ee.push("INSTANCED_ARRAYS");const fe=Qa(h,n.paint.get("model-cutoff-fade-range"));if(fe.shouldRenderCutoff&&ee.push("RENDER_CUTOFF"),D&&B)ce=h.getOrCreateProgram("modelDepth",{defines:ee}),ae=Nu(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(l.globalMatrix)),de=B.getShadowPassColorMode();else{rh(ee,re,Y,h,n.paint.get("model-color-use-theme").constantOr("default")==="none"?null:n.lut),ce=h.getOrCreateProgram("model",{defines:ee,overrideFog:q});const xe=Y.material,Ce=xe.pbrMetallicRoughness,Te=n.paint.get("model-opacity").constantOr(1),be=n.paint.get("model-emissive-strength").constantOr(0);ae=np(w.expandedProjMatrix,Float32Array.from(l.globalMatrix),new Float32Array(16),null,h,Te,Ce.baseColorFactor,xe.emissiveFactor,Ce.metallicFactor,Ce.roughnessFactor,xe,be,n,v),B&&(E.shadowUniformsInitialized?ce.setShadowUniformValues(M,B.getShadowUniformValues()):(B.setupShadows(w.toUnwrapped(),ce,"model-tile"),E.shadowUniformsInitialized=!0)),de=fe.shouldRenderCutoff||Te<1||xe.alphaMode!=="OPAQUE"?en.alphaBlended:en.unblended}h.uploadCommonUniforms(M,ce,w.toUnwrapped(),null,fe);const Me=Y.material.doubleSided?Vr.disabled:Vr.backCCW;if(ye)re.push(f.instancedDataBuffer),ce.draw(h,M.gl.TRIANGLES,j,Nr.disabled,de,Me,ae,n.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,n.paint,h.transform.zoom,void 0,re,f.instancedDataArray.length);else{const xe=D?"u_instance":"u_normal_matrix";for(let Ce=0;Ce<f.instancedDataArray.length;++Ce)ae[xe]=new Float32Array(f.instancedDataArray.arrayBuffer,64*Ce,16),ce.draw(h,M.gl.TRIANGLES,j,Nr.disabled,de,Me,ae,n.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,n.paint,h.transform.zoom,void 0,re)}}if(l.children)for(const Y of l.children)cm(h,n,Y,f,v,w,E)}const ug=[1,-1,1];function dp(h,n,l,f){if(!l.modelManager)return!0;const v=l.modelManager;if(!l.shadowRenderer)return!0;const w=l.shadowRenderer,E=n.aabb;let M=!0,D=h.maxHeight;if(D===0){let j=0;for(const q in h.instancesPerModel){const U=v.getModel(q,f);U?j=Math.max(j,Math.max(Math.max(U.aabb.max[0],U.aabb.max[1]),U.aabb.max[2])):M=!1}D=h.maxScale*j*1.41+h.maxVerticalOffset,M&&(h.maxHeight=D)}E.max[2]=D,E.min[2]+=h.terrainElevationMin,E.max[2]+=h.terrainElevationMax,i.af(E.min,E.min,n.tileMatrix),i.af(E.max,E.max,n.tileMatrix);const B=E.intersects(w.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(h.isInsideFirstShadowMapFrustum=B===2),B===0}function oh(h,n){const l=h.uniformValues.u_cutoff_params[0],f=h.uniformValues.u_cutoff_params[1],v=h.uniformValues.u_cutoff_params[2],w=h.uniformValues.u_cutoff_params[3];return f===l||w===v?1:i.aA(((n-l)/(f-l)-v)/(w-v),0,1)}function xd(h,n,l,f){if(n.pitch<20)return 1;const v=n.getWorldToCameraMatrix();i.aB(v,v,h);const w=i.bT(l.min[0],l.min[1],l.min[2],1);let E=i.aC(i.eF(),w,v),M=E,D=E;w[1]=l.max[1],E=i.aC(i.eF(),w,v),M=E[1]<M[1]?E:M,D=E[1]>D[1]?E:D,w[0]=l.max[0],E=i.aC(i.eF(),w,v),M=E[1]<M[1]?E:M,D=E[1]>D[1]?E:D,w[1]=l.min[1],E=i.aC(i.eF(),w,v),M=E[1]<M[1]?E:M,D=E[1]>D[1]?E:D;const B=i.aA(f[0],0,1),j=100*n.pixelsPerMeter*i.aA(f[1],0,1),q=i.aA(f[2],0,1),U=i.eG(i.eF(),M,D,B),Y=Math.tan(.5*n.fovX),ee=-U[2]*Y;if(j===0)return U[1]<-Math.abs(ee)?q:1;const re=(-Math.abs(ee)-U[1])/j,ce=(de,ye,fe)=>(1-fe)*de+fe*ye,ae=i.aA(ce(1,q,re),q,1);return ce(1,ae,i.aA((n.pitch-20)/20,0,1))}class dg{}class hg{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(n,l,f){{const q=this._storage.get(l.id);if(q)return q.lastUsedFrameIdx=n,q.buf}const v=f.gl,w=v.getBufferParameter(v.ELEMENT_ARRAY_BUFFER,v.BUFFER_SIZE),E=new ArrayBuffer(w),M=new Int16Array(E);v.getBufferSubData(v.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const D=new i.eI;for(let q=0;q<w/2;q+=3){const U=M[q],Y=M[q+1],ee=M[q+2];D.emplaceBack(U,Y),D.emplaceBack(Y,ee),D.emplaceBack(ee,U)}const B=f.bindVertexArrayOES.current,j=new dg;return j.buf=new Wl(f,D),j.lastUsedFrameIdx=n,this._storage.set(l.id,j),f.bindVertexArrayOES.set(B),j.buf}update(n){for(const[l,f]of this._storage)n-f.lastUsedFrameIdx>30&&(f.buf.destroy(),this._storage.delete(l))}destroy(){for(const[n,l]of this._storage)l.buf.destroy(),this._storage.delete(n)}}class sv{constructor(n){this.occluderSize=30,this.depthOffset=-1e-4,n.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),n.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const fg=i.eh([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class av{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Ia{constructor(n,l){this.revealStart=11,this.revealRange=2,n.registerParameter(this,[...l,"Reveal"],"revealStart",{min:0,max:17,step:.05}),n.registerParameter(this,[...l,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const I_=i.eh([{type:"Float32",name:"a_pos_2f",components:2}]);class rf{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(n,l){const f=n.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const E=new i.eJ,M=new i.b0;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(1,1),E.emplaceBack(-1,1),M.emplaceBack(0,1,2),M.emplaceBack(0,2,3),this.vignetteVx=n.context.createVertexBuffer(E,I_.members),this.vignetteIdx=n.context.createIndexBuffer(M)}const v=i.bf.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){n.uploadCommonUniforms(n.context,f);const E={u_vignetteShape:(w={vignetteShape:[l.start,l.range,Math.pow(10,l.fadePower)],vignetteColor:[l.color.r,l.color.g,l.color.b,l.color.a*l.strength]}).vignetteShape,u_vignetteColor:w.vignetteColor};f.draw(n,n.context.gl.TRIANGLES,pr.disabled,Nr.disabled,en.alphaBlended,Vr.disabled,E,"vignette",this.vignetteVx,this.vignetteIdx,v)}var w}}class Ci{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(n,l){const f=n.getFreeCameraOptions().position,v=f.toAltitude(),w=f.toLngLat(),E=i.an(w.lng),M=i.an(w.lat),D=n.pixelsPerMeter/l,B=E*i.eL,j=i.eL*Math.log(Math.tan(Math.PI/4+M/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const q=-this._offsetYPrev+j,U=-this._elevationPrev+v;this._accumulatedOffsetX+=(-this._offsetXPrev+B)*D,this._accumulatedOffsetY+=q*D,this._accumulatedElevation+=U*D,this._offsetXPrev=B,this._offsetYPrev=j,this._elevationPrev=v}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function pn(h,n){return[-(h[0]-Math.floor(h[0]/n)*n),-(h[1]-Math.floor(h[1]/n)*n),-(h[2]-Math.floor(h[2]/n)*n)]}function pg(h){const n=i.eq(1323123451230),l=[];for(let f=0;f<h;++f){const v=2*n()-1,w=2*n()-1,E=2*n()-1;l.push(i.d4(v,w,E))}return l}function nl(h,n,l,f,v){const w=i.aA((v-l)/(f-l),0,1);return(1-w)*h+w*n}class sh{constructor(n){this._movement=new Ci,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new rf,this._ppmScaleFactor=n}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(n,l){const f=n.transform;this._movement.update(f,this._ppmScaleFactor);const v=f.starsProjMatrix,w=i.c6([]);i.c8(w,w,i.an(90)-f._pitch),i.c7(w,w,-f.angle);const E=i.cb(new Float32Array(16),w),M=i.eK(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),D=i.ef([],M),B=i.aB([],D,E),j=Date.now()/1e3;return this._accumulatedTimeFromStart+=(j-this._prevTime)*l,this._prevTime=j,{projectionMatrix:v,modelviewMatrix:B}}}class $a extends sh{constructor(n){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Ia(n.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(n){const l=n.context;if(!this.particlesVx){const f=pg(this.particlesCount),v=new i.eM,w=new i.b0;let E=0;const M=i.eq(1323123451230);for(let D=0;D<f.length;++D){const B=f[D],j=[2*M()-1,M(),M(),M()];v.emplaceBack(B[0],B[1],B[2],-1,-1,...j),v.emplaceBack(B[0],B[1],B[2],1,-1,...j),v.emplaceBack(B[0],B[1],B[2],1,1,...j),v.emplaceBack(B[0],B[1],B[2],-1,1,...j),w.emplaceBack(E+0,E+1,E+2),w.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=l.createVertexBuffer(v,fg.members),this.particlesIdx=l.createIndexBuffer(w)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.rain)return;const l=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},f=n.transform.zoom;if(l.revealStart>f)return;const v=nl(0,1,l.revealStart,l.revealStart+l.revealRange,f);if(!this.particlesVx||!this.particlesIdx)return;const w=structuredClone(this._params);let E=[-w.direction.x,w.direction.y,-100];i.aw(E,E);const M=structuredClone(this._vignetteParams);M.strength*=v,w.overrideStyleParameters||(w.intensity=n.style.rain.state.density,w.timeFactor=n.style.rain.state.intensity,w.color=structuredClone(n.style.rain.state.color),E=structuredClone(n.style.rain.state.direction),w.screenThinning.intensity=n.style.rain.state.centerThinning,w.dropletSizeX=n.style.rain.state.dropletSize[0],w.dropletSizeYScale=n.style.rain.state.dropletSize[1]/n.style.rain.state.dropletSize[0],w.distortionStrength=100*n.style.rain.state.distortionStrength,M.strength=1,M.color=structuredClone(n.style.rain.state.vignetteColor));const D=this.updateOnRender(n,w.timeFactor),B=n.context,j=B.gl,q=n.transform;this.screenTexture&&this.screenTexture.size[0]===n.width&&this.screenTexture.size[1]===n.height||(this.screenTexture=new i.T(B,{width:n.width,height:n.height,data:null},j.RGBA8)),w.distortionStrength>0&&(B.activeTexture.set(j.TEXTURE0),this.screenTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),j.copyTexSubImage2D(j.TEXTURE_2D,0,0,0,0,0,n.width,n.height));const U=n.getOrCreateProgram("rainParticle");n.uploadCommonUniforms(B,U),B.activeTexture.set(j.TEXTURE0),this.screenTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Y=[w.color.r,w.color.g,w.color.b,w.color.a],ee=(re,ce)=>{const ae=pn(this._movement.getPosition(),re),de=w.dropletSizeX,ye=w.dropletSizeX*w.dropletSizeYScale,fe=n.width/2,Me=n.height/2,xe=nl(0,w.screenThinning.start,0,1,w.screenThinning.intensity),Ce=nl(.001,w.screenThinning.range,0,1,w.screenThinning.intensity),Te=nl(0,w.screenThinning.particleOffset,0,1,w.screenThinning.intensity),be=(De={modelview:D.modelviewMatrix,projection:D.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ae,velocityConeAperture:w.velocityConeAperture,velocity:w.velocity,boxSize:re,rainDropletSize:[de,ye],distortionStrength:w.distortionStrength,rainDirection:E,color:Y,screenSize:[q.width,q.height],thinningCenterPos:[fe,Me],thinningShape:[xe,Ce,Math.pow(10,w.screenThinning.fadePower)],thinningAffectedRatio:w.screenThinning.affectedRatio,thinningParticleOffset:Te,shapeDirectionalPower:w.shapeDirPower,shapeNormalPower:w.shapeNormalPower,mode:ce?0:1},{u_modelview:Float32Array.from(De.modelview),u_projection:Float32Array.from(De.projection),u_time:De.time,u_cam_pos:De.camPos,u_texScreen:0,u_velocityConeAperture:De.velocityConeAperture,u_velocity:De.velocity,u_boxSize:De.boxSize,u_rainDropletSize:De.rainDropletSize,u_distortionStrength:De.distortionStrength,u_rainDirection:De.rainDirection,u_color:De.color,u_screenSize:De.screenSize,u_thinningCenterPos:De.thinningCenterPos,u_thinningShape:De.thinningShape,u_thinningAffectedRatio:De.thinningAffectedRatio,u_thinningParticleOffset:De.thinningParticleOffset,u_shapeDirectionalPower:De.shapeDirectionalPower,u_shapeNormalPower:De.shapeNormalPower,u_mode:De.mode});var De;const He=Math.round(w.intensity*this.particlesCount),$e=i.bf.simpleSegment(0,0,4*He,2*He);U.draw(n,j.TRIANGLES,pr.disabled,Nr.disabled,en.alphaBlended,Vr.disabled,be,"rain_particles",this.particlesVx,this.particlesIdx,$e)};w.distortionStrength>0&&ee(w.boxSize,!0),ee(w.boxSize,!1),this._vignette.draw(n,M)}}const Wc=i.eh([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class nf extends sh{constructor(n){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Ia(n.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(n){const l=n.context;if(!this.particlesVx){const f=pg(this.particlesCount),v=new i.eN,w=new i.b0;let E=0;const M=i.eq(1323123451230);for(let D=0;D<f.length;++D){const B=f[D],j=M(),q=M(),U=M(),Y=[D/f.length,j,q,U],ee=[M(),M()];v.emplaceBack(B[0],B[1],B[2],-1,-1,...Y,...ee),v.emplaceBack(B[0],B[1],B[2],1,-1,...Y,...ee),v.emplaceBack(B[0],B[1],B[2],1,1,...Y,...ee),v.emplaceBack(B[0],B[1],B[2],-1,1,...Y,...ee),w.emplaceBack(E+0,E+1,E+2),w.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=l.createVertexBuffer(v,Wc.members),this.particlesIdx=l.createIndexBuffer(w)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.snow)return;const l=structuredClone(this._params);let f=[-l.direction.x,l.direction.y,-100];i.aw(f,f);const v=structuredClone(this._vignetteParams),w=l.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},E=n.transform.zoom;if(w.revealStart>E)return;const M=nl(0,1,w.revealStart,w.revealStart+w.revealRange,E);v.strength*=M,l.overrideStyleParameters||(l.intensity=n.style.snow.state.density,l.timeFactor=n.style.snow.state.intensity,l.color=structuredClone(n.style.snow.state.color),f=structuredClone(n.style.snow.state.direction),l.screenThinning.intensity=n.style.snow.state.centerThinning,l.billboardSize=2.79*n.style.snow.state.flakeSize,v.strength=1,v.color=structuredClone(n.style.snow.state.vignetteColor));const D=this.updateOnRender(n,l.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const B=n.context,j=B.gl,q=n.transform,U=n.getOrCreateProgram("snowParticle");n.uploadCommonUniforms(B,U),((Y,ee,re)=>{const ce=pn(this._movement.getPosition(),Y),ae=q.width/2,de=q.height/2,ye=nl(0,re.screenThinning.start,0,1,re.screenThinning.intensity),fe=nl(.001,re.screenThinning.range,0,1,re.screenThinning.intensity),Me=nl(0,re.screenThinning.particleOffset,0,1,re.screenThinning.intensity),xe=(Ce={modelview:D.modelviewMatrix,projection:D.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ce,velocityConeAperture:re.velocityConeAperture,velocity:re.velocity,horizontalOscillationRadius:re.horizontalOscillationRadius,horizontalOscillationRate:re.horizontalOscillationRate,boxSize:Y,billboardSize:1*re.billboardSize,simpleShapeParameters:[re.shapeFadeStart,re.shapeFadePower],screenSize:[q.width,q.height],thinningCenterPos:[ae,de],thinningShape:[ye,fe,Math.pow(10,re.screenThinning.fadePower)],thinningAffectedRatio:re.screenThinning.affectedRatio,thinningParticleOffset:Me,color:[re.color.r,re.color.g,re.color.b,re.color.a],direction:f},{u_modelview:Float32Array.from(Ce.modelview),u_projection:Float32Array.from(Ce.projection),u_time:Ce.time,u_cam_pos:Ce.camPos,u_velocityConeAperture:Ce.velocityConeAperture,u_velocity:Ce.velocity,u_horizontalOscillationRadius:Ce.horizontalOscillationRadius,u_horizontalOscillationRate:Ce.horizontalOscillationRate,u_boxSize:Ce.boxSize,u_billboardSize:Ce.billboardSize,u_simpleShapeParameters:Ce.simpleShapeParameters,u_screenSize:Ce.screenSize,u_thinningCenterPos:Ce.thinningCenterPos,u_thinningShape:Ce.thinningShape,u_thinningAffectedRatio:Ce.thinningAffectedRatio,u_thinningParticleOffset:Ce.thinningParticleOffset,u_particleColor:Ce.color,u_direction:Ce.direction});var Ce;const Te=Math.round(re.intensity*this.particlesCount),be=i.bf.simpleSegment(0,0,4*Te,2*Te);this.particlesVx&&this.particlesIdx&&U.draw(n,j.TRIANGLES,pr.disabled,Nr.disabled,en.alphaBlended,Vr.disabled,xe,"snow_particles",this.particlesVx,this.particlesIdx,be)})(l.boxSize,0,l),this._vignette.draw(n,v)}}const um={symbol:function(h,n,l,f,v){if(h.renderPass!=="translucent")return;const w=Nr.disabled,E=h.colorModeForRenderPass(),M=l.layout.get("text-variable-anchor"),D=l.layout.get("text-size-scale-range"),B=i.aA(h.scaleFactor,D[0],D[1]);M&&(function(U,Y,ee,re,ce,ae,de,ye){const fe=Y.transform,Me=ce==="map",xe=ae==="map";for(const Ce of U){const Te=re.getTile(Ce),be=Te.getBucket(ee);if(!be||!be.text||!be.text.segments.get().length)continue;const De=i.bJ(be.textSizeData,fe.zoom,ye),He=Ui(Ce,be.getProjection(),fe),$e=fe.calculatePixelsToTileUnitsMatrix(Te),st=qs(He,Te.tileID.canonical,xe,Me,fe,be.getProjection(),$e),Qe=be.hasIconTextFit()&&be.hasIconData();De&&pc(be,Me,xe,de,fe,st,Ce,Math.pow(2,fe.zoom-Te.tileID.overscaledZ),De,Qe)}})(f,h,l,n,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),v,B);const j=l.paint.get("icon-opacity").constantOr(1)!==0,q=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(j||q)?mc(h,n,l,f,w,E):(j&&mc(h,n,l,f,w,E,{onlyIcons:!0}),q&&mc(h,n,l,f,w,E,{onlyText:!0})),n.map.showCollisionBoxes&&(Va(h,n,l,f,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Va(h,n,l,f,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(h,n,l,f){if(h.renderPass!=="translucent")return;const v=l.paint.get("circle-opacity"),w=l.paint.get("circle-stroke-width"),E=l.paint.get("circle-stroke-opacity"),M=l.layout.get("circle-sort-key").constantOr(1)!==void 0,D=l.paint.get("circle-emissive-strength");if(v.constantOr(1)===0&&(w.constantOr(1)===0||E.constantOr(1)===0))return;const B=h.context,j=B.gl,q=h.transform,U=!(!h.terrain||!h.terrain.enabled),Y=l.layout.get("circle-elevation-reference"),ee=h.depthModeForSublayer(0,pr.ReadOnly),re=new pr(h.context.gl.LEQUAL,pr.ReadOnly,h.depthRangeFor3D),ce=Y==="none"||U?ee:re,ae=Nr.disabled,de=h.colorModeForDrapableLayerRenderPass(D),ye=q.projection.name==="globe",fe=[i.aF(q.center.lng),i.aJ(q.center.lat)],Me=[];for(let Ce=0;Ce<f.length;Ce++){const Te=f[Ce],be=n.getTile(Te),De=be.getBucket(l);if(!De||De.projection.name!==q.projection.name)continue;const He=De.programConfigurations.get(l.id),$e=De.layoutVertexBuffer,st=De.globeExtVertexBuffer,Qe=De.indexBuffer,pt=i.d$(l),Ft=[st],Xe=h.isTileAffectedByFog(Te);ye&&pt.push("PROJECTION_GLOBE_VIEW"),pt.push("DEPTH_D24"),h.terrain&&q.depthOcclusionForSymbolsAndCircles&&pt.push("DEPTH_OCCLUSION"),De.hasElevation&&!h.terrain&&(pt.push("ELEVATED_ROADS"),Ft.push(De.elevatedLayoutVertexBuffer));const je=h.getOrCreateProgram("circle",{config:He,defines:pt,overrideFog:Xe}),dt=q.projection.createInversionMatrix(q,Te.canonical),rt={programConfiguration:He,program:je,layoutVertexBuffer:$e,dynamicBuffers:Ft,indexBuffer:Qe,uniformValues:i.e0(h,Te,be,dt,fe,l),tile:be};if(M){const Mt=De.segments.get();for(const $t of Mt)Me.push({segments:new i.bf([$t]),sortKey:$t.sortKey,state:rt})}else Me.push({segments:De.segments,sortKey:0,state:rt})}M&&Me.sort(((Ce,Te)=>Ce.sortKey-Te.sortKey));const xe={useDepthForOcclusion:q.depthOcclusionForSymbolsAndCircles};for(const Ce of Me){const{programConfiguration:Te,program:be,layoutVertexBuffer:De,dynamicBuffers:He,indexBuffer:$e,uniformValues:st,tile:Qe}=Ce.state,pt=Ce.segments;h.terrain&&h.terrain.setupElevationDraw(Qe,be,xe),h.uploadCommonUniforms(B,be,Qe.tileID.toUnwrapped()),be.draw(h,j.TRIANGLES,ce,ae,de,Vr.disabled,st,l.id,De,$e,pt,l.paint,q.zoom,Te,He)}},heatmap:function(h,n,l,f){if(l.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const v=h.context,w=v.gl,E=Nr.disabled,M=new en([w.ONE,w.ONE,w.ONE,w.ONE],i.ao.transparent,[!0,!0,!0,!0]);(function(Y,ee,re,ce){const ae=Y.gl,de=ee.width*ce,ye=ee.height*ce;Y.activeTexture.set(ae.TEXTURE1),Y.viewport.set([0,0,de,ye]);let fe=re.heatmapFbo;if(!fe||fe&&(fe.width!==de||fe.height!==ye)){fe&&fe.destroy();const Me=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,Me),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),fe=re.heatmapFbo=Y.createFramebuffer(de,ye,!0,null),(function(xe,Ce,Te,be,De,He){const $e=xe.gl;$e.texImage2D($e.TEXTURE_2D,0,xe.extRenderToTextureHalfFloat?$e.RGBA16F:$e.RGBA,De,He,0,$e.RGBA,xe.extRenderToTextureHalfFloat?$e.HALF_FLOAT:$e.UNSIGNED_BYTE,null),be.colorAttachment.set(Te)})(Y,0,Me,fe,de,ye)}else ae.bindTexture(ae.TEXTURE_2D,fe.colorAttachment.get()),Y.bindFramebuffer.set(fe.framebuffer)})(v,h,l,h.transform.projection.name==="globe"?.5:.25),v.clear({color:i.ao.transparent});const D=h.transform,B=D.projection.name==="globe",j=B?["PROJECTION_GLOBE_VIEW"]:[],q=B?Vr.frontCCW:Vr.disabled,U=[i.aF(D.center.lng),i.aJ(D.center.lat)];for(let Y=0;Y<f.length;Y++){const ee=f[Y];if(n.hasRenderableParent(ee))continue;const re=n.getTile(ee),ce=re.getBucket(l);if(!ce||ce.projection.name!==D.projection.name)continue;const ae=h.isTileAffectedByFog(ee),de=ce.programConfigurations.get(l.id),ye=h.getOrCreateProgram("heatmap",{config:de,defines:j,overrideFog:ae}),{zoom:fe}=h.transform;h.terrain&&h.terrain.setupElevationDraw(re,ye),h.uploadCommonUniforms(v,ye,ee.toUnwrapped());const Me=D.projection.createInversionMatrix(D,ee.canonical);ye.draw(h,w.TRIANGLES,pr.disabled,E,M,q,sg(h,ee,re,Me,U,fe,l.paint.get("heatmap-intensity")),l.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,l.paint,h.transform.zoom,de,B?[ce.globeExtVertexBuffer]:null)}v.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),(function(v,w){const E=v.context,M=E.gl,D=w.heatmapFbo;if(!D)return;E.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,D.colorAttachment.get()),E.activeTexture.set(M.TEXTURE1);let B=w.colorRampTexture;B||(B=w.colorRampTexture=new i.T(E,w.colorRamp,M.RGBA8)),B.bind(M.LINEAR,M.CLAMP_TO_EDGE),v.getOrCreateProgram("heatmapTexture").draw(v,M.TRIANGLES,pr.disabled,Nr.disabled,v.colorModeForRenderPass(),Vr.disabled,((j,q,U,Y)=>({u_image:0,u_color_ramp:1,u_opacity:q.paint.get("heatmap-opacity")}))(0,w),w.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,w.paint,v.transform.zoom)})(h,l))},line:function(h,n,l,f){if(h.renderPass!=="translucent")return;const v=l.paint.get("line-opacity"),w=l.paint.get("line-width");if(v.constantOr(1)===0||w.constantOr(1)===0)return;const E=l.paint.get("line-emissive-strength"),M=l.paint.get("line-occlusion-opacity"),D=l.layout.get("line-elevation-reference"),B=l.layout.get("line-width-unit")==="meters",j=D==="sea",q=!(!h.terrain||!h.terrain.enabled),U=h.context,Y=U.gl;if(l.hasElevatedBuckets&&h.transform.projection.name==="globe")return;const ee=l.layout.get("line-cross-slope"),re=ee!==void 0,ce=ee<1,ae=h.colorModeForDrapableLayerRenderPass(E),de=h.terrain&&h.terrain.renderingToTexture,ye=de?1:i.o.devicePixelRatio,fe=l.paint.get("line-dasharray"),Me=fe.constantOr(1),xe=l.layout.get("line-cap"),Ce=fe.constantOr(null),Te=xe.constantOr(null),be=l.paint.get("line-pattern"),De=be.constantOr(1),He=l.paint.get("line-pattern-cross-fade"),$e=be.constantOr(null),st=l.paint.get("line-opacity").constantOr(1);let Qe=!De&&st!==1||h.depthOcclusion&&M>0&&M<1;const pt=l.paint.get("line-gradient"),Ft=De?"linePattern":"line",Xe=i.e1(l);let je;if(de&&h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(Qe=!1),M!==0&&h.depthOcclusion){const $t=l.paint._values["line-opacity"];$t&&$t.value&&$t.value.kind==="constant"?je=$t.value:i.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}w.value.kind!=="constant"&&w.value.isLineProgressConstant===!1&&Xe.push("VARIABLE_LINE_WIDTH");const dt=($t,fr,kt,Nt,mr,lr)=>{for(const Qt of $t){const ur=n.getTile(Qt);if(De&&!ur.patternsLoaded())continue;const Dr=ur.getBucket(l);if(!Dr||Dr.elevationType!=="none"&&!mr||Dr.elevationType==="none"&&mr)continue;h.prepareDrawTile();const _n=[...fr],Kr=h.shadowRenderer,hi=Dr.elevationType==="road"&&!!Kr&&Kr.enabled;let Wr=[0,0,0];if(hi){const qr=h.style.directionalLight,En=h.style.ambientLight;qr&&En&&(Wr=Na(h.style,qr,En)),_n.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Sn=Dr.programConfigurations.get(l.id);let sn=!1;if($e&&ur.imageAtlas){const qr=i.e2.from($e),En=qr.getPrimary().scaleSelf(ye).toString(),zi=ur.imageAtlas.patternPositions.get(En),_o=qr.getSecondary(),ki=_o?ur.imageAtlas.patternPositions.get(_o.scaleSelf(ye).toString()):null;sn=!!zi&&!!ki,zi&&Sn.setConstantPatternPositions(zi,ki)}He>0&&(sn||Sn.getPatternTransitionVertexBuffer("line-pattern"))&&_n.push("LINE_PATTERN_TRANSITION");const ti=h.isTileAffectedByFog(Qt),Tn=h.getOrCreateProgram(Ft,{config:Sn,defines:_n,overrideFog:ti});if(!De&&Ce&&Te&&ur.lineAtlas){const qr=ur.lineAtlas.getDash(Ce,Te);qr&&Sn.setConstantPatternPositions(qr)}hi&&Kr.setupShadows(ur.tileID.toUnwrapped(),Tn,"vector-tile");let[vi,yn]=l.paint.get("line-trim-offset");(Te==="round"||Te==="square")&&vi!==yn&&(vi===0&&(vi-=1),yn===1&&(yn+=1));const nn=de?Qt.projMatrix:null,qn=B?1/Dr.tileToMeter/i.ay(ur,1,h.transform.zoom):1,Jr=B?1/Dr.tileToMeter/i.ay(ur,1,Math.floor(h.transform.zoom)):1,xi=De?i.e3(h,ur,l,nn,ye,qn,Jr,[vi,yn],Wr,He):i.e4(h,ur,l,nn,Dr.lineClipsArray.length,ye,qn,Jr,[vi,yn],Wr);if(pt){const qr=Dr.gradients[l.id];let En=qr.texture;if(l.gradientVersion!==qr.version){let zi=256;if(l.stepInterpolant){const _o=n.getSource().maxzoom,ki=Qt.canonical.z===_o?Math.ceil(1<<h.transform.maxZoom-Qt.canonical.z):1;zi=i.aA(i.e5(Dr.maxLineLength/i.al*1024*ki),256,U.maxTextureSize)}qr.gradient=i.e6({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:zi,image:qr.gradient||void 0,clips:Dr.lineClipsArray}),qr.texture?qr.texture.update(qr.gradient):qr.texture=new i.T(U,qr.gradient,Y.RGBA8),qr.version=l.gradientVersion,En=qr.texture}U.activeTexture.set(Y.TEXTURE1),En.bind(l.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}Me&&(U.activeTexture.set(Y.TEXTURE0),ur.lineAtlasTexture&&ur.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),Sn.updatePaintBuffers()),De&&(U.activeTexture.set(Y.TEXTURE0),ur.imageAtlasTexture&&ur.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Sn.updatePaintBuffers()),mr&&!j&&h.terrain.setupElevationDraw(ur,Tn),h.uploadCommonUniforms(U,Tn,Qt.toUnwrapped());const Pn=qr=>{je!=null&&(je.value=st*M),Tn.draw(h,Y.TRIANGLES,kt,qr,ae,Vr.disabled,xi,l.id,Dr.layoutVertexBuffer,Dr.indexBuffer,Dr.segments,l.paint,h.transform.zoom,Sn,[Dr.layoutVertexBuffer2,Dr.patternVertexBuffer,Dr.zOffsetVertexBuffer]),je!=null&&(je.value=st)};if(Qe&&!mr){const qr=h.stencilModeForClipping(Qt).ref;qr===0&&de&&U.clear({stencil:0});const En={func:Y.EQUAL,mask:255};xi.u_alpha_discard_threshold=.8,Pn(new Nr(En,qr,255,Y.KEEP,Y.KEEP,Y.INVERT)),xi.u_alpha_discard_threshold=0,Pn(new Nr(En,qr,255,Y.KEEP,Y.KEEP,Y.KEEP))}else xi.u_alpha_discard_threshold=Qe&&mr&&lr?.8:0,Pn(mr?Nt:h.stencilModeForClipping(Qt))}};let rt=h.depthModeForSublayer(0,pr.ReadOnly);const Mt=new pr(h.depthOcclusion?Y.GREATER:Y.LEQUAL,pr.ReadOnly,h.depthRangeFor3D);if(l.hasNonElevatedBuckets){const $t=!de&&h.terrain;M!==0&&$t?i.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`):$t?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${l.id}.`):dt(f,Xe,rt,Nr.disabled,!1,!0)}if(l.hasElevatedBuckets){D==="hd-road-markup"?q||(rt=Mt,Xe.push("ELEVATED_ROADS")):(Xe.push("ELEVATED"),rt=Mt,re&&Xe.push(ce?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),j&&Xe.push("ELEVATION_REFERENCE_SEA"));const $t=Qe?h.stencilModeFor3D():Nr.disabled;h.forceTerrainMode=!0,dt(f,Xe,rt,$t,!0,!0),Qe&&dt(f,Xe,rt,$t,!0,!1),h.forceTerrainMode=!1}Qe&&(h.resetStencilClippingMasks(),de&&U.clear({stencil:0})),M===0||h.depthOcclusion||de||h.layersWithOcclusionOpacity.push(h.currentLayer)},fill:function(h,n,l,f){const v=l.paint.get("fill-color"),w=l.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const E=l.paint.get("fill-emissive-strength"),M=h.colorModeForDrapableLayerRenderPass(E),D=l.paint.get("fill-pattern"),B=h.opaquePassEnabledForLayer()&&!D.constantOr(1)&&v.constantOr(i.ao.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";let j="none";l.layout.get("fill-elevation-reference")!=="none"?j="road":l.paint.get("fill-z-offset").constantOr(1)!==0&&(j="offset");const q=!(!h.terrain||!h.terrain.enabled),U={painter:h,sourceCache:n,layer:l,coords:f,colorMode:M,elevationType:j,terrainEnabled:q,pass:B};if(h.renderPass!=="shadow")if(j!=="offset"){if(ql(U,!1),j==="road"){const Y=!q&&h.renderPass==="translucent";Y&&tl(h,n,l,f,"geometry"),ql(U,!0,Nr.disabled),Y&&(function(ee){const{painter:re,sourceCache:ce,layer:ae,coords:de,colorMode:ye}=ee,fe=re.context.gl,Me=ee.painter.shadowRenderer,xe=!!Me&&Me.enabled,Ce=new pr(re.context.gl.LEQUAL,pr.ReadOnly,re.depthRangeFor3D);let Te=[0,0,0];if(xe){const De=re.style.directionalLight,He=re.style.ambientLight;De&&He&&(Te=Na(re.style,De,He))}const be=De=>{for(const He of de){const $e=ce.getTile(He),st=$e.getBucket(ae);if(!st)continue;const Qe=st.elevatedStructures;if(!Qe)continue;let pt,Ft;if(De?(pt=Qe.renderableBridgeSegments,Ft=Qe.bridgeProgramConfigurations.get(ae.id)):(pt=Qe.renderableTunnelSegments,Ft=Qe.tunnelProgramConfigurations.get(ae.id)),!pt||pt.segments[0].primitiveLength===0)continue;Ft.updatePaintBuffers(),re.prepareDrawTile();const Xe=re.isTileAffectedByFog(He),je=[];xe&&je.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const dt=re.getOrCreateProgram("elevatedStructures",{config:Ft,overrideFog:Xe,defines:je}),rt=re.translatePosMatrix(He.projMatrix,$e,ae.paint.get("fill-translate"),ae.paint.get("fill-translate-anchor"));xe&&Me.setupShadows($e.tileID.toUnwrapped(),dt,"vector-tile");const Mt=P_(rt,Te);re.uploadCommonUniforms(re.context,dt,He.toUnwrapped()),dt.draw(re,fe.TRIANGLES,Ce,Nr.disabled,ye,Vr.backCCW,Mt,ae.id,Qe.vertexBuffer,Qe.indexBuffer,pt,ae.paint,re.transform.zoom,Ft,[Qe.vertexBufferNormal])}};be(!0),be(!1)})(U)}}else ql(U,!1,h.stencilModeFor3D());else h.shadowRenderer&&j==="road"&&!q&&(function(Y){const{painter:ee,sourceCache:re,layer:ce,coords:ae}=Y,de=ee.context.gl,ye=Y.painter.shadowRenderer;for(const fe of ae){const Me=re.getTile(fe),xe=Me.getBucket(ce);if(!xe)continue;const Ce=xe.elevatedStructures;if(!Ce||!Ce.shadowCasterSegments||Ce.shadowCasterSegments.segments[0].primitiveLength===0)continue;ee.prepareDrawTile();const Te=xe.bufferData.programConfigurations.get(ce.id),be=ee.isTileAffectedByFog(fe),De=ee.getOrCreateProgram("elevatedStructuresDepth",{config:Te,overrideFog:be}),He=ye.calculateShadowPassMatrixFromTile(Me.tileID.toUnwrapped());ee.uploadCommonUniforms(ee.context,De,fe.toUnwrapped());const $e={u_matrix:He,u_depth_bias:0};De.draw(ee,de.TRIANGLES,ye.getShadowPassDepthMode(),Nr.disabled,ye.getShadowPassColorMode(),Vr.disabled,$e,ce.id,Ce.vertexBuffer,Ce.indexBuffer,Ce.shadowCasterSegments,ce.paint,ee.transform.zoom,Te)}})(U)},"fill-extrusion":function(h,n,l,f){const v=l.paint.get("fill-extrusion-opacity"),w=h.context,E=w.gl,M=h.terrain,D=M&&M.renderingToTexture;if(v===0)return;const B=h.conflationActive&&h.style.isLayerClipped(l,n.getSource()),j=h.style.order.indexOf(l.fqid);if(B&&(function(q,U,Y,ee,re){for(const ce of ee){const ae=U.getTile(ce).getBucket(Y);ae&&(ae.updateReplacement(ce,q.replacementSource,re),ae.uploadCentroid(q.context))}})(h,n,l,f,j),M||B)for(const q of f){const U=n.getTile(q).getBucket(l);U&&Vu(h.context,n,q,U,l,M,B)}if(h.renderPass==="shadow"&&h.shadowRenderer){const q=h.shadowRenderer;if(M&&v<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ad)return;const U=q.getShadowPassDepthMode(),Y=q.getShadowPassColorMode();cr(h,n,l,f,U,Nr.disabled,Y,B)}else if(h.renderPass==="translucent"){const q=!l.paint.get("fill-extrusion-pattern").constantOr(1),U=l.paint.get("fill-extrusion-color").constantOr(i.ao.white);if(!D&&U.a!==0){const Y=new pr(h.context.gl.LEQUAL,pr.ReadWrite,h.depthRangeFor3D);v===1&&q?cr(h,n,l,f,Y,Nr.disabled,en.unblended,B):(cr(h,n,l,f,Y,Nr.disabled,en.disabled,B),cr(h,n,l,f,Y,h.stencilModeFor3D(),h.colorModeForRenderPass(),B),h.resetStencilClippingMasks())}if(h.style.enable3dLights()&&q&&(!M&&h.transform.projection.name!=="globe"||D)){const Y=l.paint.get("fill-extrusion-opacity"),ee=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),re=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ce=l.paint.get("fill-extrusion-flood-light-intensity"),ae=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",de=l.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(ae?null:l.lut).toArray01().slice(0,3),ye=ee>0&&re>0,fe=ce>0,Me=(Te,be,De)=>(1-De)*Te+De*be,xe=new em;xe.translate=l.paint.get("fill-extrusion-translate"),xe.translateAnchor=l.paint.get("fill-extrusion-translate-anchor"),xe.edgeRadius=l.layout.get("fill-extrusion-edge-radius"),xe.cutoffFadeRange=l.paint.get("fill-extrusion-cutoff-fade-range");const Ce=Te=>{const be=h.depthModeForSublayer(1,pr.ReadOnly,E.LEQUAL,!0),De=l.paint.get(Te?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),He=Me(.1,3,De),$e=h._showOverdrawInspector;if(!$e){const st=new Nr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Qe=new en([E.ONE,E.ONE,E.ONE,E.ONE],i.ao.transparent,[!1,!1,!1,!0],E.MIN);gc(xe,h,n,l,f,be,st,Qe,Vr.disabled,Te,"sdf",Y,ee,re,ce,de,He,B,!1)}{const st=$e?Nr.disabled:new Nr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),Qe=$e?h.colorModeForRenderPass():new en([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],i.ao.transparent,[!0,!0,!0,!0]);gc(xe,h,n,l,f,be,st,Qe,Vr.disabled,Te,"color",Y,ee,re,ce,de,He,B,!1)}};if(D){const Te=(be,De,He)=>{const $e=h.depthModeForSublayer(1,pr.ReadOnly,E.LEQUAL,!1),st=l.paint.get(be?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Qe=Me(.1,3,st);{const pt=new en([E.ONE,E.ONE,E.ONE,E.ONE],i.ao.transparent,[!1,!1,!1,!0]);gc(xe,h,n,l,f,$e,Nr.disabled,pt,Vr.disabled,be,"clear",Y,ee,re,ce,de,Qe,B,De)}{const pt=new Nr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Ft=new en([E.ONE,E.ONE,E.ONE,E.ONE],i.ao.transparent,[!1,!1,!1,!0],E.MIN);gc(xe,h,n,l,f,$e,pt,Ft,Vr.disabled,be,"sdf",Y,ee,re,ce,de,Qe,B,De)}{const pt=be?E.ZERO:E.ONE_MINUS_DST_ALPHA,Ft=new Nr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),Xe=new en([pt,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],i.ao.transparent,[!0,!0,!0,!0]);gc(xe,h,n,l,f,$e,Ft,Xe,Vr.disabled,be,"color",Y,ee,re,ce,de,Qe,B,De)}{const pt=new en([E.ONE,E.ONE,E.ONE,be?E.ZERO:E.ONE],i.ao.transparent,[!1,!1,!1,!0],be?E.FUNC_ADD:E.MAX);gc(xe,h,n,l,f,$e,Nr.disabled,pt,Vr.disabled,be,"clear",Y,ee,re,ce,de,Qe,B,De,He)}};if(ye||fe){let be;if(h.prepareDrawTile(),M){const De=M.drapeBufferSize[0],He=M.drapeBufferSize[1];be=M.framebufferCopyTexture,be&&(!be||be.size[0]===De&&be.size[1]===He)||(be&&be.destroy(),be=M.framebufferCopyTexture=new i.T(w,new i.q({width:De,height:He}),E.RGBA8)),be.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,De,He)}ye&&Te(!0,!1,be),fe&&Te(!1,!0,be)}}else ye&&Ce(!0),fe&&Ce(!1),(ye||fe)&&h.resetStencilClippingMasks()}}},building:function(h,n,l,f){h.currentLayer<h.firstLightBeamLayer&&(h.firstLightBeamLayer=h.currentLayer);const v=l.paint.get("building-ambient-occlusion-ground-intensity"),w=l.paint.get("building-ambient-occlusion-ground-radius"),E=l.paint.get("building-ambient-occlusion-ground-attenuation"),M=l.paint.get("building-opacity");if(M<=0)return;let D=v>0&&w>0,B=!0;const j=l.paint.get("building-vertical-scale");if(j<=0)return;(!h.shadowRenderer||j<1)&&(B=!1);const q=h.conflationActive&&h.style.isLayerClipped(l,n.getSource()),U=h.style.order.indexOf(l.fqid);if((function(Y,ee,re,ce,ae,de){for(const ye of de){const fe=ee.getTile(ye).getBucket(re);fe&&(ae&&fe.updateReplacement(ye,Y.replacementSource,ce),fe.uploadUpdatedIndexBuffer(Y.context))}})(h,n,l,U,q,f),(function(Y,ee,re,ce){for(const ae of ce){const de=ee.getTile(ae).getBucket(re);de&&de.needsEvaluation()&&de.uploadUpdatedColorBuffer(Y.context)}})(h,n,l,f),l.resetLayerRenderingStats(h),h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!0),h.renderPass==="shadow"&&h.shadowRenderer){const Y=h.shadowRenderer,ee=[],re=Y.getShadowPassDepthMode();pu({painter:h,source:n,layer:l,coords:f,defines:ee,blendMode:Y.getShadowPassColorMode(),depthMode:re,opacity:M,verticalScale:j,facadeEmissiveChance:0,facadeAOIntensity:0,floodLightIntensity:0,floodLightColor:[0,0,0]})}else if(h.renderPass==="translucent"){let Y=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];B&&(Y=Y.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),h.shadowRenderer&&h.shadowRenderer.useNormalOffset&&(Y=Y.concat("NORMAL_OFFSET"));const ee=l.paint.get("building-facade-emissive-chance"),re=l.paint.get("building-ambient-occlusion-intensity"),ce=l.paint.get("building-flood-light-intensity"),ae=l.paint.get("building-flood-light-color-use-theme").constantOr("default")==="none",de=l.paint.get("building-flood-light-color").toNonPremultipliedRenderColor(ae?null:l.lut).toArray01().slice(0,3),ye=l.paint.get("building-flood-light-ground-attenuation"),fe=ce>0,Me=new pr(h.context.gl.LEQUAL,pr.ReadWrite,h.depthRangeFor3D);M<1&&pu({painter:h,source:n,layer:l,coords:f,defines:Y,blendMode:en.disabled,depthMode:Me,opacity:M,verticalScale:j,facadeEmissiveChance:ee,facadeAOIntensity:re,floodLightIntensity:ce,floodLightColor:de,depthOnly:!0});const xe=h.colorModeForRenderPass();pu({painter:h,source:n,layer:l,coords:f,defines:Y,blendMode:xe,depthMode:Me,opacity:M,verticalScale:j,facadeEmissiveChance:ee,facadeAOIntensity:re,floodLightIntensity:ce,floodLightColor:de}),D&&ef(h,n,l,f,!0,M,v,w,ce,de,E,q),fe&&ef(h,n,l,f,!1,M,v,w,ce,de,ye,q)}else if(h.renderPass==="light-beam"){const Y=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],ee=new pr(h.context.gl.LEQUAL,pr.ReadOnly,h.depthRangeFor3D);pu({painter:h,source:n,layer:l,coords:f,defines:Y,blendMode:en.alphaBlended,depthMode:ee,opacity:M,verticalScale:j,facadeEmissiveChance:0,facadeAOIntensity:0,floodLightIntensity:0,floodLightColor:[0,0,0]})}h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!1),h.resetStencilClippingMasks()},hillshade:function(h,n,l,f){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent"||h.style.disableElevatedTerrain)return;const v=h.context,w=h.terrain&&h.terrain.renderingToTexture,[E,M]=h.renderPass!=="translucent"||w?[{},f]:h.stencilConfigForOverlap(f);for(const D of M){const B=n.getTile(D);if(B.needsHillshadePrepare&&h.renderPass==="offscreen")Wf(h,B,l);else if(h.renderPass==="translucent"){const j=h.depthModeForSublayer(0,pr.ReadOnly),q=l.paint.get("hillshade-emissive-strength"),U=h.colorModeForDrapableLayerRenderPass(q),Y=w&&h.terrain?h.terrain.stencilModeForRTTOverlap(D):E[D.overscaledZ];rg(h,D,B,l,j,Y,U)}}v.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,n,l,f,v,w){if(h.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const E=h.transform.projection.name==="globe",M=l.paint.get("raster-elevation")!==0,D=M&&E;if(h.renderElevatedRasterBackface&&!D)return;const B=h.context,j=B.gl,q=n.getSource(),U=(function(xe,Ce,Te,be){const De=Ce.paint.get("raster-color"),He=xe.type==="raster-array",$e=[],st=Ce.paint.get("raster-resampling"),Qe=Ce.paint.get("raster-color-mix");let pt=Ce.paint.get("raster-color-range");const Ft=[Qe[0],Qe[1],Qe[2],0],Xe=Qe[3];let je=st==="nearest"?be.NEAREST:be.LINEAR;if(He&&($e.push("RASTER_ARRAY"),De||$e.push("RASTER_COLOR"),st==="linear"&&$e.push("RASTER_ARRAY_LINEAR"),je=be.NEAREST,!pt&&xe.rasterLayers)){const dt=xe.rasterLayers.find((({id:rt})=>rt===Ce.sourceLayer));dt&&dt.fields&&dt.fields.range&&(pt=dt.fields.range)}if(pt=pt||[0,1],De){$e.push("RASTER_COLOR"),Te.activeTexture.set(be.TEXTURE2),Ce.updateColorRamp(pt);let dt=Ce.colorRampTexture;dt||(dt=Ce.colorRampTexture=new i.T(Te,Ce.colorRamp,be.RGBA8)),dt.bind(be.LINEAR,be.CLAMP_TO_EDGE)}return{mix:Ft,range:pt,offset:Xe,defines:$e,resampling:je}})(q,l,B,j);if(q instanceof i.aT&&!f.length&&!E)return;const Y=l.paint.get("raster-emissive-strength"),ee=h.colorModeForDrapableLayerRenderPass(Y),re=h.terrain&&h.terrain.renderingToTexture,ce=!h.options.moving,ae=l.paint.get("raster-resampling")==="nearest"?j.NEAREST:j.LINEAR;if(q instanceof i.aT&&!f.length&&(q.onNorthPole||q.onSouthPole)){const xe=M?h.stencilModeFor3D():Nr.disabled;return void tm(!!q.onNorthPole,null,h,n,l,Y,U,Vr.disabled,xe)}if(!f.length)return;const[de,ye]=q instanceof i.aT||re?[{},f]:h.stencilConfigForOverlap(f),fe=ye[ye.length-1].overscaledZ;D&&U.defines.push("PROJECTION_GLOBE_VIEW"),M&&U.defines.push("RENDER_CUTOFF");const Me=(xe,Ce,Te)=>{for(const be of xe){const De=be.toUnwrapped(),He=n.getTile(be);if(re&&(!He||!He.hasData()))continue;B.activeTexture.set(j.TEXTURE0);const $e=rs(He,q,l,U);if(!$e||!$e.texture)continue;const{texture:st,mix:Qe,offset:pt,tileSize:Ft,buffer:Xe}=$e;let je,dt;re?(je=pr.disabled,dt=be.projMatrix):M?(je=new pr(j.LEQUAL,pr.ReadWrite,h.depthRangeFor3D),dt=E?Float32Array.from(h.transform.expandedFarZProjMatrix):h.transform.calculateProjMatrix(De,ce)):(je=h.depthModeForSublayer(be.overscaledZ-fe,l.paint.get("raster-opacity")===1?pr.ReadWrite:pr.ReadOnly,j.LESS),dt=h.transform.calculateProjMatrix(De,ce));const rt=h.terrain&&re?h.terrain.stencilModeForRTTOverlap(be):de[be.overscaledZ],Mt=w?0:l.paint.get("raster-fade-duration");He.registerFadeDuration(Mt);const $t=n.findLoadedParent(be,0),fr=Zf(He,$t,n,h.transform,Mt);let kt,Nt;!fr.isFading&&He.refreshedUponExpiration&&(He.refreshedUponExpiration=!1),h.terrain&&h.terrain.prepareDrawTile(),B.activeTexture.set(j.TEXTURE0),st.bind(ae,j.CLAMP_TO_EDGE),B.activeTexture.set(j.TEXTURE1),$t?($t.texture&&$t.texture.bind(ae,j.CLAMP_TO_EDGE),kt=Math.pow(2,$t.tileID.overscaledZ-He.tileID.overscaledZ),Nt=[He.tileID.canonical.x*kt%1,He.tileID.canonical.y*kt%1]):st.bind(ae,j.CLAMP_TO_EDGE),"useMipmap"in st&&B.extTextureFilterAnisotropic&&h.transform.pitch>20&&j.texParameterf(j.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const mr=h.transform;let lr;const Qt=M?rm(mr):[0,0,0,0];let ur,Dr,_n,Kr,hi,Wr=0;if(D&&q instanceof i.aT&&q.coordinates.length>3)ur=Float32Array.from(i.bj(i.dI(new i.cC(0,0,0)))),Dr=Float32Array.from(mr.globeMatrix),_n=Float32Array.from(i.dE(mr)),Kr=[i.aF(mr.center.lng),i.aJ(mr.center.lat)],lr=q.elevatedGlobePerspectiveTransform,hi=q.elevatedGlobeGridMatrix||new Float32Array(9);else if(D){const Tn=i.dF(be.canonical);Wr=i.dG(Tn.getCenter().lat),ur=Float32Array.from(i.bj(i.dI(be.canonical))),Dr=Float32Array.from(mr.globeMatrix),_n=Float32Array.from(i.dE(mr)),Kr=[i.aF(mr.center.lng),i.aJ(mr.center.lat)],lr=[0,0],hi=Float32Array.from(i.dH(be.canonical,Tn,Wr,mr.worldSize/mr._pixelsPerMercatorPixel))}else lr=q instanceof i.aT?q.perspectiveTransform:[0,0],ur=new Float32Array(16),Dr=new Float32Array(9),_n=new Float32Array(16),Kr=[0,0],hi=new Float32Array(9);const Sn=Yh(dt,ur,Dr,_n,hi,Nt||[0,0],i.aj(h.transform.zoom),Kr,Qt,kt||1,fr,l,lr,M?l.paint.get("raster-elevation"):0,2,Qe,pt,U.range,Ft,Xe,Y),sn=h.isTileAffectedByFog(be),ti=h.getOrCreateProgram("raster",{defines:U.defines,overrideFog:sn});if(h.uploadCommonUniforms(B,ti,De),q instanceof i.aT){const Tn=q.elevatedGlobeVertexBuffer,vi=q.elevatedGlobeIndexBuffer;if(re||!E)q.boundsBuffer&&q.boundsSegments&&ti.draw(h,j.TRIANGLES,je,Nr.disabled,ee,Vr.disabled,Sn,l.id,q.boundsBuffer,h.quadTriangleIndexBuffer,q.boundsSegments);else if(Tn&&vi){const yn=mr.zoom<=i.cZ?q.elevatedGlobeSegments:q.getSegmentsForLongitude(mr.center.lng);yn&&ti.draw(h,j.TRIANGLES,je,Nr.disabled,ee,Ce,Sn,l.id,Tn,vi,yn)}}else if(D){je=new pr(j.LEQUAL,pr.ReadOnly,h.depthRangeFor3D);const Tn=h.globeSharedBuffers;if(Tn){const[vi,yn,nn]=Tn.getGridBuffers(Wr,!1);ti.draw(h,j.TRIANGLES,je,Te||rt,h.colorModeForRenderPass(),Ce,Sn,l.id,vi,yn,nn)}}else{const{tileBoundsBuffer:Tn,tileBoundsIndexBuffer:vi,tileBoundsSegments:yn}=h.getTileBoundsBuffers(He);ti.draw(h,j.TRIANGLES,je,rt,ee,Vr.disabled,Sn,l.id,Tn,vi,yn)}}if(!(q instanceof i.aT)&&D)for(const be of xe){const De=be.canonical.y===(1<<be.canonical.z)-1;be.canonical.y===0&&tm(!0,be,h,n,l,Y,U,Ce,Te||Nr.disabled),De&&tm(!1,be,h,n,l,Y,U,Ce===Vr.frontCW?Vr.backCW:Vr.frontCW,Te||Nr.disabled)}};D?Me(ye,h.renderElevatedRasterBackface?Vr.backCW:Vr.frontCW,h.stencilModeFor3D()):Me(ye,Vr.disabled,void 0),h.resetStencilClippingMasks()},"raster-particle":function(h,n,l,f,v,w){h.renderPass==="offscreen"&&(function(E,M,D,B){if(!B.length)return;const j=E.context,q=j.gl,U=M.getSource();if(!(U instanceof uo))return;const Y=Math.ceil(Math.sqrt(D.paint.get("raster-particle-count")));let ee=D.particlePositionRGBAImage;if(!ee||ee.width!==Y){const ye=(function(fe){const Me=fe*fe,xe=new Uint8Array(4*Me),Ce=function(be){return be|=0,be=Math.imul(2747636419^be,2654435769),be=Math.imul(be^be>>>16,2654435769),((be=Math.imul(be^be>>>16,2654435769))>>>0)/4294967296},Te=1/1.1;for(let be=0;be<Me;be++){const De=Te*(Ce(2*be+0)+gd),He=Te*(Ce(2*be+1)+gd),$e=255*De%1,st=255*He%1,Qe=$e,pt=He-st/255,Ft=st;xe[4*be+0]=255*(De-$e/255),xe[4*be+1]=255*Qe,xe[4*be+2]=255*pt,xe[4*be+3]=255*Ft}return xe})(Y);ee=D.particlePositionRGBAImage=new i.q({width:Y,height:Y},ye)}let re=D.particleFramebuffer;re?re.width!==Y&&(re.destroy(),re=D.particleFramebuffer=j.createFramebuffer(Y,Y,!0,null)):re=D.particleFramebuffer=j.createFramebuffer(Y,Y,!0,null);const ce=[];for(const ye of B){const fe=M.getTile(ye);if(!(fe instanceof oa))continue;const Me=sp(fe,U,D);if(!Me)continue;const xe=[fe.tileSize,fe.tileSize];let Ce=D.tileFramebuffer;Ce||(Ce=D.tileFramebuffer=j.createFramebuffer(xe[0],xe[1],!0,null));let Te=fe.rasterParticleState;Te||(Te=fe.rasterParticleState=new Ua(j,ye,xe,ee));const be=Te.update(D.lastInvalidatedAt);Te.particleTextureDimension!==Y&&Te.updateParticleTexture(ye,ee);const De=Te.targetColorTexture;Te.targetColorTexture=Te.backgroundColorTexture,Te.backgroundColorTexture=De;const He=Te.particleTexture0;Te.particleTexture0=Te.particleTexture1,Te.particleTexture1=He,ce.push([ye,Me,Te,be])}if(ce.length===0)return;const ae=i.o.now(),de=D.previousDrawTimestamp?.001*(ae-D.previousDrawTimestamp):.0167;if(D.previousDrawTimestamp=ae,D.hasColorMap()){j.activeTexture.set(q.TEXTURE0+2);let ye=D.colorRampTexture;ye||(ye=D.colorRampTexture=new i.T(j,D.colorRamp,q.RGBA8)),ye.bind(q.LINEAR,q.CLAMP_TO_EDGE)}j.bindFramebuffer.set(D.tileFramebuffer.framebuffer),(function(ye,fe,Me){const xe=ye.context,Ce=xe.gl,Te=fe.tileFramebuffer;xe.activeTexture.set(Ce.TEXTURE0);const be={u_texture:0,u_opacity:1.05*(He=fe.paint.get("raster-particle-fade-opacity-factor"))/(He+.05)},De=ye.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var He;for(const $e of Me){const[,,st,Qe]=$e;Te.colorAttachment.set(st.targetColorTexture.texture),xe.viewport.set([0,0,Te.width,Te.height]),xe.clear({color:i.ao.transparent}),Qe&&(st.backgroundColorTexture.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE),De.draw(ye,Ce.TRIANGLES,pr.disabled,Nr.disabled,en.alphaBlended,Vr.disabled,be,fe.id,ye.viewportBuffer,ye.quadTriangleIndexBuffer,ye.viewportSegments))}})(E,D,ce),(function(ye,fe,Me,xe){const Ce=ye.context,Te=Ce.gl,be=Me.tileFramebuffer,De=ye.transform.projection.name==="globe",He=Me.paint.get("raster-particle-max-speed");for(const $e of xe){const[st,Qe,pt]=$e;Ce.activeTexture.set(Te.TEXTURE0+0),Qe.texture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),be.colorAttachment.set(pt.targetColorTexture.texture);const Ft=ye.getOrCreateProgram("rasterParticleDraw",{defines:Qe.defines,overrideFog:!1});Ce.activeTexture.set(Te.TEXTURE0+1);const Xe=Qe.scalarData?[]:[0,1,2,3].map((rt=>i.e8[rt](st)));Xe.push(st);const je=st.canonical.x,dt=st.canonical.y;for(const rt of Xe){const Mt=fe.getTile(De?rt.wrapped():rt);if(!Mt)continue;const $t=Mt.rasterParticleState;if(!$t)continue;const fr=rt.canonical.x+(1<<rt.canonical.z)*(rt.wrap-st.wrap),kt=rt.canonical.y;$t.particleTexture0.bind(Te.NEAREST,Te.CLAMP_TO_EDGE);const Nt=ep(1,$t.particleTexture0.size[0],[fr-je,kt-dt],0,Qe.texture.size,2,He,Qe.textureOffset,Qe.scale,Qe.offset);Ft.draw(ye,Te.POINTS,pr.disabled,Nr.disabled,en.alphaBlended,Vr.disabled,Nt,Me.id,$t.particleIndexBuffer,void 0,$t.particleSegment)}}})(E,M,D,ce),j.bindFramebuffer.set(D.particleFramebuffer.framebuffer),(function(ye,fe,Me,xe){const Ce=ye.context,Te=Ce.gl,be=fe.paint.get("raster-particle-max-speed"),De=xe*fe.paint.get("raster-particle-speed-factor")*.15,He=(function(st){return Math.pow(st,6)})(.01+1*fe.paint.get("raster-particle-reset-rate-factor")),$e=fe.particleFramebuffer;Ce.viewport.set([0,0,$e.width,$e.height]);for(const st of Me){const[,Qe,pt]=st;Ce.activeTexture.set(Te.TEXTURE0+0),Qe.texture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),Ce.activeTexture.set(Te.TEXTURE0+1);const Ft=pt.particleTexture0;Ft.bind(Te.NEAREST,Te.CLAMP_TO_EDGE);const Xe=Kp(1,Ft.size[0],0,Qe.texture.size,be,De,He,Qe.textureOffset,Qe.scale,Qe.offset);$e.colorAttachment.set(pt.particleTexture1.texture),Ce.clear({color:i.ao.transparent}),ye.getOrCreateProgram("rasterParticleUpdate",{defines:Qe.defines}).draw(ye,Te.TRIANGLES,pr.disabled,Nr.disabled,en.unblended,Vr.disabled,Xe,fe.id,ye.viewportBuffer,ye.quadTriangleIndexBuffer,ye.viewportSegments)}})(E,D,ce,de)})(h,n,l,f),h.renderPass==="translucent"&&((function(E,M,D,B,j){const q=E.context,U=q.gl,Y=M.getSource().tileSize,ee=5*(1-i.ah(i.cK,i.cK+1,E.transform.zoom))*Y+D.paint.get("raster-particle-elevation"),re=!E.options.moving,ce=E.transform.projection.name==="globe";if(!B.length)return;const[ae,de]=E.stencilConfigForOverlap(B),ye=[];ce&&ye.push("PROJECTION_GLOBE_VIEW");const fe=E.stencilModeFor3D();for(const Me of de){const xe=Me.toUnwrapped(),Ce=M.getTile(Me);if(!Ce.rasterParticleState)continue;const Te=Ce.rasterParticleState,be=100;Ce.registerFadeDuration(be);const De=M.findLoadedParent(Me,0),He=Zf(Ce,De,M,E.transform,be);let $e,st;E.terrain&&E.terrain.prepareDrawTile(),q.activeTexture.set(U.TEXTURE0),Te.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),q.activeTexture.set(U.TEXTURE1),De&&De.rasterParticleState?(De.rasterParticleState.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),$e=Math.pow(2,De.tileID.overscaledZ-Ce.tileID.overscaledZ),st=[Ce.tileID.canonical.x*$e%1,Ce.tileID.canonical.y*$e%1]):Te.targetColorTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE);const Qe=ce?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(xe,re),pt=E.transform,Ft=Ys(pt),Xe=i.dF(Me.canonical),je=i.dG(Xe.getCenter().lat);let dt,rt,Mt,$t,fr;ce?(dt=Float32Array.from(i.bj(i.dI(Me.canonical))),rt=Float32Array.from(pt.globeMatrix),Mt=Float32Array.from(i.dE(pt)),$t=[i.aF(pt.center.lng),i.aJ(pt.center.lat)],fr=Float32Array.from(i.dH(Me.canonical,Xe,je,pt.worldSize/pt._pixelsPerMercatorPixel))):(dt=new Float32Array(16),rt=new Float32Array(9),Mt=new Float32Array(16),$t=[0,0],fr=new Float32Array(9));const kt=$l(Qe,dt,rt,Mt,fr,st||[0,0],i.aj(E.transform.zoom),$t,Ft,$e||1,He,ee),Nt=E.isTileAffectedByFog(Me),mr=E.getOrCreateProgram("rasterParticle",{defines:ye,overrideFog:Nt});if(E.uploadCommonUniforms(q,mr,xe),ce){const lr=new pr(U.LEQUAL,pr.ReadOnly,E.depthRangeFor3D),Qt=0,ur=E.globeSharedBuffers;if(ur){const[Dr,_n,Kr]=ur.getGridBuffers(je,Qt!==0);mr.draw(E,U.TRIANGLES,lr,fe,en.alphaBlended,E.renderElevatedRasterBackface?Vr.frontCCW:Vr.backCCW,kt,D.id,Dr,_n,Kr)}}else{const lr=E.depthModeForSublayer(0,pr.ReadOnly),Qt=ae[Me.overscaledZ],{tileBoundsBuffer:ur,tileBoundsIndexBuffer:Dr,tileBoundsSegments:_n}=E.getTileBoundsBuffers(Ce);mr.draw(E,U.TRIANGLES,lr,Qt,en.alphaBlended,Vr.disabled,kt,D.id,ur,Dr,_n)}}E.resetStencilClippingMasks()})(h,n,l,f),h.style.map.triggerRepaint())},background:function(h,n,l,f){const v=l.paint.get("background-color"),w=l.paint.get("background-color-use-theme").constantOr("default")==="none",E=l.paint.get("background-opacity"),M=l.paint.get("background-emissive-strength"),D=l.paint.get("background-pitch-alignment")==="viewport";if(E===0)return;const B=h.context,j=B.gl,q=h.transform,U=q.tileSize,Y=l.paint.get("background-pattern");let ee;if(Y!==void 0&&(Y===null||(ee=h.imageManager.getPattern(i.I.from(Y.toString()),l.scope,h.style.getLut(l.scope)),!ee)))return;const re=!Y&&v.a===1&&E===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==re)return;const ce=Nr.disabled,ae=h.depthModeForSublayer(0,re==="opaque"?pr.ReadWrite:pr.ReadOnly),de=h.colorModeForDrapableLayerRenderPass(M),ye=Y?"backgroundPattern":"background";let fe,Me=f;if(Me||(fe=h.getBackgroundTiles(),Me=Object.values(fe).map((xe=>xe.tileID))),Y&&(B.activeTexture.set(j.TEXTURE0),h.imageManager.bind(h.context,l.scope)),D){const xe=h.getOrCreateProgram(ye,{overrideFog:!1,overrideRtt:!0}),Ce=new Float32Array(i.bz([])),Te=new i.aP(0,0,0,0,0),be=Y?rp(Ce,M,E,h,0,l.scope,ee,D,{tileID:Te,tileSize:U}):tp(Ce,M,E,v.toPremultipliedRenderColor(w?null:l.lut));xe.draw(h,j.TRIANGLES,ae,ce,de,Vr.disabled,be,l.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments)}else for(const xe of Me){const Ce=h.isTileAffectedByFog(xe),Te=h.getOrCreateProgram(ye,{overrideFog:Ce}),be=xe.toUnwrapped(),De=f?xe.projMatrix:h.transform.calculateProjMatrix(be);h.prepareDrawTile();const He=n?n.getTile(xe):fe?fe[xe.key]:new jo(xe,U,q.zoom,h),$e=Y?rp(De,M,E,h,0,l.scope,ee,D,{tileID:xe,tileSize:U}):tp(De,M,E,v.toPremultipliedRenderColor(w?null:l.lut));h.uploadCommonUniforms(B,Te,be);const{tileBoundsBuffer:st,tileBoundsIndexBuffer:Qe,tileBoundsSegments:pt}=h.getTileBoundsBuffers(He);Te.draw(h,j.TRIANGLES,ae,ce,de,Vr.disabled,$e,l.id,st,Qe,pt)}},sky:function(h,n,l){const f=h._atmosphere?i.aj(h.transform.zoom):1,v=l.paint.get("sky-opacity")*f;if(v===0)return;const w=h.context,E=l.paint.get("sky-type"),M=new pr(w.gl.LEQUAL,pr.ReadOnly,[0,1]),D=h.frameCounter/1e3%1;E==="atmosphere"?h.renderPass==="offscreen"?l.needsSkyboxCapture(h)&&((function(B,j,q,U){const Y=B.context,ee=Y.gl;let re=j.skyboxFbo;if(!re){re=j.skyboxFbo=Y.createFramebuffer(32,32,!0,null),j.skyboxGeometry=new yc(Y),j.skyboxTexture=Y.gl.createTexture(),ee.bindTexture(ee.TEXTURE_CUBE_MAP,j.skyboxTexture),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MAG_FILTER,ee.LINEAR);for(let ye=0;ye<6;++ye)ee.texImage2D(ee.TEXTURE_CUBE_MAP_POSITIVE_X+ye,0,ee.RGBA,32,32,0,ee.RGBA,ee.UNSIGNED_BYTE,null)}Y.bindFramebuffer.set(re.framebuffer),Y.viewport.set([0,0,32,32]);const ce=j.getCenter(B,!0),ae=B.getOrCreateProgram("skyboxCapture"),de=new Float64Array(16);i.bz(de),i.em(de,de,.5*-Math.PI),ns(B,j,ae,de,ce,0),i.bz(de),i.em(de,de,.5*Math.PI),ns(B,j,ae,de,ce,1),i.bz(de),i.cT(de,de,.5*-Math.PI),ns(B,j,ae,de,ce,2),i.bz(de),i.cT(de,de,.5*Math.PI),ns(B,j,ae,de,ce,3),i.bz(de),ns(B,j,ae,de,ce,4),i.bz(de),i.em(de,de,Math.PI),ns(B,j,ae,de,ce,5),Y.viewport.set([0,0,B.width,B.height])})(h,l),l.markSkyboxValid(h)):h.renderPass==="sky"&&(function(B,j,q,U,Y){const ee=B.context,re=ee.gl,ce=B.transform,ae=B.getOrCreateProgram("skybox");ee.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_CUBE_MAP,j.skyboxTexture);const de=((ye,fe,Me,xe,Ce)=>({u_matrix:ye,u_sun_direction:fe,u_cubemap:0,u_opacity:xe,u_temporal_offset:Ce}))(ce.skyboxMatrix,j.getCenter(B,!1),0,U,Y);B.uploadCommonUniforms(ee,ae),ae.draw(B,re.TRIANGLES,q,Nr.disabled,B.colorModeForRenderPass(),Vr.backCW,de,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)})(h,l,M,v,D):E==="gradient"&&h.renderPass==="sky"&&(function(B,j,q,U,Y){const ee=B.context,re=ee.gl,ce=B.transform,ae=B.getOrCreateProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new yc(ee)),ee.activeTexture.set(re.TEXTURE0);let de=j.colorRampTexture;de||(de=j.colorRampTexture=new i.T(ee,j.colorRamp,re.RGBA8)),de.bind(re.LINEAR,re.CLAMP_TO_EDGE);const ye=((fe,Me,xe,Ce,Te)=>({u_matrix:fe,u_color_ramp:0,u_center_direction:Me,u_radius:i.an(xe),u_opacity:Ce,u_temporal_offset:Te}))(ce.skyboxMatrix,j.getCenter(B,!1),j.paint.get("sky-gradient-radius"),U,Y);B.uploadCommonUniforms(ee,ae),ae.draw(B,re.TRIANGLES,q,Nr.disabled,B.colorModeForRenderPass(),Vr.backCW,ye,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)})(h,l,M,v,D)},custom:function(h,n,l,f){const v=h.context,w=l.implementation;if(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes("custom")||h.terrain&&(h.terrain.renderingToTexture||h.renderPass==="offscreen")&&l.isDraped(n)){if(h.renderPass==="offscreen"){const E=w.prerender;if(E){if(h.setCustomLayerDefaults(),v.setColorMode(h.colorModeForRenderPass()),h.transform.projection.name==="globe"){const M=h.transform.pointMerc;E.call(w,v.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),i.aj(h.transform.zoom),[M.x,M.y],h.transform.pixelsPerMeterRatio)}else E.call(w,v.gl,h.transform.customLayerMatrix());v.setDirty(),h.setBaseState()}}else if(h.renderPass==="translucent"){if(h.terrain&&h.terrain.renderingToTexture){const M=w.renderToTile;if(M){const D=f[0].canonical,B={x:D.x+f[0].wrap*(w.wrapTileId?0:1<<D.z),y:D.y,z:D.z};v.setDepthMode(pr.disabled),v.setStencilMode(Nr.disabled),v.setColorMode(h.colorModeForRenderPass()),h.setCustomLayerDefaults(),M.call(w,v.gl,B),v.setDirty(),h.setBaseState()}return}h.setCustomLayerDefaults(),v.setColorMode(h.colorModeForRenderPass()),v.setStencilMode(Nr.disabled);const E=w.renderingMode==="3d"?new pr(h.context.gl.LEQUAL,pr.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,pr.ReadOnly);if(v.setDepthMode(E),h.transform.projection.name==="globe"){const M=h.transform.pointMerc;w.render(v.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),i.aj(h.transform.zoom),[M.x,M.y],h.transform.pixelsPerMeterRatio)}else w.render(v.gl,h.transform.customLayerMatrix());v.setDirty(),h.setBaseState(),v.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(h,n,l,f){if(h.renderPass==="opaque")return;const v=l.paint.get("model-opacity").constantOr(1),w=l.paint.get("model-elevation-reference"),E=w==="ground",M=w==="ground";if(v===0)return;const D=l.paint.get("model-cast-shadows");if(h.renderPass==="shadow"&&(!D||h.terrain&&v<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof i.ad))return;const B=h.shadowRenderer,j=l.paint.get("model-receive-shadows");B&&(B.useNormalOffset=!0,j||(B.enabled=!1));const q=()=>{B&&(B.useNormalOffset=!0,j||(B.enabled=!0))},U=n.getSource();if(h.renderPass==="light-beam"&&U.type!=="batched-model")return;if(U.type==="vector"||U.type==="geojson")return(function(fe,Me,xe,Ce,Te){const be=fe.transform,De=be.projection.name==="globe",He=be.getFreeCameraOptions().position;if(!fe.modelManager)return;const $e=fe.modelManager;xe.modelManager=$e;const st=fe.shadowRenderer;if(!xe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Qe=xe._unevaluatedLayout._values["model-id"],pt=Object.assign({},xe.layout.get("model-id").parameters),Ft=fe.style.order.indexOf(xe.fqid);for(const Xe of Ce){const je=Me.getTile(Xe).getBucket(xe);if(!je||je.projection.name!==be.projection.name)continue;const dt=je.getModelUris();if(dt&&!je.modelsRequested&&($e.addModelsFromBucket(dt,Te),je.modelsRequested=!0),De)pt.zoom=Xe.overscaledZ;else{const lr=lm(Xe,be);pt.zoom=lr}const rt=Qe.possiblyEvaluate(pt);if(cg(fe,je,Xe),rl.shadowUniformsInitialized=!1,rl.useSingleShadowCascade=!!st&&st.getMaxCascadeForTile(Xe.toUnwrapped())===0,fe.renderPass==="shadow"&&st){if(fe.currentShadowCascade===1&&je.isInsideFirstShadowMapFrustum)continue;const lr=be.calculatePosMatrix(Xe.toUnwrapped(),be.worldSize);if(rl.tileMatrix.set(lr),rl.shadowTileMatrix=Float32Array.from(st.calculateShadowPassMatrixFromMatrix(lr)),rl.aabb.min=[0,0,0],rl.aabb.max[0]=rl.aabb.max[1]=i.al,rl.aabb.max[2]=0,dp(je,rl,fe,xe.scope))continue}const Mt=1<<Xe.canonical.z,$t=[((He.x-Xe.wrap)*Mt-Xe.canonical.x)*i.al,(He.y*Mt-Xe.canonical.y)*i.al,He.z*Mt*i.al];fe.conflationActive&&Object.keys(je.instancesPerModel).length>0&&fe.style.isLayerClipped(xe,Me.getSource())&&je.updateReplacement(Xe,fe.replacementSource,Ft,Te)&&(je.uploaded=!1,je.upload(fe.context));let fr=0;const kt=new Array,Nt=new Array,mr=new Array;for(let lr in je.instancesPerModel){const Qt=je.instancesPerModel[lr];Qt.features.length>0&&!De&&(lr=rt.evaluate(Qt.features[0].feature,{}));const ur=$e.getModel(lr,Te);if(ur||$e.hasURLBeenRequested(lr)||je.modelUris.includes(lr)||(je.modelUris.push(lr),je.modelsRequested=!1),ur&&ur.uploaded)if(De){const Dr=i.c4([],[He.x,He.y,He.z],fe.transform.worldSize);i.ev(Dr,Dr);for(let _n=0;_n<Qt.instancedDataArray.length;++_n){const Kr=[0,0,0],hi=[1,1,1],Wr=i.ew(),Sn=Qt.tileCoordinatesForInstance(_n),sn=Qt.transformForInstance(_n);i.ex(hi,sn),i.ey(Wr,sn),i.ez(Kr,Wr);const ti=Qt.translationForInstance(_n),Tn=new i.aS(0,0);i.eA(je.canonical,Tn,Sn.x,Sn.y);const vi=i.bB();i.eB(vi,ur,fe.transform,Tn,Kr,hi,ti,!0,!1,!1);const yn=Qt.colorForInstance(_n),nn=i.bz([]),qn=i.ee(Tn.lat,fe.transform.zoom),Jr=i.bp([],[1,1,1/qn]);i.bq(nn,nn,Dr),mr.push({zScaleMatrix:Jr,negCameraPosMatrix:nn});for(const xi of ur.nodes)cp(fe,xi,vi,fe.transform.expandedFarZProjMatrix,fr,kt,Nt,ur.materialOverrides,yn);++fr}}else for(const Dr of ur.nodes)cm(fe,xe,Dr,Qt,$t,Xe,rl)}if(De)if(fe.renderPass==="shadow"){for(const lr of Nt)gu(lr.mesh,lr.nodeModelMatrix,fe,xe);for(const lr of kt)gu(lr.mesh,lr.nodeModelMatrix,fe,xe)}else up(fe,xe,1,kt,Nt,mr)}})(h,n,l,f,lp(U,l,h.style._importedAsBasemap)),void q();if(!U.loaded())return;if(U.type==="batched-model")return(function(fe,Me,xe,Ce){xe.resetLayerRenderingStats(fe);const Te=fe.context,be=fe.transform,De=fe.style.fog,He=fe.shadowRenderer;if(be.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${be.projection.name} projection is not yet implemented`);const $e=fe.transform.getFreeCameraOptions().position,st=i.c4([],[$e.x,$e.y,$e.z],fe.transform.worldSize),Qe=i.ev([],st),pt=i.bz([]),Ft=i.ee(be.center.lat,be.zoom),Xe=i.bp([],[1,1,1/Ft]);i.bq(pt,pt,Qe);const je=xe.paint.get("model-opacity").constantOr(1),dt=new pr(Te.gl.LEQUAL,pr.ReadWrite,fe.depthRangeFor3D),rt=new pr(Te.gl.LEQUAL,pr.ReadOnly,fe.depthRangeFor3D),Mt=new i.d8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),$t=fe.renderPass==="shadow",fr=$t&&He?He.getCurrentCascadeFrustum():be.getFrustum(be.scaleZoom(be.worldSize)),kt=xe.paint.get("model-front-cutoff"),Nt=kt[2]<1,mr=Qa(fe,xe.paint.get("model-cutoff-fade-range")),lr=xe.getLayerRenderingStats();(function(Qt,ur,Dr,_n){const Kr=Qt.terrain?Qt.terrain.exaggeration():0,hi=Qt.transform.zoom;for(const Wr of _n){const Sn=ur.getTile(Wr).getBucket(Dr);Sn&&(Sn.setFilter(Dr.filter),Qt.conflationActive&&Sn.updateReplacement(Wr,Qt.replacementSource),Sn.evaluateTransform(Qt,Dr),Qt.terrain&&Kr>0&&Sn.elevationUpdate(Qt.terrain,Kr,Wr,Dr.source),Sn.needsReEvaluation(Qt,hi,Dr)&&Sn.evaluate(Dr))}})(fe,Me,xe,Ce),(function(){let Qt,ur,Dr;Nt?(Qt=Ce.length-1,ur=-1,Dr=-1):(Qt=0,ur=Ce.length,Dr=1);const _n=new Float64Array(16),Kr=i.cz(),hi=new i.P(0,0);for(let Wr=Qt;Wr!==ur;Wr+=Dr){const Sn=Ce[Wr],sn=Me.getTile(Sn).getBucket(xe);if(!sn||!sn.uploaded)continue;let ti=!1;He&&(ti=He.getMaxCascadeForTile(Sn.toUnwrapped())===0);const Tn=be.calculatePosMatrix(Sn.toUnwrapped(),be.worldSize),vi=sn.modelTraits;!$t&&Nt&&(i.bk(_n,Tn),i.af(Kr,st,_n),hi.x=Kr[0],hi.y=Kr[1]);const yn=[];sn.setFilter(xe.filter);for(const nn of sn.getNodesInfo()){if(nn.hiddenByReplacement||!nn.node.meshes)continue;const qn=nn.node;let Jr=0;fe.terrain&&qn.elevation&&(Jr=qn.elevation*fe.terrain.exaggeration());const xi=(()=>{const vs=nn.aabb;return Mt.min=[...vs.min],Mt.max=[...vs.max],Mt.min[2]+=Jr,Mt.max[2]+=Jr,i.af(Mt.min,Mt.min,Tn),i.af(Mt.max,Mt.max,Tn),Mt})(),Pn=nn.evaluatedScale;if(Pn[0]<=1&&Pn[1]<=1&&Pn[2]<=1&&xi.intersects(fr)===0)continue;if(!$t&&Nt){const vs=.16666666666666666;nn.cameraCollisionOpacity=st[0]>xi.min[0]&&st[0]<xi.max[0]&&st[1]>xi.min[1]&&st[1]<xi.max[1]&&st[2]*Ft<xi.max[2]&&qn.footprint&&i.b$(hi,qn.footprint)?Math.max(nn.cameraCollisionOpacity-vs,0):Math.min(1,nn.cameraCollisionOpacity+vs)}const qr=[...Tn],En=1/i.d6(Sn.canonical),zi=qn.anchor?qn.anchor[0]:0,_o=qn.anchor?qn.anchor[1]:0;i.bq(qr,qr,[zi*(Pn[0]-1)+nn.evaluatedTranslation[0]*En,_o*(Pn[1]-1)+nn.evaluatedTranslation[1]*En,Jr+nn.evaluatedTranslation[2]]),i.cp(Pn,i.eD)||i.cR(qr,qr,Pn);const ki=i.aB([],qr,qn.globalMatrix),so=i.aB([],be.expandedFarZProjMatrix,ki),Wa=i.aB([],be.expandedFarZProjMatrix,qr),Ca=i.aC([],[zi,_o,Jr,1],so)[2];qn.hidden=!1;let ls=je;$t||(Nt&&(ls*=nn.cameraCollisionOpacity,ls*=xd(qr,be,nn.aabb,kt)),ls*=oh(mr,Ca)),ls!==0?yn.push({nodeInfo:nn,depth:Ca,opacity:ls,wvpForNode:so,wvpForTile:Wa,nodeModelMatrix:ki,tileModelMatrix:qr}):qn.hidden=!0}$t||yn.sort(((nn,qn)=>!Nt||nn.opacity===1&&qn.opacity===1?nn.depth<qn.depth?-1:1:nn.opacity===1?-1:qn.opacity===1?1:nn.depth>qn.depth?-1:1));for(const nn of yn){const qn=nn.nodeInfo,Jr=qn.node;let xi=i.aB([],Xe,nn.tileModelMatrix);i.aB(xi,pt,xi);const Pn=i.bk([],xi);i.ef(Pn,Pn),i.cR(Pn,Pn,ug),xi=i.aB(xi,xi,Jr.globalMatrix);const qr=fe.renderPass==="light-beam",En=xe.paint.get("model-color-use-theme").constantOr("default")==="none",zi=vi&i.eH.HasMapboxMeshFeatures,_o=zi?0:qn.evaluatedRMEA[0][2];for(let ki=0;ki<Jr.meshes.length;++ki){const so=Jr.meshes[ki],Wa=ki===Jr.lightMeshIndex;let Ca=nn.wvpForNode;if(Wa){if(!qr&&!fe.terrain&&fe.shadowRenderer){fe.currentLayer<fe.firstLightBeamLayer&&(fe.firstLightBeamLayer=fe.currentLayer);continue}Ca=nn.wvpForTile}else if(qr)continue;const ls={defines:[]},vs=[];if(!$t&&He&&(He.useNormalOffset=!!so.normalBuffer),rh(ls.defines,vs,so,fe,En?null:xe.lut),zi||ls.defines.push("DIFFUSE_SHADED"),ti&&ls.defines.push("SHADOWS_SINGLE_CASCADE"),lr&&($t?lr.numRenderedVerticesInShadowPass+=so.vertexArray.length:lr.numRenderedVerticesInTransparentPass+=so.vertexArray.length),$t){gu(so,nn.nodeModelMatrix,fe,xe);continue}let Sl=null;if(De){const ao=sm(nn.nodeModelMatrix,fe.transform);if(Sl=new Float32Array(ao),be.projection.name!=="globe"){const li=so.aabb.min,yo=so.aabb.max,[bs,ji]=De.getOpacityForBounds(ao,li[0],li[1],yo[0],yo[1]);ls.overrideFog=bs>=Je||ji>=Je}}const xs=so.material;let Xl;xs.occlusionTexture&&xs.occlusionTexture.offsetScale&&(Xl=xs.occlusionTexture.offsetScale,ls.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Kl=fe.getOrCreateProgram("model",ls);!$t&&He&&He.setupShadowsFromMatrix(nn.tileModelMatrix,Kl,He.useNormalOffset),fe.uploadCommonUniforms(Te,Kl,null,Sl);const is=xs.pbrMetallicRoughness;is.metallicFactor=.9,is.roughnessFactor=.5;const Bi=np(new Float32Array(Ca),new Float32Array(xi),new Float32Array(Pn),new Float32Array(Jr.globalMatrix),fe,nn.opacity,is.baseColorFactor,xs.emissiveFactor,is.metallicFactor,is.roughnessFactor,xs,_o,xe,[0,0,0],Xl);!Wa&&(qn.hasTranslucentParts||nn.opacity<1)&&Kl.draw(fe,Te.gl.TRIANGLES,dt,Nr.disabled,en.disabled,Vr.backCCW,Bi,xe.id,so.vertexBuffer,so.indexBuffer,so.segments,xe.paint,fe.transform.zoom,void 0,vs),Kl.draw(fe,Te.gl.TRIANGLES,Wa?rt:dt,Nr.disabled,Wa||nn.opacity<1||qn.hasTranslucentParts?en.alphaBlended:en.unblended,Vr.backCCW,Bi,xe.id,so.vertexBuffer,so.indexBuffer,so.segments,xe.paint,fe.transform.zoom,void 0,vs)}}}})()})(h,n,l,f),void q();if(U.type!=="model")return;const Y=U.getModels(),ee=[],re=h.transform.getFreeCameraOptions().position,ce=i.c4([],[re.x,re.y,re.z],h.transform.worldSize);i.ev(ce,ce);const ae=[],de=[];let ye=0;for(const fe of Y){const Me=n.getFeatureState("",fe.id),xe={type:"Unknown",id:fe.id,properties:fe.featureProperties},Ce=l.paint.get("model-rotation").evaluate(xe,Me),Te=l.paint.get("model-scale").evaluate(xe,Me),be=l.paint.get("model-translation").evaluate(xe,Me);ih(l,fe.id,Me,fe.featureProperties,fe.nodeOverrideNames,fe.nodeOverrides),am(l,fe.id,Me,fe.featureProperties,fe.materialOverrideNames,fe.materialOverrides),fe.nodeOverrides.size>0&&fe.computeBoundsAndApplyParent(),fe.computeModelMatrix(h,Ce,Te,be,M,E,!1);const De=i.bz([]),He=i.ee(fe.position.lat,h.transform.zoom),$e=i.bp([],[1,1,1/He]);i.bq(De,De,ce),ee.push({zScaleMatrix:$e,negCameraPosMatrix:De});for(const st of fe.nodes)cp(h,st,fe.matrix,h.transform.expandedFarZProjMatrix,ye,ae,de,fe.materialOverrides);ye++}if(ae.sort(((fe,Me)=>Me.depth-fe.depth)),h.renderPass!=="shadow")up(h,l,v,ae,de,ee),q();else{for(const fe of de)gu(fe.mesh,fe.nodeModelMatrix,h,l);for(const fe of ae)gu(fe.mesh,fe.nodeModelMatrix,h,l);q()}}},hp={line:function(h,n,l){if(h.hasElevatedBuckets=!1,h.hasNonElevatedBuckets=!1,h._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||h._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(n){const f=n.getVisibleCoordinates();for(const v of f){const w=n.getTile(v).getBucket(h);if(w&&(w.elevationType!=="none"?h.hasElevatedBuckets=!0:h.hasNonElevatedBuckets=!0,h.hasElevatedBuckets&&h.hasNonElevatedBuckets))break}}}else h.hasNonElevatedBuckets=!0},model:function(h,n,l){const f=n.getSource();if(!f.loaded())return;if(f.type==="vector"||f.type==="geojson"){const w=lp(f,h,l.style._importedAsBasemap);return void(l.modelManager&&l.modelManager.upload(l,w))}if(f.type==="batched-model"||f.type!=="model")return;const v=f.getModels();for(const w of v)w.upload(l.context)},raster:function(h,n,l){const f=n.getSource();if(!(f instanceof uo&&f.loaded()))return;const v=h.sourceLayer||f.rasterLayerIds&&f.rasterLayerIds[0];if(!v)return;const w=h.paint.get("raster-array-band")||f.getInitialBand(v);if(w==null)return;const E=n.getIds().map((M=>n.getTileByID(M)));for(const M of E)M.updateNeeded(h.id,w)&&f.prepareTile(M,v,h.id,w)},"raster-particle":function(h,n,l){const f=n.getSource();if(!(f instanceof uo&&f.loaded()))return;const v=h.sourceLayer||f.rasterLayerIds&&f.rasterLayerIds[0];if(!v)return;const w=h.paint.get("raster-particle-array-band")||f.getInitialBand(v);if(w==null)return;const E=n.getIds().map((M=>n.getTileByID(M)));for(const M of E)M.updateNeeded(h.id,w)&&f.prepareTile(M,v,h.id,w)}},fp={fill:tl},il={fill:function(h,n,l,f){if(!l.layout||l.layout.get("fill-elevation-reference")==="none"||l.paint.get("fill-opacity").constantOr(1)===0)return;const v=h.context.gl,w=new pr(v.LEQUAL,pr.ReadOnly,h.depthRangeFor3D),E=new Nr({func:v.ALWAYS,mask:255},255,255,v.KEEP,v.KEEP,v.REPLACE),M=h.transform.getFreeCameraOptions().position,D=h.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const B of f){const j=n.getTile(B),q=j.getBucket(l);if(!q)continue;const U=q.elevatedStructures;if(!U||U.depthSegments.segments[0].primitiveLength===0)continue;const Y=lg(B.toUnwrapped(),M),ee=h.translatePosMatrix(B.projMatrix,j,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),re=Gh(ee,Y,0,1,0);D.draw(h,v.TRIANGLES,w,E,en.disabled,Vr.disabled,re,l.id,U.vertexBuffer,U.indexBuffer,U.depthSegments,l.paint,h.transform.zoom)}}};class Gl{constructor(n,l,f,v,w,E){this.context=new Kh(n,l),this.transform=f,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=i.o.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const M=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const B of M)this._debugParams.enabledLayers[B]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const B of M)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],B);this.occlusionParams=new sv(w),this.setup(),this.numSublayers=Ws.maxUnderzooming+Ws.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.eO,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Lu(this),this._wireframeDebugCache=new hg,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const D=new i.q({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,D,n.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=v,this.worldview=E}updateTerrain(n,l){const f=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Nl(this,n));const v=this._terrain;this.transform.elevation=f?v:null,v.update(n,this.transform,l),this.transform.elevation&&!v.enabled&&(this.transform.elevation=null)}_updateFog(n){const l=n.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[f,v]=l.getFovAdjustedRange(this.transform._fov);if(f>v)return void(this.transform.fogCullDistSq=null);const w=f+.78*(v-f);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(n){n&&!this._terrain&&(this._terrain=new Nl(this,this.style)),this._forceTerrainMode=n}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(n,l){if(this.width=n*i.o.devicePixelRatio,this.height=l*i.o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style.order)this.style._mergedLayers[f].resize()}setup(){const n=this.context,l=new i.bc;l.emplaceBack(0,0),l.emplaceBack(i.al,0),l.emplaceBack(0,i.al),l.emplaceBack(i.al,i.al),this.tileExtentBuffer=n.createVertexBuffer(l,i.be.members),this.tileExtentSegments=i.bf.simpleSegment(0,0,4,2);const f=new i.bc;f.emplaceBack(0,0),f.emplaceBack(i.al,0),f.emplaceBack(0,i.al),f.emplaceBack(i.al,i.al),this.debugBuffer=n.createVertexBuffer(f,i.be.members),this.debugSegments=i.bf.simpleSegment(0,0,4,5);const v=new i.bc;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(v,i.be.members),this.viewportSegments=i.bf.simpleSegment(0,0,4,2);const w=new i.a$;w.emplaceBack(0,0,0,0),w.emplaceBack(i.al,0,i.al,0),w.emplaceBack(0,i.al,0,i.al),w.emplaceBack(i.al,i.al,i.al,i.al),this.mercatorBoundsBuffer=n.createVertexBuffer(w,i.bh.members),this.mercatorBoundsSegments=i.bf.simpleSegment(0,0,4,2);const E=new i.b0;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(E);const M=new i.bd;for(const B of[0,1,3,2,0])M.emplaceBack(B);this.debugIndexBuffer=n.createIndexBuffer(M),this.emptyTexture=new i.T(n,new i.q({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA8),this.identityMat=i.bB();const D=this.context.gl;this.stencilClearMode=new Nr({func:D.ALWAYS,mask:0},0,255,D.ZERO,D.ZERO,D.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,n.TRIANGLES,pr.disabled,this.stencilClearMode,en.disabled,Vr.disabled,hu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,l,f){if(!l||this.currentStencilSource===l.id||!n.isTileClipped()||!f||f.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let M=!1;for(const D of f)if(this._tileClippingMaskIDs[D.key]===void 0){M=!0;break}if(!M)return}this.currentStencilSource=l.id;const v=this.context,w=v.gl;this.nextStencilID+f.length>256&&this.clearStencil(),v.setColorMode(en.disabled),v.setDepthMode(pr.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const M of f){const D=l.getTile(M),B=this._tileClippingMaskIDs[M.key]=this.nextStencilID++,{tileBoundsBuffer:j,tileBoundsIndexBuffer:q,tileBoundsSegments:U}=this.getTileBoundsBuffers(D);E.draw(this,w.TRIANGLES,pr.disabled,new Nr({func:w.ALWAYS,mask:0},B,255,w.KEEP,w.KEEP,w.REPLACE),en.disabled,Vr.disabled,hu(M.projMatrix),"$clipping",j,q,U)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,l=this.context.gl;return new Nr({func:l.NOTEQUAL,mask:255},n,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const l=this.context.gl;return new Nr({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(n){const l=this.context.gl,f=n.sort(((E,M)=>M.overscaledZ-E.overscaledZ)),v=f[f.length-1].overscaledZ,w=f[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let M=0;M<w;M++)E[M+v]=new Nr({func:l.GEQUAL,mask:255},M+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=w,[E,f]}return[{[v]:Nr.disabled},f]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new en([n.CONSTANT_COLOR,n.ONE,n.CONSTANT_COLOR,n.ONE],new i.ao(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?en.unblended:en.alphaBlended}colorModeForDrapableLayerRenderPass(n){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new en([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new i.ao(0,0,0,n===void 0?0:n),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(n,l,f,v=!1){if(this.depthOcclusion)return new pr(this.context.gl.GREATER,pr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!v)return pr.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new pr(f||this.context.gl.LEQUAL,l,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const n=this.context.gl,l=Math.ceil(this.width),f=Math.ceil(this.height),v=this.context.bindFramebuffer.get(),w=n.getParameter(n.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===f||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&f!==0&&(this.depthFBO=new Xh(this.context,l,f,!1,"texture"),this.depthTexture=new i.T(this.context,{width:l,height:f,data:null},n.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(v),n.bindTexture(n.TEXTURE_2D,w),this.depthFBO&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),n.blitFramebuffer(0,0,l,f,0,0,l,f,n.DEPTH_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((n,l)=>n+l/this._fpsHistory.length),0))}render(n,l){const f=i.o.now();this._dt=f-this._timeStamp,this._timeStamp=f,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=n.map.repaint,this.style=n,this.options=l;const v=this.style._mergedLayers,w=!(!this.terrain||!this.terrain.enabled),E=()=>this.style._getOrder(w).filter((Xe=>{const je=v[Xe];return!(je.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[je.type]}));let M=E(),D=!1,B=!1,j=null;for(const Xe of M){const je=v[Xe];je.type==="circle"?D=!0:je.type==="building"?j=je:je.type==="symbol"&&(je.hasOcclusionOpacityProperties?B=!0:D=!0)}let q=M.map((Xe=>v[Xe]));const U=this.style._mergedSourceCaches;this.imageManager=n.imageManager,this.modelManager=n.modelManager,this.symbolFadeChange=n.placement.symbolFadeChange(i.o.now()),this.imageManager.beginFrame();let Y=0,ee=!1;for(const Xe in U){const je=U[Xe];je.used&&(je.prepare(this.context),je.getSource().usedInConflation&&++Y)}let re=!1;for(const Xe of q)Xe.isHidden(this.transform.zoom)||(Xe.type==="clip"&&(re=!0),this.prepareLayer(Xe));const ce={},ae={},de={},ye={},fe={};for(const Xe in U){const je=U[Xe];ce[Xe]=je.getVisibleCoordinates(),ae[Xe]=ce[Xe].slice().reverse(),de[Xe]=je.getVisibleCoordinates(!0).reverse(),ye[Xe]=je.getShadowCasterCoordinates(),fe[Xe]=je.sortCoordinatesByDistance(ce[Xe])}const Me=Xe=>{const je=this.style.getLayerSourceCache(Xe);return je&&je.used?je.getSource():null};if(Y||re||this._clippingActiveLastFrame){const Xe=[],je=[];let dt=0;for(const rt of q)this.isSourceForClippingOrConflation(rt,Me(rt))&&(Xe.push(rt),je.push(dt)),dt++;if(Xe&&(re||Xe.length>1)||this._clippingActiveLastFrame){re=!1;const rt=[];for(let Mt=0;Mt<Xe.length;Mt++){const $t=Xe[Mt],fr=je[Mt],kt=this.style.getLayerSourceCache($t);if(!kt||!kt.used||!kt.getSource().usedInConflation&&$t.type!=="clip"&&$t.type!=="building")continue;let Nt=i.eP,mr=i.bZ.None;const lr=[];let Qt=!0;if($t.type==="building")Nt=i.eR;else if($t.type==="clip"){Nt=fr;for(const ur of $t.layout.get("clip-layer-types"))mr|=ur==="model"?i.bZ.Model:ur==="symbol"?i.bZ.Symbol:i.bZ.FillExtrusion;for(const ur of $t.layout.get("clip-layer-scope"))lr.push(ur);$t.isHidden(this.transform.zoom)?Qt=!1:re=!0}Qt&&rt.push({layer:$t.fqid,cache:kt,order:Nt,clipMask:mr,clipScope:lr})}this.replacementSource.setSources(rt),ee=!0}}this._clippingActiveLastFrame=re,ee||this.replacementSource.clear(),this.conflationActive=ee,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Xe=0;Xe<q.length;Xe++){const je=q[Xe],dt=je.cutoffRange();if(this.longestCutoffRange=Math.max(dt,this.longestCutoffRange),dt>0){const rt=Me(je);rt&&(this.minCutoffZoom=Math.max(rt.minzoom,this.minCutoffZoom)),je.minzoom&&(this.minCutoffZoom=Math.max(je.minzoom,this.minCutoffZoom))}je.is3D(w)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Xe),this._lastOcclusionLayer=Xe)}const xe=this.style&&this.style.fog;xe?(this._fogVisible=xe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=xe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(de),this.opaquePassCutoff=0,M=E(),q=M.map((Xe=>v[Xe])));const Ce=this._shadowRenderer;if(Ce){Ce.updateShadowParameters(this.transform,this.style.directionalLight);for(const Xe in U)for(const je of ce[Xe]){let dt={min:0,max:0};this.terrain&&(dt=this.terrain.getMinMaxForTile(je)||dt),Ce.addShadowReceiver(je.toUnwrapped(),dt.min,dt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.eQ(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new to(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Te=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),be=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Te&&!this._snow&&(this._snow=new nf(this)),!Te&&this._snow&&(this._snow.destroy(),delete this._snow),be&&!this._rain&&(this._rain=new $a(this)),!be&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),j){this.buildingTileBorderManager||(this.buildingTileBorderManager=new Ye);const Xe=this.style.getLayerSourceCache(j);this.buildingTileBorderManager.updateBorders(Xe,j)}if(!Yr.has(this.context.gl))return;this.renderPass="offscreen";for(const Xe of q){const je=n.getLayerSourceCache(Xe);if(!Xe.hasOffscreenPass()||Xe.isHidden(this.transform.zoom))continue;const dt=je?ae[je.id]:void 0;(Xe.type==="custom"||Xe.type==="raster"||Xe.type==="raster-particle"||Xe.isSky()||dt&&dt.length)&&this.renderLayer(this,je,Xe,dt)}this.depthRangeFor3D=[0,1-(q.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ye)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const De=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),He=(()=>{if(l.showOverdrawInspector)return i.ao.black;const Xe=this.style.fog;if(Xe&&this.transform.projection.supportsFog){const je=this.style.getLut(Xe.scope);if(!De){const dt=Xe.properties.get("color-use-theme")==="none",rt=Xe.properties.get("color").toNonPremultipliedRenderColor(dt?null:je).toArray01();return new i.ao(...rt)}if(De){const dt=Xe.properties.get("space-color-use-theme")==="none",rt=Xe.properties.get("space-color").toNonPremultipliedRenderColor(dt?null:je).toArray01();return new i.ao(...rt)}}return i.ao.transparent})();if(this.context.clear({color:He,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&De&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){const Xe=q[this.currentLayer],je=n.getLayerSourceCache(Xe);if(Xe.isSky())continue;const dt=je?(Xe.is3D(w)?fe:ae)[je.id]:void 0;this._renderTileClippingMasks(Xe,je,dt),this.renderLayer(this,je,Xe,dt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&De&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.aj(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){const Xe=q[this.currentLayer],je=n.getLayerSourceCache(Xe);Xe.isSky()&&this.renderLayer(this,je,Xe,je?ae[je.id]:void 0)}function $e(Xe,je){let dt;return je&&(dt=(Xe.type==="symbol"?de:Xe.is3D(w)?fe:ae)[je.id]),dt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<M.length;){const Xe=q[this.currentLayer];if(Xe.type==="raster"||Xe.type==="raster-particle"){const je=n.getLayerSourceCache(Xe);this.renderLayer(this,je,Xe,$e(Xe,je))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let st=0;Ce&&(st=Ce.getShadowCastingLayerCount());let Qe=!1,pt=-1;for(let Xe=0;Xe<M.length;++Xe){const je=q[Xe];je.isHidden(this.transform.zoom)||je.is3D(w)&&(pt=Xe)}B&&pt===-1&&(D=!0);let Ft=!1;for(;this.currentLayer<M.length;){const Xe=q[this.currentLayer],je=n.getLayerSourceCache(Xe);if(Xe.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Xe)){if(Xe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Ft&&Xe.is3D(w)&&!w){const dt=this.currentLayer,rt=Mt=>{for(this.currentLayer=0;this.currentLayer<q.length;this.currentLayer++){const $t=q[this.currentLayer];if(fp[$t.type]){const fr=this.style.getLayerSourceCache($t);fp[$t.type](this,fr,$t,$e($t,fr),Mt)}}};rt("initialize"),rt("reset"),this.currentLayer=dt,Ft=!0}if(D&&!Qe&&this.terrain&&!this.transform.isOrthographic&&(Qe=!0,this.blitDepth()),B&&pt!==-1&&this.currentLayer===pt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(Xe,je,je?ce[je.id]:void 0),this.renderLayer(this,je,Xe,$e(Xe,je)),!this.terrain&&Ce&&st>0&&Xe.hasShadowPass()&&--st==0){{this.clearStencil(),this.resetStencilClippingMasks();const dt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<q.length;this.currentLayer++){const rt=q[this.currentLayer];if(il[rt.type]){const Mt=this.style.getLayerSourceCache(rt);il[rt.type](this,Mt,rt,$e(rt,Mt))}}this.currentLayer=dt}if(Ce.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const dt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=dt;this.currentLayer++){const rt=q[this.currentLayer];if(!rt.hasLightBeamPass())continue;const Mt=n.getLayerSourceCache(rt);this.renderLayer(this,Mt,rt,Mt?ae[Mt.id]:void 0)}this.currentLayer=dt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const dt=this.currentLayer;this.depthOcclusion=!0;for(const rt of this.layersWithOcclusionOpacity){this.currentLayer=rt;const Mt=q[this.currentLayer],$t=n.getLayerSourceCache(Mt),fr=$t?ae[$t.id]:void 0;this.terrain||this._renderTileClippingMasks(Mt,$t,$t?ce[$t.id]:void 0),this.renderLayer(this,$t,Mt,fr)}this.depthOcclusion=!1,this.currentLayer=dt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Xe=null;q.forEach((je=>{const dt=n.getLayerSourceCache(je);dt&&!je.isHidden(this.transform.zoom)&&dt.getVisibleCoordinates().length&&(!Xe||Xe.getSource().maxzoom<dt.getSource().maxzoom)&&(Xe=dt)})),Xe&&this.options.showTileBoundaries&&tf(this,Xe,Xe.getVisibleCoordinates(),i.ao.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&tf(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.ao(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&(function(Xe){const je=Xe.transform.padding;mi(Xe,Xe.transform.height-(je.top||0),3,mu),mi(Xe,je.bottom||0,3,vd),ap(Xe,je.left||0,3,$o),ap(Xe,Xe.transform.width-(je.right||0),3,_s);const dt=Xe.transform.centerPoint;(function(rt,Mt,$t,fr){ys(rt,Mt-1,$t-10,2,20,fr),ys(rt,Mt-10,$t-1,20,2,fr)})(Xe,dt.x,Xe.transform.height-dt.y,zs)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ee||(this.conflationActive=!1)}prepareLayer(n){this.gpuTimingStart(n);const{unsupportedLayers:l}=this.transform.projection,f=!l||!l.includes(n.type);if(hp[n.type]&&(f||this.terrain&&n.type==="custom")){const v=this.style.getLayerSourceCache(n);hp[n.type](n,v,this)}this.gpuTimingEnd()}renderLayer(n,l,f,v){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="sky"||f.type==="custom"||f.type==="model"||f.type==="raster"||f.type==="raster-particle"||v&&v.length)&&(this.id=f.id,this.gpuTimingStart(f),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(f.type)&&(!n.terrain||f.type!=="custom")||f.type==="clip"||um[f.type](n,l,f,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,f=this.context.gl;let v=this.gpuTimers[n.id];v||(v=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:f.createQuery()}),v.calls++,f.beginQuery(l.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,l=this.context.gl,f=l.createQuery();this.deferredRenderGpuTimeQueries.push(f),l.beginQuery(n.TIME_ELAPSED_EXT,f)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const l={};for(const f in n){const v=n[f],w=this.context.extTimerQuery,E=w.getQueryParameter(v.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(v.query),l[f]=E}return l}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let f=0;for(const v of n)f+=l.getQueryParameter(v,l.QUERY_RESULT)/1e6,l.deleteQuery(v);return f}translatePosMatrix(n,l,f,v,w){if(!f[0]&&!f[1])return n;const E=w?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(E){const B=Math.sin(E),j=Math.cos(E);f=[f[0]*j-f[1]*B,f[0]*B+f[1]*j]}const M=[w?f[0]:i.ay(l,f[0],this.transform.zoom),w?f[1]:i.ay(l,f[1],this.transform.zoom),0],D=new Float32Array(16);return i.bq(D,n,M),D}saveTileTexture(n){if(n.context!==this.context)return;const l=n.size[0],f=this._tileTextures[l];f?f.push(n):this._tileTextures[l]=[n]}getTileTexture(n){const l=this._tileTextures[n];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(n,l,f){const v=f===void 0?this.terrain&&this.terrain.renderingToTexture:f,w=[];return this.style&&this.style.enable3dLights()&&(n==="globeRaster"||n==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):v||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||v||l!==void 0&&!l||w.push("FOG","FOG_DITHERING"),v&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(n,l){this.cache=this.cache||{};const f=l&&l.defines||[],v=l&&l.config,w=this.currentGlobalDefines(n,l&&l.overrideFog,l&&l.overrideRtt).concat(f),E=Kf.cacheKey(dd[n],n,w,v);return this.cache[E]||(this.cache[E]=new Kf(this.context,n,dd[n],v,Qp[n],w)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(n,l){if(this.style.enable3dLights()){const f=this.style.directionalLight,v=this.style.ambientLight;if(f&&v){const w=((E,M,D)=>{const B=E.properties.get("direction"),j=E.properties.get("color-use-theme")==="none",q=E.properties.get("color").toNonPremultipliedRenderColor(j?null:D.getLut(E.scope)).toArray01(),U=E.properties.get("intensity"),Y=M.properties.get("color-use-theme")==="none",ee=M.properties.get("color").toNonPremultipliedRenderColor(Y?null:D.getLut(M.scope)).toArray01(),re=M.properties.get("intensity"),ce=[B.x,B.y,B.z],ae=i.dM(ee,re),de=i.dM(q,U);return{u_lighting_ambient_color:ae,u_lighting_directional_dir:ce,u_lighting_directional_color:de,u_ground_radiance:qh(ce,de,ae)}})(f,v,this.style);l.setLightsUniformValues(n,w)}}}uploadCommonUniforms(n,l,f,v,w){if(this.uploadCommonLightUniforms(n,l),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const M=E.getOpacity(this.transform.pitch),D=((B,j,q,U,Y,ee,re,ce,ae,de,ye,fe)=>{const Me=B.transform,xe=j.properties.get("color-use-theme")==="none",Ce=j.properties.get("color").toNonPremultipliedRenderColor(xe?null:B.style.getLut(j.scope)).toArray01();Ce[3]=U;const Te=B.frameCounter/1e3%1,[be,De]=j.properties.get("vertical-range");return{u_fog_matrix:q?Me.calculateFogTileMatrix(q):fe||B.identityMat,u_fog_range:j.getFovAdjustedRange(Me._fov),u_fog_color:Ce,u_fog_horizon_blend:j.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(be,De),De],u_fog_temporal_offset:Te,u_frustum_tl:Y,u_frustum_tr:ee,u_frustum_br:re,u_frustum_bl:ce,u_globe_pos:ae,u_globe_radius:de,u_viewport:ye,u_globe_transition:i.aj(Me.zoom),u_is_globe:+(Me.projection.name==="globe")}})(this,E,f,M,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.o.devicePixelRatio,this.transform.height*i.o.devicePixelRatio],v);l.setFogUniformValues(n,D)}w&&l.setCutoffUniformValues(n,w.uniformValues)}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,l=n.createTexture();return n.bindTexture(n.TEXTURE_2D,l),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,l=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(const v of f)l[v.key]=n[v.key]||new jo(v,512,this.transform.tileZoom,this,void 0,this.worldview);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(n,l){return!(!n.is3D(!(!this.terrain||!this.terrain.enabled))||n.type!=="clip"&&n.type!=="building"&&(n.minzoom&&n.minzoom>this.transform.zoom||(this.style._clipLayerPresent||n.sourceLayer!=="building"&&n.sourceLayer!=="procedural_buildings")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(n){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[n.key];return l||(this._cachedTileFogOpacities[n.key]=l=this.style.fog.getOpacityForTile(n)),l[0]>=Je||l[1]>=Je}setupDepthForOcclusion(n,l,f){const v=this.context,w=v.gl,E=!!f;var M;f||(f={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),v.activeTexture.set(w.TEXTURE3),n&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),f.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],f.u_depth_range_unpack=[2/((M=this.depthRangeFor3D)[1]-M[0]),-1-2*M[0]/(M[1]-M[0])],f.u_occluder_half_size=.5*this.occlusionParams.occluderSize,f.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),v.activeTexture.set(w.TEXTURE0),E||l.setTerrainUniformValues(v,f)}}function Uu(h,n){let l=!1,f=null;const v=()=>{f=null,l&&(h(),f=setTimeout(v,n),l=!1)};return()=>(l=!0,f||v(),f)}class of{constructor(n){this._hashName=n&&encodeURIComponent(n),i.aX(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Uu(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const l=dm(n);if(this._hashName){const f=this._hashName;let v=!1;const w=location.hash.slice(1).split("&").map((E=>{const M=E.split("=")[0];return M===f?(v=!0,`${M}=${l}`):E})).filter((E=>E));return v||w.push(`${f}=${l}`),`#${w.join("&")}`}return`#${l}`}_getCurrentHash(){const n=location.hash.replace("#","");if(this._hashName){let l;return n.split("&").map((f=>f.split("="))).forEach((f=>{f[0]===this._hashName&&(l=f)})),(l&&l[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some((f=>isNaN(Number(f))))){const f=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(l[3]||0):n.getBearing();return n.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:f,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function dm(h,n){const l=h.getCenter(),f=Math.round(100*h.getZoom())/100,v=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,v),E=Math.round(l.lng*w)/w,M=Math.round(l.lat*w)/w,D=h.getBearing(),B=h.getPitch();let j=n?`/${E}/${M}/${f}`:`${f}/${M}/${E}`;return(D||B)&&(j+="/"+Math.round(10*D)/10),B&&(j+=`/${Math.round(B)}`),j}const ah={linearity:.3,easing:i.eS(0,0,.3,1)},$u=Object.assign({deceleration:2500,maxSpeed:1400},ah),hm=Object.assign({deceleration:20,maxSpeed:1400},ah),Hl=Object.assign({deceleration:1e3,maxSpeed:360},ah),fm=Object.assign({deceleration:1e3,maxSpeed:90},ah);class pm{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.o.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,l=i.o.now();for(;n.length>0&&l-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)l.zoom+=w.zoomDelta||0,l.bearing+=w.bearingDelta||0,l.pitch+=w.pitchDelta||0,w.panDelta&&l.pan._add(w.panDelta),w.around&&(l.around=w.around),w.pinchAround&&(l.pinchAround=w.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(l.pan.mag()){const w=Fs(l.pan.mag(),f,Object.assign({},$u,n||{}));v.offset=l.pan.mult(w.amount/l.pan.mag()),v.center=this._map.transform.center,Zs(v,w)}if(l.zoom){const w=Fs(l.zoom,f,hm);v.zoom=this._map.transform.zoom+w.amount,Zs(v,w)}if(l.bearing){const w=Fs(l.bearing,f,Hl);v.bearing=this._map.transform.bearing+i.aA(w.amount,-179,179),Zs(v,w)}if(l.pitch){const w=Fs(l.pitch,f,fm);v.pitch=this._map.transform.pitch+w.amount,Zs(v,w)}if(v.zoom||v.bearing){const w=l.pinchAround===void 0?l.around:l.pinchAround;v.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Zs(h,n){(!h.duration||h.duration<n.duration)&&(h.duration=n.duration,h.easing=n.easing)}function Fs(h,n,l){const{maxSpeed:f,linearity:v,deceleration:w}=l,E=i.aA(h*v/(n/1e3),-f,f),M=Math.abs(E)/(w*v);return{easing:l.easing,duration:1e3*M,amount:E*(M/2)}}class Li extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,f,v={}){const w=ze(l.getCanvasContainer(),f),E=l.unproject(w);super(n,Object.assign({point:w,lngLat:E,originalEvent:f},v)),this._defaultPrevented=!1,this.target=l}}class lh extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l,f){const v=n==="touchend"?f.changedTouches:f.touches,w=et(l.getCanvasContainer(),v),E=w.map((D=>l.unproject(D))),M=w.reduce(((D,B,j,q)=>D.add(B.div(q.length))),new i.P(0,0));super(n,{points:w,point:M,lngLats:E,lngLat:l.unproject(M),originalEvent:f}),this._defaultPrevented=!1}}class mm extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class gm{constructor(n,l){this._map=n,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new mm(this._map,n))}mousedown(n,l){return this._mousedownPos=l,this._firePreventable(new Li(n.type,this._map,n))}mouseup(n){this._map.fire(new Li(n.type,this._map,n))}preclick(n){const l=new MouseEvent("preclick",n);this._map.fire(new Li(l.type,this._map,l))}click(n,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(n),this._map.fire(new Li(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new Li(n.type,this._map,n))}mouseover(n){this._map.fire(new Li(n.type,this._map,n))}mouseout(n){this._map.fire(new Li(n.type,this._map,n))}touchstart(n){return this._firePreventable(new lh(n.type,this._map,n))}touchmove(n){this._map.fire(new lh(n.type,this._map,n))}touchend(n){this._map.fire(new lh(n.type,this._map,n))}touchcancel(n){this._map.fire(new lh(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bd{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new Li(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Li("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Li(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pp{constructor(n,l){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,l){this.isEnabled()&&n.shiftKey&&n.button===0&&(Ne(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(n,l){if(!this._active)return;const f=l,v=this._startPos,w=this._lastPos;if(!v||!w||w.equals(f)||!this._box&&f.dist(v)<this._clickTolerance)return;this._lastPos=f,this._box||(this._box=Z("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const E=Math.min(v.x,f.x),M=Math.max(v.x,f.x),D=Math.min(v.y,f.y),B=Math.max(v.y,f.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${E}px,${D}px)`,this._box.style.width=M-E+"px",this._box.style.height=B-D+"px")}))}mouseupWindow(n,l){if(!this._active)return;const f=this._startPos,v=l;if(f&&n.button===0){if(this.reset(),ke(),f.x!==v.x||f.y!==v.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:n})),{cameraAnimation:w=>w.fitScreenCoordinates(f,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),_e(),delete this._startPos,delete this._lastPos}_fireEvent(n,l){return this._map.fire(new i.z(n,{originalEvent:l}))}}function sf(h,n){const l={};for(let f=0;f<h.length;f++)l[h[f].identifier]=n[f];return l}class mp{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,l,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),f.length===this.numTouches&&(this.centroid=(function(v){const w=new i.P(0,0);for(const E of v)w._add(E);return w.div(v.length)})(l),this.touches=sf(f,l)))}touchmove(n,l,f){if(this.aborted||!this.centroid)return;const v=sf(f,l);for(const w in this.touches){const E=v[w];(!E||E.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(n,l,f){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Wu{constructor(n){this.singleTap=new mp(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,l,f){this.singleTap.touchstart(n,l,f)}touchmove(n,l,f){this.singleTap.touchmove(n,l,f)}touchend(n,l,f){const v=this.singleTap.touchend(n,l,f);if(v){const w=n.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(v)<30;if(w&&E||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class _m{constructor(){this._zoomIn=new Wu({numTouches:1,numTaps:2}),this._zoomOut=new Wu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,l,f){this._zoomIn.touchstart(n,l,f),this._zoomOut.touchstart(n,l,f)}touchmove(n,l,f){this._zoomIn.touchmove(n,l,f),this._zoomOut.touchmove(n,l,f)}touchend(n,l,f){const v=this._zoomIn.touchend(n,l,f),w=this._zoomOut.touchend(n,l,f);return v?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(v)},{originalEvent:n})}):w?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(w)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const af={0:1,2:2},lf={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class ch{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,l){return!1}_move(n,l){return{}}mousedown(n,l){if(this._lastPoint)return;const f=ht(n);this._correctButton(n,f)&&(this._lastPoint=l,this._eventButton=f)}mousemoveWindow(n,l){const f=this._lastPoint;if(f){if(n.preventDefault(),this._eventButton!=null&&(function(v,w){const E=af[w];return v.buttons===void 0||(v.buttons&E)!==E})(n,this._eventButton))this.reset();else if(this._moved||!(l.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(f,l)}}mouseupWindow(n){this._lastPoint&&ht(n)===this._eventButton&&(this._moved&&ke(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gp extends ch{mousedown(n,l){super.mousedown(n,l),this._lastPoint&&(this._active=!0)}_correctButton(n,l){return l===0&&!n.ctrlKey}_move(n,l){return{around:l,panDelta:l.sub(n)}}}class uh extends ch{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?lf[n.pitchRotateKey]:void 0}_correctButton(n,l){return this._pitchRotateKey?l===0&&n[this._pitchRotateKey]:l===0&&n.ctrlKey||l===2}_move(n,l){const f=.8*(l.x-n.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class mg extends ch{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?lf[n.pitchRotateKey]:void 0}_correctButton(n,l){return this._pitchRotateKey?l===0&&n[this._pitchRotateKey]:l===0&&n.ctrlKey||l===2}_move(n,l){const f=-.5*(l.y-n.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class gg{constructor(n,l){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),i.aX(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(n,l,f){return this._calculateTransform(n,l,f)}touchmove(n,l,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(f.length===1&&!i.eT())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,l,f)}}touchend(n,l,f){this._calculateTransform(n,l,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,l,f){f.length>0&&(this._active=!0);const v=sf(f,l),w=new i.P(0,0),E=new i.P(0,0);let M=0;for(const B in v){const j=v[B],q=this._touches[B];q&&(w._add(j),E._add(j.sub(q)),M++,v[B]=j)}if(this._touches=v,M<this._minTouches||!E.mag())return;const D=E.div(M);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(M),panDelta:D}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class cf{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,l,f){return{}}touchstart(n,l,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([l[0],l[1]]))}touchmove(n,l,f){const v=this._firstTwoTouches;if(!v)return;n.preventDefault();const[w,E]=v,M=uf(f,l,w),D=uf(f,l,E);if(!M||!D)return;const B=this._aroundCenter?null:M.add(D).div(2);return this._move([M,D],B,n)}touchend(n,l,f){if(!this._firstTwoTouches)return;const[v,w]=this._firstTwoTouches,E=uf(f,l,v),M=uf(f,l,w);E&&M||(this._active&&ke(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function uf(h,n,l){for(let f=0;f<h.length;f++)if(h[f].identifier===l)return n[f]}function df(h,n){return Math.log2(h/n)}class _u extends cf{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,l){const f=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(df(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:df(this._distance,f),pinchAround:l}}}function _g(h,n){return 180*h.angleWith(n)/Math.PI}class yg extends cf{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,l){const f=this._vector;if(this._vector=n[0].sub(n[1]),f&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:_g(this._vector,f),pinchAround:l}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const l=25/(Math.PI*this._minDiameter)*360,f=this._startVector;if(!f)return!1;const v=_g(n,f);return Math.abs(v)<l}}function hf(h){return Math.abs(h.y)>Math.abs(h.x)}class vg extends cf{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,hf(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,l,f){const v=this._lastPoints;if(!v)return;const w=n[0].sub(v[0]),E=n[1].sub(v[1]);return this._map._cooperativeGestures&&!i.eT()&&f.touches.length<3||(this._valid=this.gestureBeginsVertically(w,E,f.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(w.y+E.y)/2*-.5})}gestureBeginsVertically(n,l,f){if(this._valid!==void 0)return this._valid;const v=n.mag()>=2,w=l.mag()>=2;if(!v&&!w)return;if(!v||!w)return this._firstMove==null&&(this._firstMove=f),f-this._firstMove<100&&void 0;const E=n.y>0==l.y>0;return hf(n)&&hf(l)&&E}}const xg={panStep:100,bearingStep:15,pitchStep:10};class ff{constructor(){const n=xg;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let l=0,f=0,v=0,w=0,E=0;switch(n.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:n.shiftKey?f=-1:(n.preventDefault(),w=-1);break;case 39:n.shiftKey?f=1:(n.preventDefault(),w=1);break;case 38:n.shiftKey?v=1:(n.preventDefault(),E=-1);break;case 40:n.shiftKey?v=-1:(n.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(f=0,v=0),{cameraAnimation:M=>{const D=M.getZoom();M.easeTo({duration:300,easeId:"keyboardHandler",easing:Ma,zoom:l?Math.round(D)+l*(n.shiftKey?2:1):D,bearing:M.getBearing()+f*this._bearingStep,pitch:M.getPitch()+v*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:M.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ma(h){return h*(2-h)}const M_=4.000244140625,lv=1/450;class ym{constructor(n,l){this._map=n,this._el=n.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=lv,i.aX(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||i.eT()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const f=i.o.now(),v=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,l!==0&&l%M_==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(v*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),n.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=n,this._delta-=l,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=ze(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>M_?this._wheelZoomRate:this._defaultZoomRate;let j=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&j!==0&&(j=1/j);const q=l(),U=Math.pow(2,q),Y=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(Y*j))),this._type==="wheel"&&(this._startZoom=q,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const f=typeof this._targetZoom=="number"?this._targetZoom:l(),v=this._startZoom,w=this._easing;let E,M=!1;if(this._type==="wheel"&&v&&w){const B=Math.min((i.o.now()-this._lastWheelEventTime)/200,1),j=w(B);E=i.ak(v,f,j),B<1?this._frameId||(this._frameId=!0):M=!0}else E=f,M=!0;this._active=!0,M&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let D=E-l();return D*this._lastDelta<0&&(D=0),{noInertia:!0,needsRenderFrame:!M,zoomDelta:D,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let l=i.eU;if(this._prevEase){const f=this._prevEase,v=(i.o.now()-f.start)/f.duration,w=f.easing(v+.01)-f.easing(v),E=.27/Math.sqrt(w*w+1e-4)*.01,M=Math.sqrt(.0729-E*E);l=i.eS(E,M,.25,1)}return this._prevEase={start:i.o.now(),duration:n,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class Wn{constructor(n,l){this._clickZoom=n,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class C_{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,l){return n.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(n.shiftKey?-1:1),around:f.unproject(l)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dn{constructor(){this._tap=new Wu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,l,f){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=l[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(n,l,f))}touchmove(n,l,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const v=l[0],w=v.y-this._swipePoint.y;return this._swipePoint=v,n.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(n,l,f)}touchend(n,l,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(n,l,f)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pf{constructor(n,l,f){this._el=n,this._mousePan=l,this._touchPan=f}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class bg{constructor(n,l,f){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=l,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class mf{constructor(n,l,f,v){this._el=n,this._touchZoom=l,this._touchRotate=f,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const _p=h=>h.zoom||h.drag||h.pitch||h.rotate;class dh extends i.z{}class hh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,l){const f=i.av([],l,n);this.radius=i.ag(f[2]<0?i.eW([],f,this.constants):[f[0],f[1],0])}projectRay(n){i.eW(n,n,this.constants),i.aw(n,n),i.eX(n,n,this.constants);const l=i.c4([],n,this.radius);if(l[2]>0){const f=i.c4([],[0,0,1],i.bI(l,[0,0,1])),v=i.c4([],i.aw([],[l[0],l[1],0]),this.radius),w=i.d7([],l,i.c4([],i.av([],i.d7([],v,f),l),2));l[0]=w[0],l[1]=w[1]}return l}}function bl(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class yp{constructor(n,l){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pm(n),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new hh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),i.aX(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,w,E]of this._listeners){const M=v===document?this.handleWindowEvent:this.handleEvent;v.addEventListener(w,M,E)}}destroy(){for(const[n,l,f]of this._listeners){const v=n===document?this.handleWindowEvent:this.handleEvent;n.removeEventListener(l,v,f)}}_addDefaultHandlers(n){const l=this._map,f=l.getCanvasContainer();this._add("mapEvent",new gm(l,n));const v=l.boxZoom=new pp(l,n);this._add("boxZoom",v);const w=new _m,E=new C_;l.doubleClickZoom=new Wn(E,w),this._add("tapZoom",w),this._add("clickZoom",E);const M=new dn;this._add("tapDragZoom",M);const D=l.touchPitch=new vg(l);this._add("touchPitch",D);const B=new uh(n),j=new mg(n);l.dragRotate=new bg(n,B,j),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]);const q=new gp(n),U=new gg(l,n);l.dragPan=new pf(f,q,U),this._add("mousePan",q),this._add("touchPan",U,["touchZoom","touchRotate"]);const Y=new yg,ee=new _u;l.touchZoomRotate=new mf(f,ee,Y,M),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),this._add("blockableMapEvent",new bd(l));const re=l.scrollZoom=new ym(l,this);this._add("scrollZoom",re,["mousePan"]);const ce=l.keyboard=new ff;this._add("keyboard",ce);for(const ae of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[ae]&&l[ae].enable(n[ae])}_add(n,l,f){this._handlers.push({handlerName:n,handler:l,allowed:f}),this._handlersById[n]=l}stop(n){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_p(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,l,f){for(const v in n)if(v!==f&&(!l||l.indexOf(v)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const l=[];for(const f of n)this._el.contains(f.target)&&l.push(f);return l}handleEvent(n,l){this._updatingCamera=!0;const f=n.type==="renderFrame",v=f?void 0:n,w={needsRenderFrame:!1},E={},M={},D=n.touches?this._getMapTouches(n.touches):void 0,B=D?et(this._el,D):f?void 0:ze(this._el,n);for(const{handlerName:U,handler:Y,allowed:ee}of this._handlers){if(!Y.isEnabled())continue;let re;this._blockedByActive(M,ee,U)?Y.reset():Y[l||n.type]&&(re=Y[l||n.type](n,B,D),this.mergeHandlerResult(w,E,re,U,v),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||Y.isActive())&&(M[U]=Y)}const j={};for(const U in this._previousActiveHandlers)M[U]||(j[U]=v);this._previousActiveHandlers=M,(Object.keys(j).length||bl(w))&&(this._changes.push([w,E,j]),this._triggerRenderFrame()),(Object.keys(M).length||bl(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=w;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}mergeHandlerResult(n,l,f,v,w){if(!f)return;Object.assign(n,f);const E={handlerName:v,originalEvent:f.originalEvent||w};f.zoomDelta!==void 0&&(l.zoom=E),f.panDelta!==void 0&&(l.drag=E),f.pitchDelta!==void 0&&(l.pitch=E),f.bearingDelta!==void 0&&(l.rotate=E)}_applyChanges(){const n={},l={},f={};for(const[v,w,E]of this._changes)v.panDelta&&(n.panDelta=(n.panDelta||new i.P(0,0))._add(v.panDelta)),v.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(n.around=v.around),v.aroundCoord!==void 0&&(n.aroundCoord=v.aroundCoord),v.pinchAround!==void 0&&(n.pinchAround=v.pinchAround),v.noInertia&&(n.noInertia=v.noInertia),Object.assign(l,w),Object.assign(f,E);this._updateMapTransform(n,l,f),this._changes=[]}_updateMapTransform(n,l,f){const v=this._map,w=v.transform,E=de=>[de.x,de.y,de.z];if((de=>{const ye=this._eventsInProgress.drag;return ye&&!this._handlersById[ye.handlerName].isActive()})()&&!bl(n)){const de=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),de!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&v._stop(!0),!bl(n))return void this._fireEvents(l,f,!0);let{panDelta:M,zoomDelta:D,bearingDelta:B,pitchDelta:j,around:q,aroundCoord:U,pinchAround:Y}=n;w._isCameraConstrained&&(D>0&&(D=0),w._isCameraConstrained=!1),Y!==void 0&&(q=Y),(D||(de=>l[de]&&!this._eventsInProgress[de])("drag"))&&q&&(this._dragOrigin=E(w.pointCoordinate3D(q)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",v._stop(!0),q=q||v.transform.centerPoint,B&&(w.bearing+=B),j&&(w.pitch+=j),w._updateCameraState();const ee=[0,0,0];if(M)if(w.projection.name==="mercator"){const de=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(q).dir),ye=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(q.sub(M)).dir);ee[0]=ye[0]-de[0],ee[1]=ye[1]-de[1]}else{const de=w.pointCoordinate(q);if(w.projection.name==="globe"){M=M.rotate(-w.angle);const ye=w._pixelsPerMercatorPixel/w.worldSize;ee[0]=-M.x*i.eV(i.a_(de.y))*ye,ee[1]=-M.y*i.eV(w.center.lat)*ye}else{const ye=w.pointCoordinate(q.sub(M));de&&ye&&(ee[0]=ye.x-de.x,ee[1]=ye.y-de.y)}}const re=w.zoom,ce=[0,0,0];if(D){const de=E(U||w.pointCoordinate3D(q)),ye={dir:i.aw([],i.av([],de,w._camera.position))};if(ye.dir[2]<0){const fe=w.zoomDeltaToMovement(de,D);i.c4(ce,ye.dir,fe)}}const ae=i.d7(ee,ee,ce);w._translateCameraConstrained(ae),D&&Math.abs(w.zoom-re)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(l,f,!0)}_fireEvents(n,l,f){const v=_p(this._eventsInProgress),w=_p(n),E={};for(const j in n){const{originalEvent:q}=n[j];this._eventsInProgress[j]||(E[`${j}start`]=q),this._eventsInProgress[j]=n[j]}!v&&w&&this._fireEvent("movestart",w.originalEvent);for(const j in E)this._fireEvent(j,E[j]);w&&this._fireEvent("move",w.originalEvent);for(const j in n){const{originalEvent:q}=n[j];this._fireEvent(j,q)}const M={};let D;for(const j in this._eventsInProgress){const{handlerName:q,originalEvent:U}=this._eventsInProgress[j];this._handlersById[q].isActive()||(delete this._eventsInProgress[j],D=l[q]||U,M[`${j}end`]=D)}for(const j in M)this._fireEvent(j,M[j]);const B=_p(this._eventsInProgress);if(f&&(v||w)&&!B){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;j?(q(j.bearing||this._map.getBearing())&&(j.bearing=0),this._map.easeTo(j,{originalEvent:D})):(this._map.fire(new i.z("moveend",{originalEvent:D})),q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,l){this._map.fire(new i.z(n,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((n=>{this._frameId=void 0,this.handleEvent(new dh("renderFrame",{timeStamp:n})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const xo="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class qc extends i.E{constructor(n,l){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,i.aX(["_renderFrameCallback"],this)}getCenter(){return new i.aS(this.transform.center.lng,this.transform.center.lat)}setCenter(n,l){return this.jumpTo({center:n},l)}panBy(n,l,f){return n=i.P.convert(n).mult(-1),this.panTo(this.transform.center,Object.assign({offset:n},l),f)}panTo(n,l,f){return this.easeTo(Object.assign({center:n},l),f)}getZoom(){return this.transform.zoom}setZoom(n,l){return this.jumpTo({zoom:n},l),this}zoomTo(n,l,f){return this.easeTo(Object.assign({zoom:n},l),f)}zoomIn(n,l){return this.zoomTo(this.getZoom()+1,n,l),this}zoomOut(n,l){return this.zoomTo(this.getZoom()-1,n,l),this}getBearing(){return this.transform.bearing}setBearing(n,l){return this.jumpTo({bearing:n},l),this}getPadding(){return this.transform.padding}setPadding(n,l){return this.jumpTo({padding:n},l),this}rotateTo(n,l,f){return this.easeTo(Object.assign({bearing:n},l),f)}resetNorth(n,l){return this.rotateTo(0,Object.assign({duration:1e3},n),l),this}resetNorthPitch(n,l){return this.easeTo(Object.assign({bearing:0,pitch:0,duration:1e3},n),l),this}snapToNorth(n,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,l):this}getPitch(){return this.transform.pitch}setPitch(n,l){return this.jumpTo({pitch:n},l),this}cameraForBounds(n,l){n=i.aI.convert(n);const f=l&&l.bearing||0,v=l&&l.pitch||0,w=n.getNorthWest(),E=n.getSouthEast();return this._cameraForBounds(this.transform,w,E,f,v,l)}_extendPadding(n){const l={top:0,right:0,bottom:0,left:0};return n==null?Object.assign({},l,this.transform.padding):typeof n=="number"?{top:n,bottom:n,right:n,left:n}:Object.assign({},l,n)}_extendCameraOptions(n){return(n=Object.assign({offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=this._extendPadding(n.padding),n}_minimumAABBFrustumDistance(n,l){const f=l.max[0]-l.min[0],v=l.max[1]-l.min[1];return f/v>n.aspect?f/(2*Math.tan(.5*n.fovX)*n.aspect):v/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,l,f,v,w,E){const M=n.clone(),D=this._extendCameraOptions(E);M.bearing=v,M.pitch=w;const B=i.aS.convert(l),j=i.aS.convert(f),q=.5*(B.lat+j.lat),U=.5*(B.lng+j.lng),Y=i.eY(q,U),ee=i.aw([],Y),re=i.aw([],i.bH([],ee,[0,1,0])),ce=i.bH([],re,ee),ae=[re[0],re[1],re[2],0,ce[0],ce[1],ce[2],0,ee[0],ee[1],ee[2],0,0,0,0,1],de=[Y,i.eY(B.lat,B.lng),i.eY(j.lat,B.lng),i.eY(j.lat,j.lng),i.eY(B.lat,j.lng),i.eY(q,B.lng),i.eY(q,j.lng),i.eY(B.lat,U),i.eY(j.lat,U)];let ye=i.d8.fromPoints(de.map((rt=>[i.bI(re,rt),i.bI(ce,rt),i.bI(ee,rt)])));const fe=i.af([],ye.center,ae);i.eZ(fe)===0&&i.e_(fe,0,0,1),i.aw(fe,fe),i.c4(fe,fe,i.aD),M.center=i.e$(fe);const Me=M.getWorldToCameraMatrix(),xe=i.bk(new Float64Array(16),Me);ye=i.d8.applyTransform(ye,i.aB([],Me,ae));const Ce=this._extendAABB(ye,M,D,v);if(!Ce)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ye=Ce,i.af(fe,fe,Me);const Te=.5*(ye.max[2]-ye.min[2]),be=this._minimumAABBFrustumDistance(M,ye),De=i.c4([],[0,0,1],Te),He=i.d7(De,fe,De),$e=be+(M.pitch===0?0:i.bF(fe,He)),st=M.globeCenterInViewSpace,Qe=i.av([],fe,[st[0],st[1],st[2]]);i.aw(Qe,Qe),i.c4(Qe,Qe,$e);const pt=i.d7([],fe,Qe);i.af(pt,pt,xe);const Ft=i.eL/i.aD,Xe=i.ag(pt),je=i.ce(Math.max(Xe*Ft-i.eL,Number.EPSILON),0),dt=Math.min(M.zoomFromMercatorZAdjusted(je),D.maxZoom);return dt>.5*(i.cZ+i.cK)?(M.setProjection({name:"mercator"}),M.zoom=dt,this._cameraForBounds(M,l,f,v,w,E)):{center:M.center,zoom:dt,bearing:v,pitch:w}}_extendAABB(n,l,f,v){const w=.5*((f.padding.left||0)+(f.padding.right||0)),E=.5*((f.padding.top||0)+(f.padding.bottom||0)),M=E,D=w,B=w,j=E,q=l.width-(D+B),U=l.height-(M+j),Y=i.av([],n.max,n.min),ee=Math.min(q/Y[0],U/Y[1]),re=Math.min(l.scaleZoom(l.scale*ee),f.maxZoom);if(isNaN(re))return null;const ce=l.scale/l.zoomScale(re),ae=new i.d8([n.min[0]-D*ce,n.min[1]-j*ce,n.min[2]],[n.max[0]+B*ce,n.max[1]+M*ce,n.max[2]]),de=(typeof f.offset.x=="number"&&typeof f.offset.y=="number"?new i.P(f.offset.x,f.offset.y):i.P.convert(f.offset)).rotate(-i.an(v));return ae.center[0]-=de.x*ce,ae.center[1]+=de.y*ce,ae}queryTerrainElevation(n,l){const f=this.transform.elevation;return f?(l=Object.assign({},{exaggerated:!0},l),f.getAtPoint(i.ae.fromLngLat(n),null,l.exaggerated)):null}_cameraForBounds(n,l,f,v,w,E){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,l,f,v,w,E);const M=n.clone(),D=this._extendCameraOptions(E);M.bearing=v,M.pitch=w;const B=i.aS.convert(l),j=i.aS.convert(f),q=new i.aS(B.lng,j.lat),U=new i.aS(j.lng,B.lat),Y=M.project(B),ee=M.project(j),re=this.queryTerrainElevation(B),ce=this.queryTerrainElevation(j),ae=this.queryTerrainElevation(q),de=this.queryTerrainElevation(U),ye=[[Y.x,Y.y,Math.min(re||0,ce||0,ae||0,de||0)],[ee.x,ee.y,Math.max(re||0,ce||0,ae||0,de||0)]];let fe=i.d8.fromPoints(ye);const Me=M.getWorldToCameraMatrix(),xe=i.bk(new Float64Array(16),Me);fe=i.d8.applyTransform(fe,Me);const Ce=this._extendAABB(fe,M,D,v);if(!Ce)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");fe=Ce;const Te=.5*i.av([],fe.max,fe.min)[2],be=this._minimumAABBFrustumDistance(M,fe),De=[0,0,1,0];i.aC(De,De,Me),i.f0(De,De);const He=i.c4([],De,be+Te),$e=i.d7([],fe.center,He);i.af(fe.center,fe.center,xe),i.af($e,$e,xe);const st=M.unproject(new i.P(fe.center[0],fe.center[1])),Qe=i.f1(M.projection,st),pt=Math.pow(2,Qe),Ft=Math.min(M._zoomFromMercatorZ($e[2]*M.pixelsPerMeter*pt/M.worldSize),D.maxZoom);return M.mercatorFromTransition&&Ft<.5*(i.cZ+i.cK)?(M.setProjection({name:"globe"}),M.zoom=Ft,this._cameraForBounds(M,l,f,v,w,E)):{center:st,zoom:Ft,bearing:v,pitch:w}}fitBounds(n,l,f){const v=this.cameraForBounds(n,l);return this._fitInternal(v,l,f)}fitScreenCoordinates(n,l,f,v,w){const E=i.P.convert(n),M=i.P.convert(l),D=new i.P(Math.min(E.x,M.x),Math.min(E.y,M.y)),B=new i.P(Math.max(E.x,M.x),Math.max(E.y,M.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,M))return this;const j=this.transform.pointLocation3D(D),q=this.transform.pointLocation3D(B),U=this.transform.pointLocation3D(new i.P(D.x,B.y)),Y=this.transform.pointLocation3D(new i.P(B.x,D.y)),ee=[Math.min(j.lng,q.lng,U.lng,Y.lng),Math.min(j.lat,q.lat,U.lat,Y.lat)],re=[Math.max(j.lng,q.lng,U.lng,Y.lng),Math.max(j.lat,q.lat,U.lat,Y.lat)],ce=v&&v.pitch?v.pitch:this.getPitch(),ae=this._cameraForBounds(this.transform,ee,re,f,ce,v);return this._fitInternal(ae,v,w)}_fitInternal(n,l,f){return n?(l=Object.assign(n,l)).linear?this.easeTo(l,f):this.flyTo(l,f):this}jumpTo(n,l){this.stop();const f=n.preloadOnly?this.transform.clone():this.transform;let v=!1,w=!1,E=!1;"zoom"in n&&f.zoom!==+n.zoom&&(v=!0,f.zoom=+n.zoom),n.center!==void 0&&(f.center=i.aS.convert(n.center)),"bearing"in n&&f.bearing!==+n.bearing&&(w=!0,f.bearing=+n.bearing),"pitch"in n&&f.pitch!==+n.pitch&&(E=!0,f.pitch=+n.pitch);const M=typeof n.padding=="number"?this._extendPadding(n.padding):n.padding;if(n.padding!=null&&!f.isPaddingEqual(M))if(n.retainPadding===!1){const D=f.clone();D.padding=M,f.setLocationAtPoint(f.center,D.centerPoint)}else f.padding=M;return n.preloadOnly?(this._preloadTiles(f),this):(this.fire(new i.z("movestart",l)).fire(new i.z("move",l)),v&&this.fire(new i.z("zoomstart",l)).fire(new i.z("zoom",l)).fire(new i.z("zoomend",l)),w&&this.fire(new i.z("rotatestart",l)).fire(new i.z("rotate",l)).fire(new i.z("rotateend",l)),E&&this.fire(new i.z("pitchstart",l)).fire(new i.z("pitch",l)).fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(xo),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,l){const f=this.transform;if(!f.projection.supportsFreeCamera)return i.w(xo),this;this.stop();const v=f.zoom,w=f.pitch,E=f.bearing;f.setFreeCameraOptions(n);const M=v!==f.zoom,D=w!==f.pitch,B=E!==f.bearing;return this.fire(new i.z("movestart",l)).fire(new i.z("move",l)),M&&this.fire(new i.z("zoomstart",l)).fire(new i.z("zoom",l)).fire(new i.z("zoomend",l)),B&&this.fire(new i.z("rotatestart",l)).fire(new i.z("rotate",l)).fire(new i.z("rotateend",l)),D&&this.fire(new i.z("pitchstart",l)).fire(new i.z("pitch",l)).fire(new i.z("pitchend",l)),this.fire(new i.z("moveend",l)),this}easeTo(n,l){this._stop(!1,n.easeId),((n=Object.assign({offset:[0,0],duration:500,easing:i.eU},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const f=this.transform,v=this.getZoom(),w=this.getBearing(),E=this.getPitch(),M=this.getPadding(),D="zoom"in n?+n.zoom:v,B="bearing"in n?this._normalizeBearing(n.bearing,w):w,j="pitch"in n?+n.pitch:E,q=this._extendPadding(n.padding),U=i.P.convert(n.offset);let Y,ee,re;if(f.projection.name==="globe"){const De=i.ae.fromLngLat(f.center),He=U.rotate(-f.angle);De.x+=He.x/f.worldSize,De.y+=He.y/f.worldSize;const $e=De.toLngLat(),st=i.aS.convert(n.center||$e);this._normalizeCenter(st),Y=f.centerPoint.add(He),ee=new i.P(De.x,De.y).mult(f.worldSize),re=new i.P(i.aF(st.lng),i.aJ(st.lat)).mult(f.worldSize).sub(ee)}else{Y=f.centerPoint.add(U);const De=f.pointLocation(Y),He=i.aS.convert(n.center||De);this._normalizeCenter(He),ee=f.project(De),re=f.project(He).sub(ee)}const ce=f.zoomScale(D-v);let ae,de;n.around&&(ae=i.aS.convert(n.around),de=f.locationPoint(ae));const ye=this._zooming||D!==v,fe=this._rotating||w!==B,Me=this._pitching||j!==E,xe=!f.isPaddingEqual(q),Ce=n.retainPadding===!1?f.clone():f,Te=De=>He=>{if(ye&&(De.zoom=i.ak(v,D,He)),fe&&(De.bearing=i.ak(w,B,He)),Me&&(De.pitch=i.ak(E,j,He)),xe&&(Ce.interpolatePadding(M,q,He),Y=Ce.centerPoint.add(U)),ae)De.setLocationAtPoint(ae,de);else{const $e=De.zoomScale(De.zoom-v),st=D>v?Math.min(2,ce):Math.max(.5,ce),Qe=Math.pow(st,1-He),pt=De.unproject(ee.add(re.mult(He*Qe)).mult($e));De.setLocationAtPoint(De.renderWorldCopies?pt.wrap():pt,Y)}return n.preloadOnly||this._fireMoveEvents(l),De};if(n.preloadOnly){const De=this._emulate(Te,n.duration,f);return this._preloadTiles(De),this}const be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ye,this._rotating=fe,this._pitching=Me,this._padding=xe,this._easeId=n.easeId,this._prepareEase(l,n.noMoveStart,be),this._ease(Te(f),(De=>{f.cameraElevationReference==="sea"&&f.recenterOnTerrain(),this._afterEase(l,De)}),n),this}_prepareEase(n,l,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||f.moving||this.fire(new i.z("movestart",n)),this._zooming&&!f.zooming&&this.fire(new i.z("zoomstart",n)),this._rotating&&!f.rotating&&this.fire(new i.z("rotatestart",n)),this._pitching&&!f.pitching&&this.fire(new i.z("pitchstart",n))}_fireMoveEvents(n){this.fire(new i.z("move",n)),this._zooming&&this.fire(new i.z("zoom",n)),this._rotating&&this.fire(new i.z("rotate",n)),this._pitching&&this.fire(new i.z("pitch",n))}_afterEase(n,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const f=this._zooming,v=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new i.z("zoomend",n)),v&&this.fire(new i.z("rotateend",n)),w&&this.fire(new i.z("pitchend",n)),this.fire(new i.z("moveend",n))}flyTo(n,l){if(this._prefersReducedMotion(n)){const rt=i.aH(n,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(rt,l)}this.stop(),n=Object.assign({offset:[0,0],speed:1.2,curve:1.42,easing:i.eU},n);const f=this.transform,v=this.getZoom(),w=this.getBearing(),E=this.getPitch(),M=this.getPadding(),D="zoom"in n?i.aA(+n.zoom,f.minZoom,f.maxZoom):v,B="bearing"in n?this._normalizeBearing(n.bearing,w):w,j="pitch"in n?+n.pitch:E,q=this._extendPadding(n.padding),U=f.zoomScale(D-v),Y=i.P.convert(n.offset);let ee=f.centerPoint.add(Y);const re=f.pointLocation(ee),ce=i.aS.convert(n.center||re);this._normalizeCenter(ce);const ae=f.project(re),de=f.project(ce).sub(ae);let ye=n.curve;const fe=Math.max(f.width,f.height),Me=fe/U,xe=de.mag();if("minZoom"in n){const rt=i.aA(Math.min(n.minZoom,v,D),f.minZoom,f.maxZoom),Mt=fe/f.zoomScale(rt-v);ye=Math.sqrt(Mt/xe*2)}const Ce=ye*ye;function Te(rt){const Mt=(Me*Me-fe*fe+(rt?-1:1)*Ce*Ce*xe*xe)/(2*(rt?Me:fe)*Ce*xe);return Math.log(Math.sqrt(Mt*Mt+1)-Mt)}function be(rt){return(Math.exp(rt)-Math.exp(-rt))/2}function De(rt){return(Math.exp(rt)+Math.exp(-rt))/2}const He=Te(0);let $e=function(rt){return De(He)/De(He+ye*rt)},st=function(rt){return fe*((De(He)*(be(Mt=He+ye*rt)/De(Mt))-be(He))/Ce)/xe;var Mt},Qe=(Te(1)-He)/ye;if(Math.abs(xe)<1e-6||!isFinite(Qe)){if(Math.abs(fe-Me)<1e-6)return this.easeTo(n,l);const rt=Me<fe?-1:1;Qe=Math.abs(Math.log(Me/fe))/ye,st=function(){return 0},$e=function(Mt){return Math.exp(rt*ye*Mt)}}n.duration="duration"in n?+n.duration:1e3*Qe/("screenSpeed"in n?+n.screenSpeed/ye:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const pt=w!==B,Ft=j!==E,Xe=!f.isPaddingEqual(q),je=n.retainPadding===!1?f.clone():f,dt=rt=>Mt=>{const $t=Mt*Qe,fr=1/$e($t);rt.zoom=Mt===1?D:v+rt.scaleZoom(fr),pt&&(rt.bearing=i.ak(w,B,Mt)),Ft&&(rt.pitch=i.ak(E,j,Mt)),Xe&&(je.interpolatePadding(M,q,Mt),ee=je.centerPoint.add(Y));const kt=Mt===1?ce:rt.unproject(ae.add(de.mult(st($t))).mult(fr));return rt.setLocationAtPoint(rt.renderWorldCopies?kt.wrap():kt,ee),rt._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(l),rt};if(n.preloadOnly){const rt=this._emulate(dt,n.duration,f);return this._preloadTiles(rt),this}return this._zooming=!0,this._rotating=pt,this._pitching=Ft,this._padding=Xe,this._prepareEase(l,!1),this._ease(dt(f),(()=>this._afterEase(l)),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(n){}_cancelRenderFrame(n){}_stop(n,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const f=this._onEaseEnd;this._onEaseEnd=void 0,f.call(this,l)}if(!n){const f=this.handlers;f&&f.stop(!1)}return this}_ease(n,l,f){f.animate===!1||f.duration===0?(n(1),l()):(this._easeStart=i.o.now(),this._easeOptions=f,this._onEaseFrame=n,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((i.o.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,l){n=i.bS(n,-180,180);const f=Math.abs(n-l);return Math.abs(n-360-l)<f&&(n-=360),Math.abs(n+360-l)<f&&(n+=360),n}_normalizeCenter(n){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const f=n.lng-l.center.lng;n.lng+=f>180?-360:f<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&i.o.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,l,f){const v=Math.ceil(15*l/1e3),w=[],E=n(f.clone());for(let M=0;M<=v;M++){const D=E(M/v);w.push(D.clone())}return w}_preloadTiles(n,l){}}class wd{constructor(n={}){this.options=n,i.aX(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const l=this.options&&this.options.compact,f=n._getUIString("AttributionControl.ToggleAttribution");this._map=n,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Z("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",f);const v=Z("span","mapboxgl-ctrl-icon",this._compactButton);return v.setAttribute("aria-hidden","true"),v.setAttribute("title",f),this._innerContainer=Z("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(n){const f=l.reduce(((v,w,E)=>(w.value&&(v+=`${w.key}=${w.value}${E<l.length-1?"&":""}`),v)),"?");n.href=`${i.e.FEEDBACK_URL}/${f}#${dm(this._map,!0)}`,n.rel="noopener nofollow"}}_updateData(n){!n||(n.dataType!=="source"||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility")&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const l=this._map.style._mergedSourceCaches;for(const v in l){const w=l[v];if(w.used){const E=w.getSource();E.attribution&&n.indexOf(E.attribution)<0&&n.push(E.attribution)}}n.sort(((v,w)=>v.length-w.length)),n=n.filter(((v,w)=>{for(let E=w+1;E<n.length;E++)if(n[E].indexOf(v)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const f=n.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,n.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class fh{constructor(){i.aX(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=Z("div","mapboxgl-ctrl");const l=Z("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const l in n){const f=n[l].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const l=n[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class Xs{constructor(){i.aX(["_onIndoorUpdate"],this)}onAdd(n){return this._map=n,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("selector-update",(l=>this._onIndoorUpdate(l))),this._container}_createButton(n,l){const f=Z("button",n,this._container);return f.type="button",f.addEventListener("click",l),f}_createSeparator(){return Z("div","mapboxgl-ctrl-separator",this._container)}_setButtonTitle(n,l){this._map&&(n.setAttribute("aria-label",l),n.textContent=l)}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("selector-update",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(n){if(!n||!n.floors)return this._model=n,void(this._container.style.display="none");const l=this._model;this._model=n,this._container.style.display="inline-block",this._container.style.borderRadius="8px",l&&Array.from(this._container.children).forEach((f=>f.remove())),n.floors.length>0&&(this.addBuildingsToggleButton(),this.addCurrentFloors(n.floors,n.activeFloorsVisible),this._updateBuildingsButtonState())}addBuildingsToggleButton(){const n=this._createButton("mapboxgl-ctrl-buildings-toggle",(()=>{const l=this._map;this._model&&l&&l._setIndoorActiveFloorsVisibility(!this._model.activeFloorsVisible)}));Z("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden","true"),n.classList.add("mapboxgl-ctrl-level-button","mapboxgl-ctrl-buildings-toggle"),this._model&&!this._model.activeFloorsVisible&&n.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(n),this._createSeparator()}_updateBuildingsButtonState(){const n=this._container.querySelector(".mapboxgl-ctrl-buildings-toggle");n&&this._model&&(this._model.activeFloorsVisible?n.classList.remove("mapboxgl-ctrl-level-button-selected"):n.classList.add("mapboxgl-ctrl-level-button-selected"))}addCurrentFloors(n,l){for(let f=0;f<n.length;f++){const v=n[f],w=this._createButton("mapboxgl-ctrl-level-button",(()=>{this._map._selectIndoorFloor(v.id)}));this._setButtonTitle(w,v.zIndex.toString()),this._model&&v.id===this._model.selectedFloorId&&l&&w.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(w),f<n.length-1&&this._createSeparator()}}}class vc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const l=++this._id;return this._queue.push({callback:n,id:l,cancelled:!1}),l}remove(n){const l=this._currentlyRunning,f=l?this._queue.concat(l):this._queue;for(const v of f)if(v.id===n)return void(v.cancelled=!0)}run(n=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const f of l)if(!f.cancelled&&(f.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class xc{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const l=i.dC((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,l,f){this._start=this.getValue(l),this._end=n,this._startTime=l,this._endTime=l+f}}const A_={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class wg extends i.z{constructor(n,l,f,v){const{point:w,lngLat:E,originalEvent:M,target:D}=n;super(n.type,{point:w,lngLat:E,originalEvent:M,target:D}),this.preventDefault=()=>{n.preventDefault()},this.id=l,this.interaction=f,this.feature=v}}class Yl{constructor(n){this.map=n,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(n,l){if(this.typeById.has(n))throw new Error(`Interaction id "${n}" already exists.`);const f=l.filter;let v=l.type;f&&this.filters.set(n,i.b5(f)),v==="mouseover"&&(v="mouseenter"),v==="mouseout"&&(v="mouseleave");const w=this.interactionsByType.get(v)||new Map;v==="mouseenter"||v==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(n,l)):w.size===0&&this.map.on(v,this.handleType),w.size===0&&this.interactionsByType.set(v,w),w.set(n,l),this.typeById.set(n,v)}get(n){const l=this.typeById.get(n);if(!l)return;const f=this.interactionsByType.get(l);return f?f.get(n):void 0}remove(n){const l=this.typeById.get(n);if(!l)return;this.typeById.delete(n),this.filters.delete(n);const f=this.interactionsByType.get(l);f&&(f.delete(n),l==="mouseenter"||l==="mouseleave"?(this.delegatedInteractions.delete(n),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):f.size===0&&this.map.off(l,this.handleType))}queryTargets(n,l){const f=[];for(const[v,w]of l)w.target&&f.push({targetId:v,target:w.target,filter:this.filters.get(v)});return this.map.style.queryRenderedTargets(n,f,this.map.transform)}handleMove(n){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const l=this.queryTargets(n.point,Array.from(this.delegatedInteractions).reverse());l.length&&(n.type="mouseenter",this.handleType(n,l));const f=new Map;for(const[v,{feature:w}]of this.prevHoveredFeatures)this.hoveredFeatures.has(v)||f.set(w.id,w);f.size&&(n.type="mouseleave",this.handleType(n,Array.from(f.values())))}handleOut(n){const l=Array.from(this.hoveredFeatures.values()).map((({feature:f})=>f));l.length&&(n.type="mouseleave",this.handleType(n,l)),this.hoveredFeatures.clear()}handleType(n,l){const f=n.type==="mouseenter";if(f&&!this.interactionsByType.has(n.type))return void i.w("mouseenter interaction required for mouseleave to work.");const v=Array.from(this.interactionsByType.get(n.type)).reverse(),w=!!l;l=l||this.queryTargets(n.point,v);let E=!1;const M=new Set;for(const D of l){for(const[B,j]of v){if(!j.target)continue;const q=D.variants?D.variants[B]:null;if(q){for(const U of q){if(Ho(U,D,M,B))continue;const Y=new i.dw(D,U),ee=As(U,D,B);w&&Y.id!==void 0&&(Y.state=this.map.getFeatureState(Y));const re=f?this.prevHoveredFeatures.get(ee):null,ce=new wg(n,B,j,Y),ae=re?re.stop:j.handler(ce);if(f&&this.hoveredFeatures.set(ee,{feature:D,stop:ae}),ae!==!1){E=!0;break}}if(E)break}}if(E)break}if(!E)for(const[D,B]of v){const{handler:j,target:q}=B;if(!q&&j(new wg(n,D,B,null))!==!1)break}}}function vm(h,n){if(Array.isArray(h)&&Array.isArray(n)){const l=new Set(h),f=new Set(n);return l.size===f.size&&h.every((v=>f.has(v)))}return i.bx(h,n)}const Zl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},xm={showCompass:!0,showZoom:!0,visualizePitch:!1};class gf{constructor(n,l,f=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new uh({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,f&&(this.mousePitch=new mg({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),i.aX(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(n,l){this.mouseRotate.mousedown(n,l),this.mousePitch&&this.mousePitch.mousedown(n,l),Ne()}move(n,l){const f=this.map,v=this.mouseRotate.mousemoveWindow(n,l),w=v&&v.bearingDelta;if(w&&f.setBearing(f.getBearing()+w),this.mousePitch){const E=this.mousePitch.mousemoveWindow(n,l),M=E&&E.pitchDelta;M&&f.setPitch(f.getPitch()+M)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){_e(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(Object.assign({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),ze(this.element,n)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,ze(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=et(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=et(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function yu(h,n,l){if(h=new i.aS(h.lng,h.lat),n){const f=new i.aS(h.lng-360,h.lat),v=new i.aS(h.lng+360,h.lat),w=360*Math.ceil(Math.abs(h.lng-l.center.lng)/360),E=l.locationPoint3D(h).distSqr(n),M=n.x<0||n.y<0||n.x>l.width||n.y>l.height;l.locationPoint3D(f).distSqr(n)<E&&(M||Math.abs(f.lng-l.center.lng)<w)?h=f:l.locationPoint3D(v).distSqr(n)<E&&(M||Math.abs(v.lng-l.center.lng)<w)&&(h=v)}for(;Math.abs(h.lng-l.center.lng)>180;){const f=l.locationPoint3D(h);if(f.x>=0&&f.y>=0&&f.x<=l.width&&f.y<=l.height)break;h.lng>l.center.lng?h.lng-=360:h.lng+=360}return h}const bc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Ks={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class qu extends i.E{constructor(n,l){super(),(n instanceof HTMLElement||l)&&(n=Object.assign({element:n},l)),i.aX(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:f="center",color:v="#3FB1CE",scale:w=1,draggable:E=!1,clickTolerance:M=0,rotation:D=Ks.rotation,rotationAlignment:B=Ks.rotationAlignment,pitchAlignment:j=Ks.pitchAlignment,occludedOpacity:q=Ks.occludedOpacity,altitude:U=Ks.altitude}=n||{};this._anchor=f,this._color=v,this._scale=w,this._draggable=E,this._clickTolerance=M,this._rotation=D,this._rotationAlignment=B,this._pitchAlignment=j,this._occludedOpacity=q,this._altitude=U,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),n&&n.element?(this._element=n.element,this._offset=i.P.convert(n&&n.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(n&&n.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(re=>{re.preventDefault()})),this._element.addEventListener("mousedown",(re=>{re.preventDefault()}));const Y=this._element.classList;for(const re in bc)Y.remove(`mapboxgl-marker-anchor-${re}`);Y.add(`mapboxgl-marker-anchor-${this._anchor}`);const ee=n&&n.className?n.className.trim().split(/\s+/):[];Y.add(...ee),this._popup=null}_createDefaultMarker(){const n=Z("div"),l=J("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},n);if(this._altitude===0){const f=J("radialGradient",{id:"shadowGradient"},J("defs",{},l));J("stop",{offset:"10%","stop-opacity":.4},f),J("stop",{offset:"100%","stop-opacity":.05},f),J("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},l)}return J("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},l),J("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},l),J("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},l),n}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=i.aS.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(n){return n===this._altitude||(this._defaultMarker&&(this._altitude===0&&n!==0||this._altitude!==0&&n===0)&&(this._element=this._createDefaultMarker()),this._altitude=n||Ks.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,n._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const l=n.code,f=n.charCode||n.keyCode;l!=="Space"&&l!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(n){const l=n.originalEvent.target,f=this._element;this._popup&&(l===f||f.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,l=this._pos;if(!n||!l)return!1;const f=n.unproject(l,this._altitude),v=n.getFreeCameraOptions();if(!v.position)return!1;const w=v.position.toLngLat();return w.distanceTo(f)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const l=this._pos;if(!l||l.x<0||l.x>n.transform.width||l.y<0||l.y>n.transform.height)return void this._clearFadeTimer();const f=n.unproject(l,this._altitude);let v;n._showingGlobe()&&i.f4(n.transform,this._lngLat)?v=0:(v=1-n._queryFogOpacity(f),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${bc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const n=this._pos,l=this._map,f=this.getPitchAlignment();if(!l||!n||f!=="map")return"";if(!l._showingGlobe()){const D=l.getPitch();return D?`rotateX(${D}deg)`:""}const v=i.cW(i.f5(l.transform,this._lngLat)),w=n.sub(i.f6(l.transform)),E=Math.abs(w.x)+Math.abs(w.y);if(E===0)return"";const M=v/E;return`rotateX(${-w.y*M}deg) rotateY(${w.x*M}deg)`}_calculateZTransform(){const n=this._pos,l=this._map;if(!l||!n)return"";let f=0;const v=this.getRotationAlignment();if(v==="map")if(l._showingGlobe()){const w=l.project(new i.aS(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),E=l.project(new i.aS(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(w);f=i.cW(Math.atan2(E.y,E.x))-90}else f=-l.getBearing();else if(v==="horizon"){const w=i.ah(4,6,l.getZoom()),E=i.f6(l.transform);E.y+=w*l.transform.height;const M=n.sub(E),D=i.cW(Math.atan2(M.y,M.x));f=(D>90?D-270:D+90)*(1-w)}return f+=this._rotation,f?`rotateZ(${f}deg)`:""}_update(n){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=yu(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat,this._altitude),n===!0?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),l._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(n){return this._offset=i.P.convert(n),this._update(),this}addClassName(n){return this._element.classList.add(n),this}removeClassName(n){return this._element.classList.remove(n),this}toggleClassName(n){return this._element.classList.toggle(n)}_onMove(n){const l=this._map;if(!l)return;const f=this._pointerdownPos,v=this._positionDelta;if(f&&v){if(!this._isDragging){const w=this._clickTolerance||l._clickTolerance;if(n.point.dist(f)<w)return;this._isDragging=!0}this._pos=n.point.sub(v),this._lngLat=l.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(n){const l=this._map,f=this._pos;l&&f&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(f),this._pointerdownPos=n.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const l=this._map;return l&&(n?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||Ks.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||Ks.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||Ks.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||Ks.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const wl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Sg={maxWidth:100,unit:"metric"},wc={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Ki={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},ha=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function as(h=new i.P(0,0),n="bottom"){if(typeof h=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(n){case"top":return new i.P(0,h);case"top-left":return new i.P(l,l);case"top-right":return new i.P(-l,l);case"bottom":return new i.P(0,-h);case"bottom-left":return new i.P(l,-l);case"bottom-right":return new i.P(-l,-l);case"left":return new i.P(h,0);case"right":return new i.P(-h,0)}return new i.P(0,0)}return h instanceof i.P||Array.isArray(h)?i.P.convert(h):i.P.convert(h[n]||[0,0])}return{version:C,supported:H.supported,setRTLTextPlugin:i.fa,getRTLTextPluginStatus:i.f9,Map:class extends qc{constructor(h){z.mark(R.create);const n=h;if((h=Object.assign({},Zl,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&i.f2(window)&&(h.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new dc(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies,null,null),h),this._repaint=!!h.repaint,this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new vc,this._domRenderTaskQueue=new vc,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.b1(),this._locale=Object.assign({},A_,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._tessellationStep=h.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=h.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new xc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=h.scaleFactor,this._requestManager=new Fr(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,this._contextCreateOptions=h.contextCreateOptions?Object.assign({},h.contextCreateOptions):{},typeof h.container=="string"){const l=document.getElementById(h.container);if(!l)throw new Error(`Container '${h.container.toString()}' not found.`);this._container=l}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),this._spriteFormat=h.spriteFormat,i.aX(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new av),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},(()=>{this.setScaleFactor(this._scaleFactor)})),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new yp(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,(h.style||!h.testMode)&&this.setStyle(h.style||i.e.DEFAULT_STYLE,{config:h.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),h.hash&&(this._hash=new of(typeof h.hash=="string"&&h.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){n.center==null&&n.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch});const l=h.bounds;l&&(this.resize(),this.fitBounds(l,Object.assign({},h.fitBoundsOptions,{duration:0})))}this.resize(),h.attributionControl&&this.addControl(new wd({customAttribution:h.customAttribution})),this._logoControl=new fh,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent(),this._postStyleWithAppearanceEvent(),this._setupIndoor()})),this.on("data",(l=>{this._update(l.dataType==="style"),this.fire(new i.z(`${l.dataType}data`,l))})),this.on("dataloading",(l=>{this.fire(new i.z(`${l.dataType}dataloading`,l))})),this._interactions=new Yl(this)}_getMapId(){return this._mapId}addControl(h,n){if(n===void 0&&(n=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=h.onAdd(this);this._controls.push(h);const f=this._controlPositions[n];return n.indexOf("bottom")!==-1?f.insertBefore(l,f.firstChild):f.appendChild(l),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(h);return n>-1&&this._controls.splice(n,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new i.z("movestart",h)).fire(new i.z("move",h)),this.fire(new i.z("resize",h)),n&&this.fire(new i.z("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(i.aI.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(h){return this._scaleFactor=h,this.painter.scaleFactor=h,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers((n=>n.type==="symbol")),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return h==="auto"?navigator.language:Array.isArray(h)?h.length===0?void 0:h.map((n=>n==="auto"?navigator.language:n)):h}setLanguage(h){const n=this._parseLanguage(h);if(!this.style||n===this._language)return this;this._language=n,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(h){return this._lazyInitEmptyStyle(),h?typeof h=="string"&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const h=this.transform,n=h.projection.name;let l;n==="globe"&&h.zoom>=i.cK?(h.setMercatorFromTransition(),l=!0):n==="mercator"&&h.zoom<i.cK&&(h.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(h,n){return this._updateProjection(h||n||{name:"mercator"})}_updateProjection(h){let n;const l=this.transform.mercatorFromTransition;n=h.name==="globe"&&this.transform.zoom>=i.cK?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate();const f=this.transform.getProjection().name==="mercator"&&l!==this.transform.mercatorFromTransition;return(n||f)&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(h,n){return this.transform.locationPoint3D(i.aS.convert(h),n)}unproject(h,n){return this.transform.pointLocation3D(i.P.convert(h),n)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,n,l){const f=v=>{let w=[];if(Array.isArray(n)){const E=n.filter((M=>this.getLayer(M)));w=E.length?this.queryRenderedFeatures(v,{layers:E}):[]}else w=this.queryRenderedFeatures(v,{target:n});return w};if(h==="mouseenter"||h==="mouseover"){let v=!1;return{listener:l,targets:n,delegates:{mousemove:E=>{const M=f(E.point);M.length?v||(v=!0,l.call(this,new Li(h,this,E.originalEvent,{features:M}))):v=!1},mouseout:()=>{v=!1}}}}if(h==="mouseleave"||h==="mouseout"){let v=!1;return{listener:l,targets:n,delegates:{mousemove:M=>{f(M.point).length?v=!0:v&&(v=!1,l.call(this,new Li(h,this,M.originalEvent)))},mouseout:M=>{v&&(v=!1,l.call(this,new Li(h,this,M.originalEvent)))}}}}{const v=w=>{const E=f(w.point);E.length&&(w.features=E,l.call(this,w),delete w.features)};return{listener:l,targets:n,delegates:{[h]:v}}}}on(h,n,l){if(typeof n=="function"||l===void 0)return super.on(h,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const f=this._createDelegatedListener(h,n,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(f);for(const v in f.delegates)this.on(v,f.delegates[v]);return this}once(h,n,l){if(typeof n=="function"||l===void 0)return super.once(h,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const f=this._createDelegatedListener(h,n,l);for(const v in f.delegates)this.once(v,f.delegates[v]);return this}off(h,n,l){if(typeof n=="function"||l===void 0)return super.off(h,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const f=this._delegatedListeners?this._delegatedListeners[h]:void 0;return f&&(v=>{for(let w=0;w<v.length;w++){const E=v[w];if(E.listener===l&&vm(E.targets,n)){for(const M in E.delegates)this.off(M,E.delegates[M]);return v.splice(w,1),this}}})(f),this}queryRenderedFeatures(h,n){if(!this.style)return[];if(h===void 0||h instanceof i.P||Array.isArray(h)||n!==void 0||(n=h,h=void 0),h=h||[[0,0],[this.transform.width,this.transform.height]],!n){const w=this.style.queryRenderedFeatures(h,void 0,this.transform),E=this.style.queryRenderedFeatureset(h,void 0,this.transform);return w.concat(E)}let l=!0;if(n.target&&(l=this._isTargetValid(n.target),l&&!n.layers))return this.style.queryRenderedFeatureset(h,n,this.transform);let f=!0;if(n.layers&&Array.isArray(n.layers)){for(const w of n.layers)if(!this._isValidId(w)){f=!1;break}if(f&&!n.target)return this.style.queryRenderedFeatures(h,n,this.transform)}let v=[];return f&&(v=v.concat(this.style.queryRenderedFeatures(h,n,this.transform))),l&&(v=v.concat(this.style.queryRenderedFeatureset(h,n,this.transform))),v}querySourceFeatures(h,n){return!h||typeof h=="string"&&!this._isValidId(h)?[]:this.style.querySourceFeatures(h,n)}queryRasterValue(h,n,l){return this._isValidId(h)?this.style.queryRasterValue(h,n,l):Promise.resolve(null)}isPointOnSurface(h){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&i.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(h))}addInteraction(h,n){return this._interactions.add(h,n),this}removeInteraction(h){return this._interactions.remove(h),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(h){return this._cooperativeGestures=h,this}setStyle(h,n){return n=Object.assign({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&h&&n.diff!==!1&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(h,((l,f)=>{if(l){const v=typeof l=="string"?l:l instanceof Error?l.message:l.error;i.w(`Unable to perform style diff: ${v}. Rebuilding the style from scratch.`),this._updateStyle(h,n)}else f&&this._update(!0)}),(()=>this._postStyleLoadEvent())),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(h,n))}_getUIString(h){const n=this._locale[h];if(n==null)throw new Error(`Missing UI string '${h}'`);return n}_updateStyle(h,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h){const l=Object.assign({},n);n&&n.config&&(l.initialConfig=n.config,delete l.config),this.style=new gl(this,l).load(h),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new gl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(h){return h==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.dq(h)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${h}".`))),!1)}_isTargetValid(h){return"featuresetId"in h?this._isValidId("importId"in h?h.importId:h.featuresetId):"layerId"in h&&this._isValidId(h.layerId)}_areTargetsValid(h){if(Array.isArray(h)){for(const n of h)if(!this._isValidId(n))return!1;return!0}return this._isTargetValid(h)}addSource(h,n){return this._isValidId(h)?(this._lazyInitEmptyStyle(),this.style.addSource(h,n),this._update(!0)):this}isSourceLoaded(h){return!!this._isValidId(h)&&!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(h,n,l){this._lazyInitEmptyStyle(),this.style.addSourceType(h,n,l)}removeSource(h){return this._isValidId(h)?(this.style.removeSource(h),this._updateTerrain(),this._update(!0)):this}getSource(h){return this._isValidId(h)?this.style.getOwnSource(h):null}addImage(h,n,{pixelRatio:l=1,sdf:f=!1,stretchX:v,stretchY:w,content:E}={}){this._lazyInitEmptyStyle();const M=i.I.from(h);if(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:D,height:B,data:j}=i.o.getImageData(n);this.style.addImage(M,{data:new i.q({width:D,height:B},j),pixelRatio:l,stretchX:v,stretchY:w,content:E,sdf:f,version:0,usvg:!1})}else if(n.width===void 0||n.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:B}=n,j=n;this.style.addImage(M,{data:new i.q({width:D,height:B},new Uint8Array(j.data)),pixelRatio:l,stretchX:v,stretchY:w,content:E,sdf:f,usvg:!1,version:0,userImage:j}),j.onAdd&&j.onAdd(this,h)}}updateImage(h,n){this._lazyInitEmptyStyle();const l=i.I.from(h),f=this.style.getImage(l);if(!f)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?i.o.getImageData(n):n,{width:w,height:E,data:M}=v;if(w===void 0||E===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==(f.usvg?f.icon.usvg_tree.width:f.data.width)||E!==(f.usvg?f.icon.usvg_tree.height:f.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${w}, ${E})
                must be that same as the previous version of the image
                (${f.data.width}, ${f.data.height})`)));const D=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);let B=!1;f.usvg?(f.data=new i.q({width:w,height:E},new Uint8Array(M)),f.usvg=!1,f.icon=void 0,B=!0):f.data.replace(M,D),this.style.updateImage(l,f,B)}hasImage(h){return h?!!this.style&&!!this.style.getImage(i.I.from(h)):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(i.I.from(h))}loadImage(h,n){i.n(this._requestManager.transformRequest(h,i.R.Image),((l,f)=>{n(l,f instanceof HTMLImageElement?i.o.getImageData(f):f)}))}listImages(){return this.style.listImages().map((h=>h.name))}addModel(h,n){this._lazyInitEmptyStyle(),this.style.addModel(h,n)}hasModel(h){return h?this.style.hasModel(h):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(h){this.style.removeModel(h)}listModels(){return this.style.listModels()}addLayer(h,n){return this._isValidId(h.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(h,n),this._update(!0)):this}getSlot(h){const n=this.getLayer(h);return n&&n.slot||null}setSlot(h,n){return this.style.setSlot(h,n),this.style.mergeLayers(),this._update(!0)}addImport(h,n){return this.style.addImport(h,n).catch((l=>this.fire(new i.y(new Error("Failed to add import",l))))),this}updateImport(h,n){return typeof n!="string"&&n.id!==h?(this.removeImport(h),this.addImport(n)):(this.style.updateImport(h,n),this._update(!0))}removeImport(h){return this.style.removeImport(h),this}moveImport(h,n){return this.style.moveImport(h,n),this._update(!0)}moveLayer(h,n){return this._isValidId(h)?(this.style.moveLayer(h,n),this._update(!0)):this}removeLayer(h){return this._isValidId(h)?(this.style.removeLayer(h),this._update(!0)):this}getLayer(h){if(!this._isValidId(h))return null;const n=this.style.getOwnLayer(h);return n?n.type==="custom"?n.implementation:n.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(h,n,l){return this._isValidId(h)?(this.style.setLayerZoomRange(h,n,l),this._update(!0)):this}setFilter(h,n,l={}){return this._isValidId(h)?(this.style.setFilter(h,n,l),this._update(!0)):this}getFilter(h){return this._isValidId(h)?this.style.getFilter(h):null}setPaintProperty(h,n,l,f={}){return this._isValidId(h)?(this.style.setPaintProperty(h,n,l,f),this._update(!0)):this}getPaintProperty(h,n){return this._isValidId(h)?this.style.getPaintProperty(h,n):null}setLayoutProperty(h,n,l,f={}){return this._isValidId(h)?(this.style.setLayoutProperty(h,n,l,f),this._update(!0)):this}getLayoutProperty(h,n){return this._isValidId(h)?this.style.getLayoutProperty(h,n):null}setLayerProperty(h,n,l,f={}){return this._isValidId(h)?(this.style.setLayerProperty(h,n,l,f),this._update(!0)):this}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(h){return this.style.setGlyphsUrl(h),this._update(!0)}getSchema(h){return this.style.getSchema(h)}setSchema(h,n){return this.style.setSchema(h,n),this._update(!0)}getConfig(h){return this.style.getConfig(h)}setConfig(h,n){return this.style.setConfig(h,n),this._update(!0)}getConfigProperty(h,n){return this.style.getConfigProperty(h,n)}setConfigProperty(h,n,l){return this.style.setConfigProperty(h,n,l),this._update(!0)}getFeaturesetDescriptors(h){return this.style.getFeaturesetDescriptors(h)}setLights(h){if(this._lazyInitEmptyStyle(),h&&h.length===1&&h[0].type==="flat"){const n=h[0];n.properties?this.style.setFlatLight(n.properties,n.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(h),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const h=this.style.getLights()||[];return h.length===0&&h.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),h}setLight(h,n={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:h}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(h){return this._lazyInitEmptyStyle(),this.style.setSnow(h),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(h){return this._lazyInitEmptyStyle(),this.style.setRain(h),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(h){return this._lazyInitEmptyStyle(),this.style.setColorTheme(h),this._update(!0)}setImportColorTheme(h,n){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(h,n),this._update(!0)}setCamera(h){return this.style.setCamera(h),this._triggerCameraUpdate(h)}_triggerCameraUpdate(h){return this._update(this.transform.setOrthographicProjectionAtLowPitch(h["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.aS.convert(h),this.transform):0}setFeatureState(h,n){return h.source&&!this._isValidId(h.source)?this:(this.style.setFeatureState(h,n),this._update())}removeFeatureState(h,n){return h.source&&!this._isValidId(h.source)?this:(this.style.removeFeatureState(h,n),this._update())}getFeatureState(h){return h.source&&!this._isValidId(h.source)?null:this.style.getFeatureState(h)}_selectIndoorFloor(h){this.indoor.selectFloor(h)}_setIndoorActiveFloorsVisibility(h){this.indoor.setActiveFloorsVisibility(h)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new Xs),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let l,f,v,w=this._container;for(;w&&(!f||!v);){const E=window.getComputedStyle(w).transform;E&&E!=="none"&&(l=E.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(f=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(v=l[3])),w=w.parentElement}this._containerWidth=f?Math.abs(h/f):h,this._containerHeight=v?Math.abs(n/v):n}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupIndoor(){this.style.isIndoorEnabled()&&(this.indoor=new ad(this.style),this.on("load",(()=>{this._addIndoorControl(),this.indoor._updateUI(this.transform.zoom,this.transform.center,this.transform.getBounds()),this.on("move",(()=>{this.indoor._updateUI(this.transform.zoom,this.transform.center,this.transform.getBounds())})),this.on("idle",(()=>{this.indoor._updateUI(this.transform.zoom,this.transform.center,this.transform.getBounds())}))})))}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=Z("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=Z("div","mapboxgl-canvas-container",h);this._canvas=Z("canvas","mapboxgl-canvas",n),this._interactive&&(n.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=Z("div","mapboxgl-control-container",h),f=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach((v=>{f[v]=Z("div",`mapboxgl-ctrl-${v}`,l)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,n){const l=i.o.devicePixelRatio||1;this._canvas.width=l*Math.ceil(h),this._canvas.height=l*Math.ceil(n),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${n}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const n=this._markers.indexOf(h);n!==-1&&this._markers.splice(n,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const n=this._popups.indexOf(h);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const h=Object.assign({},H.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",h);n?(Un(n,!0),this.painter=new Gl(n,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",(l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),i.k.testSupport(n)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let n;this.fire(new i.z("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,f=i.o.now(),v=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=v.createQuery(),v.beginQuery(l.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const B=this.transform.zoom,j=this.transform.pitch,q=i.o.now(),U=new i.ac(B,{now:q,fadeDuration:w,pitch:j,transition:this.style.transition,worldview:this._worldview});this.style.update(U)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(f),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(f);const M=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),M&&(this._placementDirty=M.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,z.mark(R.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const B=i.o.now()-f;v.endQuery(l.TIME_ELAPSED_EXT),setTimeout((()=>{const j=v.getQueryParameter(n,v.QUERY_RESULT)/1e6;v.deleteQuery(n),this.fire(new i.z("gpu-timing-frame",{cpuTime:B,gpuTime:j}))}),50)}if(this.listens("gpu-timing-layer")){const B=this.painter.collectGpuTimers();setTimeout((()=>{const j=this.painter.queryGpuTimers(B);this.fire(new i.z("gpu-timing-layer",{layerTimes:j}))}),50)}if(this.listens("gpu-timing-deferred-render")){const B=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const j=this.painter.queryGpuTimeDeferredRender(B);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:j}))}),50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(D||this._repaint)this.triggerRepaint();else{const B=this.idle();if(B&&(E=this._updateAverageElevation(f,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),B&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const j=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:j})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,z.mark(R.fullLoad),this._performanceMetricsCollection&&Br(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const n of this._markers)h&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!h||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(h,n=!1){const l=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const f=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(f||(n||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const v=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=h;const E=Math.abs(v-w);if(E>1){if(this._isInitialLoad||f)return this._averageElevation.jumpTo(w),l(w);this._averageElevation.easeTo(w,h,300)}else if(E>1e-4)return this._averageElevation.jumpTo(w),l(w)}return!!this._averageElevation.isEasing(h)&&l(this._averageElevation.getValue(h))}_authenticate(){Vn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(h=>{if(h&&(h.message===nr||h.status===401)){const n=this.painter.context.gl;Un(n,!1),this._logoControl instanceof fh&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),Vt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&ar(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_postStyleWithAppearanceEvent(){this.style.globalId&&this.style.hasAppearances()&&xr(this._requestManager._customAccessToken)}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const l=this.painter.context.gl,f=l.createFramebuffer();function v(w){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,w,0);const E=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,E),E}return l.bindFramebuffer(l.FRAMEBUFFER,f),this._canvasPixelComparison(v(h),n.canvasCopies.map(v),n.timeStamps)}_canvasPixelComparison(h,n,l){let f=l[1]-l[0];const v=h.length/4;for(let w=0;w<n.length;w++){const E=n[w];let M=0;for(let D=0;D<E.length;D+=4)E[D]===h[D]&&E[D+1]===h[D+1]&&E[D+2]===h[D+2]&&E[D+3]===h[D+3]&&(M+=1);f+=(l[w+2]-l[w+1])*(1-M/v)}return f}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor&&this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Yr.delete(this.painter.context.gl),hn.remove(),_t.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=i.o.frame((n=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(n)})))}_preloadTiles(h){const n=this.style?this.style.getSourceCaches():[];return i.bv(n,((l,f)=>l._preloadTiles(h,f)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(h){this._showParseStatus!==h&&(this._showParseStatus=h,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(h){this._showLayers2DWireframe!==h&&(this._showLayers2DWireframe=h,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(h){this._showLayers3DWireframe!==h&&(this._showLayers3DWireframe=h,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,this._tp.refreshUI(),h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,this._tp.refreshUI(),h&&this._update())}_setCacheLimits(h,n){i.f3(h,n)}get version(){return C}},NavigationControl:class{constructor(h={}){this.options=Object.assign({},xm,h),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this.options.showZoom&&(i.aX(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(n=>{this._map&&this._map.zoomIn({},{originalEvent:n})})),Z("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(n=>{this._map&&this._map.zoomOut({},{originalEvent:n})})),Z("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aX(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(n=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:n}):l.resetNorth({},{originalEvent:n}))})),this._compassIcon=Z("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const n=h.getZoom(),l=n===h.getMaxZoom(),f=n===h.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=n)}))}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gf(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,n){const l=Z("button",h,this._container);return l.type="button",l.addEventListener("click",n),l}_setButtonTitle(h,n){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${n}`);h.setAttribute("aria-label",l),h.firstElementChild&&h.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends i.E{constructor(h={}){super();const n=navigator.geolocation;this.options=Object.assign({geolocation:n},wl,h),i.aX(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Uu(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const n=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,h(l)};this._supportsGeolocation!==void 0?h(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then((l=>n(l.state!=="denied"))).catch((()=>n())):n()}_isOutOfMapMaxBounds(h){const n=this._map.getMaxBounds(),l=h.coords;return!!n&&(l.longitude<n.getWest()||l.longitude>n.getEast()||l.latitude<n.getSouth()||l.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",Object.assign({coords:h.coords,timestamp:h.timestamp},h.toJSON?{toJSON:h.toJSON.bind(h)}:{}))),this._finish()}}_updateCamera(h){const n=new i.aS(h.coords.longitude,h.coords.latitude),l=h.coords.accuracy,f=this._map.getBearing(),v=Object.assign({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(l),v,{geolocateSource:!0})}_updateMarker(h){if(h){const n=new i.aS(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,n=i.ce(1,h._center.lat)*h.worldSize,l=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this._geolocateButton=Z("button","mapboxgl-ctrl-geolocate",this._container),Z("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z("div","mapboxgl-user-location"),this._dotElement.appendChild(Z("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Z("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new qu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Z("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))}))}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((n=>{n==="granted"&&h()})).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:wd,ScaleControl:class{constructor(h={}){this.options=Object.assign({},Sg,h),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),i.aX(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,n=this._map,l=n._containerHeight/2,f=n._containerWidth/2-h/2,v=n.unproject([f,l]),w=n.unproject([f+h,l]),E=v.distanceTo(w);if(this.options.unit==="imperial"){const M=3.2808*E;M>5280?this._setScale(h,M/5280,"mile"):this._setScale(h,M,"foot")}else this.options.unit==="nautical"?this._setScale(h,E/1852,"nautical-mile"):E>=1e3?this._setScale(h,E/1e3,"kilometer"):this._setScale(h,E,"meter")}_setScale(h,n,l){this._map._requestDomTask((()=>{const f=(function(w){const E=Math.pow(10,`${Math.floor(w)}`.length-1);let M=w/E;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:(function(D){const B=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*B)/B})(M),E*M})(n),v=f/n;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(f):`${f}&nbsp;${wc[l]}`,this._container.style.width=h*v+"px"}))}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=Z("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h={}){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:i.w("Full screen control 'container' must be a DOM element.")),i.aX(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=Z("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Z("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:Xs,Popup:class extends i.E{constructor(h){super(),this.options=Object.assign(Object.create(Ki),h),this._altitude=this.options.altitude,i.aX(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=i.aS.convert(h),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(h){return this._altitude=h,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const n=document.createDocumentFragment(),l=document.createElement("body");let f;for(l.innerHTML=h;f=l.firstChild,f;)n.appendChild(f);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=Z("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(h),this.options.closeButton){const l=this._closeButton=Z("button","mapboxgl-popup-close-button",n);l.type="button",l.setAttribute("aria-label","Close popup"),l.innerHTML='<span aria-hidden="true">&#215;</span>',l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let n;return this._classList.delete(h)?n=!1:(this._classList.add(h),n=!0),this._updateClassList(),n}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const n=this._map,l=this._container,f=this._pos;if(!n||!l||!f)return"bottom";const v=l.offsetWidth,w=l.offsetHeight,E=f.x<v/2,M=f.x>n.transform.width-v/2;if(f.y+h<w)return E?"top-left":M?"top-right":"top";if(f.y>n.transform.height-w){if(E)return"bottom-left";if(M)return"bottom-right"}return E?"left":M?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),h.className=n.join(" ")}_update(h){const n=this._map,l=this._content;if(!n||!this._lngLat&&!this._trackPointer||!l)return;let f=this._container;if(f||(f=this._container=Z("div","mapboxgl-popup",n.getContainer()),this._tip=Z("div","mapboxgl-popup-tip",f),f.appendChild(l)),this.options.maxWidth&&f.style.maxWidth!==this.options.maxWidth&&(f.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=yu(this._lngLat,this._pos,n.transform)),!this._trackPointer||h){const v=this._pos=this._trackPointer&&h instanceof i.P?h:n.project(this._lngLat,this._altitude),w=as(this.options.offset),E=this._anchor=this._getAnchor(w.y),M=as(this.options.offset,E),D=v.add(M).round();n._requestDomTask((()=>{this._container&&E&&(this._container.style.transform=`${bc[E]} translate(${D.x}px,${D.y}px)`)}))}if(!this._marker&&n._showingGlobe()){const v=i.f4(n.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(ha);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:qu,Style:gl,LngLat:i.aS,LngLatBounds:i.aI,Point:i.P,MercatorCoordinate:i.ae,FreeCameraOptions:la,Evented:i.E,config:i.e,prewarm:i.f8,clearPrewarmedResources:i.f7,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(h){i.e.ACCESS_TOKEN=h},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(h){i.e.API_URL=h},get workerCount(){return i.fh.workerCount},set workerCount(h){i.fh.workerCount=h},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){i.e.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){i.fg(h)},get workerUrl(){return i.ff.workerUrl},set workerUrl(h){i.ff.workerUrl=h},get workerClass(){return i.ff.workerClass},set workerClass(h){i.ff.workerClass=h},get workerParams(){return i.ff.workerParams},set workerParams(h){i.ff.workerParams=h},get dracoUrl(){return i.fe()},set dracoUrl(h){i.fd(h)},get meshoptUrl(){return i.fc()},set meshoptUrl(h){i.fb(h)},setNow:i.o.setNow,restoreNow:i.o.restoreNow}}));var x=p;return x}))})(_w)),_w.exports}var cEe=lEe();const I0=hx(cEe);I0.accessToken="pk.eyJ1IjoiamVubmVmZXI4ODgiLCJhIjoiY21oYWp6aDI0MXU4ZTJrb2VnMHkyaDNmbiJ9.pbbLJheEB2crbr8nG45hfw";function uEe({locations:e=[]}){const r=ge.useRef(null),a=ge.useRef(null);return ge.useEffect(()=>{if(!r.current||!e.length||a.current)return;const u=new I0.Map({container:r.current,style:"mapbox://styles/mapbox/light-v11",center:e[0]?.coordinates||[-96,37.8],zoom:5,scrollZoom:!1});a.current=u;const p=new I0.LngLatBounds;return e.forEach(y=>{const x=document.createElement("div");x.className="marker",new I0.Marker({element:x,anchor:"bottom"}).setLngLat(y.coordinates).addTo(u),new I0.Popup({offset:30}).setLngLat(y.coordinates).setHTML(`<p>Day ${y.day}: ${y.description}</p>`).addTo(u),p.extend(y.coordinates)}),u.on("load",()=>{u.addSource("route",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:e.map(y=>y.coordinates)}}}),u.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#55c57a","line-width":3}}),u.flyTo({center:e[0]?.coordinates,zoom:8,speed:.8,curve:1.2,essential:!0}),setTimeout(()=>{u.fitBounds(p,{padding:{top:200,bottom:100,left:100,right:100},duration:2e3})},2e3)}),()=>{u.remove(),a.current=null}},[e]),X.jsx("div",{ref:r,id:"map",style:{width:"100%",height:"500px",borderRadius:"10px",overflow:"hidden"}})}function dEe({review:e}){if(!e||!e.user)return null;const r=Ih("yellow.400","yellow.300"),a=Ih("gray.700","gray.200"),{isOpen:u,onOpen:p,onClose:y}=JW(),x=Hm(Mn);return X.jsxs(X.Fragment,{children:[X.jsx(x,{whileHover:{backgroundColor:Ih("#f9fafb","#1a202c")},borderRadius:"md",py:4,px:2,cursor:"pointer",onClick:p,transition:"0.2s",children:X.jsxs(Fi,{w:"100%",justify:"space-between",spacing:6,children:[X.jsxs(Fi,{spacing:4,flex:"1",children:[X.jsx(Ny,{src:`/img/users/${e.user.photo}`,name:e.user.name,size:"md"}),X.jsxs(Wo,{align:"flex-start",spacing:0,children:[X.jsx(zr,{fontWeight:"bold",children:e.user.name}),X.jsx(zr,{fontSize:"sm",color:"gray.500",children:new Date(e.createdAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),X.jsx(zr,{fontSize:"md",color:a,lineHeight:"1.6",ml:6,flex:"1",noOfLines:1,children:e.review})]}),X.jsx(Fi,{spacing:1,minW:"120px",justify:"flex-end",children:[1,2,3,4,5].map(i=>X.jsx(mo,{as:Op,color:e.rating>=i?r:"gray.300",fill:e.rating>=i?r:"none",boxSize:5},i))})]})}),X.jsx(s_,{}),X.jsxs(f_,{isOpen:u,onClose:y,size:"lg",isCentered:!0,children:[X.jsx(y_,{}),X.jsxs(p_,{borderRadius:"2xl",overflow:"hidden",bg:Ih("white","gray.800"),shadow:"2xl",children:[X.jsxs(__,{bg:"whiteAlpha.200",color:"black",py:4,fontSize:"xl",borderTopLeftRadius:"2xl",borderTopRightRadius:"2xl",shadow:"sm",children:["Review by ",e.user.name]}),X.jsx(g_,{color:"white"}),X.jsxs(m_,{p:6,children:[X.jsxs(Fi,{align:"center",spacing:4,mb:4,children:[X.jsx(Ny,{src:`/img/users/${e.user.photo}`,name:e.user.name,size:"lg"}),X.jsxs(Wo,{align:"flex-start",spacing:0,children:[X.jsx(zr,{fontWeight:"bold",fontSize:"lg",children:e.user.name}),X.jsx(zr,{fontSize:"sm",color:"gray.500",children:new Date(e.createdAt).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),X.jsx(Fi,{spacing:1,ml:"auto",children:[1,2,3,4,5].map(i=>X.jsx(mo,{as:Op,color:e.rating>=i?r:"gray.300",fill:e.rating>=i?r:"none",boxSize:5},i))})]}),X.jsx(zr,{fontSize:"md",color:a,lineHeight:"1.8",children:e.review}),X.jsx(Mn,{mt:6,textAlign:"right",children:X.jsx(wo,{onClick:y,colorScheme:"teal",size:"sm",children:"Close"})})]})]})]})]})}const hEe=async e=>(await Ni.post("/reviews",e)).data.data.review,fEe=async()=>(await Ni.get("/reviews")).data.data.reviews,pEe=async(e,r)=>(await Ni.patch(`/reviews/${e}`,r)).data.data.review,mEe=async e=>Ni.delete(`/reviews/${e}`),gEe=async e=>(await Ni.get(`/tours/${e}/reviews`)).data.data.doc,_Ee=qy(mx(RD((e,r)=>({reviews:[],currentReview:null,loading:!1,error:null,setCurrentReview:a=>e({currentReview:a}),fetchReviews:async()=>{e({loading:!0});try{const a=await fEe();e({reviews:a||[],loading:!1})}catch(a){e({error:a.message,loading:!1})}},fetchReviewsByTour:async a=>{e({loading:!0});try{const u=await gEe(a);e({reviews:u||[],loading:!1})}catch(u){e({error:u.message,reviews:[],loading:!1})}},createReview:async a=>{const u=await hEe(a);e({reviews:[...r().reviews,u.data.review]})},updateReview:async(a,u)=>{const y=(await pEe(a,u)).data.review;e({reviews:r().reviews.map(x=>x._id===a?y:x),currentReview:y})},deleteReview:async a=>{await mEe(a),e({reviews:r().reviews.filter(u=>u._id!==a)})}}),{name:"review-storage",getStorage:()=>localStorage}))),yEe=()=>{const{reviews:e,currentReview:r,loading:a,error:u,fetchReviews:p,fetchReviewsByTour:y,createReview:x,updateReview:i,deleteReview:C,setCurrentReview:R}=_Ee();return{reviews:Array.isArray(e)?e:[],currentReview:r,loading:a,error:u,fetchReviews:p,fetchReviewsByTour:y,createReview:x,updateReview:i,deleteReview:C,setCurrentReview:R}};function vEe(){const{slug:e}=HQ();ge.useEffect(()=>{window.scrollTo(0,0)},[]);const{tour:r,tours:a,fetchTourBySlug:u,setCurrentTour:p,loading:y}=Dx(),{isLoggedIn:x}=_S(),i=kp(),{reviews:C,fetchReviewsByTour:R,loading:z}=yEe(),[F,V]=ge.useState(null),[G,H]=ge.useState(!1),Z=ge.useRef(null),J=Ih("gray.50","gray.900"),se=Ih("white","gray.800"),pe=Ih("gray.700","gray.200"),ve=Ih("gray.200","gray.700");if(ge.useEffect(()=>{const _e=setInterval(()=>{if(Z.current){const Re=new IntersectionObserver(([ke])=>{ke.isIntersecting&&(H(!0),Re.disconnect(),clearInterval(_e))},{rootMargin:"400px 0px",threshold:.01});Re.observe(Z.current)}},160);return()=>clearInterval(_e)},[]),ge.useEffect(()=>{if(!e||a.length===0)return;const _e=a.find(Re=>Re.slug===e);if(_e){p(_e),R(_e._id);return}u(e).then(Re=>{Re?._id&&R(Re._id)})},[e,a]),y||z)return X.jsxs(Wo,{py:20,children:[X.jsx(Ky,{size:"xl",color:"teal.400"}),X.jsx(zr,{children:"Loading tour details..."})]});if(!r)return X.jsx(zr,{textAlign:"center",children:"Tour not found."});const Ne=({icon:_e,color:Re,title:ke,value:ze})=>X.jsx(Mn,{bg:se,boxShadow:"sm",borderRadius:"lg",p:6,textAlign:"center",border:`1px solid ${ve}`,children:X.jsxs(Wo,{spacing:3,children:[X.jsx(Mn,{bg:`${Re}.100`,color:`${Re}.500`,w:10,h:10,borderRadius:"full",display:"flex",alignItems:"center",justifyContent:"center",children:X.jsx(mo,{as:_e,boxSize:5})}),X.jsx(zr,{fontWeight:"semibold",color:"gray.600",children:ke}),X.jsx(zr,{fontWeight:"bold",fontSize:"lg",children:ze})]})});return X.jsxs(Mn,{bg:J,children:[X.jsxs(Mn,{position:"relative",h:["300px","400px","500px"],children:[X.jsx($m,{src:r.imageCover,alt:r.name,fallbackSrc:c_,w:"100%",h:"100%",objectFit:"cover",filter:"brightness(60%)"}),X.jsxs(Wo,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",color:"white",spacing:3,children:[X.jsx(ko,{size:"2xl",children:r.name}),X.jsxs(Fi,{spacing:6,fontWeight:"medium",children:[X.jsxs(Fi,{children:[X.jsx(tE,{}),X.jsxs(zr,{children:[r.duration," days"]})]}),X.jsxs(Fi,{children:[X.jsx(zH,{}),X.jsx(zr,{children:r.startLocation?.description})]})]})]})]}),X.jsx(Ad,{maxW:"7xl",py:12,children:X.jsxs(h_,{templateColumns:["1fr",null,"2fr 1fr"],gap:10,children:[X.jsxs(Ch,{children:[X.jsxs(Mn,{bg:se,boxShadow:"sm",borderRadius:"lg",p:8,mb:8,children:[X.jsx(ko,{fontSize:"xl",mb:3,children:"About This Tour"}),X.jsx(zr,{color:pe,fontSize:"md",children:r.summary})]}),X.jsxs(Mh,{columns:[1,3],spacing:6,mb:8,children:[X.jsx(Ne,{icon:tE,color:"blue",title:"Duration",value:`${r.duration} Days`}),X.jsx(Ne,{icon:FH,color:"green",title:"Group Size",value:`Max ${r.maxGroupSize}`}),X.jsx(Ne,{icon:Op,color:"purple",title:"Difficulty",value:r.difficulty})]}),X.jsxs(Mn,{bg:se,boxShadow:"sm",borderRadius:"lg",p:8,mb:8,children:[X.jsx(ko,{fontSize:"xl",mb:4,children:"Tour Highlights"}),X.jsx(Mh,{columns:[1,2],spacing:3,children:["Inca Trail","High mountain passes","Machu Picchu sunrise","Andean food"].map((_e,Re)=>X.jsxs(Fi,{bg:"gray.50",borderRadius:"md",p:3,spacing:3,children:[X.jsx(Mn,{bg:"green.100",color:"green.500",w:6,h:6,borderRadius:"full",display:"flex",alignItems:"center",justifyContent:"center",children:X.jsx(mo,{as:eE})}),X.jsx(zr,{color:pe,children:_e})]},Re))})]}),X.jsxs(Mn,{bg:se,boxShadow:"sm",borderRadius:"lg",p:8,mb:8,children:[X.jsx(ko,{fontSize:"xl",mb:4,children:"Your Guides"}),X.jsx(Ax,{spacing:4,children:r.guides?.map(_e=>X.jsxs(Fi,{children:[X.jsx(Ny,{src:`/img/users/${_e.photo}`,name:_e.name}),X.jsxs(Wo,{align:"flex-start",spacing:0,children:[X.jsx(zr,{fontWeight:"bold",children:_e.name}),X.jsx(zr,{fontSize:"sm",color:"gray.500",children:_e.role==="lead-guide"?"Lead Guide":"Tour Guide"})]})]},_e._id))})]}),X.jsx(Mh,{columns:[1,2,3],spacing:4,mb:8,children:r.images?.map((_e,Re)=>X.jsx($m,{src:_e,alt:`${r.name}-${Re}`,fallbackSrc:c_,w:"100%",h:"210px",objectFit:"cover",borderRadius:"lg",shadow:"md"},_e))}),X.jsxs(Mn,{bg:se,boxShadow:"sm",borderRadius:"lg",p:8,mb:8,children:[X.jsx(ko,{fontSize:"xl",mb:4,children:"Tour Location"}),X.jsx(Mn,{ref:Z,maxH:"500px",w:"100%",children:G?X.jsxs(X.Fragment,{children:[console.log(" Rendering <MapBox> now..."),X.jsx(uEe,{locations:r.locations})]}):X.jsxs(X.Fragment,{children:[console.log(" Map NOT rendered yet  waiting for intersection..."),X.jsx(Mn,{h:"100%",w:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"gray.400",children:"Loading map"})]})})]}),X.jsxs(Mn,{bg:se,boxShadow:"sm",borderRadius:"lg",p:8,children:[X.jsxs(Fi,{justify:"space-between",mb:4,children:[X.jsxs(Fi,{children:[X.jsx(mo,{as:yve,color:"gray.700",boxSize:5}),X.jsxs(zr,{fontWeight:"bold",fontSize:"lg",children:["Reviews (",C.length,")"]})]}),X.jsxs(Fi,{children:[X.jsx(mo,{as:Op,color:"yellow.400",boxSize:5}),X.jsx(zr,{fontSize:"xl",fontWeight:"bold",children:r.ratingsAverage?.toFixed(1)||"4.9"}),X.jsx(zr,{color:"gray.500",children:"/ 5"})]})]}),C.length?C.map(_e=>X.jsx(dEe,{review:_e},_e._id)):X.jsx(zr,{color:"gray.500",children:"No reviews yet for this tour."})]})]}),X.jsx(Ch,{children:X.jsxs(Mn,{position:"sticky",top:"100px",bg:se,borderRadius:"lg",boxShadow:"sm",p:8,children:[X.jsxs(zr,{fontSize:"3xl",fontWeight:"bold",children:["$",r.price," ",X.jsx(zr,{as:"span",fontWeight:"medium",color:"gray.500",fontSize:"lg",children:"/ person"})]}),X.jsx(zr,{mt:6,fontWeight:"semibold",children:"Select Start Date"}),X.jsx(Wo,{mt:4,spacing:3,align:"stretch",children:r.startDates?.map(_e=>{const Re=new Date(_e).toLocaleDateString("en-US",{weekday:"short",month:"long",day:"numeric",year:"numeric"}),ke=F===_e;return X.jsx(wo,{bg:ke?"black":"white",color:ke?"white":"gray.800",border:"1px solid",borderColor:"gray.200",justifyContent:"space-between",rightIcon:ke?X.jsx(mo,{as:eE}):null,onClick:()=>V(_e),children:Re},_e)})}),X.jsx(s_,{my:6}),X.jsxs(Fi,{justify:"space-between",mb:2,children:[X.jsx(zr,{color:"gray.600",children:"Duration"}),X.jsxs(zr,{fontWeight:"medium",children:[r.duration," days"]})]}),X.jsxs(Fi,{justify:"space-between",mb:2,children:[X.jsx(zr,{color:"gray.600",children:"Max Group Size"}),X.jsxs(zr,{fontWeight:"medium",children:[r.maxGroupSize," people"]})]}),X.jsxs(Fi,{justify:"space-between",mb:4,children:[X.jsx(zr,{color:"gray.600",children:"Difficulty"}),X.jsx(fS,{colorScheme:"red",px:2,children:r.difficulty})]}),X.jsx(wo,{size:"lg",bg:F?"black":"gray.400",color:"white",w:"100%",isDisabled:!F,_hover:F?{bg:"gray.800"}:{},onClick:async()=>{if(!x){i("/login");return}try{const _e=await oEe(r._id);window.location.href=_e}catch(_e){console.error("Booking error:",_e)}},children:x?F?"Confirm Booking":"Select a Date First":"Login to Book"}),X.jsxs(Wo,{spacing:1,fontSize:"sm",color:"gray.500",mt:4,children:[X.jsxs(Fi,{children:[X.jsx(mo,{as:eE}),X.jsx(zr,{children:"Free cancellation up to 24 hours before"})]}),X.jsxs(Fi,{children:[X.jsx(mo,{as:tE}),X.jsx(zr,{children:"Reserve now, pay later"})]})]})]})})]})})]})}const xEe=async()=>(await Ni.get("/packages")).data.data,bEe=async e=>(await Ni.get(`/packages/${e}`)).data.data,wEe=qy(e=>({packages:[],currentPackage:null,loading:!1,error:null,fetchPackages:async()=>{e({loading:!0});try{const r=await xEe();e({packages:r,loading:!1})}catch(r){e({error:r.message,loading:!1})}},fetchPackageById:async r=>{e({loading:!0});try{const a=await bEe(r);e({currentPackage:a,loading:!1})}catch(a){e({error:a.message,loading:!1})}}}));function SEe(){const{packages:e,fetchPackages:r,loading:a}=wEe(),{countries:u,fetchCountries:p}=Dx(),{isOpen:y,onOpen:x,onClose:i}=JW(),[C,R]=ge.useState(null);ge.useEffect(()=>{r(),p()},[]);const z=pe=>{R(pe),x()},[F,V]=ge.useState(""),[G,H]=ge.useState(""),Z=ge.useMemo(()=>e.filter(pe=>{if(G&&pe.country!==G)return!1;if(F){const ve=F.toLowerCase();if(!pe.title.toLowerCase().includes(ve)&&!pe.description.toLowerCase().includes(ve))return!1}return!0}),[e,F,G]),J=Z.filter(pe=>pe.isFeatured),se=Z.filter(pe=>!pe.isFeatured);return X.jsx(wY,{children:X.jsxs(Mn,{children:[X.jsxs(Mn,{bgImage:"url(/img/package-bg.png)",bgSize:"cover",py:[20,28],color:"white",position:"relative",children:[X.jsx(Ad,{maxW:"7xl",position:"relative",zIndex:2,marginTop:70,children:X.jsxs(Wo,{align:"flex-start",spacing:4,maxW:"3xl",children:[X.jsx(ko,{fontSize:["3xl","5xl"],lineHeight:"1.05",children:"Bundled adventures  curated packages"}),X.jsx(zr,{fontSize:"lg",maxW:"xl",children:"Save more with thoughtfully combined tours. All bundles are generated directly from our best-rated experiences."})]})}),X.jsx(Mn,{position:"absolute",inset:0,bgGradient:"linear(to-b, rgba(0, 0, 0, 0.03), rgba(19, 3, 18, 0.38))"})]}),X.jsxs(Ad,{maxW:"7xl",py:12,children:[X.jsx(Mn,{mb:8,children:X.jsx(yO,{mode:"tours"})}),X.jsxs(Fi,{spacing:4,mb:6,children:[X.jsx(oy,{children:"All Packages"}),X.jsx(oy,{children:"Featured"}),X.jsx(oy,{children:"Budget"}),X.jsx(oy,{children:"Adventure"}),X.jsxs(Mn,{ml:"auto",display:"flex",gap:2,children:[X.jsx(TEe,{setSearch:V}),X.jsx(EEe,{countries:u,setCountryFilter:H})]})]}),J.length>0&&X.jsxs(X.Fragment,{children:[X.jsx(ko,{size:"md",mb:4,children:"Featured Bundles"}),X.jsx(Mh,{columns:[1,2,3],spacing:6,mb:12,children:J.map(pe=>X.jsx(sW,{pkg:pe,onOpen:()=>z(pe)},pe._id))}),X.jsx(s_,{mb:10})]}),X.jsx(ko,{size:"md",mb:4,children:"All Packages"}),a?X.jsx(zr,{children:"Loading packages..."}):se.length===0?X.jsx(zr,{children:"No packages match your filters."}):X.jsx(Mh,{columns:[1,2,3],spacing:6,children:se.map(pe=>X.jsx(sW,{pkg:pe,onOpen:()=>z(pe)},pe._id))})]}),X.jsxs(f_,{isOpen:y,onClose:i,size:"xl",children:[X.jsx(y_,{}),X.jsxs(p_,{children:[X.jsx(__,{children:C?.title}),X.jsx(g_,{}),X.jsx(m_,{children:C&&X.jsxs(h_,{templateColumns:["1fr","1fr 2fr"],gap:6,children:[X.jsxs(Ch,{children:[X.jsx($m,{src:C.imageCover||c_,borderRadius:"md",w:"100%",h:"220px",objectFit:"cover"}),X.jsxs(Fi,{mt:3,spacing:3,children:[X.jsx(fS,{colorScheme:"purple",children:C.country}),X.jsxs(Fi,{spacing:1,children:[X.jsx(mo,{as:Op}),X.jsx(zr,{children:C.ratingAverage?.toFixed(1)})]}),C.tags?.map(pe=>X.jsx(oy,{children:pe},pe))]})]}),X.jsx(Ch,{children:X.jsxs(Wo,{align:"flex-start",spacing:3,children:[X.jsx(zr,{children:C.description}),X.jsxs(Mn,{children:[X.jsx(ko,{size:"sm",children:"Included Tours"}),X.jsx(Wo,{align:"stretch",mt:2,spacing:2,children:(C.includedTours||[]).map(pe=>X.jsxs(Mn,{p:3,borderWidth:1,borderRadius:"md",children:[X.jsxs(Fi,{justify:"space-between",children:[X.jsx(zr,{fontWeight:"semibold",children:pe.name}),X.jsxs(zr,{children:["$",pe.price?.toLocaleString()]})]}),X.jsx(zr,{fontSize:"sm",color:"gray.500",children:pe.summary})]},pe._id))})]}),X.jsx(s_,{}),X.jsxs(Fi,{justify:"space-between",w:"100%",children:[X.jsx(zr,{fontWeight:"bold",children:"Total Price"}),X.jsxs(zr,{fontSize:"xl",fontWeight:"extrabold",children:["$",C.totalPrice?.toLocaleString()]})]}),X.jsxs(Fi,{justify:"space-between",w:"100%",children:[X.jsx(zr,{fontWeight:"bold",children:"Total Days"}),X.jsxs(zr,{children:[C.totalDays," days"]})]})]})})]})}),X.jsxs(Cx,{children:[X.jsx(wo,{colorScheme:"purple",mr:3,children:"Book Package"}),X.jsx(wo,{variant:"ghost",onClick:i,children:"Close"})]})]})]})]})})}function sW({pkg:e,onOpen:r}){return X.jsxs(Mn,{borderWidth:1,borderRadius:"lg",overflow:"hidden",boxShadow:"sm",_hover:{transform:"translateY(-6px)",transition:"0.25s"},children:[X.jsx($m,{src:e.imageCover||c_,w:"100%",h:"220px",objectFit:"cover"}),X.jsxs(Mn,{p:4,children:[X.jsxs(Fi,{justify:"space-between",mb:2,children:[X.jsx(ko,{size:"sm",children:e.title}),X.jsxs(Fi,{children:[X.jsx(mo,{as:Op}),X.jsx(zr,{fontWeight:"semibold",children:e.ratingAverage?.toFixed(1)})]})]}),X.jsx(zr,{color:"gray.600",noOfLines:2,mb:3,children:e.description}),X.jsxs(Fi,{justify:"space-between",align:"end",children:[X.jsxs(Wo,{align:"flex-start",children:[X.jsxs(zr,{fontSize:"sm",children:["Includes ",e.includedTours?.length||0," tours"]}),X.jsxs(zr,{fontWeight:"bold",children:[e.totalDays," days"]})]}),X.jsxs(Wo,{align:"flex-end",children:[X.jsx(zr,{fontSize:"sm",color:"gray.500",children:"Starting from"}),X.jsxs(zr,{fontSize:"lg",fontWeight:"extrabold",children:["$",e.totalPrice?.toLocaleString()]}),X.jsx(wo,{size:"sm",colorScheme:"purple",onClick:r,children:"View"})]})]})]})]})}function TEe({setSearch:e}){return X.jsx(Mn,{children:X.jsx("input",{placeholder:"Search packages...",onChange:r=>e(r.target.value),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #E2E8F0"}})})}function EEe({countries:e=[],setCountryFilter:r}){return X.jsxs("select",{onChange:a=>r(a.target.value),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #E2E8F0"},children:[X.jsx("option",{value:"",children:"All countries"}),e.map(a=>X.jsx("option",{value:a,children:a},a))]})}function PEe(e={}){const{nonce:r,onScriptLoadSuccess:a,onScriptLoadError:u}=e,[p,y]=ge.useState(!1),x=ge.useRef(a);x.current=a;const i=ge.useRef(u);return i.current=u,ge.useEffect(()=>{const C=document.createElement("script");return C.src="https://accounts.google.com/gsi/client",C.async=!0,C.defer=!0,C.nonce=r,C.onload=()=>{var R;y(!0),(R=x.current)===null||R===void 0||R.call(x)},C.onerror=()=>{var R;y(!1),(R=i.current)===null||R===void 0||R.call(i)},document.body.appendChild(C),()=>{document.body.removeChild(C)}},[r]),p}const IEe=ge.createContext(null);function MEe({clientId:e,nonce:r,onScriptLoadSuccess:a,onScriptLoadError:u,children:p}){const y=PEe({nonce:r,onScriptLoadSuccess:a,onScriptLoadError:u}),x=ge.useMemo(()=>({clientId:e,scriptLoadedSuccessfully:y}),[e,y]);return Js.createElement(IEe.Provider,{value:x},p)}const{toast:q1}=Jye({defaultOptions:{position:"bottom-right",duration:3e3,isClosable:!0}}),TY=()=>({showSuccess:(p,y="")=>q1({status:"success",title:p,description:y}),showError:(p,y="")=>q1({status:"error",title:p,description:y}),showWarning:(p,y="")=>q1({status:"warning",title:p,description:y}),showInfo:(p,y="")=>q1({status:"info",title:p,description:y})});function CEe({isOpen:e,onClose:r,mode:a,value:u,setValue:p,code:y,setCode:x,loading:i,isCodeSent:C,onSend:R,onVerify:z}){const F=a==="email"?"Email Address":"Phone Number",V=a==="email"?"Enter your email address and well send a 6-digit login code.":"Enter your mobile number and well send a 6-digit SMS code.",G=a==="email"?`We sent a code to ${u}.`:`We sent an SMS code to ${u}.`;return X.jsxs(f_,{isOpen:e,onClose:r,isCentered:!0,size:"md",children:[X.jsx(y_,{}),X.jsxs(p_,{borderRadius:"2xl",p:4,children:[X.jsx(__,{textAlign:"center",children:C?"Enter Verification Code":`Login via ${a}`}),X.jsx(g_,{}),X.jsx(m_,{children:X.jsx(Wo,{spacing:4,children:C?X.jsxs(X.Fragment,{children:[X.jsx(zr,{fontSize:"sm",color:"gray.600",textAlign:"center",children:G}),X.jsx(El,{placeholder:"6-digit code",size:"lg",maxLength:6,borderRadius:"lg",value:y,onChange:H=>x(H.target.value)}),X.jsx(wo,{colorScheme:"purple",w:"100%",borderRadius:"lg",isLoading:i,onClick:z,children:"Verify & Login"})]}):X.jsxs(X.Fragment,{children:[X.jsx(zr,{fontSize:"sm",color:"gray.600",textAlign:"center",children:V}),X.jsx(El,{placeholder:F,size:"lg",borderRadius:"lg",value:u,onChange:H=>p(H.target.value)}),X.jsx(wo,{colorScheme:"purple",w:"100%",borderRadius:"lg",isLoading:i,onClick:R,children:"Send Code"})]})})})]})]})}function AEe(){const e=kp(),{login:r,signup:a,loading:u,googleLogin:p,initGoogleLoginButton:y,sendEmailCode:x,verifyEmailCode:i,sendSmsOtp:C,verifySmsOtp:R}=_S(),{showSuccess:z,showError:F}=TY(),[V,G]=ge.useState(!0),[H,Z]=ge.useState(!1),[J,se]=ge.useState(1),[pe,ve]=ge.useState(!1),[Ne,_e]=ge.useState("email"),[Re,ke]=ge.useState(""),[ze,et]=ge.useState(""),[ht,Xt]=ge.useState(!1),[Ir,nr]=ge.useState(!1),[Fr,Or]=ge.useState(""),[or,lt]=ge.useState(""),[Et,qt]=ge.useState("");new URLSearchParams(window.location.search).get("success"),ge.useEffect(()=>{if(!V)return;const hr=setTimeout(()=>{y(async xr=>{await p(xr.credential),e("/")})},100);return()=>clearTimeout(hr)},[V]);const Gt=async()=>{try{const hr=await r(Fr,or);z("Login Successful!",`Welcome back, ${hr?.data?.user?.name||"Traveler"}`),setTimeout(()=>e("/"),1200)}catch(hr){F("Login Failed",hr.response?.data?.message||"Invalid credentials")}},tt=()=>{_e("email"),ke(""),et(""),nr(!1),ve(!0)},ct=()=>{_e("sms"),ke(""),et(""),nr(!1),ve(!0)},_t=async()=>{if(!Re){F(Ne==="email"?"Missing Email":"Missing Phone Number",`Please enter your ${Ne==="email"?"email":"phone number"}.`);return}Xt(!0);try{Ne==="email"?await x(Re):await C(Re),nr(!0),z("Code Sent!","Please check your inbox or phone.")}catch(hr){F("Failed",hr?.response?.data?.message||"Unable to send verification code.")}finally{Xt(!1)}},Vt=async()=>{if(!ze){F("Missing Code","Enter the 6-digit code.");return}Xt(!0);try{let hr;Ne==="email"?hr=await i(Re,ze):hr=await R(Re,ze),z("Login Successful",`Welcome back ${hr?.data?.user?.name||"Traveler"}`),ve(!1),e("/")}catch(hr){F("Invalid Code",hr?.response?.data?.message||"Incorrect or expired verification code.")}finally{Xt(!1)}},bt=async()=>{try{await a({name:Et,email:Fr,password:or,passwordConfirm:or}),z("Account created!","Welcome to Voyanix "),setTimeout(()=>e("/"),1200)}catch(hr){F("Signup Failed",hr.response?.data?.message||"Please try again.")}},ar=hr=>{se(xr=>{const sr=hr==="next"?xr+1:xr-1;return sr>3?1:sr<1?3:sr})};return X.jsxs(Ic,{align:"center",justify:"center",p:8,bgImage:"url('/img/login_bg.png')",bgPosition:"center",bgRepeat:"no-repeat",position:"relative",children:[X.jsx(CEe,{isOpen:pe,onClose:()=>ve(!1),mode:Ne,value:Re,setValue:ke,code:ze,setCode:et,loading:ht,isCodeSent:Ir,onSend:_t,onVerify:Vt}),X.jsxs(h_,{templateColumns:["1fr",null,"1fr 1fr"],h:"100vh",w:["95%","90%","80%","70%"],bg:"white",borderRadius:"3xl",overflow:"hidden",my:"4%",boxShadow:"2xl",children:[X.jsx(Ch,{display:"flex",alignItems:"center",justifyContent:"center",p:[6,10],children:X.jsxs(Wo,{spacing:8,align:"stretch",w:"full",maxW:"sm",children:[X.jsxs(Mn,{textAlign:"center",children:[X.jsx(ko,{fontSize:40,fontFamily:"Playfair Display",mb:2,children:"Travel. Explore.Experience"}),X.jsx(zr,{color:"gray.500",fontSize:"sm",children:"Explore More. Experience Life."})]}),X.jsxs(Fi,{justify:"center",bg:Ih("gray.100","gray.700"),borderRadius:"full",p:1.5,children:[X.jsx(wo,{flex:"1",borderRadius:"full",color:V?"white":"blackAlpha.500",colorScheme:V?"purple":"transparent",boxShadow:V?"md":"none",onClick:()=>G(!0),children:"Login"}),X.jsx(wo,{flex:"1",borderRadius:"full",color:V?"blackAlpha.500":"white",colorScheme:V?"transparent":"purple",boxShadow:V?"none":"md",onClick:()=>G(!1),children:"Sign Up"})]}),V?X.jsxs(Wo,{align:"stretch",children:[X.jsx(ko,{size:"md",textAlign:"center",children:"Journey Begins"}),X.jsx(Mn,{w:"100%",children:X.jsx("div",{id:"google-btn"})}),X.jsx(wo,{colorScheme:"gray",variant:"outline",leftIcon:X.jsx(wve,{}),onClick:tt,children:"Send code to Email"}),X.jsx(wo,{colorScheme:"gray",variant:"outline",leftIcon:X.jsx(Tve,{}),onClick:ct,children:"Send code to SMS"}),X.jsxs(Fi,{my:2,children:[X.jsx(s_,{}),X.jsx(zr,{fontSize:"sm",color:"gray.400",children:"or"}),X.jsx(s_,{})]}),X.jsx(El,{placeholder:"Email address",size:"lg",borderRadius:"lg",value:Fr,onChange:hr=>Or(hr.target.value)}),X.jsxs(eD,{size:"lg",children:[X.jsx(El,{placeholder:"Password",type:H?"text":"password",borderRadius:"lg",value:or,onChange:hr=>lt(hr.target.value)}),X.jsx(Lw,{children:X.jsx(T0,{variant:"ghost",icon:H?X.jsx(Xj,{}):X.jsx(Kj,{}),onClick:()=>Z(!H)})})]}),X.jsx(wo,{colorScheme:"purple",size:"lg",borderRadius:"lg",isLoading:u,onClick:Gt,children:"Log In"})]}):X.jsxs(Wo,{align:"stretch",spacing:5,children:[X.jsx(ko,{size:"md",textAlign:"center",children:"Create Your Account"}),X.jsx(El,{placeholder:"Full Name",size:"lg",borderRadius:"lg",value:Et,onChange:hr=>qt(hr.target.value)}),X.jsx(El,{placeholder:"Email address",size:"lg",borderRadius:"lg",value:Fr,onChange:hr=>Or(hr.target.value)}),X.jsxs(eD,{size:"lg",children:[X.jsx(El,{placeholder:"Password",type:H?"text":"password",borderRadius:"lg",value:or,onChange:hr=>lt(hr.target.value)}),X.jsx(Lw,{children:X.jsx(T0,{variant:"ghost",icon:H?X.jsx(Xj,{}):X.jsx(Kj,{}),onClick:()=>Z(!H)})})]}),X.jsx(wo,{colorScheme:"purple",size:"lg",borderRadius:"lg",isLoading:u,onClick:bt,children:"Sign Up"})]})]})}),X.jsxs(Ch,{position:"relative",overflow:"hidden",bg:`url(/img/lbg-${J}.jpg) center/cover no-repeat`,clipPath:"path('M0,0 h100% v100% q-30,0 -60,30 t-60,60 v-100% h-100% z')",children:[X.jsx(Mn,{position:"absolute",top:"6",right:"20",transform:"translateX(15%)",children:X.jsxs(Mn,{bg:"whiteAlpha.900",p:6,borderRadius:"2xl",shadow:"xl",w:"260px",position:"relative",children:[X.jsx(ko,{fontSize:"md",mb:2,children:"Wander, Explore, Experience."}),X.jsx(zr,{fontSize:"sm",color:"gray.600",children:"Discover new places, embrace adventures, & create memorable journeys."}),X.jsx(Mn,{position:"absolute",top:"18%",right:"-15px",transform:"translateY(-50%)",bg:"white",borderRadius:"full",p:"3",shadow:"lg",children:X.jsx(_ve,{color:"red"})})]})}),X.jsxs(Mn,{position:"absolute",bottom:"10",right:"10",color:"white",textAlign:"right",children:[X.jsxs(ko,{fontSize:"xl",mb:3,children:["Escape the Ordinary, ",X.jsx("br",{})," Embrace the Journey"]}),X.jsx(Mn,{bg:"rgba(255,255,255,0.15)",borderRadius:"xl",px:5,py:2,backdropFilter:"blur(10px)",fontSize:"sm",children:"Experience the world your way"})]}),X.jsxs(Fi,{position:"absolute",bottom:"8",left:"8",spacing:4,children:[X.jsx(T0,{icon:X.jsx(pve,{}),variant:"ghost",color:"white",onClick:()=>ar("prev")}),X.jsx(T0,{icon:X.jsx(mve,{}),variant:"ghost",color:"white",onClick:()=>ar("next")})]})]})]})]})}const DEe=qy(mx(e=>({bookings:[],loading:!1,error:null,fetchBookings:async()=>{e({loading:!0,error:null});try{const r=await sEe();e({bookings:r,loading:!1})}catch(r){e({loading:!1,error:r.response?.data?.message||r.message||"Failed to load bookings"})}},clearBookings:()=>{e({bookings:[],loading:!1,error:null})}}),{name:"BookingStore"})),iA=Hm(Mn);function REe(){const e=kp(),[r]=wJ(),a=r.get("tab")||"profile",{user:u,updateProfile:p,updateMyPassword:y,sendPhoneVerificationOtp:x,verifyPhoneVerificationOtp:i,checkPhoneUnique:C}=_S(),{bookings:R,fetchBookings:z,loading:F}=DEe(),{showSuccess:V,showError:G}=TY(),[H,Z]=ge.useState(u?.phoneNumber||""),[J,se]=ge.useState(u?.phoneVerified),[pe,ve]=ge.useState(!1),[Ne,_e]=ge.useState(!1),[Re,ke]=ge.useState(""),[ze,et]=ge.useState(!1),ht=Ih("rgba(255,255,255,0.6)","rgba(50,50,70,0.3)"),Ir={backdropFilter:"blur(18px)",WebkitBackdropFilter:"blur(18px)",borderRadius:"22px",border:`1px solid ${Ih("whiteAlpha.700","whiteAlpha.300")}`,boxShadow:"0 8px 20px rgba(0,0,0,0.04), inset 0 0 0 1px rgba(255,255,255,0.15)"},nr=qt=>{let Gt=qt.replace(/\D/g,"");return Gt.startsWith("63")||(Gt="63"+Gt.replace(/^0+/,"")),"+"+Gt},Fr=async()=>{if(H)try{await C(nr(H))}catch{G("Phone number already in use"),Z(u.phoneNumber||"")}},Or=async qt=>{qt.preventDefault();const Gt=new FormData(qt.target);try{await p(Gt),V("Profile updated")}catch{G("Error updating profile")}},or=async qt=>{if(qt.preventDefault(),u.provider==="google"){G("Google accounts cannot change password");return}const Gt=new FormData(qt.target),tt=Object.fromEntries(Gt);try{await y(tt),V("Password changed"),qt.target.reset()}catch{G("Error updating password")}},lt=async()=>{et(!0);try{await x(nr(H)),V("Verification code sent!"),_e(!0)}catch(qt){G(qt?.response?.data?.message||"Failed sending OTP")}finally{et(!1)}},Et=async()=>{if(!Re){G("Please enter the OTP code");return}et(!0);try{await i(Re),V("Phone verified!"),se(!0),ve(!1)}catch{G("Incorrect or expired OTP")}finally{et(!1)}};return ge.useEffect(()=>{r.get("tab")||e("/me?tab=profile",{replace:!0})},[]),ge.useEffect(()=>{a==="bookings"&&z()},[a]),u?X.jsxs(Mn,{minH:"100vh",px:4,pt:"110px",pb:20,bg:"#F6F1FF",position:"relative",overflow:"hidden",children:[X.jsx(Ad,{maxW:"7xl",position:"relative",zIndex:5,children:X.jsxs(h_,{templateColumns:["1fr",null,"240px 1fr"],gap:12,children:[X.jsx(Ch,{children:X.jsxs(Ic,{direction:"column",align:"center",sx:Ir,p:6,bg:ht,children:[X.jsx(Mn,{p:"6px",borderRadius:"full",bg:"whiteAlpha.700",border:"2px solid #faf7ff51",boxShadow:"0 0 25px rgba(183,148,244,0.6)",children:X.jsx(Ny,{size:"xl",name:u.name,src:`undefined/img/users/${u.photo}`})}),X.jsx(zr,{mt:4,fontSize:"lg",fontWeight:"bold",color:"purple.700",children:u.name}),X.jsxs(Wo,{spacing:2,mt:8,w:"100%",children:[X.jsx(oA,{icon:Qj,label:"My Profile",active:a==="profile",onClick:()=>e("/me?tab=profile")}),X.jsx(oA,{icon:oD,label:"My Bookings",active:a==="bookings",onClick:()=>e("/me?tab=bookings")}),X.jsx(oA,{icon:bve,label:"My Reviews",active:a==="reviews",onClick:()=>e("/me?tab=reviews")})]})]})}),X.jsx(Ch,{children:X.jsxs(Wo,{spacing:10,children:[a==="profile"&&X.jsxs(X.Fragment,{children:[X.jsxs(iA,{sx:Ir,bg:ht,p:8,w:"100%",children:[X.jsx(aW,{title:"Profile Information",icon:Qj}),X.jsx("form",{onSubmit:Or,children:X.jsxs(Wo,{spacing:5,children:[X.jsxs(Lm,{children:[X.jsx(zm,{children:"Name"}),X.jsx(El,{name:"name",defaultValue:u.name,bg:"whiteAlpha.700"})]}),X.jsxs(Lm,{children:[X.jsx(zm,{children:"Email"}),X.jsx(El,{name:"email",type:"email",defaultValue:u.email,bg:"whiteAlpha.700"})]}),X.jsxs(Lm,{children:[X.jsx(zm,{children:"Phone Number"}),X.jsx(El,{name:"phoneNumber",value:H,onChange:qt=>Z(nr(qt.target.value)),onBlur:Fr,bg:"whiteAlpha.700",disabled:J}),J?X.jsx(zr,{mt:2,fontSize:"sm",color:"green.500",children:" Phone Verified"}):X.jsx(wo,{mt:2,size:"sm",leftIcon:X.jsx(xve,{}),colorScheme:"purple",onClick:()=>ve(!0),children:"Verify Phone Number"})]}),X.jsxs(Lm,{children:[X.jsx(zm,{children:"Profile Photo"}),X.jsxs(Ic,{gap:5,bg:"purple.50",borderRadius:"12px",p:2,children:[X.jsx(wo,{as:"label",htmlFor:"photoUpload",colorScheme:"purple",size:"sm",cursor:"pointer",children:"Upload Photo"}),X.jsx(zr,{mt:2,id:"uploadFilename",children:"No file chosen"})]}),X.jsx(El,{id:"photoUpload",name:"photo",type:"file",accept:"image/*",display:"none",onChange:qt=>{const Gt=qt.target.files[0];document.getElementById("uploadFilename").textContent=Gt?.name||"No file chosen"}})]}),X.jsx(wo,{colorScheme:"purple",w:"160px",type:"submit",children:"Save Changes"})]})})]}),X.jsxs(iA,{sx:Ir,bg:ht,p:8,w:"100%",children:[X.jsx(aW,{title:"Change Password",icon:vve}),X.jsx("form",{onSubmit:or,children:X.jsxs(Wo,{spacing:5,opacity:u.provider==="google"?.5:1,children:[X.jsxs(Lm,{isRequired:!0,children:[X.jsx(zm,{children:"Current Password"}),X.jsx(El,{name:"passwordCurrent",type:"password",disabled:u.provider==="google"})]}),X.jsxs(Lm,{isRequired:!0,children:[X.jsx(zm,{children:"New Password"}),X.jsx(El,{name:"password",type:"password",disabled:u.provider==="google"})]}),X.jsxs(Lm,{isRequired:!0,children:[X.jsx(zm,{children:"Confirm Password"}),X.jsx(El,{name:"passwordConfirm",type:"password",disabled:u.provider==="google"})]}),X.jsx(wo,{mt:3,colorScheme:"purple",w:"180px",type:"submit",disabled:u.provider==="google",children:"Update Password"}),u.provider==="google"&&X.jsx(zr,{fontSize:"sm",color:"red.400",children:"Google accounts cannot change password"})]})})]})]}),a==="bookings"&&X.jsxs(iA,{sx:Ir,bg:ht,p:8,w:"100%",children:[X.jsx(ko,{size:"lg",mb:6,children:"My Bookings"}),F?X.jsx(Ky,{}):R.length?X.jsx(Wo,{spacing:4,align:"stretch",children:R.map(qt=>X.jsxs(Mn,{p:5,bg:"whiteAlpha.800",borderRadius:"lg",children:[X.jsxs(Fi,{justify:"space-between",children:[X.jsx(zr,{fontWeight:"bold",children:qt.tour?.name}),X.jsx(fS,{colorScheme:"green",children:"PAID"})]}),X.jsxs(Fi,{mt:2,color:"gray.600",children:[X.jsx(mo,{as:oD}),X.jsx(zr,{fontSize:"sm",children:new Date(qt.createdAt).toLocaleDateString()})]}),X.jsxs(zr,{mt:2,fontWeight:"semibold",children:["$",qt.price]})]},qt._id))}):X.jsx(zr,{children:"No bookings yet."})]})]})})]})}),X.jsxs(f_,{isOpen:pe,onClose:()=>ve(!1),isCentered:!0,children:[X.jsx(y_,{}),X.jsxs(p_,{children:[X.jsx(__,{children:"Verify Phone Number"}),X.jsx(g_,{}),X.jsx(m_,{children:Ne?X.jsxs(Wo,{spacing:4,children:[X.jsx(zr,{fontSize:"sm",children:"Enter the 6-digit code sent to your phone."}),X.jsx(El,{value:Re,onChange:qt=>ke(qt.target.value),placeholder:"123456",maxLength:6}),X.jsx(wo,{colorScheme:"purple",w:"100%",isLoading:ze,onClick:Et,children:"Verify"})]}):X.jsxs(Wo,{spacing:4,children:[X.jsx(zr,{fontSize:"sm",children:"Send a verification code to:"}),X.jsx(zr,{fontWeight:"bold",children:nr(H)}),X.jsx(wo,{colorScheme:"purple",w:"100%",isLoading:ze,onClick:lt,children:"Send Verification Code"})]})}),X.jsx(Cx,{children:X.jsx(wo,{variant:"ghost",onClick:()=>ve(!1),children:"Cancel"})})]})]})]}):X.jsx(zr,{textAlign:"center",children:"Loading user"})}function oA({icon:e,label:r,active:a=!1,onClick:u}){return X.jsxs(Ic,{w:"100%",align:"center",gap:3,px:4,py:2,borderRadius:"md",cursor:"pointer",onClick:u,bg:a?"purple.200":"whiteAlpha.500",_hover:{bg:"purple.100"},children:[e&&X.jsx(mo,{as:e,color:"purple.600"}),X.jsx(zr,{children:r})]})}function aW({icon:e,title:r}){return X.jsxs(Fi,{mb:6,children:[X.jsx(mo,{as:e,w:6,h:6,color:"purple.500"}),X.jsx(ko,{fontSize:"xl",children:r})]})}function OEe({message:e="Something went wrong!"}){return X.jsx("main",{className:"main",children:X.jsxs("div",{className:"error",children:[X.jsx("div",{className:"error__title"}),X.jsx("h2",{className:"heading-secondary heading-secondary--error",children:"Uh oh! Something went wrong!"}),X.jsx("h2",{className:"error__emoji",children:" "}),X.jsx("div",{className:"error__msg",children:e})]})})}function LEe(){return X.jsxs(Ic,{h:"100vh",w:"100vw",align:"center",justify:"center",direction:"column",bg:"white",children:[X.jsx(Ky,{size:"xl",thickness:"4px",speed:"0.65s",color:"purple.500"}),X.jsx(zr,{mt:4,fontSize:"lg",color:"gray.600",children:"Loading..."})]})}function zEe(){const{ready:e,init:r}=HW();return ge.useEffect(()=>{r()},[]),e?X.jsx(uJ,{children:X.jsxs(Sp,{element:X.jsx(fve,{}),children:[X.jsx(Sp,{path:"/login",element:X.jsx(AEe,{})}),X.jsx(Sp,{path:"/",element:X.jsx(E1e,{})}),X.jsx(Sp,{path:"/tours",element:X.jsx(iEe,{})}),X.jsx(Sp,{path:"/packages",element:X.jsx(SEe,{})}),X.jsx(Sp,{path:"/tour/:slug",element:X.jsx(vEe,{})}),X.jsx(Sp,{path:"/me",element:X.jsx(REe,{})}),X.jsx(Sp,{path:"*",element:X.jsx(OEe,{})})]})}):X.jsx(LEe,{})}mQ.createRoot(document.getElementById("root")).render(X.jsx(Js.StrictMode,{children:X.jsx(Ume,{children:X.jsx(MEe,{clientId:void 0,children:X.jsx(yJ,{children:X.jsx(zEe,{})})})})}));
